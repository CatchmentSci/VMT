<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub92" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub93" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub94" class="code">function initGUI(handles)</a></li><li><a href="#_sub95" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub96" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub97" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub98" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub99" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub100" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub101" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub102" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub103" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a></li><li><a href="#_sub104" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub105" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub106" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function icons = getIcons</a></li><li><a href="#_sub108" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub109" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub110" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub111" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub91" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub92" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub108" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = {<span class="string">'v4.06'</span>; <span class="string">'r20140917'</span>};
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="comment">% else</span>
0122 <span class="comment">%     X = imread('VMT_Background.png');</span>
0123 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0124 <span class="comment">%     X = uint8(X);</span>
0125 <span class="comment">%     imshow(X,'Border','tight')</span>
0126 <span class="comment">% end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0133 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0134 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0135 
0136 <span class="comment">% Auto-check for updates</span>
0137 <span class="comment">% ----------------------</span>
0138 thres = 20; 
0139 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0140 time_to_check = (mod(runcounter,thres)==0);
0141 <span class="keyword">if</span> time_to_check
0142     <a href="#_sub48" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0143 <span class="keyword">end</span>
0144 
0145 <span class="comment">% Initialize the GUI:</span>
0146 <span class="comment">% -------------------</span>
0147 <a href="#_sub94" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0148 <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0149 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0150 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0151 pos = get(handles.figure1,<span class="string">'Position'</span>);
0152 <span class="comment">% pos(3) = 545;</span>
0153 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0154 movegui(handles.figure1,<span class="string">'center'</span>)
0155 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0156 
0157 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0158 <span class="comment">% the root</span>
0159 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0160 
0161 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0162 <span class="comment">% uiwait(handles.figure1);</span>
0163 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0164 
0165 
0166 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0167 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0168 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0169 <span class="comment">% hObject    handle to figure</span>
0170 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0171 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0172 
0173 <span class="comment">% Get default command line output from handles structure</span>
0174 varargout{1} = handles.output;
0175 <span class="comment">% [EOF] VMT_OutputFcn</span>
0176 
0177 <span class="comment">% --- Executes when figure1 is resized.</span>
0178 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0179 
0180 <span class="comment">% Draw the VMT Background</span>
0181 <span class="comment">% -----------------</span>
0182 pos = get(handles.figure1,<span class="string">'position'</span>);
0183 axes(handles.VMTBackground);
0184 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0185     X = imread(<span class="string">'VMT_Background.png'</span>);
0186     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0187 <span class="comment">% else</span>
0188 <span class="comment">%     X = imread('VMT_Background.png');</span>
0189 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0190 <span class="comment">%     X = uint8(X);</span>
0191 <span class="comment">%     imshow(X,'Border','tight')</span>
0192 <span class="comment">% end</span>
0193 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0194 
0195 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0196 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0197 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0198 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0199 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0200 
0201 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0202 who_called = get(hObject,<span class="string">'tag'</span>);
0203 close_button = questdlg(<span class="keyword">...</span>
0204     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0205     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0206 <span class="keyword">switch</span> close_button
0207     <span class="keyword">case</span> <span class="string">'Yes'</span>
0208         closereq
0209         close all hidden
0210     <span class="keyword">otherwise</span>
0211         <span class="keyword">return</span>
0212 <span class="keyword">end</span>
0213 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0214 
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 <span class="comment">% MENU BAR CALLBACKS %</span>
0217 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0221 <span class="comment">% Empty</span>
0222 
0223 <span class="comment">% --------------------------------------------------------------------</span>
0224 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0225 <span class="comment">% Empty</span>
0226 
0227 <span class="comment">% --------------------------------------------------------------------</span>
0228 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0229 <a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0230 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0231 
0232 <span class="comment">% --------------------------------------------------------------------</span>
0233 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0234 
0235 <span class="comment">% Get the Application data:</span>
0236 <span class="comment">% -------------------------</span>
0237 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0238 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0239 
0240 <span class="comment">% Ask the user to select files:</span>
0241 <span class="comment">% -----------------------------</span>
0242 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0243 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0244 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0245     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0246 <span class="keyword">else</span>
0247     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0248 <span class="keyword">end</span>
0249 [filename,pathname] = <span class="keyword">...</span>
0250     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0251     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0252     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0253 
0254 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0255     <span class="comment">% Load the data:</span>
0256     <span class="comment">% --------------</span>
0257     vars = load(fullfile(pathname,filename));
0258     
0259     <span class="comment">% Make sure the selected file is a valid file:</span>
0260     <span class="comment">% --------------------------------------------</span>
0261     varnames = fieldnames(vars);
0262     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0263         guiparams.mat_path = pathname;
0264         guiparams.mat_file = filename;
0265         guiparams.z = vars.z;
0266         guiparams.A = vars.A;
0267         guiparams.V = vars.V;
0268         
0269         <span class="comment">% Update the preferences:</span>
0270         <span class="comment">% -----------------------</span>
0271         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0272         guiprefs.mat_path = pathname;
0273         guiprefs.mat_file = filename;
0274         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0275         <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0276                      
0277         <span class="comment">% Re-store the Application Data:</span>
0278         <span class="comment">% ------------------------------</span>
0279         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0280         
0281         <span class="comment">% Update the GUI:</span>
0282         <span class="comment">% ---------------</span>
0283         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0284         <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0285     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0286         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0287             <span class="string">'Invalid File...'</span>)
0288     <span class="keyword">end</span>
0289     
0290     <span class="comment">% Set the vertical grid node spacing</span>
0291     <span class="comment">% ----------------------------------</span>
0292     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0293     <span class="comment">% Backwards compatible</span>
0294     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0295         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0296     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0297         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0298     <span class="keyword">end</span>
0299     
0300 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0301     <span class="comment">% Set the filenames</span>
0302     <span class="comment">% -----------------</span>
0303     guiparams.mat_path = pathname;
0304     guiparams.mat_file = filename;
0305     
0306     <span class="comment">% Push status to log window</span>
0307     <span class="comment">% -------------------------</span>
0308     log_text = {<span class="keyword">...</span>
0309         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0310         <span class="string">'Directory:'</span>};
0311     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0312     statusLogging(handles.LogWindow,log_text)
0313     
0314     <span class="comment">% Update the Application Data:</span>
0315     <span class="comment">% ------------------------------</span>
0316     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0317     
0318     <span class="comment">% Update the persistent preferences:</span>
0319     <span class="comment">% ----------------------------------</span>
0320     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0321     guiprefs.mat_path = pathname;
0322     guiprefs.mat_file = filename;
0323     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0324     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0325         
0326     <span class="comment">% Update the GUI:</span>
0327     <span class="comment">% ---------------</span>
0328     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0329 <span class="keyword">end</span>
0330 
0331 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0332 
0333 <span class="comment">% --------------------------------------------------------------------</span>
0334 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0335 <span class="comment">% Empty</span>
0336 
0337 <span class="comment">% --------------------------------------------------------------------</span>
0338 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0339 <a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0340 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0341 
0342 <span class="comment">% --------------------------------------------------------------------</span>
0343 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0344 <a href="#_sub59" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0345 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0346 
0347 <span class="comment">% --------------------------------------------------------------------</span>
0348 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0349 <a href="#_sub60" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0350 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0351 
0352 <span class="comment">% --------------------------------------------------------------------</span>
0353 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0354 <span class="comment">% Empty</span>
0355 
0356 <span class="comment">% --------------------------------------------------------------------</span>
0357 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0358 <span class="comment">% Empty</span>
0359 
0360 <span class="comment">% --------------------------------------------------------------------</span>
0361 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0362 
0363 <span class="comment">% Get the Application Data:</span>
0364 <span class="comment">% -------------------------</span>
0365 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0366 
0367 <span class="comment">% Update the Application Data:</span>
0368 <span class="comment">% ----------------------------</span>
0369 guiparams.print        = true;
0370 guiparams.presentation = false;
0371 
0372 <span class="comment">% Re-store the Application data:</span>
0373 <span class="comment">% ------------------------------</span>
0374 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0375 
0376 <span class="comment">% Update the GUI:</span>
0377 <span class="comment">% ---------------</span>
0378 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0380 
0381 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0382 
0383 
0384 <span class="comment">% --------------------------------------------------------------------</span>
0385 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0386 
0387 <span class="comment">% Get the Application Data:</span>
0388 <span class="comment">% -------------------------</span>
0389 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0390 
0391 <span class="comment">% Update the Application Data:</span>
0392 <span class="comment">% ----------------------------</span>
0393 guiparams.print        = false;
0394 guiparams.presentation = true;
0395 
0396 <span class="comment">% Re-store the Application data:</span>
0397 <span class="comment">% ------------------------------</span>
0398 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0399 
0400 <span class="comment">% Update the GUI:</span>
0401 <span class="comment">% ---------------</span>
0402 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0403 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0404 
0405 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0406 
0407 <span class="comment">% --------------------------------------------------------------------</span>
0408 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0409 <span class="comment">%  --- Empty ---</span>
0410 
0411 <span class="comment">% --------------------------------------------------------------------</span>
0412 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0413 <span class="comment">% Get the Application Data:</span>
0414 <span class="comment">% -------------------------</span>
0415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0416 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0417 
0418 <span class="comment">% Update the Application Data:</span>
0419 <span class="comment">% ----------------------------</span>
0420 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0421 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0422 
0423 <span class="comment">% Re-store the Application data:</span>
0424 <span class="comment">% ------------------------------</span>
0425 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0426 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0427 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0428 
0429 <span class="comment">% Update the GUI:</span>
0430 <span class="comment">% ---------------</span>
0431 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0432 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0434 
0435 <span class="comment">% Modify the existing figures</span>
0436 <span class="comment">% ---------------------------</span>
0437 <span class="comment">% Find what plots exist already</span>
0438 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0439 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0440 
0441 <span class="comment">% Loop through valid figures and adjust</span>
0442 <span class="comment">% -------------------------------------</span>
0443 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0444     <span class="keyword">for</span> i = 1:length(valid_names)
0445         <span class="comment">% Focus the figure</span>
0446         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0447         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0448             figure(hff)
0449             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0450         <span class="keyword">end</span>
0451         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0452         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0453             figure(hff)
0454             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0455         <span class="keyword">end</span>
0456     <span class="keyword">end</span>
0457 <span class="keyword">end</span>
0458 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0459 
0460 
0461 <span class="comment">% --------------------------------------------------------------------</span>
0462 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0463 <span class="comment">% Get the Application Data:</span>
0464 <span class="comment">% -------------------------</span>
0465 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0466 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0467 
0468 <span class="comment">% Update the Application Data:</span>
0469 <span class="comment">% ----------------------------</span>
0470 guiparams.renderer  = <span class="string">'painters'</span>;
0471 guiprefs.renderer   = <span class="string">'painters'</span>;
0472 
0473 <span class="comment">% Re-store the Application data:</span>
0474 <span class="comment">% ------------------------------</span>
0475 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0476 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0477 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0478 
0479 <span class="comment">% Update the GUI:</span>
0480 <span class="comment">% ---------------</span>
0481 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0482 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0483 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0484 
0485 <span class="comment">% Modify the existing figures</span>
0486 <span class="comment">% ---------------------------</span>
0487 <span class="comment">% Find what plots exist already</span>
0488 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0489 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0490 
0491 <span class="comment">% Loop through valid figures and adjust</span>
0492 <span class="comment">% -------------------------------------</span>
0493 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0494     <span class="keyword">for</span> i = 1:length(valid_names)
0495         <span class="comment">% Focus the figure</span>
0496         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0497         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0498             figure(hff)
0499             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0500         <span class="keyword">end</span>
0501         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0502         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0503             figure(hff)
0504             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0505         <span class="keyword">end</span>
0506     <span class="keyword">end</span>
0507 <span class="keyword">end</span>
0508 <span class="comment">% [EOF] menuPainters_Callback</span>
0509 
0510 <span class="comment">% --------------------------------------------------------------------</span>
0511 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0512 <span class="comment">% Get the Application Data:</span>
0513 <span class="comment">% -------------------------</span>
0514 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0515 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0516 
0517 <span class="comment">% Update the Application Data:</span>
0518 <span class="comment">% ----------------------------</span>
0519 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0520 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0521 
0522 <span class="comment">% Re-store the Application data:</span>
0523 <span class="comment">% ------------------------------</span>
0524 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0525 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0526 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0527 
0528 <span class="comment">% Update the GUI:</span>
0529 <span class="comment">% ---------------</span>
0530 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0532 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0533 
0534 <span class="comment">% Modify the existing figures</span>
0535 <span class="comment">% ---------------------------</span>
0536 <span class="comment">% Find what plots exist already</span>
0537 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0538 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0539 
0540 <span class="comment">% Loop through valid figures and adjust</span>
0541 <span class="comment">% -------------------------------------</span>
0542 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0543     <span class="keyword">for</span> i = 1:length(valid_names)
0544         <span class="comment">% Focus the figure</span>
0545         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0546         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0547             figure(hff)
0548             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0549         <span class="keyword">end</span>
0550         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0551         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0552             figure(hff)
0553             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0554         <span class="keyword">end</span>
0555     <span class="keyword">end</span>
0556 <span class="keyword">end</span>
0557 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0558 
0559 <span class="comment">% --------------------------------------------------------------------</span>
0560 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0561 <span class="comment">% Get the Application data:</span>
0562 <span class="comment">% -------------------------</span>
0563 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0564 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0565 
0566 <span class="comment">% Find what plots exist already</span>
0567 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0568 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0569 
0570 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0571 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0572 <span class="keyword">if</span> ~isempty(idx)
0573     fig_names(idx) = [];
0574 <span class="keyword">end</span>
0575 
0576 <span class="keyword">if</span> guiparams.presentation
0577     figure_style = <span class="string">'presentation'</span>;
0578 <span class="keyword">else</span>
0579     figure_style = <span class="string">'print'</span>;
0580 <span class="keyword">end</span>
0581 
0582 [selected_figures] = <a href="#_sub105" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0583 
0584 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0585     <span class="keyword">return</span>
0586 <span class="keyword">else</span>
0587     <span class="keyword">for</span> i = 1:length(selected_figures)
0588         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0589     <span class="keyword">end</span>
0590 <span class="keyword">end</span>
0591 
0592 
0593 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0594 
0595 <span class="comment">% --------------------------------------------------------------------</span>
0596 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0597 <span class="comment">% Get the Application data:</span>
0598 <span class="comment">% -------------------------</span>
0599 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0600 beam_angle             = guiparams.beam_angle; 
0601 magnetic_variation     = guiparams.magnetic_variation; 
0602 wse                    = guiparams.wse;
0603 output_auxiliary_data  = guiparams.output_auxiliary_data; 
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data] = <span class="keyword">...</span>
0611     <a href="#_sub103" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxiliary_data,handles.figure1);
0612 
0613 <span class="comment">% Re-store the Application data:</span>
0614 <span class="comment">% ------------------------------</span>
0615 guiparams.beam_angle            = beam_angle;
0616 guiparams.magnetic_variation    = magnetic_variation; 
0617 guiparams.wse                   = wse;
0618 guiparams.output_auxiliary_data = output_auxiliary_data;
0619 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0620 
0621 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0622 
0623 <span class="comment">% --------------------------------------------------------------------</span>
0624 <a name="_sub23" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0625 <a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0626 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0627 
0628 
0629 <span class="comment">% --------------------------------------------------------------------</span>
0630 <a name="_sub24" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0631 
0632 <span class="comment">% Get the Application Data:</span>
0633 <span class="comment">% -------------------------</span>
0634 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0635 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0636 PVdata    = guiparams.iric_anv_planview_data;
0637 iric_path = guiprefs.iric_path;
0638 iric_file = guiprefs.iric_file;
0639 
0640 <span class="comment">% Is there any planview data?</span>
0641 <span class="keyword">if</span> isempty(PVdata)
0642     <span class="comment">% Nothing to do, warn user</span>
0643     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0644     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0645 <span class="keyword">else</span>
0646     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0647     <span class="comment">% and smoothing (for iRiC)</span>
0648     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0649     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0650         fullfile(iric_path,iric_file));
0651     
0652     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0653         outfile = fullfile(iric_path,iric_file);
0654         log_text = vertcat(log_text,{outfile});
0655         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0656         outcount = fprintf(ofid,<span class="keyword">...</span>
0657             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0658         fclose(ofid);
0659     <span class="keyword">else</span>
0660         <span class="comment">% Return default iric_path and iric_file</span>
0661         iric_path = guiprefs.iric_path;
0662         iric_file = guiprefs.iric_file;
0663     <span class="keyword">end</span>
0664 <span class="keyword">end</span>
0665 
0666 <span class="comment">% Push messages to Log Window:</span>
0667 <span class="comment">% ----------------------------</span>
0668 statusLogging(handles.LogWindow, log_text)
0669 
0670 <span class="comment">% Store the persistent preferences:</span>
0671 <span class="comment">% ---------------------------------</span>
0672 guiprefs.iric_file = iric_file;
0673 guiprefs.iric_path = iric_path;
0674 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0675 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0676 
0677 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0678 
0679 <span class="comment">% --------------------------------------------------------------------</span>
0680 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0681 <span class="comment">% Get the Application Data:</span>
0682 <span class="comment">% -------------------------</span>
0683 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0684 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0685 excel_path  = guiprefs.excel_path;
0686 excel_file  = guiprefs.excel_file;
0687 
0688 <span class="comment">% Push messages to Log Window:</span>
0689 <span class="comment">% ----------------------------</span>
0690 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0691 statusLogging(handles.LogWindow, log_text)
0692 
0693 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0694 <span class="comment">% data.</span>
0695 <span class="keyword">if</span> iscell(guiparams.mat_file)
0696     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0697     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0698     <span class="comment">% Refresh the Application Data:</span>
0699     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0700     z           = guiparams.z;
0701     A           = guiparams.A;
0702     V           = guiparams.V;
0703     Map         = guiparams.Map;
0704     wse         = guiparams.wse;
0705     PVdata      = guiparams.iric_anv_planview_data;
0706     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0707         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0708     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0709         fullfile(excel_path,excel_file));
0710     
0711     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0712         outfile = fullfile(excel_path,excel_file);
0713         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0714         
0715     <span class="keyword">else</span>
0716         <span class="comment">% Return default excel_path and excel_file</span>
0717         excel_path = guiprefs.excel_path;
0718         excel_file = guiprefs.excel_file;
0719         outfile = fullfile(excel_path,excel_file);
0720         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0721     <span class="keyword">end</span>
0722     
0723     <span class="comment">% Delete the old file if it exists</span>
0724     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0725         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0726             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0727             <span class="string">'already exists. Overwriting file...'</span>});
0728         delete(outfile)
0729     <span class="keyword">end</span>
0730     
0731     <span class="comment">% Save DAV data to an Excel File</span>
0732     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0733     vmin = num2str(guiparams.depth_range_min);
0734     vmax = num2str(guiparams.depth_range_max);
0735     pvheaders = {<span class="keyword">...</span>
0736         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0737         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0738         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0739         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0740     
0741 
0742     <span class="comment">% Initialize Variables</span>
0743     pvdata = []; Dist = [];
0744     X = []; Y = []; E = [];
0745     Ve = []; Vn =[]; Vm = []; Vd = [];
0746     
0747     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0748     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0749         <span class="comment">% Load current MAT-file</span>
0750         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0751         
0752         <span class="comment">% Location and Bathy</span>
0753         X = [X V.mcsX(1,:)];
0754         Y = [Y V.mcsY(1,:)];
0755         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0756         E = [E V.mcsBedElev];
0757         
0758         <span class="comment">% Build layer-averaged velocities</span>
0759         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0760         V.mcsX(indx,:) = nan;
0761         V.mcsY(indx,:) = nan;
0762         V.mcsEast(indx,:) = nan;
0763         V.mcsNorth(indx,:) = nan;
0764         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0765         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0766         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0767         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0768         
0769         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0770     <span class="keyword">end</span>
0771     
0772     <span class="comment">% Put output into 1 matrix</span>
0773     pvdata = [<span class="keyword">...</span>
0774         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0775         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0776         ];
0777     pvdata(isnan(pvdata)) = -9999;
0778     
0779     <span class="comment">% Create table and write to Excel</span>
0780     pvout = num2cell(pvdata');
0781     pvout = vertcat(pvheaders,pvout);
0782     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0783     
0784     <span class="comment">% Close out waitbar</span>
0785     waitbar(1,hwait)
0786     delete(hwait)
0787     
0788     <span class="comment">% Push messages to Log Window:</span>
0789     <span class="comment">% ----------------------------</span>
0790     statusLogging(handles.LogWindow, log_text)
0791 <span class="keyword">else</span>
0792     
0793     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0794     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0795     <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0796     <span class="comment">% Refresh the Application Data:</span>
0797     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0798     z           = guiparams.z;
0799     A           = guiparams.A;
0800     V           = guiparams.V;
0801     Map         = guiparams.Map;
0802     wse         = guiparams.wse;
0803     PVdata      = guiparams.iric_anv_planview_data;
0804     
0805     
0806     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0807     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0808         fullfile(excel_path,excel_file));
0809     
0810     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0811         outfile = fullfile(excel_path,excel_file);
0812         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0813         
0814         <span class="comment">% Delete the old file if it exists</span>
0815         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0816             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0817                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0818                 <span class="string">'already exists. Overwriting file...'</span>});
0819             delete(outfile)
0820         <span class="keyword">end</span>
0821         
0822         <span class="comment">% Push messages to Log Window:</span>
0823         <span class="comment">% ----------------------------</span>
0824         statusLogging(handles.LogWindow, log_text)
0825         
0826         <span class="comment">% Save MCS Summary to an Excel File</span>
0827         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0828         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0829         sout = guiparams.data_files';
0830         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0831         sout = {<span class="keyword">...</span>
0832             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0833             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0834             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0835             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0836             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0837             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0838             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0839             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0840             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0841             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0842             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0843             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0844             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0845             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0846             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0847             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0848             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0849             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0850         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0851         
0852         <span class="comment">% Save DAV data to an Excel File</span>
0853         vmin = num2str(guiparams.depth_range_min);
0854         vmax = num2str(guiparams.depth_range_max);
0855         pvheaders = {<span class="keyword">...</span>
0856             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0857             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0858             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0859             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0860         
0861         <span class="comment">% Create block style matrix of all processed data</span>
0862         pvdata = [];
0863         
0864         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0865         <span class="comment">% you are looking upstream into the transect</span>
0866         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0867         
0868         <span class="comment">% Build bathy data matrix</span>
0869         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0870         
0871         <span class="comment">% Build layer-averaged velocities</span>
0872         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0873         V.mcsX(indx,:) = nan;
0874         V.mcsY(indx,:) = nan;
0875         V.mcsEast(indx,:) = nan;
0876         V.mcsNorth(indx,:) = nan;
0877         pvdata = [<span class="keyword">...</span>
0878             pvdata;<span class="keyword">...</span>
0879             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0880             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0881             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0882             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0883         pvdata(isnan(pvdata)) = -9999;
0884         pvout = num2cell(pvdata');
0885         pvout = vertcat(pvheaders,pvout);
0886         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0887         waitbar(4/5,hwait)
0888         
0889         <span class="comment">% Save MCS data to an Excel File</span>
0890         mcsheaders = {<span class="keyword">...</span>
0891             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0892             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0893             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0894             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0895             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0896             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0897             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0898             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0899             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0900             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0901             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0902             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0903             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0904             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0905             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0906             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0907         
0908         mcsdata = [<span class="keyword">...</span>
0909             V.mcsX(:)<span class="keyword">...</span>
0910             V.mcsY(:)<span class="keyword">...</span>
0911             V.mcsDist(:)<span class="keyword">...</span>
0912             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0913             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0914             V.mcsEast(:)<span class="keyword">...</span>
0915             V.mcsNorth(:)<span class="keyword">...</span>
0916             V.mcsVert(:)<span class="keyword">...</span>
0917             V.mcsMag(:)<span class="keyword">...</span>
0918             V.mcsDir(:)<span class="keyword">...</span>
0919             V.u(:)<span class="keyword">...</span>
0920             V.v(:)<span class="keyword">...</span>
0921             V.vp(:)<span class="keyword">...</span>
0922             V.vs(:)<span class="keyword">...</span>
0923             V.Roz.up(:)<span class="keyword">...</span>
0924             V.Roz.us(:)];
0925         mcsdata(isnan(mcsdata)) = -9999;
0926         
0927         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0928         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0929         waitbar(1,hwait)
0930         delete(hwait)
0931         
0932     <span class="keyword">else</span>
0933         <span class="comment">% Return default excel_path and excel_file</span>
0934         excel_path = guiprefs.excel_path;
0935         excel_file = guiprefs.excel_file;
0936         outfile = fullfile(excel_path,excel_file);
0937         log_text = {<span class="string">'User aborted Excel export...'</span>};
0938     <span class="keyword">end</span>
0939     
0940     
0941     
0942 <span class="keyword">end</span>
0943 
0944 <span class="comment">% Push messages to Log Window:</span>
0945 <span class="comment">% ----------------------------</span>
0946 statusLogging(handles.LogWindow, log_text)
0947 
0948 <span class="comment">% Store the persistent preferences:</span>
0949 <span class="comment">% ---------------------------------</span>
0950 guiprefs.excel_file = excel_file;
0951 guiprefs.excel_path = excel_path;
0952 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0953 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0954 
0955 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0956 
0957 <span class="comment">% --------------------------------------------------------------------</span>
0958 <a name="_sub26" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0959 <span class="comment">% Empty</span>
0960 
0961 <span class="comment">% --------------------------------------------------------------------</span>
0962 <a name="_sub27" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0963 <span class="comment">% Empty</span>
0964 
0965 <span class="comment">% --------------------------------------------------------------------</span>
0966 <a name="_sub28" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0967 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0968 
0969 <span class="comment">% Get the Application Data:</span>
0970 <span class="comment">% -------------------------</span>
0971 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0972 
0973 <span class="comment">% Update the GUI &amp; Application Data:</span>
0974 <span class="comment">% ----------------------------------</span>
0975 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0976 <span class="keyword">switch</span> status
0977     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0978         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0979         guiparams.unit_discharge_correction = false;
0980     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0981         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0982         guiparams.unit_discharge_correction = true;
0983 <span class="keyword">end</span>
0984 
0985 <span class="comment">% Re-store the Application data:</span>
0986 <span class="comment">% ------------------------------</span>
0987 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0988 
0989 
0990 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0991 
0992 <span class="comment">% --------------------------------------------------------------------</span>
0993 <a name="_sub29" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0994 <span class="comment">% Empty</span>
0995 
0996 <span class="comment">% --------------------------------------------------------------------</span>
0997 <a name="_sub30" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0998 <span class="comment">% Empty</span>
0999 
1000 <span class="comment">% --------------------------------------------------------------------</span>
1001 <a name="_sub31" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1002 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1003 
1004 <span class="comment">% Get the Application Data:</span>
1005 <span class="comment">% -------------------------</span>
1006 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1007 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1008 
1009 <span class="comment">% Update the Application Data:</span>
1010 <span class="comment">% ----------------------------</span>
1011 guiparams.english_units = false;
1012 guiprefs.units = <span class="string">'metric'</span>;
1013 
1014 <span class="comment">% Re-store the Application data:</span>
1015 <span class="comment">% ------------------------------</span>
1016 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1017 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1018 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1019 
1020 <span class="comment">% Update the GUI:</span>
1021 <span class="comment">% ---------------</span>
1022 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1023 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1024 
1025 <span class="comment">% [EOF] menuMetric_Callback</span>
1026 
1027 
1028 <span class="comment">% --------------------------------------------------------------------</span>
1029 <a name="_sub32" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1030 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1031 
1032 <span class="comment">% Get the Application Data:</span>
1033 <span class="comment">% -------------------------</span>
1034 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1035 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1036 
1037 <span class="comment">% Update the Application Data:</span>
1038 <span class="comment">% ----------------------------</span>
1039 guiparams.english_units = true;
1040 guiprefs.units = <span class="string">'english'</span>;
1041 
1042 <span class="comment">% Re-store the Application data:</span>
1043 <span class="comment">% ------------------------------</span>
1044 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1045 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1046 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1047 
1048 <span class="comment">% Update the GUI:</span>
1049 <span class="comment">% ---------------</span>
1050 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1051 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1052 
1053 <span class="comment">% [EOF] menuEnglish_Callback</span>
1054 
1055 
1056 <span class="comment">% --------------------------------------------------------------------</span>
1057 <a name="_sub33" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1058 <span class="comment">% Empty</span>
1059 
1060 <span class="comment">% --------------------------------------------------------------------</span>
1061 <a name="_sub34" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1062 <span class="comment">% Set cross-section endpoints automatically</span>
1063 
1064 <span class="comment">% Get the Application Data:</span>
1065 <span class="comment">% -------------------------</span>
1066 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1067 
1068 <span class="comment">% Update the Application Data:</span>
1069 <span class="comment">% ----------------------------</span>
1070 guiparams.set_cross_section_endpoints = false;
1071 
1072 <span class="comment">% Re-store the Application data:</span>
1073 <span class="comment">% ------------------------------</span>
1074 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1075 
1076 <span class="comment">% Update the GUI:</span>
1077 <span class="comment">% ---------------</span>
1078 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1079 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1080 
1081 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1082 
1083 
1084 <span class="comment">% --------------------------------------------------------------------</span>
1085 <a name="_sub35" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1086 <span class="comment">% Set cross-section endpoints manually</span>
1087 
1088 <span class="comment">% Get the Application Data:</span>
1089 <span class="comment">% -------------------------</span>
1090 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1091 
1092 <span class="comment">% Update the Application Data:</span>
1093 <span class="comment">% ----------------------------</span>
1094 guiparams.set_cross_section_endpoints = true;
1095 
1096 <span class="comment">% Re-store the Application data:</span>
1097 <span class="comment">% ------------------------------</span>
1098 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1099 
1100 <span class="comment">% Update the GUI:</span>
1101 <span class="comment">% ---------------</span>
1102 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1103 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1104 
1105 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1106 
1107 
1108 
1109 
1110 <span class="comment">% --------------------------------------------------------------------</span>
1111 <a name="_sub36" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1112 <span class="comment">% Empty</span>
1113 
1114 <span class="comment">% --------------------------------------------------------------------</span>
1115 <a name="_sub37" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1116 
1117 <span class="comment">% Get the Application Data:</span>
1118 <span class="comment">% -------------------------</span>
1119 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1120 
1121 <span class="comment">% Update the Application Data:</span>
1122 <span class="comment">% ----------------------------</span>
1123 guiparams.print        = true;
1124 guiparams.presentation = false;
1125 
1126 <span class="comment">% Re-store the Application data:</span>
1127 <span class="comment">% ------------------------------</span>
1128 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1129 
1130 <span class="comment">% Update the GUI:</span>
1131 <span class="comment">% ---------------</span>
1132 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1133 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1134 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1135 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1136 
1137 <span class="comment">% Modify the existing figures</span>
1138 <span class="comment">% ---------------------------</span>
1139 <span class="comment">% Find what plots exist already</span>
1140 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1141 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1142 
1143 <span class="comment">% Defaults for Print Stlye Figure</span>
1144 BkgdColor   = <span class="string">'white'</span>;
1145 AxColor     = <span class="string">'black'</span>;
1146 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1147 FntSize     = 14;
1148 
1149 <span class="comment">% Loop through valid figures and adjust</span>
1150 <span class="comment">% -------------------------------------</span>
1151 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1152     
1153     <span class="keyword">for</span> i = 1:length(valid_names)
1154         <span class="keyword">switch</span> valid_names{i}
1155             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1156                 <span class="comment">% Focus the figure</span>
1157                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1158                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1159                     figure(hff)
1160                     
1161                     <span class="comment">% Make the changes to figure</span>
1162                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1163                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1164                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1165                     set(gca,<span class="string">'Color'</span>,FigColor)
1166                     set(gca,<span class="string">'XColor'</span>,AxColor)
1167                     set(gca,<span class="string">'YColor'</span>,AxColor)
1168                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1169                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1170                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1171                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1172                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1173                     
1174                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1175                     <span class="comment">% the file(s) and path for the data</span>
1176                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1177                     <span class="keyword">if</span> ~ismultiplot
1178                         filestr = guiparams.savefile;
1179                         wd = length(filestr);
1180                         hd = 1;
1181                     <span class="keyword">else</span>
1182                         <span class="comment">% Construct a filename</span>
1183                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1184                         wd        = max(cellfun(@length,filestr));
1185                         hd        = numel(filestr);
1186                             
1187                     <span class="keyword">end</span>
1188                     
1189                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1190                     disableMenuBar(hff)
1191                     set(fileinfotxt,<span class="keyword">...</span>
1192                         <span class="string">'string'</span>,filestr)
1193                     set(fileinfotxt,<span class="keyword">...</span>
1194                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1195                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1196                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1197                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1198                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1199                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1200                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1201                     
1202                 <span class="keyword">end</span>
1203             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1204                 <span class="comment">% Focus the figure</span>
1205                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1206                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1207                     figure(hff)
1208                     
1209                     <span class="comment">% Make the changes to figure</span>
1210                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1211                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1212                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1213                     set(gca,<span class="string">'Color'</span>,FigColor)
1214                     set(gca,<span class="string">'XColor'</span>,AxColor)
1215                     set(gca,<span class="string">'YColor'</span>,AxColor)
1216                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1217                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1218                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1219                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1220                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1221                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1222                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1223                     
1224                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1225                     <span class="comment">% the file(s) and path for the data</span>
1226                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1227                     <span class="keyword">if</span> ~ismultiplot
1228                         filestr = guiparams.savefile;
1229                         wd = length(filestr);
1230                         hd = 1;
1231                     <span class="keyword">else</span>
1232                         <span class="comment">% Construct a filename</span>
1233                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1234                         wd        = max(cellfun(@length,filestr));
1235                         hd        = numel(filestr);
1236                             
1237                     <span class="keyword">end</span>
1238                     
1239                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1240                     disableMenuBar(hff)
1241                     set(fileinfotxt,<span class="keyword">...</span>
1242                         <span class="string">'string'</span>,filestr)
1243                     set(fileinfotxt,<span class="keyword">...</span>
1244                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1245                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1246                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1247                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1248                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1249                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1250                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1251                 <span class="keyword">end</span>
1252             <span class="keyword">otherwise</span>
1253         <span class="keyword">end</span>
1254     <span class="keyword">end</span>
1255     
1256     
1257 <span class="keyword">end</span>
1258 
1259 
1260 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1261 
1262 
1263 <span class="comment">% --------------------------------------------------------------------</span>
1264 <a name="_sub38" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1265 <span class="comment">% Get the Application Data:</span>
1266 <span class="comment">% -------------------------</span>
1267 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1268 
1269 <span class="comment">% Update the Application Data:</span>
1270 <span class="comment">% ----------------------------</span>
1271 guiparams.print        = false;
1272 guiparams.presentation = true;
1273 
1274 <span class="comment">% Re-store the Application data:</span>
1275 <span class="comment">% ------------------------------</span>
1276 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1277 
1278 <span class="comment">% Update the GUI:</span>
1279 <span class="comment">% ---------------</span>
1280 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1281 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1282 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1283 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1284 
1285 <span class="comment">% Modify the existing figures</span>
1286 <span class="comment">% ---------------------------</span>
1287 <span class="comment">% Find what plots exist already</span>
1288 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1289 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1290 
1291 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1292 <span class="comment">% --------------------------------------</span>
1293 BkgdColor   = <span class="string">'black'</span>;
1294 AxColor     = <span class="string">'white'</span>;
1295 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1296 FntSize     = 14;
1297 
1298 <span class="comment">% Loop through valid figures and adjust</span>
1299 <span class="comment">% -------------------------------------</span>
1300 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1301     
1302     <span class="keyword">for</span> i = 1:length(valid_names)
1303         <span class="keyword">switch</span> valid_names{i}
1304             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1305                 <span class="comment">% Focus the figure</span>
1306                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1307                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1308                     figure(hff)
1309                     
1310                     <span class="comment">% Make the changes to figure</span>
1311                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1312                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1313                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1314                     set(gca,<span class="string">'Color'</span>,FigColor)
1315                     set(gca,<span class="string">'XColor'</span>,AxColor)
1316                     set(gca,<span class="string">'YColor'</span>,AxColor)
1317                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1318                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1319                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1320                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1321                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1322                     
1323                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1324                     <span class="comment">% the file(s) and path for the data</span>
1325                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1326                     <span class="keyword">if</span> ~ismultiplot
1327                         filestr = guiparams.savefile;
1328                         wd = length(filestr);
1329                         hd = 1;
1330                     <span class="keyword">else</span>
1331                         <span class="comment">% Construct a filename</span>
1332                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1333                         wd        = max(cellfun(@length,filestr));
1334                         hd        = numel(filestr);
1335                             
1336                     <span class="keyword">end</span>
1337                     
1338                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1339                     disableMenuBar(hff)
1340                     set(fileinfotxt,<span class="keyword">...</span>
1341                         <span class="string">'string'</span>,filestr)
1342                     set(fileinfotxt,<span class="keyword">...</span>
1343                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1344                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1345                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1346                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1347                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1348                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1349                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1350                     
1351                 <span class="keyword">end</span>
1352             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1353                 <span class="comment">% Focus the figure</span>
1354                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1355                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1356                     figure(hff)
1357                     
1358                     <span class="comment">% Make the changes to figure</span>
1359                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1360                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1361                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1362                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1363                     set(gca,<span class="string">'XColor'</span>,AxColor)
1364                     set(gca,<span class="string">'YColor'</span>,AxColor)
1365                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1366                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1367                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1368                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1369                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1370                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1371                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1372                     
1373                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1374                     <span class="comment">% the file(s) and path for the data</span>
1375                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1376                     <span class="keyword">if</span> ~ismultiplot
1377                         filestr = guiparams.savefile;
1378                         wd = length(filestr);
1379                         hd = 1;
1380                     <span class="keyword">else</span>
1381                         <span class="comment">% Construct a filename</span>
1382                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1383                         wd        = max(cellfun(@length,filestr));
1384                         hd        = numel(filestr);
1385                             
1386                     <span class="keyword">end</span>
1387                     
1388                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1389                     disableMenuBar(hff)
1390                     set(fileinfotxt,<span class="keyword">...</span>
1391                         <span class="string">'string'</span>,filestr)
1392                     set(fileinfotxt,<span class="keyword">...</span>
1393                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1394                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1395                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1396                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1397                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1398                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1399                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1400                 <span class="keyword">end</span>
1401             <span class="keyword">otherwise</span>
1402         <span class="keyword">end</span>
1403     <span class="keyword">end</span>
1404     
1405     
1406 <span class="keyword">end</span>
1407 
1408 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1409 
1410 <span class="comment">% --------------------------------------------------------------------</span>
1411 <a name="_sub39" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1412 
1413 <span class="comment">% Get the Application data:</span>
1414 <span class="comment">% -------------------------</span>
1415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1416 
1417 <span class="comment">% Initialize the answer:</span>
1418 <span class="comment">% ----------------------</span>
1419 numstr = {num2str(guiparams.vertical_offset)};
1420 answer = NaN;
1421 <span class="keyword">while</span> isnan(answer)
1422     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1423     
1424     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1425         <span class="keyword">return</span>
1426     <span class="keyword">end</span>
1427     
1428     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1429     <span class="comment">% A numeric char will be a double</span>
1430 <span class="keyword">end</span>
1431 
1432 <span class="comment">% Re-store the Application data:</span>
1433 <span class="comment">% ------------------------------</span>
1434 guiparams.vertical_offset = answer;
1435 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1436 
1437 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1438 
1439 <span class="comment">% --------------------------------------------------------------------</span>
1440 <a name="_sub40" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1441 <span class="comment">% Not implemented</span>
1442 
1443 <span class="comment">% --------------------------------------------------------------------</span>
1444 <a name="_sub41" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1445 <span class="comment">% Empty</span>
1446 
1447 <span class="comment">% --------------------------------------------------------------------</span>
1448 <a name="_sub42" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1449 ASCII2GIS_GUI
1450 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1451 
1452 <span class="comment">% --------------------------------------------------------------------</span>
1453 <a name="_sub43" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1454 
1455 <span class="comment">% Get the Application preferences:</span>
1456 <span class="comment">% --------------------------------</span>
1457 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1458 
1459 inpath = guiprefs.kmz_path;
1460 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1461     infile = guiprefs.kmz_file{1};
1462 <span class="keyword">else</span>
1463     infile = guiprefs.kmz_file;
1464 <span class="keyword">end</span>
1465 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1466 
1467 guiprefs.kmz_path = outpath;
1468 guiprefs.kmz_file = outfile;
1469 
1470 <span class="comment">% Update persistent preferences</span>
1471 <span class="comment">% -----------------------------</span>
1472 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1473 
1474 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1475 
1476 <span class="comment">% --------------------------------------------------------------------</span>
1477 <a name="_sub44" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1478 <span class="comment">% Get the Application preferences:</span>
1479 <span class="comment">% --------------------------------</span>
1480 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1481 
1482 VMT_BatchMode;
1483 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1484 
1485 <span class="comment">% --------------------------------------------------------------------</span>
1486 <a name="_sub45" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1487 <span class="comment">% Empty</span>
1488 
1489 <span class="comment">% --------------------------------------------------------------------</span>
1490 <a name="_sub46" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1491 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1492 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1493     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version <span class="string">'.pdf'</span>]);
1494     
1495 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1496     
1497     <span class="keyword">if</span> isdeployed
1498         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1499             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1500         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1501             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1502             errLogFileName},<span class="keyword">...</span>
1503             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1504             <span class="string">'error'</span>);
1505         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1506         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1507         fclose(fid);
1508         rethrow(err)
1509     <span class="keyword">else</span>
1510         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1511             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1512             <span class="string">'error'</span>);
1513         rethrow(err);
1514     <span class="keyword">end</span>
1515 <span class="keyword">end</span>
1516 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1517 
1518 <span class="comment">% --------------------------------------------------------------------</span>
1519 <a name="_sub47" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1520 <span class="comment">% Get the Application data:</span>
1521 <span class="comment">% -------------------------</span>
1522 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1523 
1524 <span class="keyword">try</span>
1525     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1526     <span class="comment">% web-browser</span>
1527     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1528     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1529     system([<span class="string">'start '</span> webaddress]);
1530 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1531 <span class="keyword">catch</span> err 
1532     <span class="keyword">if</span> isdeployed
1533         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1534             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1535         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1536             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1537             errLogFileName},<span class="keyword">...</span>
1538             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1539             <span class="string">'error'</span>);
1540         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1541         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1542         fclose(fid);
1543         rethrow(err)
1544     <span class="keyword">else</span>
1545         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1546             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1547             <span class="string">'error'</span>);
1548         rethrow(err);
1549     <span class="keyword">end</span>
1550 <span class="keyword">end</span>
1551 
1552 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1553 
1554 <span class="comment">% --------------------------------------------------------------------</span>
1555 <a name="_sub48" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1556 
1557 <span class="comment">% Get the Application data:</span>
1558 <span class="comment">% -------------------------</span>
1559 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1560 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1561 
1562 <span class="comment">% Check version tag against the web, and display a message</span>
1563 <span class="keyword">try</span>
1564     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1565     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1566 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1567     <span class="keyword">if</span> isdeployed
1568         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1569             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1570         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1571             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1572             errLogFileName},<span class="keyword">...</span>
1573             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1574             <span class="string">'error'</span>);
1575         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1576         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1577         fclose(fid);
1578         rethrow(err)
1579     <span class="keyword">else</span>
1580         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1581             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1582             <span class="string">'error'</span>);
1583         rethrow(err);
1584     <span class="keyword">end</span>
1585 <span class="keyword">end</span>
1586 
1587 <span class="keyword">if</span> ischar(current_vmt_version)
1588     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1589         h = msgbox(<span class="keyword">...</span>
1590             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1591             <span class="string">''</span>;<span class="keyword">...</span>
1592             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1593             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1594     <span class="keyword">else</span>
1595         h = msgbox(<span class="keyword">...</span>
1596             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1597             <span class="string">''</span>;<span class="keyword">...</span>
1598             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1599             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1600     <span class="keyword">end</span>
1601 <span class="keyword">elseif</span> iscell(current_vmt_version)
1602     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1603         h = msgbox(<span class="keyword">...</span>
1604             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1605             <span class="string">''</span>;<span class="keyword">...</span>
1606             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1607             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1608     <span class="keyword">else</span>
1609         h = msgbox(<span class="keyword">...</span>
1610             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1611             <span class="string">''</span>;<span class="keyword">...</span>
1612             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1613             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1614     <span class="keyword">end</span>
1615 <span class="keyword">end</span>
1616 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1617 
1618 <span class="comment">% --------------------------------------------------------------------</span>
1619 <a name="_sub49" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1620 
1621 <span class="comment">% Get the Application data:</span>
1622 <span class="comment">% -------------------------</span>
1623 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1624 messagestr = <span class="keyword">...</span>
1625     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1626     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1627     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1628     <span class="string">''</span>;<span class="keyword">...</span>
1629     <span class="string">''</span>;<span class="keyword">...</span>
1630     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1631     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1632     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1633     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1634     <span class="string">''</span>;<span class="keyword">...</span>
1635     <span class="string">''</span>;<span class="keyword">...</span>
1636     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1637     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1638     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1639     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1640     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1641     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1642     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1643 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1644 <span class="comment">% [EOF] menuAbout_Callback</span>
1645 
1646 
1647 
1648 
1649 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1650 <span class="comment">% TOOLBAR CALLBACKS %</span>
1651 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1652 
1653 <span class="comment">% --------------------------------------------------------------------</span>
1654 <a name="_sub50" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1655 <span class="comment">% Read Files into Data Structure using tfile.</span>
1656 
1657 <span class="comment">% Get the Application data:</span>
1658 <span class="comment">% -------------------------</span>
1659 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1660 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1661 
1662 <span class="comment">% Ask the user to select files:</span>
1663 <span class="comment">% -----------------------------</span>
1664 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1665 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1666     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1667     current_file, <span class="keyword">...</span>
1668     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1669 
1670 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1671     guiparams.data_folder = pathname;
1672     <span class="keyword">if</span> ischar(filename)
1673         filename = {filename};
1674     <span class="keyword">end</span>
1675     guiparams.data_files = filename;
1676     guiparams.mat_file = <span class="string">''</span>;
1677     
1678     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1679     
1680    
1681     
1682     <span class="comment">% Update the preferences:</span>
1683     <span class="comment">% -----------------------</span>
1684     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1685     guiprefs.ascii_path = pathname;
1686     guiprefs.ascii_file = filename;
1687     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1688     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1689     
1690     <span class="comment">% Push messages to Log Window:</span>
1691     <span class="comment">% ----------------------------</span>
1692     log_text = {<span class="keyword">...</span>
1693         <span class="string">''</span>;<span class="keyword">...</span>
1694         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1695         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1696         guiparams.data_folder;
1697         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1698         char(filename)};
1699     statusLogging(handles.LogWindow, log_text)
1700     
1701     <span class="comment">% Read the file(s)</span>
1702     <span class="comment">% ----------------</span>
1703     [~,~,savefile,A,z] = <span class="keyword">...</span>
1704         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1705     guiparams.savefile = savefile;
1706     guiparams.A        = A;
1707     guiparams.z        = z;
1708     
1709     
1710     <span class="comment">% Set the vertical grid node spacing</span>
1711     <span class="comment">% ----------------------------------</span>
1712     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1713     <span class="comment">% Backwards compatible</span>
1714     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1715         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1716         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1717     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1718         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1719         guiparams.vertical_grid_node_spacing = 0.4;
1720     <span class="keyword">end</span>
1721     
1722     
1723     <span class="comment">% Save application data</span>
1724     <span class="comment">% ---------------------</span>
1725     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1726        
1727 <span class="comment">%</span>
1728 <span class="comment">%     % Preprocess the data:</span>
1729 <span class="comment">%     % --------------------</span>
1730 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1731 <span class="comment">%</span>
1732 <span class="comment">%     % Push messages to Log Window:</span>
1733 <span class="comment">%     % ----------------------------</span>
1734 <span class="comment">%     log_text = {...</span>
1735 <span class="comment">%         '   Preprocessing complete.';...</span>
1736 <span class="comment">%         '   Begin Data Processing...'};</span>
1737 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1738 <span class="comment">%</span>
1739 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1740 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1741 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1742 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1743 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1744 <span class="comment">%</span>
1745 <span class="comment">%     % Push messages to Log Window:</span>
1746 <span class="comment">%     % ----------------------------</span>
1747 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1748 <span class="comment">%</span>
1749 <span class="comment">%     % Store the data:</span>
1750 <span class="comment">%     % ---------------</span>
1751 <span class="comment">%     guiparams.z = z;</span>
1752 <span class="comment">%     guiparams.A = A;</span>
1753 <span class="comment">%     guiparams.V = V;</span>
1754 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1755     
1756           
1757     <span class="comment">% Update the GUI:</span>
1758     <span class="comment">% ---------------</span>
1759     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1760     
1761     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1762     
1763 <span class="keyword">end</span>
1764 <span class="comment">% [EOF] loadDataCallback</span>
1765 
1766 
1767 
1768 <span class="comment">% --------------------------------------------------------------------</span>
1769 <a name="_sub51" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1770 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1771 
1772 <span class="comment">% Get the Application data:</span>
1773 <span class="comment">% -------------------------</span>
1774 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1775 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1776 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1777 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1778 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1779 
1780 [the_file,the_path] = <span class="keyword">...</span>
1781     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1782     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1783     fullfile(guiparams.mat_path,guiparams.savefile));
1784 
1785 <span class="comment">% Save the processed data to a MAT file:</span>
1786 <span class="comment">% --------------------------------------</span>
1787 <span class="keyword">if</span> ischar(the_file)
1788     guiparams.mat_path = the_path;
1789     guiparams.mat_file = the_file;
1790     guiparams.savefile = the_file;
1791     
1792     <span class="comment">% Re-store the Application data:</span>
1793     <span class="comment">% ------------------------------</span>
1794     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1795     
1796     <span class="comment">% Update the preferences:</span>
1797     <span class="comment">% -----------------------</span>
1798     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1799     guiprefs.mat_path = the_path;
1800     guiprefs.mat_file = the_file;
1801     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1802     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1803     
1804     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1805     savefile = fullfile(pathstr,[filename extension]);
1806     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1807     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1808     log_text = {<span class="keyword">...</span>
1809         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1810         savefile};
1811     statusLogging(handles.LogWindow,log_text)
1812     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1813 <span class="keyword">end</span>
1814 
1815 <span class="comment">% [EOF] saveDataCallback</span>
1816 
1817 
1818 <span class="comment">% --------------------------------------------------------------------</span>
1819 <a name="_sub52" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1820 
1821 <span class="comment">% Get the Application data:</span>
1822 <span class="comment">% -------------------------</span>
1823 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1824 z   = guiparams.z;
1825 A   = guiparams.A;
1826 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1827 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1828 
1829 <span class="comment">% Compute multibeam bathymetry:</span>
1830 <span class="comment">% -----------------------------</span>
1831 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1832 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1833 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1834     guiparams.beam_angle, <span class="keyword">...</span>
1835     guiparams.magnetic_variation, <span class="keyword">...</span>
1836     guiparams.wse, <span class="keyword">...</span>
1837     guiparams.output_auxiliary_data);
1838 
1839 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1840 
1841 <span class="comment">% [EOF] saveBathymetryCallback</span>
1842 
1843 <span class="comment">% --------------------------------------------------------------------</span>
1844 <a name="_sub53" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1845 
1846 <span class="comment">% Get the Application data:</span>
1847 <span class="comment">% -------------------------</span>
1848 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1849 
1850 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1851     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1852     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1853     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1854     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1855     handles.figure1);
1856 
1857 <span class="comment">% Update the GUI:</span>
1858 <span class="comment">% ---------------</span>
1859 <span class="keyword">if</span> guiparams.english_units
1860     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1861     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1862 <span class="keyword">else</span>
1863     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1864     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1865 <span class="keyword">end</span>
1866 
1867 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1868     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1869     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1870 <span class="keyword">else</span>
1871     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1872     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1873 <span class="keyword">end</span>
1874 
1875 <span class="keyword">if</span> guiparams.presentation
1876     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1877 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1878 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1879 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1880 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1881 <span class="keyword">else</span>
1882     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1883 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1884 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1885 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1886 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1887 <span class="keyword">end</span>
1888 
1889 <span class="comment">% Re-store the Application data:</span>
1890 <span class="comment">% ------------------------------</span>
1891 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1892 
1893 <span class="comment">% [EOF] plottingParametersCallback</span>
1894 
1895 
1896 <span class="comment">% --------------------------------------------------------------------</span>
1897 <a name="_sub54" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1898 
1899 <span class="comment">% Get the Application data:</span>
1900 <span class="comment">% -------------------------</span>
1901 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1902 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1903 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1904 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1905 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1906 
1907 <span class="comment">% [EOF] processingParametersCallback</span>
1908 
1909 
1910 <span class="comment">% --------------------------------------------------------------------</span>
1911 <a name="_sub55" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1912 <span class="comment">% Plot 1</span>
1913 
1914 <span class="comment">% Get the Application data:</span>
1915 <span class="comment">% -------------------------</span>
1916 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1917 z = guiparams.z;
1918 A = guiparams.A;
1919 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1920 <span class="comment">% Map = guiparams.Map;</span>
1921 
1922 
1923 <span class="comment">% Preprocess the data:</span>
1924 <span class="comment">% --------------------</span>
1925 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1926 
1927 <span class="comment">% Push messages to Log Window:</span>
1928 <span class="comment">% ----------------------------</span>
1929 log_text = {<span class="keyword">...</span>
1930     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1931     <span class="string">'   Begin Data Processing...'</span>};
1932 statusLogging(handles.LogWindow, log_text)
1933 
1934 <span class="comment">% Process the transects:</span>
1935 <span class="comment">% ----------------------</span>
1936 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1937 A(1).vgns = guiparams.vertical_grid_node_spacing;
1938 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1939 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1940     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1941 
1942 <span class="comment">% Compute the smoothed variables</span>
1943 <span class="comment">% ------------------------------</span>
1944 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1945 <span class="comment">% runtime.</span>
1946 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1947     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1948     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1949     guiparams.vertical_smoothing_window);
1950 
1951 <span class="comment">% Push messages to Log Window:</span>
1952 <span class="comment">% ----------------------------</span>
1953 statusLogging(handles.LogWindow, processing_log_text)
1954 
1955 <span class="comment">% Store the data:</span>
1956 <span class="comment">% ---------------</span>
1957 guiparams.z = z;
1958 guiparams.A = A;
1959 guiparams.V = V;
1960 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1961 
1962 <span class="comment">% Push messages to Log Window:</span>
1963 <span class="comment">% ----------------------------</span>
1964 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1965 statusLogging(handles.LogWindow, log_text)
1966 
1967 <span class="comment">% Create or replot the Shiptracks</span>
1968 <span class="comment">% -------------------------------</span>
1969 <span class="comment">% Grab the axes to the plot</span>
1970 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1971 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1972 
1973 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1974 <span class="comment">% New plot display window</span>
1975 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1976 <span class="comment">% h = figure(1); clf</span>
1977 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1978 
1979 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1980 
1981 
1982 <span class="comment">% --------------------------------------------------------------------</span>
1983 <a name="_sub56" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1984 <span class="comment">% Plot 2</span>
1985 
1986 <span class="comment">% Get the Application data:</span>
1987 <span class="comment">% -------------------------</span>
1988 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1989 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1990 
1991 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1992     <span class="comment">% Push messages to Log Window:</span>
1993     <span class="comment">% ----------------------------</span>
1994     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1995     statusLogging(handles.LogWindow, log_text)
1996     
1997        
1998     <span class="comment">% Push plotting parameters to log window:</span>
1999     <span class="comment">% ---------------------------------------</span>
2000     log_text = {<span class="keyword">...</span>
2001         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2002         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2003         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2004         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2005         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2006         };
2007     statusLogging(handles.LogWindow, log_text)
2008     
2009     <span class="comment">% Plot the data:</span>
2010     <span class="comment">% --------------</span>
2011     z = [];
2012     A = [];
2013     V = [];
2014     Map = [];
2015     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2016     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2017         depth_range, <span class="keyword">...</span>
2018         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2019         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2020         guiparams.smoothing_window_size, <span class="keyword">...</span>
2021         guiparams.display_shoreline, <span class="keyword">...</span>
2022         guiparams.english_units, <span class="keyword">...</span>
2023         guiparams.mat_file, <span class="keyword">...</span>
2024         guiparams.mat_path); <span class="comment">% PLOT2</span>
2025     statusLogging(handles.LogWindow, log_text)
2026     
2027     <span class="comment">% Plot a Shoreline Map:</span>
2028     <span class="comment">% ---------------------</span>
2029     <span class="keyword">if</span> guiparams.display_shoreline
2030         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2031             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2032             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2033             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2034         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2035             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2036             Map.UTMe   = mapdata(:,1);
2037             Map.UTMn   = mapdata(:,2);
2038             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2039             <span class="comment">%Map.UTMzone = zone;</span>
2040         <span class="keyword">else</span>
2041             Map = [];
2042         <span class="keyword">end</span>
2043         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2044         log_text = {<span class="keyword">...</span>
2045             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2046             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2047             };
2048         statusLogging(handles.LogWindow, log_text)
2049     <span class="keyword">else</span>
2050         Map = [];
2051     <span class="keyword">end</span>
2052     
2053 <span class="keyword">else</span>
2054     z = guiparams.z;
2055     A = guiparams.A;
2056     <span class="comment">% V = guiparams.V;</span>
2057     Map = guiparams.Map;
2058     
2059     <span class="comment">% Push messages to Log Window:</span>
2060     <span class="comment">% ----------------------------</span>
2061     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2062     statusLogging(handles.LogWindow, log_text)
2063     
2064         
2065     <span class="comment">% Preprocess the data:</span>
2066     <span class="comment">% --------------------</span>
2067     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2068     
2069     <span class="comment">% Process the transects:</span>
2070     <span class="comment">% ----------------------</span>
2071     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2072     A(1).vgns = guiparams.vertical_grid_node_spacing;
2073     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2074     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2075         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2076     
2077     <span class="comment">% Compute the smoothed variables</span>
2078     <span class="comment">% ------------------------------</span>
2079     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2080     <span class="comment">% runtime.</span>
2081     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2082         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2083         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2084         guiparams.vertical_smoothing_window);
2085     
2086     <span class="comment">% Push messages to Log Window:</span>
2087     <span class="comment">% ----------------------------</span>
2088     statusLogging(handles.LogWindow, processing_log_text)
2089     
2090     <span class="comment">% Plot the cross section:</span>
2091     <span class="comment">% -----------------------</span>
2092     log_text = {<span class="keyword">...</span>
2093         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2094         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2095         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2096         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2097         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2098         };
2099     statusLogging(handles.LogWindow, log_text)
2100     
2101     <span class="comment">% Plot the data:</span>
2102     <span class="comment">% --------------</span>
2103     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2104     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2105     
2106     
2107     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2108         depth_range, <span class="keyword">...</span>
2109         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2110         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2111         guiparams.smoothing_window_size, <span class="keyword">...</span>
2112         guiparams.display_shoreline, <span class="keyword">...</span>
2113         guiparams.english_units, <span class="keyword">...</span>
2114         guiparams.mat_file, <span class="keyword">...</span>
2115         guiparams.mat_path); <span class="comment">% PLOT2</span>
2116     statusLogging(handles.LogWindow, log_text)
2117     
2118     <span class="comment">% Plot User Set Endpoints</span>
2119     <span class="comment">% -----------------------</span>
2120     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2121         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2122         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2123         x = data(:,1);
2124         y = data(:,2);
2125         
2126         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2127         figure(fh); hold on
2128         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2129         hold off
2130     <span class="keyword">end</span>
2131     
2132     <span class="comment">% Plot a Shoreline Map:</span>
2133     <span class="comment">% ---------------------</span>
2134     <span class="keyword">if</span> guiparams.display_shoreline
2135         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2136             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2137             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2138             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2139         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2140             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2141             Map.UTMe   = mapdata(:,1);
2142             Map.UTMn   = mapdata(:,2);
2143             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2144             <span class="comment">%Map.UTMzone = zone;</span>
2145         <span class="keyword">else</span>
2146             Map = [];
2147         <span class="keyword">end</span>
2148         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2149         log_text = {<span class="keyword">...</span>
2150             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2151             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2152             };
2153         statusLogging(handles.LogWindow, log_text)
2154     <span class="keyword">else</span>
2155         Map = [];
2156     <span class="keyword">end</span>
2157     
2158 <span class="keyword">end</span>
2159 
2160 <span class="keyword">if</span> guiparams.add_background
2161     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2162     statusLogging(handles.LogWindow, log_text)
2163 <span class="keyword">end</span>
2164 
2165 <span class="comment">% Update guiparams</span>
2166 <span class="comment">% ----------------</span>
2167 guiparams.z   = z;
2168 guiparams.A   = A;
2169 guiparams.V   = V;
2170 guiparams.Map = Map;
2171 guiparams.iric_anv_planview_data = PVdata;
2172 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2173 
2174 <span class="comment">% Update preferences</span>
2175 <span class="comment">% ------------------</span>
2176 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2177 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2178 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2179 
2180 <span class="comment">% Force plot to be formated properly</span>
2181 <span class="comment">% ----------------------------------</span>
2182 <span class="keyword">if</span> guiparams.presentation
2183     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2184 <span class="keyword">else</span>
2185     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2186 <span class="keyword">end</span>
2187 <span class="keyword">switch</span> guiparams.renderer
2188     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2189         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2190     <span class="keyword">case</span> <span class="string">'painters'</span>
2191         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2192     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2193         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2194 <span class="keyword">end</span>
2195 
2196 <span class="comment">% Focus the figure</span>
2197 <span class="comment">% ----------------</span>
2198 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2199 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2200     figure(hff)
2201 <span class="keyword">end</span>
2202 
2203 <span class="comment">% Start the Graphics Control Gui</span>
2204 <span class="comment">% ------------------------------</span>
2205 VMT_GraphicsControl
2206 
2207 <span class="comment">% [EOF] planviewPlotCallback</span>
2208 
2209 
2210 <span class="comment">% --------------------------------------------------------------------</span>
2211 <a name="_sub57" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2212 <span class="comment">% Plot 3</span>
2213 
2214 <span class="comment">% Get the Application data:</span>
2215 <span class="comment">% -------------------------</span>
2216 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2217 z = guiparams.z;
2218 A = guiparams.A;
2219 <span class="comment">% V = guiparams.V;</span>
2220 <span class="comment">% Map = guiparams.Map;</span>
2221 
2222 <span class="comment">% Preprocess the data:</span>
2223 <span class="comment">% --------------------</span>
2224 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2225 
2226 <span class="comment">% Push messages to Log Window:</span>
2227 <span class="comment">% ----------------------------</span>
2228 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2229 statusLogging(handles.LogWindow, log_text)
2230 
2231 <span class="comment">% Process the transects:</span>
2232 <span class="comment">% ----------------------</span>
2233 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2234 A(1).vgns = guiparams.vertical_grid_node_spacing;
2235 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2236 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2237     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2238 
2239 <span class="comment">% Push messages to Log Window:</span>
2240 <span class="comment">% ----------------------------</span>
2241 statusLogging(handles.LogWindow, processing_log_text)
2242 
2243 <span class="comment">% Plot the cross section:</span>
2244 <span class="comment">% -----------------------</span>
2245 log_text = {<span class="keyword">...</span>
2246     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2247     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2248     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2249     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2250     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2251     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2252     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2253     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2254     };
2255 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2256     log_text = vertcat(log_text, {<span class="keyword">...</span>
2257         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2258         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2259         });
2260 <span class="keyword">end</span>
2261 <span class="comment">% Push messages to Log Window:</span>
2262 <span class="comment">% ----------------------------</span>
2263 statusLogging(handles.LogWindow, log_text)
2264 
2265 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2266     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2267 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2268 <span class="comment">%         ...guiparams.contour, ...</span>
2269 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2270 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2271     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2272         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2273         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2274         guiparams.vertical_smoothing_window);
2275     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2276         guiparams.contour, <span class="keyword">...</span>
2277         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2278         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2279         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2280         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2281         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2282         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2283         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2284     
2285 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2286     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2287         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2288         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2289         guiparams.vertical_smoothing_window);
2290     
2291     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2292         guiparams.contour, <span class="keyword">...</span>
2293         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2294         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2295     
2296     guiparams.zmin = zmin;
2297     guiparams.zmax = zmax;
2298     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2299 <span class="keyword">end</span>
2300 
2301 <span class="comment">% Force plot to be formated properly</span>
2302 <span class="comment">% ----------------------------------</span>
2303 <span class="keyword">if</span> guiparams.presentation
2304     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2305 <span class="keyword">else</span>
2306     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2307 <span class="keyword">end</span>
2308 <span class="keyword">switch</span> guiparams.renderer
2309     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2310         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2311     <span class="keyword">case</span> <span class="string">'painters'</span>
2312         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2313     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2314         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2315 <span class="keyword">end</span>
2316 
2317 <span class="comment">% Focus the figure</span>
2318 <span class="comment">% ----------------</span>
2319 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2320 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2321     figure(hff)
2322 <span class="keyword">end</span>
2323 
2324 <span class="comment">% Re-store the Application data:</span>
2325 <span class="comment">% ------------------------------</span>
2326 guiparams.V = V;
2327 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2328 
2329 <span class="comment">% Start the Graphics Control Gui</span>
2330 <span class="comment">% ------------------------------</span>
2331 VMT_GraphicsControl
2332 
2333 <span class="comment">% Push messages to Log Window:</span>
2334 <span class="comment">% ----------------------------</span>
2335 statusLogging(handles.LogWindow, plot_cont_log_text)
2336 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2337 
2338 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2339 
2340 
2341 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2342 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2343 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2344 
2345 <span class="comment">% --------------------------------------------------------------------</span>
2346 <a name="_sub58" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2347 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2348 
2349 <span class="comment">% Get the Application data:</span>
2350 <span class="comment">% -------------------------</span>
2351 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2352 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2353 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2354 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2355 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2356 
2357 [the_file,the_path] = <span class="keyword">...</span>
2358     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2359     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2360     fullfile(guiparams.mat_path,guiparams.savefile));
2361 
2362 <span class="comment">% Save the processed data to a MAT file:</span>
2363 <span class="comment">% --------------------------------------</span>
2364 <span class="keyword">if</span> ischar(the_file)
2365     guiparams.mat_path = the_path;
2366     guiparams.mat_file = the_file;
2367     guiparams.savefile = the_file;
2368     
2369     <span class="comment">% Re-store the Application data:</span>
2370     <span class="comment">% ------------------------------</span>
2371     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2372     
2373     <span class="comment">% Update the preferences:</span>
2374     <span class="comment">% -----------------------</span>
2375     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2376     guiprefs.mat_path = the_path;
2377     guiprefs.mat_file = the_file;
2378     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2379     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2380     
2381     [~,filename,extension] = fileparts(guiparams.savefile);
2382     savefile = [filename extension];
2383     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2384         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2385     disp(<span class="string">'Saving Processed Data File...'</span>)
2386     disp(savefile)
2387     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2388 <span class="keyword">end</span>
2389 
2390 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2391 
2392 
2393 <span class="comment">% --------------------------------------------------------------------</span>
2394 <a name="_sub59" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2395 
2396 <span class="comment">% Get the Application data:</span>
2397 <span class="comment">% -------------------------</span>
2398 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2399 <span class="comment">% z   = guiparams.z;</span>
2400 <span class="comment">% A   = guiparams.A;</span>
2401 V   = guiparams.V;
2402 <span class="comment">% Map = guiparams.Map;</span>
2403 
2404 [the_file,the_path] = <span class="keyword">...</span>
2405     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2406     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2407     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2408 
2409 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2410 <span class="comment">% ------------------------------------------</span>
2411 <span class="keyword">if</span> ischar(the_file)
2412     guiparams.tecplot_path = the_path;
2413     guiparams.tecplot_file = the_file;
2414     
2415     <span class="comment">% Re-store the Application data:</span>
2416     <span class="comment">% ------------------------------</span>
2417     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2418     
2419     <span class="comment">% Update the preferences:</span>
2420     <span class="comment">% -----------------------</span>
2421     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2422     guiprefs.tecplot_path = the_path;
2423     guiprefs.tecplot_file = the_file;
2424     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2425     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2426     
2427     <span class="comment">% Push to log window</span>
2428     <span class="comment">% ------------------</span>
2429     log_text = {<span class="keyword">...</span>
2430         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2431         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2432         the_path;<span class="keyword">...</span>
2433         [<span class="string">'Filename: '</span> the_file]};
2434     statusLogging(handles.LogWindow,log_text)
2435         
2436     <span class="keyword">if</span> isempty(V)
2437         A = guiparams.A;
2438         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2439         A(1).vgns = guiparams.vertical_grid_node_spacing;
2440         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2441         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2442             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2443             guiparams.unit_discharge_correction);
2444     <span class="keyword">end</span>
2445     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2446     
2447     <span class="comment">% Push to log window</span>
2448     <span class="comment">% ------------------</span>
2449     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2450     statusLogging(handles.LogWindow,log_text)
2451     
2452     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2453     
2454     <span class="comment">% Push to log window</span>
2455     <span class="comment">% ------------------</span>
2456     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2457     statusLogging(handles.LogWindow,log_text)
2458    
2459 <span class="keyword">end</span>
2460 
2461 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2462 
2463 
2464 <span class="comment">% --------------------------------------------------------------------</span>
2465 <a name="_sub60" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2466 
2467 <span class="comment">% Get the Application data:</span>
2468 <span class="comment">% -------------------------</span>
2469 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2470 <span class="comment">% z   = guiparams.z;</span>
2471 A   = guiparams.A;
2472 V   = guiparams.V;
2473 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2474 
2475 [the_file,the_path] = <span class="keyword">...</span>
2476     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2477     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2478     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2479 
2480 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2481 <span class="comment">% -----------------------------------------------------</span>
2482 <span class="keyword">if</span> ischar(the_file)
2483     guiparams.kmz_path = the_path;
2484     guiparams.kmz_file = the_file;
2485     
2486     <span class="comment">% Re-store the Application data:</span>
2487     <span class="comment">% ------------------------------</span>
2488     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2489     
2490     <span class="comment">% Update the preferences:</span>
2491     <span class="comment">% -----------------------</span>
2492     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2493     guiprefs.kmz_path = the_path;
2494     guiprefs.kmz_file = the_file;
2495     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2496     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2497     
2498     <span class="comment">%     if guiparams.display_shoreline</span>
2499     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2500     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2501     <span class="comment">%                             guiparams.vertical_offset);</span>
2502     <span class="comment">%     end</span>
2503     <span class="keyword">if</span> isempty(V)
2504         A = guiparams.A;
2505         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2506         A(1).vgns = guiparams.vertical_grid_node_spacing;
2507         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2508         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2509             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2510             guiparams.unit_discharge_correction);
2511     <span class="keyword">end</span>
2512     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2513         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2514         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2515         guiparams.vertical_offset);
2516 <span class="keyword">end</span>
2517 
2518 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2519 
2520 
2521 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2522 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2523 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2524 
2525 <span class="comment">% --------------------------------------------------------------------</span>
2526 <a name="_sub61" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2527 
2528 <span class="comment">% Get the Application data:</span>
2529 <span class="comment">% -------------------------</span>
2530 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2531 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2532 z = guiparams.z;
2533 A = guiparams.A;
2534 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2535 <span class="comment">% Map = guiparams.Map;</span>
2536 setends = guiparams.set_cross_section_endpoints;
2537 
2538 [the_file,the_path] = <span class="keyword">...</span>
2539     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2540     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2541     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2542     guiprefs.multibeambathymetry_file));
2543 
2544 <span class="keyword">if</span> ischar(the_file)
2545     guiparams.multibeambathymetry_path = the_path;
2546     guiparams.multibeambathymetry_file = the_file;
2547     
2548     <span class="comment">% Re-store the Application data:</span>
2549     <span class="comment">% ------------------------------</span>
2550     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2551     
2552     <span class="comment">% Update the preferences:</span>
2553     <span class="comment">% -----------------------</span>
2554     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2555     guiprefs.multibeambathymetry_path = the_path;
2556     guiprefs.multibeambathymetry_file = the_file;
2557     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2558     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2559     
2560     <span class="keyword">if</span> guiparams.output_auxiliary_data
2561     <span class="keyword">end</span>
2562     
2563     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2564     
2565     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2566         guiparams.multibeambathymetry_file);
2567     
2568     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2569         [<span class="string">'   '</span> savefile]};
2570     statusLogging(handles.LogWindow,log_text)
2571     
2572     <span class="comment">% Process the transects:</span>
2573     <span class="comment">% ----------------------</span>
2574     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2575     A(1).vgns = guiparams.vertical_grid_node_spacing;
2576     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2577     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2578         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2579     
2580     <span class="comment">% Compute the smoothed variables</span>
2581     <span class="comment">% ------------------------------</span>
2582     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2583     <span class="comment">% runtime.</span>
2584     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2585         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2586         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2587         guiparams.vertical_smoothing_window);
2588     
2589     <span class="comment">% Push messages to Log Window:</span>
2590     <span class="comment">% ----------------------------</span>
2591     statusLogging(handles.LogWindow, processing_log_text)
2592 
2593     
2594     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2595         guiparams.A, <span class="keyword">...</span>
2596         savefile, <span class="keyword">...</span>
2597         guiparams.beam_angle, <span class="keyword">...</span>
2598         guiparams.magnetic_variation, <span class="keyword">...</span>
2599         guiparams.wse, <span class="keyword">...</span>
2600         guiparams.output_auxiliary_data);
2601     
2602     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2603     
2604 <span class="keyword">end</span>
2605 
2606 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2607 
2608 
2609 <span class="comment">% --------------------------------------------------------------------</span>
2610 <a name="_sub62" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2611 <span class="comment">% Get the beam angle</span>
2612 
2613 <span class="comment">% Get the Application data:</span>
2614 <span class="comment">% -------------------------</span>
2615 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2616 
2617 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2618 <span class="comment">% ----------------------------------------------------------------</span>
2619 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2620 is_a_number = ~isnan(new_beam_angle);
2621 is_positive = new_beam_angle&gt;=0;
2622 
2623 <span class="comment">% Modify the Application data:</span>
2624 <span class="comment">% ----------------------------</span>
2625 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2626     guiparams.beam_angle = new_beam_angle;
2627     
2628     <span class="comment">% Re-store the Application data:</span>
2629     <span class="comment">% ------------------------------</span>
2630     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2631     
2632 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2633     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2634 <span class="keyword">end</span>
2635 
2636 <span class="comment">% [EOF] BeamAngle_Callback</span>
2637 
2638 
2639 <span class="comment">% --------------------------------------------------------------------</span>
2640 <a name="_sub63" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2641 <span class="comment">% Get the Magnetic Variation</span>
2642 
2643 <span class="comment">% Get the Application data:</span>
2644 <span class="comment">% -------------------------</span>
2645 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2646 
2647 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2648 <span class="comment">% ----------------------------------------------------------------</span>
2649 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2650 is_a_number = ~isnan(new_magnetic_variation);
2651 is_positive = new_magnetic_variation&gt;=0;
2652 
2653 <span class="comment">% Modify the Application data:</span>
2654 <span class="comment">% ----------------------------</span>
2655 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2656     guiparams.magnetic_variation = new_magnetic_variation;
2657     
2658     <span class="comment">% Re-store the Application data:</span>
2659     <span class="comment">% ------------------------------</span>
2660     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2661     
2662 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2663     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2664 <span class="keyword">end</span>
2665 
2666 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2667 
2668 
2669 <span class="comment">% --------------------------------------------------------------------</span>
2670 <a name="_sub64" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2671 
2672 <span class="comment">% Get the Application data:</span>
2673 <span class="comment">% -------------------------</span>
2674 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2675 
2676 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2677 <span class="comment">% ----------------------------------------------------------------</span>
2678 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2679 is_a_number = ~isnan(new_wse);
2680 is_positive = new_wse&gt;=0;
2681 
2682 <span class="comment">% Modify the Application data:</span>
2683 <span class="comment">% ----------------------------</span>
2684 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2685     guiparams.wse = new_wse;
2686     
2687     <span class="comment">% Re-store the Application data:</span>
2688     <span class="comment">% ------------------------------</span>
2689     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2690     
2691 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2692     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2693 <span class="keyword">end</span>
2694 
2695 <span class="comment">% [EOF] WSE_Callback</span>
2696 
2697 
2698 <span class="comment">% --------------------------------------------------------------------</span>
2699 <a name="_sub65" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2700 <span class="comment">% Bathymetry Auxiliary Data</span>
2701 
2702 <span class="comment">% Get the Application data:</span>
2703 <span class="comment">% -------------------------</span>
2704 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2705 
2706 <span class="comment">% Modify the Application data:</span>
2707 <span class="comment">% ----------------------------</span>
2708 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2709 
2710 <span class="comment">% Re-store the Application data:</span>
2711 <span class="comment">% ------------------------------</span>
2712 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2713 
2714 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2715 
2716 
2717 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2718 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2719 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2720 
2721 <span class="comment">% --------------------------------------------------------------------</span>
2722 <a name="_sub66" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2723 
2724 <span class="comment">% Get the Application data:</span>
2725 <span class="comment">% -------------------------</span>
2726 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2727 
2728 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2729 <span class="comment">% ----------------------------------------------------------------</span>
2730 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2731 is_a_number = ~isnan(new_depth_range_min);
2732 is_positive = new_depth_range_min&gt;=0;
2733 
2734 <span class="comment">% Modify the Application data:</span>
2735 <span class="comment">% ----------------------------</span>
2736 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2737     guiparams.depth_range_min = new_depth_range_min;
2738     
2739     <span class="comment">% Re-store the Application data:</span>
2740     <span class="comment">% ------------------------------</span>
2741     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2742     
2743 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2744     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2745 <span class="keyword">end</span>
2746 
2747 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2748 
2749 
2750 <span class="comment">% --------------------------------------------------------------------</span>
2751 <a name="_sub67" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2752 
2753 <span class="comment">% Get the Application data:</span>
2754 <span class="comment">% -------------------------</span>
2755 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2756 
2757 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2758 <span class="comment">% ----------------------------------------------------------------</span>
2759 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2760 is_a_number = ~isnan(new_depth_range_max);
2761 is_positive = new_depth_range_max&gt;=0;
2762 
2763 <span class="comment">% Modify the Application data:</span>
2764 <span class="comment">% ----------------------------</span>
2765 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2766     guiparams.depth_range_max = new_depth_range_max;
2767     
2768     <span class="comment">% Re-store the Application data:</span>
2769     <span class="comment">% ------------------------------</span>
2770     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2771     
2772 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2773     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2774 <span class="keyword">end</span>
2775 
2776 <span class="comment">% [EOF] DepthMax_Callback</span>
2777 
2778 
2779 <span class="comment">% --------------------------------------------------------------------</span>
2780 <a name="_sub68" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2781 <span class="comment">% Set quiver scale (contour)</span>
2782 
2783 <span class="comment">% Get the Application data:</span>
2784 <span class="comment">% -------------------------</span>
2785 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2786 
2787 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2788 <span class="comment">% ----------------------------------------------------------------</span>
2789 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2790 is_a_number = ~isnan(new_vector_scale_plan_view);
2791 is_positive = new_vector_scale_plan_view&gt;=0;
2792 
2793 <span class="comment">% Modify the Application data:</span>
2794 <span class="comment">% ----------------------------</span>
2795 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2796     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2797     
2798     <span class="comment">% Re-store the Application data:</span>
2799     <span class="comment">% ------------------------------</span>
2800     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2801     
2802 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2803     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2804 <span class="keyword">end</span>
2805 
2806 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2807 
2808 
2809 <span class="comment">% --------------------------------------------------------------------</span>
2810 <a name="_sub69" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2811 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2812 
2813 <span class="comment">% Get the Application data:</span>
2814 <span class="comment">% -------------------------</span>
2815 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2816 
2817 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2818 <span class="comment">% ----------------------------------------------------------------</span>
2819 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2820 is_a_number = ~isnan(new_vector_spacing_plan_view);
2821 is_positive = new_vector_spacing_plan_view&gt;=0;
2822 
2823 <span class="comment">% Modify the Application data:</span>
2824 <span class="comment">% ----------------------------</span>
2825 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2826     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2827     
2828     <span class="comment">% Re-store the Application data:</span>
2829     <span class="comment">% ------------------------------</span>
2830     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2831     
2832 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2833     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2834 <span class="keyword">end</span>
2835 
2836 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2837 
2838 
2839 <span class="comment">% --------------------------------------------------------------------</span>
2840 <a name="_sub70" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2841 <span class="comment">% Plan View smoothing window size</span>
2842 
2843 <span class="comment">% Get the Application data:</span>
2844 <span class="comment">% -------------------------</span>
2845 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2846 
2847 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2848 <span class="comment">% ----------------------------------------------------------------</span>
2849 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2850 is_a_number = ~isnan(new_smoothing_window_size);
2851 is_positive = new_smoothing_window_size&gt;=0;
2852 
2853 <span class="comment">% Modify the Application data:</span>
2854 <span class="comment">% ----------------------------</span>
2855 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2856     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2857     
2858     <span class="comment">% Re-store the Application data:</span>
2859     <span class="comment">% ------------------------------</span>
2860     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2861     
2862 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2863     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2864 <span class="keyword">end</span>
2865 
2866 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2867 
2868 
2869 <span class="comment">% --------------------------------------------------------------------</span>
2870 <a name="_sub71" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2871 
2872 <span class="comment">% Get the Application data:</span>
2873 <span class="comment">% -------------------------</span>
2874 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2875 
2876 <span class="comment">% Modify the Application data:</span>
2877 <span class="comment">% ----------------------------</span>
2878 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2879 
2880 <span class="comment">% Re-store the Application data:</span>
2881 <span class="comment">% ------------------------------</span>
2882 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2883 
2884 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2885 
2886 
2887 <span class="comment">% --------------------------------------------------------------------</span>
2888 <a name="_sub72" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2889 
2890 <span class="comment">% Get the Application data:</span>
2891 <span class="comment">% -------------------------</span>
2892 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2893 
2894 <span class="comment">% Modify the Application data:</span>
2895 <span class="comment">% ----------------------------</span>
2896 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2897 
2898 <span class="comment">% Re-store the Application data:</span>
2899 <span class="comment">% ------------------------------</span>
2900 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2901 
2902 <span class="comment">% [EOF] AddBackground_Callback</span>
2903 
2904 
2905 <span class="comment">% --------------------------------------------------------------------</span>
2906 <a name="_sub73" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2907 <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2908 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2909 
2910 
2911 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2912 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2913 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2914 
2915 <span class="comment">% --------------------------------------------------------------------</span>
2916 <a name="_sub74" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2917 <span class="comment">% Set the horizontal grid node spacing</span>
2918 
2919 <span class="comment">% Get the Application data:</span>
2920 <span class="comment">% -------------------------</span>
2921 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2922 
2923 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2924 <span class="comment">% ----------------------------------------------------------------</span>
2925 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2926 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2927 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2928 
2929 <span class="comment">% Modify the Application data:</span>
2930 <span class="comment">% ----------------------------</span>
2931 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2932     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
2933     
2934     <span class="comment">% Re-store the Application data:</span>
2935     <span class="comment">% ------------------------------</span>
2936     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2937     
2938 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2939     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2940 <span class="keyword">end</span>
2941 
2942 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2943 
2944 <span class="comment">% --------------------------------------------------------------------</span>
2945 <a name="_sub75" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2946 <span class="comment">% Set the horizontal grid node spacing</span>
2947 
2948 <span class="comment">% Get the Application data:</span>
2949 <span class="comment">% -------------------------</span>
2950 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2951 
2952 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2953 <span class="comment">% ----------------------------------------------------------------</span>
2954 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2955 is_a_number = ~isnan(new_vertical_grid_node_spacing);
2956 is_positive = new_vertical_grid_node_spacing&gt;=0;
2957 
2958 <span class="comment">% Modify the Application data:</span>
2959 <span class="comment">% ----------------------------</span>
2960 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2961     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
2962     
2963     <span class="comment">% Re-store the Application data:</span>
2964     <span class="comment">% ------------------------------</span>
2965     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2966     
2967 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2968     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
2969 <span class="keyword">end</span>
2970 
2971 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
2972 
2973 <span class="comment">% --------------------------------------------------------------------</span>
2974 <a name="_sub76" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2975 <span class="comment">% Set the cross section endpoints manually</span>
2976 
2977 <span class="comment">% Get the Application data:</span>
2978 <span class="comment">% -------------------------</span>
2979 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2980 
2981 <span class="comment">% Modify the Application data:</span>
2982 <span class="comment">% ----------------------------</span>
2983 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2984 
2985 <span class="comment">% Re-store the Application data:</span>
2986 <span class="comment">% ------------------------------</span>
2987 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2988 
2989 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2990 
2991 
2992 <span class="comment">% --------------------------------------------------------------------</span>
2993 <a name="_sub77" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2994 <a href="#_sub55" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2995 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2996 
2997 
2998 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2999 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3000 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3001 
3002 <span class="comment">% --------------------------------------------------------------------</span>
3003 <a name="_sub78" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3004 
3005 <span class="comment">% Get the Application data:</span>
3006 <span class="comment">% -------------------------</span>
3007 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3008 
3009 <span class="comment">% Modify the Application data:</span>
3010 <span class="comment">% ----------------------------</span>
3011 idx_variable = get(hObject,<span class="string">'Value'</span>);
3012 guiparams.idx_contour = idx_variable;
3013 guiparams.contour = guiparams.contours(idx_variable).variable;
3014 
3015 <span class="comment">% Re-store the Application data:</span>
3016 <span class="comment">% ------------------------------</span>
3017 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3018 
3019 <span class="comment">% [EOF] Contour_Callback</span>
3020 
3021 
3022 <span class="comment">% --------------------------------------------------------------------</span>
3023 <a name="_sub79" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3024 <span class="comment">% Set vertical exaggeration</span>
3025 
3026 <span class="comment">% Get the Application data:</span>
3027 <span class="comment">% -------------------------</span>
3028 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3029 
3030 <span class="comment">% Modify the Application data:</span>
3031 <span class="comment">% ----------------------------</span>
3032 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3033 
3034 <span class="comment">% Re-store the Application data:</span>
3035 <span class="comment">% ------------------------------</span>
3036 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3037 
3038 <span class="comment">% Update the GUI:</span>
3039 <span class="comment">% ---------------</span>
3040 <span class="comment">% updateGUI(handles,guiparams)</span>
3041 
3042 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3043 
3044 
3045 <span class="comment">% --------------------------------------------------------------------</span>
3046 <a name="_sub80" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3047 
3048 <span class="comment">% Get the Application data:</span>
3049 <span class="comment">% -------------------------</span>
3050 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3051 
3052 <span class="comment">% Modify the Application data:</span>
3053 <span class="comment">% ----------------------------</span>
3054 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3055 
3056 <span class="comment">% Re-store the Application data:</span>
3057 <span class="comment">% ------------------------------</span>
3058 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3059 
3060 <span class="comment">% Update the GUI:</span>
3061 <span class="comment">% ---------------</span>
3062 <span class="comment">% updateGUI(handles,guiparams)</span>
3063 
3064 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3065 
3066 
3067 <span class="comment">% --------------------------------------------------------------------</span>
3068 <a name="_sub81" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3069 
3070 <span class="comment">% Get the Application data:</span>
3071 <span class="comment">% -------------------------</span>
3072 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3073 
3074 <span class="comment">% Modify the Application data:</span>
3075 <span class="comment">% ----------------------------</span>
3076 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3077 
3078 <span class="comment">% Re-store the Application data:</span>
3079 <span class="comment">% ------------------------------</span>
3080 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3081 
3082 <span class="comment">% Update the GUI:</span>
3083 <span class="comment">% ---------------</span>
3084 <span class="comment">% updateGUI(handles,guiparams)</span>
3085 
3086 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3087 
3088 
3089 <span class="comment">% --------------------------------------------------------------------</span>
3090 <a name="_sub82" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3091 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3092 
3093 <span class="comment">% Get the Application data:</span>
3094 <span class="comment">% -------------------------</span>
3095 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3096 
3097 <span class="comment">% Modify the Application data:</span>
3098 <span class="comment">% ----------------------------</span>
3099 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3100 
3101 <span class="comment">% Re-store the Application data:</span>
3102 <span class="comment">% ------------------------------</span>
3103 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3104 
3105 <span class="comment">% Update the GUI:</span>
3106 <span class="comment">% ---------------</span>
3107 <span class="comment">% updateGUI(handles,guiparams)</span>
3108 
3109 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3110 
3111 
3112 <span class="comment">% --------------------------------------------------------------------</span>
3113 <a name="_sub83" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3114 <span class="comment">% Horizontal Smoothing</span>
3115 
3116 <span class="comment">% Get the Application data:</span>
3117 <span class="comment">% -------------------------</span>
3118 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3119 
3120 <span class="comment">% Modify the Application data:</span>
3121 <span class="comment">% ----------------------------</span>
3122 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3123 
3124 <span class="comment">% Re-store the Application data:</span>
3125 <span class="comment">% ------------------------------</span>
3126 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3127 
3128 <span class="comment">% Update the GUI:</span>
3129 <span class="comment">% ---------------</span>
3130 <span class="comment">% updateGUI(handles,guiparams)</span>
3131 
3132 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3133 
3134 
3135 <span class="comment">% --------------------------------------------------------------------</span>
3136 <a name="_sub84" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3137 <span class="comment">% Vertical Smoothing</span>
3138 
3139 <span class="comment">% Get the Application data:</span>
3140 <span class="comment">% -------------------------</span>
3141 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3142 
3143 <span class="comment">% Modify the Application data:</span>
3144 <span class="comment">% ----------------------------</span>
3145 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3146 
3147 <span class="comment">% Re-store the Application data:</span>
3148 <span class="comment">% ------------------------------</span>
3149 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3150 
3151 <span class="comment">% Update the GUI:</span>
3152 <span class="comment">% ---------------</span>
3153 <span class="comment">% updateGUI(handles,guiparams)</span>
3154 
3155 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3156 
3157 
3158 <span class="comment">% --------------------------------------------------------------------</span>
3159 <a name="_sub85" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3160 
3161 <span class="comment">% Get the Application data:</span>
3162 <span class="comment">% -------------------------</span>
3163 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3164 
3165 <span class="comment">% Modify the Application data:</span>
3166 <span class="comment">% ----------------------------</span>
3167 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3168 
3169 <span class="comment">% Re-store the Application data:</span>
3170 <span class="comment">% ------------------------------</span>
3171 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3172 
3173 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3174 
3175 
3176 <span class="comment">% --------------------------------------------------------------------</span>
3177 <a name="_sub86" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3178 
3179 <span class="comment">% Get the Application data:</span>
3180 <span class="comment">% -------------------------</span>
3181 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3182 
3183 <span class="comment">% Modify the Application data:</span>
3184 <span class="comment">% ----------------------------</span>
3185 idx_variable = get(hObject,<span class="string">'Value'</span>);
3186 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3187 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3188 
3189 <span class="comment">% Re-store the Application data:</span>
3190 <span class="comment">% ------------------------------</span>
3191 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3192 
3193 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3194 
3195 
3196 <span class="comment">% --------------------------------------------------------------------</span>
3197 <a name="_sub87" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3198 
3199 <span class="comment">% Get the Application data:</span>
3200 <span class="comment">% -------------------------</span>
3201 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3202 
3203 <span class="comment">% Modify the Application data:</span>
3204 <span class="comment">% ----------------------------</span>
3205 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3206 
3207 <span class="comment">% Re-store the Application data:</span>
3208 <span class="comment">% ------------------------------</span>
3209 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3210 
3211 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3212 
3213 
3214 <span class="comment">% --------------------------------------------------------------------</span>
3215 <a name="_sub88" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3216 <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3217 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3218 
3219 
3220 <span class="comment">% --------------------------------------------------------------------</span>
3221 <a name="_sub89" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3222 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3223 <span class="comment">% [EOF] ClearLog_Callback</span>
3224 
3225 <span class="comment">% --------------------------------------------------------------------</span>
3226 <a name="_sub90" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3227 
3228 <span class="comment">% Get the Application data:</span>
3229 <span class="comment">% -------------------------</span>
3230 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3231 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3232 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3233 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3234 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3235 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3236 
3237 [the_file,the_path] = <span class="keyword">...</span>
3238     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3239     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3240     fullfile(guiprefs.log_path,guiprefs.log_file));
3241 
3242 <span class="comment">% Save the log to a TXT file:</span>
3243 <span class="comment">% ---------------------------</span>
3244 <span class="keyword">if</span> ischar(the_file)
3245     guiparams.log_path = the_path;
3246     guiparams.log_file = the_file;
3247     <span class="comment">%guiparams.savefile = the_file;</span>
3248     
3249     <span class="comment">% Re-store the Application data:</span>
3250     <span class="comment">% ------------------------------</span>
3251     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3252     
3253     <span class="comment">% Update the preferences:</span>
3254     <span class="comment">% -----------------------</span>
3255     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3256     guiprefs.log_path = the_path;
3257     guiprefs.log_file = the_file;
3258     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3259     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3260     
3261     [~,filename,extension] = fileparts(the_file);
3262     savefile = [the_path filename extension];
3263     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3264         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3265     
3266     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3267     [nrows,~]= size(logfile);
3268     fid = fopen(savefile, <span class="string">'w'</span>);
3269     <span class="keyword">for</span> row=1:nrows
3270         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3271     <span class="keyword">end</span>
3272     fclose(fid);
3273 <span class="keyword">end</span>
3274 <span class="comment">% [EOF] SaveLog_Callback</span>
3275 
3276 <span class="comment">%%%%%%%%%%%%%%%%</span>
3277 <span class="comment">% SUBFUNCTIONS %</span>
3278 <span class="comment">%%%%%%%%%%%%%%%%</span>
3279 
3280 <span class="comment">% --------------------------------------------------------------------</span>
3281 <a name="_sub91" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3282 
3283 icons = <a href="#_sub107" class="code" title="subfunction icons = getIcons">getIcons</a>;
3284 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3285 
3286 <span class="comment">% Load data</span>
3287 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3288 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3289 <span class="comment">% icon(icon==0) = NaN;</span>
3290 handles.toolbarLoadData = <span class="keyword">...</span>
3291     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3292     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3293     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3294 
3295 <span class="comment">% Save data</span>
3296 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3297 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3298 <span class="comment">% icon(icon==0) = NaN;</span>
3299 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3300     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3301     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3302     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3303     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3304 
3305 
3306 <span class="comment">% Save bathymetry</span>
3307 <span class="comment">%icon = ones(16,16,3);</span>
3308 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3309     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3310     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3311     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3312 
3313 <span class="comment">% Save figures</span>
3314 <span class="comment">% icon = ones(16,16,3);</span>
3315 handles.toolbarSaveFigures = <span class="keyword">...</span>
3316     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3317     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3318     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3319 
3320 <span class="comment">% Save Excel File</span>
3321 <span class="comment">% icon = ones(16,16,3);</span>
3322 handles.toolbarSaveExcel = <span class="keyword">...</span>
3323     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3324     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3325     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3326 
3327 
3328 <span class="comment">% Plotting parameters</span>
3329 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3330 <span class="comment">% icon = ind2rgb(icon,map);</span>
3331 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3332     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3333     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3334     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3335     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3336 
3337 <span class="comment">% Processing parameters</span>
3338 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3339 <span class="comment">% icon = ind2rgb(icon,map);</span>
3340 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3341     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3342     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3343     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3344 
3345 <span class="comment">% Zoom In</span>
3346 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3347 <span class="comment">% icon = ind2rgb(icon,map);</span>
3348 <span class="comment">% handles.toolbarZoomIn = ...</span>
3349 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3350 <span class="comment">%     'CData',        icons(8).data, ...</span>
3351 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3352 <span class="comment">%     'Separator',     'on');</span>
3353 
3354 <span class="comment">% Zoom Out</span>
3355 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3356 <span class="comment">% icon = ind2rgb(icon,map);</span>
3357 <span class="comment">% handles.toolbarZoomOut = ...</span>
3358 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3359 <span class="comment">%     'CData',        icons(9).data, ...</span>
3360 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3361 
3362 <span class="comment">% Pan</span>
3363 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3364 <span class="comment">% icon = ind2rgb(icon,map);</span>
3365 <span class="comment">% handles.toolbarPan = ...</span>
3366 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3367 <span class="comment">%     'CData',        icons(10).data, ...</span>
3368 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3369 
3370 
3371 
3372 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3373 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3374 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3375 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3376 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub25" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3377 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub53" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3378 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3379 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3380 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3381 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3382 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3383 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3384 
3385 <span class="comment">% [EOF] buildtoolbar</span>
3386 
3387 
3388 <span class="comment">% --------------------------------------------------------------------</span>
3389 <a name="_sub92" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3390 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3391 <span class="comment">% already exist.</span>
3392 
3393 <span class="comment">% Preferences:</span>
3394 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3395 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3396 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3397 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3398 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3399 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3400 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3401 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3402 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3403 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3404 <span class="comment">% 'renderer'             Default graphics renderer</span>
3405 <span class="comment">% 'units'                Default plotting units</span>
3406 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3407 <span class="comment">%                        started</span>
3408 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3409 
3410 <span class="comment">% Originals</span>
3411 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3412 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3413 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3414 
3415 <span class="comment">% ASCII</span>
3416 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3417     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3418     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3419         guiprefs.ascii_path = ascii.path;
3420     <span class="keyword">else</span>
3421         guiprefs.ascii_path = pwd;
3422     <span class="keyword">end</span>
3423     does_exist = false(1,length(ascii.file));
3424     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3425         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3426     <span class="keyword">end</span>
3427     <span class="keyword">if</span> any(does_exist)
3428         guiprefs.ascii_file = ascii.file(does_exist);
3429     <span class="keyword">else</span>
3430         guiprefs.ascii_file = {<span class="string">''</span>};
3431     <span class="keyword">end</span>
3432 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3433     guiprefs.ascii_path = pwd;
3434     guiprefs.ascii_file = {<span class="string">''</span>};
3435     
3436     ascii.path = pwd;
3437     ascii.file = {<span class="string">''</span>};
3438     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3439 <span class="keyword">end</span>
3440 
3441 <span class="comment">% MAT</span>
3442 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3443     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3444     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3445         guiprefs.mat_path = mat.path;
3446     <span class="keyword">else</span>
3447         guiprefs.mat_path = pwd;
3448     <span class="keyword">end</span>
3449     
3450     <span class="keyword">if</span> iscell(mat.file)
3451         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3452             guiprefs.mat_file = mat.file;
3453         <span class="keyword">else</span>
3454             guiprefs.mat_file = <span class="string">''</span>;
3455         <span class="keyword">end</span>
3456     <span class="keyword">else</span>
3457         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3458             guiprefs.mat_file = mat.file;
3459         <span class="keyword">else</span>
3460             guiprefs.mat_file = <span class="string">''</span>;
3461         <span class="keyword">end</span>
3462     <span class="keyword">end</span>
3463 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3464     guiprefs.mat_path = pwd;
3465     guiprefs.mat_file = <span class="string">''</span>;
3466     
3467     mat.path = pwd;
3468     mat.file = <span class="string">''</span>;
3469     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3470 <span class="keyword">end</span>
3471 
3472 <span class="comment">% TECPLOT</span>
3473 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3474     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3475     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3476         guiprefs.tecplot_path = tecplot.path;
3477     <span class="keyword">else</span>
3478         guiprefs.tecplot_path = pwd;
3479     <span class="keyword">end</span>
3480     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3481         guiprefs.tecplot_file = tecplot.file;
3482     <span class="keyword">else</span>
3483         guiprefs.tecplot_file = <span class="string">''</span>;
3484     <span class="keyword">end</span>
3485 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3486     guiprefs.tecplot_path = pwd;
3487     guiprefs.tecplot_file = <span class="string">''</span>;
3488     
3489     tecplot.path = pwd;
3490     tecplot.file = <span class="string">''</span>;
3491     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3492 <span class="keyword">end</span>
3493 
3494 <span class="comment">% KMZ</span>
3495 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3496     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3497     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3498         guiprefs.kmz_path = kmz.path;
3499     <span class="keyword">else</span>
3500         guiprefs.kmz_path = pwd;
3501     <span class="keyword">end</span>
3502     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3503         guiprefs.kmz_file = kmz.file;
3504     <span class="keyword">else</span>
3505         guiprefs.kmz_file = <span class="string">''</span>;
3506     <span class="keyword">end</span>
3507 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3508     guiprefs.kmz_path = pwd;
3509     guiprefs.kmz_file = <span class="string">''</span>;
3510     
3511     kmz.path = pwd;
3512     kmz.file = <span class="string">''</span>;
3513     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3514 <span class="keyword">end</span>
3515 
3516 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3517 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3518     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3519     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3520         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3521     <span class="keyword">else</span>
3522         guiprefs.multibeambathymetry_path = pwd;
3523     <span class="keyword">end</span>
3524     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3525         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3526     <span class="keyword">else</span>
3527         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3528     <span class="keyword">end</span>
3529 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3530     guiprefs.multibeambathymetry_path = pwd;
3531     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3532     
3533     multibeambathymetry.path = pwd;
3534     multibeambathymetry.file = <span class="string">''</span>;
3535     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3536 <span class="keyword">end</span>
3537 
3538 <span class="comment">% Log</span>
3539 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3540     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3541     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3542         guiprefs.log_path = log.path;
3543     <span class="keyword">else</span>
3544         guiprefs.log_path = pwd;
3545     <span class="keyword">end</span>
3546     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3547         guiprefs.log_file = log.file;
3548     <span class="keyword">else</span>
3549         guiprefs.log_file = <span class="string">''</span>;
3550     <span class="keyword">end</span>
3551 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3552     guiprefs.log_path = pwd;
3553     guiprefs.log_file = <span class="string">''</span>;
3554     
3555     log.path = pwd;
3556     log.file = <span class="string">''</span>;
3557     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3558 <span class="keyword">end</span>
3559 
3560 <span class="comment">% iRic</span>
3561 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3562     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3563     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3564         guiprefs.iric_path = iric.path;
3565     <span class="keyword">else</span>
3566         guiprefs.iric_path = pwd;
3567     <span class="keyword">end</span>
3568     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3569         guiprefs.iric_file = iric.file;
3570     <span class="keyword">else</span>
3571         guiprefs.iric_file = <span class="string">''</span>;
3572     <span class="keyword">end</span>
3573 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3574     guiprefs.iric_path = pwd;
3575     guiprefs.iric_file = <span class="string">''</span>;
3576     
3577     iric.path = pwd;
3578     iric.file = <span class="string">''</span>;
3579     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3580 <span class="keyword">end</span>
3581 
3582 <span class="comment">% excel</span>
3583 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3584     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3585     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3586         guiprefs.excel_path = excel.path;
3587     <span class="keyword">else</span>
3588         guiprefs.excel_path = pwd;
3589     <span class="keyword">end</span>
3590     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3591         guiprefs.excel_file = excel.file;
3592     <span class="keyword">else</span>
3593         guiprefs.excel_file = <span class="string">''</span>;
3594     <span class="keyword">end</span>
3595 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3596     guiprefs.excel_path = pwd;
3597     guiprefs.excel_file = <span class="string">''</span>;
3598     
3599     excel.path = pwd;
3600     excel.file = <span class="string">''</span>;
3601     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3602 <span class="keyword">end</span>
3603 
3604 <span class="comment">% aerial</span>
3605 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3606     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3607     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3608         guiprefs.aerial_path = aerial.path;
3609     <span class="keyword">else</span>
3610         guiprefs.aerial_path = pwd;
3611     <span class="keyword">end</span>
3612     does_exist = false(1,length(aerial.file));
3613     <span class="keyword">if</span> iscell(aerial.file)
3614     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3615         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3616     <span class="keyword">end</span>
3617     <span class="keyword">else</span>
3618         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3619     <span class="keyword">end</span>
3620     <span class="keyword">if</span> any(does_exist)
3621         guiprefs.aerial_file = aerial.file;
3622     <span class="keyword">else</span>
3623         guiprefs.aerial_file = {<span class="string">''</span>};
3624     <span class="keyword">end</span>
3625 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3626     guiprefs.aerial_path = pwd;
3627     guiprefs.aerial_file = {<span class="string">''</span>};
3628     
3629     aerial.path = pwd;
3630     aerial.file = {<span class="string">''</span>};
3631     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3632 <span class="keyword">end</span>
3633 
3634 <span class="comment">% shoreline</span>
3635 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3636     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3637     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3638         guiprefs.shoreline_path = shoreline.path;
3639     <span class="keyword">else</span>
3640         guiprefs.shoreline_path = pwd;
3641     <span class="keyword">end</span>
3642     
3643     <span class="keyword">if</span> iscell(shoreline.file)
3644         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3645             guiprefs.shoreline_file = shoreline.file;
3646         <span class="keyword">else</span>
3647             guiprefs.shoreline_file = <span class="string">''</span>;
3648         <span class="keyword">end</span>
3649     <span class="keyword">else</span>
3650         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3651             guiprefs.shoreline_file = shoreline.file;
3652         <span class="keyword">else</span>
3653             guiprefs.shoreline_file = <span class="string">''</span>;
3654         <span class="keyword">end</span>
3655     <span class="keyword">end</span>
3656 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3657     guiprefs.shoreline_path = pwd;
3658     guiprefs.shoreline_file = <span class="string">''</span>;
3659     
3660     shoreline.path = pwd;
3661     shoreline.file = <span class="string">''</span>;
3662     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3663 <span class="keyword">end</span>
3664 <span class="comment">% guiprefs.presentation = true;</span>
3665 <span class="comment">% guiprefs.print        = false;</span>
3666 
3667 <span class="comment">% for k = 1:length(prefs)</span>
3668 <span class="comment">%     newpref = '';</span>
3669 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3670 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3671 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3672 <span class="comment">%             newpref = stored_newpref;</span>
3673 <span class="comment">%         else</span>
3674 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3675 <span class="comment">%         end</span>
3676 <span class="comment">%     end</span>
3677 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3678 <span class="comment">% end</span>
3679 
3680 <span class="comment">% RENDERER</span>
3681 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3682     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3683     guiprefs.renderer = renderer;
3684 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3685     renderer           = <span class="string">'OpenGL'</span>;
3686     guiprefs.renderer  = renderer;
3687     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3688 <span class="keyword">end</span>
3689 
3690 <span class="comment">% UNITS</span>
3691 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3692     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3693     guiprefs.units = units;
3694 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3695     units           = <span class="string">'metric'</span>;
3696     guiprefs.units  = renderer;
3697     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3698 <span class="keyword">end</span>
3699 
3700 <span class="comment">% RUNCOUNTER</span>
3701 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3702     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3703     guiprefs.runcounter = runcounter;
3704 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3705     runcounter           = 1;
3706     guiprefs.runcounter  = runcounter;
3707     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3708 <span class="keyword">end</span>
3709 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3710 
3711 <span class="comment">% SETENDPOINTS</span>
3712 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
3713     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
3714     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
3715         guiprefs.setendpoints_path = setendpoints.path;
3716     <span class="keyword">else</span>
3717         guiprefs.setendpoints_path = pwd;
3718     <span class="keyword">end</span>
3719     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
3720         guiprefs.setendpoints_file = setendpoints.file;
3721     <span class="keyword">else</span>
3722         guiprefs.setendpoints_file = <span class="string">''</span>;
3723     <span class="keyword">end</span>
3724 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3725     guiprefs.setendpoints_path = pwd;
3726     guiprefs.setendpoints_file = <span class="string">''</span>;
3727     
3728     setendpoints.path = pwd;
3729     setendpoints.file = <span class="string">''</span>;
3730     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3731 <span class="keyword">end</span>
3732 
3733 <span class="comment">% [EOF] load_prefs</span>
3734 
3735 
3736 <span class="comment">% --------------------------------------------------------------------</span>
3737 <a name="_sub93" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3738 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3739 <span class="comment">% preferences data.</span>
3740 
3741 <span class="comment">% Preferences:</span>
3742 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3743 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3744 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3745 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3746 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3747 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3748 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3749 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3750 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3751 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3752 <span class="comment">% 'renderer'             Default graphics renderer</span>
3753 <span class="comment">% 'units'                Default plotting units</span>
3754 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3755 <span class="comment">%                        started</span>
3756 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
3757 
3758 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3759 
3760 <span class="keyword">switch</span> pref
3761     <span class="keyword">case</span> <span class="string">'ascii'</span>
3762         ascii.path = guiprefs.ascii_path;
3763         ascii.file = guiprefs.ascii_file;
3764         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3765     <span class="keyword">case</span> <span class="string">'mat'</span>
3766         mat.path = guiprefs.mat_path;
3767         mat.file = guiprefs.mat_file;
3768         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3769     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3770         tecplot.path = guiprefs.tecplot_path;
3771         tecplot.file = guiprefs.tecplot_file;
3772         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3773     <span class="keyword">case</span> <span class="string">'kmz'</span>
3774         kmz.path = guiprefs.kmz_path;
3775         kmz.file = guiprefs.kmz_file;
3776         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3777     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3778         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3779         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3780         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3781     <span class="keyword">case</span> <span class="string">'log'</span>
3782         log.path = guiprefs.log_path;
3783         log.file = guiprefs.log_file;
3784         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3785     <span class="keyword">case</span> <span class="string">'iric'</span>
3786         iric.path = guiprefs.iric_path;
3787         iric.file = guiprefs.iric_file;
3788         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3789     <span class="keyword">case</span> <span class="string">'excel'</span>
3790         excel.path = guiprefs.excel_path;
3791         excel.file = guiprefs.excel_file;
3792         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3793     <span class="keyword">case</span> <span class="string">'aerial'</span>
3794         aerial.path = guiprefs.aerial_path;
3795         aerial.file = guiprefs.aerial_file;
3796         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3797     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3798         shoreline.path = guiprefs.shoreline_path;
3799         shoreline.file = guiprefs.shoreline_file;
3800         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3801     <span class="keyword">case</span> <span class="string">'renderer'</span>
3802         renderer = guiprefs.renderer;
3803         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3804     <span class="keyword">case</span> <span class="string">'units'</span>
3805         units = guiprefs.units;
3806         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3807     <span class="keyword">case</span> <span class="string">'runcounter'</span>
3808         runcounter = guiprefs.runcounter;
3809         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3810     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
3811         setendpoints.path = guiprefs.setendpoints_path;
3812         setendpoints.file = guiprefs.setendpoints_file;
3813         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3814     <span class="keyword">otherwise</span>
3815 <span class="keyword">end</span>
3816 
3817 <span class="comment">% if ismember(pref,prefs)</span>
3818 <span class="comment">%     setpref('VMT',pref,value)</span>
3819 <span class="comment">%</span>
3820 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3821 <span class="comment">%     guiprefs.(pref) = value;</span>
3822 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3823 <span class="comment">% end</span>
3824 
3825 <span class="comment">% [EOF] store_prefs</span>
3826 
3827 
3828 <span class="comment">% --------------------------------------------------------------------</span>
3829 <a name="_sub94" href="#_subfunctions" class="code">function initGUI(handles)</a>
3830 <span class="comment">% Initialize the UI controls in the GUI.</span>
3831 
3832 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3833 
3834 <span class="comment">% Set the name and version</span>
3835 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
3836     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3837 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3838 
3839 <span class="comment">% Set the PLOT 1 axis labels</span>
3840 axes(handles.Plot1Shiptracks);
3841 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3842 xlabel(<span class="string">'UTM Easting (m)'</span>)
3843 ylabel(<span class="string">'UTM Northing (m)'</span>)
3844 box on
3845 grid on
3846 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3847 
3848 <span class="comment">%%%%%%%%%%%%</span>
3849 <span class="comment">% MENU BAR %</span>
3850 <span class="comment">%%%%%%%%%%%%</span>
3851 <span class="keyword">if</span> guiparams.english_units
3852     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3853     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3854 <span class="keyword">else</span>
3855     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3856     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3857 <span class="keyword">end</span>
3858 
3859 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3860     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3861     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3862 <span class="keyword">else</span>
3863     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3864     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3865 <span class="keyword">end</span>
3866 
3867 
3868 <span class="keyword">if</span> guiparams.print
3869     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3870     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3871     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3872     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3873 <span class="keyword">elseif</span> guiparams.presentation
3874     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3875     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3876     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3877     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3878 <span class="keyword">else</span>
3879 <span class="keyword">end</span>
3880 
3881 <span class="keyword">switch</span> guiparams.renderer
3882     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
3883         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3884         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3885         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3886     <span class="keyword">case</span> <span class="string">'painters'</span>
3887         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3888         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3889         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3890     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
3891         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3892         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3893         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3894 <span class="keyword">end</span>
3895 
3896 
3897 <span class="comment">%%%%%%%%%%%%%%%</span>
3898 <span class="comment">% DATA EXPORT %</span>
3899 <span class="comment">%%%%%%%%%%%%%%%</span>
3900 <span class="comment">% BathymetryPanel</span>
3901 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3902 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3903 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3904 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3905 
3906 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3907 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3908 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3909 <span class="comment">% PlanViewPanel</span>
3910 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3911 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3912 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3913 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3914 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3915 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3916 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3917 
3918 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3919 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3920 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3921 <span class="comment">% ShiptracksPanel</span>
3922 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3923 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3924 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3925 
3926 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3927 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3928 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3929 <span class="comment">% CrossSectionsPanel</span>
3930 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3931     <span class="string">'Value'</span>, guiparams.idx_contour)
3932 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3933 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3934 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3935 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3936 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3937 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3938 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3939 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3940     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3941 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3942 
3943 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3944 
3945 <span class="comment">% [EOF] initGUI</span>
3946 
3947 
3948 <span class="comment">% --------------------------------------------------------------------</span>
3949 <a name="_sub95" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3950 
3951 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3952 
3953 <span class="keyword">switch</span> enable_state
3954     <span class="keyword">case</span> <span class="string">'init'</span>
3955         guiparams.gui_state = <span class="string">'init'</span>;
3956         set([handles.menuFile
3957             handles.menuOpen
3958             handles.menuOpenASCII
3959             handles.menuOpenMAT
3960             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3961         
3962         set([handles.toolbarLoadData
3963             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3964         set([handles.toolbarSaveMatFile
3965             handles.toolbarSaveBathymetry
3966             handles.toolbarSaveFigures
3967             handles.toolbarSaveExcel
3968             handles.toolbarPlottingParameters
3969             handles.toolbarProcessingParameters
3970             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3971         
3972         set([handles.DepthRangeMin
3973             handles.DepthRangeMax
3974             handles.VectorScalePlanView
3975             handles.VectorSpacingPlanview
3976             handles.SmoothingWindowSize
3977             handles.DisplayShoreline
3978             handles.AddBackground
3979             handles.PlotPlanView
3980             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3981         
3982         set([handles.HorizontalGridNodeSpacing
3983             handles.VerticalGridNodeSpacing
3984             handles.PlotShiptracks
3985             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3986         
3987         set([handles.Contour
3988             handles.VerticalExaggeration
3989             handles.VectorScaleCrossSection
3990             handles.HorizontalVectorSpacing
3991             handles.VerticalVectorSpacing
3992             handles.HorizontalSmoothingWindow
3993             handles.VerticalSmoothingWindow
3994             handles.PlotSecondaryFlowVectors
3995             handles.SecondaryFlowVectorVariable
3996             handles.IncludeVerticalVelocity
3997             handles.PlotCrossSection
3998             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3999         
4000     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4001         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4002         set([handles.menuFile
4003             handles.menuOpen
4004             handles.menuOpenASCII
4005             handles.menuOpenMAT
4006             handles.menuSaveMAT
4007             handles.menuSaveTecplot
4008             handles.menuSaveKMZFile
4009             handles.menuParameters
4010             handles.menuPlottingParameters
4011             handles.menuMetric
4012             handles.menuEnglish
4013             handles.menuBathymetryExportSettings
4014             handles.menuExportMultibeamBathymetry
4015             handles.menuKMZVerticalOffset
4016             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4017         
4018         set([handles.toolbarLoadData
4019             handles.toolbarSaveMatFile
4020             handles.toolbarSaveBathymetry
4021             handles.toolbarSaveExcel
4022             handles.toolbarSaveFigures
4023             handles.toolbarPlottingParameters
4024             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4025         set([handles.toolbarProcessingParameters
4026             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4027         
4028            
4029         set([handles.DepthRangeMin
4030             handles.DepthRangeMax
4031             handles.VectorScalePlanView
4032             handles.VectorSpacingPlanview
4033             handles.SmoothingWindowSize
4034             handles.DisplayShoreline
4035             handles.PlotPlanView
4036             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4037         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4038             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4039         <span class="keyword">else</span>
4040             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4041         <span class="keyword">end</span>
4042         
4043         set([handles.HorizontalGridNodeSpacing
4044             handles.VerticalGridNodeSpacing
4045             handles.PlotShiptracks
4046             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4047         
4048         set([handles.Contour
4049             handles.VerticalExaggeration
4050             handles.VectorScaleCrossSection
4051             handles.HorizontalVectorSpacing
4052             handles.VerticalVectorSpacing
4053             handles.HorizontalSmoothingWindow
4054             handles.VerticalSmoothingWindow
4055             handles.PlotSecondaryFlowVectors
4056             handles.SecondaryFlowVectorVariable
4057             handles.IncludeVerticalVelocity
4058             handles.PlotCrossSection
4059             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4060     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4061         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4062         set([handles.menuFile
4063             handles.menuOpen
4064             handles.menuOpenASCII
4065             handles.menuOpenMAT
4066             handles.menuParameters
4067             handles.menuPlottingParameters
4068             handles.menuMetric
4069             handles.menuEnglish
4070             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4071         set([handles.menuSaveMAT
4072             handles.menuBathymetryExportSettings
4073             handles.menuExportMultibeamBathymetry
4074             handles.menuKMZVerticalOffset
4075             handles.menuSaveKMZFile
4076             handles.menuSaveTecplot
4077             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4078         
4079         set([handles.toolbarLoadData
4080             handles.toolbarSaveFigures
4081             handles.toolbarPlottingParameters
4082             handles.toolbarSaveExcel
4083             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4084         set([handles.toolbarProcessingParameters
4085             handles.toolbarSaveMatFile
4086             handles.toolbarSaveBathymetry
4087             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4088         
4089         set([handles.DepthRangeMin
4090             handles.DepthRangeMax
4091             handles.VectorScalePlanView
4092             handles.VectorSpacingPlanview
4093             handles.SmoothingWindowSize
4094             handles.DisplayShoreline
4095             handles.PlotPlanView
4096             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4097         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4098             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4099         <span class="keyword">else</span>
4100             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4101         <span class="keyword">end</span>
4102         
4103         set([handles.HorizontalGridNodeSpacing
4104             handles.VerticalGridNodeSpacing
4105             handles.PlotShiptracks
4106             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4107         
4108         set([handles.Contour
4109             handles.VerticalExaggeration
4110             handles.VectorScaleCrossSection
4111             handles.HorizontalVectorSpacing
4112             handles.VerticalVectorSpacing
4113             handles.HorizontalSmoothingWindow
4114             handles.VerticalSmoothingWindow
4115             handles.PlotSecondaryFlowVectors
4116             handles.SecondaryFlowVectorVariable
4117             handles.IncludeVerticalVelocity
4118             handles.PlotCrossSection
4119             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4120     <span class="keyword">otherwise</span>
4121 <span class="keyword">end</span>
4122 
4123 <span class="comment">% Save Application Data</span>
4124 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4125 
4126 <span class="comment">% [EOF] set_enable</span>
4127 
4128 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4129 
4130 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4131 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4132 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4133 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4134 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4135 
4136 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4137 
4138 
4139 <span class="comment">% --------------------------------------------------------------------</span>
4140 <a name="_sub96" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4141     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4142 
4143 w = 500;
4144 h = 110;
4145 dx = 10;
4146 dy = 35;
4147 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4148 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4149     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4150     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4151     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4152     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4153     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4154     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4155     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4156     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4157     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4158     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4159 dialog_params.english_units               = english_units;
4160 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4161 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4162 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4163 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4164 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4165 
4166 <span class="comment">% Build the graphics:</span>
4167 <span class="comment">% -------------------</span>
4168 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4169     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4170     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4171     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4172 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4173     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4174     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4175     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4176     <span class="string">'Position'</span>,[15 35 100 22]);
4177 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4178     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4179     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4180     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4181     <span class="string">'Position'</span>,[15 10 100 22]);
4182 
4183 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4184     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4185     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4186     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4187 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4188     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4189     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4190     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4191     <span class="string">'Position'</span>,[15 35 100 22]);
4192 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4193     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4194     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4195     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4196     <span class="string">'Position'</span>,[15 10 100 22]);
4197 
4198 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4199     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4200     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4201     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4202 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4203     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4204     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4205     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4206     <span class="string">'Position'</span>,[15 35 100 22]);
4207 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4208     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4209     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4210     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4211     <span class="string">'Position'</span>,[15 10 100 22]);
4212 
4213 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4214     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4215     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4216     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4217     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4218 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4219     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4220     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4221     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4222     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4223 
4224 <span class="comment">% Update the UI controls:</span>
4225 <span class="comment">% -----------------------</span>
4226 <span class="keyword">if</span> dialog_params.english_units
4227     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4228     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4229 <span class="keyword">else</span>
4230     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4231     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4232 <span class="keyword">end</span>
4233 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4234     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4235     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4236 <span class="keyword">else</span>
4237     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4238     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4239 <span class="keyword">end</span>
4240 <span class="keyword">if</span> dialog_params.presentation
4241     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4242     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4243 <span class="keyword">else</span>
4244     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4245     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4246 <span class="keyword">end</span>
4247 
4248 <span class="comment">% Set the callbacks:</span>
4249 <span class="comment">% ------------------</span>
4250 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4251 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4252 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4253 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4254 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4255 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4256 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4257 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4258 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4259 
4260 <span class="comment">% Position the dialog and make it visible:</span>
4261 <span class="comment">% ----------------------------------------</span>
4262 fpos = get(hf,<span class="string">'Position'</span>);
4263 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4264 movegui(handles.Figure,dpos)
4265 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4266 
4267 <span class="comment">% Hold the dialog open:</span>
4268 <span class="comment">% ---------------------</span>
4269 waitfor(handles.OK)
4270 
4271 <span class="comment">% Return the outputs and close the dialog:</span>
4272 <span class="comment">% ----------------------------------------</span>
4273 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4274 english_units = dialog_params.english_units;
4275 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4276 plot_presentation_style =  dialog_params.presentation;
4277 plot_print_style =  dialog_params.print;
4278 
4279 delete(handles.Figure)
4280 
4281 <span class="comment">% [EOF] plotParametersDialog</span>
4282 
4283 
4284 <span class="comment">% --------------------------------------------------------------------</span>
4285 <a name="_sub97" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4286 
4287 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4288 <span class="keyword">switch</span> the_units
4289     <span class="keyword">case</span> <span class="string">'metric'</span>
4290         dialog_params.english_units = false;
4291         
4292         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4293         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4294     <span class="keyword">case</span> <span class="string">'english'</span>
4295         dialog_params.english_units = true;
4296         
4297         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4298         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4299     <span class="keyword">otherwise</span>
4300 <span class="keyword">end</span>
4301 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4302 
4303 <span class="comment">% [EOF] dialogUnits</span>
4304 
4305 <span class="comment">% --------------------------------------------------------------------</span>
4306 <a name="_sub98" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4307 
4308 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4309 <span class="keyword">switch</span> the_endpoints
4310     <span class="keyword">case</span> <span class="string">'auto'</span>
4311         dialog_params.set_cross_section_endpoints = false;
4312         
4313         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4314         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4315     <span class="keyword">case</span> <span class="string">'manual'</span>
4316         dialog_params.set_cross_section_endpoints = true;
4317         
4318         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4319         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4320     <span class="keyword">otherwise</span>
4321 <span class="keyword">end</span>
4322 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4323 
4324 <span class="comment">% [EOF] dialogEnpoints</span>
4325 
4326 <a name="_sub99" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4327 
4328 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4329 <span class="keyword">switch</span> the_style
4330     <span class="keyword">case</span> <span class="string">'presentation'</span>
4331         dialog_params.presentation  = true;
4332         dialog_params.print         = false;
4333         
4334         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4335         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4336     <span class="keyword">case</span> <span class="string">'print'</span>
4337         dialog_params.presentation  = false;
4338         dialog_params.print         = true;
4339         
4340         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4341         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4342     <span class="keyword">otherwise</span>
4343 <span class="keyword">end</span>
4344 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4345 
4346 <span class="comment">% [EOF] dialogEnpoints</span>
4347 
4348 <span class="comment">% --------------------------------------------------------------------</span>
4349 <a name="_sub100" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4350 
4351 delete(h_OK)
4352 
4353 <span class="comment">% [EOF] dialogOK</span>
4354 
4355 <span class="comment">% --------------------------------------------------------------------</span>
4356 <a name="_sub101" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4357 <span class="comment">% Return the original inputs</span>
4358 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4359 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4360 delete(handles.OK)
4361 
4362 <span class="comment">% [EOF] dialogCancel</span>
4363 
4364 <span class="comment">% --------------------------------------------------------------------</span>
4365 <a name="_sub102" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4366 
4367 delete(h_OK)
4368 
4369 <span class="comment">% [EOF] dialogCloseReq</span>
4370 
4371 <a name="_sub103" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a>
4372 w = 230;
4373 h = 200;
4374 dx = 10;
4375 dy = 35;
4376 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4377 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4378     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4379     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4380     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4381     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4382     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4383     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4384     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4385     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4386     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4387     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4388 dialog_params.beam_angle             = beam_angle;
4389 dialog_params.magnetic_variation     = magnetic_variation;
4390 dialog_params.wse                    = wse;
4391 dialog_params.output_auxiliary_data = output_auxiliary_data;
4392 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4393 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4394 
4395 <span class="comment">% Build the graphics:</span>
4396 <span class="comment">% -------------------</span>
4397 ph = 150;
4398 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4399     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4400     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4401     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4402 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4403     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4404     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4405     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4406     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4407     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4408     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4409 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4410     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4411     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4412     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4413     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4414     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4415     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4416 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4417     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4418     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4419     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4420     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4421     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4422     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4423 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4424     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4425     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4426     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4427     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4428     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4429     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4430 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4431     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4432     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4433     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4434     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4435     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4436     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4437 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4438     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4439     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4440     <span class="string">'String'</span>,num2str(wse),<span class="keyword">...</span>
4441     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4442     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4443     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4444 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4445     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4446     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4447     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4448     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4449 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4450     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4451     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4452     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4453     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4454 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4455     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4456     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4457     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4458     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4459 
4460 <span class="comment">% Update the UI controls:</span>
4461 <span class="comment">% -----------------------</span>
4462 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4463 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4464 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4465 set(handles.OutputauxiliaryData,     <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4466 
4467 <span class="comment">% Set the callbacks:</span>
4468 <span class="comment">% ------------------</span>
4469 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4470 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4471 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4472 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4473 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4474 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4475 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4476 
4477 <span class="comment">% Position the dialog and make it visible:</span>
4478 <span class="comment">% ----------------------------------------</span>
4479 fpos = get(hf,<span class="string">'Position'</span>);
4480 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4481 movegui(handles.Figure,dpos)
4482 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4483 
4484 <span class="comment">% Hold the dialog open:</span>
4485 <span class="comment">% ---------------------</span>
4486 waitfor(handles.OK)
4487 
4488 <span class="comment">% Return the outputs and close the dialog:</span>
4489 <span class="comment">% ----------------------------------------</span>
4490 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4491 beam_angle              = dialog_params.beam_angle;
4492 magnetic_variation      = dialog_params.magnetic_variation;
4493 wse                     = str2double(dialog_params.wse);
4494 output_auxiliary_data  = logical(dialog_params.output_auxiliary_data);
4495 
4496 delete(handles.Figure)
4497 
4498 <span class="comment">% [EOF] exportSettingsDialog</span>
4499 
4500 <span class="comment">% --------------------------------------------------------------------</span>
4501 <a name="_sub104" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4502 
4503 <span class="comment">% Grab the current data</span>
4504 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4505 
4506 <span class="comment">% Set it according to the dialog box values</span>
4507 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4508 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4509 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4510 dialog_params.output_auxiliary_data    = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4511 
4512 <span class="comment">% Re-store the application data</span>
4513 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4514 
4515 <span class="comment">% [EOF] dialogExportSettings</span>
4516 
4517 <a name="_sub105" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4518 
4519 w = 230;
4520 h = 200;
4521 dx = 10;
4522 dy = 35;
4523 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4524 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4525     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4526     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4527     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4528     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4529     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4530     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4531     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4532     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4533     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4534     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4535 dialog_params.figure_names               = figure_names;
4536 dialog_params.selected_figures           = <span class="string">''</span>;
4537 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4538 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4539 
4540 <span class="comment">% Build the graphics:</span>
4541 <span class="comment">% -------------------</span>
4542 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4543     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4544     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4545     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4546 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4547     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4548     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4549     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4550     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4551     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4552     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4553     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4554 
4555 
4556 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4557     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4558     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4559     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4560     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4561 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4562     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4563     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4564     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4565     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4566 
4567 <span class="comment">% Update the UI controls:</span>
4568 <span class="comment">% -----------------------</span>
4569 
4570 
4571 <span class="comment">% Set the callbacks:</span>
4572 <span class="comment">% ------------------</span>
4573 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4574 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4575 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4576 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4577 
4578 <span class="comment">% Position the dialog and make it visible:</span>
4579 <span class="comment">% ----------------------------------------</span>
4580 fpos = get(hf,<span class="string">'Position'</span>);
4581 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4582 movegui(handles.Figure,dpos)
4583 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4584 
4585 <span class="comment">% Hold the dialog open:</span>
4586 <span class="comment">% ---------------------</span>
4587 waitfor(handles.OK)
4588 
4589 <span class="comment">% Return the outputs and close the dialog:</span>
4590 <span class="comment">% ----------------------------------------</span>
4591 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4592 selected_figures = dialog_params.selected_figures;
4593 
4594 delete(handles.Figure)
4595 
4596 <span class="comment">% [EOF] openFiguresDialog</span>
4597 
4598 <span class="comment">% --------------------------------------------------------------------</span>
4599 <a name="_sub106" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4600 
4601 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4602 
4603 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4604 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4605 selected     = fig_names(idx_selected);
4606 dialog_params.selected_figures = selected;
4607 
4608 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4609 
4610 
4611 
4612 <span class="comment">% --------------------------------------------------------------------</span>
4613 <a name="_sub107" href="#_subfunctions" class="code">function icons = getIcons</a>
4614 
4615 <span class="comment">% Load data</span>
4616 idx = 1;
4617 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4618     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4619     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4620     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4621     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4622     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4623     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4624     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4625     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4626     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4627     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4628     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4629     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4630     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4631     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4632     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4633     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4634 
4635 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4636     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4637     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4638     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4639     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4640     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4641     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4642     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4643     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4644     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4645     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4646     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4647     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4648     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4649     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4650     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4651     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4652 
4653 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4654     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4655     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4656     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4657     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4658     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4659     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4660     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4661     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4662     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4663     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4664     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4665     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4666     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4667     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4668     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4669     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4670 
4671 <span class="comment">% Save data</span>
4672 idx = idx+1;
4673 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4674     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4675     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4676     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4677     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4678     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4679     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4680     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4681     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4682     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4683     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4684     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4685     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4686     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4687     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4688     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4689     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4690 
4691 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4692     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4693     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4694     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4695     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4696     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4697     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4698     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4699     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4700     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4701     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4702     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4703     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4704     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4705     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4706     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4707     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4708 
4709 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4710     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4711     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4712     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4713     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4714     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4715     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4716     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4717     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4718     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4719     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4720     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4721     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4722     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4723     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4724     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4725     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4726 
4727 <span class="comment">% Plotting parameters</span>
4728 idx = idx+1;
4729 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4730     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4731     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4732     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4733     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4734     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4735     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4736     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4737     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4738     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4739     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4740     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4741     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4742     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4743     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4744     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4745     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4746 
4747 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4748     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4749     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4750     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4751     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4752     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4753     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4754     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4755     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4756     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4757     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4758     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4759     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4760     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4761     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4762     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4763     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4764 
4765 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4766     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4767     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4768     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4769     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4770     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4771     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4772     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4773     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4774     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4775     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4776     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4777     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4778     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4779     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4780     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4781     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4782 
4783 <span class="comment">% Processing parameters</span>
4784 idx = idx+1;
4785 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4786     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4787     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4788     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4789     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4790     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4791     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4792     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4793     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4794     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4795     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4796     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4797     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4798     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4799     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4800     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4801     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4802 
4803 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4804     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4805     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4806     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4807     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4808     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4809     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4810     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4811     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4812     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4813     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4814     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4815     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4816     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4817     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4818     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4819     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4820 
4821 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4822     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4823     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4824     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4825     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4826     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4827     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4828     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4829     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4830     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4831     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4832     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4833     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4834     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4835     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4836     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4837     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4838 
4839 <span class="comment">% Export bathymetry dialog</span>
4840 idx = idx+1;
4841 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4842     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4843     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4844     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4845     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4846     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4847     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4848     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4849     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4850     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4851     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4852     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4853     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4854     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4855     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4856     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4857     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4858     ]/255;
4859 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4860     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4861     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4862     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4863     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4864     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4865     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4866     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4867     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4868     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4869     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4870     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4871     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4872     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4873     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4874     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4875     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4876     ]/255;
4877 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4878     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4879     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4880     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4881     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4882     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4883     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4884     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4885     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4886     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4887     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4888     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4889     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4890     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4891     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4892     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4893     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4894     ]/255;
4895 
4896 <span class="comment">% Export Figures Dialog</span>
4897 idx = idx + 1;
4898 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4899     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4900     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4901     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4902     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4903     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4904     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4905     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4906     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4907     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4908     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4909     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4910     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4911     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4912     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4913     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4914 
4915 
4916 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4917     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4918     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4919     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4920     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4921     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4922     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4923     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4924     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4925     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4926     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4927     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4928     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4929     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4930     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4931     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4932 
4933 
4934 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4935     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4936     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4937     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4938     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4939     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4940     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4941     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4942     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4943     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4944     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4945     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4946     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4947     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4948     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4949     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4950 
4951 <span class="comment">% Export Excel File</span>
4952 idx = idx + 1;
4953 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4954     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4955    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4956    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4957    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4958    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4959    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4960    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4961    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4962    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4963    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4964    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4965    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4966    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4967    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4968    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4969     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4970 
4971 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4972     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4973    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4974    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4975    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4976    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4977    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4978    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4979    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4980    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4981    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4982    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4983    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4984    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4985    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4986    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4987     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4988 
4989 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4990     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4991    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4992    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4993    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4994    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4995    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4996    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4997    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4998    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4999    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5000    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5001    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5002    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5003    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5004    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5005     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5006 
5007 <span class="comment">% Zoom In</span>
5008 idx = idx + 1;
5009 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5010     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5011 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5012     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5013 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5014     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5015 
5016 <span class="comment">% Zoom Out</span>
5017 idx = idx + 1;
5018 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5019     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5020 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5021     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5022 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5023     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5024 
5025 <span class="comment">% Pan</span>
5026 idx = idx + 1;
5027 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5028     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5029 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5030     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5031 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5032     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5033 <span class="comment">% [EOF] getIcons</span>
5034 
5035 <a name="_sub108" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5036 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5037 
5038 <span class="comment">% Check for any stored prefs</span>
5039 <span class="comment">% --------------------------</span>
5040 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5041 guiprefs = getpref(<span class="string">'VMT'</span>);
5042 
5043 <span class="comment">% Organized by GUI panels</span>
5044 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5045 <span class="comment">% SHIPTRACKS PLOT %</span>
5046 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5047 guiparams.horizontal_grid_node_spacing       = 1.0;
5048 guiparams.vertical_grid_node_spacing         = 0.4;
5049 
5050 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5051 <span class="comment">% CROSS SECTION PLOT %</span>
5052 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5053 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5054 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5055 guiparams.idx_contour                        = 1;
5056 guiparams.vertical_exaggeration              = 10;
5057 guiparams.vector_scale_cross_section         = 0.2;
5058 guiparams.horizontal_vector_spacing          = 1;
5059 guiparams.vertical_vector_spacing            = 1;
5060 guiparams.horizontal_smoothing_window        = 1;
5061 guiparams.vertical_smoothing_window          = 1;
5062 guiparams.plot_secondary_flow_vectors        = true;
5063 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5064 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5065 guiparams.idx_secondary_flow_vector_variable = 1;
5066 guiparams.include_vertical_velocity          = true;
5067 
5068 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5069 <span class="comment">% PLAN VIEW PLOT %</span>
5070 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5071 guiparams.depth_range_min                    = 0;
5072 guiparams.depth_range_max                    = inf;
5073 guiparams.vector_scale_plan_view             = 1;
5074 guiparams.vector_spacing_plan_view           = 1;
5075 guiparams.smoothing_window_size              = 1;
5076 guiparams.display_shoreline                  = false;
5077 guiparams.add_background                     = false;
5078 
5079 <span class="comment">%%%%%%%%%%%%%%%</span>
5080 <span class="comment">% DATA EXPORT %</span>
5081 <span class="comment">%%%%%%%%%%%%%%%</span>
5082 guiparams.beam_angle                         = 20.0;
5083 guiparams.magnetic_variation                 = 0.0;
5084 guiparams.wse                                = 0.0;
5085 guiparams.output_auxiliary_data              = false;
5086 
5087 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5088 <span class="comment">% Contour variables %</span>
5089 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5090 idx = 1;
5091 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5092 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5093 idx = idx + 1;
5094 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5095 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5096 idx = idx + 1;
5097 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5098 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5099 idx = idx + 1;
5100 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5101 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5102 idx = idx + 1;
5103 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5104 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5105 idx = idx + 1;
5106 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5107 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5108 idx = idx + 1;
5109 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5110 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5111 idx = idx + 1;
5112 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5113 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5114 idx = idx + 1;
5115 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5116 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5117 idx = idx + 1;
5118 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5119 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5120 idx = idx + 1;
5121 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5122 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5123 idx = idx + 1;
5124 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5125 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5126 idx = idx + 1;
5127 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5128 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5129 idx = idx + 1;
5130 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5131 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5132 idx = idx + 1;
5133 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5134 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5135 idx = idx + 1;
5136 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5137 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5138 idx = idx + 1;
5139 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5140 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5141 
5142 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5143 
5144 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5145 <span class="comment">% Secondary Flow Vector Variables %</span>
5146 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5147 idx = 1;
5148 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5149 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5150 idx = idx + 1;
5151 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5152 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5153 idx = idx + 1;
5154 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5155 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5156 idx = idx + 1;
5157 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5158 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5159 idx = idx + 1;
5160 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5161 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5162 
5163 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5164     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5165 
5166 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5167 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5168 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5169 <span class="comment">% Menu bar options</span>
5170 guiparams.presentation                       = true;
5171 guiparams.print                              = false;
5172 guiparams.set_cross_section_endpoints        = false;
5173 guiparams.unit_discharge_correction          = false;
5174 
5175 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5176     <span class="keyword">switch</span> guiprefs.units
5177         <span class="keyword">case</span> <span class="string">'metric'</span>
5178             guiparams.english_units          = false;
5179         <span class="keyword">case</span> <span class="string">'english'</span>
5180             guiparams.english_units          = true;
5181     <span class="keyword">end</span>
5182 <span class="keyword">else</span>
5183     guiparams.english_units                  = false;
5184 <span class="keyword">end</span>
5185 guiparams.vertical_offset                    = 0;
5186 
5187 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5188     guiparams.renderer                       = guiprefs.renderer;
5189 <span class="keyword">else</span>
5190     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5191 <span class="keyword">end</span>
5192 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5193 <span class="comment">% guiparams.plot_planview                      = false;</span>
5194 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5195 
5196 <span class="comment">% File location defaults</span>
5197 guiparams.ascii_path                        = pwd;
5198 guiparams.ascii_file                        = <span class="string">''</span>;
5199 guiparams.mat_path                          = pwd;
5200 guiparams.mat_file                          = <span class="string">''</span>;
5201 guiparams.tecplot_path                      = pwd;
5202 guiparams.tecplot_file                      = <span class="string">''</span>;
5203 guiparams.kmz_path                          = pwd;
5204 guiparams.kmz_file                          = <span class="string">''</span>;
5205 guiparams.multibeambathymetry_path          = pwd;
5206 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5207 guiparams.log_path                          = pwd;
5208 guiparams.log_file                          = <span class="string">''</span>;
5209 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5210 <span class="comment">% application</span>
5211 <span class="keyword">if</span> isdeployed 
5212     guiparams.has_mapping_toolbox           = true;
5213 <span class="keyword">else</span>
5214     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5215         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5216 <span class="keyword">end</span>
5217 
5218 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5219 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5220 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5221 guiparams.z                      = [];
5222 guiparams.A                      = [];
5223 guiparams.V                      = [];
5224 guiparams.Map                    = [];
5225 guiparams.savefile               = [];
5226 guiparams.iric_anv_planview_data = [];
5227 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5228 <span class="comment">% guiparams.zmax = [];</span>
5229 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5230 guiparams.data_folder = <span class="string">''</span>;
5231 guiparams.data_files  = {<span class="string">''</span>};
5232 guiparams.gui_state   = <span class="string">'init'</span>;
5233 
5234 <span class="comment">% [EOF] createGUIparams</span>
5235 
5236 <a name="_sub109" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5237 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5238 
5239 <a name="_sub110" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5240 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5241 
5242 <span class="comment">% [EOF] VMT</span>
5243 
5244 
5245 
5246 
5247 
5248 <span class="comment">% --- Hidden keyboard commands</span>
5249 <a name="_sub111" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5250 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5251 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5252 <span class="comment">%</span>
5253 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5254 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5255 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5256 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5257 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5258 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5259 
5260 in1 = eventdata.Modifier; 
5261 in2 = eventdata.Key;
5262 
5263 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5264     input = [in1{:} in2];
5265 <span class="keyword">else</span>
5266     input = in2;
5267 <span class="keyword">end</span>
5268 
5269 <span class="keyword">switch</span> input
5270     <span class="comment">% Hidden SonTek M9 support</span>
5271     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5272         msgtxt = {<span class="keyword">...</span>
5273             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5274             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5275             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5276             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5277             <span class="string">''</span>;<span class="keyword">...</span>
5278             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5279             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5280             <span class="string">'PROVISIONAL at best.'</span>};
5281         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5282         
5283         <span class="comment">% Get the Application data:</span>
5284         <span class="comment">% -------------------------</span>
5285         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5286         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5287         
5288         <span class="comment">% Ask the user to select files:</span>
5289         <span class="comment">% -----------------------------</span>
5290         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5291         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5292         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5293             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5294         <span class="keyword">else</span>
5295             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5296         <span class="keyword">end</span>
5297         [filename,pathname] = <span class="keyword">...</span>
5298             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5299             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5300             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5301         
5302         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5303             guiparams.data_folder = pathname;
5304             <span class="keyword">if</span> ischar(filename)
5305                 filename = {filename};
5306             <span class="keyword">end</span>
5307             guiparams.data_files = filename;
5308             guiparams.mat_file = <span class="string">''</span>;
5309             
5310             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5311             
5312             
5313             
5314             <span class="comment">% Update the preferences:</span>
5315             <span class="comment">% -----------------------</span>
5316             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5317             guiprefs.ascii_path = pathname;
5318             guiprefs.ascii_file = filename;
5319             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5320             <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5321             
5322             <span class="comment">% Push messages to Log Window:</span>
5323             <span class="comment">% ----------------------------</span>
5324             log_text = {<span class="keyword">...</span>
5325                 <span class="string">''</span>;<span class="keyword">...</span>
5326                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5327                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5328                 guiparams.data_folder;
5329                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5330                 char(filename)};
5331             statusLogging(handles.LogWindow, log_text)
5332             
5333             <span class="comment">% Read the file(s)</span>
5334             <span class="comment">% ----------------</span>
5335             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5336             
5337             [~,~,savefile,A,z] = <span class="keyword">...</span>
5338                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5339             guiparams.savefile = savefile;
5340             guiparams.A        = A;
5341             guiparams.z        = z;
5342             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5343             
5344             
5345             <span class="comment">% Update the GUI:</span>
5346             <span class="comment">% ---------------</span>
5347             <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5348         <span class="keyword">end</span>  
5349     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5350         SontekMAT2KML;
5351     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5352         <a href="#_sub46" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5353         
5354     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5355         VMT_BuildCustomFlatFile;
5356     <span class="keyword">otherwise</span>
5357         <span class="comment">%disp(input)</span>
5358 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 17-Sep-2014 10:34:03 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>