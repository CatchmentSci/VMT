<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub92" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub93" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub94" class="code">function initGUI(handles)</a></li><li><a href="#_sub95" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub96" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub97" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub98" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub99" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub100" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub101" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub102" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub103" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a></li><li><a href="#_sub104" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub105" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub106" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function icons = getIcons</a></li><li><a href="#_sub108" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub109" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub110" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub111" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub91" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub92" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub108" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = <span class="string">'v4.06'</span>;
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="comment">% else</span>
0122 <span class="comment">%     X = imread('VMT_Background.png');</span>
0123 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0124 <span class="comment">%     X = uint8(X);</span>
0125 <span class="comment">%     imshow(X,'Border','tight')</span>
0126 <span class="comment">% end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 
0133 <span class="comment">% Initialize the GUI:</span>
0134 <span class="comment">% -------------------</span>
0135 <a href="#_sub94" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0136 <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0137 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0138 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0139 pos = get(handles.figure1,<span class="string">'Position'</span>);
0140 <span class="comment">% pos(3) = 545;</span>
0141 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0142 movegui(handles.figure1,<span class="string">'center'</span>)
0143 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0144 
0145 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0146 <span class="comment">% the root</span>
0147 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0148 
0149 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0150 <span class="comment">% uiwait(handles.figure1);</span>
0151 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0152 
0153 
0154 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0155 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0156 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0157 <span class="comment">% hObject    handle to figure</span>
0158 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0159 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0160 
0161 <span class="comment">% Get default command line output from handles structure</span>
0162 varargout{1} = handles.output;
0163 <span class="comment">% [EOF] VMT_OutputFcn</span>
0164 
0165 <span class="comment">% --- Executes when figure1 is resized.</span>
0166 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0167 
0168 <span class="comment">% Draw the VMT Background</span>
0169 <span class="comment">% -----------------</span>
0170 pos = get(handles.figure1,<span class="string">'position'</span>);
0171 axes(handles.VMTBackground);
0172 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0173     X = imread(<span class="string">'VMT_Background.png'</span>);
0174     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0175 <span class="comment">% else</span>
0176 <span class="comment">%     X = imread('VMT_Background.png');</span>
0177 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0178 <span class="comment">%     X = uint8(X);</span>
0179 <span class="comment">%     imshow(X,'Border','tight')</span>
0180 <span class="comment">% end</span>
0181 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0182 
0183 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0184 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0185 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0186 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0187 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0188 
0189 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0190 close_button = questdlg(<span class="keyword">...</span>
0191     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0192     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0193 <span class="keyword">switch</span> close_button
0194     <span class="keyword">case</span> <span class="string">'Yes'</span>
0195         delete(hObject)
0196         close all hidden
0197     <span class="keyword">otherwise</span>
0198         <span class="keyword">return</span>
0199 <span class="keyword">end</span>
0200 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0201 
0202 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0203 <span class="comment">% MENU BAR CALLBACKS %</span>
0204 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0205 
0206 <span class="comment">% --------------------------------------------------------------------</span>
0207 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0208 <span class="comment">% Empty</span>
0209 
0210 <span class="comment">% --------------------------------------------------------------------</span>
0211 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0212 <span class="comment">% Empty</span>
0213 
0214 <span class="comment">% --------------------------------------------------------------------</span>
0215 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0216 <a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0217 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0221 
0222 <span class="comment">% Get the Application data:</span>
0223 <span class="comment">% -------------------------</span>
0224 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0225 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0226 
0227 <span class="comment">% Ask the user to select files:</span>
0228 <span class="comment">% -----------------------------</span>
0229 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0230 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0231 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0232     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0233 <span class="keyword">else</span>
0234     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0235 <span class="keyword">end</span>
0236 [filename,pathname] = <span class="keyword">...</span>
0237     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0238     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0239     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0240 
0241 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0242     <span class="comment">% Load the data:</span>
0243     <span class="comment">% --------------</span>
0244     vars = load(fullfile(pathname,filename));
0245     
0246     <span class="comment">% Make sure the selected file is a valid file:</span>
0247     <span class="comment">% --------------------------------------------</span>
0248     varnames = fieldnames(vars);
0249     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0250         guiparams.mat_path = pathname;
0251         guiparams.mat_file = filename;
0252         guiparams.z = vars.z;
0253         guiparams.A = vars.A;
0254         guiparams.V = vars.V;
0255         
0256         <span class="comment">% Update the preferences:</span>
0257         <span class="comment">% -----------------------</span>
0258         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0259         guiprefs.mat_path = pathname;
0260         guiprefs.mat_file = filename;
0261         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0262         <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0263                      
0264         <span class="comment">% Re-store the Application Data:</span>
0265         <span class="comment">% ------------------------------</span>
0266         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0267         
0268         <span class="comment">% Update the GUI:</span>
0269         <span class="comment">% ---------------</span>
0270         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0271         <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0272     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0273         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0274             <span class="string">'Invalid File...'</span>)
0275     <span class="keyword">end</span>
0276     
0277     <span class="comment">% Set the vertical grid node spacing</span>
0278     <span class="comment">% ----------------------------------</span>
0279     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0280     <span class="comment">% Backwards compatible</span>
0281     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0282         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0283     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0284         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0285     <span class="keyword">end</span>
0286     
0287 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0288     <span class="comment">% Set the filenames</span>
0289     <span class="comment">% -----------------</span>
0290     guiparams.mat_path = pathname;
0291     guiparams.mat_file = filename;
0292     
0293     <span class="comment">% Push status to log window</span>
0294     <span class="comment">% -------------------------</span>
0295     log_text = {<span class="keyword">...</span>
0296         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0297         <span class="string">'Directory:'</span>};
0298     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0299     statusLogging(handles.LogWindow,log_text)
0300     
0301     <span class="comment">% Update the Application Data:</span>
0302     <span class="comment">% ------------------------------</span>
0303     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0304     
0305     <span class="comment">% Update the persistent preferences:</span>
0306     <span class="comment">% ----------------------------------</span>
0307     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0308     guiprefs.mat_path = pathname;
0309     guiprefs.mat_file = filename;
0310     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0311     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0312         
0313     <span class="comment">% Update the GUI:</span>
0314     <span class="comment">% ---------------</span>
0315     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0316 <span class="keyword">end</span>
0317 
0318 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0319 
0320 <span class="comment">% --------------------------------------------------------------------</span>
0321 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0322 <span class="comment">% Empty</span>
0323 
0324 <span class="comment">% --------------------------------------------------------------------</span>
0325 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0326 <a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0327 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0328 
0329 <span class="comment">% --------------------------------------------------------------------</span>
0330 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0331 <a href="#_sub59" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0332 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0333 
0334 <span class="comment">% --------------------------------------------------------------------</span>
0335 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0336 <a href="#_sub60" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0337 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0338 
0339 <span class="comment">% --------------------------------------------------------------------</span>
0340 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0341 <span class="comment">% Empty</span>
0342 
0343 <span class="comment">% --------------------------------------------------------------------</span>
0344 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0345 <span class="comment">% Empty</span>
0346 
0347 <span class="comment">% --------------------------------------------------------------------</span>
0348 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0349 
0350 <span class="comment">% Get the Application Data:</span>
0351 <span class="comment">% -------------------------</span>
0352 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0353 
0354 <span class="comment">% Update the Application Data:</span>
0355 <span class="comment">% ----------------------------</span>
0356 guiparams.print        = true;
0357 guiparams.presentation = false;
0358 
0359 <span class="comment">% Re-store the Application data:</span>
0360 <span class="comment">% ------------------------------</span>
0361 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0362 
0363 <span class="comment">% Update the GUI:</span>
0364 <span class="comment">% ---------------</span>
0365 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0366 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0367 
0368 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0369 
0370 
0371 <span class="comment">% --------------------------------------------------------------------</span>
0372 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0373 
0374 <span class="comment">% Get the Application Data:</span>
0375 <span class="comment">% -------------------------</span>
0376 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0377 
0378 <span class="comment">% Update the Application Data:</span>
0379 <span class="comment">% ----------------------------</span>
0380 guiparams.print        = false;
0381 guiparams.presentation = true;
0382 
0383 <span class="comment">% Re-store the Application data:</span>
0384 <span class="comment">% ------------------------------</span>
0385 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0386 
0387 <span class="comment">% Update the GUI:</span>
0388 <span class="comment">% ---------------</span>
0389 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0390 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0391 
0392 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0393 
0394 <span class="comment">% --------------------------------------------------------------------</span>
0395 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0396 <span class="comment">%  --- Empty ---</span>
0397 
0398 <span class="comment">% --------------------------------------------------------------------</span>
0399 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0400 <span class="comment">% Get the Application Data:</span>
0401 <span class="comment">% -------------------------</span>
0402 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0403 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0404 
0405 <span class="comment">% Update the Application Data:</span>
0406 <span class="comment">% ----------------------------</span>
0407 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0408 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0409 
0410 <span class="comment">% Re-store the Application data:</span>
0411 <span class="comment">% ------------------------------</span>
0412 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0413 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0414 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0415 
0416 <span class="comment">% Update the GUI:</span>
0417 <span class="comment">% ---------------</span>
0418 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0419 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0420 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0421 
0422 <span class="comment">% Modify the existing figures</span>
0423 <span class="comment">% ---------------------------</span>
0424 <span class="comment">% Find what plots exist already</span>
0425 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0426 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0427 
0428 <span class="comment">% Loop through valid figures and adjust</span>
0429 <span class="comment">% -------------------------------------</span>
0430 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0431     <span class="keyword">for</span> i = 1:length(valid_names)
0432         <span class="comment">% Focus the figure</span>
0433         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0434         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0435             figure(hff)
0436             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0437         <span class="keyword">end</span>
0438         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0439         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0440             figure(hff)
0441             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0442         <span class="keyword">end</span>
0443     <span class="keyword">end</span>
0444 <span class="keyword">end</span>
0445 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0446 
0447 
0448 <span class="comment">% --------------------------------------------------------------------</span>
0449 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0450 <span class="comment">% Get the Application Data:</span>
0451 <span class="comment">% -------------------------</span>
0452 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0453 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0454 
0455 <span class="comment">% Update the Application Data:</span>
0456 <span class="comment">% ----------------------------</span>
0457 guiparams.renderer  = <span class="string">'painters'</span>;
0458 guiprefs.renderer   = <span class="string">'painters'</span>;
0459 
0460 <span class="comment">% Re-store the Application data:</span>
0461 <span class="comment">% ------------------------------</span>
0462 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0463 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0464 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0465 
0466 <span class="comment">% Update the GUI:</span>
0467 <span class="comment">% ---------------</span>
0468 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0469 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0470 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0471 
0472 <span class="comment">% Modify the existing figures</span>
0473 <span class="comment">% ---------------------------</span>
0474 <span class="comment">% Find what plots exist already</span>
0475 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0476 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0477 
0478 <span class="comment">% Loop through valid figures and adjust</span>
0479 <span class="comment">% -------------------------------------</span>
0480 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0481     <span class="keyword">for</span> i = 1:length(valid_names)
0482         <span class="comment">% Focus the figure</span>
0483         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0484         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0485             figure(hff)
0486             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0487         <span class="keyword">end</span>
0488         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0489         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0490             figure(hff)
0491             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0492         <span class="keyword">end</span>
0493     <span class="keyword">end</span>
0494 <span class="keyword">end</span>
0495 <span class="comment">% [EOF] menuPainters_Callback</span>
0496 
0497 <span class="comment">% --------------------------------------------------------------------</span>
0498 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0499 <span class="comment">% Get the Application Data:</span>
0500 <span class="comment">% -------------------------</span>
0501 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0502 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0503 
0504 <span class="comment">% Update the Application Data:</span>
0505 <span class="comment">% ----------------------------</span>
0506 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0507 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0508 
0509 <span class="comment">% Re-store the Application data:</span>
0510 <span class="comment">% ------------------------------</span>
0511 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0512 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0513 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0514 
0515 <span class="comment">% Update the GUI:</span>
0516 <span class="comment">% ---------------</span>
0517 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0518 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0519 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0520 
0521 <span class="comment">% Modify the existing figures</span>
0522 <span class="comment">% ---------------------------</span>
0523 <span class="comment">% Find what plots exist already</span>
0524 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0525 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0526 
0527 <span class="comment">% Loop through valid figures and adjust</span>
0528 <span class="comment">% -------------------------------------</span>
0529 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0530     <span class="keyword">for</span> i = 1:length(valid_names)
0531         <span class="comment">% Focus the figure</span>
0532         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0533         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0534             figure(hff)
0535             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0536         <span class="keyword">end</span>
0537         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0538         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0539             figure(hff)
0540             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0541         <span class="keyword">end</span>
0542     <span class="keyword">end</span>
0543 <span class="keyword">end</span>
0544 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0545 
0546 <span class="comment">% --------------------------------------------------------------------</span>
0547 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0548 <span class="comment">% Get the Application data:</span>
0549 <span class="comment">% -------------------------</span>
0550 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0551 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0552 
0553 <span class="comment">% Find what plots exist already</span>
0554 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0555 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0556 
0557 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0558 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0559 <span class="keyword">if</span> ~isempty(idx)
0560     fig_names(idx) = [];
0561 <span class="keyword">end</span>
0562 
0563 <span class="keyword">if</span> guiparams.presentation
0564     figure_style = <span class="string">'presentation'</span>;
0565 <span class="keyword">else</span>
0566     figure_style = <span class="string">'print'</span>;
0567 <span class="keyword">end</span>
0568 
0569 [selected_figures] = <a href="#_sub105" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0570 
0571 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0572     <span class="keyword">return</span>
0573 <span class="keyword">else</span>
0574     <span class="keyword">for</span> i = 1:length(selected_figures)
0575         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0576     <span class="keyword">end</span>
0577 <span class="keyword">end</span>
0578 
0579 
0580 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0581 
0582 <span class="comment">% --------------------------------------------------------------------</span>
0583 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0584 <span class="comment">% Get the Application data:</span>
0585 <span class="comment">% -------------------------</span>
0586 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0587 beam_angle             = guiparams.beam_angle; 
0588 magnetic_variation     = guiparams.magnetic_variation; 
0589 wse                    = guiparams.wse;
0590 output_auxiliary_data  = guiparams.output_auxiliary_data; 
0591 
0592 <span class="comment">% Open dialog and allow user to select settings</span>
0593 <span class="comment">% ---------------------------------------------</span>
0594 [beam_angle,<span class="keyword">...</span>
0595     magnetic_variation,<span class="keyword">...</span>
0596     wse,<span class="keyword">...</span>
0597     output_auxiliary_data] = <span class="keyword">...</span>
0598     <a href="#_sub103" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxiliary_data,handles.figure1);
0599 
0600 <span class="comment">% Re-store the Application data:</span>
0601 <span class="comment">% ------------------------------</span>
0602 guiparams.beam_angle            = beam_angle;
0603 guiparams.magnetic_variation    = magnetic_variation; 
0604 guiparams.wse                   = wse;
0605 guiparams.output_auxiliary_data = output_auxiliary_data;
0606 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0607 
0608 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0609 
0610 <span class="comment">% --------------------------------------------------------------------</span>
0611 <a name="_sub23" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0612 <a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0613 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0614 
0615 
0616 <span class="comment">% --------------------------------------------------------------------</span>
0617 <a name="_sub24" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0618 
0619 <span class="comment">% Get the Application Data:</span>
0620 <span class="comment">% -------------------------</span>
0621 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0622 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0623 PVdata    = guiparams.iric_anv_planview_data;
0624 iric_path = guiprefs.iric_path;
0625 iric_file = guiprefs.iric_file;
0626 
0627 <span class="comment">% Is there any planview data?</span>
0628 <span class="keyword">if</span> isempty(PVdata)
0629     <span class="comment">% Nothing to do, warn user</span>
0630     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0631     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0632 <span class="keyword">else</span>
0633     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0634     <span class="comment">% and smoothing (for iRiC)</span>
0635     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0636     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0637         fullfile(iric_path,iric_file));
0638     
0639     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0640         outfile = fullfile(iric_path,iric_file);
0641         log_text = vertcat(log_text,{outfile});
0642         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0643         outcount = fprintf(ofid,<span class="keyword">...</span>
0644             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0645         fclose(ofid);
0646     <span class="keyword">else</span>
0647         <span class="comment">% Return default iric_path and iric_file</span>
0648         iric_path = guiprefs.iric_path;
0649         iric_file = guiprefs.iric_file;
0650     <span class="keyword">end</span>
0651 <span class="keyword">end</span>
0652 
0653 <span class="comment">% Push messages to Log Window:</span>
0654 <span class="comment">% ----------------------------</span>
0655 statusLogging(handles.LogWindow, log_text)
0656 
0657 <span class="comment">% Store the persistent preferences:</span>
0658 <span class="comment">% ---------------------------------</span>
0659 guiprefs.iric_file = iric_file;
0660 guiprefs.iric_path = iric_path;
0661 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0662 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0663 
0664 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0665 
0666 <span class="comment">% --------------------------------------------------------------------</span>
0667 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0668 <span class="comment">% Get the Application Data:</span>
0669 <span class="comment">% -------------------------</span>
0670 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0671 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0672 excel_path  = guiprefs.excel_path;
0673 excel_file  = guiprefs.excel_file;
0674 
0675 <span class="comment">% Push messages to Log Window:</span>
0676 <span class="comment">% ----------------------------</span>
0677 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0678 statusLogging(handles.LogWindow, log_text)
0679 
0680 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0681 <span class="comment">% data.</span>
0682 <span class="keyword">if</span> iscell(guiparams.mat_file)
0683     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0684     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0685     <span class="comment">% Refresh the Application Data:</span>
0686     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0687     z           = guiparams.z;
0688     A           = guiparams.A;
0689     V           = guiparams.V;
0690     Map         = guiparams.Map;
0691     wse         = guiparams.wse;
0692     PVdata      = guiparams.iric_anv_planview_data;
0693     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0694         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0695     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0696         fullfile(excel_path,excel_file));
0697     
0698     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0699         outfile = fullfile(excel_path,excel_file);
0700         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0701         
0702     <span class="keyword">else</span>
0703         <span class="comment">% Return default excel_path and excel_file</span>
0704         excel_path = guiprefs.excel_path;
0705         excel_file = guiprefs.excel_file;
0706         outfile = fullfile(excel_path,excel_file);
0707         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0708     <span class="keyword">end</span>
0709     
0710     <span class="comment">% Delete the old file if it exists</span>
0711     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0712         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0713             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0714             <span class="string">'already exists. Overwriting file...'</span>});
0715         delete(outfile)
0716     <span class="keyword">end</span>
0717     
0718     <span class="comment">% Save DAV data to an Excel File</span>
0719     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0720     vmin = num2str(guiparams.depth_range_min);
0721     vmax = num2str(guiparams.depth_range_max);
0722     pvheaders = {<span class="keyword">...</span>
0723         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0724         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0725         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0726         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0727     
0728 
0729     <span class="comment">% Initialize Variables</span>
0730     pvdata = []; Dist = [];
0731     X = []; Y = []; E = [];
0732     Ve = []; Vn =[]; Vm = []; Vd = [];
0733     
0734     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0735     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0736         <span class="comment">% Load current MAT-file</span>
0737         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0738         
0739         <span class="comment">% Location and Bathy</span>
0740         X = [X V.mcsX(1,:)];
0741         Y = [Y V.mcsY(1,:)];
0742         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0743         E = [E V.mcsBedElev];
0744         
0745         <span class="comment">% Build layer-averaged velocities</span>
0746         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0747         V.mcsX(indx,:) = nan;
0748         V.mcsY(indx,:) = nan;
0749         V.mcsEast(indx,:) = nan;
0750         V.mcsNorth(indx,:) = nan;
0751         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0752         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0753         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0754         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0755         
0756         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0757     <span class="keyword">end</span>
0758     
0759     <span class="comment">% Put output into 1 matrix</span>
0760     pvdata = [<span class="keyword">...</span>
0761         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0762         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0763         ];
0764     pvdata(isnan(pvdata)) = -9999;
0765     
0766     <span class="comment">% Create table and write to Excel</span>
0767     pvout = num2cell(pvdata');
0768     pvout = vertcat(pvheaders,pvout);
0769     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0770     
0771     <span class="comment">% Close out waitbar</span>
0772     waitbar(1,hwait)
0773     delete(hwait)
0774     
0775     <span class="comment">% Push messages to Log Window:</span>
0776     <span class="comment">% ----------------------------</span>
0777     statusLogging(handles.LogWindow, log_text)
0778 <span class="keyword">else</span>
0779     
0780     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0781     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0782     <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0783     <span class="comment">% Refresh the Application Data:</span>
0784     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0785     z           = guiparams.z;
0786     A           = guiparams.A;
0787     V           = guiparams.V;
0788     Map         = guiparams.Map;
0789     wse         = guiparams.wse;
0790     PVdata      = guiparams.iric_anv_planview_data;
0791     
0792     
0793     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0794     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0795         fullfile(excel_path,excel_file));
0796     
0797     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0798         outfile = fullfile(excel_path,excel_file);
0799         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0800         
0801         <span class="comment">% Delete the old file if it exists</span>
0802         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0803             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0804                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0805                 <span class="string">'already exists. Overwriting file...'</span>});
0806             delete(outfile)
0807         <span class="keyword">end</span>
0808         
0809         <span class="comment">% Push messages to Log Window:</span>
0810         <span class="comment">% ----------------------------</span>
0811         statusLogging(handles.LogWindow, log_text)
0812         
0813         <span class="comment">% Save MCS Summary to an Excel File</span>
0814         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0815         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0816         sout = guiparams.data_files';
0817         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0818         sout = {<span class="keyword">...</span>
0819             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0820             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0821             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0822             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0823             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0824             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0825             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0826             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0827             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0828             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0829             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0830             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0831             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0832             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0833             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0834             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0835             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0836             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0837         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0838         
0839         <span class="comment">% Save DAV data to an Excel File</span>
0840         vmin = num2str(guiparams.depth_range_min);
0841         vmax = num2str(guiparams.depth_range_max);
0842         pvheaders = {<span class="keyword">...</span>
0843             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0844             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0845             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0846             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0847         
0848         <span class="comment">% Create block style matrix of all processed data</span>
0849         pvdata = [];
0850         
0851         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0852         <span class="comment">% you are looking upstream into the transect</span>
0853         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0854         
0855         <span class="comment">% Build bathy data matrix</span>
0856         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0857         
0858         <span class="comment">% Build layer-averaged velocities</span>
0859         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0860         V.mcsX(indx,:) = nan;
0861         V.mcsY(indx,:) = nan;
0862         V.mcsEast(indx,:) = nan;
0863         V.mcsNorth(indx,:) = nan;
0864         pvdata = [<span class="keyword">...</span>
0865             pvdata;<span class="keyword">...</span>
0866             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0867             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0868             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0869             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0870         pvdata(isnan(pvdata)) = -9999;
0871         pvout = num2cell(pvdata');
0872         pvout = vertcat(pvheaders,pvout);
0873         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0874         waitbar(4/5,hwait)
0875         
0876         <span class="comment">% Save MCS data to an Excel File</span>
0877         mcsheaders = {<span class="keyword">...</span>
0878             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0879             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0880             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0881             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0882             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0883             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0884             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0885             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0886             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0887             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0888             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0889             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0890             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0891             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0892             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0893             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0894         
0895         mcsdata = [<span class="keyword">...</span>
0896             V.mcsX(:)<span class="keyword">...</span>
0897             V.mcsY(:)<span class="keyword">...</span>
0898             V.mcsDist(:)<span class="keyword">...</span>
0899             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0900             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0901             V.mcsEast(:)<span class="keyword">...</span>
0902             V.mcsNorth(:)<span class="keyword">...</span>
0903             V.mcsVert(:)<span class="keyword">...</span>
0904             V.mcsMag(:)<span class="keyword">...</span>
0905             V.mcsDir(:)<span class="keyword">...</span>
0906             V.u(:)<span class="keyword">...</span>
0907             V.v(:)<span class="keyword">...</span>
0908             V.vp(:)<span class="keyword">...</span>
0909             V.vs(:)<span class="keyword">...</span>
0910             V.Roz.up(:)<span class="keyword">...</span>
0911             V.Roz.us(:)];
0912         mcsdata(isnan(mcsdata)) = -9999;
0913         
0914         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0915         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0916         waitbar(1,hwait)
0917         delete(hwait)
0918         
0919     <span class="keyword">else</span>
0920         <span class="comment">% Return default excel_path and excel_file</span>
0921         excel_path = guiprefs.excel_path;
0922         excel_file = guiprefs.excel_file;
0923         outfile = fullfile(excel_path,excel_file);
0924         log_text = {<span class="string">'User aborted Excel export...'</span>};
0925     <span class="keyword">end</span>
0926     
0927     
0928     
0929 <span class="keyword">end</span>
0930 
0931 <span class="comment">% Push messages to Log Window:</span>
0932 <span class="comment">% ----------------------------</span>
0933 statusLogging(handles.LogWindow, log_text)
0934 
0935 <span class="comment">% Store the persistent preferences:</span>
0936 <span class="comment">% ---------------------------------</span>
0937 guiprefs.excel_file = excel_file;
0938 guiprefs.excel_path = excel_path;
0939 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0940 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0941 
0942 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0943 
0944 <span class="comment">% --------------------------------------------------------------------</span>
0945 <a name="_sub26" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0946 <span class="comment">% Empty</span>
0947 
0948 <span class="comment">% --------------------------------------------------------------------</span>
0949 <a name="_sub27" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0950 <span class="comment">% Empty</span>
0951 
0952 <span class="comment">% --------------------------------------------------------------------</span>
0953 <a name="_sub28" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0954 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0955 
0956 <span class="comment">% Get the Application Data:</span>
0957 <span class="comment">% -------------------------</span>
0958 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0959 
0960 <span class="comment">% Update the GUI &amp; Application Data:</span>
0961 <span class="comment">% ----------------------------------</span>
0962 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0963 <span class="keyword">switch</span> status
0964     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0965         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0966         guiparams.unit_discharge_correction = false;
0967     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0968         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0969         guiparams.unit_discharge_correction = true;
0970 <span class="keyword">end</span>
0971 
0972 <span class="comment">% Re-store the Application data:</span>
0973 <span class="comment">% ------------------------------</span>
0974 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0975 
0976 
0977 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0978 
0979 <span class="comment">% --------------------------------------------------------------------</span>
0980 <a name="_sub29" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0981 <span class="comment">% Empty</span>
0982 
0983 <span class="comment">% --------------------------------------------------------------------</span>
0984 <a name="_sub30" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0985 <span class="comment">% Empty</span>
0986 
0987 <span class="comment">% --------------------------------------------------------------------</span>
0988 <a name="_sub31" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
0989 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
0990 
0991 <span class="comment">% Get the Application Data:</span>
0992 <span class="comment">% -------------------------</span>
0993 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0994 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0995 
0996 <span class="comment">% Update the Application Data:</span>
0997 <span class="comment">% ----------------------------</span>
0998 guiparams.english_units = false;
0999 guiprefs.units = <span class="string">'metric'</span>;
1000 
1001 <span class="comment">% Re-store the Application data:</span>
1002 <span class="comment">% ------------------------------</span>
1003 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1004 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1005 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1006 
1007 <span class="comment">% Update the GUI:</span>
1008 <span class="comment">% ---------------</span>
1009 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1010 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1011 
1012 <span class="comment">% [EOF] menuMetric_Callback</span>
1013 
1014 
1015 <span class="comment">% --------------------------------------------------------------------</span>
1016 <a name="_sub32" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1017 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1018 
1019 <span class="comment">% Get the Application Data:</span>
1020 <span class="comment">% -------------------------</span>
1021 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1022 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1023 
1024 <span class="comment">% Update the Application Data:</span>
1025 <span class="comment">% ----------------------------</span>
1026 guiparams.english_units = true;
1027 guiprefs.units = <span class="string">'english'</span>;
1028 
1029 <span class="comment">% Re-store the Application data:</span>
1030 <span class="comment">% ------------------------------</span>
1031 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1032 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1033 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1034 
1035 <span class="comment">% Update the GUI:</span>
1036 <span class="comment">% ---------------</span>
1037 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1038 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1039 
1040 <span class="comment">% [EOF] menuEnglish_Callback</span>
1041 
1042 
1043 <span class="comment">% --------------------------------------------------------------------</span>
1044 <a name="_sub33" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1045 <span class="comment">% Empty</span>
1046 
1047 <span class="comment">% --------------------------------------------------------------------</span>
1048 <a name="_sub34" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1049 <span class="comment">% Set cross-section endpoints automatically</span>
1050 
1051 <span class="comment">% Get the Application Data:</span>
1052 <span class="comment">% -------------------------</span>
1053 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1054 
1055 <span class="comment">% Update the Application Data:</span>
1056 <span class="comment">% ----------------------------</span>
1057 guiparams.set_cross_section_endpoints = false;
1058 
1059 <span class="comment">% Re-store the Application data:</span>
1060 <span class="comment">% ------------------------------</span>
1061 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1062 
1063 <span class="comment">% Update the GUI:</span>
1064 <span class="comment">% ---------------</span>
1065 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1066 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1067 
1068 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1069 
1070 
1071 <span class="comment">% --------------------------------------------------------------------</span>
1072 <a name="_sub35" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1073 <span class="comment">% Set cross-section endpoints manually</span>
1074 
1075 <span class="comment">% Get the Application Data:</span>
1076 <span class="comment">% -------------------------</span>
1077 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1078 
1079 <span class="comment">% Update the Application Data:</span>
1080 <span class="comment">% ----------------------------</span>
1081 guiparams.set_cross_section_endpoints = true;
1082 
1083 <span class="comment">% Re-store the Application data:</span>
1084 <span class="comment">% ------------------------------</span>
1085 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1086 
1087 <span class="comment">% Update the GUI:</span>
1088 <span class="comment">% ---------------</span>
1089 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1090 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1091 
1092 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1093 
1094 
1095 
1096 
1097 <span class="comment">% --------------------------------------------------------------------</span>
1098 <a name="_sub36" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1099 <span class="comment">% Empty</span>
1100 
1101 <span class="comment">% --------------------------------------------------------------------</span>
1102 <a name="_sub37" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1103 
1104 <span class="comment">% Get the Application Data:</span>
1105 <span class="comment">% -------------------------</span>
1106 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1107 
1108 <span class="comment">% Update the Application Data:</span>
1109 <span class="comment">% ----------------------------</span>
1110 guiparams.print        = true;
1111 guiparams.presentation = false;
1112 
1113 <span class="comment">% Re-store the Application data:</span>
1114 <span class="comment">% ------------------------------</span>
1115 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1116 
1117 <span class="comment">% Update the GUI:</span>
1118 <span class="comment">% ---------------</span>
1119 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1120 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1121 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1122 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1123 
1124 <span class="comment">% Modify the existing figures</span>
1125 <span class="comment">% ---------------------------</span>
1126 <span class="comment">% Find what plots exist already</span>
1127 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1128 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1129 
1130 <span class="comment">% Defaults for Print Stlye Figure</span>
1131 BkgdColor   = <span class="string">'white'</span>;
1132 AxColor     = <span class="string">'black'</span>;
1133 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1134 FntSize     = 14;
1135 
1136 <span class="comment">% Loop through valid figures and adjust</span>
1137 <span class="comment">% -------------------------------------</span>
1138 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1139     
1140     <span class="keyword">for</span> i = 1:length(valid_names)
1141         <span class="keyword">switch</span> valid_names{i}
1142             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1143                 <span class="comment">% Focus the figure</span>
1144                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1145                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1146                     figure(hff)
1147                     
1148                     <span class="comment">% Make the changes to figure</span>
1149                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1150                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1151                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1152                     set(gca,<span class="string">'Color'</span>,FigColor)
1153                     set(gca,<span class="string">'XColor'</span>,AxColor)
1154                     set(gca,<span class="string">'YColor'</span>,AxColor)
1155                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1156                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1157                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1158                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1159                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1160                 <span class="keyword">end</span>
1161             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1162                 <span class="comment">% Focus the figure</span>
1163                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1164                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1165                     figure(hff)
1166                     
1167                     <span class="comment">% Make the changes to figure</span>
1168                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1169                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1170                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1171                     set(gca,<span class="string">'Color'</span>,FigColor)
1172                     set(gca,<span class="string">'XColor'</span>,AxColor)
1173                     set(gca,<span class="string">'YColor'</span>,AxColor)
1174                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1175                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1176                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1177                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1178                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1179                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1180                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1181                 <span class="keyword">end</span>
1182             <span class="keyword">otherwise</span>
1183         <span class="keyword">end</span>
1184     <span class="keyword">end</span>
1185     
1186     
1187 <span class="keyword">end</span>
1188 
1189 
1190 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1191 
1192 
1193 <span class="comment">% --------------------------------------------------------------------</span>
1194 <a name="_sub38" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1195 <span class="comment">% Get the Application Data:</span>
1196 <span class="comment">% -------------------------</span>
1197 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1198 
1199 <span class="comment">% Update the Application Data:</span>
1200 <span class="comment">% ----------------------------</span>
1201 guiparams.print        = false;
1202 guiparams.presentation = true;
1203 
1204 <span class="comment">% Re-store the Application data:</span>
1205 <span class="comment">% ------------------------------</span>
1206 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1207 
1208 <span class="comment">% Update the GUI:</span>
1209 <span class="comment">% ---------------</span>
1210 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1211 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1212 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1213 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1214 
1215 <span class="comment">% Modify the existing figures</span>
1216 <span class="comment">% ---------------------------</span>
1217 <span class="comment">% Find what plots exist already</span>
1218 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1219 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1220 
1221 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1222 <span class="comment">% --------------------------------------</span>
1223 BkgdColor   = <span class="string">'black'</span>;
1224 AxColor     = <span class="string">'white'</span>;
1225 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1226 FntSize     = 14;
1227 
1228 <span class="comment">% Loop through valid figures and adjust</span>
1229 <span class="comment">% -------------------------------------</span>
1230 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1231     
1232     <span class="keyword">for</span> i = 1:length(valid_names)
1233         <span class="keyword">switch</span> valid_names{i}
1234             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1235                 <span class="comment">% Focus the figure</span>
1236                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1237                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1238                     figure(hff)
1239                     
1240                     <span class="comment">% Make the changes to figure</span>
1241                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1242                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1243                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1244                     set(gca,<span class="string">'Color'</span>,FigColor)
1245                     set(gca,<span class="string">'XColor'</span>,AxColor)
1246                     set(gca,<span class="string">'YColor'</span>,AxColor)
1247                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1248                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1249                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1250                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1251                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1252                     
1253                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1254                     <span class="comment">% the file(s) and path for the data</span>
1255                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1256                     <span class="keyword">if</span> ~ismultiplot
1257                         filestr = guiparams.savefile;
1258                         wd = length(filestr);
1259                         hd = 1;
1260                     <span class="keyword">else</span>
1261                         <span class="comment">% Construct a filename</span>
1262                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1263                         wd        = max(cellfun(@length,filestr));
1264                         hd        = numel(filestr);
1265                             
1266                     <span class="keyword">end</span>
1267                     
1268                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="keyword">...</span>
1269                         <span class="string">'units'</span>,<span class="string">'characters'</span>,<span class="keyword">...</span>
1270                         <span class="string">'tag'</span>,<span class="string">'fileinfotxt'</span>);
1271                     
1272                     <span class="comment">% Have to turn the toolbar back on after adding a uicontrol</span>
1273                     set(figure(hff), <span class="string">'toolbar'</span>,<span class="string">'figure'</span>)  
1274                     <span class="comment">% Turn off the menu bar, and keep only specified tools</span>
1275                     disableMenuBar(hff)
1276                     
1277                     set(fileinfotxt,<span class="keyword">...</span>
1278                         <span class="string">'string'</span>,filestr)
1279                     set(fileinfotxt,<span class="keyword">...</span>
1280                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1281                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1282                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1283                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1284                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>)
1285                     
1286                 <span class="keyword">end</span>
1287             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1288                 <span class="comment">% Focus the figure</span>
1289                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1290                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1291                     figure(hff)
1292                     
1293                     <span class="comment">% Make the changes to figure</span>
1294                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1295                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1296                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1297                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1298                     set(gca,<span class="string">'XColor'</span>,AxColor)
1299                     set(gca,<span class="string">'YColor'</span>,AxColor)
1300                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1301                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1302                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1303                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1304                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1305                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1306                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1307                     
1308                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1309                     <span class="comment">% the file(s) and path for the data</span>
1310                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1311                     <span class="keyword">if</span> ~ismultiplot
1312                         filestr = guiparams.savefile;
1313                         wd = length(filestr);
1314                         hd = 1;
1315                     <span class="keyword">else</span>
1316                         <span class="comment">% Construct a filename</span>
1317                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1318                         wd        = max(cellfun(@length,filestr));
1319                         hd        = numel(filestr);
1320                             
1321                     <span class="keyword">end</span>
1322                     
1323                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="keyword">...</span>
1324                         <span class="string">'units'</span>,<span class="string">'characters'</span>,<span class="keyword">...</span>
1325                         <span class="string">'tag'</span>,<span class="string">'fileinfotxt'</span>);
1326                     
1327                     <span class="comment">% Have to turn the toolbar back on after adding a uicontrol</span>
1328                     set(figure(hff), <span class="string">'toolbar'</span>,<span class="string">'figure'</span>)  
1329                     <span class="comment">% Turn off the menu bar, and keep only specified tools</span>
1330                     disableMenuBar(hff)
1331                     
1332                     set(fileinfotxt,<span class="keyword">...</span>
1333                         <span class="string">'string'</span>,filestr)
1334                     set(fileinfotxt,<span class="keyword">...</span>
1335                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1336                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1337                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1338                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1339                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>)
1340                 <span class="keyword">end</span>
1341             <span class="keyword">otherwise</span>
1342         <span class="keyword">end</span>
1343     <span class="keyword">end</span>
1344     
1345     
1346 <span class="keyword">end</span>
1347 
1348 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1349 
1350 <span class="comment">% --------------------------------------------------------------------</span>
1351 <a name="_sub39" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1352 
1353 <span class="comment">% Get the Application data:</span>
1354 <span class="comment">% -------------------------</span>
1355 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1356 
1357 <span class="comment">% Initialize the answer:</span>
1358 <span class="comment">% ----------------------</span>
1359 numstr = {num2str(guiparams.vertical_offset)};
1360 answer = NaN;
1361 <span class="keyword">while</span> isnan(answer)
1362     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1363     
1364     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1365         <span class="keyword">return</span>
1366     <span class="keyword">end</span>
1367     
1368     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1369     <span class="comment">% A numeric char will be a double</span>
1370 <span class="keyword">end</span>
1371 
1372 <span class="comment">% Re-store the Application data:</span>
1373 <span class="comment">% ------------------------------</span>
1374 guiparams.vertical_offset = answer;
1375 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1376 
1377 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1378 
1379 <span class="comment">% --------------------------------------------------------------------</span>
1380 <a name="_sub40" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1381 <span class="comment">% Not implemented</span>
1382 
1383 <span class="comment">% --------------------------------------------------------------------</span>
1384 <a name="_sub41" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1385 <span class="comment">% Empty</span>
1386 
1387 <span class="comment">% --------------------------------------------------------------------</span>
1388 <a name="_sub42" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1389 ASCII2GIS_GUI
1390 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1391 
1392 <span class="comment">% --------------------------------------------------------------------</span>
1393 <a name="_sub43" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1394 
1395 <span class="comment">% Get the Application preferences:</span>
1396 <span class="comment">% --------------------------------</span>
1397 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1398 
1399 inpath = guiprefs.kmz_path;
1400 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1401     infile = guiprefs.kmz_file{1};
1402 <span class="keyword">else</span>
1403     infile = guiprefs.kmz_file;
1404 <span class="keyword">end</span>
1405 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1406 
1407 guiprefs.kmz_path = outpath;
1408 guiprefs.kmz_file = outfile;
1409 
1410 <span class="comment">% Update persistent preferences</span>
1411 <span class="comment">% -----------------------------</span>
1412 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1413 
1414 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1415 
1416 <span class="comment">% --------------------------------------------------------------------</span>
1417 <a name="_sub44" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1418 <span class="comment">% Get the Application preferences:</span>
1419 <span class="comment">% --------------------------------</span>
1420 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1421 
1422 VMT_BatchMode;
1423 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1424 
1425 <span class="comment">% --------------------------------------------------------------------</span>
1426 <a name="_sub45" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1427 <span class="comment">% Empty</span>
1428 
1429 <span class="comment">% --------------------------------------------------------------------</span>
1430 <a name="_sub46" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1431 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1432 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1433     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version <span class="string">'.pdf'</span>]);
1434     
1435 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1436     
1437     <span class="keyword">if</span> isdeployed
1438         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1439             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1440         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1441             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1442             errLogFileName},<span class="keyword">...</span>
1443             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1444             <span class="string">'error'</span>);
1445         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1446         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1447         fclose(fid);
1448         rethrow(err)
1449     <span class="keyword">else</span>
1450         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1451             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1452             <span class="string">'error'</span>);
1453         rethrow(err);
1454     <span class="keyword">end</span>
1455 <span class="keyword">end</span>
1456 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1457 
1458 <span class="comment">% --------------------------------------------------------------------</span>
1459 <a name="_sub47" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1460 <span class="comment">% Get the Application data:</span>
1461 <span class="comment">% -------------------------</span>
1462 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1463 
1464 <span class="keyword">try</span>
1465     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1466     <span class="comment">% web-browser</span>
1467     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1468     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1469     system([<span class="string">'start '</span> webaddress]);
1470 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1471 <span class="keyword">catch</span> err 
1472     <span class="keyword">if</span> isdeployed
1473         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1474             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1475         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1476             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1477             errLogFileName},<span class="keyword">...</span>
1478             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1479             <span class="string">'error'</span>);
1480         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1481         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1482         fclose(fid);
1483         rethrow(err)
1484     <span class="keyword">else</span>
1485         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1486             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1487             <span class="string">'error'</span>);
1488         rethrow(err);
1489     <span class="keyword">end</span>
1490 <span class="keyword">end</span>
1491 
1492 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1493 
1494 <span class="comment">% --------------------------------------------------------------------</span>
1495 <a name="_sub48" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1496 
1497 <span class="comment">% Get the Application data:</span>
1498 <span class="comment">% -------------------------</span>
1499 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1500 
1501 <span class="comment">% Check version tag against the web, and display a message</span>
1502 <span class="keyword">try</span>
1503     current_vmt_version = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1504     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1505 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1506     <span class="keyword">if</span> isdeployed
1507         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1508             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1509         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1510             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1511             errLogFileName},<span class="keyword">...</span>
1512             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1513             <span class="string">'error'</span>);
1514         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1515         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1516         fclose(fid);
1517         rethrow(err)
1518     <span class="keyword">else</span>
1519         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1520             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1521             <span class="string">'error'</span>);
1522         rethrow(err);
1523     <span class="keyword">end</span>
1524 <span class="keyword">end</span>
1525 
1526 <span class="keyword">if</span> strcmpi(guiparams.vmt_version,current_vmt_version)
1527     h = msgbox(<span class="string">'VMT is currently up to date, no updates available.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1528 <span class="keyword">else</span>
1529     h = msgbox(<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>,<span class="string">'Check for updates'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1530 <span class="keyword">end</span>
1531 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1532 
1533 <span class="comment">% --------------------------------------------------------------------</span>
1534 <a name="_sub49" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1535 
1536 <span class="comment">% Get the Application data:</span>
1537 <span class="comment">% -------------------------</span>
1538 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1539 messagestr = <span class="keyword">...</span>
1540     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1541     [<span class="string">'   Version: '</span> guiparams.vmt_version];<span class="keyword">...</span>
1542     <span class="string">''</span>;<span class="keyword">...</span>
1543     <span class="string">''</span>;<span class="keyword">...</span>
1544     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1545     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1546     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1547     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1548     <span class="string">''</span>;<span class="keyword">...</span>
1549     <span class="string">''</span>;<span class="keyword">...</span>
1550     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1551     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1552     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1553     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1554     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1555     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1556     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1557 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1558 <span class="comment">% [EOF] menuAbout_Callback</span>
1559 
1560 
1561 
1562 
1563 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1564 <span class="comment">% TOOLBAR CALLBACKS %</span>
1565 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1566 
1567 <span class="comment">% --------------------------------------------------------------------</span>
1568 <a name="_sub50" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1569 <span class="comment">% Read Files into Data Structure using tfile.</span>
1570 
1571 <span class="comment">% Get the Application data:</span>
1572 <span class="comment">% -------------------------</span>
1573 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1574 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1575 
1576 <span class="comment">% Ask the user to select files:</span>
1577 <span class="comment">% -----------------------------</span>
1578 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1579 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1580     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1581     current_file, <span class="keyword">...</span>
1582     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1583 
1584 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1585     guiparams.data_folder = pathname;
1586     <span class="keyword">if</span> ischar(filename)
1587         filename = {filename};
1588     <span class="keyword">end</span>
1589     guiparams.data_files = filename;
1590     guiparams.mat_file = <span class="string">''</span>;
1591     
1592     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1593     
1594    
1595     
1596     <span class="comment">% Update the preferences:</span>
1597     <span class="comment">% -----------------------</span>
1598     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1599     guiprefs.ascii_path = pathname;
1600     guiprefs.ascii_file = filename;
1601     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1602     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1603     
1604     <span class="comment">% Push messages to Log Window:</span>
1605     <span class="comment">% ----------------------------</span>
1606     log_text = {<span class="keyword">...</span>
1607         <span class="string">''</span>;<span class="keyword">...</span>
1608         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1609         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1610         guiparams.data_folder;
1611         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1612         char(filename)};
1613     statusLogging(handles.LogWindow, log_text)
1614     
1615     <span class="comment">% Read the file(s)</span>
1616     <span class="comment">% ----------------</span>
1617     [~,~,savefile,A,z] = <span class="keyword">...</span>
1618         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1619     guiparams.savefile = savefile;
1620     guiparams.A        = A;
1621     guiparams.z        = z;
1622     
1623     
1624     <span class="comment">% Set the vertical grid node spacing</span>
1625     <span class="comment">% ----------------------------------</span>
1626     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1627     <span class="comment">% Backwards compatible</span>
1628     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1629         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1630         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1631     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1632         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1633         guiparams.vertical_grid_node_spacing = 0.4;
1634     <span class="keyword">end</span>
1635     
1636     
1637     <span class="comment">% Save application data</span>
1638     <span class="comment">% ---------------------</span>
1639     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1640        
1641 <span class="comment">%</span>
1642 <span class="comment">%     % Preprocess the data:</span>
1643 <span class="comment">%     % --------------------</span>
1644 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1645 <span class="comment">%</span>
1646 <span class="comment">%     % Push messages to Log Window:</span>
1647 <span class="comment">%     % ----------------------------</span>
1648 <span class="comment">%     log_text = {...</span>
1649 <span class="comment">%         '   Preprocessing complete.';...</span>
1650 <span class="comment">%         '   Begin Data Processing...'};</span>
1651 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1652 <span class="comment">%</span>
1653 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1654 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1655 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1656 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1657 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1658 <span class="comment">%</span>
1659 <span class="comment">%     % Push messages to Log Window:</span>
1660 <span class="comment">%     % ----------------------------</span>
1661 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1662 <span class="comment">%</span>
1663 <span class="comment">%     % Store the data:</span>
1664 <span class="comment">%     % ---------------</span>
1665 <span class="comment">%     guiparams.z = z;</span>
1666 <span class="comment">%     guiparams.A = A;</span>
1667 <span class="comment">%     guiparams.V = V;</span>
1668 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1669     
1670           
1671     <span class="comment">% Update the GUI:</span>
1672     <span class="comment">% ---------------</span>
1673     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1674     
1675     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1676     
1677 <span class="keyword">end</span>
1678 <span class="comment">% [EOF] loadDataCallback</span>
1679 
1680 
1681 
1682 <span class="comment">% --------------------------------------------------------------------</span>
1683 <a name="_sub51" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1684 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1685 
1686 <span class="comment">% Get the Application data:</span>
1687 <span class="comment">% -------------------------</span>
1688 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1689 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1690 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1691 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1692 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1693 
1694 [the_file,the_path] = <span class="keyword">...</span>
1695     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1696     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1697     fullfile(guiparams.mat_path,guiparams.savefile));
1698 
1699 <span class="comment">% Save the processed data to a MAT file:</span>
1700 <span class="comment">% --------------------------------------</span>
1701 <span class="keyword">if</span> ischar(the_file)
1702     guiparams.mat_path = the_path;
1703     guiparams.mat_file = the_file;
1704     guiparams.savefile = the_file;
1705     
1706     <span class="comment">% Re-store the Application data:</span>
1707     <span class="comment">% ------------------------------</span>
1708     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1709     
1710     <span class="comment">% Update the preferences:</span>
1711     <span class="comment">% -----------------------</span>
1712     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1713     guiprefs.mat_path = the_path;
1714     guiprefs.mat_file = the_file;
1715     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1716     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1717     
1718     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1719     savefile = fullfile(pathstr,[filename extension]);
1720     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1721     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1722     log_text = {<span class="keyword">...</span>
1723         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1724         savefile};
1725     statusLogging(handles.LogWindow,log_text)
1726     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1727 <span class="keyword">end</span>
1728 
1729 <span class="comment">% [EOF] saveDataCallback</span>
1730 
1731 
1732 <span class="comment">% --------------------------------------------------------------------</span>
1733 <a name="_sub52" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1734 
1735 <span class="comment">% Get the Application data:</span>
1736 <span class="comment">% -------------------------</span>
1737 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1738 z   = guiparams.z;
1739 A   = guiparams.A;
1740 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1741 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1742 
1743 <span class="comment">% Compute multibeam bathymetry:</span>
1744 <span class="comment">% -----------------------------</span>
1745 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1746 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1747 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1748     guiparams.beam_angle, <span class="keyword">...</span>
1749     guiparams.magnetic_variation, <span class="keyword">...</span>
1750     guiparams.wse, <span class="keyword">...</span>
1751     guiparams.output_auxiliary_data);
1752 
1753 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1754 
1755 <span class="comment">% [EOF] saveBathymetryCallback</span>
1756 
1757 <span class="comment">% --------------------------------------------------------------------</span>
1758 <a name="_sub53" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1759 
1760 <span class="comment">% Get the Application data:</span>
1761 <span class="comment">% -------------------------</span>
1762 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1763 
1764 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1765     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1766     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1767     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1768     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1769     handles.figure1);
1770 
1771 <span class="comment">% Update the GUI:</span>
1772 <span class="comment">% ---------------</span>
1773 <span class="keyword">if</span> guiparams.english_units
1774     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1775     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1776 <span class="keyword">else</span>
1777     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1778     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1779 <span class="keyword">end</span>
1780 
1781 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1782     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1783     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1784 <span class="keyword">else</span>
1785     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1786     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1787 <span class="keyword">end</span>
1788 
1789 <span class="keyword">if</span> guiparams.presentation
1790     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1791 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1792 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1793 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1794 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1795 <span class="keyword">else</span>
1796     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1797 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1798 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1799 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1800 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1801 <span class="keyword">end</span>
1802 
1803 <span class="comment">% Re-store the Application data:</span>
1804 <span class="comment">% ------------------------------</span>
1805 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1806 
1807 <span class="comment">% [EOF] plottingParametersCallback</span>
1808 
1809 
1810 <span class="comment">% --------------------------------------------------------------------</span>
1811 <a name="_sub54" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1812 
1813 <span class="comment">% Get the Application data:</span>
1814 <span class="comment">% -------------------------</span>
1815 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1816 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1817 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1818 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1819 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1820 
1821 <span class="comment">% [EOF] processingParametersCallback</span>
1822 
1823 
1824 <span class="comment">% --------------------------------------------------------------------</span>
1825 <a name="_sub55" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1826 <span class="comment">% Plot 1</span>
1827 
1828 <span class="comment">% Get the Application data:</span>
1829 <span class="comment">% -------------------------</span>
1830 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1831 z = guiparams.z;
1832 A = guiparams.A;
1833 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1834 <span class="comment">% Map = guiparams.Map;</span>
1835 setends = guiparams.set_cross_section_endpoints;
1836 
1837 <span class="comment">% Preprocess the data:</span>
1838 <span class="comment">% --------------------</span>
1839 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1840 
1841 <span class="comment">% Push messages to Log Window:</span>
1842 <span class="comment">% ----------------------------</span>
1843 log_text = {<span class="keyword">...</span>
1844     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1845     <span class="string">'   Begin Data Processing...'</span>};
1846 statusLogging(handles.LogWindow, log_text)
1847 
1848 <span class="comment">% Process the transects:</span>
1849 <span class="comment">% ----------------------</span>
1850 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1851 A(1).vgns = guiparams.vertical_grid_node_spacing;
1852 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1853 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1854     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1855 
1856 <span class="comment">% Compute the smoothed variables</span>
1857 <span class="comment">% ------------------------------</span>
1858 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1859 <span class="comment">% runtime.</span>
1860 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1861     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1862     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1863     guiparams.vertical_smoothing_window);
1864 
1865 <span class="comment">% Push messages to Log Window:</span>
1866 <span class="comment">% ----------------------------</span>
1867 statusLogging(handles.LogWindow, processing_log_text)
1868 
1869 <span class="comment">% Store the data:</span>
1870 <span class="comment">% ---------------</span>
1871 guiparams.z = z;
1872 guiparams.A = A;
1873 guiparams.V = V;
1874 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1875 
1876 <span class="comment">% Push messages to Log Window:</span>
1877 <span class="comment">% ----------------------------</span>
1878 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1879 statusLogging(handles.LogWindow, log_text)
1880 
1881 <span class="comment">% Create or replot the Shiptracks</span>
1882 <span class="comment">% -------------------------------</span>
1883 <span class="comment">% Grab the axes to the plot</span>
1884 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1885 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,setends,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1886 
1887 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1888 <span class="comment">% New plot display window</span>
1889 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1890 <span class="comment">% h = figure(1); clf</span>
1891 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1892 
1893 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1894 
1895 
1896 <span class="comment">% --------------------------------------------------------------------</span>
1897 <a name="_sub56" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1898 <span class="comment">% Plot 2</span>
1899 
1900 <span class="comment">% Get the Application data:</span>
1901 <span class="comment">% -------------------------</span>
1902 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1903 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1904 
1905 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1906     <span class="comment">% Push messages to Log Window:</span>
1907     <span class="comment">% ----------------------------</span>
1908     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
1909     statusLogging(handles.LogWindow, log_text)
1910     
1911        
1912     <span class="comment">% Push plotting parameters to log window:</span>
1913     <span class="comment">% ---------------------------------------</span>
1914     log_text = {<span class="keyword">...</span>
1915         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
1916         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
1917         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
1918         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
1919         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
1920         };
1921     statusLogging(handles.LogWindow, log_text)
1922     
1923     <span class="comment">% Plot the data:</span>
1924     <span class="comment">% --------------</span>
1925     z = [];
1926     A = [];
1927     V = [];
1928     Map = [];
1929     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
1930     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
1931         depth_range, <span class="keyword">...</span>
1932         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
1933         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
1934         guiparams.smoothing_window_size, <span class="keyword">...</span>
1935         guiparams.display_shoreline, <span class="keyword">...</span>
1936         guiparams.english_units, <span class="keyword">...</span>
1937         guiparams.mat_file, <span class="keyword">...</span>
1938         guiparams.mat_path); <span class="comment">% PLOT2</span>
1939     statusLogging(handles.LogWindow, log_text)
1940     
1941     <span class="comment">% Plot a Shoreline Map:</span>
1942     <span class="comment">% ---------------------</span>
1943     <span class="keyword">if</span> guiparams.display_shoreline
1944         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
1945             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
1946             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
1947             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1948         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
1949             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
1950             Map.UTMe   = mapdata(:,1);
1951             Map.UTMn   = mapdata(:,2);
1952             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
1953             <span class="comment">%Map.UTMzone = zone;</span>
1954         <span class="keyword">else</span>
1955             Map = [];
1956         <span class="keyword">end</span>
1957         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
1958         log_text = {<span class="keyword">...</span>
1959             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
1960             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
1961             };
1962         statusLogging(handles.LogWindow, log_text)
1963     <span class="keyword">else</span>
1964         Map = [];
1965     <span class="keyword">end</span>
1966     
1967 <span class="keyword">else</span>
1968     z = guiparams.z;
1969     A = guiparams.A;
1970     <span class="comment">% V = guiparams.V;</span>
1971     Map = guiparams.Map;
1972     
1973     <span class="comment">% Push messages to Log Window:</span>
1974     <span class="comment">% ----------------------------</span>
1975     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
1976     statusLogging(handles.LogWindow, log_text)
1977     
1978         
1979     <span class="comment">% Preprocess the data:</span>
1980     <span class="comment">% --------------------</span>
1981     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1982     
1983     <span class="comment">% Process the transects:</span>
1984     <span class="comment">% ----------------------</span>
1985     A(1).hgns = guiparams.horizontal_grid_node_spacing;
1986     A(1).vgns = guiparams.vertical_grid_node_spacing;
1987     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1988     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1989         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1990     
1991     <span class="comment">% Compute the smoothed variables</span>
1992     <span class="comment">% ------------------------------</span>
1993     <span class="comment">% This is required so that the V struc is complete at any point during</span>
1994     <span class="comment">% runtime.</span>
1995     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1996         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1997         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1998         guiparams.vertical_smoothing_window);
1999     
2000     <span class="comment">% Push messages to Log Window:</span>
2001     <span class="comment">% ----------------------------</span>
2002     statusLogging(handles.LogWindow, processing_log_text)
2003     
2004     <span class="comment">% Plot the cross section:</span>
2005     <span class="comment">% -----------------------</span>
2006     log_text = {<span class="keyword">...</span>
2007         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2008         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2009         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2010         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2011         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2012         };
2013     statusLogging(handles.LogWindow, log_text)
2014     
2015     <span class="comment">% Plot the data:</span>
2016     <span class="comment">% --------------</span>
2017     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2018     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2019     
2020     
2021     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2022         depth_range, <span class="keyword">...</span>
2023         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2024         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2025         guiparams.smoothing_window_size, <span class="keyword">...</span>
2026         guiparams.display_shoreline, <span class="keyword">...</span>
2027         guiparams.english_units, <span class="keyword">...</span>
2028         guiparams.mat_file, <span class="keyword">...</span>
2029         guiparams.mat_path); <span class="comment">% PLOT2</span>
2030     statusLogging(handles.LogWindow, log_text)
2031     
2032     <span class="comment">% Plot a Shoreline Map:</span>
2033     <span class="comment">% ---------------------</span>
2034     <span class="keyword">if</span> guiparams.display_shoreline
2035         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2036             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2037             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2038             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2039         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2040             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2041             Map.UTMe   = mapdata(:,1);
2042             Map.UTMn   = mapdata(:,2);
2043             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2044             <span class="comment">%Map.UTMzone = zone;</span>
2045         <span class="keyword">else</span>
2046             Map = [];
2047         <span class="keyword">end</span>
2048         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2049         log_text = {<span class="keyword">...</span>
2050             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2051             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2052             };
2053         statusLogging(handles.LogWindow, log_text)
2054     <span class="keyword">else</span>
2055         Map = [];
2056     <span class="keyword">end</span>
2057     
2058 <span class="keyword">end</span>
2059 
2060 <span class="keyword">if</span> guiparams.add_background
2061     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2062     statusLogging(handles.LogWindow, log_text)
2063 <span class="keyword">end</span>
2064 
2065 <span class="comment">% Update guiparams</span>
2066 <span class="comment">% ----------------</span>
2067 guiparams.z   = z;
2068 guiparams.A   = A;
2069 guiparams.V   = V;
2070 guiparams.Map = Map;
2071 guiparams.iric_anv_planview_data = PVdata;
2072 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2073 
2074 <span class="comment">% Update preferences</span>
2075 <span class="comment">% ------------------</span>
2076 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2077 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2078 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2079 
2080 <span class="comment">% Force plot to be formated properly</span>
2081 <span class="comment">% ----------------------------------</span>
2082 <span class="keyword">if</span> guiparams.presentation
2083     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2084 <span class="keyword">else</span>
2085     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2086 <span class="keyword">end</span>
2087 <span class="keyword">switch</span> guiparams.renderer
2088     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2089         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2090     <span class="keyword">case</span> <span class="string">'painters'</span>
2091         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2092     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2093         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2094 <span class="keyword">end</span>
2095 
2096 <span class="comment">% Focus the figure</span>
2097 <span class="comment">% ----------------</span>
2098 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2099 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2100     figure(hff)
2101 <span class="keyword">end</span>
2102 
2103 <span class="comment">% Start the Graphics Control Gui</span>
2104 <span class="comment">% ------------------------------</span>
2105 VMT_GraphicsControl
2106 
2107 <span class="comment">% [EOF] planviewPlotCallback</span>
2108 
2109 
2110 <span class="comment">% --------------------------------------------------------------------</span>
2111 <a name="_sub57" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2112 <span class="comment">% Plot 3</span>
2113 
2114 <span class="comment">% Get the Application data:</span>
2115 <span class="comment">% -------------------------</span>
2116 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2117 z = guiparams.z;
2118 A = guiparams.A;
2119 <span class="comment">% V = guiparams.V;</span>
2120 <span class="comment">% Map = guiparams.Map;</span>
2121 
2122 <span class="comment">% Preprocess the data:</span>
2123 <span class="comment">% --------------------</span>
2124 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2125 
2126 <span class="comment">% Push messages to Log Window:</span>
2127 <span class="comment">% ----------------------------</span>
2128 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2129 statusLogging(handles.LogWindow, log_text)
2130 
2131 <span class="comment">% Process the transects:</span>
2132 <span class="comment">% ----------------------</span>
2133 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2134 A(1).vgns = guiparams.vertical_grid_node_spacing;
2135 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2136 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2137     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2138 
2139 <span class="comment">% Push messages to Log Window:</span>
2140 <span class="comment">% ----------------------------</span>
2141 statusLogging(handles.LogWindow, processing_log_text)
2142 
2143 <span class="comment">% Plot the cross section:</span>
2144 <span class="comment">% -----------------------</span>
2145 log_text = {<span class="keyword">...</span>
2146     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2147     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2148     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2149     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2150     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2151     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2152     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2153     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2154     };
2155 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2156     log_text = vertcat(log_text, {<span class="keyword">...</span>
2157         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2158         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2159         });
2160 <span class="keyword">end</span>
2161 <span class="comment">% Push messages to Log Window:</span>
2162 <span class="comment">% ----------------------------</span>
2163 statusLogging(handles.LogWindow, log_text)
2164 
2165 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2166     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2167 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2168 <span class="comment">%         ...guiparams.contour, ...</span>
2169 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2170 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2171     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2172         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2173         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2174         guiparams.vertical_smoothing_window);
2175     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2176         guiparams.contour, <span class="keyword">...</span>
2177         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2178         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2179         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2180         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2181         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2182         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2183         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2184     
2185 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2186     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2187         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2188         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2189         guiparams.vertical_smoothing_window);
2190     
2191     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2192         guiparams.contour, <span class="keyword">...</span>
2193         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2194         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2195     
2196     guiparams.zmin = zmin;
2197     guiparams.zmax = zmax;
2198     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2199 <span class="keyword">end</span>
2200 
2201 <span class="comment">% Force plot to be formated properly</span>
2202 <span class="comment">% ----------------------------------</span>
2203 <span class="keyword">if</span> guiparams.presentation
2204     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2205 <span class="keyword">else</span>
2206     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2207 <span class="keyword">end</span>
2208 <span class="keyword">switch</span> guiparams.renderer
2209     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2210         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2211     <span class="keyword">case</span> <span class="string">'painters'</span>
2212         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2213     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2214         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2215 <span class="keyword">end</span>
2216 
2217 <span class="comment">% Focus the figure</span>
2218 <span class="comment">% ----------------</span>
2219 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2220 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2221     figure(hff)
2222 <span class="keyword">end</span>
2223 
2224 <span class="comment">% Re-store the Application data:</span>
2225 <span class="comment">% ------------------------------</span>
2226 guiparams.V = V;
2227 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2228 
2229 <span class="comment">% Start the Graphics Control Gui</span>
2230 <span class="comment">% ------------------------------</span>
2231 VMT_GraphicsControl
2232 
2233 <span class="comment">% Push messages to Log Window:</span>
2234 <span class="comment">% ----------------------------</span>
2235 statusLogging(handles.LogWindow, plot_cont_log_text)
2236 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2237 
2238 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2239 
2240 
2241 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2242 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2243 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2244 
2245 <span class="comment">% --------------------------------------------------------------------</span>
2246 <a name="_sub58" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2247 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2248 
2249 <span class="comment">% Get the Application data:</span>
2250 <span class="comment">% -------------------------</span>
2251 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2252 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2253 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2254 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2255 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2256 
2257 [the_file,the_path] = <span class="keyword">...</span>
2258     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2259     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2260     fullfile(guiparams.mat_path,guiparams.savefile));
2261 
2262 <span class="comment">% Save the processed data to a MAT file:</span>
2263 <span class="comment">% --------------------------------------</span>
2264 <span class="keyword">if</span> ischar(the_file)
2265     guiparams.mat_path = the_path;
2266     guiparams.mat_file = the_file;
2267     guiparams.savefile = the_file;
2268     
2269     <span class="comment">% Re-store the Application data:</span>
2270     <span class="comment">% ------------------------------</span>
2271     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2272     
2273     <span class="comment">% Update the preferences:</span>
2274     <span class="comment">% -----------------------</span>
2275     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2276     guiprefs.mat_path = the_path;
2277     guiprefs.mat_file = the_file;
2278     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2279     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2280     
2281     [~,filename,extension] = fileparts(guiparams.savefile);
2282     savefile = [filename extension];
2283     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2284         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2285     disp(<span class="string">'Saving Processed Data File...'</span>)
2286     disp(savefile)
2287     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2288 <span class="keyword">end</span>
2289 
2290 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2291 
2292 
2293 <span class="comment">% --------------------------------------------------------------------</span>
2294 <a name="_sub59" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2295 
2296 <span class="comment">% Get the Application data:</span>
2297 <span class="comment">% -------------------------</span>
2298 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2299 <span class="comment">% z   = guiparams.z;</span>
2300 <span class="comment">% A   = guiparams.A;</span>
2301 V   = guiparams.V;
2302 <span class="comment">% Map = guiparams.Map;</span>
2303 
2304 [the_file,the_path] = <span class="keyword">...</span>
2305     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2306     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2307     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2308 
2309 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2310 <span class="comment">% ------------------------------------------</span>
2311 <span class="keyword">if</span> ischar(the_file)
2312     guiparams.tecplot_path = the_path;
2313     guiparams.tecplot_file = the_file;
2314     
2315     <span class="comment">% Re-store the Application data:</span>
2316     <span class="comment">% ------------------------------</span>
2317     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2318     
2319     <span class="comment">% Update the preferences:</span>
2320     <span class="comment">% -----------------------</span>
2321     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2322     guiprefs.tecplot_path = the_path;
2323     guiprefs.tecplot_file = the_file;
2324     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2325     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2326     
2327     <span class="comment">% Push to log window</span>
2328     <span class="comment">% ------------------</span>
2329     log_text = {<span class="keyword">...</span>
2330         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2331         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2332         the_path;<span class="keyword">...</span>
2333         [<span class="string">'Filename: '</span> the_file]};
2334     statusLogging(handles.LogWindow,log_text)
2335         
2336     <span class="keyword">if</span> isempty(V)
2337         A = guiparams.A;
2338         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2339         A(1).vgns = guiparams.vertical_grid_node_spacing;
2340         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2341         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2342             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2343             guiparams.unit_discharge_correction);
2344     <span class="keyword">end</span>
2345     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2346     
2347     <span class="comment">% Push to log window</span>
2348     <span class="comment">% ------------------</span>
2349     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2350     statusLogging(handles.LogWindow,log_text)
2351     
2352     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2353     
2354     <span class="comment">% Push to log window</span>
2355     <span class="comment">% ------------------</span>
2356     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2357     statusLogging(handles.LogWindow,log_text)
2358    
2359 <span class="keyword">end</span>
2360 
2361 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2362 
2363 
2364 <span class="comment">% --------------------------------------------------------------------</span>
2365 <a name="_sub60" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2366 
2367 <span class="comment">% Get the Application data:</span>
2368 <span class="comment">% -------------------------</span>
2369 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2370 <span class="comment">% z   = guiparams.z;</span>
2371 A   = guiparams.A;
2372 V   = guiparams.V;
2373 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2374 
2375 [the_file,the_path] = <span class="keyword">...</span>
2376     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2377     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2378     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2379 
2380 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2381 <span class="comment">% -----------------------------------------------------</span>
2382 <span class="keyword">if</span> ischar(the_file)
2383     guiparams.kmz_path = the_path;
2384     guiparams.kmz_file = the_file;
2385     
2386     <span class="comment">% Re-store the Application data:</span>
2387     <span class="comment">% ------------------------------</span>
2388     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2389     
2390     <span class="comment">% Update the preferences:</span>
2391     <span class="comment">% -----------------------</span>
2392     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2393     guiprefs.kmz_path = the_path;
2394     guiprefs.kmz_file = the_file;
2395     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2396     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2397     
2398     <span class="comment">%     if guiparams.display_shoreline</span>
2399     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2400     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2401     <span class="comment">%                             guiparams.vertical_offset);</span>
2402     <span class="comment">%     end</span>
2403     <span class="keyword">if</span> isempty(V)
2404         A = guiparams.A;
2405         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2406         A(1).vgns = guiparams.vertical_grid_node_spacing;
2407         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2408         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2409             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2410             guiparams.unit_discharge_correction);
2411     <span class="keyword">end</span>
2412     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2413         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2414         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2415         guiparams.vertical_offset);
2416 <span class="keyword">end</span>
2417 
2418 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2419 
2420 
2421 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2422 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2423 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2424 
2425 <span class="comment">% --------------------------------------------------------------------</span>
2426 <a name="_sub61" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2427 
2428 <span class="comment">% Get the Application data:</span>
2429 <span class="comment">% -------------------------</span>
2430 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2431 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2432 z = guiparams.z;
2433 A = guiparams.A;
2434 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2435 <span class="comment">% Map = guiparams.Map;</span>
2436 setends = guiparams.set_cross_section_endpoints;
2437 
2438 [the_file,the_path] = <span class="keyword">...</span>
2439     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2440     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2441     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2442     guiprefs.multibeambathymetry_file));
2443 
2444 <span class="keyword">if</span> ischar(the_file)
2445     guiparams.multibeambathymetry_path = the_path;
2446     guiparams.multibeambathymetry_file = the_file;
2447     
2448     <span class="comment">% Re-store the Application data:</span>
2449     <span class="comment">% ------------------------------</span>
2450     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2451     
2452     <span class="comment">% Update the preferences:</span>
2453     <span class="comment">% -----------------------</span>
2454     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2455     guiprefs.multibeambathymetry_path = the_path;
2456     guiprefs.multibeambathymetry_file = the_file;
2457     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2458     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2459     
2460     <span class="keyword">if</span> guiparams.output_auxiliary_data
2461     <span class="keyword">end</span>
2462     
2463     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2464     
2465     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2466         guiparams.multibeambathymetry_file);
2467     
2468     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2469         [<span class="string">'   '</span> savefile]};
2470     statusLogging(handles.LogWindow,log_text)
2471     
2472     <span class="comment">% Process the transects:</span>
2473     <span class="comment">% ----------------------</span>
2474     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2475     A(1).vgns = guiparams.vertical_grid_node_spacing;
2476     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2477     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2478         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2479     
2480     <span class="comment">% Compute the smoothed variables</span>
2481     <span class="comment">% ------------------------------</span>
2482     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2483     <span class="comment">% runtime.</span>
2484     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2485         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2486         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2487         guiparams.vertical_smoothing_window);
2488     
2489     <span class="comment">% Push messages to Log Window:</span>
2490     <span class="comment">% ----------------------------</span>
2491     statusLogging(handles.LogWindow, processing_log_text)
2492 
2493     
2494     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2495         guiparams.A, <span class="keyword">...</span>
2496         savefile, <span class="keyword">...</span>
2497         guiparams.beam_angle, <span class="keyword">...</span>
2498         guiparams.magnetic_variation, <span class="keyword">...</span>
2499         guiparams.wse, <span class="keyword">...</span>
2500         guiparams.output_auxiliary_data);
2501     
2502     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2503     
2504 <span class="keyword">end</span>
2505 
2506 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2507 
2508 
2509 <span class="comment">% --------------------------------------------------------------------</span>
2510 <a name="_sub62" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2511 <span class="comment">% Get the beam angle</span>
2512 
2513 <span class="comment">% Get the Application data:</span>
2514 <span class="comment">% -------------------------</span>
2515 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2516 
2517 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2518 <span class="comment">% ----------------------------------------------------------------</span>
2519 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2520 is_a_number = ~isnan(new_beam_angle);
2521 is_positive = new_beam_angle&gt;=0;
2522 
2523 <span class="comment">% Modify the Application data:</span>
2524 <span class="comment">% ----------------------------</span>
2525 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2526     guiparams.beam_angle = new_beam_angle;
2527     
2528     <span class="comment">% Re-store the Application data:</span>
2529     <span class="comment">% ------------------------------</span>
2530     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2531     
2532 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2533     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2534 <span class="keyword">end</span>
2535 
2536 <span class="comment">% [EOF] BeamAngle_Callback</span>
2537 
2538 
2539 <span class="comment">% --------------------------------------------------------------------</span>
2540 <a name="_sub63" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2541 <span class="comment">% Get the Magnetic Variation</span>
2542 
2543 <span class="comment">% Get the Application data:</span>
2544 <span class="comment">% -------------------------</span>
2545 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2546 
2547 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2548 <span class="comment">% ----------------------------------------------------------------</span>
2549 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2550 is_a_number = ~isnan(new_magnetic_variation);
2551 is_positive = new_magnetic_variation&gt;=0;
2552 
2553 <span class="comment">% Modify the Application data:</span>
2554 <span class="comment">% ----------------------------</span>
2555 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2556     guiparams.magnetic_variation = new_magnetic_variation;
2557     
2558     <span class="comment">% Re-store the Application data:</span>
2559     <span class="comment">% ------------------------------</span>
2560     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2561     
2562 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2563     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2564 <span class="keyword">end</span>
2565 
2566 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2567 
2568 
2569 <span class="comment">% --------------------------------------------------------------------</span>
2570 <a name="_sub64" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2571 
2572 <span class="comment">% Get the Application data:</span>
2573 <span class="comment">% -------------------------</span>
2574 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2575 
2576 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2577 <span class="comment">% ----------------------------------------------------------------</span>
2578 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2579 is_a_number = ~isnan(new_wse);
2580 is_positive = new_wse&gt;=0;
2581 
2582 <span class="comment">% Modify the Application data:</span>
2583 <span class="comment">% ----------------------------</span>
2584 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2585     guiparams.wse = new_wse;
2586     
2587     <span class="comment">% Re-store the Application data:</span>
2588     <span class="comment">% ------------------------------</span>
2589     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2590     
2591 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2592     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2593 <span class="keyword">end</span>
2594 
2595 <span class="comment">% [EOF] WSE_Callback</span>
2596 
2597 
2598 <span class="comment">% --------------------------------------------------------------------</span>
2599 <a name="_sub65" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2600 <span class="comment">% Bathymetry Auxiliary Data</span>
2601 
2602 <span class="comment">% Get the Application data:</span>
2603 <span class="comment">% -------------------------</span>
2604 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2605 
2606 <span class="comment">% Modify the Application data:</span>
2607 <span class="comment">% ----------------------------</span>
2608 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2609 
2610 <span class="comment">% Re-store the Application data:</span>
2611 <span class="comment">% ------------------------------</span>
2612 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2613 
2614 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2615 
2616 
2617 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2618 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2619 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2620 
2621 <span class="comment">% --------------------------------------------------------------------</span>
2622 <a name="_sub66" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2623 
2624 <span class="comment">% Get the Application data:</span>
2625 <span class="comment">% -------------------------</span>
2626 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2627 
2628 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2629 <span class="comment">% ----------------------------------------------------------------</span>
2630 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2631 is_a_number = ~isnan(new_depth_range_min);
2632 is_positive = new_depth_range_min&gt;=0;
2633 
2634 <span class="comment">% Modify the Application data:</span>
2635 <span class="comment">% ----------------------------</span>
2636 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2637     guiparams.depth_range_min = new_depth_range_min;
2638     
2639     <span class="comment">% Re-store the Application data:</span>
2640     <span class="comment">% ------------------------------</span>
2641     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2642     
2643 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2644     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2645 <span class="keyword">end</span>
2646 
2647 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2648 
2649 
2650 <span class="comment">% --------------------------------------------------------------------</span>
2651 <a name="_sub67" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2652 
2653 <span class="comment">% Get the Application data:</span>
2654 <span class="comment">% -------------------------</span>
2655 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2656 
2657 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2658 <span class="comment">% ----------------------------------------------------------------</span>
2659 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2660 is_a_number = ~isnan(new_depth_range_max);
2661 is_positive = new_depth_range_max&gt;=0;
2662 
2663 <span class="comment">% Modify the Application data:</span>
2664 <span class="comment">% ----------------------------</span>
2665 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2666     guiparams.depth_range_max = new_depth_range_max;
2667     
2668     <span class="comment">% Re-store the Application data:</span>
2669     <span class="comment">% ------------------------------</span>
2670     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2671     
2672 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2673     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2674 <span class="keyword">end</span>
2675 
2676 <span class="comment">% [EOF] DepthMax_Callback</span>
2677 
2678 
2679 <span class="comment">% --------------------------------------------------------------------</span>
2680 <a name="_sub68" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2681 <span class="comment">% Set quiver scale (contour)</span>
2682 
2683 <span class="comment">% Get the Application data:</span>
2684 <span class="comment">% -------------------------</span>
2685 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2686 
2687 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2688 <span class="comment">% ----------------------------------------------------------------</span>
2689 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2690 is_a_number = ~isnan(new_vector_scale_plan_view);
2691 is_positive = new_vector_scale_plan_view&gt;=0;
2692 
2693 <span class="comment">% Modify the Application data:</span>
2694 <span class="comment">% ----------------------------</span>
2695 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2696     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2697     
2698     <span class="comment">% Re-store the Application data:</span>
2699     <span class="comment">% ------------------------------</span>
2700     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2701     
2702 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2703     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2704 <span class="keyword">end</span>
2705 
2706 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2707 
2708 
2709 <span class="comment">% --------------------------------------------------------------------</span>
2710 <a name="_sub69" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2711 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2712 
2713 <span class="comment">% Get the Application data:</span>
2714 <span class="comment">% -------------------------</span>
2715 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2716 
2717 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2718 <span class="comment">% ----------------------------------------------------------------</span>
2719 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2720 is_a_number = ~isnan(new_vector_spacing_plan_view);
2721 is_positive = new_vector_spacing_plan_view&gt;=0;
2722 
2723 <span class="comment">% Modify the Application data:</span>
2724 <span class="comment">% ----------------------------</span>
2725 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2726     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2727     
2728     <span class="comment">% Re-store the Application data:</span>
2729     <span class="comment">% ------------------------------</span>
2730     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2731     
2732 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2733     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2734 <span class="keyword">end</span>
2735 
2736 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2737 
2738 
2739 <span class="comment">% --------------------------------------------------------------------</span>
2740 <a name="_sub70" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2741 <span class="comment">% Plan View smoothing window size</span>
2742 
2743 <span class="comment">% Get the Application data:</span>
2744 <span class="comment">% -------------------------</span>
2745 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2746 
2747 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2748 <span class="comment">% ----------------------------------------------------------------</span>
2749 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2750 is_a_number = ~isnan(new_smoothing_window_size);
2751 is_positive = new_smoothing_window_size&gt;=0;
2752 
2753 <span class="comment">% Modify the Application data:</span>
2754 <span class="comment">% ----------------------------</span>
2755 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2756     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2757     
2758     <span class="comment">% Re-store the Application data:</span>
2759     <span class="comment">% ------------------------------</span>
2760     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2761     
2762 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2763     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2764 <span class="keyword">end</span>
2765 
2766 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2767 
2768 
2769 <span class="comment">% --------------------------------------------------------------------</span>
2770 <a name="_sub71" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2771 
2772 <span class="comment">% Get the Application data:</span>
2773 <span class="comment">% -------------------------</span>
2774 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2775 
2776 <span class="comment">% Modify the Application data:</span>
2777 <span class="comment">% ----------------------------</span>
2778 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2779 
2780 <span class="comment">% Re-store the Application data:</span>
2781 <span class="comment">% ------------------------------</span>
2782 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2783 
2784 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2785 
2786 
2787 <span class="comment">% --------------------------------------------------------------------</span>
2788 <a name="_sub72" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2789 
2790 <span class="comment">% Get the Application data:</span>
2791 <span class="comment">% -------------------------</span>
2792 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2793 
2794 <span class="comment">% Modify the Application data:</span>
2795 <span class="comment">% ----------------------------</span>
2796 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2797 
2798 <span class="comment">% Re-store the Application data:</span>
2799 <span class="comment">% ------------------------------</span>
2800 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2801 
2802 <span class="comment">% [EOF] AddBackground_Callback</span>
2803 
2804 
2805 <span class="comment">% --------------------------------------------------------------------</span>
2806 <a name="_sub73" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2807 <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2808 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2809 
2810 
2811 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2812 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2813 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2814 
2815 <span class="comment">% --------------------------------------------------------------------</span>
2816 <a name="_sub74" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2817 <span class="comment">% Set the horizontal grid node spacing</span>
2818 
2819 <span class="comment">% Get the Application data:</span>
2820 <span class="comment">% -------------------------</span>
2821 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2822 
2823 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2824 <span class="comment">% ----------------------------------------------------------------</span>
2825 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2826 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2827 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2828 
2829 <span class="comment">% Modify the Application data:</span>
2830 <span class="comment">% ----------------------------</span>
2831 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2832     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
2833     
2834     <span class="comment">% Re-store the Application data:</span>
2835     <span class="comment">% ------------------------------</span>
2836     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2837     
2838 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2839     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2840 <span class="keyword">end</span>
2841 
2842 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2843 
2844 <span class="comment">% --------------------------------------------------------------------</span>
2845 <a name="_sub75" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2846 <span class="comment">% Set the horizontal grid node spacing</span>
2847 
2848 <span class="comment">% Get the Application data:</span>
2849 <span class="comment">% -------------------------</span>
2850 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2851 
2852 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2853 <span class="comment">% ----------------------------------------------------------------</span>
2854 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2855 is_a_number = ~isnan(new_vertical_grid_node_spacing);
2856 is_positive = new_vertical_grid_node_spacing&gt;=0;
2857 
2858 <span class="comment">% Modify the Application data:</span>
2859 <span class="comment">% ----------------------------</span>
2860 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2861     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
2862     
2863     <span class="comment">% Re-store the Application data:</span>
2864     <span class="comment">% ------------------------------</span>
2865     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2866     
2867 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2868     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
2869 <span class="keyword">end</span>
2870 
2871 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
2872 
2873 <span class="comment">% --------------------------------------------------------------------</span>
2874 <a name="_sub76" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2875 <span class="comment">% Set the cross section endpoints manually</span>
2876 
2877 <span class="comment">% Get the Application data:</span>
2878 <span class="comment">% -------------------------</span>
2879 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2880 
2881 <span class="comment">% Modify the Application data:</span>
2882 <span class="comment">% ----------------------------</span>
2883 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2884 
2885 <span class="comment">% Re-store the Application data:</span>
2886 <span class="comment">% ------------------------------</span>
2887 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2888 
2889 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2890 
2891 
2892 <span class="comment">% --------------------------------------------------------------------</span>
2893 <a name="_sub77" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
2894 <a href="#_sub55" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
2895 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
2896 
2897 
2898 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2899 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
2900 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2901 
2902 <span class="comment">% --------------------------------------------------------------------</span>
2903 <a name="_sub78" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
2904 
2905 <span class="comment">% Get the Application data:</span>
2906 <span class="comment">% -------------------------</span>
2907 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2908 
2909 <span class="comment">% Modify the Application data:</span>
2910 <span class="comment">% ----------------------------</span>
2911 idx_variable = get(hObject,<span class="string">'Value'</span>);
2912 guiparams.idx_contour = idx_variable;
2913 guiparams.contour = guiparams.contours(idx_variable).variable;
2914 
2915 <span class="comment">% Re-store the Application data:</span>
2916 <span class="comment">% ------------------------------</span>
2917 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2918 
2919 <span class="comment">% [EOF] Contour_Callback</span>
2920 
2921 
2922 <span class="comment">% --------------------------------------------------------------------</span>
2923 <a name="_sub79" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
2924 <span class="comment">% Set vertical exaggeration</span>
2925 
2926 <span class="comment">% Get the Application data:</span>
2927 <span class="comment">% -------------------------</span>
2928 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2929 
2930 <span class="comment">% Modify the Application data:</span>
2931 <span class="comment">% ----------------------------</span>
2932 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
2933 
2934 <span class="comment">% Re-store the Application data:</span>
2935 <span class="comment">% ------------------------------</span>
2936 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2937 
2938 <span class="comment">% Update the GUI:</span>
2939 <span class="comment">% ---------------</span>
2940 <span class="comment">% updateGUI(handles,guiparams)</span>
2941 
2942 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
2943 
2944 
2945 <span class="comment">% --------------------------------------------------------------------</span>
2946 <a name="_sub80" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
2947 
2948 <span class="comment">% Get the Application data:</span>
2949 <span class="comment">% -------------------------</span>
2950 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2951 
2952 <span class="comment">% Modify the Application data:</span>
2953 <span class="comment">% ----------------------------</span>
2954 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
2955 
2956 <span class="comment">% Re-store the Application data:</span>
2957 <span class="comment">% ------------------------------</span>
2958 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2959 
2960 <span class="comment">% Update the GUI:</span>
2961 <span class="comment">% ---------------</span>
2962 <span class="comment">% updateGUI(handles,guiparams)</span>
2963 
2964 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
2965 
2966 
2967 <span class="comment">% --------------------------------------------------------------------</span>
2968 <a name="_sub81" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2969 
2970 <span class="comment">% Get the Application data:</span>
2971 <span class="comment">% -------------------------</span>
2972 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2973 
2974 <span class="comment">% Modify the Application data:</span>
2975 <span class="comment">% ----------------------------</span>
2976 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2977 
2978 <span class="comment">% Re-store the Application data:</span>
2979 <span class="comment">% ------------------------------</span>
2980 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2981 
2982 <span class="comment">% Update the GUI:</span>
2983 <span class="comment">% ---------------</span>
2984 <span class="comment">% updateGUI(handles,guiparams)</span>
2985 
2986 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
2987 
2988 
2989 <span class="comment">% --------------------------------------------------------------------</span>
2990 <a name="_sub82" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
2991 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
2992 
2993 <span class="comment">% Get the Application data:</span>
2994 <span class="comment">% -------------------------</span>
2995 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2996 
2997 <span class="comment">% Modify the Application data:</span>
2998 <span class="comment">% ----------------------------</span>
2999 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3000 
3001 <span class="comment">% Re-store the Application data:</span>
3002 <span class="comment">% ------------------------------</span>
3003 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3004 
3005 <span class="comment">% Update the GUI:</span>
3006 <span class="comment">% ---------------</span>
3007 <span class="comment">% updateGUI(handles,guiparams)</span>
3008 
3009 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3010 
3011 
3012 <span class="comment">% --------------------------------------------------------------------</span>
3013 <a name="_sub83" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3014 <span class="comment">% Horizontal Smoothing</span>
3015 
3016 <span class="comment">% Get the Application data:</span>
3017 <span class="comment">% -------------------------</span>
3018 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3019 
3020 <span class="comment">% Modify the Application data:</span>
3021 <span class="comment">% ----------------------------</span>
3022 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3023 
3024 <span class="comment">% Re-store the Application data:</span>
3025 <span class="comment">% ------------------------------</span>
3026 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3027 
3028 <span class="comment">% Update the GUI:</span>
3029 <span class="comment">% ---------------</span>
3030 <span class="comment">% updateGUI(handles,guiparams)</span>
3031 
3032 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3033 
3034 
3035 <span class="comment">% --------------------------------------------------------------------</span>
3036 <a name="_sub84" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3037 <span class="comment">% Vertical Smoothing</span>
3038 
3039 <span class="comment">% Get the Application data:</span>
3040 <span class="comment">% -------------------------</span>
3041 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3042 
3043 <span class="comment">% Modify the Application data:</span>
3044 <span class="comment">% ----------------------------</span>
3045 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3046 
3047 <span class="comment">% Re-store the Application data:</span>
3048 <span class="comment">% ------------------------------</span>
3049 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3050 
3051 <span class="comment">% Update the GUI:</span>
3052 <span class="comment">% ---------------</span>
3053 <span class="comment">% updateGUI(handles,guiparams)</span>
3054 
3055 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3056 
3057 
3058 <span class="comment">% --------------------------------------------------------------------</span>
3059 <a name="_sub85" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3060 
3061 <span class="comment">% Get the Application data:</span>
3062 <span class="comment">% -------------------------</span>
3063 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3064 
3065 <span class="comment">% Modify the Application data:</span>
3066 <span class="comment">% ----------------------------</span>
3067 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3068 
3069 <span class="comment">% Re-store the Application data:</span>
3070 <span class="comment">% ------------------------------</span>
3071 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3072 
3073 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3074 
3075 
3076 <span class="comment">% --------------------------------------------------------------------</span>
3077 <a name="_sub86" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3078 
3079 <span class="comment">% Get the Application data:</span>
3080 <span class="comment">% -------------------------</span>
3081 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3082 
3083 <span class="comment">% Modify the Application data:</span>
3084 <span class="comment">% ----------------------------</span>
3085 idx_variable = get(hObject,<span class="string">'Value'</span>);
3086 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3087 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3088 
3089 <span class="comment">% Re-store the Application data:</span>
3090 <span class="comment">% ------------------------------</span>
3091 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3092 
3093 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3094 
3095 
3096 <span class="comment">% --------------------------------------------------------------------</span>
3097 <a name="_sub87" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3098 
3099 <span class="comment">% Get the Application data:</span>
3100 <span class="comment">% -------------------------</span>
3101 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3102 
3103 <span class="comment">% Modify the Application data:</span>
3104 <span class="comment">% ----------------------------</span>
3105 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3106 
3107 <span class="comment">% Re-store the Application data:</span>
3108 <span class="comment">% ------------------------------</span>
3109 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3110 
3111 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3112 
3113 
3114 <span class="comment">% --------------------------------------------------------------------</span>
3115 <a name="_sub88" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3116 <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3117 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3118 
3119 
3120 <span class="comment">% --------------------------------------------------------------------</span>
3121 <a name="_sub89" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3122 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3123 <span class="comment">% [EOF] ClearLog_Callback</span>
3124 
3125 <span class="comment">% --------------------------------------------------------------------</span>
3126 <a name="_sub90" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3127 
3128 <span class="comment">% Get the Application data:</span>
3129 <span class="comment">% -------------------------</span>
3130 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3131 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3132 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3133 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3134 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3135 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3136 
3137 [the_file,the_path] = <span class="keyword">...</span>
3138     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3139     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3140     fullfile(guiprefs.log_path,guiprefs.log_file));
3141 
3142 <span class="comment">% Save the log to a TXT file:</span>
3143 <span class="comment">% ---------------------------</span>
3144 <span class="keyword">if</span> ischar(the_file)
3145     guiparams.log_path = the_path;
3146     guiparams.log_file = the_file;
3147     <span class="comment">%guiparams.savefile = the_file;</span>
3148     
3149     <span class="comment">% Re-store the Application data:</span>
3150     <span class="comment">% ------------------------------</span>
3151     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3152     
3153     <span class="comment">% Update the preferences:</span>
3154     <span class="comment">% -----------------------</span>
3155     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3156     guiprefs.log_path = the_path;
3157     guiprefs.log_file = the_file;
3158     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3159     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3160     
3161     [~,filename,extension] = fileparts(the_file);
3162     savefile = [the_path filename extension];
3163     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3164         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3165     
3166     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3167     [nrows,~]= size(logfile);
3168     fid = fopen(savefile, <span class="string">'w'</span>);
3169     <span class="keyword">for</span> row=1:nrows
3170         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3171     <span class="keyword">end</span>
3172     fclose(fid);
3173 <span class="keyword">end</span>
3174 <span class="comment">% [EOF] SaveLog_Callback</span>
3175 
3176 <span class="comment">%%%%%%%%%%%%%%%%</span>
3177 <span class="comment">% SUBFUNCTIONS %</span>
3178 <span class="comment">%%%%%%%%%%%%%%%%</span>
3179 
3180 <span class="comment">% --------------------------------------------------------------------</span>
3181 <a name="_sub91" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3182 
3183 icons = <a href="#_sub107" class="code" title="subfunction icons = getIcons">getIcons</a>;
3184 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3185 
3186 <span class="comment">% Load data</span>
3187 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3188 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3189 <span class="comment">% icon(icon==0) = NaN;</span>
3190 handles.toolbarLoadData = <span class="keyword">...</span>
3191     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3192     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3193     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3194 
3195 <span class="comment">% Save data</span>
3196 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3197 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3198 <span class="comment">% icon(icon==0) = NaN;</span>
3199 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3200     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3201     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3202     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3203     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3204 
3205 
3206 <span class="comment">% Save bathymetry</span>
3207 <span class="comment">%icon = ones(16,16,3);</span>
3208 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3209     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3210     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3211     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3212 
3213 <span class="comment">% Save figures</span>
3214 <span class="comment">% icon = ones(16,16,3);</span>
3215 handles.toolbarSaveFigures = <span class="keyword">...</span>
3216     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3217     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3218     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3219 
3220 <span class="comment">% Save Excel File</span>
3221 <span class="comment">% icon = ones(16,16,3);</span>
3222 handles.toolbarSaveExcel = <span class="keyword">...</span>
3223     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3224     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3225     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3226 
3227 
3228 <span class="comment">% Plotting parameters</span>
3229 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3230 <span class="comment">% icon = ind2rgb(icon,map);</span>
3231 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3232     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3233     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3234     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3235     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3236 
3237 <span class="comment">% Processing parameters</span>
3238 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3239 <span class="comment">% icon = ind2rgb(icon,map);</span>
3240 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3241     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3242     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3243     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3244 
3245 <span class="comment">% Zoom In</span>
3246 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3247 <span class="comment">% icon = ind2rgb(icon,map);</span>
3248 <span class="comment">% handles.toolbarZoomIn = ...</span>
3249 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3250 <span class="comment">%     'CData',        icons(8).data, ...</span>
3251 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3252 <span class="comment">%     'Separator',     'on');</span>
3253 
3254 <span class="comment">% Zoom Out</span>
3255 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3256 <span class="comment">% icon = ind2rgb(icon,map);</span>
3257 <span class="comment">% handles.toolbarZoomOut = ...</span>
3258 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3259 <span class="comment">%     'CData',        icons(9).data, ...</span>
3260 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3261 
3262 <span class="comment">% Pan</span>
3263 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3264 <span class="comment">% icon = ind2rgb(icon,map);</span>
3265 <span class="comment">% handles.toolbarPan = ...</span>
3266 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3267 <span class="comment">%     'CData',        icons(10).data, ...</span>
3268 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3269 
3270 
3271 
3272 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3273 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3274 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3275 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3276 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub25" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3277 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub53" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3278 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3279 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3280 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3281 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3282 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3283 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3284 
3285 <span class="comment">% [EOF] buildtoolbar</span>
3286 
3287 
3288 <span class="comment">% --------------------------------------------------------------------</span>
3289 <a name="_sub92" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3290 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3291 <span class="comment">% already exist.</span>
3292 
3293 <span class="comment">% Preferences:</span>
3294 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3295 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3296 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3297 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3298 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3299 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3300 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3301 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3302 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3303 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3304 <span class="comment">% 'renderer'             Default graphics renderer</span>
3305 <span class="comment">% 'units'                Default plotting units</span>
3306 
3307 <span class="comment">% Originals</span>
3308 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3309 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3310 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3311 
3312 <span class="comment">% ASCII</span>
3313 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3314     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3315     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3316         guiprefs.ascii_path = ascii.path;
3317     <span class="keyword">else</span>
3318         guiprefs.ascii_path = pwd;
3319     <span class="keyword">end</span>
3320     does_exist = false(1,length(ascii.file));
3321     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3322         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3323     <span class="keyword">end</span>
3324     <span class="keyword">if</span> any(does_exist)
3325         guiprefs.ascii_file = ascii.file(does_exist);
3326     <span class="keyword">else</span>
3327         guiprefs.ascii_file = {<span class="string">''</span>};
3328     <span class="keyword">end</span>
3329 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3330     guiprefs.ascii_path = pwd;
3331     guiprefs.ascii_file = {<span class="string">''</span>};
3332     
3333     ascii.path = pwd;
3334     ascii.file = {<span class="string">''</span>};
3335     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3336 <span class="keyword">end</span>
3337 
3338 <span class="comment">% MAT</span>
3339 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3340     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3341     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3342         guiprefs.mat_path = mat.path;
3343     <span class="keyword">else</span>
3344         guiprefs.mat_path = pwd;
3345     <span class="keyword">end</span>
3346     
3347     <span class="keyword">if</span> iscell(mat.file)
3348         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3349             guiprefs.mat_file = mat.file;
3350         <span class="keyword">else</span>
3351             guiprefs.mat_file = <span class="string">''</span>;
3352         <span class="keyword">end</span>
3353     <span class="keyword">else</span>
3354         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3355             guiprefs.mat_file = mat.file;
3356         <span class="keyword">else</span>
3357             guiprefs.mat_file = <span class="string">''</span>;
3358         <span class="keyword">end</span>
3359     <span class="keyword">end</span>
3360 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3361     guiprefs.mat_path = pwd;
3362     guiprefs.mat_file = <span class="string">''</span>;
3363     
3364     mat.path = pwd;
3365     mat.file = <span class="string">''</span>;
3366     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3367 <span class="keyword">end</span>
3368 
3369 <span class="comment">% TECPLOT</span>
3370 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3371     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3372     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3373         guiprefs.tecplot_path = tecplot.path;
3374     <span class="keyword">else</span>
3375         guiprefs.tecplot_path = pwd;
3376     <span class="keyword">end</span>
3377     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3378         guiprefs.tecplot_file = tecplot.file;
3379     <span class="keyword">else</span>
3380         guiprefs.tecplot_file = <span class="string">''</span>;
3381     <span class="keyword">end</span>
3382 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3383     guiprefs.tecplot_path = pwd;
3384     guiprefs.tecplot_file = <span class="string">''</span>;
3385     
3386     tecplot.path = pwd;
3387     tecplot.file = <span class="string">''</span>;
3388     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3389 <span class="keyword">end</span>
3390 
3391 <span class="comment">% KMZ</span>
3392 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3393     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3394     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3395         guiprefs.kmz_path = kmz.path;
3396     <span class="keyword">else</span>
3397         guiprefs.kmz_path = pwd;
3398     <span class="keyword">end</span>
3399     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3400         guiprefs.kmz_file = kmz.file;
3401     <span class="keyword">else</span>
3402         guiprefs.kmz_file = <span class="string">''</span>;
3403     <span class="keyword">end</span>
3404 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3405     guiprefs.kmz_path = pwd;
3406     guiprefs.kmz_file = <span class="string">''</span>;
3407     
3408     kmz.path = pwd;
3409     kmz.file = <span class="string">''</span>;
3410     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3411 <span class="keyword">end</span>
3412 
3413 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3414 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3415     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3416     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3417         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3418     <span class="keyword">else</span>
3419         guiprefs.multibeambathymetry_path = pwd;
3420     <span class="keyword">end</span>
3421     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3422         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3423     <span class="keyword">else</span>
3424         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3425     <span class="keyword">end</span>
3426 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3427     guiprefs.multibeambathymetry_path = pwd;
3428     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3429     
3430     multibeambathymetry.path = pwd;
3431     multibeambathymetry.file = <span class="string">''</span>;
3432     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3433 <span class="keyword">end</span>
3434 
3435 <span class="comment">% Log</span>
3436 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3437     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3438     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3439         guiprefs.log_path = log.path;
3440     <span class="keyword">else</span>
3441         guiprefs.log_path = pwd;
3442     <span class="keyword">end</span>
3443     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3444         guiprefs.log_file = log.file;
3445     <span class="keyword">else</span>
3446         guiprefs.log_file = <span class="string">''</span>;
3447     <span class="keyword">end</span>
3448 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3449     guiprefs.log_path = pwd;
3450     guiprefs.log_file = <span class="string">''</span>;
3451     
3452     log.path = pwd;
3453     log.file = <span class="string">''</span>;
3454     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3455 <span class="keyword">end</span>
3456 
3457 <span class="comment">% iRic</span>
3458 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3459     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3460     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3461         guiprefs.iric_path = iric.path;
3462     <span class="keyword">else</span>
3463         guiprefs.iric_path = pwd;
3464     <span class="keyword">end</span>
3465     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3466         guiprefs.iric_file = iric.file;
3467     <span class="keyword">else</span>
3468         guiprefs.iric_file = <span class="string">''</span>;
3469     <span class="keyword">end</span>
3470 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3471     guiprefs.iric_path = pwd;
3472     guiprefs.iric_file = <span class="string">''</span>;
3473     
3474     iric.path = pwd;
3475     iric.file = <span class="string">''</span>;
3476     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3477 <span class="keyword">end</span>
3478 
3479 <span class="comment">% excel</span>
3480 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3481     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3482     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3483         guiprefs.excel_path = excel.path;
3484     <span class="keyword">else</span>
3485         guiprefs.excel_path = pwd;
3486     <span class="keyword">end</span>
3487     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3488         guiprefs.excel_file = excel.file;
3489     <span class="keyword">else</span>
3490         guiprefs.excel_file = <span class="string">''</span>;
3491     <span class="keyword">end</span>
3492 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3493     guiprefs.excel_path = pwd;
3494     guiprefs.excel_file = <span class="string">''</span>;
3495     
3496     excel.path = pwd;
3497     excel.file = <span class="string">''</span>;
3498     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3499 <span class="keyword">end</span>
3500 
3501 <span class="comment">% aerial</span>
3502 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3503     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3504     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3505         guiprefs.aerial_path = aerial.path;
3506     <span class="keyword">else</span>
3507         guiprefs.aerial_path = pwd;
3508     <span class="keyword">end</span>
3509     does_exist = false(1,length(aerial.file));
3510     <span class="keyword">if</span> iscell(aerial.file)
3511     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3512         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3513     <span class="keyword">end</span>
3514     <span class="keyword">else</span>
3515         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3516     <span class="keyword">end</span>
3517     <span class="keyword">if</span> any(does_exist)
3518         guiprefs.aerial_file = aerial.file;
3519     <span class="keyword">else</span>
3520         guiprefs.aerial_file = {<span class="string">''</span>};
3521     <span class="keyword">end</span>
3522 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3523     guiprefs.aerial_path = pwd;
3524     guiprefs.aerial_file = {<span class="string">''</span>};
3525     
3526     aerial.path = pwd;
3527     aerial.file = {<span class="string">''</span>};
3528     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3529 <span class="keyword">end</span>
3530 
3531 <span class="comment">% shoreline</span>
3532 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3533     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3534     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3535         guiprefs.shoreline_path = shoreline.path;
3536     <span class="keyword">else</span>
3537         guiprefs.shoreline_path = pwd;
3538     <span class="keyword">end</span>
3539     
3540     <span class="keyword">if</span> iscell(shoreline.file)
3541         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3542             guiprefs.shoreline_file = shoreline.file;
3543         <span class="keyword">else</span>
3544             guiprefs.shoreline_file = <span class="string">''</span>;
3545         <span class="keyword">end</span>
3546     <span class="keyword">else</span>
3547         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3548             guiprefs.shoreline_file = shoreline.file;
3549         <span class="keyword">else</span>
3550             guiprefs.shoreline_file = <span class="string">''</span>;
3551         <span class="keyword">end</span>
3552     <span class="keyword">end</span>
3553 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3554     guiprefs.shoreline_path = pwd;
3555     guiprefs.shoreline_file = <span class="string">''</span>;
3556     
3557     shoreline.path = pwd;
3558     shoreline.file = <span class="string">''</span>;
3559     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3560 <span class="keyword">end</span>
3561 <span class="comment">% guiprefs.presentation = true;</span>
3562 <span class="comment">% guiprefs.print        = false;</span>
3563 
3564 <span class="comment">% for k = 1:length(prefs)</span>
3565 <span class="comment">%     newpref = '';</span>
3566 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3567 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3568 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3569 <span class="comment">%             newpref = stored_newpref;</span>
3570 <span class="comment">%         else</span>
3571 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3572 <span class="comment">%         end</span>
3573 <span class="comment">%     end</span>
3574 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3575 <span class="comment">% end</span>
3576 
3577 <span class="comment">% RENDERER</span>
3578 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3579     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3580     guiprefs.renderer = renderer;
3581 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3582     renderer           = <span class="string">'OpenGL'</span>;
3583     guiprefs.renderer  = renderer;
3584     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3585 <span class="keyword">end</span>
3586 
3587 <span class="comment">% UNITS</span>
3588 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3589     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3590     guiprefs.units = units;
3591 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3592     units           = <span class="string">'metric'</span>;
3593     guiprefs.units  = renderer;
3594     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3595 <span class="keyword">end</span>
3596 
3597 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3598 
3599 <span class="comment">% [EOF] load_prefs</span>
3600 
3601 
3602 <span class="comment">% --------------------------------------------------------------------</span>
3603 <a name="_sub93" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3604 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3605 <span class="comment">% preferences data.</span>
3606 
3607 <span class="comment">% Preferences:</span>
3608 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3609 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3610 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3611 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3612 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3613 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3614 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3615 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3616 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3617 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3618 <span class="comment">% 'renderer'             Default graphics renderer</span>
3619 <span class="comment">% 'units'                Default plotting units</span>
3620 
3621 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3622 
3623 <span class="keyword">switch</span> pref
3624     <span class="keyword">case</span> <span class="string">'ascii'</span>
3625         ascii.path = guiprefs.ascii_path;
3626         ascii.file = guiprefs.ascii_file;
3627         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3628     <span class="keyword">case</span> <span class="string">'mat'</span>
3629         mat.path = guiprefs.mat_path;
3630         mat.file = guiprefs.mat_file;
3631         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3632     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3633         tecplot.path = guiprefs.tecplot_path;
3634         tecplot.file = guiprefs.tecplot_file;
3635         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3636     <span class="keyword">case</span> <span class="string">'kmz'</span>
3637         kmz.path = guiprefs.kmz_path;
3638         kmz.file = guiprefs.kmz_file;
3639         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3640     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3641         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3642         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3643         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3644     <span class="keyword">case</span> <span class="string">'log'</span>
3645         log.path = guiprefs.log_path;
3646         log.file = guiprefs.log_file;
3647         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3648     <span class="keyword">case</span> <span class="string">'iric'</span>
3649         iric.path = guiprefs.iric_path;
3650         iric.file = guiprefs.iric_file;
3651         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3652     <span class="keyword">case</span> <span class="string">'excel'</span>
3653         excel.path = guiprefs.excel_path;
3654         excel.file = guiprefs.excel_file;
3655         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3656     <span class="keyword">case</span> <span class="string">'aerial'</span>
3657         aerial.path = guiprefs.aerial_path;
3658         aerial.file = guiprefs.aerial_file;
3659         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3660     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3661         shoreline.path = guiprefs.shoreline_path;
3662         shoreline.file = guiprefs.shoreline_file;
3663         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3664     <span class="keyword">case</span> <span class="string">'renderer'</span>
3665         renderer = guiprefs.renderer;
3666         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3667     <span class="keyword">case</span> <span class="string">'units'</span>
3668         units = guiprefs.units;
3669         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3670     <span class="keyword">otherwise</span>
3671 <span class="keyword">end</span>
3672 
3673 <span class="comment">% if ismember(pref,prefs)</span>
3674 <span class="comment">%     setpref('VMT',pref,value)</span>
3675 <span class="comment">%</span>
3676 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3677 <span class="comment">%     guiprefs.(pref) = value;</span>
3678 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3679 <span class="comment">% end</span>
3680 
3681 <span class="comment">% [EOF] store_prefs</span>
3682 
3683 
3684 <span class="comment">% --------------------------------------------------------------------</span>
3685 <a name="_sub94" href="#_subfunctions" class="code">function initGUI(handles)</a>
3686 <span class="comment">% Initialize the UI controls in the GUI.</span>
3687 
3688 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3689 
3690 <span class="comment">% Set the name and version</span>
3691 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version], <span class="keyword">...</span>
3692     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3693 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3694 
3695 <span class="comment">% Set the PLOT 1 axis labels</span>
3696 axes(handles.Plot1Shiptracks);
3697 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3698 xlabel(<span class="string">'UTM Easting (m)'</span>)
3699 ylabel(<span class="string">'UTM Northing (m)'</span>)
3700 box on
3701 grid on
3702 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3703 
3704 <span class="comment">%%%%%%%%%%%%</span>
3705 <span class="comment">% MENU BAR %</span>
3706 <span class="comment">%%%%%%%%%%%%</span>
3707 <span class="keyword">if</span> guiparams.english_units
3708     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3709     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3710 <span class="keyword">else</span>
3711     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3712     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3713 <span class="keyword">end</span>
3714 
3715 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3716     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3717     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3718 <span class="keyword">else</span>
3719     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3720     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3721 <span class="keyword">end</span>
3722 
3723 
3724 <span class="keyword">if</span> guiparams.print
3725     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3726     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3727     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3728     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3729 <span class="keyword">elseif</span> guiparams.presentation
3730     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3731     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3732     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3733     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3734 <span class="keyword">else</span>
3735 <span class="keyword">end</span>
3736 
3737 <span class="keyword">switch</span> guiparams.renderer
3738     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
3739         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3740         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3741         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3742     <span class="keyword">case</span> <span class="string">'painters'</span>
3743         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3744         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3745         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3746     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
3747         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3748         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3749         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3750 <span class="keyword">end</span>
3751 
3752 
3753 <span class="comment">%%%%%%%%%%%%%%%</span>
3754 <span class="comment">% DATA EXPORT %</span>
3755 <span class="comment">%%%%%%%%%%%%%%%</span>
3756 <span class="comment">% BathymetryPanel</span>
3757 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3758 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3759 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3760 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3761 
3762 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3763 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3764 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3765 <span class="comment">% PlanViewPanel</span>
3766 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3767 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3768 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3769 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3770 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3771 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3772 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3773 
3774 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3775 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3776 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3777 <span class="comment">% ShiptracksPanel</span>
3778 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3779 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3780 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3781 
3782 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3783 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3784 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3785 <span class="comment">% CrossSectionsPanel</span>
3786 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3787     <span class="string">'Value'</span>, guiparams.idx_contour)
3788 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3789 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3790 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3791 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3792 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3793 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3794 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3795 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3796     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3797 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3798 
3799 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3800 
3801 <span class="comment">% [EOF] initGUI</span>
3802 
3803 
3804 <span class="comment">% --------------------------------------------------------------------</span>
3805 <a name="_sub95" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3806 
3807 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3808 
3809 <span class="keyword">switch</span> enable_state
3810     <span class="keyword">case</span> <span class="string">'init'</span>
3811         guiparams.gui_state = <span class="string">'init'</span>;
3812         set([handles.menuFile
3813             handles.menuOpen
3814             handles.menuOpenASCII
3815             handles.menuOpenMAT
3816             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3817         
3818         set([handles.toolbarLoadData
3819             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3820         set([handles.toolbarSaveMatFile
3821             handles.toolbarSaveBathymetry
3822             handles.toolbarSaveFigures
3823             handles.toolbarSaveExcel
3824             handles.toolbarPlottingParameters
3825             handles.toolbarProcessingParameters
3826             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3827         
3828         set([handles.DepthRangeMin
3829             handles.DepthRangeMax
3830             handles.VectorScalePlanView
3831             handles.VectorSpacingPlanview
3832             handles.SmoothingWindowSize
3833             handles.DisplayShoreline
3834             handles.AddBackground
3835             handles.PlotPlanView
3836             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3837         
3838         set([handles.HorizontalGridNodeSpacing
3839             handles.VerticalGridNodeSpacing
3840             handles.PlotShiptracks
3841             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3842         
3843         set([handles.Contour
3844             handles.VerticalExaggeration
3845             handles.VectorScaleCrossSection
3846             handles.HorizontalVectorSpacing
3847             handles.VerticalVectorSpacing
3848             handles.HorizontalSmoothingWindow
3849             handles.VerticalSmoothingWindow
3850             handles.PlotSecondaryFlowVectors
3851             handles.SecondaryFlowVectorVariable
3852             handles.IncludeVerticalVelocity
3853             handles.PlotCrossSection
3854             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3855         
3856     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
3857         guiparams.gui_state = <span class="string">'fileloaded'</span>;
3858         set([handles.menuFile
3859             handles.menuOpen
3860             handles.menuOpenASCII
3861             handles.menuOpenMAT
3862             handles.menuSaveMAT
3863             handles.menuSaveTecplot
3864             handles.menuSaveKMZFile
3865             handles.menuParameters
3866             handles.menuPlottingParameters
3867             handles.menuMetric
3868             handles.menuEnglish
3869             handles.menuBathymetryExportSettings
3870             handles.menuExportMultibeamBathymetry
3871             handles.menuKMZVerticalOffset
3872             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3873         
3874         set([handles.toolbarLoadData
3875             handles.toolbarSaveMatFile
3876             handles.toolbarSaveBathymetry
3877             handles.toolbarSaveExcel
3878             handles.toolbarSaveFigures
3879             handles.toolbarPlottingParameters
3880             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3881         set([handles.toolbarProcessingParameters
3882             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3883         
3884            
3885         set([handles.DepthRangeMin
3886             handles.DepthRangeMax
3887             handles.VectorScalePlanView
3888             handles.VectorSpacingPlanview
3889             handles.SmoothingWindowSize
3890             handles.DisplayShoreline
3891             handles.PlotPlanView
3892             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3893         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3894             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3895         <span class="keyword">else</span>
3896             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3897         <span class="keyword">end</span>
3898         
3899         set([handles.HorizontalGridNodeSpacing
3900             handles.VerticalGridNodeSpacing
3901             handles.PlotShiptracks
3902             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3903         
3904         set([handles.Contour
3905             handles.VerticalExaggeration
3906             handles.VectorScaleCrossSection
3907             handles.HorizontalVectorSpacing
3908             handles.VerticalVectorSpacing
3909             handles.HorizontalSmoothingWindow
3910             handles.VerticalSmoothingWindow
3911             handles.PlotSecondaryFlowVectors
3912             handles.SecondaryFlowVectorVariable
3913             handles.IncludeVerticalVelocity
3914             handles.PlotCrossSection
3915             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3916     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
3917         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
3918         set([handles.menuFile
3919             handles.menuOpen
3920             handles.menuOpenASCII
3921             handles.menuOpenMAT
3922             handles.menuParameters
3923             handles.menuPlottingParameters
3924             handles.menuMetric
3925             handles.menuEnglish
3926             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3927         set([handles.menuSaveMAT
3928             handles.menuBathymetryExportSettings
3929             handles.menuExportMultibeamBathymetry
3930             handles.menuKMZVerticalOffset
3931             handles.menuSaveKMZFile
3932             handles.menuSaveTecplot
3933             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3934         
3935         set([handles.toolbarLoadData
3936             handles.toolbarSaveFigures
3937             handles.toolbarPlottingParameters
3938             handles.toolbarSaveExcel
3939             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3940         set([handles.toolbarProcessingParameters
3941             handles.toolbarSaveMatFile
3942             handles.toolbarSaveBathymetry
3943             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3944         
3945         set([handles.DepthRangeMin
3946             handles.DepthRangeMax
3947             handles.VectorScalePlanView
3948             handles.VectorSpacingPlanview
3949             handles.SmoothingWindowSize
3950             handles.DisplayShoreline
3951             handles.PlotPlanView
3952             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3953         <span class="keyword">if</span> guiparams.has_mapping_toolbox
3954             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3955         <span class="keyword">else</span>
3956             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3957         <span class="keyword">end</span>
3958         
3959         set([handles.HorizontalGridNodeSpacing
3960             handles.VerticalGridNodeSpacing
3961             handles.PlotShiptracks
3962             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3963         
3964         set([handles.Contour
3965             handles.VerticalExaggeration
3966             handles.VectorScaleCrossSection
3967             handles.HorizontalVectorSpacing
3968             handles.VerticalVectorSpacing
3969             handles.HorizontalSmoothingWindow
3970             handles.VerticalSmoothingWindow
3971             handles.PlotSecondaryFlowVectors
3972             handles.SecondaryFlowVectorVariable
3973             handles.IncludeVerticalVelocity
3974             handles.PlotCrossSection
3975             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3976     <span class="keyword">otherwise</span>
3977 <span class="keyword">end</span>
3978 
3979 <span class="comment">% Save Application Data</span>
3980 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3981 
3982 <span class="comment">% [EOF] set_enable</span>
3983 
3984 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
3985 
3986 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
3987 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
3988 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
3989 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
3990 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
3991 
3992 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
3993 
3994 
3995 <span class="comment">% --------------------------------------------------------------------</span>
3996 <a name="_sub96" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
3997     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
3998 
3999 w = 500;
4000 h = 110;
4001 dx = 10;
4002 dy = 35;
4003 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4004 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4005     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4006     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4007     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4008     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4009     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4010     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4011     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4012     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4013     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4014     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4015 dialog_params.english_units               = english_units;
4016 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4017 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4018 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4019 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4020 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4021 
4022 <span class="comment">% Build the graphics:</span>
4023 <span class="comment">% -------------------</span>
4024 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4025     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4026     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4027     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4028 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4029     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4030     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4031     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4032     <span class="string">'Position'</span>,[15 35 100 22]);
4033 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4034     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4035     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4036     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4037     <span class="string">'Position'</span>,[15 10 100 22]);
4038 
4039 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4040     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4041     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4042     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4043 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4044     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4045     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4046     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4047     <span class="string">'Position'</span>,[15 35 100 22]);
4048 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4049     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4050     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4051     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4052     <span class="string">'Position'</span>,[15 10 100 22]);
4053 
4054 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4055     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4056     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4057     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4058 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4059     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4060     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4061     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4062     <span class="string">'Position'</span>,[15 35 100 22]);
4063 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4064     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4065     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4066     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4067     <span class="string">'Position'</span>,[15 10 100 22]);
4068 
4069 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4070     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4071     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4072     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4073     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4074 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4075     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4076     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4077     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4078     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4079 
4080 <span class="comment">% Update the UI controls:</span>
4081 <span class="comment">% -----------------------</span>
4082 <span class="keyword">if</span> dialog_params.english_units
4083     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4084     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4085 <span class="keyword">else</span>
4086     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4087     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4088 <span class="keyword">end</span>
4089 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4090     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4091     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4092 <span class="keyword">else</span>
4093     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4094     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4095 <span class="keyword">end</span>
4096 <span class="keyword">if</span> dialog_params.presentation
4097     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4098     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4099 <span class="keyword">else</span>
4100     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4101     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4102 <span class="keyword">end</span>
4103 
4104 <span class="comment">% Set the callbacks:</span>
4105 <span class="comment">% ------------------</span>
4106 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4107 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4108 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4109 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4110 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4111 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4112 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4113 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4114 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4115 
4116 <span class="comment">% Position the dialog and make it visible:</span>
4117 <span class="comment">% ----------------------------------------</span>
4118 fpos = get(hf,<span class="string">'Position'</span>);
4119 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4120 movegui(handles.Figure,dpos)
4121 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4122 
4123 <span class="comment">% Hold the dialog open:</span>
4124 <span class="comment">% ---------------------</span>
4125 waitfor(handles.OK)
4126 
4127 <span class="comment">% Return the outputs and close the dialog:</span>
4128 <span class="comment">% ----------------------------------------</span>
4129 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4130 english_units = dialog_params.english_units;
4131 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4132 plot_presentation_style =  dialog_params.presentation;
4133 plot_print_style =  dialog_params.print;
4134 
4135 delete(handles.Figure)
4136 
4137 <span class="comment">% [EOF] plotParametersDialog</span>
4138 
4139 
4140 <span class="comment">% --------------------------------------------------------------------</span>
4141 <a name="_sub97" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4142 
4143 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4144 <span class="keyword">switch</span> the_units
4145     <span class="keyword">case</span> <span class="string">'metric'</span>
4146         dialog_params.english_units = false;
4147         
4148         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4149         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4150     <span class="keyword">case</span> <span class="string">'english'</span>
4151         dialog_params.english_units = true;
4152         
4153         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4154         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4155     <span class="keyword">otherwise</span>
4156 <span class="keyword">end</span>
4157 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4158 
4159 <span class="comment">% [EOF] dialogUnits</span>
4160 
4161 <span class="comment">% --------------------------------------------------------------------</span>
4162 <a name="_sub98" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4163 
4164 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4165 <span class="keyword">switch</span> the_endpoints
4166     <span class="keyword">case</span> <span class="string">'auto'</span>
4167         dialog_params.set_cross_section_endpoints = false;
4168         
4169         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4170         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4171     <span class="keyword">case</span> <span class="string">'manual'</span>
4172         dialog_params.set_cross_section_endpoints = true;
4173         
4174         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4175         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4176     <span class="keyword">otherwise</span>
4177 <span class="keyword">end</span>
4178 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4179 
4180 <span class="comment">% [EOF] dialogEnpoints</span>
4181 
4182 <a name="_sub99" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4183 
4184 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4185 <span class="keyword">switch</span> the_style
4186     <span class="keyword">case</span> <span class="string">'presentation'</span>
4187         dialog_params.presentation  = true;
4188         dialog_params.print         = false;
4189         
4190         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4191         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4192     <span class="keyword">case</span> <span class="string">'print'</span>
4193         dialog_params.presentation  = false;
4194         dialog_params.print         = true;
4195         
4196         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4197         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4198     <span class="keyword">otherwise</span>
4199 <span class="keyword">end</span>
4200 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4201 
4202 <span class="comment">% [EOF] dialogEnpoints</span>
4203 
4204 <span class="comment">% --------------------------------------------------------------------</span>
4205 <a name="_sub100" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4206 
4207 delete(h_OK)
4208 
4209 <span class="comment">% [EOF] dialogOK</span>
4210 
4211 <span class="comment">% --------------------------------------------------------------------</span>
4212 <a name="_sub101" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4213 <span class="comment">% Return the original inputs</span>
4214 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4215 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4216 delete(handles.OK)
4217 
4218 <span class="comment">% [EOF] dialogCancel</span>
4219 
4220 <span class="comment">% --------------------------------------------------------------------</span>
4221 <a name="_sub102" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4222 
4223 delete(h_OK)
4224 
4225 <span class="comment">% [EOF] dialogCloseReq</span>
4226 
4227 <a name="_sub103" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a>
4228 w = 230;
4229 h = 200;
4230 dx = 10;
4231 dy = 35;
4232 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4233 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4234     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4235     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4236     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4237     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4238     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4239     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4240     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4241     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4242     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4243     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4244 dialog_params.beam_angle             = beam_angle;
4245 dialog_params.magnetic_variation     = magnetic_variation;
4246 dialog_params.wse                    = wse;
4247 dialog_params.output_auxiliary_data = output_auxiliary_data;
4248 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4249 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4250 
4251 <span class="comment">% Build the graphics:</span>
4252 <span class="comment">% -------------------</span>
4253 ph = 150;
4254 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4255     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4256     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4257     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4258 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4259     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4260     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4261     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4262     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4263     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4264     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4265 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4266     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4267     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4268     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4269     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4270     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4271     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4272 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4273     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4274     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4275     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4276     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4277     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4278     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4279 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4280     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4281     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4282     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4283     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4284     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4285     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4286 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4287     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4288     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4289     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4290     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4291     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4292     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4293 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4294     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4295     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4296     <span class="string">'String'</span>,num2str(wse),<span class="keyword">...</span>
4297     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4298     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4299     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4300 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4301     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4302     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4303     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4304     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4305 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4306     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4307     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4308     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4309     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4310 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4311     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4312     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4313     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4314     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4315 
4316 <span class="comment">% Update the UI controls:</span>
4317 <span class="comment">% -----------------------</span>
4318 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4319 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4320 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4321 set(handles.OutputauxiliaryData,     <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4322 
4323 <span class="comment">% Set the callbacks:</span>
4324 <span class="comment">% ------------------</span>
4325 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4326 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4327 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4328 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4329 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4330 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4331 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4332 
4333 <span class="comment">% Position the dialog and make it visible:</span>
4334 <span class="comment">% ----------------------------------------</span>
4335 fpos = get(hf,<span class="string">'Position'</span>);
4336 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4337 movegui(handles.Figure,dpos)
4338 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4339 
4340 <span class="comment">% Hold the dialog open:</span>
4341 <span class="comment">% ---------------------</span>
4342 waitfor(handles.OK)
4343 
4344 <span class="comment">% Return the outputs and close the dialog:</span>
4345 <span class="comment">% ----------------------------------------</span>
4346 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4347 beam_angle              = dialog_params.beam_angle;
4348 magnetic_variation      = dialog_params.magnetic_variation;
4349 wse                     = str2double(dialog_params.wse);
4350 output_auxiliary_data  = logical(dialog_params.output_auxiliary_data);
4351 
4352 delete(handles.Figure)
4353 
4354 <span class="comment">% [EOF] exportSettingsDialog</span>
4355 
4356 <span class="comment">% --------------------------------------------------------------------</span>
4357 <a name="_sub104" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4358 
4359 <span class="comment">% Grab the current data</span>
4360 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4361 
4362 <span class="comment">% Set it according to the dialog box values</span>
4363 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4364 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4365 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4366 dialog_params.output_auxiliary_data    = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4367 
4368 <span class="comment">% Re-store the application data</span>
4369 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4370 
4371 <span class="comment">% [EOF] dialogExportSettings</span>
4372 
4373 <a name="_sub105" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4374 
4375 w = 230;
4376 h = 200;
4377 dx = 10;
4378 dy = 35;
4379 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4380 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4381     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4382     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4383     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4384     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4385     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4386     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4387     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4388     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4389     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4390     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4391 dialog_params.figure_names               = figure_names;
4392 dialog_params.selected_figures           = <span class="string">''</span>;
4393 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4394 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4395 
4396 <span class="comment">% Build the graphics:</span>
4397 <span class="comment">% -------------------</span>
4398 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4399     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4400     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4401     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4402 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4403     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4404     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4405     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4406     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4407     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4408     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4409     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4410 
4411 
4412 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4413     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4414     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4415     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4416     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4417 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4418     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4419     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4420     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4421     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4422 
4423 <span class="comment">% Update the UI controls:</span>
4424 <span class="comment">% -----------------------</span>
4425 
4426 
4427 <span class="comment">% Set the callbacks:</span>
4428 <span class="comment">% ------------------</span>
4429 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4430 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4431 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4432 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4433 
4434 <span class="comment">% Position the dialog and make it visible:</span>
4435 <span class="comment">% ----------------------------------------</span>
4436 fpos = get(hf,<span class="string">'Position'</span>);
4437 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4438 movegui(handles.Figure,dpos)
4439 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4440 
4441 <span class="comment">% Hold the dialog open:</span>
4442 <span class="comment">% ---------------------</span>
4443 waitfor(handles.OK)
4444 
4445 <span class="comment">% Return the outputs and close the dialog:</span>
4446 <span class="comment">% ----------------------------------------</span>
4447 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4448 selected_figures = dialog_params.selected_figures;
4449 
4450 delete(handles.Figure)
4451 
4452 <span class="comment">% [EOF] openFiguresDialog</span>
4453 
4454 <span class="comment">% --------------------------------------------------------------------</span>
4455 <a name="_sub106" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4456 
4457 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4458 
4459 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4460 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4461 selected     = fig_names(idx_selected);
4462 dialog_params.selected_figures = selected;
4463 
4464 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4465 
4466 
4467 
4468 <span class="comment">% --------------------------------------------------------------------</span>
4469 <a name="_sub107" href="#_subfunctions" class="code">function icons = getIcons</a>
4470 
4471 <span class="comment">% Load data</span>
4472 idx = 1;
4473 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4474     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4475     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4476     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4477     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4478     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4479     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4480     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4481     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4482     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4483     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4484     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4485     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4486     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4487     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4488     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4489     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4490 
4491 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4492     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4493     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4494     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4495     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4496     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4497     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4498     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4499     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4500     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4501     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4502     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4503     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4504     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4505     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4506     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4507     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4508 
4509 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4510     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4511     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4512     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4513     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4514     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4515     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4516     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4517     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4518     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4519     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4520     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4521     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4522     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4523     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4524     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4525     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4526 
4527 <span class="comment">% Save data</span>
4528 idx = idx+1;
4529 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4530     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4531     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4532     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4533     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4534     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4535     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4536     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4537     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4538     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4539     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4540     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4541     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4542     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4543     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4544     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4545     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4546 
4547 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4548     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4549     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4550     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4551     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4552     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4553     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4554     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4555     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4556     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4557     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4558     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4559     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4560     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4561     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4562     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4563     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4564 
4565 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4566     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4567     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4568     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4569     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4570     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4571     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4572     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4573     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4574     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4575     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4576     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4577     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4578     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4579     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4580     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4581     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4582 
4583 <span class="comment">% Plotting parameters</span>
4584 idx = idx+1;
4585 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4586     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4587     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4588     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4589     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4590     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4591     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4592     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4593     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4594     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4595     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4596     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4597     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4598     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4599     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4600     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4601     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4602 
4603 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4604     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4605     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4606     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4607     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4608     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4609     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4610     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4611     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4612     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4613     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4614     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4615     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4616     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4617     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4618     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4619     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4620 
4621 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4622     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4623     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4624     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4625     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4626     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4627     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4628     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4629     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4630     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4631     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4632     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4633     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4634     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4635     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4636     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4637     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4638 
4639 <span class="comment">% Processing parameters</span>
4640 idx = idx+1;
4641 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4642     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4643     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4644     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4645     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4646     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4647     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4648     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4649     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4650     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4651     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4652     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4653     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4654     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4655     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4656     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4657     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4658 
4659 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4660     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4661     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4662     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4663     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4664     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4665     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4666     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4667     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4668     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4669     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4670     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4671     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4672     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4673     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4674     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4675     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4676 
4677 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4678     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4679     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4680     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4681     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4682     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4683     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4684     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4685     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4686     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4687     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4688     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4689     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4690     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4691     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4692     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4693     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4694 
4695 <span class="comment">% Export bathymetry dialog</span>
4696 idx = idx+1;
4697 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4698     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4699     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4700     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4701     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4702     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4703     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4704     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4705     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4706     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4707     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4708     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4709     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4710     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4711     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4712     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4713     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4714     ]/255;
4715 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4716     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4717     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4718     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4719     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4720     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4721     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4722     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4723     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4724     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4725     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4726     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4727     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4728     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4729     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4730     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4731     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4732     ]/255;
4733 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4734     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4735     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4736     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4737     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4738     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4739     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4740     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4741     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4742     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4743     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4744     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4745     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4746     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4747     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4748     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4749     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4750     ]/255;
4751 
4752 <span class="comment">% Export Figures Dialog</span>
4753 idx = idx + 1;
4754 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4755     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4756     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4757     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4758     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4759     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4760     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4761     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4762     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4763     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4764     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4765     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4766     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4767     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4768     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4769     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4770 
4771 
4772 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4773     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4774     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4775     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4776     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4777     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4778     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4779     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4780     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4781     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4782     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4783     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4784     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4785     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4786     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4787     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4788 
4789 
4790 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4791     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4792     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4793     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4794     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4795     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4796     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4797     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4798     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4799     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4800     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4801     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4802     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4803     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4804     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4805     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4806 
4807 <span class="comment">% Export Excel File</span>
4808 idx = idx + 1;
4809 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4810     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4811    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4812    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4813    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4814    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4815    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4816    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4817    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4818    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4819    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4820    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4821    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4822    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4823    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4824    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4825     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4826 
4827 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4828     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4829    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4830    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4831    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4832    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4833    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4834    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4835    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4836    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4837    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4838    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4839    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4840    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4841    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4842    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4843     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4844 
4845 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4846     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4847    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4848    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
4849    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
4850    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
4851    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
4852    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
4853    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
4854    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
4855    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
4856    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
4857    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
4858    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
4859    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
4860    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
4861     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
4862 
4863 <span class="comment">% Zoom In</span>
4864 idx = idx + 1;
4865 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4866     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
4867 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4868     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
4869 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4870     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
4871 
4872 <span class="comment">% Zoom Out</span>
4873 idx = idx + 1;
4874 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4875     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
4876 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4877     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
4878 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4879     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
4880 
4881 <span class="comment">% Pan</span>
4882 idx = idx + 1;
4883 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4884     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
4885 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4886     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
4887 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4888     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
4889 <span class="comment">% [EOF] getIcons</span>
4890 
4891 <a name="_sub108" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
4892 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
4893 
4894 <span class="comment">% Check for any stored prefs</span>
4895 <span class="comment">% --------------------------</span>
4896 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
4897 guiprefs = getpref(<span class="string">'VMT'</span>);
4898 
4899 <span class="comment">% Organized by GUI panels</span>
4900 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4901 <span class="comment">% SHIPTRACKS PLOT %</span>
4902 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
4903 guiparams.horizontal_grid_node_spacing       = 1.0;
4904 guiparams.vertical_grid_node_spacing         = 0.4;
4905 
4906 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4907 <span class="comment">% CROSS SECTION PLOT %</span>
4908 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4909 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
4910 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
4911 guiparams.idx_contour                        = 1;
4912 guiparams.vertical_exaggeration              = 10;
4913 guiparams.vector_scale_cross_section         = 0.2;
4914 guiparams.horizontal_vector_spacing          = 1;
4915 guiparams.vertical_vector_spacing            = 1;
4916 guiparams.horizontal_smoothing_window        = 1;
4917 guiparams.vertical_smoothing_window          = 1;
4918 guiparams.plot_secondary_flow_vectors        = true;
4919 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
4920 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
4921 guiparams.idx_secondary_flow_vector_variable = 1;
4922 guiparams.include_vertical_velocity          = true;
4923 
4924 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4925 <span class="comment">% PLAN VIEW PLOT %</span>
4926 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
4927 guiparams.depth_range_min                    = 0;
4928 guiparams.depth_range_max                    = inf;
4929 guiparams.vector_scale_plan_view             = 1;
4930 guiparams.vector_spacing_plan_view           = 1;
4931 guiparams.smoothing_window_size              = 1;
4932 guiparams.display_shoreline                  = false;
4933 guiparams.add_background                     = false;
4934 
4935 <span class="comment">%%%%%%%%%%%%%%%</span>
4936 <span class="comment">% DATA EXPORT %</span>
4937 <span class="comment">%%%%%%%%%%%%%%%</span>
4938 guiparams.beam_angle                         = 20.0;
4939 guiparams.magnetic_variation                 = 0.0;
4940 guiparams.wse                                = 0.0;
4941 guiparams.output_auxiliary_data              = false;
4942 
4943 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4944 <span class="comment">% Contour variables %</span>
4945 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
4946 idx = 1;
4947 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
4948 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
4949 idx = idx + 1;
4950 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
4951 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
4952 idx = idx + 1;
4953 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
4954 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
4955 idx = idx + 1;
4956 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
4957 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
4958 idx = idx + 1;
4959 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
4960 guiparams.contours(idx).variable = <span class="string">'east'</span>;
4961 idx = idx + 1;
4962 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
4963 guiparams.contours(idx).variable = <span class="string">'north'</span>;
4964 idx = idx + 1;
4965 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
4966 guiparams.contours(idx).variable = <span class="string">'error'</span>;
4967 idx = idx + 1;
4968 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
4969 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
4970 idx = idx + 1;
4971 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
4972 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
4973 idx = idx + 1;
4974 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
4975 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
4976 idx = idx + 1;
4977 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
4978 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
4979 idx = idx + 1;
4980 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
4981 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
4982 idx = idx + 1;
4983 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
4984 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
4985 idx = idx + 1;
4986 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
4987 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
4988 idx = idx + 1;
4989 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
4990 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
4991 idx = idx + 1;
4992 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
4993 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
4994 idx = idx + 1;
4995 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
4996 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
4997 
4998 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
4999 
5000 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5001 <span class="comment">% Secondary Flow Vector Variables %</span>
5002 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5003 idx = 1;
5004 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5005 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5006 idx = idx + 1;
5007 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5008 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5009 idx = idx + 1;
5010 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5011 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5012 idx = idx + 1;
5013 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5014 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5015 idx = idx + 1;
5016 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5017 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5018 
5019 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5020     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5021 
5022 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5023 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5024 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5025 <span class="comment">% Menu bar options</span>
5026 guiparams.presentation                       = true;
5027 guiparams.print                              = false;
5028 guiparams.set_cross_section_endpoints        = false;
5029 guiparams.unit_discharge_correction          = false;
5030 
5031 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5032     <span class="keyword">switch</span> guiprefs.units
5033         <span class="keyword">case</span> <span class="string">'metric'</span>
5034             guiparams.english_units          = false;
5035         <span class="keyword">case</span> <span class="string">'english'</span>
5036             guiparams.english_units          = true;
5037     <span class="keyword">end</span>
5038 <span class="keyword">else</span>
5039     guiparams.english_units                  = false;
5040 <span class="keyword">end</span>
5041 guiparams.vertical_offset                    = 0;
5042 
5043 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5044     guiparams.renderer                       = guiprefs.renderer;
5045 <span class="keyword">else</span>
5046     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5047 <span class="keyword">end</span>
5048 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5049 <span class="comment">% guiparams.plot_planview                      = false;</span>
5050 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5051 
5052 <span class="comment">% File location defaults</span>
5053 guiparams.ascii_path                        = pwd;
5054 guiparams.ascii_file                        = <span class="string">''</span>;
5055 guiparams.mat_path                          = pwd;
5056 guiparams.mat_file                          = <span class="string">''</span>;
5057 guiparams.tecplot_path                      = pwd;
5058 guiparams.tecplot_file                      = <span class="string">''</span>;
5059 guiparams.kmz_path                          = pwd;
5060 guiparams.kmz_file                          = <span class="string">''</span>;
5061 guiparams.multibeambathymetry_path          = pwd;
5062 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5063 guiparams.log_path                          = pwd;
5064 guiparams.log_file                          = <span class="string">''</span>;
5065 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5066 <span class="comment">% application</span>
5067 <span class="keyword">if</span> isdeployed 
5068     guiparams.has_mapping_toolbox           = true;
5069 <span class="keyword">else</span>
5070     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5071         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5072 <span class="keyword">end</span>
5073 
5074 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5075 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5076 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5077 guiparams.z                      = [];
5078 guiparams.A                      = [];
5079 guiparams.V                      = [];
5080 guiparams.Map                    = [];
5081 guiparams.savefile               = [];
5082 guiparams.iric_anv_planview_data = [];
5083 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5084 <span class="comment">% guiparams.zmax = [];</span>
5085 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5086 guiparams.data_folder = <span class="string">''</span>;
5087 guiparams.data_files  = {<span class="string">''</span>};
5088 guiparams.gui_state   = <span class="string">'init'</span>;
5089 
5090 <span class="comment">% [EOF] createGUIparams</span>
5091 
5092 <a name="_sub109" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5093 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5094 
5095 <a name="_sub110" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5096 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5097 
5098 <span class="comment">% [EOF] VMT</span>
5099 
5100 
5101 
5102 
5103 
5104 <span class="comment">% --- Hidden keyboard commands</span>
5105 <a name="_sub111" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5106 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5107 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5108 <span class="comment">%</span>
5109 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5110 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5111 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5112 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5113 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5114 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5115 
5116 in1 = eventdata.Modifier; 
5117 in2 = eventdata.Key;
5118 
5119 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5120     input = [in1{:} in2];
5121 <span class="keyword">else</span>
5122     input = in2;
5123 <span class="keyword">end</span>
5124 
5125 <span class="keyword">switch</span> input
5126     <span class="comment">% Hidden SonTek M9 support</span>
5127     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5128         msgtxt = {<span class="keyword">...</span>
5129             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5130             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5131             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5132             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5133             <span class="string">''</span>;<span class="keyword">...</span>
5134             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5135             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5136             <span class="string">'PROVISIONAL at best.'</span>};
5137         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5138         
5139         <span class="comment">% Get the Application data:</span>
5140         <span class="comment">% -------------------------</span>
5141         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5142         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5143         
5144         <span class="comment">% Ask the user to select files:</span>
5145         <span class="comment">% -----------------------------</span>
5146         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5147         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5148         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5149             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5150         <span class="keyword">else</span>
5151             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5152         <span class="keyword">end</span>
5153         [filename,pathname] = <span class="keyword">...</span>
5154             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5155             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5156             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5157         
5158         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5159             guiparams.data_folder = pathname;
5160             <span class="keyword">if</span> ischar(filename)
5161                 filename = {filename};
5162             <span class="keyword">end</span>
5163             guiparams.data_files = filename;
5164             guiparams.mat_file = <span class="string">''</span>;
5165             
5166             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5167             
5168             
5169             
5170             <span class="comment">% Update the preferences:</span>
5171             <span class="comment">% -----------------------</span>
5172             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5173             guiprefs.ascii_path = pathname;
5174             guiprefs.ascii_file = filename;
5175             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5176             <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5177             
5178             <span class="comment">% Push messages to Log Window:</span>
5179             <span class="comment">% ----------------------------</span>
5180             log_text = {<span class="keyword">...</span>
5181                 <span class="string">''</span>;<span class="keyword">...</span>
5182                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5183                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5184                 guiparams.data_folder;
5185                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5186                 char(filename)};
5187             statusLogging(handles.LogWindow, log_text)
5188             
5189             <span class="comment">% Read the file(s)</span>
5190             <span class="comment">% ----------------</span>
5191             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5192             
5193             [~,~,savefile,A,z] = <span class="keyword">...</span>
5194                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5195             guiparams.savefile = savefile;
5196             guiparams.A        = A;
5197             guiparams.z        = z;
5198             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5199             
5200             
5201             <span class="comment">% Update the GUI:</span>
5202             <span class="comment">% ---------------</span>
5203             <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5204         <span class="keyword">end</span>  
5205     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5206         SontekMAT2KML;
5207     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5208         <a href="#_sub46" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5209         
5210     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5211         VMT_BuildCustomFlatFile;
5212     <span class="keyword">otherwise</span>
5213         <span class="comment">%disp(input)</span>
5214 <span class="keyword">end</span>
5215 
5216 
5217 
5218</pre></div>
<hr><address>Generated on Thu 03-Jul-2014 10:48:58 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>