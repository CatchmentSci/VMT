<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub96" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub97" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub98" class="code">function initGUI(handles)</a></li><li><a href="#_sub99" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub100" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub101" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub102" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub103" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub104" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub106" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub108" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub110" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function icons = getIcons</a></li><li><a href="#_sub112" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub113" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub114" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub95" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub96" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub112" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.07'</span>; <span class="string">'r20150601'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub98" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub109" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.wse;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.wse = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.wse = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">end</span>
0651 <span class="comment">%  [EOF] loadTideFile</span>
0652 
0653 <span class="comment">% --------------------------------------------------------------------</span>
0654 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0655 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0656 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0657 
0658 
0659 <span class="comment">% --------------------------------------------------------------------</span>
0660 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0661 
0662 <span class="comment">% Get the Application Data:</span>
0663 <span class="comment">% -------------------------</span>
0664 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0665 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0666 PVdata    = guiparams.iric_anv_planview_data;
0667 iric_path = guiprefs.iric_path;
0668 iric_file = guiprefs.iric_file;
0669 
0670 <span class="comment">% Is there any planview data?</span>
0671 <span class="keyword">if</span> isempty(PVdata)
0672     <span class="comment">% Nothing to do, warn user</span>
0673     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0674     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0675 <span class="keyword">else</span>
0676     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0677     <span class="comment">% and smoothing (for iRiC)</span>
0678     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0679     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0680         fullfile(iric_path,iric_file));
0681     
0682     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0683         outfile = fullfile(iric_path,iric_file);
0684         log_text = vertcat(log_text,{outfile});
0685         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0686         outcount = fprintf(ofid,<span class="keyword">...</span>
0687             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0688         fclose(ofid);
0689     <span class="keyword">else</span>
0690         <span class="comment">% Return default iric_path and iric_file</span>
0691         iric_path = guiprefs.iric_path;
0692         iric_file = guiprefs.iric_file;
0693     <span class="keyword">end</span>
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% Push messages to Log Window:</span>
0697 <span class="comment">% ----------------------------</span>
0698 statusLogging(handles.LogWindow, log_text)
0699 
0700 <span class="comment">% Store the persistent preferences:</span>
0701 <span class="comment">% ---------------------------------</span>
0702 guiprefs.iric_file = iric_file;
0703 guiprefs.iric_path = iric_path;
0704 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0705 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0706 
0707 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0708 
0709 <span class="comment">% --------------------------------------------------------------------</span>
0710 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0711 <span class="comment">% Get the Application Data:</span>
0712 <span class="comment">% -------------------------</span>
0713 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0714 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0715 excel_path  = guiprefs.excel_path;
0716 excel_file  = guiprefs.excel_file;
0717 
0718 <span class="comment">% Push messages to Log Window:</span>
0719 <span class="comment">% ----------------------------</span>
0720 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0721 statusLogging(handles.LogWindow, log_text)
0722 
0723 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0724 <span class="comment">% data.</span>
0725 <span class="keyword">if</span> iscell(guiparams.mat_file)
0726     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0727     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0728     <span class="comment">% Refresh the Application Data:</span>
0729     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0730     z           = guiparams.z;
0731     A           = guiparams.A;
0732     V           = guiparams.V;
0733     Map         = guiparams.Map;
0734     wse         = guiparams.wse;
0735     PVdata      = guiparams.iric_anv_planview_data;
0736     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0737         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0738     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0739         fullfile(excel_path,excel_file));
0740     
0741     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0742         outfile = fullfile(excel_path,excel_file);
0743         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0744         
0745     <span class="keyword">else</span>
0746         <span class="comment">% Return default excel_path and excel_file</span>
0747         excel_path = guiprefs.excel_path;
0748         excel_file = guiprefs.excel_file;
0749         outfile = fullfile(excel_path,excel_file);
0750         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0751     <span class="keyword">end</span>
0752     
0753     <span class="comment">% Delete the old file if it exists</span>
0754     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0755         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0756             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0757             <span class="string">'already exists. Overwriting file...'</span>});
0758         delete(outfile)
0759     <span class="keyword">end</span>
0760     
0761     <span class="comment">% Save DAV data to an Excel File</span>
0762     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0763     vmin = num2str(guiparams.depth_range_min);
0764     vmax = num2str(guiparams.depth_range_max);
0765     pvheaders = {<span class="keyword">...</span>
0766         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0767         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0768         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0769         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0770     
0771 
0772     <span class="comment">% Initialize Variables</span>
0773     pvdata = []; Dist = [];
0774     X = []; Y = []; E = [];
0775     Ve = []; Vn =[]; Vm = []; Vd = [];
0776     
0777     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0778     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0779         <span class="comment">% Load current MAT-file</span>
0780         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0781         
0782         <span class="comment">% Location and Bathy</span>
0783         X = [X V.mcsX(1,:)];
0784         Y = [Y V.mcsY(1,:)];
0785         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0786         E = [E V.mcsBedElev];
0787         
0788         <span class="comment">% Build layer-averaged velocities</span>
0789         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0790         V.mcsX(indx,:) = nan;
0791         V.mcsY(indx,:) = nan;
0792         V.mcsEast(indx,:) = nan;
0793         V.mcsNorth(indx,:) = nan;
0794         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0795         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0796         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0797         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0798         
0799         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0800     <span class="keyword">end</span>
0801     
0802     <span class="comment">% Put output into 1 matrix</span>
0803     pvdata = [<span class="keyword">...</span>
0804         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0805         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0806         ];
0807     pvdata(isnan(pvdata)) = -9999;
0808     
0809     <span class="comment">% Create table and write to Excel</span>
0810     pvout = num2cell(pvdata');
0811     pvout = vertcat(pvheaders,pvout);
0812     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0813     
0814     <span class="comment">% Close out waitbar</span>
0815     waitbar(1,hwait)
0816     delete(hwait)
0817     
0818     <span class="comment">% Push messages to Log Window:</span>
0819     <span class="comment">% ----------------------------</span>
0820     statusLogging(handles.LogWindow, log_text)
0821 <span class="keyword">else</span>
0822     
0823     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0824     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0825     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0826     <span class="comment">% Refresh the Application Data:</span>
0827     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0828     z           = guiparams.z;
0829     A           = guiparams.A;
0830     V           = guiparams.V;
0831     Map         = guiparams.Map;
0832     wse         = guiparams.wse;
0833     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0834                                                     <span class="comment">% Planview Plot exactly</span>
0835         
0836     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0837     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0838         fullfile(excel_path,excel_file));
0839     
0840     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0841         outfile = fullfile(excel_path,excel_file);
0842         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0843         
0844         <span class="comment">% Delete the old file if it exists</span>
0845         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0846             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0847                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0848                 <span class="string">'already exists. Overwriting file...'</span>});
0849             delete(outfile)
0850         <span class="keyword">end</span>
0851         
0852         <span class="comment">% Push messages to Log Window:</span>
0853         <span class="comment">% ----------------------------</span>
0854         statusLogging(handles.LogWindow, log_text)
0855         
0856         <span class="comment">% Save MCS Summary to an Excel File</span>
0857         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0858         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0859         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0860         waitbar(1/5,hwait)
0861         <span class="keyword">if</span> isempty(guiparams.data_files(:)) <span class="comment">% Loaded MAT file</span>
0862             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0863             sout = {guiparams.mat_file};
0864         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0865             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0866             sout = guiparams.data_files';
0867         <span class="keyword">end</span>
0868         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0869         waitbar(2/7,hwait)
0870         sout = {<span class="keyword">...</span>
0871             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0872             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0873             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0875             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0877             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0878             <span class="string">'Water Surface Elevation (m)'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0879             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0880             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0881             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0882             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0883             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0884             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0885             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0886             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0887             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0888             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0889             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0890             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0891             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0892             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0893             <span class="string">'Data Structure:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0894             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0895             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0896             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0897             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0898             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0899             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0900             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0901             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0902             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0903             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0904             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0905             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0906             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0907             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0908             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0909             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0910             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0911             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0912             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0913             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0914             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0915             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0916             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0917             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0918             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>
0919             };
0920         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
0921         waitbar(3/7,hwait)
0922         
0923         <span class="comment">% Save DAV data to an Excel File</span>
0924         vmin = num2str(guiparams.depth_range_min);
0925         vmax = num2str(guiparams.depth_range_max);
0926         pvheaders = {<span class="keyword">...</span>
0927             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0928             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0929             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0930             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0931         
0932         <span class="comment">% Create block style matrix of all processed data</span>
0933         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0934         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
0935         <span class="comment">% layer-averaging applied</span>
0936         pvdata = [];
0937         
0938         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0939         <span class="comment">% you are looking upstream into the transect</span>
0940         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0941         
0942         <span class="comment">% Build bathy data matrix</span>
0943         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0944         
0945         <span class="comment">% Build layer-averaged velocities</span>
0946         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0947         V.mcsX(indx,:) = nan;
0948         V.mcsY(indx,:) = nan;
0949         V.mcsEast(indx,:) = nan;
0950         V.mcsNorth(indx,:) = nan;
0951         pvdata = [<span class="keyword">...</span>
0952             pvdata;<span class="keyword">...</span>
0953             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0954             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0955             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0956             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0957         pvdata(isnan(pvdata)) = -9999;
0958         pvout = num2cell(pvdata');
0959         pvout = vertcat(pvheaders,pvout);
0960         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0961         waitbar(4/7,hwait)
0962         
0963         <span class="comment">% Save MCS data to an Excel File</span>
0964         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0965         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
0966         MCSheaders = {<span class="keyword">...</span>
0967             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0968             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0969             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0970             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0971             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0972             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0973             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0974             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0975             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0976             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0977             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0978             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0979             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0980             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0981             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0982             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0983         
0984         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
0985         MCSdata = [<span class="keyword">...</span>
0986             V.mcsX(:)<span class="keyword">...</span>
0987             V.mcsY(:)<span class="keyword">...</span>
0988             V.mcsDist(:)<span class="keyword">...</span>
0989             vectorized_bed(:)<span class="keyword">...</span>
0990             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
0991             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0992             V.mcsEast(:)<span class="keyword">...</span>
0993             V.mcsNorth(:)<span class="keyword">...</span>
0994             V.mcsVert(:)<span class="keyword">...</span>
0995             V.mcsMag(:)<span class="keyword">...</span>
0996             V.mcsDir(:)<span class="keyword">...</span>
0997             V.u(:)<span class="keyword">...</span>
0998             V.v(:)<span class="keyword">...</span>
0999             V.vp(:)<span class="keyword">...</span>
1000             V.vs(:)<span class="keyword">...</span>
1001             V.Roz.up(:)<span class="keyword">...</span>
1002             V.Roz.us(:)];
1003         MCSdata(isnan(MCSdata)) = -9999;
1004         
1005         MCSout = vertcat(MCSheaders,num2cell(MCSdata));
1006         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1007         waitbar(5/7,hwait)
1008                 
1009         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1010         <span class="comment">% results</span>
1011         <span class="comment">% Compute and sort the Distances such that when plotting in 2D</span>
1012         <span class="comment">% (Dist. vs. Depth), you are looking upstream into the transect</span>
1013         PVDist = [0 cumsum(hypot(diff(PVdata.outmat(1,:)),diff(PVdata.outmat(2,:))))];
1014         PVDist = sort(PVDist,<span class="string">'descend'</span>);
1015         PVheaders = {<span class="keyword">...</span>
1016             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
1017             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1018             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1019             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1020         PVtable = [<span class="keyword">...</span>
1021             PVdata.outmat(1,:);<span class="keyword">...</span>
1022             PVdata.outmat(2,:);<span class="keyword">...</span>
1023             PVDist;<span class="keyword">...</span>
1024             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1025             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1026             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1027             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1028         PVtable = (sortrows(PVtable',3))';
1029         PVtable(isnan(PVtable)) = -9999;
1030         PVout = num2cell(PVtable');
1031         PVout = vertcat(PVheaders,PVout);
1032         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1033         waitbar(6/7,hwait)
1034         
1035         <span class="comment">%% Save the actual MCS plot data, which includes the smoothed</span>
1036         <span class="comment">% results</span>
1037         <span class="comment">% Compute and sort the Distances such that when plotting in 2D</span>
1038         <span class="comment">% (Dist. vs. Depth), you are looking upstream into the transect</span>
1039         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1040         dist    = guiparams.mcsQuivers(:,1);
1041         depth   = guiparams.mcsQuivers(:,2);
1042         vcomp   = guiparams.mcsQuivers(:,3);
1043         wcomp   = guiparams.mcsQuivers(:,4);
1044         
1045         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1046         <span class="keyword">switch</span> guiparams.contour
1047             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1048                 wtp=[<span class="string">'V.uSmooth'</span>];
1049             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1050                 wtp=[<span class="string">'V.vSmooth'</span>];
1051             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1052                 wtp=[<span class="string">'V.wSmooth'</span>];
1053             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1054                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1055             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1056                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1057             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1058                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1059             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1060                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1061             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1062                 wtp=[<span class="string">'V.vpSmooth'</span>];
1063             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1064                 wtp=[<span class="string">'V.vsSmooth'</span>];
1065             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1066                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1067             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1068                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1069             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1070                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1071             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1072                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1073             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1074                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1075             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1076                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1077             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1078                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1079             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1080                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1081             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1082                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1083             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1084                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1085             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1086                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1087         <span class="keyword">end</span>
1088         Ucomp = eval(wtp);
1089         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1090         
1091         <span class="comment">% Save MCS data to an Excel File</span>
1092         <span class="comment">% This includes the smoothed data results from the plots.</span>
1093         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1094         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1095         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1096         mcsheaders = {<span class="keyword">...</span>
1097             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1098             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1099             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1100             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1101             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1102             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1103             };
1104         mcsdata = [<span class="keyword">...</span>
1105             dist(:)<span class="keyword">...</span>
1106             depth(:)<span class="keyword">...</span>
1107             ucomp(:)<span class="keyword">...</span>
1108             vcomp(:)<span class="keyword">...</span>
1109             wcomp(:)];
1110         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1111         ridx = ~isnan(ucomp);
1112         mcsdata = mcsdata(ridx,:);
1113         mcsdata(isnan(mcsdata)) = -9999;
1114         
1115         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
1116         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1117         waitbar(7/7,hwait)
1118     <span class="keyword">else</span>
1119         <span class="comment">% Return default excel_path and excel_file</span>
1120         excel_path = guiprefs.excel_path;
1121         excel_file = guiprefs.excel_file;
1122         outfile = fullfile(excel_path,excel_file);
1123         log_text = {<span class="string">'User aborted Excel export...'</span>};
1124     <span class="keyword">end</span>
1125     
1126     
1127 waitbar(1,hwait)    
1128 <span class="keyword">end</span>
1129 
1130 <span class="comment">% Push messages to Log Window:</span>
1131 <span class="comment">% ----------------------------</span>
1132 statusLogging(handles.LogWindow, log_text)
1133 
1134 <span class="comment">% Store the persistent preferences:</span>
1135 <span class="comment">% ---------------------------------</span>
1136 guiprefs.excel_file = excel_file;
1137 guiprefs.excel_path = excel_path;
1138 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1139 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1140 delete(hwait)
1141 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1142 
1143 <span class="comment">% --------------------------------------------------------------------</span>
1144 <a name="_sub27" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1145 <span class="comment">% Empty</span>
1146 
1147 <span class="comment">% --------------------------------------------------------------------</span>
1148 <a name="_sub28" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1149 <span class="comment">% Empty</span>
1150 
1151 <span class="comment">% --------------------------------------------------------------------</span>
1152 <a name="_sub29" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1153 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1154 
1155 <span class="comment">% Get the Application Data:</span>
1156 <span class="comment">% -------------------------</span>
1157 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1158 
1159 <span class="comment">% Update the GUI &amp; Application Data:</span>
1160 <span class="comment">% ----------------------------------</span>
1161 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1162 <span class="keyword">switch</span> status
1163     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1164         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1165         guiparams.unit_discharge_correction = false;
1166     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1167         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1168         guiparams.unit_discharge_correction = true;
1169 <span class="keyword">end</span>
1170 
1171 <span class="comment">% Re-store the Application data:</span>
1172 <span class="comment">% ------------------------------</span>
1173 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1174 
1175 
1176 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1177 
1178 <span class="comment">% --------------------------------------------------------------------</span>
1179 <a name="_sub30" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1180 <span class="comment">% Empty</span>
1181 
1182 <span class="comment">% --------------------------------------------------------------------</span>
1183 <a name="_sub31" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1184 <span class="comment">% Empty</span>
1185 
1186 <span class="comment">% --------------------------------------------------------------------</span>
1187 <a name="_sub32" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1188 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1189 
1190 <span class="comment">% Get the Application Data:</span>
1191 <span class="comment">% -------------------------</span>
1192 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1193 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1194 
1195 <span class="comment">% Update the Application Data:</span>
1196 <span class="comment">% ----------------------------</span>
1197 guiparams.english_units = false;
1198 guiprefs.units = <span class="string">'metric'</span>;
1199 
1200 <span class="comment">% Re-store the Application data:</span>
1201 <span class="comment">% ------------------------------</span>
1202 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1203 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1204 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1205 
1206 <span class="comment">% Update the GUI:</span>
1207 <span class="comment">% ---------------</span>
1208 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1209 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1210 
1211 <span class="comment">% [EOF] menuMetric_Callback</span>
1212 
1213 
1214 <span class="comment">% --------------------------------------------------------------------</span>
1215 <a name="_sub33" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1216 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1217 
1218 <span class="comment">% Get the Application Data:</span>
1219 <span class="comment">% -------------------------</span>
1220 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1221 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1222 
1223 <span class="comment">% Update the Application Data:</span>
1224 <span class="comment">% ----------------------------</span>
1225 guiparams.english_units = true;
1226 guiprefs.units = <span class="string">'english'</span>;
1227 
1228 <span class="comment">% Re-store the Application data:</span>
1229 <span class="comment">% ------------------------------</span>
1230 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1231 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1232 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1233 
1234 <span class="comment">% Update the GUI:</span>
1235 <span class="comment">% ---------------</span>
1236 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1237 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1238 
1239 <span class="comment">% [EOF] menuEnglish_Callback</span>
1240 
1241 <span class="comment">% --------------------------------------------------------------------</span>
1242 <a name="_sub34" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1243 <span class="comment">% Empty</span>
1244 
1245 <span class="comment">% --------------------------------------------------------------------</span>
1246 <a name="_sub35" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1247 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1248 <span class="comment">% surface)</span>
1249 
1250 <span class="comment">% Get the Application Data:</span>
1251 <span class="comment">% -------------------------</span>
1252 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1253 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1254 
1255 <span class="comment">% Update the Application Data:</span>
1256 <span class="comment">% ----------------------------</span>
1257 guiparams.plotref = <span class="string">'dfs'</span>;
1258 guiprefs.plotref  = <span class="string">'dfs'</span>;
1259 
1260 <span class="comment">% Re-store the Application data:</span>
1261 <span class="comment">% ------------------------------</span>
1262 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1263 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1264 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1265 
1266 <span class="comment">% Update the GUI:</span>
1267 <span class="comment">% ---------------</span>
1268 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1269 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1270 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1271 
1272 <span class="comment">% --------------------------------------------------------------------</span>
1273 <a name="_sub36" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1274 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1275 
1276 <span class="comment">% Get the Application Data:</span>
1277 <span class="comment">% -------------------------</span>
1278 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1279 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1280 
1281 <span class="comment">% Update the Application Data:</span>
1282 <span class="comment">% ----------------------------</span>
1283 guiparams.plotref = <span class="string">'hab'</span>;
1284 guiprefs.plotref  = <span class="string">'hab'</span>;
1285 
1286 <span class="comment">% Prompt and set eta</span>
1287 <span class="comment">% ------------------</span>
1288 prompt = <span class="string">'Enter elevation of the bottom (eta), in meters:'</span>;
1289 dlg_title = <span class="string">'Set bottom elevation for height above bottom reference'</span>;
1290 num_lines = 1;
1291 def = {num2str(guiparams.eta)};
1292 guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));
1293 
1294 
1295 <span class="comment">% Re-store the Application data:</span>
1296 <span class="comment">% ------------------------------</span>
1297 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1298 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1299 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1300 
1301 <span class="comment">% Update the GUI:</span>
1302 <span class="comment">% ---------------</span>
1303 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1304 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1305 
1306 
1307 
1308 
1309 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1310 
1311 <span class="comment">% --------------------------------------------------------------------</span>
1312 <a name="_sub37" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1313 <span class="comment">% Empty</span>
1314 
1315 <span class="comment">% --------------------------------------------------------------------</span>
1316 <a name="_sub38" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1317 <span class="comment">% Set cross-section endpoints automatically</span>
1318 
1319 <span class="comment">% Get the Application Data:</span>
1320 <span class="comment">% -------------------------</span>
1321 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1322 
1323 <span class="comment">% Update the Application Data:</span>
1324 <span class="comment">% ----------------------------</span>
1325 guiparams.set_cross_section_endpoints = false;
1326 
1327 <span class="comment">% Re-store the Application data:</span>
1328 <span class="comment">% ------------------------------</span>
1329 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1330 
1331 <span class="comment">% Update the GUI:</span>
1332 <span class="comment">% ---------------</span>
1333 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1334 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1335 
1336 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1337 
1338 
1339 <span class="comment">% --------------------------------------------------------------------</span>
1340 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1341 <span class="comment">% Set cross-section endpoints manually</span>
1342 
1343 <span class="comment">% Get the Application Data:</span>
1344 <span class="comment">% -------------------------</span>
1345 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1346 
1347 <span class="comment">% Update the Application Data:</span>
1348 <span class="comment">% ----------------------------</span>
1349 guiparams.set_cross_section_endpoints = true;
1350 
1351 <span class="comment">% Re-store the Application data:</span>
1352 <span class="comment">% ------------------------------</span>
1353 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1354 
1355 <span class="comment">% Update the GUI:</span>
1356 <span class="comment">% ---------------</span>
1357 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1358 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1359 
1360 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1361 
1362 
1363 
1364 
1365 <span class="comment">% --------------------------------------------------------------------</span>
1366 <a name="_sub40" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1367 <span class="comment">% Empty</span>
1368 
1369 <span class="comment">% --------------------------------------------------------------------</span>
1370 <a name="_sub41" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1371 
1372 <span class="comment">% Get the Application Data:</span>
1373 <span class="comment">% -------------------------</span>
1374 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1375 
1376 <span class="comment">% Update the Application Data:</span>
1377 <span class="comment">% ----------------------------</span>
1378 guiparams.print        = true;
1379 guiparams.presentation = false;
1380 
1381 <span class="comment">% Re-store the Application data:</span>
1382 <span class="comment">% ------------------------------</span>
1383 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1384 
1385 <span class="comment">% Update the GUI:</span>
1386 <span class="comment">% ---------------</span>
1387 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1388 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1389 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1390 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1391 
1392 <span class="comment">% Modify the existing figures</span>
1393 <span class="comment">% ---------------------------</span>
1394 <span class="comment">% Find what plots exist already</span>
1395 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1396 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1397 
1398 <span class="comment">% Defaults for Print Stlye Figure</span>
1399 BkgdColor   = <span class="string">'white'</span>;
1400 AxColor     = <span class="string">'black'</span>;
1401 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1402 FntSize     = 14;
1403 
1404 <span class="comment">% Loop through valid figures and adjust</span>
1405 <span class="comment">% -------------------------------------</span>
1406 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1407     
1408     <span class="keyword">for</span> i = 1:length(valid_names)
1409         <span class="keyword">switch</span> valid_names{i}
1410             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1411                 <span class="comment">% Focus the figure</span>
1412                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1413                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1414                     figure(hff)
1415                     
1416                     <span class="comment">% Make the changes to figure</span>
1417                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1418                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1419                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1420                     set(gca,<span class="string">'Color'</span>,FigColor)
1421                     set(gca,<span class="string">'XColor'</span>,AxColor)
1422                     set(gca,<span class="string">'YColor'</span>,AxColor)
1423                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1424                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1425                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1426                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1427                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1428                     
1429                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1430                     <span class="comment">% the file(s) and path for the data</span>
1431                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1432                     <span class="keyword">if</span> ~ismultiplot
1433                         filestr = guiparams.savefile;
1434                         wd = length(filestr);
1435                         hd = 1;
1436                     <span class="keyword">else</span>
1437                         <span class="comment">% Construct a filename</span>
1438                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1439                         wd        = max(cellfun(@length,filestr));
1440                         hd        = numel(filestr);
1441                             
1442                     <span class="keyword">end</span>
1443                     
1444                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1445                     disableMenuBar(hff)
1446                     set(fileinfotxt,<span class="keyword">...</span>
1447                         <span class="string">'string'</span>,filestr)
1448                     set(fileinfotxt,<span class="keyword">...</span>
1449                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1450                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1451                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1452                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1453                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1454                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1455                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1456                     
1457                 <span class="keyword">end</span>
1458             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1459                 <span class="comment">% Focus the figure</span>
1460                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1461                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1462                     figure(hff)
1463                     
1464                     <span class="comment">% Make the changes to figure</span>
1465                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1466                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1467                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1468                     set(gca,<span class="string">'Color'</span>,FigColor)
1469                     set(gca,<span class="string">'XColor'</span>,AxColor)
1470                     set(gca,<span class="string">'YColor'</span>,AxColor)
1471                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1472                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1473                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1474                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1475                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1476                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1477                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1478                     
1479                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1480                     <span class="comment">% the file(s) and path for the data</span>
1481                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1482                     <span class="keyword">if</span> ~ismultiplot
1483                         filestr = guiparams.savefile;
1484                         wd = length(filestr);
1485                         hd = 1;
1486                     <span class="keyword">else</span>
1487                         <span class="comment">% Construct a filename</span>
1488                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1489                         wd        = max(cellfun(@length,filestr));
1490                         hd        = numel(filestr);
1491                             
1492                     <span class="keyword">end</span>
1493                     
1494                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1495                     disableMenuBar(hff)
1496                     set(fileinfotxt,<span class="keyword">...</span>
1497                         <span class="string">'string'</span>,filestr)
1498                     set(fileinfotxt,<span class="keyword">...</span>
1499                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1500                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1501                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1502                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1503                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1504                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1505                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1506                 <span class="keyword">end</span>
1507             <span class="keyword">otherwise</span>
1508         <span class="keyword">end</span>
1509     <span class="keyword">end</span>
1510     
1511     
1512 <span class="keyword">end</span>
1513 
1514 
1515 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1516 
1517 
1518 <span class="comment">% --------------------------------------------------------------------</span>
1519 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1520 <span class="comment">% Get the Application Data:</span>
1521 <span class="comment">% -------------------------</span>
1522 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1523 
1524 <span class="comment">% Update the Application Data:</span>
1525 <span class="comment">% ----------------------------</span>
1526 guiparams.print        = false;
1527 guiparams.presentation = true;
1528 
1529 <span class="comment">% Re-store the Application data:</span>
1530 <span class="comment">% ------------------------------</span>
1531 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1532 
1533 <span class="comment">% Update the GUI:</span>
1534 <span class="comment">% ---------------</span>
1535 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1536 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1537 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1538 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1539 
1540 <span class="comment">% Modify the existing figures</span>
1541 <span class="comment">% ---------------------------</span>
1542 <span class="comment">% Find what plots exist already</span>
1543 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1544 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1545 
1546 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1547 <span class="comment">% --------------------------------------</span>
1548 BkgdColor   = <span class="string">'black'</span>;
1549 AxColor     = <span class="string">'white'</span>;
1550 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1551 FntSize     = 14;
1552 
1553 <span class="comment">% Loop through valid figures and adjust</span>
1554 <span class="comment">% -------------------------------------</span>
1555 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1556     
1557     <span class="keyword">for</span> i = 1:length(valid_names)
1558         <span class="keyword">switch</span> valid_names{i}
1559             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1560                 <span class="comment">% Focus the figure</span>
1561                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1562                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1563                     figure(hff)
1564                     
1565                     <span class="comment">% Make the changes to figure</span>
1566                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1567                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1568                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1569                     set(gca,<span class="string">'Color'</span>,FigColor)
1570                     set(gca,<span class="string">'XColor'</span>,AxColor)
1571                     set(gca,<span class="string">'YColor'</span>,AxColor)
1572                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1573                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1574                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1575                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1576                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1577                     
1578                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1579                     <span class="comment">% the file(s) and path for the data</span>
1580                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1581                     <span class="keyword">if</span> ~ismultiplot
1582                         filestr = guiparams.savefile;
1583                         wd = length(filestr);
1584                         hd = 1;
1585                     <span class="keyword">else</span>
1586                         <span class="comment">% Construct a filename</span>
1587                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1588                         wd        = max(cellfun(@length,filestr));
1589                         hd        = numel(filestr);
1590                             
1591                     <span class="keyword">end</span>
1592                     
1593                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1594                     disableMenuBar(hff)
1595                     set(fileinfotxt,<span class="keyword">...</span>
1596                         <span class="string">'string'</span>,filestr)
1597                     set(fileinfotxt,<span class="keyword">...</span>
1598                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1599                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1600                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1601                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1602                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1603                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1604                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1605                     
1606                 <span class="keyword">end</span>
1607             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1608                 <span class="comment">% Focus the figure</span>
1609                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1610                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1611                     figure(hff)
1612                     
1613                     <span class="comment">% Make the changes to figure</span>
1614                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1615                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1616                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1617                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1618                     set(gca,<span class="string">'XColor'</span>,AxColor)
1619                     set(gca,<span class="string">'YColor'</span>,AxColor)
1620                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1621                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1622                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1623                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1624                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1625                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1626                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1627                     
1628                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1629                     <span class="comment">% the file(s) and path for the data</span>
1630                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1631                     <span class="keyword">if</span> ~ismultiplot
1632                         filestr = guiparams.savefile;
1633                         wd = length(filestr);
1634                         hd = 1;
1635                     <span class="keyword">else</span>
1636                         <span class="comment">% Construct a filename</span>
1637                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1638                         wd        = max(cellfun(@length,filestr));
1639                         hd        = numel(filestr);
1640                             
1641                     <span class="keyword">end</span>
1642                     
1643                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1644                     disableMenuBar(hff)
1645                     set(fileinfotxt,<span class="keyword">...</span>
1646                         <span class="string">'string'</span>,filestr)
1647                     set(fileinfotxt,<span class="keyword">...</span>
1648                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1649                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1650                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1651                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1652                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1653                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1654                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1655                 <span class="keyword">end</span>
1656             <span class="keyword">otherwise</span>
1657         <span class="keyword">end</span>
1658     <span class="keyword">end</span>
1659     
1660     
1661 <span class="keyword">end</span>
1662 
1663 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1664 
1665 <span class="comment">% --------------------------------------------------------------------</span>
1666 <a name="_sub43" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1667 
1668 <span class="comment">% Get the Application data:</span>
1669 <span class="comment">% -------------------------</span>
1670 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1671 
1672 <span class="comment">% Initialize the answer:</span>
1673 <span class="comment">% ----------------------</span>
1674 numstr = {num2str(guiparams.vertical_offset)};
1675 answer = NaN;
1676 <span class="keyword">while</span> isnan(answer)
1677     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1678     
1679     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1680         <span class="keyword">return</span>
1681     <span class="keyword">end</span>
1682     
1683     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1684     <span class="comment">% A numeric char will be a double</span>
1685 <span class="keyword">end</span>
1686 
1687 <span class="comment">% Re-store the Application data:</span>
1688 <span class="comment">% ------------------------------</span>
1689 guiparams.vertical_offset = answer;
1690 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1691 
1692 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1693 
1694 <span class="comment">% --------------------------------------------------------------------</span>
1695 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1696 <span class="comment">% Not implemented</span>
1697 
1698 <span class="comment">% --------------------------------------------------------------------</span>
1699 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1700 <span class="comment">% Empty</span>
1701 
1702 <span class="comment">% --------------------------------------------------------------------</span>
1703 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1704 ASCII2GIS_GUI
1705 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1706 
1707 <span class="comment">% --------------------------------------------------------------------</span>
1708 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1709 
1710 <span class="comment">% Get the Application preferences:</span>
1711 <span class="comment">% --------------------------------</span>
1712 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1713 
1714 inpath = guiprefs.kmz_path;
1715 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1716     infile = guiprefs.kmz_file{1};
1717 <span class="keyword">else</span>
1718     infile = guiprefs.kmz_file;
1719 <span class="keyword">end</span>
1720 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1721 
1722 guiprefs.kmz_path = outpath;
1723 guiprefs.kmz_file = outfile;
1724 
1725 <span class="comment">% Update persistent preferences</span>
1726 <span class="comment">% -----------------------------</span>
1727 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1728 
1729 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1730 
1731 <span class="comment">% --------------------------------------------------------------------</span>
1732 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1733 <span class="comment">% Get the Application preferences:</span>
1734 <span class="comment">% --------------------------------</span>
1735 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1736 
1737 VMT_BatchMode;
1738 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1739 
1740 <span class="comment">% --------------------------------------------------------------------</span>
1741 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1742 <span class="comment">% Empty</span>
1743 
1744 <span class="comment">% --------------------------------------------------------------------</span>
1745 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1746 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1747 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1748     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1749     
1750 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1751     
1752     <span class="keyword">if</span> isdeployed
1753         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1754             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1755         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1756             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1757             errLogFileName},<span class="keyword">...</span>
1758             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1759             <span class="string">'error'</span>);
1760         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1761         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1762         fclose(fid);
1763         rethrow(err)
1764     <span class="keyword">else</span>
1765         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1766             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1767             <span class="string">'error'</span>);
1768         rethrow(err);
1769     <span class="keyword">end</span>
1770 <span class="keyword">end</span>
1771 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1772 
1773 <span class="comment">% --------------------------------------------------------------------</span>
1774 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1775 <span class="comment">% Get the Application data:</span>
1776 <span class="comment">% -------------------------</span>
1777 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1778 
1779 <span class="keyword">try</span>
1780     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1781 
1782 
1783 <span class="comment">% This catch is probably not necessary.</span>
1784 <span class="keyword">catch</span> err 
1785     <span class="keyword">if</span> isdeployed
1786         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1787             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1788         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1789             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1790             errLogFileName},<span class="keyword">...</span>
1791             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1792             <span class="string">'error'</span>);
1793         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1794         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1795         fclose(fid);
1796         rethrow(err)
1797     <span class="keyword">else</span>
1798         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1799             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1800             <span class="string">'error'</span>);
1801         rethrow(err);
1802     <span class="keyword">end</span>
1803 <span class="keyword">end</span>
1804 
1805 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1806 
1807 <span class="comment">% --------------------------------------------------------------------</span>
1808 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1809 
1810 <span class="comment">% Get the Application data:</span>
1811 <span class="comment">% -------------------------</span>
1812 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1813 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1814 
1815 <span class="comment">% Check version tag against the web, and display a message</span>
1816 <span class="keyword">try</span>
1817     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1818     webdata = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1819     <span class="keyword">if</span> length(webdata) &gt; 5
1820         current_vmt_version{1} = webdata(1:5);
1821         current_vmt_version{2} = webdata(8:16);
1822     <span class="keyword">else</span>
1823         current_vmt_version = webdata;
1824     <span class="keyword">end</span>
1825     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1826 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1827     <span class="keyword">if</span> isdeployed
1828         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1829             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1830         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1831             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1832             errLogFileName},<span class="keyword">...</span>
1833             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1834             <span class="string">'error'</span>);
1835         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1836         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1837         fclose(fid);
1838         rethrow(err)
1839     <span class="keyword">else</span>
1840         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1841             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1842             <span class="string">'error'</span>);
1843         rethrow(err);
1844     <span class="keyword">end</span>
1845 <span class="keyword">end</span>
1846 
1847 <span class="keyword">if</span> ischar(current_vmt_version)
1848     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1849         h = msgbox(<span class="keyword">...</span>
1850             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1851             <span class="string">''</span>;<span class="keyword">...</span>
1852             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1853             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1854     <span class="keyword">else</span>
1855         h = msgbox(<span class="keyword">...</span>
1856             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1857             <span class="string">''</span>;<span class="keyword">...</span>
1858             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1859             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1860     <span class="keyword">end</span>
1861 <span class="keyword">elseif</span> iscell(current_vmt_version)
1862     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1863         h = msgbox(<span class="keyword">...</span>
1864             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1865             <span class="string">''</span>;<span class="keyword">...</span>
1866             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1867             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1868     <span class="keyword">else</span>
1869         h = msgbox(<span class="keyword">...</span>
1870             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1871             <span class="string">''</span>;<span class="keyword">...</span>
1872             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1873             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1874     <span class="keyword">end</span>
1875 <span class="keyword">end</span>
1876 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1877 
1878 <span class="comment">% --------------------------------------------------------------------</span>
1879 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1880 
1881 <span class="comment">% Get the Application data:</span>
1882 <span class="comment">% -------------------------</span>
1883 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1884 messagestr = <span class="keyword">...</span>
1885     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1886     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1887     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1888     <span class="string">''</span>;<span class="keyword">...</span>
1889     <span class="string">''</span>;<span class="keyword">...</span>
1890     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1891     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1892     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1893     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1894     <span class="string">''</span>;<span class="keyword">...</span>
1895     <span class="string">''</span>;<span class="keyword">...</span>
1896     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1897     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1898     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1899     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1900     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1901     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1902     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1903 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1904 <span class="comment">% [EOF] menuAbout_Callback</span>
1905 
1906 
1907 
1908 
1909 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1910 <span class="comment">% TOOLBAR CALLBACKS %</span>
1911 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1912 
1913 <span class="comment">% --------------------------------------------------------------------</span>
1914 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1915 <span class="comment">% Read Files into Data Structure using tfile.</span>
1916 
1917 <span class="comment">% Get the Application data:</span>
1918 <span class="comment">% -------------------------</span>
1919 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1920 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1921 
1922 <span class="comment">% Ask the user to select files:</span>
1923 <span class="comment">% -----------------------------</span>
1924 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1925 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1926     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1927     current_file, <span class="keyword">...</span>
1928     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1929 
1930 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1931     guiparams.data_folder = pathname;
1932     <span class="keyword">if</span> ischar(filename)
1933         filename = {filename};
1934     <span class="keyword">end</span>
1935     guiparams.data_files = filename;
1936     guiparams.mat_file = <span class="string">''</span>;
1937     
1938     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1939     
1940    
1941     
1942     <span class="comment">% Update the preferences:</span>
1943     <span class="comment">% -----------------------</span>
1944     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1945     guiprefs.ascii_path = pathname;
1946     guiprefs.ascii_file = filename;
1947     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1948     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1949     
1950     <span class="comment">% Push messages to Log Window:</span>
1951     <span class="comment">% ----------------------------</span>
1952     log_text = {<span class="keyword">...</span>
1953         <span class="string">''</span>;<span class="keyword">...</span>
1954         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1955         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1956         guiparams.data_folder;
1957         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1958         char(filename)};
1959     statusLogging(handles.LogWindow, log_text)
1960     
1961     <span class="comment">% Read the file(s)</span>
1962     <span class="comment">% ----------------</span>
1963     [~,~,savefile,A,z] = <span class="keyword">...</span>
1964         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1965     guiparams.savefile = savefile;
1966     guiparams.A        = A;
1967     guiparams.z        = z;
1968     
1969     
1970     <span class="comment">% Set the vertical grid node spacing</span>
1971     <span class="comment">% ----------------------------------</span>
1972     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1973     <span class="comment">% Backwards compatible</span>
1974     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1975         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1976         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1977     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1978         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1979         guiparams.vertical_grid_node_spacing = 0.4;
1980     <span class="keyword">end</span>
1981     
1982     
1983     <span class="comment">% Save application data</span>
1984     <span class="comment">% ---------------------</span>
1985     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1986        
1987 <span class="comment">%</span>
1988 <span class="comment">%     % Preprocess the data:</span>
1989 <span class="comment">%     % --------------------</span>
1990 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1991 <span class="comment">%</span>
1992 <span class="comment">%     % Push messages to Log Window:</span>
1993 <span class="comment">%     % ----------------------------</span>
1994 <span class="comment">%     log_text = {...</span>
1995 <span class="comment">%         '   Preprocessing complete.';...</span>
1996 <span class="comment">%         '   Begin Data Processing...'};</span>
1997 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1998 <span class="comment">%</span>
1999 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2000 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2001 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2002 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2003 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2004 <span class="comment">%</span>
2005 <span class="comment">%     % Push messages to Log Window:</span>
2006 <span class="comment">%     % ----------------------------</span>
2007 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2008 <span class="comment">%</span>
2009 <span class="comment">%     % Store the data:</span>
2010 <span class="comment">%     % ---------------</span>
2011 <span class="comment">%     guiparams.z = z;</span>
2012 <span class="comment">%     guiparams.A = A;</span>
2013 <span class="comment">%     guiparams.V = V;</span>
2014 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2015     
2016           
2017     <span class="comment">% Update the GUI:</span>
2018     <span class="comment">% ---------------</span>
2019     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2020     
2021     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2022     
2023 <span class="keyword">end</span>
2024 <span class="comment">% [EOF] loadDataCallback</span>
2025 
2026 
2027 
2028 <span class="comment">% --------------------------------------------------------------------</span>
2029 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2030 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2031 
2032 <span class="comment">% Get the Application data:</span>
2033 <span class="comment">% -------------------------</span>
2034 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2035 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2036 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2037 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2038 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2039 
2040 [the_file,the_path] = <span class="keyword">...</span>
2041     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2042     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2043     fullfile(guiparams.mat_path,guiparams.savefile));
2044 
2045 <span class="comment">% Save the processed data to a MAT file:</span>
2046 <span class="comment">% --------------------------------------</span>
2047 <span class="keyword">if</span> ischar(the_file)
2048     guiparams.mat_path = the_path;
2049     guiparams.mat_file = the_file;
2050     guiparams.savefile = the_file;
2051     
2052     <span class="comment">% Re-store the Application data:</span>
2053     <span class="comment">% ------------------------------</span>
2054     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2055     
2056     <span class="comment">% Update the preferences:</span>
2057     <span class="comment">% -----------------------</span>
2058     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2059     guiprefs.mat_path = the_path;
2060     guiprefs.mat_file = the_file;
2061     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2062     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2063     
2064     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2065     savefile = fullfile(pathstr,[filename extension]);
2066     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2067     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2068     log_text = {<span class="keyword">...</span>
2069         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2070         savefile};
2071     statusLogging(handles.LogWindow,log_text)
2072     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2073 <span class="keyword">end</span>
2074 
2075 <span class="comment">% [EOF] saveDataCallback</span>
2076 
2077 
2078 <span class="comment">% --------------------------------------------------------------------</span>
2079 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2080 
2081 <span class="comment">% Get the Application data:</span>
2082 <span class="comment">% -------------------------</span>
2083 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2084 z   = guiparams.z;
2085 A   = guiparams.A;
2086 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2087 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2088 
2089 <span class="comment">% Compute multibeam bathymetry:</span>
2090 <span class="comment">% -----------------------------</span>
2091 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2092 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2093 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2094     guiparams.beam_angle, <span class="keyword">...</span>
2095     guiparams.magnetic_variation, <span class="keyword">...</span>
2096     guiparams.wse, <span class="keyword">...</span>
2097     guiparams.output_auxiliary_data);
2098 
2099 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2100 
2101 <span class="comment">% [EOF] saveBathymetryCallback</span>
2102 
2103 <span class="comment">% --------------------------------------------------------------------</span>
2104 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2105 
2106 <span class="comment">% Get the Application data:</span>
2107 <span class="comment">% -------------------------</span>
2108 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2109 
2110 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2111     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2112     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2113     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2114     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2115     handles.figure1);
2116 
2117 <span class="comment">% Update the GUI:</span>
2118 <span class="comment">% ---------------</span>
2119 <span class="keyword">if</span> guiparams.english_units
2120     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2121     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2122 <span class="keyword">else</span>
2123     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2124     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2125 <span class="keyword">end</span>
2126 
2127 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2128     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2129     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2130 <span class="keyword">else</span>
2131     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2132     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2133 <span class="keyword">end</span>
2134 
2135 <span class="keyword">if</span> guiparams.presentation
2136     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2137 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2138 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2139 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2140 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2141 <span class="keyword">else</span>
2142     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2143 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2144 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2145 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2146 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2147 <span class="keyword">end</span>
2148 
2149 <span class="comment">% Re-store the Application data:</span>
2150 <span class="comment">% ------------------------------</span>
2151 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2152 
2153 <span class="comment">% [EOF] plottingParametersCallback</span>
2154 
2155 
2156 <span class="comment">% --------------------------------------------------------------------</span>
2157 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2158 
2159 <span class="comment">% Get the Application data:</span>
2160 <span class="comment">% -------------------------</span>
2161 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2162 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2163 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2164 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2165 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2166 
2167 <span class="comment">% [EOF] processingParametersCallback</span>
2168 
2169 
2170 <span class="comment">% --------------------------------------------------------------------</span>
2171 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2172 <span class="comment">% Plot 1</span>
2173 
2174 <span class="comment">% Get the Application data:</span>
2175 <span class="comment">% -------------------------</span>
2176 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2177 z = guiparams.z;
2178 A = guiparams.A;
2179 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2180 <span class="comment">% Map = guiparams.Map;</span>
2181 
2182 
2183 <span class="comment">% Preprocess the data:</span>
2184 <span class="comment">% --------------------</span>
2185 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2186 
2187 <span class="comment">% Push messages to Log Window:</span>
2188 <span class="comment">% ----------------------------</span>
2189 log_text = {<span class="keyword">...</span>
2190     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2191     <span class="string">'   Begin Data Processing...'</span>};
2192 statusLogging(handles.LogWindow, log_text)
2193 
2194 <span class="comment">% Process the transects:</span>
2195 <span class="comment">% ----------------------</span>
2196 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2197 A(1).vgns = guiparams.vertical_grid_node_spacing;
2198 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2199 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2200     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2201 
2202 <span class="comment">% Compute the smoothed variables</span>
2203 <span class="comment">% ------------------------------</span>
2204 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2205 <span class="comment">% runtime.</span>
2206 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2207     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2208     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2209     guiparams.vertical_smoothing_window);
2210 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2211 
2212 <span class="comment">% Push messages to Log Window:</span>
2213 <span class="comment">% ----------------------------</span>
2214 statusLogging(handles.LogWindow, processing_log_text)
2215 
2216 <span class="comment">% Store the data:</span>
2217 <span class="comment">% ---------------</span>
2218 guiparams.z = z;
2219 guiparams.A = A;
2220 guiparams.V = V;
2221 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2222 
2223 <span class="comment">% Push messages to Log Window:</span>
2224 <span class="comment">% ----------------------------</span>
2225 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2226 statusLogging(handles.LogWindow, log_text)
2227 
2228 <span class="comment">% Create or replot the Shiptracks</span>
2229 <span class="comment">% -------------------------------</span>
2230 <span class="comment">% Grab the axes to the plot</span>
2231 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2232 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2233 
2234 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2235 <span class="comment">% New plot display window</span>
2236 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2237 <span class="comment">% h = figure(1); clf</span>
2238 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2239 
2240 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2241 
2242 
2243 <span class="comment">% --------------------------------------------------------------------</span>
2244 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2245 <span class="comment">% Plot 2</span>
2246 
2247 <span class="comment">% Get the Application data:</span>
2248 <span class="comment">% -------------------------</span>
2249 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2250 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2251 
2252 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2253     <span class="comment">% Push messages to Log Window:</span>
2254     <span class="comment">% ----------------------------</span>
2255     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2256     statusLogging(handles.LogWindow, log_text)
2257     
2258        
2259     <span class="comment">% Push plotting parameters to log window:</span>
2260     <span class="comment">% ---------------------------------------</span>
2261     log_text = {<span class="keyword">...</span>
2262         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2263         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2264         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2265         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2266         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2267         };
2268     statusLogging(handles.LogWindow, log_text)
2269     
2270     <span class="comment">% Plot the data:</span>
2271     <span class="comment">% --------------</span>
2272     z = [];
2273     A = [];
2274     V = [];
2275     Map = [];
2276     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2277     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2278         depth_range, <span class="keyword">...</span>
2279         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2280         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2281         guiparams.smoothing_window_size, <span class="keyword">...</span>
2282         guiparams.display_shoreline, <span class="keyword">...</span>
2283         guiparams.english_units, <span class="keyword">...</span>
2284         guiparams.mat_file, <span class="keyword">...</span>
2285         guiparams.mat_path); <span class="comment">% PLOT2</span>
2286     statusLogging(handles.LogWindow, log_text)
2287     
2288     <span class="comment">% Plot a Shoreline Map:</span>
2289     <span class="comment">% ---------------------</span>
2290     <span class="keyword">if</span> guiparams.display_shoreline
2291         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2292             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2293             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2294             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2295         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2296             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2297             Map.UTMe   = mapdata(:,1);
2298             Map.UTMn   = mapdata(:,2);
2299             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2300             <span class="comment">%Map.UTMzone = zone;</span>
2301         <span class="keyword">else</span>
2302             Map = [];
2303         <span class="keyword">end</span>
2304         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2305         log_text = {<span class="keyword">...</span>
2306             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2307             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2308             };
2309         statusLogging(handles.LogWindow, log_text)
2310     <span class="keyword">else</span>
2311         Map = [];
2312     <span class="keyword">end</span>
2313     
2314 <span class="keyword">else</span>
2315     z = guiparams.z;
2316     A = guiparams.A;
2317     <span class="comment">% V = guiparams.V;</span>
2318     Map = guiparams.Map;
2319     
2320     <span class="comment">% Push messages to Log Window:</span>
2321     <span class="comment">% ----------------------------</span>
2322     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2323     statusLogging(handles.LogWindow, log_text)
2324     
2325         
2326     <span class="comment">% Preprocess the data:</span>
2327     <span class="comment">% --------------------</span>
2328     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2329     
2330     <span class="comment">% Process the transects:</span>
2331     <span class="comment">% ----------------------</span>
2332     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2333     A(1).vgns = guiparams.vertical_grid_node_spacing;
2334     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2335     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2336         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2337     
2338     <span class="comment">% Compute the smoothed variables</span>
2339     <span class="comment">% ------------------------------</span>
2340     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2341     <span class="comment">% runtime.</span>
2342     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2343         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2344         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2345         guiparams.vertical_smoothing_window);
2346     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2347     
2348     <span class="comment">% Push messages to Log Window:</span>
2349     <span class="comment">% ----------------------------</span>
2350     statusLogging(handles.LogWindow, processing_log_text)
2351     
2352     <span class="comment">% Plot the cross section:</span>
2353     <span class="comment">% -----------------------</span>
2354     log_text = {<span class="keyword">...</span>
2355         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2356         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2357         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2358         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2359         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2360         };
2361     statusLogging(handles.LogWindow, log_text)
2362     
2363     <span class="comment">% Plot the data:</span>
2364     <span class="comment">% --------------</span>
2365     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2366     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2367     
2368     
2369     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2370         depth_range, <span class="keyword">...</span>
2371         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2372         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2373         guiparams.smoothing_window_size, <span class="keyword">...</span>
2374         guiparams.display_shoreline, <span class="keyword">...</span>
2375         guiparams.english_units, <span class="keyword">...</span>
2376         guiparams.mat_file, <span class="keyword">...</span>
2377         guiparams.mat_path); <span class="comment">% PLOT2</span>
2378     statusLogging(handles.LogWindow, log_text)
2379     
2380     <span class="comment">% Plot User Set Endpoints</span>
2381     <span class="comment">% -----------------------</span>
2382     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2383         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2384         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2385         x = data(:,1);
2386         y = data(:,2);
2387         
2388         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2389         figure(fh); hold on
2390         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2391         hold off
2392     <span class="keyword">end</span>
2393     
2394     <span class="comment">% Plot a Shoreline Map:</span>
2395     <span class="comment">% ---------------------</span>
2396     <span class="keyword">if</span> guiparams.display_shoreline
2397         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2398             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2399             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2400             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2401         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2402             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2403             Map.UTMe   = mapdata(:,1);
2404             Map.UTMn   = mapdata(:,2);
2405             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2406             <span class="comment">%Map.UTMzone = zone;</span>
2407         <span class="keyword">else</span>
2408             Map = [];
2409         <span class="keyword">end</span>
2410         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2411         log_text = {<span class="keyword">...</span>
2412             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2413             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2414             };
2415         statusLogging(handles.LogWindow, log_text)
2416     <span class="keyword">else</span>
2417         Map = [];
2418     <span class="keyword">end</span>
2419     
2420 <span class="keyword">end</span>
2421 
2422 <span class="keyword">if</span> guiparams.add_background
2423     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2424     statusLogging(handles.LogWindow, log_text)
2425 <span class="keyword">end</span>
2426 
2427 <span class="comment">% Update guiparams</span>
2428 <span class="comment">% ----------------</span>
2429 guiparams.z   = z;
2430 guiparams.A   = A;
2431 guiparams.V   = V;
2432 guiparams.Map = Map;
2433 guiparams.iric_anv_planview_data = PVdata;
2434 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2435 
2436 <span class="comment">% Update preferences</span>
2437 <span class="comment">% ------------------</span>
2438 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2439 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2440 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2441 
2442 <span class="comment">% Force plot to be formated properly</span>
2443 <span class="comment">% ----------------------------------</span>
2444 <span class="keyword">if</span> guiparams.presentation
2445     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2446 <span class="keyword">else</span>
2447     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2448 <span class="keyword">end</span>
2449 <span class="keyword">switch</span> guiparams.renderer
2450     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2451         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2452     <span class="keyword">case</span> <span class="string">'painters'</span>
2453         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2454     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2455         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2456 <span class="keyword">end</span>
2457 
2458 <span class="comment">% Focus the figure</span>
2459 <span class="comment">% ----------------</span>
2460 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2461 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2462     figure(hff)
2463 <span class="keyword">end</span>
2464 
2465 <span class="comment">% Start the Graphics Control Gui</span>
2466 <span class="comment">% ------------------------------</span>
2467 VMT_GraphicsControl
2468 
2469 <span class="comment">% [EOF] planviewPlotCallback</span>
2470 
2471 
2472 <span class="comment">% --------------------------------------------------------------------</span>
2473 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2474 <span class="comment">% Plot 3</span>
2475 
2476 <span class="comment">% Get the Application data:</span>
2477 <span class="comment">% -------------------------</span>
2478 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2479 z = guiparams.z;
2480 A = guiparams.A;
2481 <span class="comment">% V = guiparams.V;</span>
2482 <span class="comment">% Map = guiparams.Map;</span>
2483 
2484 <span class="comment">% Preprocess the data:</span>
2485 <span class="comment">% --------------------</span>
2486 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2487 
2488 <span class="comment">% Push messages to Log Window:</span>
2489 <span class="comment">% ----------------------------</span>
2490 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2491 statusLogging(handles.LogWindow, log_text)
2492 
2493 <span class="comment">% Process the transects:</span>
2494 <span class="comment">% ----------------------</span>
2495 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2496 A(1).vgns = guiparams.vertical_grid_node_spacing;
2497 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2498 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2499     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2500 
2501 <span class="comment">% Push messages to Log Window:</span>
2502 <span class="comment">% ----------------------------</span>
2503 statusLogging(handles.LogWindow, processing_log_text)
2504 
2505 <span class="comment">% Plot the cross section:</span>
2506 <span class="comment">% -----------------------</span>
2507 log_text = {<span class="keyword">...</span>
2508     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2509     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2510     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2511     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2512     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2513     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2514     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2515     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2516     };
2517 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2518     log_text = vertcat(log_text, {<span class="keyword">...</span>
2519         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2520         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2521         });
2522 <span class="keyword">end</span>
2523 <span class="comment">% Push messages to Log Window:</span>
2524 <span class="comment">% ----------------------------</span>
2525 statusLogging(handles.LogWindow, log_text)
2526 
2527 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2528     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2529 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2530 <span class="comment">%         ...guiparams.contour, ...</span>
2531 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2532 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2533     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2534         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2535         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2536         guiparams.vertical_smoothing_window);
2537     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2538     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2539         guiparams.contour, <span class="keyword">...</span>
2540         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2541         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2542         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2543         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2544         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2545         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2546         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2547     
2548 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2549     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2550         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2551         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2552         guiparams.vertical_smoothing_window);
2553     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2554     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2555         guiparams.contour, <span class="keyword">...</span>
2556         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2557         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2558     
2559     guiparams.zmin = zmin;
2560     guiparams.zmax = zmax;
2561     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2562 <span class="keyword">end</span>
2563 
2564 <span class="comment">% Force plot to be formated properly</span>
2565 <span class="comment">% ----------------------------------</span>
2566 <span class="keyword">if</span> guiparams.presentation
2567     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2568 <span class="keyword">else</span>
2569     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2570 <span class="keyword">end</span>
2571 <span class="keyword">switch</span> guiparams.renderer
2572     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2573         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2574     <span class="keyword">case</span> <span class="string">'painters'</span>
2575         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2576     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2577         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2578 <span class="keyword">end</span>
2579 
2580 <span class="comment">% Focus the figure</span>
2581 <span class="comment">% ----------------</span>
2582 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2583 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2584     figure(hff)
2585 <span class="keyword">end</span>
2586 
2587 <span class="comment">% Re-store the Application data:</span>
2588 <span class="comment">% ------------------------------</span>
2589 guiparams.V = V;
2590 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2591 
2592 <span class="comment">% Start the Graphics Control Gui</span>
2593 <span class="comment">% ------------------------------</span>
2594 VMT_GraphicsControl
2595 
2596 <span class="comment">% Push messages to Log Window:</span>
2597 <span class="comment">% ----------------------------</span>
2598 statusLogging(handles.LogWindow, plot_cont_log_text)
2599 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2600 
2601 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2602 
2603 
2604 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2605 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2606 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2607 
2608 <span class="comment">% --------------------------------------------------------------------</span>
2609 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2610 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2611 
2612 <span class="comment">% Get the Application data:</span>
2613 <span class="comment">% -------------------------</span>
2614 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2615 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2616 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2617 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2618 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2619 
2620 [the_file,the_path] = <span class="keyword">...</span>
2621     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2622     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2623     fullfile(guiparams.mat_path,guiparams.savefile));
2624 
2625 <span class="comment">% Save the processed data to a MAT file:</span>
2626 <span class="comment">% --------------------------------------</span>
2627 <span class="keyword">if</span> ischar(the_file)
2628     guiparams.mat_path = the_path;
2629     guiparams.mat_file = the_file;
2630     guiparams.savefile = the_file;
2631     
2632     <span class="comment">% Re-store the Application data:</span>
2633     <span class="comment">% ------------------------------</span>
2634     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2635     
2636     <span class="comment">% Update the preferences:</span>
2637     <span class="comment">% -----------------------</span>
2638     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2639     guiprefs.mat_path = the_path;
2640     guiprefs.mat_file = the_file;
2641     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2642     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2643     
2644     [~,filename,extension] = fileparts(guiparams.savefile);
2645     savefile = [filename extension];
2646     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2647         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2648     disp(<span class="string">'Saving Processed Data File...'</span>)
2649     disp(savefile)
2650     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2651 <span class="keyword">end</span>
2652 
2653 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2654 
2655 
2656 <span class="comment">% --------------------------------------------------------------------</span>
2657 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2658 
2659 <span class="comment">% Get the Application data:</span>
2660 <span class="comment">% -------------------------</span>
2661 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2662 <span class="comment">% z   = guiparams.z;</span>
2663 <span class="comment">% A   = guiparams.A;</span>
2664 V   = guiparams.V;
2665 <span class="comment">% Map = guiparams.Map;</span>
2666 
2667 [the_file,the_path] = <span class="keyword">...</span>
2668     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2669     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2670     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2671 
2672 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2673 <span class="comment">% ------------------------------------------</span>
2674 <span class="keyword">if</span> ischar(the_file)
2675     guiparams.tecplot_path = the_path;
2676     guiparams.tecplot_file = the_file;
2677     
2678     <span class="comment">% Re-store the Application data:</span>
2679     <span class="comment">% ------------------------------</span>
2680     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2681     
2682     <span class="comment">% Update the preferences:</span>
2683     <span class="comment">% -----------------------</span>
2684     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2685     guiprefs.tecplot_path = the_path;
2686     guiprefs.tecplot_file = the_file;
2687     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2688     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2689     
2690     <span class="comment">% Push to log window</span>
2691     <span class="comment">% ------------------</span>
2692     log_text = {<span class="keyword">...</span>
2693         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2694         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2695         the_path;<span class="keyword">...</span>
2696         [<span class="string">'Filename: '</span> the_file]};
2697     statusLogging(handles.LogWindow,log_text)
2698         
2699     <span class="keyword">if</span> isempty(V)
2700         A = guiparams.A;
2701         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2702         A(1).vgns = guiparams.vertical_grid_node_spacing;
2703         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2704         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2705             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2706             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2707             guiparams.eta);
2708     <span class="keyword">end</span>
2709     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2710     
2711     <span class="comment">% Push to log window</span>
2712     <span class="comment">% ------------------</span>
2713     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2714     statusLogging(handles.LogWindow,log_text)
2715     
2716     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2717     
2718     <span class="comment">% Push to log window</span>
2719     <span class="comment">% ------------------</span>
2720     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2721     statusLogging(handles.LogWindow,log_text)
2722    
2723 <span class="keyword">end</span>
2724 
2725 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2726 
2727 
2728 <span class="comment">% --------------------------------------------------------------------</span>
2729 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2730 
2731 <span class="comment">% Get the Application data:</span>
2732 <span class="comment">% -------------------------</span>
2733 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2734 <span class="comment">% z   = guiparams.z;</span>
2735 A   = guiparams.A;
2736 V   = guiparams.V;
2737 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2738 
2739 [the_file,the_path] = <span class="keyword">...</span>
2740     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2741     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2742     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2743 
2744 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2745 <span class="comment">% -----------------------------------------------------</span>
2746 <span class="keyword">if</span> ischar(the_file)
2747     guiparams.kmz_path = the_path;
2748     guiparams.kmz_file = the_file;
2749     
2750     <span class="comment">% Re-store the Application data:</span>
2751     <span class="comment">% ------------------------------</span>
2752     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2753     
2754     <span class="comment">% Update the preferences:</span>
2755     <span class="comment">% -----------------------</span>
2756     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2757     guiprefs.kmz_path = the_path;
2758     guiprefs.kmz_file = the_file;
2759     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2760     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2761     
2762     <span class="comment">%     if guiparams.display_shoreline</span>
2763     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2764     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2765     <span class="comment">%                             guiparams.vertical_offset);</span>
2766     <span class="comment">%     end</span>
2767     <span class="keyword">if</span> isempty(V)
2768         A = guiparams.A;
2769         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2770         A(1).vgns = guiparams.vertical_grid_node_spacing;
2771         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2772         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2773             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2774             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2775             guiparams.eta);
2776     <span class="keyword">end</span>
2777     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2778         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2779         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2780         guiparams.vertical_offset);
2781 <span class="keyword">end</span>
2782 
2783 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2784 
2785 
2786 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2787 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2788 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2789 
2790 <span class="comment">% --------------------------------------------------------------------</span>
2791 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2792 
2793 <span class="comment">% Get the Application data:</span>
2794 <span class="comment">% -------------------------</span>
2795 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2796 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2797 z = guiparams.z;
2798 A = guiparams.A;
2799 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2800 <span class="comment">% Map = guiparams.Map;</span>
2801 setends = guiparams.set_cross_section_endpoints;
2802 
2803 [the_file,the_path] = <span class="keyword">...</span>
2804     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2805     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2806     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2807     guiprefs.multibeambathymetry_file));
2808 
2809 <span class="keyword">if</span> ischar(the_file)
2810     guiparams.multibeambathymetry_path = the_path;
2811     guiparams.multibeambathymetry_file = the_file;
2812     
2813     <span class="comment">% Re-store the Application data:</span>
2814     <span class="comment">% ------------------------------</span>
2815     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2816     
2817     <span class="comment">% Update the preferences:</span>
2818     <span class="comment">% -----------------------</span>
2819     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2820     guiprefs.multibeambathymetry_path = the_path;
2821     guiprefs.multibeambathymetry_file = the_file;
2822     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2823     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2824     
2825     <span class="keyword">if</span> guiparams.output_auxiliary_data
2826     <span class="keyword">end</span>
2827     
2828     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2829     
2830     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2831         guiparams.multibeambathymetry_file);
2832     
2833     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2834         [<span class="string">'   '</span> savefile]};
2835     statusLogging(handles.LogWindow,log_text)
2836     
2837     <span class="comment">% Process the transects:</span>
2838     <span class="comment">% ----------------------</span>
2839     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2840     A(1).vgns = guiparams.vertical_grid_node_spacing;
2841     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2842     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2843         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2844     
2845     <span class="comment">% Compute the smoothed variables</span>
2846     <span class="comment">% ------------------------------</span>
2847     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2848     <span class="comment">% runtime.</span>
2849     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2850         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2851         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2852         guiparams.vertical_smoothing_window);
2853     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2854     <span class="comment">% Push messages to Log Window:</span>
2855     <span class="comment">% ----------------------------</span>
2856     statusLogging(handles.LogWindow, processing_log_text)
2857 
2858     
2859     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2860         guiparams.A, <span class="keyword">...</span>
2861         savefile, <span class="keyword">...</span>
2862         guiparams.beam_angle, <span class="keyword">...</span>
2863         guiparams.magnetic_variation, <span class="keyword">...</span>
2864         guiparams.wse, <span class="keyword">...</span>
2865         guiparams.output_auxiliary_data);
2866     
2867     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2868     
2869 <span class="keyword">end</span>
2870 
2871 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2872 
2873 
2874 <span class="comment">% --------------------------------------------------------------------</span>
2875 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2876 <span class="comment">% Get the beam angle</span>
2877 
2878 <span class="comment">% Get the Application data:</span>
2879 <span class="comment">% -------------------------</span>
2880 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2881 
2882 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2883 <span class="comment">% ----------------------------------------------------------------</span>
2884 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2885 is_a_number = ~isnan(new_beam_angle);
2886 is_positive = new_beam_angle&gt;=0;
2887 
2888 <span class="comment">% Modify the Application data:</span>
2889 <span class="comment">% ----------------------------</span>
2890 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2891     guiparams.beam_angle = new_beam_angle;
2892     
2893     <span class="comment">% Re-store the Application data:</span>
2894     <span class="comment">% ------------------------------</span>
2895     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2896     
2897 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2898     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2899 <span class="keyword">end</span>
2900 
2901 <span class="comment">% [EOF] BeamAngle_Callback</span>
2902 
2903 
2904 <span class="comment">% --------------------------------------------------------------------</span>
2905 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2906 <span class="comment">% Get the Magnetic Variation</span>
2907 
2908 <span class="comment">% Get the Application data:</span>
2909 <span class="comment">% -------------------------</span>
2910 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2911 
2912 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2913 <span class="comment">% ----------------------------------------------------------------</span>
2914 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2915 is_a_number = ~isnan(new_magnetic_variation);
2916 is_positive = new_magnetic_variation&gt;=0;
2917 
2918 <span class="comment">% Modify the Application data:</span>
2919 <span class="comment">% ----------------------------</span>
2920 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2921     guiparams.magnetic_variation = new_magnetic_variation;
2922     
2923     <span class="comment">% Re-store the Application data:</span>
2924     <span class="comment">% ------------------------------</span>
2925     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2926     
2927 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2928     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2929 <span class="keyword">end</span>
2930 
2931 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2932 
2933 
2934 <span class="comment">% --------------------------------------------------------------------</span>
2935 <a name="_sub68" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2936 
2937 <span class="comment">% Get the Application data:</span>
2938 <span class="comment">% -------------------------</span>
2939 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2940 
2941 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2942 <span class="comment">% ----------------------------------------------------------------</span>
2943 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2944 is_a_number = ~isnan(new_wse);
2945 is_positive = new_wse&gt;=0;
2946 
2947 <span class="comment">% Modify the Application data:</span>
2948 <span class="comment">% ----------------------------</span>
2949 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2950     guiparams.wse = new_wse;
2951     
2952     <span class="comment">% Re-store the Application data:</span>
2953     <span class="comment">% ------------------------------</span>
2954     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2955     
2956 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2957     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2958 <span class="keyword">end</span>
2959 
2960 <span class="comment">% [EOF] WSE_Callback</span>
2961 
2962 
2963 <span class="comment">% --------------------------------------------------------------------</span>
2964 <a name="_sub69" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2965 <span class="comment">% Bathymetry Auxiliary Data</span>
2966 
2967 <span class="comment">% Get the Application data:</span>
2968 <span class="comment">% -------------------------</span>
2969 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2970 
2971 <span class="comment">% Modify the Application data:</span>
2972 <span class="comment">% ----------------------------</span>
2973 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2974 
2975 <span class="comment">% Re-store the Application data:</span>
2976 <span class="comment">% ------------------------------</span>
2977 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2978 
2979 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2980 
2981 
2982 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2983 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2984 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2985 
2986 <span class="comment">% --------------------------------------------------------------------</span>
2987 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2988 
2989 <span class="comment">% Get the Application data:</span>
2990 <span class="comment">% -------------------------</span>
2991 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2992 
2993 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2994 <span class="comment">% ----------------------------------------------------------------</span>
2995 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2996 is_a_number = ~isnan(new_depth_range_min);
2997 is_positive = new_depth_range_min&gt;=0;
2998 
2999 <span class="comment">% Modify the Application data:</span>
3000 <span class="comment">% ----------------------------</span>
3001 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3002     guiparams.depth_range_min = new_depth_range_min;
3003     
3004     <span class="comment">% Re-store the Application data:</span>
3005     <span class="comment">% ------------------------------</span>
3006     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3007     
3008 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3009     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3010 <span class="keyword">end</span>
3011 
3012 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3013 
3014 
3015 <span class="comment">% --------------------------------------------------------------------</span>
3016 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3017 
3018 <span class="comment">% Get the Application data:</span>
3019 <span class="comment">% -------------------------</span>
3020 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3021 
3022 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3023 <span class="comment">% ----------------------------------------------------------------</span>
3024 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3025 is_a_number = ~isnan(new_depth_range_max);
3026 is_positive = new_depth_range_max&gt;=0;
3027 
3028 <span class="comment">% Modify the Application data:</span>
3029 <span class="comment">% ----------------------------</span>
3030 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3031     guiparams.depth_range_max = new_depth_range_max;
3032     
3033     <span class="comment">% Re-store the Application data:</span>
3034     <span class="comment">% ------------------------------</span>
3035     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3036     
3037 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3038     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3039 <span class="keyword">end</span>
3040 
3041 <span class="comment">% [EOF] DepthMax_Callback</span>
3042 
3043 
3044 <span class="comment">% --------------------------------------------------------------------</span>
3045 <a name="_sub72" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3046 <span class="comment">% Set quiver scale (contour)</span>
3047 
3048 <span class="comment">% Get the Application data:</span>
3049 <span class="comment">% -------------------------</span>
3050 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3051 
3052 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3053 <span class="comment">% ----------------------------------------------------------------</span>
3054 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3055 is_a_number = ~isnan(new_vector_scale_plan_view);
3056 is_positive = new_vector_scale_plan_view&gt;=0;
3057 
3058 <span class="comment">% Modify the Application data:</span>
3059 <span class="comment">% ----------------------------</span>
3060 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3061     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
3062     
3063     <span class="comment">% Re-store the Application data:</span>
3064     <span class="comment">% ------------------------------</span>
3065     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3066     
3067 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3068     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3069 <span class="keyword">end</span>
3070 
3071 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3072 
3073 
3074 <span class="comment">% --------------------------------------------------------------------</span>
3075 <a name="_sub73" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3076 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3077 
3078 <span class="comment">% Get the Application data:</span>
3079 <span class="comment">% -------------------------</span>
3080 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3081 
3082 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3083 <span class="comment">% ----------------------------------------------------------------</span>
3084 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3085 is_a_number = ~isnan(new_vector_spacing_plan_view);
3086 is_positive = new_vector_spacing_plan_view&gt;=0;
3087 
3088 <span class="comment">% Modify the Application data:</span>
3089 <span class="comment">% ----------------------------</span>
3090 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3091     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3092     
3093     <span class="comment">% Re-store the Application data:</span>
3094     <span class="comment">% ------------------------------</span>
3095     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3096     
3097 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3098     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3099 <span class="keyword">end</span>
3100 
3101 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3102 
3103 
3104 <span class="comment">% --------------------------------------------------------------------</span>
3105 <a name="_sub74" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3106 <span class="comment">% Plan View smoothing window size</span>
3107 
3108 <span class="comment">% Get the Application data:</span>
3109 <span class="comment">% -------------------------</span>
3110 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3111 
3112 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3113 <span class="comment">% ----------------------------------------------------------------</span>
3114 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3115 is_a_number = ~isnan(new_smoothing_window_size);
3116 is_positive = new_smoothing_window_size&gt;=0;
3117 
3118 <span class="comment">% Modify the Application data:</span>
3119 <span class="comment">% ----------------------------</span>
3120 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3121     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3122     
3123     <span class="comment">% Re-store the Application data:</span>
3124     <span class="comment">% ------------------------------</span>
3125     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3126     
3127 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3128     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3129 <span class="keyword">end</span>
3130 
3131 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3132 
3133 
3134 <span class="comment">% --------------------------------------------------------------------</span>
3135 <a name="_sub75" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3136 
3137 <span class="comment">% Get the Application data:</span>
3138 <span class="comment">% -------------------------</span>
3139 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3140 
3141 <span class="comment">% Modify the Application data:</span>
3142 <span class="comment">% ----------------------------</span>
3143 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3144 
3145 <span class="comment">% Re-store the Application data:</span>
3146 <span class="comment">% ------------------------------</span>
3147 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3148 
3149 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3150 
3151 
3152 <span class="comment">% --------------------------------------------------------------------</span>
3153 <a name="_sub76" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3154 
3155 <span class="comment">% Get the Application data:</span>
3156 <span class="comment">% -------------------------</span>
3157 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3158 
3159 <span class="comment">% Modify the Application data:</span>
3160 <span class="comment">% ----------------------------</span>
3161 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3162 
3163 <span class="comment">% Re-store the Application data:</span>
3164 <span class="comment">% ------------------------------</span>
3165 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3166 
3167 <span class="comment">% [EOF] AddBackground_Callback</span>
3168 
3169 
3170 <span class="comment">% --------------------------------------------------------------------</span>
3171 <a name="_sub77" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3172 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3173 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3174 
3175 
3176 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3177 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3178 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3179 
3180 <span class="comment">% --------------------------------------------------------------------</span>
3181 <a name="_sub78" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3182 <span class="comment">% Set the horizontal grid node spacing</span>
3183 
3184 <span class="comment">% Get the Application data:</span>
3185 <span class="comment">% -------------------------</span>
3186 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3187 
3188 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3189 <span class="comment">% ----------------------------------------------------------------</span>
3190 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3191 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3192 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3193 
3194 <span class="comment">% Modify the Application data:</span>
3195 <span class="comment">% ----------------------------</span>
3196 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3197     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3198     
3199     <span class="comment">% Re-store the Application data:</span>
3200     <span class="comment">% ------------------------------</span>
3201     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3202     
3203 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3204     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3205 <span class="keyword">end</span>
3206 
3207 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3208 
3209 <span class="comment">% --------------------------------------------------------------------</span>
3210 <a name="_sub79" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3211 <span class="comment">% Set the horizontal grid node spacing</span>
3212 
3213 <span class="comment">% Get the Application data:</span>
3214 <span class="comment">% -------------------------</span>
3215 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3216 
3217 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3218 <span class="comment">% ----------------------------------------------------------------</span>
3219 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3220 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3221 is_positive = new_vertical_grid_node_spacing&gt;=0;
3222 
3223 <span class="comment">% Modify the Application data:</span>
3224 <span class="comment">% ----------------------------</span>
3225 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3226     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3227     
3228     <span class="comment">% Re-store the Application data:</span>
3229     <span class="comment">% ------------------------------</span>
3230     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3231     
3232 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3233     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3234 <span class="keyword">end</span>
3235 
3236 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3237 
3238 <span class="comment">% --------------------------------------------------------------------</span>
3239 <a name="_sub80" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3240 <span class="comment">% Set the cross section endpoints manually</span>
3241 
3242 <span class="comment">% Get the Application data:</span>
3243 <span class="comment">% -------------------------</span>
3244 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3245 
3246 <span class="comment">% Modify the Application data:</span>
3247 <span class="comment">% ----------------------------</span>
3248 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3249 
3250 <span class="comment">% Re-store the Application data:</span>
3251 <span class="comment">% ------------------------------</span>
3252 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3253 
3254 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3255 
3256 
3257 <span class="comment">% --------------------------------------------------------------------</span>
3258 <a name="_sub81" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3259 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3260 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3261 
3262 
3263 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3264 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3265 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3266 
3267 <span class="comment">% --------------------------------------------------------------------</span>
3268 <a name="_sub82" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3269 
3270 <span class="comment">% Get the Application data:</span>
3271 <span class="comment">% -------------------------</span>
3272 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3273 
3274 <span class="comment">% Modify the Application data:</span>
3275 <span class="comment">% ----------------------------</span>
3276 idx_variable = get(hObject,<span class="string">'Value'</span>);
3277 guiparams.idx_contour = idx_variable;
3278 guiparams.contour = guiparams.contours(idx_variable).variable;
3279 
3280 <span class="comment">% Re-store the Application data:</span>
3281 <span class="comment">% ------------------------------</span>
3282 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3283 
3284 <span class="comment">% [EOF] Contour_Callback</span>
3285 
3286 
3287 <span class="comment">% --------------------------------------------------------------------</span>
3288 <a name="_sub83" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3289 <span class="comment">% Set vertical exaggeration</span>
3290 
3291 <span class="comment">% Get the Application data:</span>
3292 <span class="comment">% -------------------------</span>
3293 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3294 
3295 <span class="comment">% Modify the Application data:</span>
3296 <span class="comment">% ----------------------------</span>
3297 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3298 
3299 <span class="comment">% Re-store the Application data:</span>
3300 <span class="comment">% ------------------------------</span>
3301 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3302 
3303 <span class="comment">% Update the GUI:</span>
3304 <span class="comment">% ---------------</span>
3305 <span class="comment">% updateGUI(handles,guiparams)</span>
3306 
3307 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3308 
3309 
3310 <span class="comment">% --------------------------------------------------------------------</span>
3311 <a name="_sub84" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3312 
3313 <span class="comment">% Get the Application data:</span>
3314 <span class="comment">% -------------------------</span>
3315 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3316 
3317 <span class="comment">% Modify the Application data:</span>
3318 <span class="comment">% ----------------------------</span>
3319 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3320 
3321 <span class="comment">% Re-store the Application data:</span>
3322 <span class="comment">% ------------------------------</span>
3323 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3324 
3325 <span class="comment">% Update the GUI:</span>
3326 <span class="comment">% ---------------</span>
3327 <span class="comment">% updateGUI(handles,guiparams)</span>
3328 
3329 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3330 
3331 
3332 <span class="comment">% --------------------------------------------------------------------</span>
3333 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3334 
3335 <span class="comment">% Get the Application data:</span>
3336 <span class="comment">% -------------------------</span>
3337 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3338 
3339 <span class="comment">% Modify the Application data:</span>
3340 <span class="comment">% ----------------------------</span>
3341 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3342 
3343 <span class="comment">% Re-store the Application data:</span>
3344 <span class="comment">% ------------------------------</span>
3345 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3346 
3347 <span class="comment">% Update the GUI:</span>
3348 <span class="comment">% ---------------</span>
3349 <span class="comment">% updateGUI(handles,guiparams)</span>
3350 
3351 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3352 
3353 
3354 <span class="comment">% --------------------------------------------------------------------</span>
3355 <a name="_sub86" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3356 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3357 
3358 <span class="comment">% Get the Application data:</span>
3359 <span class="comment">% -------------------------</span>
3360 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3361 
3362 <span class="comment">% Modify the Application data:</span>
3363 <span class="comment">% ----------------------------</span>
3364 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3365 
3366 <span class="comment">% Re-store the Application data:</span>
3367 <span class="comment">% ------------------------------</span>
3368 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3369 
3370 <span class="comment">% Update the GUI:</span>
3371 <span class="comment">% ---------------</span>
3372 <span class="comment">% updateGUI(handles,guiparams)</span>
3373 
3374 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3375 
3376 
3377 <span class="comment">% --------------------------------------------------------------------</span>
3378 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3379 <span class="comment">% Horizontal Smoothing</span>
3380 
3381 <span class="comment">% Get the Application data:</span>
3382 <span class="comment">% -------------------------</span>
3383 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3384 
3385 <span class="comment">% Modify the Application data:</span>
3386 <span class="comment">% ----------------------------</span>
3387 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3388 
3389 <span class="comment">% Re-store the Application data:</span>
3390 <span class="comment">% ------------------------------</span>
3391 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3392 
3393 <span class="comment">% Update the GUI:</span>
3394 <span class="comment">% ---------------</span>
3395 <span class="comment">% updateGUI(handles,guiparams)</span>
3396 
3397 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3398 
3399 
3400 <span class="comment">% --------------------------------------------------------------------</span>
3401 <a name="_sub88" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3402 <span class="comment">% Vertical Smoothing</span>
3403 
3404 <span class="comment">% Get the Application data:</span>
3405 <span class="comment">% -------------------------</span>
3406 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3407 
3408 <span class="comment">% Modify the Application data:</span>
3409 <span class="comment">% ----------------------------</span>
3410 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3411 
3412 <span class="comment">% Re-store the Application data:</span>
3413 <span class="comment">% ------------------------------</span>
3414 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3415 
3416 <span class="comment">% Update the GUI:</span>
3417 <span class="comment">% ---------------</span>
3418 <span class="comment">% updateGUI(handles,guiparams)</span>
3419 
3420 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3421 
3422 
3423 <span class="comment">% --------------------------------------------------------------------</span>
3424 <a name="_sub89" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3425 
3426 <span class="comment">% Get the Application data:</span>
3427 <span class="comment">% -------------------------</span>
3428 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3429 
3430 <span class="comment">% Modify the Application data:</span>
3431 <span class="comment">% ----------------------------</span>
3432 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3433 
3434 <span class="comment">% Re-store the Application data:</span>
3435 <span class="comment">% ------------------------------</span>
3436 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3437 
3438 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3439 
3440 
3441 <span class="comment">% --------------------------------------------------------------------</span>
3442 <a name="_sub90" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3443 
3444 <span class="comment">% Get the Application data:</span>
3445 <span class="comment">% -------------------------</span>
3446 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3447 
3448 <span class="comment">% Modify the Application data:</span>
3449 <span class="comment">% ----------------------------</span>
3450 idx_variable = get(hObject,<span class="string">'Value'</span>);
3451 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3452 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3453 
3454 <span class="comment">% Re-store the Application data:</span>
3455 <span class="comment">% ------------------------------</span>
3456 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3457 
3458 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3459 
3460 
3461 <span class="comment">% --------------------------------------------------------------------</span>
3462 <a name="_sub91" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3463 
3464 <span class="comment">% Get the Application data:</span>
3465 <span class="comment">% -------------------------</span>
3466 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3467 
3468 <span class="comment">% Modify the Application data:</span>
3469 <span class="comment">% ----------------------------</span>
3470 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3471 
3472 <span class="comment">% Re-store the Application data:</span>
3473 <span class="comment">% ------------------------------</span>
3474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3475 
3476 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3477 
3478 
3479 <span class="comment">% --------------------------------------------------------------------</span>
3480 <a name="_sub92" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3481 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3482 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3483 
3484 
3485 <span class="comment">% --------------------------------------------------------------------</span>
3486 <a name="_sub93" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3487 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3488 <span class="comment">% [EOF] ClearLog_Callback</span>
3489 
3490 <span class="comment">% --------------------------------------------------------------------</span>
3491 <a name="_sub94" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3492 
3493 <span class="comment">% Get the Application data:</span>
3494 <span class="comment">% -------------------------</span>
3495 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3496 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3497 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3498 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3499 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3500 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3501 
3502 [the_file,the_path] = <span class="keyword">...</span>
3503     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3504     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3505     fullfile(guiprefs.log_path,guiprefs.log_file));
3506 
3507 <span class="comment">% Save the log to a TXT file:</span>
3508 <span class="comment">% ---------------------------</span>
3509 <span class="keyword">if</span> ischar(the_file)
3510     guiparams.log_path = the_path;
3511     guiparams.log_file = the_file;
3512     <span class="comment">%guiparams.savefile = the_file;</span>
3513     
3514     <span class="comment">% Re-store the Application data:</span>
3515     <span class="comment">% ------------------------------</span>
3516     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3517     
3518     <span class="comment">% Update the preferences:</span>
3519     <span class="comment">% -----------------------</span>
3520     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3521     guiprefs.log_path = the_path;
3522     guiprefs.log_file = the_file;
3523     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3524     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3525     
3526     [~,filename,extension] = fileparts(the_file);
3527     savefile = [the_path filename extension];
3528     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3529         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3530     
3531     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3532     [nrows,~]= size(logfile);
3533     fid = fopen(savefile, <span class="string">'w'</span>);
3534     <span class="keyword">for</span> row=1:nrows
3535         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3536     <span class="keyword">end</span>
3537     fclose(fid);
3538 <span class="keyword">end</span>
3539 <span class="comment">% [EOF] SaveLog_Callback</span>
3540 
3541 <span class="comment">%%%%%%%%%%%%%%%%</span>
3542 <span class="comment">% SUBFUNCTIONS %</span>
3543 <span class="comment">%%%%%%%%%%%%%%%%</span>
3544 
3545 <span class="comment">% --------------------------------------------------------------------</span>
3546 <a name="_sub95" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3547 
3548 icons = <a href="#_sub111" class="code" title="subfunction icons = getIcons">getIcons</a>;
3549 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3550 
3551 <span class="comment">% Load data</span>
3552 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3553 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3554 <span class="comment">% icon(icon==0) = NaN;</span>
3555 handles.toolbarLoadData = <span class="keyword">...</span>
3556     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3557     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3558     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3559 
3560 <span class="comment">% Save data</span>
3561 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3562 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3563 <span class="comment">% icon(icon==0) = NaN;</span>
3564 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3565     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3566     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3567     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3568     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3569 
3570 
3571 <span class="comment">% Save bathymetry</span>
3572 <span class="comment">%icon = ones(16,16,3);</span>
3573 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3574     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3575     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3576     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3577 
3578 <span class="comment">% Save figures</span>
3579 <span class="comment">% icon = ones(16,16,3);</span>
3580 handles.toolbarSaveFigures = <span class="keyword">...</span>
3581     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3582     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3583     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3584 
3585 <span class="comment">% Save Excel File</span>
3586 <span class="comment">% icon = ones(16,16,3);</span>
3587 handles.toolbarSaveExcel = <span class="keyword">...</span>
3588     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3589     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3590     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3591 
3592 
3593 <span class="comment">% Plotting parameters</span>
3594 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3595 <span class="comment">% icon = ind2rgb(icon,map);</span>
3596 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3597     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3598     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3599     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3600     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3601 
3602 <span class="comment">% Processing parameters</span>
3603 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3604 <span class="comment">% icon = ind2rgb(icon,map);</span>
3605 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3606     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3607     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3608     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3609 
3610 <span class="comment">% Zoom In</span>
3611 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3612 <span class="comment">% icon = ind2rgb(icon,map);</span>
3613 <span class="comment">% handles.toolbarZoomIn = ...</span>
3614 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3615 <span class="comment">%     'CData',        icons(8).data, ...</span>
3616 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3617 <span class="comment">%     'Separator',     'on');</span>
3618 
3619 <span class="comment">% Zoom Out</span>
3620 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3621 <span class="comment">% icon = ind2rgb(icon,map);</span>
3622 <span class="comment">% handles.toolbarZoomOut = ...</span>
3623 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3624 <span class="comment">%     'CData',        icons(9).data, ...</span>
3625 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3626 
3627 <span class="comment">% Pan</span>
3628 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3629 <span class="comment">% icon = ind2rgb(icon,map);</span>
3630 <span class="comment">% handles.toolbarPan = ...</span>
3631 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3632 <span class="comment">%     'CData',        icons(10).data, ...</span>
3633 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3634 
3635 
3636 
3637 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3638 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3639 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3640 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3641 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3642 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3643 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3644 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3645 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3646 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3647 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3648 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3649 
3650 <span class="comment">% [EOF] buildtoolbar</span>
3651 
3652 
3653 <span class="comment">% --------------------------------------------------------------------</span>
3654 <a name="_sub96" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3655 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3656 <span class="comment">% already exist.</span>
3657 
3658 <span class="comment">% Preferences:</span>
3659 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3660 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3661 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3662 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3663 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3664 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3665 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3666 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3667 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3668 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3669 <span class="comment">% 'renderer'             Default graphics renderer</span>
3670 <span class="comment">% 'units'                Default plotting units</span>
3671 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3672 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3673 <span class="comment">%                        started</span>
3674 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3675 
3676 <span class="comment">% Originals</span>
3677 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3678 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3679 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3680 
3681 <span class="comment">% ASCII</span>
3682 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3683     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3684     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3685         guiprefs.ascii_path = ascii.path;
3686     <span class="keyword">else</span>
3687         guiprefs.ascii_path = pwd;
3688     <span class="keyword">end</span>
3689     does_exist = false(1,length(ascii.file));
3690     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3691         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3692     <span class="keyword">end</span>
3693     <span class="keyword">if</span> any(does_exist)
3694         guiprefs.ascii_file = ascii.file(does_exist);
3695     <span class="keyword">else</span>
3696         guiprefs.ascii_file = {<span class="string">''</span>};
3697     <span class="keyword">end</span>
3698 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3699     guiprefs.ascii_path = pwd;
3700     guiprefs.ascii_file = {<span class="string">''</span>};
3701     
3702     ascii.path = pwd;
3703     ascii.file = {<span class="string">''</span>};
3704     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3705 <span class="keyword">end</span>
3706 
3707 <span class="comment">% MAT</span>
3708 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3709     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3710     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3711         guiprefs.mat_path = mat.path;
3712     <span class="keyword">else</span>
3713         guiprefs.mat_path = pwd;
3714     <span class="keyword">end</span>
3715     
3716     <span class="keyword">if</span> iscell(mat.file)
3717         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3718             guiprefs.mat_file = mat.file;
3719         <span class="keyword">else</span>
3720             guiprefs.mat_file = <span class="string">''</span>;
3721         <span class="keyword">end</span>
3722     <span class="keyword">else</span>
3723         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3724             guiprefs.mat_file = mat.file;
3725         <span class="keyword">else</span>
3726             guiprefs.mat_file = <span class="string">''</span>;
3727         <span class="keyword">end</span>
3728     <span class="keyword">end</span>
3729 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3730     guiprefs.mat_path = pwd;
3731     guiprefs.mat_file = <span class="string">''</span>;
3732     
3733     mat.path = pwd;
3734     mat.file = <span class="string">''</span>;
3735     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3736 <span class="keyword">end</span>
3737 
3738 <span class="comment">% TECPLOT</span>
3739 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3740     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3741     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3742         guiprefs.tecplot_path = tecplot.path;
3743     <span class="keyword">else</span>
3744         guiprefs.tecplot_path = pwd;
3745     <span class="keyword">end</span>
3746     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3747         guiprefs.tecplot_file = tecplot.file;
3748     <span class="keyword">else</span>
3749         guiprefs.tecplot_file = <span class="string">''</span>;
3750     <span class="keyword">end</span>
3751 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3752     guiprefs.tecplot_path = pwd;
3753     guiprefs.tecplot_file = <span class="string">''</span>;
3754     
3755     tecplot.path = pwd;
3756     tecplot.file = <span class="string">''</span>;
3757     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3758 <span class="keyword">end</span>
3759 
3760 <span class="comment">% KMZ</span>
3761 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3762     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3763     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3764         guiprefs.kmz_path = kmz.path;
3765     <span class="keyword">else</span>
3766         guiprefs.kmz_path = pwd;
3767     <span class="keyword">end</span>
3768     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3769         guiprefs.kmz_file = kmz.file;
3770     <span class="keyword">else</span>
3771         guiprefs.kmz_file = <span class="string">''</span>;
3772     <span class="keyword">end</span>
3773 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3774     guiprefs.kmz_path = pwd;
3775     guiprefs.kmz_file = <span class="string">''</span>;
3776     
3777     kmz.path = pwd;
3778     kmz.file = <span class="string">''</span>;
3779     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3780 <span class="keyword">end</span>
3781 
3782 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3783 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3784     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3785     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3786         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3787     <span class="keyword">else</span>
3788         guiprefs.multibeambathymetry_path = pwd;
3789     <span class="keyword">end</span>
3790     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3791         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3792     <span class="keyword">else</span>
3793         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3794     <span class="keyword">end</span>
3795 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3796     guiprefs.multibeambathymetry_path = pwd;
3797     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3798     
3799     multibeambathymetry.path = pwd;
3800     multibeambathymetry.file = <span class="string">''</span>;
3801     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3802 <span class="keyword">end</span>
3803 
3804 <span class="comment">% Log</span>
3805 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3806     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3807     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3808         guiprefs.log_path = log.path;
3809     <span class="keyword">else</span>
3810         guiprefs.log_path = pwd;
3811     <span class="keyword">end</span>
3812     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3813         guiprefs.log_file = log.file;
3814     <span class="keyword">else</span>
3815         guiprefs.log_file = <span class="string">''</span>;
3816     <span class="keyword">end</span>
3817 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3818     guiprefs.log_path = pwd;
3819     guiprefs.log_file = <span class="string">''</span>;
3820     
3821     log.path = pwd;
3822     log.file = <span class="string">''</span>;
3823     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3824 <span class="keyword">end</span>
3825 
3826 <span class="comment">% iRic</span>
3827 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3828     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3829     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3830         guiprefs.iric_path = iric.path;
3831     <span class="keyword">else</span>
3832         guiprefs.iric_path = pwd;
3833     <span class="keyword">end</span>
3834     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3835         guiprefs.iric_file = iric.file;
3836     <span class="keyword">else</span>
3837         guiprefs.iric_file = <span class="string">''</span>;
3838     <span class="keyword">end</span>
3839 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3840     guiprefs.iric_path = pwd;
3841     guiprefs.iric_file = <span class="string">''</span>;
3842     
3843     iric.path = pwd;
3844     iric.file = <span class="string">''</span>;
3845     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3846 <span class="keyword">end</span>
3847 
3848 <span class="comment">% excel</span>
3849 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3850     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3851     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3852         guiprefs.excel_path = excel.path;
3853     <span class="keyword">else</span>
3854         guiprefs.excel_path = pwd;
3855     <span class="keyword">end</span>
3856     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3857         guiprefs.excel_file = excel.file;
3858     <span class="keyword">else</span>
3859         guiprefs.excel_file = <span class="string">''</span>;
3860     <span class="keyword">end</span>
3861 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3862     guiprefs.excel_path = pwd;
3863     guiprefs.excel_file = <span class="string">''</span>;
3864     
3865     excel.path = pwd;
3866     excel.file = <span class="string">''</span>;
3867     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3868 <span class="keyword">end</span>
3869 
3870 <span class="comment">% aerial</span>
3871 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3872     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3873     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3874         guiprefs.aerial_path = aerial.path;
3875     <span class="keyword">else</span>
3876         guiprefs.aerial_path = pwd;
3877     <span class="keyword">end</span>
3878     does_exist = false(1,length(aerial.file));
3879     <span class="keyword">if</span> iscell(aerial.file)
3880     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3881         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3882     <span class="keyword">end</span>
3883     <span class="keyword">else</span>
3884         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3885     <span class="keyword">end</span>
3886     <span class="keyword">if</span> any(does_exist)
3887         guiprefs.aerial_file = aerial.file;
3888     <span class="keyword">else</span>
3889         guiprefs.aerial_file = {<span class="string">''</span>};
3890     <span class="keyword">end</span>
3891 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3892     guiprefs.aerial_path = pwd;
3893     guiprefs.aerial_file = {<span class="string">''</span>};
3894     
3895     aerial.path = pwd;
3896     aerial.file = {<span class="string">''</span>};
3897     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3898 <span class="keyword">end</span>
3899 
3900 <span class="comment">% shoreline</span>
3901 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3902     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3903     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3904         guiprefs.shoreline_path = shoreline.path;
3905     <span class="keyword">else</span>
3906         guiprefs.shoreline_path = pwd;
3907     <span class="keyword">end</span>
3908     
3909     <span class="keyword">if</span> iscell(shoreline.file)
3910         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3911             guiprefs.shoreline_file = shoreline.file;
3912         <span class="keyword">else</span>
3913             guiprefs.shoreline_file = <span class="string">''</span>;
3914         <span class="keyword">end</span>
3915     <span class="keyword">else</span>
3916         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3917             guiprefs.shoreline_file = shoreline.file;
3918         <span class="keyword">else</span>
3919             guiprefs.shoreline_file = <span class="string">''</span>;
3920         <span class="keyword">end</span>
3921     <span class="keyword">end</span>
3922 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3923     guiprefs.shoreline_path = pwd;
3924     guiprefs.shoreline_file = <span class="string">''</span>;
3925     
3926     shoreline.path = pwd;
3927     shoreline.file = <span class="string">''</span>;
3928     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3929 <span class="keyword">end</span>
3930 <span class="comment">% guiprefs.presentation = true;</span>
3931 <span class="comment">% guiprefs.print        = false;</span>
3932 
3933 <span class="comment">% for k = 1:length(prefs)</span>
3934 <span class="comment">%     newpref = '';</span>
3935 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3936 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3937 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3938 <span class="comment">%             newpref = stored_newpref;</span>
3939 <span class="comment">%         else</span>
3940 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3941 <span class="comment">%         end</span>
3942 <span class="comment">%     end</span>
3943 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3944 <span class="comment">% end</span>
3945 
3946 <span class="comment">% RENDERER</span>
3947 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3948     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3949     guiprefs.renderer = renderer;
3950 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3951     renderer           = <span class="string">'OpenGL'</span>;
3952     guiprefs.renderer  = renderer;
3953     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3954 <span class="keyword">end</span>
3955 
3956 <span class="comment">% UNITS</span>
3957 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3958     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3959     guiprefs.units = units;
3960 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
3961     units           = <span class="string">'metric'</span>;
3962     guiprefs.units  = units;
3963     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3964 <span class="keyword">end</span>
3965 
3966 <span class="comment">% PLOTREF</span>
3967 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
3968     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
3969     guiprefs.plotref = plotref;
3970 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
3971     plotref           = <span class="string">'dfs'</span>;
3972     guiprefs.plotref  = plotref;
3973     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
3974 <span class="keyword">end</span>
3975 
3976 <span class="comment">% RUNCOUNTER</span>
3977 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3978     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3979     guiprefs.runcounter = runcounter;
3980 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3981     runcounter           = 1;
3982     guiprefs.runcounter  = runcounter;
3983     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3984 <span class="keyword">end</span>
3985 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3986 
3987 <span class="comment">% SETENDPOINTS</span>
3988 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
3989     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
3990     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
3991         guiprefs.setendpoints_path = setendpoints.path;
3992     <span class="keyword">else</span>
3993         guiprefs.setendpoints_path = pwd;
3994     <span class="keyword">end</span>
3995     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
3996         guiprefs.setendpoints_file = setendpoints.file;
3997     <span class="keyword">else</span>
3998         guiprefs.setendpoints_file = <span class="string">''</span>;
3999     <span class="keyword">end</span>
4000 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4001     guiprefs.setendpoints_path = pwd;
4002     guiprefs.setendpoints_file = <span class="string">''</span>;
4003     
4004     setendpoints.path = pwd;
4005     setendpoints.file = <span class="string">''</span>;
4006     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4007 <span class="keyword">end</span>
4008 
4009 <span class="comment">% [EOF] load_prefs</span>
4010 
4011 
4012 <span class="comment">% --------------------------------------------------------------------</span>
4013 <a name="_sub97" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4014 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4015 <span class="comment">% preferences data.</span>
4016 
4017 <span class="comment">% Preferences:</span>
4018 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4019 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4020 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4021 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4022 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4023 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4024 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4025 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4026 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4027 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4028 <span class="comment">% 'renderer'             Default graphics renderer</span>
4029 <span class="comment">% 'units'                Default plotting units</span>
4030 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4031 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4032 <span class="comment">%                        started</span>
4033 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4034 
4035 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4036 
4037 <span class="keyword">switch</span> pref
4038     <span class="keyword">case</span> <span class="string">'ascii'</span>
4039         ascii.path = guiprefs.ascii_path;
4040         ascii.file = guiprefs.ascii_file;
4041         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4042     <span class="keyword">case</span> <span class="string">'mat'</span>
4043         mat.path = guiprefs.mat_path;
4044         mat.file = guiprefs.mat_file;
4045         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4046     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4047         tecplot.path = guiprefs.tecplot_path;
4048         tecplot.file = guiprefs.tecplot_file;
4049         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4050     <span class="keyword">case</span> <span class="string">'kmz'</span>
4051         kmz.path = guiprefs.kmz_path;
4052         kmz.file = guiprefs.kmz_file;
4053         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4054     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4055         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4056         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4057         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4058     <span class="keyword">case</span> <span class="string">'log'</span>
4059         log.path = guiprefs.log_path;
4060         log.file = guiprefs.log_file;
4061         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4062     <span class="keyword">case</span> <span class="string">'iric'</span>
4063         iric.path = guiprefs.iric_path;
4064         iric.file = guiprefs.iric_file;
4065         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4066     <span class="keyword">case</span> <span class="string">'excel'</span>
4067         excel.path = guiprefs.excel_path;
4068         excel.file = guiprefs.excel_file;
4069         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4070     <span class="keyword">case</span> <span class="string">'aerial'</span>
4071         aerial.path = guiprefs.aerial_path;
4072         aerial.file = guiprefs.aerial_file;
4073         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4074     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4075         shoreline.path = guiprefs.shoreline_path;
4076         shoreline.file = guiprefs.shoreline_file;
4077         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4078     <span class="keyword">case</span> <span class="string">'renderer'</span>
4079         renderer = guiprefs.renderer;
4080         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4081     <span class="keyword">case</span> <span class="string">'units'</span>
4082         units = guiprefs.units;
4083         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4084     <span class="keyword">case</span> <span class="string">'plotref'</span>
4085         plotref = guiprefs.plotref;
4086         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4087     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4088         runcounter = guiprefs.runcounter;
4089         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4090     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4091         setendpoints.path = guiprefs.setendpoints_path;
4092         setendpoints.file = guiprefs.setendpoints_file;
4093         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4094     <span class="keyword">otherwise</span>
4095 <span class="keyword">end</span>
4096 
4097 <span class="comment">% if ismember(pref,prefs)</span>
4098 <span class="comment">%     setpref('VMT',pref,value)</span>
4099 <span class="comment">%</span>
4100 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4101 <span class="comment">%     guiprefs.(pref) = value;</span>
4102 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4103 <span class="comment">% end</span>
4104 
4105 <span class="comment">% [EOF] store_prefs</span>
4106 
4107 
4108 <span class="comment">% --------------------------------------------------------------------</span>
4109 <a name="_sub98" href="#_subfunctions" class="code">function initGUI(handles)</a>
4110 <span class="comment">% Initialize the UI controls in the GUI.</span>
4111 
4112 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4113 
4114 <span class="comment">% Set the name and version</span>
4115 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4116     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4117 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4118 
4119 <span class="comment">% Set the PLOT 1 axis labels</span>
4120 axes(handles.Plot1Shiptracks);
4121 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4122 xlabel(<span class="string">'UTM Easting (m)'</span>)
4123 ylabel(<span class="string">'UTM Northing (m)'</span>)
4124 box on
4125 grid on
4126 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4127 
4128 <span class="comment">%%%%%%%%%%%%</span>
4129 <span class="comment">% MENU BAR %</span>
4130 <span class="comment">%%%%%%%%%%%%</span>
4131 <span class="keyword">if</span> guiparams.english_units
4132     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4133     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4134 <span class="keyword">else</span>
4135     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4136     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4137 <span class="keyword">end</span>
4138 
4139 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4140     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4141     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4142 <span class="keyword">else</span>
4143     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4144     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4145 <span class="keyword">end</span>
4146 
4147 
4148 <span class="keyword">if</span> guiparams.print
4149     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4150     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4151     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4152     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4153 <span class="keyword">elseif</span> guiparams.presentation
4154     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4155     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4156     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4157     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4158 <span class="keyword">else</span>
4159 <span class="keyword">end</span>
4160 
4161 <span class="keyword">switch</span> guiparams.renderer
4162     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4163         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4164         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4165         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4166     <span class="keyword">case</span> <span class="string">'painters'</span>
4167         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4168         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4169         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4170     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4171         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4172         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4173         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4174 <span class="keyword">end</span>
4175 
4176 
4177 <span class="comment">%%%%%%%%%%%%%%%</span>
4178 <span class="comment">% DATA EXPORT %</span>
4179 <span class="comment">%%%%%%%%%%%%%%%</span>
4180 <span class="comment">% BathymetryPanel</span>
4181 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4182 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4183 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4184 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4185 
4186 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4187 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4188 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4189 <span class="comment">% PlanViewPanel</span>
4190 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4191 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4192 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4193 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4194 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4195 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4196 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4197 
4198 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4199 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4200 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4201 <span class="comment">% ShiptracksPanel</span>
4202 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4203 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4204 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4205 
4206 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4207 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4208 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4209 <span class="comment">% CrossSectionsPanel</span>
4210 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4211     <span class="string">'Value'</span>, guiparams.idx_contour)
4212 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4213 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4214 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4215 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4216 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4217 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4218 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4219 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4220     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4221 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4222 
4223 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4224 
4225 <span class="comment">% [EOF] initGUI</span>
4226 
4227 
4228 <span class="comment">% --------------------------------------------------------------------</span>
4229 <a name="_sub99" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4230 
4231 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4232 
4233 <span class="keyword">switch</span> enable_state
4234     <span class="keyword">case</span> <span class="string">'init'</span>
4235         guiparams.gui_state = <span class="string">'init'</span>;
4236         set([handles.menuFile
4237             handles.menuOpen
4238             handles.menuOpenASCII
4239             handles.menuOpenMAT
4240             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4241         
4242         set([handles.toolbarLoadData
4243             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4244         set([handles.toolbarSaveMatFile
4245             handles.toolbarSaveBathymetry
4246             handles.toolbarSaveFigures
4247             handles.toolbarSaveExcel
4248             handles.toolbarPlottingParameters
4249             handles.toolbarProcessingParameters
4250             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4251         
4252         set([handles.DepthRangeMin
4253             handles.DepthRangeMax
4254             handles.VectorScalePlanView
4255             handles.VectorSpacingPlanview
4256             handles.SmoothingWindowSize
4257             handles.DisplayShoreline
4258             handles.AddBackground
4259             handles.PlotPlanView
4260             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4261         
4262         set([handles.HorizontalGridNodeSpacing
4263             handles.VerticalGridNodeSpacing
4264             handles.PlotShiptracks
4265             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4266         
4267         set([handles.Contour
4268             handles.VerticalExaggeration
4269             handles.VectorScaleCrossSection
4270             handles.HorizontalVectorSpacing
4271             handles.VerticalVectorSpacing
4272             handles.HorizontalSmoothingWindow
4273             handles.VerticalSmoothingWindow
4274             handles.PlotSecondaryFlowVectors
4275             handles.SecondaryFlowVectorVariable
4276             handles.IncludeVerticalVelocity
4277             handles.PlotCrossSection
4278             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4279         
4280     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4281         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4282         set([handles.menuFile
4283             handles.menuOpen
4284             handles.menuOpenASCII
4285             handles.menuOpenMAT
4286             handles.menuSaveMAT
4287             handles.menuSaveTecplot
4288             handles.menuSaveKMZFile
4289             handles.menuParameters
4290             handles.menuPlottingParameters
4291             handles.menuMetric
4292             handles.menuEnglish
4293             handles.menuBathymetryExportSettings
4294             handles.menuExportMultibeamBathymetry
4295             handles.menuKMZVerticalOffset
4296             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4297         
4298         set([handles.toolbarLoadData
4299             handles.toolbarSaveMatFile
4300             handles.toolbarSaveBathymetry
4301             handles.toolbarSaveExcel
4302             handles.toolbarSaveFigures
4303             handles.toolbarPlottingParameters
4304             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4305         set([handles.toolbarProcessingParameters
4306             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4307         
4308            
4309         set([handles.DepthRangeMin
4310             handles.DepthRangeMax
4311             handles.VectorScalePlanView
4312             handles.VectorSpacingPlanview
4313             handles.SmoothingWindowSize
4314             handles.DisplayShoreline
4315             handles.PlotPlanView
4316             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4317         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4318             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4319         <span class="keyword">else</span>
4320             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4321         <span class="keyword">end</span>
4322         
4323         set([handles.HorizontalGridNodeSpacing
4324             handles.VerticalGridNodeSpacing
4325             handles.PlotShiptracks
4326             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4327         
4328         set([handles.Contour
4329             handles.VerticalExaggeration
4330             handles.VectorScaleCrossSection
4331             handles.HorizontalVectorSpacing
4332             handles.VerticalVectorSpacing
4333             handles.HorizontalSmoothingWindow
4334             handles.VerticalSmoothingWindow
4335             handles.PlotSecondaryFlowVectors
4336             handles.SecondaryFlowVectorVariable
4337             handles.IncludeVerticalVelocity
4338             handles.PlotCrossSection
4339             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4340     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4341         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4342         set([handles.menuFile
4343             handles.menuOpen
4344             handles.menuOpenASCII
4345             handles.menuOpenMAT
4346             handles.menuParameters
4347             handles.menuPlottingParameters
4348             handles.menuMetric
4349             handles.menuEnglish
4350             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4351         set([handles.menuSaveMAT
4352             handles.menuBathymetryExportSettings
4353             handles.menuExportMultibeamBathymetry
4354             handles.menuKMZVerticalOffset
4355             handles.menuSaveKMZFile
4356             handles.menuSaveTecplot
4357             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4358         
4359         set([handles.toolbarLoadData
4360             handles.toolbarSaveFigures
4361             handles.toolbarPlottingParameters
4362             handles.toolbarSaveExcel
4363             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4364         set([handles.toolbarProcessingParameters
4365             handles.toolbarSaveMatFile
4366             handles.toolbarSaveBathymetry
4367             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4368         
4369         set([handles.DepthRangeMin
4370             handles.DepthRangeMax
4371             handles.VectorScalePlanView
4372             handles.VectorSpacingPlanview
4373             handles.SmoothingWindowSize
4374             handles.DisplayShoreline
4375             handles.PlotPlanView
4376             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4377         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4378             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4379         <span class="keyword">else</span>
4380             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4381         <span class="keyword">end</span>
4382         
4383         set([handles.HorizontalGridNodeSpacing
4384             handles.VerticalGridNodeSpacing
4385             handles.PlotShiptracks
4386             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4387         
4388         set([handles.Contour
4389             handles.VerticalExaggeration
4390             handles.VectorScaleCrossSection
4391             handles.HorizontalVectorSpacing
4392             handles.VerticalVectorSpacing
4393             handles.HorizontalSmoothingWindow
4394             handles.VerticalSmoothingWindow
4395             handles.PlotSecondaryFlowVectors
4396             handles.SecondaryFlowVectorVariable
4397             handles.IncludeVerticalVelocity
4398             handles.PlotCrossSection
4399             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4400     <span class="keyword">otherwise</span>
4401 <span class="keyword">end</span>
4402 
4403 <span class="comment">% Save Application Data</span>
4404 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4405 
4406 <span class="comment">% [EOF] set_enable</span>
4407 
4408 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4409 
4410 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4411 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4412 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4413 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4414 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4415 
4416 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4417 
4418 
4419 <span class="comment">% --------------------------------------------------------------------</span>
4420 <a name="_sub100" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4421     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4422 
4423 w = 500;
4424 h = 110;
4425 dx = 10;
4426 dy = 35;
4427 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4428 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4429     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4430     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4431     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4432     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4433     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4434     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4435     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4436     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4437     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4438     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4439 dialog_params.english_units               = english_units;
4440 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4441 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4442 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4443 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4444 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4445 
4446 <span class="comment">% Build the graphics:</span>
4447 <span class="comment">% -------------------</span>
4448 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4449     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4450     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4451     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4452 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4453     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4454     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4455     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4456     <span class="string">'Position'</span>,[15 35 100 22]);
4457 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4458     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4459     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4460     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4461     <span class="string">'Position'</span>,[15 10 100 22]);
4462 
4463 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4464     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4465     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4466     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4467 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4468     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4469     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4470     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4471     <span class="string">'Position'</span>,[15 35 100 22]);
4472 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4473     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4474     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4475     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4476     <span class="string">'Position'</span>,[15 10 100 22]);
4477 
4478 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4479     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4480     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4481     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4482 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4483     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4484     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4485     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4486     <span class="string">'Position'</span>,[15 35 100 22]);
4487 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4488     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4489     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4490     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4491     <span class="string">'Position'</span>,[15 10 100 22]);
4492 
4493 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4494     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4495     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4496     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4497     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4498 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4499     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4500     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4501     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4502     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4503 
4504 <span class="comment">% Update the UI controls:</span>
4505 <span class="comment">% -----------------------</span>
4506 <span class="keyword">if</span> dialog_params.english_units
4507     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4508     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4509 <span class="keyword">else</span>
4510     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4511     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4512 <span class="keyword">end</span>
4513 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4514     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4515     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4516 <span class="keyword">else</span>
4517     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4518     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4519 <span class="keyword">end</span>
4520 <span class="keyword">if</span> dialog_params.presentation
4521     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4522     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4523 <span class="keyword">else</span>
4524     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4525     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4526 <span class="keyword">end</span>
4527 
4528 <span class="comment">% Set the callbacks:</span>
4529 <span class="comment">% ------------------</span>
4530 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4531 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4532 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4533 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4534 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4535 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4536 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4537 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4538 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4539 
4540 <span class="comment">% Position the dialog and make it visible:</span>
4541 <span class="comment">% ----------------------------------------</span>
4542 fpos = get(hf,<span class="string">'Position'</span>);
4543 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4544 movegui(handles.Figure,dpos)
4545 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4546 
4547 <span class="comment">% Hold the dialog open:</span>
4548 <span class="comment">% ---------------------</span>
4549 waitfor(handles.OK)
4550 
4551 <span class="comment">% Return the outputs and close the dialog:</span>
4552 <span class="comment">% ----------------------------------------</span>
4553 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4554 english_units = dialog_params.english_units;
4555 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4556 plot_presentation_style =  dialog_params.presentation;
4557 plot_print_style =  dialog_params.print;
4558 
4559 delete(handles.Figure)
4560 
4561 <span class="comment">% [EOF] plotParametersDialog</span>
4562 
4563 
4564 <span class="comment">% --------------------------------------------------------------------</span>
4565 <a name="_sub101" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4566 
4567 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4568 <span class="keyword">switch</span> the_units
4569     <span class="keyword">case</span> <span class="string">'metric'</span>
4570         dialog_params.english_units = false;
4571         
4572         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4573         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4574     <span class="keyword">case</span> <span class="string">'english'</span>
4575         dialog_params.english_units = true;
4576         
4577         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4578         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4579     <span class="keyword">otherwise</span>
4580 <span class="keyword">end</span>
4581 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4582 
4583 <span class="comment">% [EOF] dialogUnits</span>
4584 
4585 <span class="comment">% --------------------------------------------------------------------</span>
4586 <a name="_sub102" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4587 
4588 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4589 <span class="keyword">switch</span> the_endpoints
4590     <span class="keyword">case</span> <span class="string">'auto'</span>
4591         dialog_params.set_cross_section_endpoints = false;
4592         
4593         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4594         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4595     <span class="keyword">case</span> <span class="string">'manual'</span>
4596         dialog_params.set_cross_section_endpoints = true;
4597         
4598         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4599         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4600     <span class="keyword">otherwise</span>
4601 <span class="keyword">end</span>
4602 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4603 
4604 <span class="comment">% [EOF] dialogEnpoints</span>
4605 
4606 <a name="_sub103" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4607 
4608 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4609 <span class="keyword">switch</span> the_style
4610     <span class="keyword">case</span> <span class="string">'presentation'</span>
4611         dialog_params.presentation  = true;
4612         dialog_params.print         = false;
4613         
4614         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4615         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4616     <span class="keyword">case</span> <span class="string">'print'</span>
4617         dialog_params.presentation  = false;
4618         dialog_params.print         = true;
4619         
4620         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4621         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4622     <span class="keyword">otherwise</span>
4623 <span class="keyword">end</span>
4624 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4625 
4626 <span class="comment">% [EOF] dialogEnpoints</span>
4627 
4628 <span class="comment">% --------------------------------------------------------------------</span>
4629 <a name="_sub104" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4630 
4631 delete(h_OK)
4632 
4633 <span class="comment">% [EOF] dialogOK</span>
4634 
4635 <span class="comment">% --------------------------------------------------------------------</span>
4636 <a name="_sub105" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4637 <span class="comment">% Return the original inputs</span>
4638 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4639 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4640 delete(handles.OK)
4641 
4642 <span class="comment">% [EOF] dialogCancel</span>
4643 
4644 <span class="comment">% --------------------------------------------------------------------</span>
4645 <a name="_sub106" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4646 
4647 delete(h_OK)
4648 
4649 <span class="comment">% [EOF] dialogCloseReq</span>
4650 
4651 <a name="_sub107" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4652     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4653 w = 230;
4654 h = 245;
4655 dx = 10;
4656 dy = 35;
4657 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4658 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4659     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4660     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4661     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4662     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4663     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4664     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4665     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4666     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4667     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4668     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4669 dialog_params.beam_angle             = beam_angle;
4670 dialog_params.magnetic_variation     = magnetic_variation;
4671 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded</span>
4672     dialog_params.wse                = <span class="string">'tide'</span>;
4673     wse_string                       = <span class="string">'tide'</span>;
4674 <span class="keyword">else</span>
4675     dialog_params.wse                = wse;
4676     wse_string                       = num2str(wse);
4677 <span class="keyword">end</span>
4678 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4679 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4680 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4681 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4682 
4683 <span class="comment">% Build the graphics:</span>
4684 <span class="comment">% -------------------</span>
4685 ph = 150;
4686 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4687     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4688     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4689     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4690 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4691     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4692     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4693     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4694     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4695     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4696     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4697 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4698     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4699     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4700     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4701     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4702     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4703     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4704 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4705     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4706     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4707     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4708     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4709     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4710     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4711 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4712     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4713     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4714     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4715     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4716     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4717     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4718 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4719     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4720     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4721     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4722     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4723     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4724     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4725 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4726     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4727     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4728     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4729     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4730     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4731     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4732 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4733     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4734     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4735     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4736     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4737 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4738     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4739     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4740     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4741     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4742 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4743     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4744     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4745     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4746     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4747 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4748     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4749     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4750     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4751     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4752 
4753 <span class="comment">% Update the UI controls:</span>
4754 <span class="comment">% -----------------------</span>
4755 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4756 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4757 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4758 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4759 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4760 
4761 <span class="comment">% Set the callbacks:</span>
4762 <span class="comment">% ------------------</span>
4763 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4764 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4765 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4766 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4767 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4768 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4769 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4770 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4771 
4772 <span class="comment">% Position the dialog and make it visible:</span>
4773 <span class="comment">% ----------------------------------------</span>
4774 fpos = get(hf,<span class="string">'Position'</span>);
4775 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4776 movegui(handles.Figure,dpos)
4777 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4778 
4779 <span class="comment">% Hold the dialog open:</span>
4780 <span class="comment">% ---------------------</span>
4781 waitfor(handles.OK)
4782 
4783 <span class="comment">% Return the outputs and close the dialog:</span>
4784 <span class="comment">% ----------------------------------------</span>
4785 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4786 beam_angle              = dialog_params.beam_angle;
4787 magnetic_variation      = dialog_params.magnetic_variation;
4788 wse                     = str2num(dialog_params.wse);
4789 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4790 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4791 
4792 delete(handles.Figure)
4793 
4794 <span class="comment">% [EOF] exportSettingsDialog</span>
4795 
4796 <span class="comment">% --------------------------------------------------------------------</span>
4797 <a name="_sub108" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4798 
4799 <span class="comment">% Grab the current data</span>
4800 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4801 
4802 <span class="comment">% Set it according to the dialog box values</span>
4803 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4804 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4805 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4806 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4807 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4808 
4809 <span class="comment">% Re-store the application data</span>
4810 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4811 
4812 <span class="comment">% [EOF] dialogExportSettings</span>
4813 
4814 <a name="_sub109" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4815 
4816 w = 230;
4817 h = 200;
4818 dx = 10;
4819 dy = 35;
4820 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4821 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4822     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4823     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4824     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4825     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4826     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4827     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4828     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4829     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4830     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4831     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4832 dialog_params.figure_names               = figure_names;
4833 dialog_params.selected_figures           = <span class="string">''</span>;
4834 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4835 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4836 
4837 <span class="comment">% Build the graphics:</span>
4838 <span class="comment">% -------------------</span>
4839 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4840     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4841     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4842     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4843 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4844     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4845     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4846     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4847     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4848     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4849     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4850     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4851 
4852 
4853 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4854     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4855     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4856     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4857     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4858 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4859     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4860     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4861     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4862     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4863 
4864 <span class="comment">% Update the UI controls:</span>
4865 <span class="comment">% -----------------------</span>
4866 
4867 
4868 <span class="comment">% Set the callbacks:</span>
4869 <span class="comment">% ------------------</span>
4870 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4871 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4872 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4873 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4874 
4875 <span class="comment">% Position the dialog and make it visible:</span>
4876 <span class="comment">% ----------------------------------------</span>
4877 fpos = get(hf,<span class="string">'Position'</span>);
4878 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4879 movegui(handles.Figure,dpos)
4880 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4881 
4882 <span class="comment">% Hold the dialog open:</span>
4883 <span class="comment">% ---------------------</span>
4884 waitfor(handles.OK)
4885 
4886 <span class="comment">% Return the outputs and close the dialog:</span>
4887 <span class="comment">% ----------------------------------------</span>
4888 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4889 selected_figures = dialog_params.selected_figures;
4890 
4891 delete(handles.Figure)
4892 
4893 <span class="comment">% [EOF] openFiguresDialog</span>
4894 
4895 <span class="comment">% --------------------------------------------------------------------</span>
4896 <a name="_sub110" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4897 
4898 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4899 
4900 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4901 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4902 selected     = fig_names(idx_selected);
4903 dialog_params.selected_figures = selected;
4904 
4905 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4906 
4907 
4908 
4909 <span class="comment">% --------------------------------------------------------------------</span>
4910 <a name="_sub111" href="#_subfunctions" class="code">function icons = getIcons</a>
4911 
4912 <span class="comment">% Load data</span>
4913 idx = 1;
4914 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4915     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4916     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4917     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4918     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4919     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4920     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4921     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4922     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4923     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4924     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4925     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4926     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4927     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4928     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4929     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4930     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4931 
4932 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4933     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4934     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4935     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4936     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4937     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4938     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4939     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4940     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4941     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4942     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4943     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4944     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4945     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4946     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4947     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4948     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4949 
4950 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4951     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4952     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4953     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4954     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4955     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4956     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4957     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4958     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4959     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4960     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4961     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4962     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4963     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4964     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4965     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4966     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4967 
4968 <span class="comment">% Save data</span>
4969 idx = idx+1;
4970 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4971     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4972     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4973     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4974     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4975     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4976     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4977     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4978     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4979     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4980     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4981     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4982     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4983     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4984     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4985     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4986     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4987 
4988 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4989     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4990     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4991     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4992     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4993     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4994     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4995     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4996     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4997     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4998     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4999     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5000     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5001     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5002     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5003     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5004     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5005 
5006 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5007     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5008     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5009     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5010     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5011     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5012     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5013     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5014     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5015     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5016     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5017     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5018     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5019     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5020     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5021     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5022     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5023 
5024 <span class="comment">% Plotting parameters</span>
5025 idx = idx+1;
5026 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5027     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5028     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5029     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5030     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5031     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5032     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5033     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5034     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5035     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5036     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5037     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5038     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5039     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5040     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5041     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5042     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5043 
5044 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5045     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5046     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5047     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5048     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5049     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5050     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5051     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5052     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5053     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5054     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5055     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5056     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5057     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5058     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5059     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5060     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5061 
5062 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5063     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5064     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5065     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5066     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5067     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5068     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5069     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5070     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5071     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5072     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5073     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5074     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5075     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5076     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5077     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5078     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5079 
5080 <span class="comment">% Processing parameters</span>
5081 idx = idx+1;
5082 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5083     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5084     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5085     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5086     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5087     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5088     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5089     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5090     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5091     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5092     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5093     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5094     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5095     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5096     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5097     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5098     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5099 
5100 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5101     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5102     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5103     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5104     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5105     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5106     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5107     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5108     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5109     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5110     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5111     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5112     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5113     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5114     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5115     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5116     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5117 
5118 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5119     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5120     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5121     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5122     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5123     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5124     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5125     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5126     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5127     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5128     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5129     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5130     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5131     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5132     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5133     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5134     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5135 
5136 <span class="comment">% Export bathymetry dialog</span>
5137 idx = idx+1;
5138 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5139     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5140     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5141     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5142     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5143     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5144     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5145     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5146     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5147     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5148     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5149     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5150     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5151     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5152     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5153     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5154     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5155     ]/255;
5156 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5157     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5158     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5159     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5160     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5161     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5162     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5163     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5164     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5165     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5166     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5167     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5168     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5169     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5170     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5171     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5172     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5173     ]/255;
5174 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5175     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5176     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5177     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5178     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5179     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5180     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5181     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5182     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5183     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5184     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5185     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5186     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5187     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5188     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5189     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5190     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5191     ]/255;
5192 
5193 <span class="comment">% Export Figures Dialog</span>
5194 idx = idx + 1;
5195 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5196     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5197     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5198     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5199     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5200     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5201     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5202     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5203     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5204     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5205     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5206     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5207     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5208     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5209     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5210     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5211 
5212 
5213 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5214     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5215     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5216     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5217     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5218     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5219     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5220     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5221     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5222     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5223     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5224     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5225     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5226     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5227     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5228     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5229 
5230 
5231 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5232     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5233     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5234     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5235     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5236     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5237     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5238     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5239     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5240     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5241     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5242     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5243     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5244     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5245     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5246     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5247 
5248 <span class="comment">% Export Excel File</span>
5249 idx = idx + 1;
5250 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5251     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5252    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5253    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5254    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5255    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5256    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5257    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5258    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5259    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5260    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5261    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5262    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5263    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5264    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5265    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5266     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5267 
5268 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5269     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5270    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5271    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5272    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5273    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5274    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5275    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5276    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5277    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5278    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5279    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5280    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5281    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5282    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5283    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5284     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5285 
5286 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5287     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5288    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5289    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5290    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5291    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5292    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5293    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5294    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5295    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5296    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5297    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5298    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5299    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5300    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5301    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5302     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5303 
5304 <span class="comment">% Zoom In</span>
5305 idx = idx + 1;
5306 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5307     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5308 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5309     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5310 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5311     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5312 
5313 <span class="comment">% Zoom Out</span>
5314 idx = idx + 1;
5315 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5316     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5317 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5318     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5319 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5320     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5321 
5322 <span class="comment">% Pan</span>
5323 idx = idx + 1;
5324 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5325     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5326 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5327     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5328 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5329     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5330 <span class="comment">% [EOF] getIcons</span>
5331 
5332 <a name="_sub112" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5333 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5334 
5335 <span class="comment">% Check for any stored prefs</span>
5336 <span class="comment">% --------------------------</span>
5337 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5338 guiprefs = getpref(<span class="string">'VMT'</span>);
5339 
5340 <span class="comment">% Organized by GUI panels</span>
5341 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5342 <span class="comment">% SHIPTRACKS PLOT %</span>
5343 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5344 guiparams.horizontal_grid_node_spacing       = 1.0;
5345 guiparams.vertical_grid_node_spacing         = 0.4;
5346 
5347 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5348 <span class="comment">% CROSS SECTION PLOT %</span>
5349 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5350 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5351 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5352 guiparams.idx_contour                        = 1;
5353 guiparams.vertical_exaggeration              = 10;
5354 guiparams.vector_scale_cross_section         = 0.2;
5355 guiparams.horizontal_vector_spacing          = 1;
5356 guiparams.vertical_vector_spacing            = 1;
5357 guiparams.horizontal_smoothing_window        = 1;
5358 guiparams.vertical_smoothing_window          = 1;
5359 guiparams.plot_secondary_flow_vectors        = true;
5360 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5361 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5362 guiparams.idx_secondary_flow_vector_variable = 1;
5363 guiparams.include_vertical_velocity          = true;
5364 
5365 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5366 <span class="comment">% PLAN VIEW PLOT %</span>
5367 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5368 guiparams.depth_range_min                    = 0;
5369 guiparams.depth_range_max                    = inf;
5370 guiparams.vector_scale_plan_view             = 1;
5371 guiparams.vector_spacing_plan_view           = 1;
5372 guiparams.smoothing_window_size              = 1;
5373 guiparams.display_shoreline                  = false;
5374 guiparams.add_background                     = false;
5375 
5376 <span class="comment">%%%%%%%%%%%%%%%</span>
5377 <span class="comment">% DATA EXPORT %</span>
5378 <span class="comment">%%%%%%%%%%%%%%%</span>
5379 guiparams.beam_angle                         = 20.0;
5380 guiparams.magnetic_variation                 = 0.0;
5381 guiparams.wse                                = 0.0;
5382 guiparams.load_wse_tide_file                 = false;
5383 guiparams.output_auxiliary_data              = false;
5384 
5385 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5386 <span class="comment">% Contour variables %</span>
5387 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5388 idx = 1;
5389 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5390 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5391 idx = idx + 1;
5392 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5393 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5394 idx = idx + 1;
5395 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5396 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5397 idx = idx + 1;
5398 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5399 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5400 idx = idx + 1;
5401 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5402 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5403 idx = idx + 1;
5404 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5405 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5406 idx = idx + 1;
5407 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5408 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5409 idx = idx + 1;
5410 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5411 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5412 idx = idx + 1;
5413 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5414 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5415 idx = idx + 1;
5416 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5417 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5418 idx = idx + 1;
5419 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5420 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5421 idx = idx + 1;
5422 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5423 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5424 idx = idx + 1;
5425 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5426 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5427 idx = idx + 1;
5428 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5429 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5430 idx = idx + 1;
5431 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5432 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5433 idx = idx + 1;
5434 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5435 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5436 idx = idx + 1;
5437 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5438 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5439 idx = idx + 1;
5440 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5441 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5442 idx = idx + 1;
5443 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5444 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5445 idx = idx + 1;
5446 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5447 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5448 
5449 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5450 
5451 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5452 <span class="comment">% Secondary Flow Vector Variables %</span>
5453 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5454 idx = 1;
5455 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5456 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5457 idx = idx + 1;
5458 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5459 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5460 idx = idx + 1;
5461 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5462 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5463 idx = idx + 1;
5464 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5465 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5466 idx = idx + 1;
5467 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5468 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5469 
5470 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5471     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5472 
5473 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5474 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5475 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5476 <span class="comment">% Menu bar options</span>
5477 guiparams.presentation                       = true;
5478 guiparams.print                              = false;
5479 guiparams.set_cross_section_endpoints        = false;
5480 guiparams.unit_discharge_correction          = false;
5481 
5482 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5483     <span class="keyword">switch</span> guiprefs.units
5484         <span class="keyword">case</span> <span class="string">'metric'</span>
5485             guiparams.english_units          = false;
5486         <span class="keyword">case</span> <span class="string">'english'</span>
5487             guiparams.english_units          = true;
5488     <span class="keyword">end</span>
5489 <span class="keyword">else</span>
5490     guiparams.english_units                  = false;
5491 <span class="keyword">end</span>
5492 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5493     <span class="keyword">switch</span> guiprefs.plotref
5494         <span class="keyword">case</span> <span class="string">'dfs'</span>
5495             guiparams.plotref                 = <span class="string">'dfs'</span>;
5496         <span class="keyword">case</span> <span class="string">'hab'</span>
5497             guiparams.plotref                 = <span class="string">'hab'</span>;
5498     <span class="keyword">end</span>
5499 <span class="keyword">else</span>
5500     guiparams.plotref                         = <span class="string">'dfs'</span>;
5501 <span class="keyword">end</span>
5502 guiparams.eta                                 = 100; <span class="comment">% Used in HAB reference</span>
5503 guiparams.vertical_offset                     = 0;
5504 
5505 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5506     guiparams.renderer                       = guiprefs.renderer;
5507 <span class="keyword">else</span>
5508     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5509 <span class="keyword">end</span>
5510 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5511 <span class="comment">% guiparams.plot_planview                      = false;</span>
5512 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5513 
5514 <span class="comment">% File location defaults</span>
5515 guiparams.ascii_path                        = pwd;
5516 guiparams.ascii_file                        = <span class="string">''</span>;
5517 guiparams.mat_path                          = pwd;
5518 guiparams.mat_file                          = <span class="string">''</span>;
5519 guiparams.tecplot_path                      = pwd;
5520 guiparams.tecplot_file                      = <span class="string">''</span>;
5521 guiparams.kmz_path                          = pwd;
5522 guiparams.kmz_file                          = <span class="string">''</span>;
5523 guiparams.multibeambathymetry_path          = pwd;
5524 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5525 guiparams.log_path                          = pwd;
5526 guiparams.log_file                          = <span class="string">''</span>;
5527 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5528 <span class="comment">% application</span>
5529 <span class="keyword">if</span> isdeployed 
5530     guiparams.has_mapping_toolbox           = true;
5531 <span class="keyword">else</span>
5532     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5533         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5534 <span class="keyword">end</span>
5535 
5536 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5537 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5538 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5539 guiparams.z                      = [];
5540 guiparams.A                      = [];
5541 guiparams.V                      = [];
5542 guiparams.Map                    = [];
5543 guiparams.savefile               = [];
5544 guiparams.iric_anv_planview_data = [];
5545 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5546 <span class="comment">% guiparams.zmax = [];</span>
5547 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5548 guiparams.data_folder = <span class="string">''</span>;
5549 guiparams.data_files  = {<span class="string">''</span>};
5550 guiparams.gui_state   = <span class="string">'init'</span>;
5551 
5552 <span class="comment">% [EOF] createGUIparams</span>
5553 
5554 <a name="_sub113" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5555 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5556 
5557 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5558 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5559 
5560 <span class="comment">% [EOF] VMT</span>
5561 
5562 
5563 
5564 
5565 
5566 <span class="comment">% --- Hidden keyboard commands</span>
5567 <a name="_sub115" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5568 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5569 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5570 <span class="comment">%</span>
5571 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5572 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5573 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5574 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5575 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5576 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5577 
5578 in1 = eventdata.Modifier; 
5579 in2 = eventdata.Key;
5580 
5581 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5582     input = [in1{:} in2];
5583 <span class="keyword">else</span>
5584     input = in2;
5585 <span class="keyword">end</span>
5586 
5587 <span class="keyword">switch</span> input
5588     <span class="comment">% Hidden SonTek M9 support</span>
5589     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5590         msgtxt = {<span class="keyword">...</span>
5591             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5592             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5593             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5594             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5595             <span class="string">''</span>;<span class="keyword">...</span>
5596             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5597             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5598             <span class="string">'PROVISIONAL at best.'</span>};
5599         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5600         
5601         <span class="comment">% Get the Application data:</span>
5602         <span class="comment">% -------------------------</span>
5603         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5604         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5605         
5606         <span class="comment">% Ask the user to select files:</span>
5607         <span class="comment">% -----------------------------</span>
5608         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5609         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5610         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5611             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5612         <span class="keyword">else</span>
5613             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5614         <span class="keyword">end</span>
5615         [filename,pathname] = <span class="keyword">...</span>
5616             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5617             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5618             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5619         
5620         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5621             guiparams.data_folder = pathname;
5622             <span class="keyword">if</span> ischar(filename)
5623                 filename = {filename};
5624             <span class="keyword">end</span>
5625             guiparams.data_files = filename;
5626             guiparams.mat_file = <span class="string">''</span>;
5627             
5628             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5629             
5630             
5631             
5632             <span class="comment">% Update the preferences:</span>
5633             <span class="comment">% -----------------------</span>
5634             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5635             guiprefs.ascii_path = pathname;
5636             guiprefs.ascii_file = filename;
5637             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5638             <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5639             
5640             <span class="comment">% Push messages to Log Window:</span>
5641             <span class="comment">% ----------------------------</span>
5642             log_text = {<span class="keyword">...</span>
5643                 <span class="string">''</span>;<span class="keyword">...</span>
5644                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5645                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5646                 guiparams.data_folder;
5647                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5648                 char(filename)};
5649             statusLogging(handles.LogWindow, log_text)
5650             
5651             <span class="comment">% Read the file(s)</span>
5652             <span class="comment">% ----------------</span>
5653             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5654             
5655             [~,~,savefile,A,z] = <span class="keyword">...</span>
5656                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5657             guiparams.savefile = savefile;
5658             guiparams.A        = A;
5659             guiparams.z        = z;
5660             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5661             
5662             
5663             <span class="comment">% Update the GUI:</span>
5664             <span class="comment">% ---------------</span>
5665             <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5666         <span class="keyword">end</span>  
5667     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5668         SontekMAT2KML;
5669     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5670         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5671         
5672     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5673         VMT_BuildCustomFlatFile;
5674     <span class="keyword">otherwise</span>
5675         <span class="comment">%disp(input)</span>
5676 <span class="keyword">end</span>
5677 
5678</pre></div>
<hr><address>Generated on Tue 02-Jun-2015 12:21:30 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>