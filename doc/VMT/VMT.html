<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function AllowVMTFlipFlux_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub97" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub98" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub99" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub100" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub101" class="code">function initGUI(handles)</a></li><li><a href="#_sub102" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub103" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub104" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub105" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub106" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub107" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub108" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub110" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub111" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub112" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub113" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub114" class="code">function icons = getIcons</a></li><li><a href="#_sub115" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub116" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub117" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub118" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub98" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub99" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub115" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20160114'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub101" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 
0149 <span class="comment">% Allow VMT GUI to be resized depending on the screen resolution</span>
0150 <span class="comment">% set(0,'units','pixels')</span>
0151 <span class="comment">% Pix_SS = get(0,'screensize');</span>
0152 <span class="comment">% movegui(handles.figure1,'center')</span>
0153 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0154 
0155 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0156 <span class="comment">% the root</span>
0157 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0158 
0159 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0160 <span class="comment">% uiwait(handles.figure1);</span>
0161 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0162 
0163 
0164 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0165 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0166 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0167 <span class="comment">% hObject    handle to figure</span>
0168 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0169 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0170 
0171 <span class="comment">% Get default command line output from handles structure</span>
0172 varargout{1} = handles.output;
0173 <span class="comment">% [EOF] VMT_OutputFcn</span>
0174 
0175 <span class="comment">% --- Executes when figure1 is resized.</span>
0176 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0177 
0178 <span class="comment">% Draw the VMT Background</span>
0179 <span class="comment">% -----------------</span>
0180 pos = get(handles.figure1,<span class="string">'position'</span>);
0181 axes(handles.VMTBackground);
0182 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0183     X = imread(<span class="string">'VMT_Background.png'</span>);
0184     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0185 <span class="comment">% else</span>
0186 <span class="comment">%     X = imread('VMT_Background.png');</span>
0187 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0188 <span class="comment">%     X = uint8(X);</span>
0189 <span class="comment">%     imshow(X,'Border','tight')</span>
0190 <span class="comment">% end</span>
0191 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0192 
0193 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0194 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0195 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0196 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0197 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0198 
0199 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0200 who_called = get(hObject,<span class="string">'tag'</span>);
0201 close_button = questdlg(<span class="keyword">...</span>
0202     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0203     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0204 <span class="keyword">switch</span> close_button
0205     <span class="keyword">case</span> <span class="string">'Yes'</span>
0206         closereq
0207         close all hidden
0208     <span class="keyword">otherwise</span>
0209         <span class="keyword">return</span>
0210 <span class="keyword">end</span>
0211 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0212 
0213 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0214 <span class="comment">% MENU BAR CALLBACKS %</span>
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 
0217 <span class="comment">% --------------------------------------------------------------------</span>
0218 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0219 <span class="comment">% Empty</span>
0220 
0221 <span class="comment">% --------------------------------------------------------------------</span>
0222 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0223 <span class="comment">% Empty</span>
0224 
0225 <span class="comment">% --------------------------------------------------------------------</span>
0226 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0227 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0228 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0229 
0230 <span class="comment">% --------------------------------------------------------------------</span>
0231 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0232 
0233 <span class="comment">% Get the Application data:</span>
0234 <span class="comment">% -------------------------</span>
0235 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0236 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0237 
0238 <span class="comment">% Ask the user to select files:</span>
0239 <span class="comment">% -----------------------------</span>
0240 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0241 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0242 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0243     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0244 <span class="keyword">else</span>
0245     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0246 <span class="keyword">end</span>
0247 [filename,pathname] = <span class="keyword">...</span>
0248     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0249     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0250     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0251 
0252 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0253     <span class="comment">% Load the data:</span>
0254     <span class="comment">% --------------</span>
0255     vars = load(fullfile(pathname,filename));
0256     
0257     <span class="comment">% Make sure the selected file is a valid file:</span>
0258     <span class="comment">% --------------------------------------------</span>
0259     varnames = fieldnames(vars);
0260     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0261         guiparams.mat_path = pathname;
0262         guiparams.mat_file = filename;
0263         guiparams.z = vars.z;
0264         guiparams.A = vars.A;
0265         guiparams.V = vars.V;
0266         
0267         <span class="comment">% Update the preferences:</span>
0268         <span class="comment">% -----------------------</span>
0269         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0270         guiprefs.mat_path = pathname;
0271         guiprefs.mat_file = filename;
0272         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0273         <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0274                      
0275         <span class="comment">% Re-store the Application Data:</span>
0276         <span class="comment">% ------------------------------</span>
0277         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0278         
0279         <span class="comment">% Update the GUI:</span>
0280         <span class="comment">% ---------------</span>
0281         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0282         <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0283     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0284         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0285             <span class="string">'Invalid File...'</span>)
0286     <span class="keyword">end</span>
0287     
0288     <span class="comment">% Set the vertical grid node spacing</span>
0289     <span class="comment">% ----------------------------------</span>
0290     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0291     <span class="comment">% Backwards compatible</span>
0292     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0293         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0294     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0295         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0296     <span class="keyword">end</span>
0297     
0298 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0299     <span class="comment">% Set the filenames</span>
0300     <span class="comment">% -----------------</span>
0301     guiparams.mat_path = pathname;
0302     guiparams.mat_file = filename;
0303     
0304     <span class="comment">% Push status to log window</span>
0305     <span class="comment">% -------------------------</span>
0306     log_text = {<span class="keyword">...</span>
0307         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0308         <span class="string">'Directory:'</span>};
0309     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0310     statusLogging(handles.LogWindow,log_text)
0311     
0312     <span class="comment">% Update the Application Data:</span>
0313     <span class="comment">% ------------------------------</span>
0314     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0315     
0316     <span class="comment">% Update the persistent preferences:</span>
0317     <span class="comment">% ----------------------------------</span>
0318     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0319     guiprefs.mat_path = pathname;
0320     guiprefs.mat_file = filename;
0321     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0322     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0323         
0324     <span class="comment">% Update the GUI:</span>
0325     <span class="comment">% ---------------</span>
0326     <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0327 <span class="keyword">end</span>
0328 
0329 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0330 
0331 <span class="comment">% --------------------------------------------------------------------</span>
0332 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0333 <span class="comment">% Empty</span>
0334 
0335 <span class="comment">% --------------------------------------------------------------------</span>
0336 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0337 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0338 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0339 
0340 <span class="comment">% --------------------------------------------------------------------</span>
0341 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0342 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0343 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0344 
0345 <span class="comment">% --------------------------------------------------------------------</span>
0346 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0347 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0348 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0349 
0350 <span class="comment">% --------------------------------------------------------------------</span>
0351 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0352 <span class="comment">% Empty</span>
0353 
0354 <span class="comment">% --------------------------------------------------------------------</span>
0355 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0356 <span class="comment">% Empty</span>
0357 
0358 <span class="comment">% --------------------------------------------------------------------</span>
0359 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0360 
0361 <span class="comment">% Get the Application Data:</span>
0362 <span class="comment">% -------------------------</span>
0363 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0364 
0365 <span class="comment">% Update the Application Data:</span>
0366 <span class="comment">% ----------------------------</span>
0367 guiparams.print        = true;
0368 guiparams.presentation = false;
0369 
0370 <span class="comment">% Re-store the Application data:</span>
0371 <span class="comment">% ------------------------------</span>
0372 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0373 
0374 <span class="comment">% Update the GUI:</span>
0375 <span class="comment">% ---------------</span>
0376 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0377 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0378 
0379 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0380 
0381 
0382 <span class="comment">% --------------------------------------------------------------------</span>
0383 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0384 
0385 <span class="comment">% Get the Application Data:</span>
0386 <span class="comment">% -------------------------</span>
0387 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0388 
0389 <span class="comment">% Update the Application Data:</span>
0390 <span class="comment">% ----------------------------</span>
0391 guiparams.print        = false;
0392 guiparams.presentation = true;
0393 
0394 <span class="comment">% Re-store the Application data:</span>
0395 <span class="comment">% ------------------------------</span>
0396 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0397 
0398 <span class="comment">% Update the GUI:</span>
0399 <span class="comment">% ---------------</span>
0400 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0401 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0402 
0403 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0404 
0405 <span class="comment">% --------------------------------------------------------------------</span>
0406 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0407 <span class="comment">%  --- Empty ---</span>
0408 
0409 <span class="comment">% --------------------------------------------------------------------</span>
0410 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0411 <span class="comment">% Get the Application Data:</span>
0412 <span class="comment">% -------------------------</span>
0413 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0414 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0415 
0416 <span class="comment">% Update the Application Data:</span>
0417 <span class="comment">% ----------------------------</span>
0418 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0419 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0420 
0421 <span class="comment">% Re-store the Application data:</span>
0422 <span class="comment">% ------------------------------</span>
0423 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0424 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0425 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0426 
0427 <span class="comment">% Update the GUI:</span>
0428 <span class="comment">% ---------------</span>
0429 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0430 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0431 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 
0433 <span class="comment">% Modify the existing figures</span>
0434 <span class="comment">% ---------------------------</span>
0435 <span class="comment">% Find what plots exist already</span>
0436 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0437 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0438 
0439 <span class="comment">% Loop through valid figures and adjust</span>
0440 <span class="comment">% -------------------------------------</span>
0441 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0442     <span class="keyword">for</span> i = 1:length(valid_names)
0443         <span class="comment">% Focus the figure</span>
0444         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0445         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0446             figure(hff)
0447             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0448         <span class="keyword">end</span>
0449         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0450         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0451             figure(hff)
0452             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0453         <span class="keyword">end</span>
0454     <span class="keyword">end</span>
0455 <span class="keyword">end</span>
0456 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0457 
0458 
0459 <span class="comment">% --------------------------------------------------------------------</span>
0460 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0461 <span class="comment">% Get the Application Data:</span>
0462 <span class="comment">% -------------------------</span>
0463 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0464 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0465 
0466 <span class="comment">% Update the Application Data:</span>
0467 <span class="comment">% ----------------------------</span>
0468 guiparams.renderer  = <span class="string">'painters'</span>;
0469 guiprefs.renderer   = <span class="string">'painters'</span>;
0470 
0471 <span class="comment">% Re-store the Application data:</span>
0472 <span class="comment">% ------------------------------</span>
0473 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0474 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0475 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0476 
0477 <span class="comment">% Update the GUI:</span>
0478 <span class="comment">% ---------------</span>
0479 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0480 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0481 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0482 
0483 <span class="comment">% Modify the existing figures</span>
0484 <span class="comment">% ---------------------------</span>
0485 <span class="comment">% Find what plots exist already</span>
0486 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0487 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0488 
0489 <span class="comment">% Loop through valid figures and adjust</span>
0490 <span class="comment">% -------------------------------------</span>
0491 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0492     <span class="keyword">for</span> i = 1:length(valid_names)
0493         <span class="comment">% Focus the figure</span>
0494         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0495         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0496             figure(hff)
0497             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0498         <span class="keyword">end</span>
0499         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0500         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0501             figure(hff)
0502             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0503         <span class="keyword">end</span>
0504     <span class="keyword">end</span>
0505 <span class="keyword">end</span>
0506 <span class="comment">% [EOF] menuPainters_Callback</span>
0507 
0508 <span class="comment">% --------------------------------------------------------------------</span>
0509 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0510 <span class="comment">% Get the Application Data:</span>
0511 <span class="comment">% -------------------------</span>
0512 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0513 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0514 
0515 <span class="comment">% Update the Application Data:</span>
0516 <span class="comment">% ----------------------------</span>
0517 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0518 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0519 
0520 <span class="comment">% Re-store the Application data:</span>
0521 <span class="comment">% ------------------------------</span>
0522 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0523 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0524 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0525 
0526 <span class="comment">% Update the GUI:</span>
0527 <span class="comment">% ---------------</span>
0528 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0529 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0531 
0532 <span class="comment">% Modify the existing figures</span>
0533 <span class="comment">% ---------------------------</span>
0534 <span class="comment">% Find what plots exist already</span>
0535 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0536 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0537 
0538 <span class="comment">% Loop through valid figures and adjust</span>
0539 <span class="comment">% -------------------------------------</span>
0540 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0541     <span class="keyword">for</span> i = 1:length(valid_names)
0542         <span class="comment">% Focus the figure</span>
0543         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0544         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0545             figure(hff)
0546             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0547         <span class="keyword">end</span>
0548         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0549         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0550             figure(hff)
0551             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0552         <span class="keyword">end</span>
0553     <span class="keyword">end</span>
0554 <span class="keyword">end</span>
0555 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0556 
0557 <span class="comment">% --------------------------------------------------------------------</span>
0558 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0559 <span class="comment">% Get the Application data:</span>
0560 <span class="comment">% -------------------------</span>
0561 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0562 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0563 
0564 <span class="comment">% Find what plots exist already</span>
0565 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0566 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0567 
0568 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0569 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0570 <span class="keyword">if</span> ~isempty(idx)
0571     fig_names(idx) = [];
0572 <span class="keyword">end</span>
0573 
0574 <span class="keyword">if</span> guiparams.presentation
0575     figure_style = <span class="string">'presentation'</span>;
0576 <span class="keyword">else</span>
0577     figure_style = <span class="string">'print'</span>;
0578 <span class="keyword">end</span>
0579 
0580 [selected_figures] = <a href="#_sub112" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0581 
0582 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0583     <span class="keyword">return</span>
0584 <span class="keyword">else</span>
0585     <span class="keyword">for</span> i = 1:length(selected_figures)
0586         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0587     <span class="keyword">end</span>
0588 <span class="keyword">end</span>
0589 
0590 
0591 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0592 
0593 <span class="comment">% --------------------------------------------------------------------</span>
0594 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0595 <span class="comment">% Get the Application data:</span>
0596 <span class="comment">% -------------------------</span>
0597 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0598 beam_angle             = guiparams.beam_angle; 
0599 magnetic_variation     = guiparams.magnetic_variation; 
0600 wse                    = guiparams.water_surface_elevation;
0601 output_auxiliary_data  = guiparams.output_auxiliary_data;
0602 load_wse_tide_file     = guiparams.load_wse_tide_file;
0603 
0604 <span class="comment">% Open dialog and allow user to select settings</span>
0605 <span class="comment">% ---------------------------------------------</span>
0606 [beam_angle,<span class="keyword">...</span>
0607     magnetic_variation,<span class="keyword">...</span>
0608     wse,<span class="keyword">...</span>
0609     output_auxiliary_data,<span class="keyword">...</span>
0610     load_wse_tide_file] = <span class="keyword">...</span>
0611     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0612 
0613 <span class="comment">% Re-store the Application data:</span>
0614 <span class="comment">% ------------------------------</span>
0615 guiparams.beam_angle            = beam_angle;
0616 guiparams.magnetic_variation    = magnetic_variation; 
0617 guiparams.load_wse_tide_file    = load_wse_tide_file;
0618 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0619       infile = fullfile(<span class="keyword">...</span>
0620         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_file);
0622     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0623     guiparams.water_surface_elevation = wsedata;
0624 <span class="keyword">else</span>
0625       guiparams.water_surface_elevation = wse;
0626 <span class="keyword">end</span>
0627 guiparams.output_auxiliary_data = output_auxiliary_data;
0628 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0629 
0630 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0631 
0632 <span class="comment">% --------------------------------------------------------------------</span>
0633 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0634 <span class="comment">% wsedata.obstime</span>
0635 <span class="comment">% wsedata.elev</span>
0636 
0637 <span class="comment">% Determine Files to Process</span>
0638 <span class="comment">% Ask the user to select files:</span>
0639 <span class="comment">% -----------------------------</span>
0640 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0641     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0642     infile, <span class="keyword">...</span>
0643     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0644 
0645 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0646     data = csvread(fullfile(zPathName,zFileName));
0647     wsedata.obstime = datenum(data(:,1:6));
0648     wsedata.elev    = data(:,7);
0649 <span class="keyword">else</span>
0650     wsedata.obstime = [];
0651     wsedata.elev    = [];
0652     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0653 <span class="keyword">end</span>
0654 <span class="comment">%  [EOF] loadTideFile</span>
0655 
0656 <span class="comment">% --------------------------------------------------------------------</span>
0657 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0658 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0659 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0660 
0661 
0662 <span class="comment">% --------------------------------------------------------------------</span>
0663 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0664 
0665 <span class="comment">% Get the Application Data:</span>
0666 <span class="comment">% -------------------------</span>
0667 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0668 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0669 PVdata    = guiparams.iric_anv_planview_data;
0670 iric_path = guiprefs.iric_path;
0671 iric_file = guiprefs.iric_file;
0672 
0673 <span class="comment">% Is there any planview data?</span>
0674 <span class="keyword">if</span> isempty(PVdata)
0675     <span class="comment">% Nothing to do, warn user</span>
0676     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0677     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0678 <span class="keyword">else</span>
0679     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0680     <span class="comment">% and smoothing (for iRiC)</span>
0681     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0682     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0683         fullfile(iric_path,iric_file));
0684     
0685     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0686         outfile = fullfile(iric_path,iric_file);
0687         log_text = vertcat(log_text,{outfile});
0688         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0689         outcount = fprintf(ofid,<span class="keyword">...</span>
0690             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0691         fclose(ofid);
0692     <span class="keyword">else</span>
0693         <span class="comment">% Return default iric_path and iric_file</span>
0694         iric_path = guiprefs.iric_path;
0695         iric_file = guiprefs.iric_file;
0696     <span class="keyword">end</span>
0697 <span class="keyword">end</span>
0698 
0699 <span class="comment">% Push messages to Log Window:</span>
0700 <span class="comment">% ----------------------------</span>
0701 statusLogging(handles.LogWindow, log_text)
0702 
0703 <span class="comment">% Store the persistent preferences:</span>
0704 <span class="comment">% ---------------------------------</span>
0705 guiprefs.iric_file = iric_file;
0706 guiprefs.iric_path = iric_path;
0707 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0708 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0709 
0710 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0711 
0712 <span class="comment">% --------------------------------------------------------------------</span>
0713 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0714 <span class="comment">% Get the Application Data:</span>
0715 <span class="comment">% -------------------------</span>
0716 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0717 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0718 excel_path  = guiprefs.excel_path;
0719 excel_file  = guiprefs.excel_file;
0720 
0721 <span class="comment">% Push messages to Log Window:</span>
0722 <span class="comment">% ----------------------------</span>
0723 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0724 statusLogging(handles.LogWindow, log_text)
0725 
0726 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0727 <span class="comment">% data.</span>
0728 <span class="keyword">if</span> iscell(guiparams.mat_file)
0729     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0730     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0731     <span class="comment">% Refresh the Application Data:</span>
0732     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0733     z           = guiparams.z;
0734     A           = guiparams.A;
0735     V           = guiparams.V;
0736     Map         = guiparams.Map;
0737     wse         = guiparams.water_surface_elevation;
0738     PVdata      = guiparams.iric_anv_planview_data;
0739     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0740         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0741     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0742         fullfile(excel_path,excel_file));
0743     
0744     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0745         outfile = fullfile(excel_path,excel_file);
0746         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0747         
0748     <span class="keyword">else</span>
0749         <span class="comment">% Return default excel_path and excel_file</span>
0750         excel_path = guiprefs.excel_path;
0751         excel_file = guiprefs.excel_file;
0752         outfile = fullfile(excel_path,excel_file);
0753         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0754     <span class="keyword">end</span>
0755     
0756     <span class="comment">% Delete the old file if it exists</span>
0757     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0758         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0759             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0760             <span class="string">'already exists. Overwriting file...'</span>});
0761         delete(outfile)
0762     <span class="keyword">end</span>
0763     
0764     <span class="comment">% Save MCS Summary to an Excel File</span>
0765     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0766     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0767     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0768     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0769         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0770         sout = guiparams.mat_file';
0771     <span class="keyword">end</span>
0772     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0773     sout = {<span class="keyword">...</span>
0774         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0775         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0776         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0777         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0778         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0779         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0780         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0781         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0782         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0783         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0784         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0785         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0786         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0787         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0788         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0789         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0790         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0791         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0792         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0793         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0794         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0795         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0796         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0797         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0798         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0799         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0800         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0801         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0802         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0803         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0804         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0805         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0806         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0807         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0808         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0809         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0810         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0811         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0812         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0813         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0814         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0815         };
0816     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0817     
0818     <span class="comment">% Save DAV data to an Excel File</span>
0819     vmin = num2str(guiparams.depth_range_min);
0820     vmax = num2str(guiparams.depth_range_max);
0821     pvheaders = {<span class="keyword">...</span>
0822         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0823         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0824         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0825         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0826 
0827     <span class="comment">% Initialize Variables</span>
0828     pvdata = []; Dist = []; ID = {};
0829     X = []; Y = []; E = []; T = [];
0830     Ve = []; Vn =[]; Vm = []; Vd = [];
0831     
0832     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0833     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0834         <span class="comment">% Load current MAT-file</span>
0835         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0836         
0837         <span class="comment">% Location, Time and Bathy</span>
0838         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0839         X = [X V.mcsX(1,:)];
0840         Y = [Y V.mcsY(1,:)];
0841         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0842         E = [E V.mcsBedElev];
0843         T = [T V.mcsTime(1,:)];
0844                 
0845         <span class="comment">% Build layer-averaged velocities</span>
0846         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0847         V.mcsX(indx,:) = nan;
0848         V.mcsY(indx,:) = nan;
0849         V.mcsEast(indx,:) = nan;
0850         V.mcsNorth(indx,:) = nan;
0851         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0852         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0853         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0854         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0855         
0856         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0857     <span class="keyword">end</span>
0858     
0859     <span class="comment">% Put output into 1 matrix</span>
0860     pvdata = [<span class="keyword">...</span>
0861         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0862         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0863         ];
0864     pvdata(isnan(pvdata)) = -9999;
0865     
0866     <span class="comment">% Create table and write to Excel</span>
0867     pvout = num2cell(pvdata');
0868     pvout = horzcat(ID,pvout);
0869     timestamp = cellstr(nandatestr(T));
0870     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0871     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0872     
0873     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0874     <span class="comment">% results</span>
0875     PVheaders = {<span class="keyword">...</span>
0876         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0877         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0878         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0879         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0880         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0881     PVtable = [<span class="keyword">...</span>
0882         PVdata.outmat(1,:);<span class="keyword">...</span>
0883         PVdata.outmat(2,:);<span class="keyword">...</span>
0884         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0885         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0886         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0887         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0888         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0889     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0890     PVtable(isnan(PVtable)) = -9999;
0891     PVout = horzcat(<span class="keyword">...</span>
0892         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0893         PVdata.outfile,<span class="keyword">...</span>
0894         num2cell(PVtable'));
0895     PVout = vertcat(PVheaders,PVout);
0896     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0897     
0898     <span class="comment">% Close out waitbar</span>
0899     waitbar(1,hwait)
0900     delete(hwait)
0901     
0902     <span class="comment">% Push messages to Log Window:</span>
0903     <span class="comment">% ----------------------------</span>
0904     statusLogging(handles.LogWindow, log_text)
0905 <span class="keyword">else</span>
0906     
0907     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0908     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0909     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0910     <span class="comment">% Refresh the Application Data:</span>
0911     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0912     z           = guiparams.z;
0913     A           = guiparams.A;
0914     V           = guiparams.V;
0915     Map         = guiparams.Map;
0916     wse         = guiparams.water_surface_elevation;
0917     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0918                                                     <span class="comment">% Planview Plot exactly</span>
0919     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
0920                                  <span class="comment">% planview plot</span>
0921         
0922     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0923     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0924         fullfile(excel_path,excel_file));
0925     
0926     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0927         outfile = fullfile(excel_path,excel_file);
0928         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0929         
0930         <span class="comment">% Delete the old file if it exists</span>
0931         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0932             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0933                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0934                 <span class="string">'already exists. Overwriting file...'</span>});
0935             delete(outfile)
0936         <span class="keyword">end</span>
0937         
0938         <span class="comment">% Push messages to Log Window:</span>
0939         <span class="comment">% ----------------------------</span>
0940         statusLogging(handles.LogWindow, log_text)
0941         
0942         <span class="comment">% Save MCS Summary to an Excel File</span>
0943         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0944         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0945         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0946         waitbar(1/5,hwait)
0947         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
0948             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0949             sout = {guiparams.mat_file};
0950         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0951             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0952             sout = guiparams.data_files';
0953         <span class="keyword">end</span>
0954         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0955         waitbar(2/7,hwait)
0956         sout = {<span class="keyword">...</span>
0957             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0958             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0959             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0960             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0961             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0962             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0963             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0964             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0965             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0966             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0967             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0968             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0969             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0970             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0971             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0972             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0973             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0974             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0975             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0976             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0977             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0978             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0979             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0980             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0981             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0982             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0983             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0984             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0985             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0986             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0987             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0988             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0989             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0990             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0991             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0992             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0993             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0994             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0995             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0996             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0997             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0998             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0999             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1000             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1001             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1002             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1003             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1004             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1005             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1006             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1007             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1008             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1009             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1010             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1011             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1012             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1013             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1014             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1015             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1016             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1017             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1018             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1019             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1020             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1021             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1022             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1023             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1024             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1025             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1026             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1027             };
1028         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1029         waitbar(3/7,hwait)
1030         
1031         <span class="comment">% Save DAV data to an Excel File</span>
1032         vmin = num2str(guiparams.depth_range_min);
1033         vmax = num2str(guiparams.depth_range_max);
1034         pvheaders = {<span class="keyword">...</span>
1035             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1036             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1037             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1038             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1039             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1040             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1041         
1042         <span class="comment">% Create block style matrix of all processed data</span>
1043         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1044         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1045         <span class="comment">% layer-averaging applied</span>
1046         pvdata = [];
1047         
1048         <span class="comment">% Stationing from LEFT bank</span>
1049         Dist = V.mcsDist;
1050         
1051         <span class="comment">% Build bathy data matrix</span>
1052         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1053         
1054         <span class="comment">% Build layer-averaged velocities</span>
1055         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1056         V.mcsX(indx,:) = nan;
1057         V.mcsY(indx,:) = nan;
1058         V.mcsEast(indx,:) = nan;
1059         V.mcsNorth(indx,:) = nan;
1060         pvdata = [<span class="keyword">...</span>
1061             pvdata;<span class="keyword">...</span>
1062             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1063             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1064             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1065             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1066         pvdata(isnan(pvdata)) = -9999;
1067         pvout = num2cell(pvdata');
1068         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1069         timestr = nandatestr(V.mcsTime(1,:));
1070         timestamp = cellstr(timestr);
1071         pvout = horzcat(timestamp,pvout);
1072         pvout = vertcat(pvheaders,pvout);
1073         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1074         waitbar(4/7,hwait)
1075         
1076         <span class="comment">% Save MCS data to an Excel File</span>
1077         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1078         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1079         MCSheaders = {<span class="keyword">...</span>
1080             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1081             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1082             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1083             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1084             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1085             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1086             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1087             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1088             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1089             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1090             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1091             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1092             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1093             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1094             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1095             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1096             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1097         
1098         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1099         MCSdata = [<span class="keyword">...</span>
1100             V.mcsX(:)<span class="keyword">...</span>
1101             V.mcsY(:)<span class="keyword">...</span>
1102             V.mcsDist(:)<span class="keyword">...</span>
1103             vectorized_bed(:)<span class="keyword">...</span>
1104             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1105             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1106             V.mcsEast(:)<span class="keyword">...</span>
1107             V.mcsNorth(:)<span class="keyword">...</span>
1108             V.mcsVert(:)<span class="keyword">...</span>
1109             V.mcsMag(:)<span class="keyword">...</span>
1110             V.mcsDir(:)<span class="keyword">...</span>
1111             V.u(:)<span class="keyword">...</span>
1112             V.v(:)<span class="keyword">...</span>
1113             V.vp(:)<span class="keyword">...</span>
1114             V.vs(:)<span class="keyword">...</span>
1115             V.Roz.up(:)<span class="keyword">...</span>
1116             V.Roz.us(:)];
1117         MCSdata(isnan(MCSdata)) = -9999;
1118         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1119         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1120         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1121         waitbar(5/7,hwait)
1122                 
1123         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1124         <span class="comment">% results</span>
1125         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1126         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1127         PVheaders = {<span class="keyword">...</span>
1128             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1129             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1130             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1131             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1132             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1133             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1134             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1135             <span class="string">'Vel_dir_deg'</span>};
1136         PVtable = [<span class="keyword">...</span>
1137             PVdata.outmat(1,:);<span class="keyword">...</span>
1138             PVdata.outmat(2,:);<span class="keyword">...</span>
1139             PVDist;<span class="keyword">...</span>
1140             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1141             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1142             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1143             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1144         PVtable = (sortrows(PVtable',3))';
1145         PVtable(isnan(PVtable)) = -9999;
1146         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1147         PVout = vertcat(PVheaders,PVout);
1148         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1149         waitbar(6/7,hwait)
1150         
1151         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1152         <span class="comment">% results</span>
1153         <span class="comment">% Distance is from the LEFT bank</span>
1154         <span class="comment">% Doesn't include the reference vector</span>
1155         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1156         dist    = guiparams.mcsQuivers(1:end-1,1);
1157         depth   = guiparams.mcsQuivers(1:end-1,2);
1158         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1159         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1160         
1161         <span class="comment">% Compute an UTM coordinate for the vector</span>
1162         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1163         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1164         
1165         <span class="comment">% Compute a Time for each vector</span>
1166         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1167         
1168         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1169         <span class="keyword">switch</span> guiparams.contour
1170             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1171                 wtp=[<span class="string">'V.uSmooth'</span>];
1172             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1173                 wtp=[<span class="string">'V.vSmooth'</span>];
1174             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1175                 wtp=[<span class="string">'V.wSmooth'</span>];
1176             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1177                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1178             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1179                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1180             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1181                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1182             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1183                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1184             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1185                 wtp=[<span class="string">'V.vpSmooth'</span>];
1186             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1187                 wtp=[<span class="string">'V.vsSmooth'</span>];
1188             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1189                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1190             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1191                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1192             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1193                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1194             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1195                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1196             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1197                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1198             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1199                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1200             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1201                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1202             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1203                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1204             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1205                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1206             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1207                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1208             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1209                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1210         <span class="keyword">end</span>
1211         Ucomp = eval(wtp);
1212         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1213         
1214         <span class="comment">% Save MCS data to an Excel File</span>
1215         <span class="comment">% This includes the smoothed data results from the plots.</span>
1216         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1217         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1218         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1219         mcsheaders = {<span class="keyword">...</span>
1220             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1221             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1222             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1223             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1224             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1225             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1226             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1227             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1228             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1229             };
1230         mcsdata = [<span class="keyword">...</span>
1231             pUTMx(:)<span class="keyword">...</span>
1232             pUTMy(:)<span class="keyword">...</span>
1233             dist(:)<span class="keyword">...</span>
1234             depth(:)<span class="keyword">...</span>
1235             ucomp(:)<span class="keyword">...</span>
1236             vcomp(:)<span class="keyword">...</span>
1237             wcomp(:)];
1238         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1239         ridx = ~isnan(ucomp);
1240         mcsdata = mcsdata(ridx,:);
1241         mcsdata(isnan(mcsdata)) = -9999;
1242         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1243         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1244         waitbar(7/7,hwait)
1245     <span class="keyword">else</span>
1246         <span class="comment">% Return default excel_path and excel_file</span>
1247         excel_path = guiprefs.excel_path;
1248         excel_file = guiprefs.excel_file;
1249         outfile = fullfile(excel_path,excel_file);
1250         log_text = {<span class="string">'User aborted Excel export...'</span>};
1251     <span class="keyword">end</span>
1252     
1253     
1254 waitbar(1,hwait)  
1255 delete(hwait)
1256 <span class="keyword">end</span>
1257 
1258 <span class="comment">% Push messages to Log Window:</span>
1259 <span class="comment">% ----------------------------</span>
1260 statusLogging(handles.LogWindow, log_text)
1261 
1262 <span class="comment">% Store the persistent preferences:</span>
1263 <span class="comment">% ---------------------------------</span>
1264 guiprefs.excel_file = excel_file;
1265 guiprefs.excel_path = excel_path;
1266 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1267 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1268 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1269 
1270 
1271 <span class="comment">% --------------------------------------------------------------------</span>
1272 <a name="_sub27" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1273 <span class="comment">% Call separate GUI</span>
1274 VMT_BuildCustomFlatFile;
1275 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1276 
1277 <span class="comment">% --------------------------------------------------------------------</span>
1278 <a name="_sub28" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1279 <span class="comment">% Empty</span>
1280 
1281 <span class="comment">% --------------------------------------------------------------------</span>
1282 <a name="_sub29" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1283 <span class="comment">% Empty</span>
1284 
1285 <span class="comment">% --------------------------------------------------------------------</span>
1286 <a name="_sub30" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1287 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1288 
1289 <span class="comment">% Get the Application Data:</span>
1290 <span class="comment">% -------------------------</span>
1291 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1292 
1293 <span class="comment">% Update the GUI &amp; Application Data:</span>
1294 <span class="comment">% ----------------------------------</span>
1295 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1296 <span class="keyword">switch</span> status
1297     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1298         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1299         guiparams.unit_discharge_correction = false;
1300     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1301         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1302         guiparams.unit_discharge_correction = true;
1303 <span class="keyword">end</span>
1304 
1305 <span class="comment">% Re-store the Application data:</span>
1306 <span class="comment">% ------------------------------</span>
1307 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1308 
1309 
1310 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1311 
1312 <span class="comment">% --------------------------------------------------------------------</span>
1313 <a name="_sub31" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1314 <span class="comment">% Empty</span>
1315 
1316 <span class="comment">% --------------------------------------------------------------------</span>
1317 <a name="_sub32" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1318 <span class="comment">% Empty</span>
1319 
1320 <span class="comment">% --------------------------------------------------------------------</span>
1321 <a name="_sub33" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1322 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1323 
1324 <span class="comment">% Get the Application Data:</span>
1325 <span class="comment">% -------------------------</span>
1326 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1327 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1328 
1329 <span class="comment">% Update the Application Data:</span>
1330 <span class="comment">% ----------------------------</span>
1331 guiparams.english_units = false;
1332 guiprefs.units = <span class="string">'metric'</span>;
1333 
1334 <span class="comment">% Re-store the Application data:</span>
1335 <span class="comment">% ------------------------------</span>
1336 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1337 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1338 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1339 
1340 <span class="comment">% Update the GUI:</span>
1341 <span class="comment">% ---------------</span>
1342 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1343 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1344 
1345 <span class="comment">% [EOF] menuMetric_Callback</span>
1346 
1347 
1348 <span class="comment">% --------------------------------------------------------------------</span>
1349 <a name="_sub34" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1350 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1351 
1352 <span class="comment">% Get the Application Data:</span>
1353 <span class="comment">% -------------------------</span>
1354 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1355 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1356 
1357 <span class="comment">% Update the Application Data:</span>
1358 <span class="comment">% ----------------------------</span>
1359 guiparams.english_units = true;
1360 guiprefs.units = <span class="string">'english'</span>;
1361 
1362 <span class="comment">% Re-store the Application data:</span>
1363 <span class="comment">% ------------------------------</span>
1364 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1365 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1366 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1367 
1368 <span class="comment">% Update the GUI:</span>
1369 <span class="comment">% ---------------</span>
1370 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1371 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1372 
1373 <span class="comment">% [EOF] menuEnglish_Callback</span>
1374 
1375 <span class="comment">% --------------------------------------------------------------------</span>
1376 <a name="_sub35" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1377 <span class="comment">% Empty</span>
1378 
1379 <span class="comment">% --------------------------------------------------------------------</span>
1380 <a name="_sub36" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1381 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1382 <span class="comment">% surface)</span>
1383 
1384 <span class="comment">% Get the Application Data:</span>
1385 <span class="comment">% -------------------------</span>
1386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1387 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1388 
1389 <span class="comment">% Update the Application Data:</span>
1390 <span class="comment">% ----------------------------</span>
1391 guiparams.plotref = <span class="string">'dfs'</span>;
1392 guiprefs.plotref  = <span class="string">'dfs'</span>;
1393 
1394 <span class="comment">% Re-store the Application data:</span>
1395 <span class="comment">% ------------------------------</span>
1396 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1397 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1398 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1399 
1400 <span class="comment">% Update the GUI:</span>
1401 <span class="comment">% ---------------</span>
1402 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1403 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1404 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1405 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1406 
1407 <span class="comment">% --------------------------------------------------------------------</span>
1408 <a name="_sub37" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1409 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1410 
1411 <span class="comment">% Get the Application Data:</span>
1412 <span class="comment">% -------------------------</span>
1413 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1414 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1415 
1416 <span class="comment">% Update the Application Data:</span>
1417 <span class="comment">% ----------------------------</span>
1418 guiparams.plotref = <span class="string">'hab'</span>;
1419 guiprefs.plotref  = <span class="string">'hab'</span>;
1420 
1421 <span class="comment">% % Prompt and set eta</span>
1422 <span class="comment">% % ------------------</span>
1423 <span class="comment">% prompt = 'Enter elevation of the bottom (eta), in meters:';</span>
1424 <span class="comment">% dlg_title = 'Set bottom elevation for height above bottom reference';</span>
1425 <span class="comment">% num_lines = 1;</span>
1426 <span class="comment">% def = {num2str(guiparams.eta)};</span>
1427 <span class="comment">% guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));</span>
1428 
1429 
1430 <span class="comment">% Re-store the Application data:</span>
1431 <span class="comment">% ------------------------------</span>
1432 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1433 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1434 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1435 
1436 <span class="comment">% Update the GUI:</span>
1437 <span class="comment">% ---------------</span>
1438 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1439 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1440 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1441 
1442 
1443 
1444 
1445 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1446 
1447 <span class="comment">% --------------------------------------------------------------------</span>
1448 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1449 <span class="comment">% Empty</span>
1450 
1451 <span class="comment">% --------------------------------------------------------------------</span>
1452 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1453 <span class="comment">% Set cross-section endpoints automatically</span>
1454 
1455 <span class="comment">% Get the Application Data:</span>
1456 <span class="comment">% -------------------------</span>
1457 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1458 
1459 <span class="comment">% Update the Application Data:</span>
1460 <span class="comment">% ----------------------------</span>
1461 guiparams.set_cross_section_endpoints = false;
1462 
1463 <span class="comment">% Re-store the Application data:</span>
1464 <span class="comment">% ------------------------------</span>
1465 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1466 
1467 <span class="comment">% Update the GUI:</span>
1468 <span class="comment">% ---------------</span>
1469 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1470 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1471 
1472 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1473 
1474 
1475 <span class="comment">% --------------------------------------------------------------------</span>
1476 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1477 <span class="comment">% Set cross-section endpoints manually</span>
1478 
1479 <span class="comment">% Get the Application Data:</span>
1480 <span class="comment">% -------------------------</span>
1481 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1482 
1483 <span class="comment">% Update the Application Data:</span>
1484 <span class="comment">% ----------------------------</span>
1485 guiparams.set_cross_section_endpoints = true;
1486 
1487 <span class="comment">% Re-store the Application data:</span>
1488 <span class="comment">% ------------------------------</span>
1489 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1490 
1491 <span class="comment">% Update the GUI:</span>
1492 <span class="comment">% ---------------</span>
1493 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1494 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1495 
1496 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1497 
1498 
1499 
1500 
1501 <span class="comment">% --------------------------------------------------------------------</span>
1502 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1503 <span class="comment">% Empty</span>
1504 
1505 <span class="comment">% --------------------------------------------------------------------</span>
1506 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1507 
1508 <span class="comment">% Get the Application Data:</span>
1509 <span class="comment">% -------------------------</span>
1510 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1511 
1512 <span class="comment">% Update the Application Data:</span>
1513 <span class="comment">% ----------------------------</span>
1514 guiparams.print        = true;
1515 guiparams.presentation = false;
1516 
1517 <span class="comment">% Re-store the Application data:</span>
1518 <span class="comment">% ------------------------------</span>
1519 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1520 
1521 <span class="comment">% Update the GUI:</span>
1522 <span class="comment">% ---------------</span>
1523 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1524 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1525 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1526 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1527 
1528 <span class="comment">% Modify the existing figures</span>
1529 <span class="comment">% ---------------------------</span>
1530 <span class="comment">% Find what plots exist already</span>
1531 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1532 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1533 
1534 <span class="comment">% Defaults for Print Stlye Figure</span>
1535 BkgdColor   = <span class="string">'white'</span>;
1536 AxColor     = <span class="string">'black'</span>;
1537 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1538 FntSize     = 14;
1539 
1540 <span class="comment">% Loop through valid figures and adjust</span>
1541 <span class="comment">% -------------------------------------</span>
1542 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1543     
1544     <span class="keyword">for</span> i = 1:length(valid_names)
1545         <span class="keyword">switch</span> valid_names{i}
1546             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1547                 <span class="comment">% Focus the figure</span>
1548                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1549                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1550                     figure(hff)
1551                     
1552                     <span class="comment">% Make the changes to figure</span>
1553                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1554                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1555                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1556                     set(gca,<span class="string">'Color'</span>,FigColor)
1557                     set(gca,<span class="string">'XColor'</span>,AxColor)
1558                     set(gca,<span class="string">'YColor'</span>,AxColor)
1559                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1560                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1561                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1562                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1563                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1564                         <span class="string">'YColor'</span>,AxColor);
1565                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1566                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1567                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1568                     
1569                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1570                     <span class="comment">% the file(s) and path for the data</span>
1571                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1572                     <span class="keyword">if</span> ~ismultiplot
1573                         filestr = guiparams.savefile;
1574                         wd = length(filestr);
1575                         hd = 1;
1576                     <span class="keyword">else</span>
1577                         <span class="comment">% Construct a filename</span>
1578                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1579                         wd        = max(cellfun(@length,filestr));
1580                         hd        = numel(filestr);
1581                             
1582                     <span class="keyword">end</span>
1583                     
1584                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1585                     disableMenuBar(hff)
1586                     set(fileinfotxt,<span class="keyword">...</span>
1587                         <span class="string">'string'</span>,filestr)
1588                     set(fileinfotxt,<span class="keyword">...</span>
1589                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1590                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1591                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1592                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1593                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1594                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1595                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1596                     
1597                 <span class="keyword">end</span>
1598             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1599                 <span class="comment">% Focus the figure</span>
1600                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1601                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1602                     figure(hff)
1603                     
1604                     <span class="comment">% Make the changes to figure</span>
1605                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1606                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1607                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1608                     set(gca,<span class="string">'Color'</span>,FigColor)
1609                     set(gca,<span class="string">'XColor'</span>,AxColor)
1610                     set(gca,<span class="string">'YColor'</span>,AxColor)
1611                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1612                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1613                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1614                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1615                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1616                         <span class="string">'YColor'</span>,AxColor);
1617                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1618                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1619                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1620                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1621                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1622                     
1623                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1624                     <span class="comment">% the file(s) and path for the data</span>
1625                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1626                     <span class="keyword">if</span> ~ismultiplot
1627                         filestr = guiparams.savefile;
1628                         wd = length(filestr);
1629                         hd = 1;
1630                     <span class="keyword">else</span>
1631                         <span class="comment">% Construct a filename</span>
1632                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1633                         wd        = max(cellfun(@length,filestr));
1634                         hd        = numel(filestr);
1635                             
1636                     <span class="keyword">end</span>
1637                     
1638                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1639                     disableMenuBar(hff)
1640                     set(fileinfotxt,<span class="keyword">...</span>
1641                         <span class="string">'string'</span>,filestr)
1642                     set(fileinfotxt,<span class="keyword">...</span>
1643                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1644                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1645                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1646                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1647                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1648                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1649                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1650                 <span class="keyword">end</span>
1651             <span class="keyword">otherwise</span>
1652         <span class="keyword">end</span>
1653     <span class="keyword">end</span>
1654     
1655     
1656 <span class="keyword">end</span>
1657 
1658 
1659 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1660 
1661 
1662 <span class="comment">% --------------------------------------------------------------------</span>
1663 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1664 <span class="comment">% Get the Application Data:</span>
1665 <span class="comment">% -------------------------</span>
1666 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1667 
1668 <span class="comment">% Update the Application Data:</span>
1669 <span class="comment">% ----------------------------</span>
1670 guiparams.print        = false;
1671 guiparams.presentation = true;
1672 
1673 <span class="comment">% Re-store the Application data:</span>
1674 <span class="comment">% ------------------------------</span>
1675 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1676 
1677 <span class="comment">% Update the GUI:</span>
1678 <span class="comment">% ---------------</span>
1679 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1680 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1681 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1682 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1683 
1684 <span class="comment">% Modify the existing figures</span>
1685 <span class="comment">% ---------------------------</span>
1686 <span class="comment">% Find what plots exist already</span>
1687 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1688 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1689 
1690 <span class="comment">% Defaults for Presentation Style Figure</span>
1691 <span class="comment">% --------------------------------------</span>
1692 BkgdColor   = <span class="string">'black'</span>;
1693 AxColor     = <span class="string">'white'</span>;
1694 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1695 FntSize     = 14;
1696 
1697 <span class="comment">% Loop through valid figures and adjust</span>
1698 <span class="comment">% -------------------------------------</span>
1699 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1700     
1701     <span class="keyword">for</span> i = 1:length(valid_names)
1702         <span class="keyword">switch</span> valid_names{i}
1703             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1704                 <span class="comment">% Focus the figure</span>
1705                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1706                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1707                     figure(hff)
1708                     
1709                     <span class="comment">% Make the changes to figure</span>
1710                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1711                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1712                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1713                     set(gca,<span class="string">'Color'</span>,FigColor)
1714                     set(gca,<span class="string">'XColor'</span>,AxColor)
1715                     set(gca,<span class="string">'YColor'</span>,AxColor)
1716                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1717                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1718                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1719                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1720                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1721                         <span class="string">'YColor'</span>,AxColor);
1722                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1723                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1724                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1725                     
1726                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1727                     <span class="comment">% the file(s) and path for the data</span>
1728                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1729                     <span class="keyword">if</span> ~ismultiplot
1730                         filestr = guiparams.savefile;
1731                         wd = length(filestr);
1732                         hd = 1;
1733                     <span class="keyword">else</span>
1734                         <span class="comment">% Construct a filename</span>
1735                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1736                         wd        = max(cellfun(@length,filestr));
1737                         hd        = numel(filestr);
1738                             
1739                     <span class="keyword">end</span>
1740                     
1741                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1742                     disableMenuBar(hff)
1743                     set(fileinfotxt,<span class="keyword">...</span>
1744                         <span class="string">'string'</span>,filestr)
1745                     set(fileinfotxt,<span class="keyword">...</span>
1746                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1747                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1748                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1749                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1750                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1751                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1752                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1753                     
1754                 <span class="keyword">end</span>
1755             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1756                 <span class="comment">% Focus the figure</span>
1757                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1758                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1759                     figure(hff)
1760                     
1761                     <span class="comment">% Make the changes to figure</span>
1762                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1763                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1764                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1765                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1766                     set(gca,<span class="string">'XColor'</span>,AxColor)
1767                     set(gca,<span class="string">'YColor'</span>,AxColor)
1768                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1769                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1770                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1771                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1772                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1773                         <span class="string">'YColor'</span>,AxColor);
1774                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1775                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1776                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1777                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1778                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1779                     
1780                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1781                     <span class="comment">% the file(s) and path for the data</span>
1782                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1783                     <span class="keyword">if</span> ~ismultiplot
1784                         filestr = guiparams.savefile;
1785                         wd = length(filestr);
1786                         hd = 1;
1787                     <span class="keyword">else</span>
1788                         <span class="comment">% Construct a filename</span>
1789                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1790                         wd        = max(cellfun(@length,filestr));
1791                         hd        = numel(filestr);
1792                             
1793                     <span class="keyword">end</span>
1794                     
1795                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1796                     disableMenuBar(hff)
1797                     set(fileinfotxt,<span class="keyword">...</span>
1798                         <span class="string">'string'</span>,filestr)
1799                     set(fileinfotxt,<span class="keyword">...</span>
1800                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1801                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1802                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1803                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1804                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1805                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1806                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1807                 <span class="keyword">end</span>
1808             <span class="keyword">otherwise</span>
1809         <span class="keyword">end</span>
1810     <span class="keyword">end</span>
1811     
1812     
1813 <span class="keyword">end</span>
1814 
1815 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1816 
1817 <span class="comment">% --------------------------------------------------------------------</span>
1818 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1819 <span class="comment">%</span>
1820 <span class="comment">% % Get the Application data:</span>
1821 <span class="comment">% % -------------------------</span>
1822 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1823 <span class="comment">%</span>
1824 <span class="comment">% % Initialize the answer:</span>
1825 <span class="comment">% % ----------------------</span>
1826 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1827 <span class="comment">% answer = NaN;</span>
1828 <span class="comment">% while isnan(answer)</span>
1829 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1830 <span class="comment">%</span>
1831 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1832 <span class="comment">%         return</span>
1833 <span class="comment">%     end</span>
1834 <span class="comment">%</span>
1835 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1836 <span class="comment">%     % A numeric char will be a double</span>
1837 <span class="comment">% end</span>
1838 <span class="comment">%</span>
1839 <span class="comment">% % Re-store the Application data:</span>
1840 <span class="comment">% % ------------------------------</span>
1841 <span class="comment">% guiparams.vertical_offset = answer;</span>
1842 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1843 <span class="comment">%</span>
1844 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1845 
1846 <span class="comment">% --------------------------------------------------------------------</span>
1847 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1848 <span class="comment">% Not implemented</span>
1849 
1850 <span class="comment">% --------------------------------------------------------------------</span>
1851 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1852 <span class="comment">% Empty</span>
1853 
1854 <span class="comment">% --------------------------------------------------------------------</span>
1855 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1856 ASCII2GIS_GUI
1857 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1858 
1859 <span class="comment">% --------------------------------------------------------------------</span>
1860 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1861 
1862 <span class="comment">% Get the Application preferences:</span>
1863 <span class="comment">% --------------------------------</span>
1864 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1865 
1866 inpath = guiprefs.kmz_path;
1867 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1868     infile = guiprefs.kmz_file{1};
1869 <span class="keyword">else</span>
1870     infile = guiprefs.kmz_file;
1871 <span class="keyword">end</span>
1872 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1873 
1874 guiprefs.kmz_path = outpath;
1875 guiprefs.kmz_file = outfile;
1876 
1877 <span class="comment">% Update persistent preferences</span>
1878 <span class="comment">% -----------------------------</span>
1879 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1880 
1881 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1882 
1883 <span class="comment">% --------------------------------------------------------------------</span>
1884 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1885 <span class="comment">% Get the Application preferences:</span>
1886 <span class="comment">% --------------------------------</span>
1887 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1888 
1889 VMT_BatchMode;
1890 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1891 
1892 <span class="comment">% --------------------------------------------------------------------</span>
1893 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1894 <span class="comment">% Empty</span>
1895 
1896 <span class="comment">% --------------------------------------------------------------------</span>
1897 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1898 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1899 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1900     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1901     
1902 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1903     
1904     <span class="keyword">if</span> isdeployed
1905         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1906             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1907         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1908             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1909             errLogFileName},<span class="keyword">...</span>
1910             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1911             <span class="string">'error'</span>);
1912         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1913         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1914         fclose(fid);
1915         rethrow(err)
1916     <span class="keyword">else</span>
1917         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1918             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1919             <span class="string">'error'</span>);
1920         rethrow(err);
1921     <span class="keyword">end</span>
1922 <span class="keyword">end</span>
1923 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1924 
1925 <span class="comment">% --------------------------------------------------------------------</span>
1926 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1927 <span class="comment">% Get the Application data:</span>
1928 <span class="comment">% -------------------------</span>
1929 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1930 
1931 <span class="keyword">try</span>
1932     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1933 
1934 
1935 <span class="comment">% This catch is probably not necessary.</span>
1936 <span class="keyword">catch</span> err 
1937     <span class="keyword">if</span> isdeployed
1938         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1939             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1940         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1941             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1942             errLogFileName},<span class="keyword">...</span>
1943             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1944             <span class="string">'error'</span>);
1945         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1946         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1947         fclose(fid);
1948         rethrow(err)
1949     <span class="keyword">else</span>
1950         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1951             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1952             <span class="string">'error'</span>);
1953         rethrow(err);
1954     <span class="keyword">end</span>
1955 <span class="keyword">end</span>
1956 
1957 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1958 
1959 <span class="comment">% --------------------------------------------------------------------</span>
1960 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1961 
1962 <span class="comment">% Get the Application data:</span>
1963 <span class="comment">% -------------------------</span>
1964 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1965 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1966 
1967 <span class="comment">% Check version tag against the web, and display a message</span>
1968 <span class="keyword">try</span>
1969     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1970     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1971     <span class="keyword">if</span> length(webdata) &gt; 5
1972         current_vmt_version{1} = webdata(1:5);
1973         current_vmt_version{2} = webdata(8:16);
1974     <span class="keyword">else</span>
1975         current_vmt_version = webdata;
1976     <span class="keyword">end</span>
1977     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1978 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1979     <span class="keyword">if</span> isdeployed
1980         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1981             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1982         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1983             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1984             errLogFileName},<span class="keyword">...</span>
1985             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1986             <span class="string">'error'</span>);
1987         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1988         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1989         fclose(fid);
1990         rethrow(err)
1991     <span class="keyword">else</span>
1992         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1993             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1994             <span class="string">'error'</span>);
1995         rethrow(err);
1996     <span class="keyword">end</span>
1997 <span class="keyword">end</span>
1998 
1999 <span class="keyword">if</span> ischar(current_vmt_version)
2000     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2001         h = msgbox(<span class="keyword">...</span>
2002             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2003             <span class="string">''</span>;<span class="keyword">...</span>
2004             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2005             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2006     <span class="keyword">else</span>
2007         h = msgbox(<span class="keyword">...</span>
2008             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2009             <span class="string">''</span>;<span class="keyword">...</span>
2010             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2011             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2012     <span class="keyword">end</span>
2013 <span class="keyword">elseif</span> iscell(current_vmt_version)
2014     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2015         h = msgbox(<span class="keyword">...</span>
2016             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2017             <span class="string">''</span>;<span class="keyword">...</span>
2018             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2019             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2020     <span class="keyword">else</span>
2021         h = msgbox(<span class="keyword">...</span>
2022             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2023             <span class="string">''</span>;<span class="keyword">...</span>
2024             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2025             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2026     <span class="keyword">end</span>
2027 <span class="keyword">end</span>
2028 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2029 
2030 <span class="comment">% --------------------------------------------------------------------</span>
2031 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2032 
2033 <span class="comment">% Get the Application data:</span>
2034 <span class="comment">% -------------------------</span>
2035 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2036 messagestr = <span class="keyword">...</span>
2037     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2038     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2039     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2040     <span class="string">''</span>;<span class="keyword">...</span>
2041     <span class="string">''</span>;<span class="keyword">...</span>
2042     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2043     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2044     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2045     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2046     <span class="string">''</span>;<span class="keyword">...</span>
2047     <span class="string">''</span>;<span class="keyword">...</span>
2048     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2049     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2050     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2051     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2052     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2053     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2054     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2055 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2056 <span class="comment">% [EOF] menuAbout_Callback</span>
2057 
2058 
2059 
2060 
2061 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2062 <span class="comment">% TOOLBAR CALLBACKS %</span>
2063 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2064 
2065 <span class="comment">% --------------------------------------------------------------------</span>
2066 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2067 <span class="comment">% Read Files into Data Structure using tfile.</span>
2068 
2069 <span class="comment">% Get the Application data:</span>
2070 <span class="comment">% -------------------------</span>
2071 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2072 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2073 
2074 <span class="comment">% Ask the user to select files:</span>
2075 <span class="comment">% -----------------------------</span>
2076 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2077 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2078     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2079     current_file, <span class="keyword">...</span>
2080     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2081 
2082 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2083     guiparams.data_folder = pathname;
2084     <span class="keyword">if</span> ischar(filename)
2085         filename = {filename};
2086     <span class="keyword">end</span>
2087     guiparams.data_files = filename;
2088     guiparams.mat_file = <span class="string">''</span>;
2089     
2090     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2091     
2092    
2093     
2094     <span class="comment">% Update the preferences:</span>
2095     <span class="comment">% -----------------------</span>
2096     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2097     guiprefs.ascii_path = pathname;
2098     guiprefs.ascii_file = filename;
2099     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2100     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2101     
2102     <span class="comment">% Push messages to Log Window:</span>
2103     <span class="comment">% ----------------------------</span>
2104     log_text = {<span class="keyword">...</span>
2105         <span class="string">''</span>;<span class="keyword">...</span>
2106         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2107         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2108         guiparams.data_folder;
2109         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2110         char(filename)};
2111     statusLogging(handles.LogWindow, log_text)
2112     
2113     <span class="comment">% Read the file(s)</span>
2114     <span class="comment">% ----------------</span>
2115     [~,~,savefile,A,z] = <span class="keyword">...</span>
2116         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2117     guiparams.savefile = savefile;
2118     guiparams.A        = A;
2119     guiparams.z        = z;
2120     
2121     
2122     <span class="comment">% Set the vertical grid node spacing</span>
2123     <span class="comment">% ----------------------------------</span>
2124     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2125     <span class="comment">% Backwards compatible</span>
2126     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2127         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2128         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2129     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2130         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2131         guiparams.vertical_grid_node_spacing = 0.4;
2132     <span class="keyword">end</span>
2133     
2134     
2135     <span class="comment">% Save application data</span>
2136     <span class="comment">% ---------------------</span>
2137     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2138        
2139 <span class="comment">%</span>
2140 <span class="comment">%     % Preprocess the data:</span>
2141 <span class="comment">%     % --------------------</span>
2142 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2143 <span class="comment">%</span>
2144 <span class="comment">%     % Push messages to Log Window:</span>
2145 <span class="comment">%     % ----------------------------</span>
2146 <span class="comment">%     log_text = {...</span>
2147 <span class="comment">%         '   Preprocessing complete.';...</span>
2148 <span class="comment">%         '   Begin Data Processing...'};</span>
2149 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2150 <span class="comment">%</span>
2151 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2152 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2153 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2154 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2155 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2156 <span class="comment">%</span>
2157 <span class="comment">%     % Push messages to Log Window:</span>
2158 <span class="comment">%     % ----------------------------</span>
2159 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2160 <span class="comment">%</span>
2161 <span class="comment">%     % Store the data:</span>
2162 <span class="comment">%     % ---------------</span>
2163 <span class="comment">%     guiparams.z = z;</span>
2164 <span class="comment">%     guiparams.A = A;</span>
2165 <span class="comment">%     guiparams.V = V;</span>
2166 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2167     
2168           
2169     <span class="comment">% Update the GUI:</span>
2170     <span class="comment">% ---------------</span>
2171     <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2172     
2173     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2174     
2175 <span class="keyword">end</span>
2176 <span class="comment">% [EOF] loadDataCallback</span>
2177 
2178 
2179 
2180 <span class="comment">% --------------------------------------------------------------------</span>
2181 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2182 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2183 
2184 <span class="comment">% Get the Application data:</span>
2185 <span class="comment">% -------------------------</span>
2186 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2187 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2188 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2189 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2190 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2191 
2192 [the_file,the_path] = <span class="keyword">...</span>
2193     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2194     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2195     fullfile(guiparams.mat_path,guiparams.savefile));
2196 
2197 <span class="comment">% Save the processed data to a MAT file:</span>
2198 <span class="comment">% --------------------------------------</span>
2199 <span class="keyword">if</span> ischar(the_file)
2200     guiparams.mat_path = the_path;
2201     guiparams.mat_file = the_file;
2202     guiparams.savefile = the_file;
2203     
2204     <span class="comment">% Re-store the Application data:</span>
2205     <span class="comment">% ------------------------------</span>
2206     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2207     
2208     <span class="comment">% Update the preferences:</span>
2209     <span class="comment">% -----------------------</span>
2210     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2211     guiprefs.mat_path = the_path;
2212     guiprefs.mat_file = the_file;
2213     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2214     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2215     
2216     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2217     savefile = fullfile(pathstr,[filename extension]);
2218     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2219     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2220     log_text = {<span class="keyword">...</span>
2221         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2222         savefile};
2223     statusLogging(handles.LogWindow,log_text)
2224     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2225 <span class="keyword">end</span>
2226 
2227 <span class="comment">% [EOF] saveDataCallback</span>
2228 
2229 
2230 <span class="comment">% --------------------------------------------------------------------</span>
2231 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2232 
2233 <span class="comment">% Get the Application data:</span>
2234 <span class="comment">% -------------------------</span>
2235 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2236 z   = guiparams.z;
2237 A   = guiparams.A;
2238 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2239 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2240 
2241 <span class="comment">% Compute multibeam bathymetry:</span>
2242 <span class="comment">% -----------------------------</span>
2243 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2244 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2245 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2246     guiparams.beam_angle, <span class="keyword">...</span>
2247     guiparams.magnetic_variation, <span class="keyword">...</span>
2248     guiparams.water_surface_elevation, <span class="keyword">...</span>
2249     guiparams.output_auxiliary_data);
2250 
2251 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2252 
2253 <span class="comment">% [EOF] saveBathymetryCallback</span>
2254 
2255 <span class="comment">% --------------------------------------------------------------------</span>
2256 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2257 
2258 <span class="comment">% Get the Application data:</span>
2259 <span class="comment">% -------------------------</span>
2260 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2261 
2262 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2263     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2264     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2265     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2266     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2267     handles.figure1);
2268 
2269 <span class="comment">% Update the GUI:</span>
2270 <span class="comment">% ---------------</span>
2271 <span class="keyword">if</span> guiparams.english_units
2272     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2273     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2274 <span class="keyword">else</span>
2275     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2276     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2277 <span class="keyword">end</span>
2278 
2279 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2280     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2281     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2282 <span class="keyword">else</span>
2283     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2284     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2285 <span class="keyword">end</span>
2286 
2287 <span class="keyword">if</span> guiparams.presentation
2288     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2289 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2290 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2291 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2292 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2293 <span class="keyword">else</span>
2294     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2295 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2296 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2297 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2298 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2299 <span class="keyword">end</span>
2300 
2301 <span class="comment">% Re-store the Application data:</span>
2302 <span class="comment">% ------------------------------</span>
2303 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2304 
2305 <span class="comment">% [EOF] plottingParametersCallback</span>
2306 
2307 
2308 <span class="comment">% --------------------------------------------------------------------</span>
2309 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2310 
2311 <span class="comment">% Get the Application data:</span>
2312 <span class="comment">% -------------------------</span>
2313 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2314 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2315 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2316 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2317 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2318 
2319 <span class="comment">% [EOF] processingParametersCallback</span>
2320 
2321 
2322 <span class="comment">% --------------------------------------------------------------------</span>
2323 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2324 <span class="comment">% Plot 1</span>
2325 
2326 <span class="comment">% Get the Application data:</span>
2327 <span class="comment">% -------------------------</span>
2328 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2329 z = guiparams.z;
2330 A = guiparams.A;
2331 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2332 <span class="comment">% Map = guiparams.Map;</span>
2333 
2334 
2335 <span class="comment">% Preprocess the data:</span>
2336 <span class="comment">% --------------------</span>
2337 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2338 
2339 <span class="comment">% Push messages to Log Window:</span>
2340 <span class="comment">% ----------------------------</span>
2341 log_text = {<span class="keyword">...</span>
2342     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2343     <span class="string">'   Begin Data Processing...'</span>};
2344 statusLogging(handles.LogWindow, log_text)
2345 
2346 <span class="comment">% Process the transects:</span>
2347 <span class="comment">% ----------------------</span>
2348 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2349 A(1).vgns = guiparams.vertical_grid_node_spacing;
2350 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2351 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2352     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2353 
2354 <span class="comment">% Compute the smoothed variables</span>
2355 <span class="comment">% ------------------------------</span>
2356 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2357 <span class="comment">% runtime.</span>
2358 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2359     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2360     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2361     guiparams.vertical_smoothing_window);
2362 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2363 
2364 <span class="comment">% Push messages to Log Window:</span>
2365 <span class="comment">% ----------------------------</span>
2366 statusLogging(handles.LogWindow, processing_log_text)
2367 
2368 <span class="comment">% Store the data:</span>
2369 <span class="comment">% ---------------</span>
2370 guiparams.z = z;
2371 guiparams.A = A;
2372 guiparams.V = V;
2373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2374 
2375 <span class="comment">% Push messages to Log Window:</span>
2376 <span class="comment">% ----------------------------</span>
2377 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2378 statusLogging(handles.LogWindow, log_text)
2379 
2380 <span class="comment">% Create or replot the Shiptracks</span>
2381 <span class="comment">% -------------------------------</span>
2382 <span class="comment">% Grab the axes to the plot</span>
2383 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2384 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2385 
2386 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2387 <span class="comment">% New plot display window</span>
2388 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2389 <span class="comment">% h = figure(1); clf</span>
2390 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2391 
2392 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2393 
2394 
2395 <span class="comment">% --------------------------------------------------------------------</span>
2396 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2397 <span class="comment">% Plot 2</span>
2398 
2399 <span class="comment">% Get the Application data:</span>
2400 <span class="comment">% -------------------------</span>
2401 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2402 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2403 
2404 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2405     <span class="comment">% Push messages to Log Window:</span>
2406     <span class="comment">% ----------------------------</span>
2407     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2408     statusLogging(handles.LogWindow, log_text)
2409     
2410        
2411     <span class="comment">% Push plotting parameters to log window:</span>
2412     <span class="comment">% ---------------------------------------</span>
2413     log_text = {<span class="keyword">...</span>
2414         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2415         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2416         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2417         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2418         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2419         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2420         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2421         };
2422     statusLogging(handles.LogWindow, log_text)
2423     
2424     <span class="comment">% Plot the data:</span>
2425     <span class="comment">% --------------</span>
2426     z = [];
2427     A = [];
2428     V = [];
2429     Map = [];
2430     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2431     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2432         depth_range, <span class="keyword">...</span>
2433         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2434         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2435         guiparams.smoothing_window_size, <span class="keyword">...</span>
2436         guiparams.display_shoreline, <span class="keyword">...</span>
2437         guiparams.english_units, <span class="keyword">...</span>
2438         guiparams.mat_file, <span class="keyword">...</span>
2439         guiparams.mat_path, <span class="keyword">...</span>
2440         guiparams.plotref); <span class="comment">% PLOT2</span>
2441     statusLogging(handles.LogWindow, log_text)
2442     
2443     <span class="comment">% Plot a Shoreline Map:</span>
2444     <span class="comment">% ---------------------</span>
2445     <span class="keyword">if</span> guiparams.display_shoreline
2446         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2447             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2448             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2449             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2450         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2451             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2452             Map.UTMe   = mapdata(:,1);
2453             Map.UTMn   = mapdata(:,2);
2454             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2455             <span class="comment">%Map.UTMzone = zone;</span>
2456         <span class="keyword">else</span>
2457             Map = [];
2458         <span class="keyword">end</span>
2459         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2460         log_text = {<span class="keyword">...</span>
2461             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2462             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2463             };
2464         statusLogging(handles.LogWindow, log_text)
2465     <span class="keyword">else</span>
2466         Map = [];
2467     <span class="keyword">end</span>
2468     
2469 <span class="keyword">else</span>
2470     z = guiparams.z;
2471     A = guiparams.A;
2472     <span class="comment">% V = guiparams.V;</span>
2473     Map = guiparams.Map;
2474     
2475     <span class="comment">% Push messages to Log Window:</span>
2476     <span class="comment">% ----------------------------</span>
2477     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2478     statusLogging(handles.LogWindow, log_text)
2479     
2480         
2481     <span class="comment">% Preprocess the data:</span>
2482     <span class="comment">% --------------------</span>
2483     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2484     
2485     <span class="comment">% Process the transects:</span>
2486     <span class="comment">% ----------------------</span>
2487     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2488     A(1).vgns = guiparams.vertical_grid_node_spacing;
2489     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2490     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2491         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2492     
2493     <span class="comment">% Compute the smoothed variables</span>
2494     <span class="comment">% ------------------------------</span>
2495     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2496     <span class="comment">% runtime.</span>
2497     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2498         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2499         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2500         guiparams.vertical_smoothing_window);
2501     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2502     
2503     <span class="comment">% Push messages to Log Window:</span>
2504     <span class="comment">% ----------------------------</span>
2505     statusLogging(handles.LogWindow, processing_log_text)
2506     
2507     <span class="comment">% Plot the cross section:</span>
2508     <span class="comment">% -----------------------</span>
2509     log_text = {<span class="keyword">...</span>
2510         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2511         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2512         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2513         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2514         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2515         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2516         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2517         };
2518     statusLogging(handles.LogWindow, log_text)
2519     
2520     <span class="comment">% Plot the data:</span>
2521     <span class="comment">% --------------</span>
2522     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2523     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2524     
2525     
2526     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2527         depth_range, <span class="keyword">...</span>
2528         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2529         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2530         guiparams.smoothing_window_size, <span class="keyword">...</span>
2531         guiparams.display_shoreline, <span class="keyword">...</span>
2532         guiparams.english_units, <span class="keyword">...</span>
2533         guiparams.mat_file, <span class="keyword">...</span>
2534         guiparams.mat_path, <span class="keyword">...</span>
2535         guiparams.plotref); <span class="comment">% PLOT2</span>
2536     statusLogging(handles.LogWindow, log_text)
2537     
2538     <span class="comment">% Plot User Set Endpoints</span>
2539     <span class="comment">% -----------------------</span>
2540     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2541         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2542         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2543         x = data(:,1);
2544         y = data(:,2);
2545         
2546         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2547         figure(fh); hold on
2548         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2549         hold off
2550     <span class="keyword">end</span>
2551     
2552     <span class="comment">% Plot a Shoreline Map:</span>
2553     <span class="comment">% ---------------------</span>
2554     <span class="keyword">if</span> guiparams.display_shoreline
2555         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2556             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2557             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2558             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2559         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2560             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2561             Map.UTMe   = mapdata(:,1);
2562             Map.UTMn   = mapdata(:,2);
2563             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2564             <span class="comment">%Map.UTMzone = zone;</span>
2565         <span class="keyword">else</span>
2566             Map = [];
2567         <span class="keyword">end</span>
2568         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2569         log_text = {<span class="keyword">...</span>
2570             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2571             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2572             };
2573         statusLogging(handles.LogWindow, log_text)
2574     <span class="keyword">else</span>
2575         Map = [];
2576     <span class="keyword">end</span>
2577     
2578 <span class="keyword">end</span>
2579 
2580 <span class="keyword">if</span> guiparams.add_background
2581     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2582     statusLogging(handles.LogWindow, log_text)
2583 <span class="keyword">end</span>
2584 
2585 <span class="comment">% Update guiparams</span>
2586 <span class="comment">% ----------------</span>
2587 guiparams.z   = z;
2588 guiparams.A   = A;
2589 guiparams.V   = V;
2590 guiparams.Map = Map;
2591 guiparams.iric_anv_planview_data = PVdata;
2592 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2593 
2594 <span class="comment">% Update preferences</span>
2595 <span class="comment">% ------------------</span>
2596 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2597 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2598 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2599 
2600 <span class="comment">% Force plot to be formated properly</span>
2601 <span class="comment">% ----------------------------------</span>
2602 <span class="keyword">if</span> guiparams.presentation
2603     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2604 <span class="keyword">else</span>
2605     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2606 <span class="keyword">end</span>
2607 <span class="keyword">switch</span> guiparams.renderer
2608     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2609         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2610     <span class="keyword">case</span> <span class="string">'painters'</span>
2611         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2612     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2613         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2614 <span class="keyword">end</span>
2615 
2616 <span class="comment">% Focus the figure</span>
2617 <span class="comment">% ----------------</span>
2618 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2619 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2620     figure(hff)
2621 <span class="keyword">end</span>
2622 
2623 <span class="comment">% Start the Graphics Control Gui</span>
2624 <span class="comment">% ------------------------------</span>
2625 VMT_GraphicsControl
2626 
2627 <span class="comment">% [EOF] planviewPlotCallback</span>
2628 
2629 
2630 <span class="comment">% --------------------------------------------------------------------</span>
2631 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2632 <span class="comment">% Plot 3</span>
2633 
2634 <span class="comment">% Get the Application data:</span>
2635 <span class="comment">% -------------------------</span>
2636 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2637 z = guiparams.z;
2638 A = guiparams.A;
2639 <span class="comment">% V = guiparams.V;</span>
2640 <span class="comment">% Map = guiparams.Map;</span>
2641 
2642 <span class="comment">% Preprocess the data:</span>
2643 <span class="comment">% --------------------</span>
2644 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2645 
2646 <span class="comment">% Push messages to Log Window:</span>
2647 <span class="comment">% ----------------------------</span>
2648 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2649 statusLogging(handles.LogWindow, log_text)
2650 
2651 <span class="comment">% Process the transects:</span>
2652 <span class="comment">% ----------------------</span>
2653 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2654 A(1).vgns = guiparams.vertical_grid_node_spacing;
2655 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2656 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2657     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2658 
2659 <span class="comment">% Push messages to Log Window:</span>
2660 <span class="comment">% ----------------------------</span>
2661 statusLogging(handles.LogWindow, processing_log_text)
2662 
2663 <span class="comment">% Plot the cross section:</span>
2664 <span class="comment">% -----------------------</span>
2665 log_text = {<span class="keyword">...</span>
2666     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2667     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2668     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2669     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2670     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2671     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2672     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2673     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2674     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2675     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2676     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2677     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2678     
2679     };
2680 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2681     log_text = vertcat(log_text, {<span class="keyword">...</span>
2682         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2683         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2684         });
2685 <span class="keyword">end</span>
2686 <span class="comment">% Push messages to Log Window:</span>
2687 <span class="comment">% ----------------------------</span>
2688 statusLogging(handles.LogWindow, log_text)
2689 
2690 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2691     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2692 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2693 <span class="comment">%         ...guiparams.contour, ...</span>
2694 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2695 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2696     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2697         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2698         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2699         guiparams.vertical_smoothing_window);
2700     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2701     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2702         guiparams.contour, <span class="keyword">...</span>
2703         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2704         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2705         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2706         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2707         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2708         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2709         guiparams.english_units,<span class="keyword">...</span>
2710         guiparams.allow_vmt_flip_flux); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2711     
2712 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2713     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2714         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2715         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2716         guiparams.vertical_smoothing_window);
2717     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2718     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2719         guiparams.contour, <span class="keyword">...</span>
2720         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2721         guiparams.english_units, <span class="keyword">...</span>
2722         guiparams.allow_vmt_flip_flux);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2723     
2724     guiparams.zmin = zmin;
2725     guiparams.zmax = zmax;
2726     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2727 <span class="keyword">end</span>
2728 
2729 <span class="comment">% Force plot to be formated properly</span>
2730 <span class="comment">% ----------------------------------</span>
2731 <span class="keyword">if</span> guiparams.presentation
2732     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2733 <span class="keyword">else</span>
2734     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2735 <span class="keyword">end</span>
2736 <span class="keyword">switch</span> guiparams.renderer
2737     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2738         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2739     <span class="keyword">case</span> <span class="string">'painters'</span>
2740         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2741     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2742         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2743 <span class="keyword">end</span>
2744 
2745 <span class="comment">% Focus the figure</span>
2746 <span class="comment">% ----------------</span>
2747 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2748 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2749     figure(hff)
2750 <span class="keyword">end</span>
2751 
2752 <span class="comment">% Re-store the Application data:</span>
2753 <span class="comment">% ------------------------------</span>
2754 guiparams.V = V;
2755 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2756 
2757 <span class="comment">% Start the Graphics Control Gui</span>
2758 <span class="comment">% ------------------------------</span>
2759 VMT_GraphicsControl
2760 
2761 <span class="comment">% Push messages to Log Window:</span>
2762 <span class="comment">% ----------------------------</span>
2763 statusLogging(handles.LogWindow, plot_cont_log_text)
2764 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2765 
2766 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2767 
2768 
2769 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2770 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2771 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2772 
2773 <span class="comment">% --------------------------------------------------------------------</span>
2774 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2775 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2776 
2777 <span class="comment">% Get the Application data:</span>
2778 <span class="comment">% -------------------------</span>
2779 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2780 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2781 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2782 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2783 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2784 
2785 [the_file,the_path] = <span class="keyword">...</span>
2786     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2787     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2788     fullfile(guiparams.mat_path,guiparams.savefile));
2789 
2790 <span class="comment">% Save the processed data to a MAT file:</span>
2791 <span class="comment">% --------------------------------------</span>
2792 <span class="keyword">if</span> ischar(the_file)
2793     guiparams.mat_path = the_path;
2794     guiparams.mat_file = the_file;
2795     guiparams.savefile = the_file;
2796     
2797     <span class="comment">% Re-store the Application data:</span>
2798     <span class="comment">% ------------------------------</span>
2799     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2800     
2801     <span class="comment">% Update the preferences:</span>
2802     <span class="comment">% -----------------------</span>
2803     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2804     guiprefs.mat_path = the_path;
2805     guiprefs.mat_file = the_file;
2806     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2807     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2808     
2809     [~,filename,extension] = fileparts(guiparams.savefile);
2810     savefile = [filename extension];
2811     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2812         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2813     disp(<span class="string">'Saving Processed Data File...'</span>)
2814     disp(savefile)
2815     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2816 <span class="keyword">end</span>
2817 
2818 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2819 
2820 
2821 <span class="comment">% --------------------------------------------------------------------</span>
2822 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2823 
2824 <span class="comment">% Get the Application data:</span>
2825 <span class="comment">% -------------------------</span>
2826 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2827 <span class="comment">% z   = guiparams.z;</span>
2828 <span class="comment">% A   = guiparams.A;</span>
2829 V   = guiparams.V;
2830 <span class="comment">% Map = guiparams.Map;</span>
2831 
2832 [the_file,the_path] = <span class="keyword">...</span>
2833     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2834     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2835     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2836 
2837 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2838 <span class="comment">% ------------------------------------------</span>
2839 <span class="keyword">if</span> ischar(the_file)
2840     guiparams.tecplot_path = the_path;
2841     guiparams.tecplot_file = the_file;
2842     
2843     <span class="comment">% Re-store the Application data:</span>
2844     <span class="comment">% ------------------------------</span>
2845     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2846     
2847     <span class="comment">% Update the preferences:</span>
2848     <span class="comment">% -----------------------</span>
2849     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2850     guiprefs.tecplot_path = the_path;
2851     guiprefs.tecplot_file = the_file;
2852     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2853     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2854     
2855     <span class="comment">% Push to log window</span>
2856     <span class="comment">% ------------------</span>
2857     log_text = {<span class="keyword">...</span>
2858         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2859         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2860         the_path;<span class="keyword">...</span>
2861         [<span class="string">'Filename: '</span> the_file]};
2862     statusLogging(handles.LogWindow,log_text)
2863         
2864     <span class="keyword">if</span> isempty(V)
2865         A = guiparams.A;
2866         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2867         A(1).vgns = guiparams.vertical_grid_node_spacing;
2868         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2869         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2870             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2871             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2872             guiparams.bed_elevation);
2873     <span class="keyword">end</span>
2874     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2875     
2876     <span class="comment">% Push to log window</span>
2877     <span class="comment">% ------------------</span>
2878     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2879     statusLogging(handles.LogWindow,log_text)
2880     
2881     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2882     
2883     <span class="comment">% Push to log window</span>
2884     <span class="comment">% ------------------</span>
2885     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2886     statusLogging(handles.LogWindow,log_text)
2887    
2888 <span class="keyword">end</span>
2889 
2890 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2891 
2892 
2893 <span class="comment">% --------------------------------------------------------------------</span>
2894 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2895 
2896 <span class="comment">% Get the Application data:</span>
2897 <span class="comment">% -------------------------</span>
2898 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2899 <span class="comment">% z   = guiparams.z;</span>
2900 A   = guiparams.A;
2901 V   = guiparams.V;
2902 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2903 
2904 [the_file,the_path] = <span class="keyword">...</span>
2905     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2906     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2907     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2908 
2909 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2910 <span class="comment">% -----------------------------------------------------</span>
2911 <span class="keyword">if</span> ischar(the_file)
2912     guiparams.kmz_path = the_path;
2913     guiparams.kmz_file = the_file;
2914     
2915     <span class="comment">% Re-store the Application data:</span>
2916     <span class="comment">% ------------------------------</span>
2917     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2918     
2919     <span class="comment">% Update the preferences:</span>
2920     <span class="comment">% -----------------------</span>
2921     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2922     guiprefs.kmz_path = the_path;
2923     guiprefs.kmz_file = the_file;
2924     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2925     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2926     
2927     <span class="comment">%     if guiparams.display_shoreline</span>
2928     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2929     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2930     <span class="comment">%                             guiparams.vertical_offset);</span>
2931     <span class="comment">%     end</span>
2932     <span class="keyword">if</span> isempty(V)
2933         A = guiparams.A;
2934         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2935         A(1).vgns = guiparams.vertical_grid_node_spacing;
2936         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2937         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2938             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2939             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2940             guiparams.bed_elevation);
2941     <span class="keyword">end</span>
2942     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2943         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2944         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2945         guiparams.KMZ_vertical_offset);
2946 <span class="keyword">end</span>
2947 
2948 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2949 
2950 
2951 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2952 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2953 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2954 
2955 <span class="comment">% --------------------------------------------------------------------</span>
2956 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2957 
2958 <span class="comment">% Get the Application data:</span>
2959 <span class="comment">% -------------------------</span>
2960 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2961 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2962 z = guiparams.z;
2963 A = guiparams.A;
2964 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2965 <span class="comment">% Map = guiparams.Map;</span>
2966 setends = guiparams.set_cross_section_endpoints;
2967 
2968 [the_file,the_path] = <span class="keyword">...</span>
2969     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2970     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2971     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2972     guiprefs.multibeambathymetry_file));
2973 
2974 <span class="keyword">if</span> ischar(the_file)
2975     guiparams.multibeambathymetry_path = the_path;
2976     guiparams.multibeambathymetry_file = the_file;
2977     
2978     <span class="comment">% Re-store the Application data:</span>
2979     <span class="comment">% ------------------------------</span>
2980     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2981     
2982     <span class="comment">% Update the preferences:</span>
2983     <span class="comment">% -----------------------</span>
2984     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2985     guiprefs.multibeambathymetry_path = the_path;
2986     guiprefs.multibeambathymetry_file = the_file;
2987     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2988     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2989     
2990     <span class="keyword">if</span> guiparams.output_auxiliary_data
2991     <span class="keyword">end</span>
2992     
2993     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2994     
2995     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2996         guiparams.multibeambathymetry_file);
2997     
2998     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2999         [<span class="string">'   '</span> savefile]};
3000     statusLogging(handles.LogWindow,log_text)
3001     
3002     <span class="comment">% Process the transects:</span>
3003     <span class="comment">% ----------------------</span>
3004     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3005     A(1).vgns = guiparams.vertical_grid_node_spacing;
3006     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3007     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3008         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
3009     
3010     <span class="comment">% Compute the smoothed variables</span>
3011     <span class="comment">% ------------------------------</span>
3012     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3013     <span class="comment">% runtime.</span>
3014     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3015         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3016         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3017         guiparams.vertical_smoothing_window);
3018     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3019     <span class="comment">% Push messages to Log Window:</span>
3020     <span class="comment">% ----------------------------</span>
3021     statusLogging(handles.LogWindow, processing_log_text)
3022 
3023     
3024     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3025         guiparams.A, <span class="keyword">...</span>
3026         savefile, <span class="keyword">...</span>
3027         guiparams.beam_angle, <span class="keyword">...</span>
3028         guiparams.magnetic_variation, <span class="keyword">...</span>
3029         guiparams.water_surface_elevation, <span class="keyword">...</span>
3030         guiparams.output_auxiliary_data);
3031     
3032     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3033     
3034 <span class="keyword">end</span>
3035 
3036 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3037 
3038 
3039 <span class="comment">% --------------------------------------------------------------------</span>
3040 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3041 <span class="comment">% Get the beam angle</span>
3042 
3043 <span class="comment">% Get the Application data:</span>
3044 <span class="comment">% -------------------------</span>
3045 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3046 
3047 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3048 <span class="comment">% ----------------------------------------------------------------</span>
3049 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3050 is_a_number = ~isnan(new_beam_angle);
3051 is_positive = new_beam_angle&gt;=0;
3052 
3053 <span class="comment">% Modify the Application data:</span>
3054 <span class="comment">% ----------------------------</span>
3055 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3056     guiparams.beam_angle = new_beam_angle;
3057     
3058     <span class="comment">% Re-store the Application data:</span>
3059     <span class="comment">% ------------------------------</span>
3060     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3061     
3062 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3063     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3064 <span class="keyword">end</span>
3065 
3066 <span class="comment">% [EOF] BeamAngle_Callback</span>
3067 
3068 
3069 <span class="comment">% --------------------------------------------------------------------</span>
3070 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3071 <span class="comment">% Get the Magnetic Variation</span>
3072 
3073 <span class="comment">% Get the Application data:</span>
3074 <span class="comment">% -------------------------</span>
3075 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3076 
3077 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3078 <span class="comment">% ----------------------------------------------------------------</span>
3079 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3080 is_a_number = ~isnan(new_magnetic_variation);
3081 is_positive = new_magnetic_variation&gt;=0;
3082 
3083 <span class="comment">% Modify the Application data:</span>
3084 <span class="comment">% ----------------------------</span>
3085 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3086     guiparams.magnetic_variation = new_magnetic_variation;
3087     
3088     <span class="comment">% Re-store the Application data:</span>
3089     <span class="comment">% ------------------------------</span>
3090     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3091     
3092 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3093     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3094 <span class="keyword">end</span>
3095 
3096 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3097 
3098 
3099 <span class="comment">% % --------------------------------------------------------------------</span>
3100 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3101 <span class="comment">%</span>
3102 <span class="comment">% % Get the Application data:</span>
3103 <span class="comment">% % -------------------------</span>
3104 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3105 <span class="comment">%</span>
3106 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3107 <span class="comment">% % ----------------------------------------------------------------</span>
3108 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3109 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3110 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3111 <span class="comment">%</span>
3112 <span class="comment">% % Modify the Application data:</span>
3113 <span class="comment">% % ----------------------------</span>
3114 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3115 <span class="comment">%     guiparams.wse = new_wse;</span>
3116 <span class="comment">%</span>
3117 <span class="comment">%     % Re-store the Application data:</span>
3118 <span class="comment">%     % ------------------------------</span>
3119 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3120 <span class="comment">%</span>
3121 <span class="comment">% else % Reject the (incorrect) input</span>
3122 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3123 <span class="comment">% end</span>
3124 <span class="comment">%</span>
3125 <span class="comment">% % [EOF] WSE_Callback</span>
3126 
3127 
3128 <span class="comment">% --------------------------------------------------------------------</span>
3129 <a name="_sub68" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3130 <span class="comment">% Bathymetry Auxiliary Data</span>
3131 
3132 <span class="comment">% Get the Application data:</span>
3133 <span class="comment">% -------------------------</span>
3134 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3135 
3136 <span class="comment">% Modify the Application data:</span>
3137 <span class="comment">% ----------------------------</span>
3138 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3139 
3140 <span class="comment">% Re-store the Application data:</span>
3141 <span class="comment">% ------------------------------</span>
3142 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3143 
3144 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3145 
3146 
3147 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3148 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3149 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3150 
3151 <span class="comment">% --------------------------------------------------------------------</span>
3152 <a name="_sub69" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3153 
3154 <span class="comment">% Get the Application data:</span>
3155 <span class="comment">% -------------------------</span>
3156 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3157 
3158 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3159 <span class="comment">% ----------------------------------------------------------------</span>
3160 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3161 is_a_number = ~isnan(new_depth_range_min);
3162 is_positive = new_depth_range_min&gt;=0;
3163 
3164 <span class="comment">% Modify the Application data:</span>
3165 <span class="comment">% ----------------------------</span>
3166 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3167     guiparams.depth_range_min = new_depth_range_min;
3168     
3169     <span class="comment">% Re-store the Application data:</span>
3170     <span class="comment">% ------------------------------</span>
3171     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3172     
3173 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3174     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3175 <span class="keyword">end</span>
3176 
3177 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3178 
3179 
3180 <span class="comment">% --------------------------------------------------------------------</span>
3181 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3182 
3183 <span class="comment">% Get the Application data:</span>
3184 <span class="comment">% -------------------------</span>
3185 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3186 
3187 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3188 <span class="comment">% ----------------------------------------------------------------</span>
3189 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3190 is_a_number = ~isnan(new_depth_range_max);
3191 is_positive = new_depth_range_max&gt;=0;
3192 
3193 <span class="comment">% Modify the Application data:</span>
3194 <span class="comment">% ----------------------------</span>
3195 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3196     guiparams.depth_range_max = new_depth_range_max;
3197     
3198     <span class="comment">% Re-store the Application data:</span>
3199     <span class="comment">% ------------------------------</span>
3200     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3201     
3202 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3203     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3204 <span class="keyword">end</span>
3205 
3206 <span class="comment">% [EOF] DepthMax_Callback</span>
3207 
3208 
3209 <span class="comment">% --------------------------------------------------------------------</span>
3210 <a name="_sub71" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3211 <span class="comment">% Set quiver scale (contour)</span>
3212 
3213 <span class="comment">% Get the Application data:</span>
3214 <span class="comment">% -------------------------</span>
3215 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3216 
3217 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3218 <span class="comment">% ----------------------------------------------------------------</span>
3219 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3220 is_a_number = ~isnan(new_vector_scale_plan_view);
3221 is_positive = new_vector_scale_plan_view&gt;=0;
3222 
3223 <span class="comment">% Modify the Application data:</span>
3224 <span class="comment">% ----------------------------</span>
3225 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3226     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3227     
3228     <span class="comment">% Re-store the Application data:</span>
3229     <span class="comment">% ------------------------------</span>
3230     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3231     
3232 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3233     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3234 <span class="keyword">end</span>
3235 
3236 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3237 
3238 
3239 <span class="comment">% --------------------------------------------------------------------</span>
3240 <a name="_sub72" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3241 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3242 
3243 <span class="comment">% Get the Application data:</span>
3244 <span class="comment">% -------------------------</span>
3245 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3246 
3247 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3248 <span class="comment">% ----------------------------------------------------------------</span>
3249 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3250 is_a_number = ~isnan(new_vector_spacing_plan_view);
3251 is_positive = new_vector_spacing_plan_view&gt;=0;
3252 
3253 <span class="comment">% Modify the Application data:</span>
3254 <span class="comment">% ----------------------------</span>
3255 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3256     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3257     
3258     <span class="comment">% Re-store the Application data:</span>
3259     <span class="comment">% ------------------------------</span>
3260     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3261     
3262 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3263     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3264 <span class="keyword">end</span>
3265 
3266 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3267 
3268 
3269 <span class="comment">% --------------------------------------------------------------------</span>
3270 <a name="_sub73" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3271 <span class="comment">% Plan View smoothing window size</span>
3272 
3273 <span class="comment">% Get the Application data:</span>
3274 <span class="comment">% -------------------------</span>
3275 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3276 
3277 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3278 <span class="comment">% ----------------------------------------------------------------</span>
3279 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3280 is_a_number = ~isnan(new_smoothing_window_size);
3281 is_positive = new_smoothing_window_size&gt;=0;
3282 
3283 <span class="comment">% Modify the Application data:</span>
3284 <span class="comment">% ----------------------------</span>
3285 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3286     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3287     
3288     <span class="comment">% Re-store the Application data:</span>
3289     <span class="comment">% ------------------------------</span>
3290     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3291     
3292 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3293     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3294 <span class="keyword">end</span>
3295 
3296 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3297 
3298 
3299 <span class="comment">% --------------------------------------------------------------------</span>
3300 <a name="_sub74" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3301 
3302 <span class="comment">% Get the Application data:</span>
3303 <span class="comment">% -------------------------</span>
3304 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3305 
3306 <span class="comment">% Modify the Application data:</span>
3307 <span class="comment">% ----------------------------</span>
3308 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3309 
3310 <span class="comment">% Re-store the Application data:</span>
3311 <span class="comment">% ------------------------------</span>
3312 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3313 
3314 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3315 
3316 
3317 <span class="comment">% --------------------------------------------------------------------</span>
3318 <a name="_sub75" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3319 
3320 <span class="comment">% Get the Application data:</span>
3321 <span class="comment">% -------------------------</span>
3322 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3323 
3324 <span class="comment">% Modify the Application data:</span>
3325 <span class="comment">% ----------------------------</span>
3326 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3327 
3328 <span class="comment">% Re-store the Application data:</span>
3329 <span class="comment">% ------------------------------</span>
3330 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3331 
3332 <span class="comment">% [EOF] AddBackground_Callback</span>
3333 
3334 
3335 <span class="comment">% --------------------------------------------------------------------</span>
3336 <a name="_sub76" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3337 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3338 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3339 
3340 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3341 <span class="comment">% OFFSETS PANEL CALLBACKS %</span>
3342 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3343 
3344 
3345 <a name="_sub77" href="#_subfunctions" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a>
3346 <span class="comment">% Water Surface Elevation</span>
3347 
3348 <span class="comment">% Get the Application data:</span>
3349 <span class="comment">% -------------------------</span>
3350 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3351 
3352 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3353 <span class="comment">% ----------------------------------------------------------------</span>
3354 string = get(hObject,<span class="string">'String'</span>);
3355 new_water_surface_elevation = str2double(string);
3356 is_a_number = ~isnan(new_water_surface_elevation);
3357 is_positive = new_water_surface_elevation&gt;=0;
3358 is_tide     = strcmpi(<span class="string">'tide'</span>,string);
3359 
3360 <span class="comment">% Modify the Application data:</span>
3361 <span class="comment">% ----------------------------</span>
3362 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3363     guiparams.water_surface_elevation = (new_water_surface_elevation);
3364     guiparams.load_wse_tide_file      = false;
3365     <span class="comment">% Re-store the Application data:</span>
3366     <span class="comment">% ------------------------------</span>
3367     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3368     
3369 <span class="keyword">elseif</span> is_tide
3370     guiparams.water_surface_elevation = <span class="string">'tide'</span>;
3371     guiparams.load_wse_tide_file      = true;
3372     
3373     <span class="comment">% Re-store the Application data:</span>
3374     <span class="comment">% ------------------------------</span>
3375     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3376 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3377     set(hObject,<span class="string">'String'</span>,guiparams.water_surface_elevation)
3378 <span class="keyword">end</span>
3379 
3380 <span class="comment">% [EOF] WaterSurfaceElevation_Callback</span>
3381 
3382 
3383 <a name="_sub78" href="#_subfunctions" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a>
3384 <span class="comment">% Bed Elevation</span>
3385 <span class="comment">% This is a constant that is added to the V.mcsBedElev variable if the</span>
3386 <span class="comment">% 'Height above the bed' [hab] reference is selected. Note, in cases where</span>
3387 <span class="comment">% the bed is flat, this represents the actual bed elevation. Otherwise this</span>
3388 <span class="comment">% is a simple datum shift applied to the bed.</span>
3389 
3390 <span class="comment">% Get the Application data:</span>
3391 <span class="comment">% -------------------------</span>
3392 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3393 
3394 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3395 <span class="comment">% ----------------------------------------------------------------</span>
3396 string = get(hObject,<span class="string">'String'</span>);
3397 new_bed_elevation = str2double(string);
3398 is_a_number = ~isnan(new_bed_elevation);
3399 
3400 <span class="comment">% Modify the Application data:</span>
3401 <span class="comment">% ----------------------------</span>
3402 <span class="keyword">if</span> is_a_number
3403     guiparams.bed_elevation = (new_bed_elevation);
3404     
3405     <span class="comment">% Re-store the Application data:</span>
3406     <span class="comment">% ------------------------------</span>
3407     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3408     
3409 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3410     set(hObject,<span class="string">'String'</span>,guiparams.bed_elevation)
3411 <span class="keyword">end</span>
3412 
3413 <span class="comment">% [EOF] BedElevation_Callback</span>
3414 
3415 <a name="_sub79" href="#_subfunctions" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
3416 <span class="comment">% KMZ Vertical Offset</span>
3417 <span class="comment">% This is the elevation (in meters) that the cross section should be offset</span>
3418 <span class="comment">% to in Google Earth to ensure it plots above the land surface for</span>
3419 <span class="comment">% visualization.</span>
3420 
3421 <span class="comment">% Get the Application data:</span>
3422 <span class="comment">% -------------------------</span>
3423 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3424 
3425 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3426 <span class="comment">% ----------------------------------------------------------------</span>
3427 string = get(hObject,<span class="string">'String'</span>);
3428 new_KMZ_vertical_offset = str2double(string);
3429 is_a_number = ~isnan(new_KMZ_vertical_offset);
3430 is_positive = new_KMZ_vertical_offset&gt;=0;
3431 
3432 <span class="comment">% Modify the Application data:</span>
3433 <span class="comment">% ----------------------------</span>
3434 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3435     guiparams.KMZ_vertical_offset = (new_KMZ_vertical_offset);
3436     
3437     <span class="comment">% Re-store the Application data:</span>
3438     <span class="comment">% ------------------------------</span>
3439     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3440     
3441 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3442     set(hObject,<span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
3443 <span class="keyword">end</span>
3444 
3445 <span class="comment">% [EOF] KMZVerticalOffset_Callback</span>
3446 
3447 
3448 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3449 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3450 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3451 
3452 <span class="comment">% --------------------------------------------------------------------</span>
3453 <a name="_sub80" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3454 <span class="comment">% Set the horizontal grid node spacing</span>
3455 
3456 <span class="comment">% Get the Application data:</span>
3457 <span class="comment">% -------------------------</span>
3458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3459 
3460 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3461 <span class="comment">% ----------------------------------------------------------------</span>
3462 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3463 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3464 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3465 
3466 <span class="comment">% Modify the Application data:</span>
3467 <span class="comment">% ----------------------------</span>
3468 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3469     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3470     
3471     <span class="comment">% Re-store the Application data:</span>
3472     <span class="comment">% ------------------------------</span>
3473     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3474     
3475 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3476     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3477 <span class="keyword">end</span>
3478 
3479 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3480 
3481 <span class="comment">% --------------------------------------------------------------------</span>
3482 <a name="_sub81" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3483 <span class="comment">% Set the horizontal grid node spacing</span>
3484 
3485 <span class="comment">% Get the Application data:</span>
3486 <span class="comment">% -------------------------</span>
3487 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3488 
3489 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3490 <span class="comment">% ----------------------------------------------------------------</span>
3491 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3492 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3493 is_positive = new_vertical_grid_node_spacing&gt;=0;
3494 
3495 <span class="comment">% Modify the Application data:</span>
3496 <span class="comment">% ----------------------------</span>
3497 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3498     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3499     
3500     <span class="comment">% Re-store the Application data:</span>
3501     <span class="comment">% ------------------------------</span>
3502     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3503     
3504 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3505     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3506 <span class="keyword">end</span>
3507 
3508 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3509 
3510 <span class="comment">% --------------------------------------------------------------------</span>
3511 <a name="_sub82" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3512 <span class="comment">% Set the cross section endpoints manually</span>
3513 
3514 <span class="comment">% Get the Application data:</span>
3515 <span class="comment">% -------------------------</span>
3516 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3517 
3518 <span class="comment">% Modify the Application data:</span>
3519 <span class="comment">% ----------------------------</span>
3520 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3521 
3522 <span class="comment">% Re-store the Application data:</span>
3523 <span class="comment">% ------------------------------</span>
3524 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3525 
3526 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3527 
3528 
3529 <span class="comment">% --------------------------------------------------------------------</span>
3530 <a name="_sub83" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3531 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3532 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3533 
3534 
3535 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3536 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3537 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3538 
3539 <span class="comment">% --------------------------------------------------------------------</span>
3540 <a name="_sub84" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3541 
3542 <span class="comment">% Get the Application data:</span>
3543 <span class="comment">% -------------------------</span>
3544 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3545 
3546 <span class="comment">% Modify the Application data:</span>
3547 <span class="comment">% ----------------------------</span>
3548 idx_variable = get(hObject,<span class="string">'Value'</span>);
3549 guiparams.idx_contour = idx_variable;
3550 guiparams.contour = guiparams.contours(idx_variable).variable;
3551 
3552 <span class="comment">% Re-store the Application data:</span>
3553 <span class="comment">% ------------------------------</span>
3554 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3555 
3556 <span class="comment">% [EOF] Contour_Callback</span>
3557 
3558 
3559 <span class="comment">% --------------------------------------------------------------------</span>
3560 <a name="_sub85" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3561 <span class="comment">% Set vertical exaggeration</span>
3562 
3563 <span class="comment">% Get the Application data:</span>
3564 <span class="comment">% -------------------------</span>
3565 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3566 
3567 <span class="comment">% Modify the Application data:</span>
3568 <span class="comment">% ----------------------------</span>
3569 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3570 
3571 <span class="comment">% Re-store the Application data:</span>
3572 <span class="comment">% ------------------------------</span>
3573 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3574 
3575 <span class="comment">% Update the GUI:</span>
3576 <span class="comment">% ---------------</span>
3577 <span class="comment">% updateGUI(handles,guiparams)</span>
3578 
3579 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3580 
3581 
3582 <span class="comment">% --------------------------------------------------------------------</span>
3583 <a name="_sub86" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3584 
3585 <span class="comment">% Get the Application data:</span>
3586 <span class="comment">% -------------------------</span>
3587 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3588 
3589 <span class="comment">% Modify the Application data:</span>
3590 <span class="comment">% ----------------------------</span>
3591 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3592 
3593 <span class="comment">% Re-store the Application data:</span>
3594 <span class="comment">% ------------------------------</span>
3595 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3596 
3597 <span class="comment">% Update the GUI:</span>
3598 <span class="comment">% ---------------</span>
3599 <span class="comment">% updateGUI(handles,guiparams)</span>
3600 
3601 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3602 
3603 
3604 <span class="comment">% --------------------------------------------------------------------</span>
3605 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3606 
3607 <span class="comment">% Get the Application data:</span>
3608 <span class="comment">% -------------------------</span>
3609 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3610 
3611 <span class="comment">% Modify the Application data:</span>
3612 <span class="comment">% ----------------------------</span>
3613 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3614 
3615 <span class="comment">% Re-store the Application data:</span>
3616 <span class="comment">% ------------------------------</span>
3617 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3618 
3619 <span class="comment">% Update the GUI:</span>
3620 <span class="comment">% ---------------</span>
3621 <span class="comment">% updateGUI(handles,guiparams)</span>
3622 
3623 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3624 
3625 
3626 <span class="comment">% --------------------------------------------------------------------</span>
3627 <a name="_sub88" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3628 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3629 
3630 <span class="comment">% Get the Application data:</span>
3631 <span class="comment">% -------------------------</span>
3632 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3633 
3634 <span class="comment">% Modify the Application data:</span>
3635 <span class="comment">% ----------------------------</span>
3636 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3637 
3638 <span class="comment">% Re-store the Application data:</span>
3639 <span class="comment">% ------------------------------</span>
3640 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3641 
3642 <span class="comment">% Update the GUI:</span>
3643 <span class="comment">% ---------------</span>
3644 <span class="comment">% updateGUI(handles,guiparams)</span>
3645 
3646 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3647 
3648 
3649 <span class="comment">% --------------------------------------------------------------------</span>
3650 <a name="_sub89" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3651 <span class="comment">% Horizontal Smoothing</span>
3652 
3653 <span class="comment">% Get the Application data:</span>
3654 <span class="comment">% -------------------------</span>
3655 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3656 
3657 <span class="comment">% Modify the Application data:</span>
3658 <span class="comment">% ----------------------------</span>
3659 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3660 
3661 <span class="comment">% Re-store the Application data:</span>
3662 <span class="comment">% ------------------------------</span>
3663 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3664 
3665 <span class="comment">% Update the GUI:</span>
3666 <span class="comment">% ---------------</span>
3667 <span class="comment">% updateGUI(handles,guiparams)</span>
3668 
3669 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3670 
3671 
3672 <span class="comment">% --------------------------------------------------------------------</span>
3673 <a name="_sub90" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3674 <span class="comment">% Vertical Smoothing</span>
3675 
3676 <span class="comment">% Get the Application data:</span>
3677 <span class="comment">% -------------------------</span>
3678 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3679 
3680 <span class="comment">% Modify the Application data:</span>
3681 <span class="comment">% ----------------------------</span>
3682 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3683 
3684 <span class="comment">% Re-store the Application data:</span>
3685 <span class="comment">% ------------------------------</span>
3686 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3687 
3688 <span class="comment">% Update the GUI:</span>
3689 <span class="comment">% ---------------</span>
3690 <span class="comment">% updateGUI(handles,guiparams)</span>
3691 
3692 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3693 
3694 
3695 <span class="comment">% --------------------------------------------------------------------</span>
3696 <a name="_sub91" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3697 
3698 <span class="comment">% Get the Application data:</span>
3699 <span class="comment">% -------------------------</span>
3700 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3701 
3702 <span class="comment">% Modify the Application data:</span>
3703 <span class="comment">% ----------------------------</span>
3704 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3705 
3706 <span class="comment">% Re-store the Application data:</span>
3707 <span class="comment">% ------------------------------</span>
3708 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3709 
3710 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3711 
3712 <span class="comment">% --- Executes on button press in AllowVMTFlipFlux.</span>
3713 <a name="_sub92" href="#_subfunctions" class="code">function AllowVMTFlipFlux_Callback(hObject, eventdata, handles)</a>
3714 
3715 <span class="comment">% Get the Application data:</span>
3716 <span class="comment">% -------------------------</span>
3717 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3718 
3719 <span class="comment">% Modify the Application data:</span>
3720 <span class="comment">% ----------------------------</span>
3721 guiparams.allow_vmt_flip_flux = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3722 
3723 <span class="comment">% Re-store the Application data:</span>
3724 <span class="comment">% ------------------------------</span>
3725 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3726 
3727 <span class="comment">% [EOF] AllowVMTFlipFlux_Callback</span>
3728 
3729 
3730 <span class="comment">% --------------------------------------------------------------------</span>
3731 <a name="_sub93" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3732 
3733 <span class="comment">% Get the Application data:</span>
3734 <span class="comment">% -------------------------</span>
3735 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3736 
3737 <span class="comment">% Modify the Application data:</span>
3738 <span class="comment">% ----------------------------</span>
3739 idx_variable = get(hObject,<span class="string">'Value'</span>);
3740 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3741 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3742 
3743 <span class="comment">% Re-store the Application data:</span>
3744 <span class="comment">% ------------------------------</span>
3745 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3746 
3747 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3748 
3749 
3750 <span class="comment">% --------------------------------------------------------------------</span>
3751 <a name="_sub94" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3752 
3753 <span class="comment">% Get the Application data:</span>
3754 <span class="comment">% -------------------------</span>
3755 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3756 
3757 <span class="comment">% Modify the Application data:</span>
3758 <span class="comment">% ----------------------------</span>
3759 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3760 
3761 <span class="comment">% Re-store the Application data:</span>
3762 <span class="comment">% ------------------------------</span>
3763 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3764 
3765 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3766 
3767 
3768 <span class="comment">% --------------------------------------------------------------------</span>
3769 <a name="_sub95" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3770 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3771 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3772 
3773 
3774 <span class="comment">% --------------------------------------------------------------------</span>
3775 <a name="_sub96" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3776 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3777 <span class="comment">% [EOF] ClearLog_Callback</span>
3778 
3779 <span class="comment">% --------------------------------------------------------------------</span>
3780 <a name="_sub97" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3781 
3782 <span class="comment">% Get the Application data:</span>
3783 <span class="comment">% -------------------------</span>
3784 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3785 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3786 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3787 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3788 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3789 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3790 
3791 [the_file,the_path] = <span class="keyword">...</span>
3792     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3793     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3794     fullfile(guiprefs.log_path,guiprefs.log_file));
3795 
3796 <span class="comment">% Save the log to a TXT file:</span>
3797 <span class="comment">% ---------------------------</span>
3798 <span class="keyword">if</span> ischar(the_file)
3799     guiparams.log_path = the_path;
3800     guiparams.log_file = the_file;
3801     <span class="comment">%guiparams.savefile = the_file;</span>
3802     
3803     <span class="comment">% Re-store the Application data:</span>
3804     <span class="comment">% ------------------------------</span>
3805     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3806     
3807     <span class="comment">% Update the preferences:</span>
3808     <span class="comment">% -----------------------</span>
3809     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3810     guiprefs.log_path = the_path;
3811     guiprefs.log_file = the_file;
3812     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3813     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3814     
3815     [~,filename,extension] = fileparts(the_file);
3816     savefile = [the_path filename extension];
3817     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3818         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3819     
3820     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3821     [nrows,~]= size(logfile);
3822     fid = fopen(savefile, <span class="string">'w'</span>);
3823     <span class="keyword">for</span> row=1:nrows
3824         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3825     <span class="keyword">end</span>
3826     fclose(fid);
3827 <span class="keyword">end</span>
3828 <span class="comment">% [EOF] SaveLog_Callback</span>
3829 
3830 <span class="comment">%%%%%%%%%%%%%%%%</span>
3831 <span class="comment">% SUBFUNCTIONS %</span>
3832 <span class="comment">%%%%%%%%%%%%%%%%</span>
3833 
3834 <span class="comment">% --------------------------------------------------------------------</span>
3835 <a name="_sub98" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3836 
3837 icons = <a href="#_sub114" class="code" title="subfunction icons = getIcons">getIcons</a>;
3838 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3839 
3840 <span class="comment">% Load data</span>
3841 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3842 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3843 <span class="comment">% icon(icon==0) = NaN;</span>
3844 handles.toolbarLoadData = <span class="keyword">...</span>
3845     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3846     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3847     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3848 
3849 <span class="comment">% Save data</span>
3850 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3851 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3852 <span class="comment">% icon(icon==0) = NaN;</span>
3853 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3854     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3855     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3856     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3857     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3858 
3859 
3860 <span class="comment">% Save bathymetry</span>
3861 <span class="comment">%icon = ones(16,16,3);</span>
3862 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3863     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3864     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3865     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3866 
3867 <span class="comment">% Save figures</span>
3868 <span class="comment">% icon = ones(16,16,3);</span>
3869 handles.toolbarSaveFigures = <span class="keyword">...</span>
3870     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3871     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3872     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3873 
3874 <span class="comment">% Save Excel File</span>
3875 <span class="comment">% icon = ones(16,16,3);</span>
3876 handles.toolbarSaveExcel = <span class="keyword">...</span>
3877     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3878     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3879     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3880 
3881 
3882 <span class="comment">% Plotting parameters</span>
3883 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3884 <span class="comment">% icon = ind2rgb(icon,map);</span>
3885 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3886     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3887     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3888     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3889     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3890 
3891 <span class="comment">% Processing parameters</span>
3892 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3893 <span class="comment">% icon = ind2rgb(icon,map);</span>
3894 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3895     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3896     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3897     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3898 
3899 <span class="comment">% Zoom In</span>
3900 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3901 <span class="comment">% icon = ind2rgb(icon,map);</span>
3902 <span class="comment">% handles.toolbarZoomIn = ...</span>
3903 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3904 <span class="comment">%     'CData',        icons(8).data, ...</span>
3905 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3906 <span class="comment">%     'Separator',     'on');</span>
3907 
3908 <span class="comment">% Zoom Out</span>
3909 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3910 <span class="comment">% icon = ind2rgb(icon,map);</span>
3911 <span class="comment">% handles.toolbarZoomOut = ...</span>
3912 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3913 <span class="comment">%     'CData',        icons(9).data, ...</span>
3914 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3915 
3916 <span class="comment">% Pan</span>
3917 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3918 <span class="comment">% icon = ind2rgb(icon,map);</span>
3919 <span class="comment">% handles.toolbarPan = ...</span>
3920 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3921 <span class="comment">%     'CData',        icons(10).data, ...</span>
3922 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3923 
3924 
3925 
3926 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3927 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3928 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3929 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3930 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3931 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3932 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3933 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3934 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3935 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3936 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3937 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3938 
3939 <span class="comment">% [EOF] buildtoolbar</span>
3940 
3941 
3942 <span class="comment">% --------------------------------------------------------------------</span>
3943 <a name="_sub99" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3944 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3945 <span class="comment">% already exist.</span>
3946 
3947 <span class="comment">% Preferences:</span>
3948 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3949 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3950 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3951 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3952 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3953 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3954 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3955 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3956 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3957 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3958 <span class="comment">% 'renderer'             Default graphics renderer</span>
3959 <span class="comment">% 'units'                Default plotting units</span>
3960 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3961 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3962 <span class="comment">%                        started</span>
3963 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3964 
3965 <span class="comment">% Originals</span>
3966 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3967 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3968 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3969 
3970 <span class="comment">% ASCII</span>
3971 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3972     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3973     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3974         guiprefs.ascii_path = ascii.path;
3975     <span class="keyword">else</span>
3976         guiprefs.ascii_path = pwd;
3977     <span class="keyword">end</span>
3978     does_exist = false(1,length(ascii.file));
3979     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3980         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3981     <span class="keyword">end</span>
3982     <span class="keyword">if</span> any(does_exist)
3983         guiprefs.ascii_file = ascii.file(does_exist);
3984     <span class="keyword">else</span>
3985         guiprefs.ascii_file = {<span class="string">''</span>};
3986     <span class="keyword">end</span>
3987 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3988     guiprefs.ascii_path = pwd;
3989     guiprefs.ascii_file = {<span class="string">''</span>};
3990     
3991     ascii.path = pwd;
3992     ascii.file = {<span class="string">''</span>};
3993     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3994 <span class="keyword">end</span>
3995 
3996 <span class="comment">% MAT</span>
3997 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3998     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3999     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
4000         guiprefs.mat_path = mat.path;
4001     <span class="keyword">else</span>
4002         guiprefs.mat_path = pwd;
4003     <span class="keyword">end</span>
4004     
4005     <span class="keyword">if</span> iscell(mat.file)
4006         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
4007             guiprefs.mat_file = mat.file;
4008         <span class="keyword">else</span>
4009             guiprefs.mat_file = <span class="string">''</span>;
4010         <span class="keyword">end</span>
4011     <span class="keyword">else</span>
4012         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
4013             guiprefs.mat_file = mat.file;
4014         <span class="keyword">else</span>
4015             guiprefs.mat_file = <span class="string">''</span>;
4016         <span class="keyword">end</span>
4017     <span class="keyword">end</span>
4018 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
4019     guiprefs.mat_path = pwd;
4020     guiprefs.mat_file = <span class="string">''</span>;
4021     
4022     mat.path = pwd;
4023     mat.file = <span class="string">''</span>;
4024     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4025 <span class="keyword">end</span>
4026 
4027 <span class="comment">% TECPLOT</span>
4028 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
4029     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
4030     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
4031         guiprefs.tecplot_path = tecplot.path;
4032     <span class="keyword">else</span>
4033         guiprefs.tecplot_path = pwd;
4034     <span class="keyword">end</span>
4035     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
4036         guiprefs.tecplot_file = tecplot.file;
4037     <span class="keyword">else</span>
4038         guiprefs.tecplot_file = <span class="string">''</span>;
4039     <span class="keyword">end</span>
4040 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4041     guiprefs.tecplot_path = pwd;
4042     guiprefs.tecplot_file = <span class="string">''</span>;
4043     
4044     tecplot.path = pwd;
4045     tecplot.file = <span class="string">''</span>;
4046     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4047 <span class="keyword">end</span>
4048 
4049 <span class="comment">% KMZ</span>
4050 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
4051     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
4052     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
4053         guiprefs.kmz_path = kmz.path;
4054     <span class="keyword">else</span>
4055         guiprefs.kmz_path = pwd;
4056     <span class="keyword">end</span>
4057     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
4058         guiprefs.kmz_file = kmz.file;
4059     <span class="keyword">else</span>
4060         guiprefs.kmz_file = <span class="string">''</span>;
4061     <span class="keyword">end</span>
4062 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
4063     guiprefs.kmz_path = pwd;
4064     guiprefs.kmz_file = <span class="string">''</span>;
4065     
4066     kmz.path = pwd;
4067     kmz.file = <span class="string">''</span>;
4068     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4069 <span class="keyword">end</span>
4070 
4071 <span class="comment">% MULTIBEAM BATHYMETRY</span>
4072 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
4073     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
4074     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
4075         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
4076     <span class="keyword">else</span>
4077         guiprefs.multibeambathymetry_path = pwd;
4078     <span class="keyword">end</span>
4079     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
4080         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
4081     <span class="keyword">else</span>
4082         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4083     <span class="keyword">end</span>
4084 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
4085     guiprefs.multibeambathymetry_path = pwd;
4086     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4087     
4088     multibeambathymetry.path = pwd;
4089     multibeambathymetry.file = <span class="string">''</span>;
4090     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4091 <span class="keyword">end</span>
4092 
4093 <span class="comment">% Log</span>
4094 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
4095     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
4096     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
4097         guiprefs.log_path = log.path;
4098     <span class="keyword">else</span>
4099         guiprefs.log_path = pwd;
4100     <span class="keyword">end</span>
4101     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
4102         guiprefs.log_file = log.file;
4103     <span class="keyword">else</span>
4104         guiprefs.log_file = <span class="string">''</span>;
4105     <span class="keyword">end</span>
4106 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4107     guiprefs.log_path = pwd;
4108     guiprefs.log_file = <span class="string">''</span>;
4109     
4110     log.path = pwd;
4111     log.file = <span class="string">''</span>;
4112     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4113 <span class="keyword">end</span>
4114 
4115 <span class="comment">% iRic</span>
4116 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
4117     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
4118     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
4119         guiprefs.iric_path = iric.path;
4120     <span class="keyword">else</span>
4121         guiprefs.iric_path = pwd;
4122     <span class="keyword">end</span>
4123     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
4124         guiprefs.iric_file = iric.file;
4125     <span class="keyword">else</span>
4126         guiprefs.iric_file = <span class="string">''</span>;
4127     <span class="keyword">end</span>
4128 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4129     guiprefs.iric_path = pwd;
4130     guiprefs.iric_file = <span class="string">''</span>;
4131     
4132     iric.path = pwd;
4133     iric.file = <span class="string">''</span>;
4134     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4135 <span class="keyword">end</span>
4136 
4137 <span class="comment">% excel</span>
4138 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
4139     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
4140     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
4141         guiprefs.excel_path = excel.path;
4142     <span class="keyword">else</span>
4143         guiprefs.excel_path = pwd;
4144     <span class="keyword">end</span>
4145     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4146         guiprefs.excel_file = excel.file;
4147     <span class="keyword">else</span>
4148         guiprefs.excel_file = <span class="string">''</span>;
4149     <span class="keyword">end</span>
4150 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4151     guiprefs.excel_path = pwd;
4152     guiprefs.excel_file = <span class="string">''</span>;
4153     
4154     excel.path = pwd;
4155     excel.file = <span class="string">''</span>;
4156     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4157 <span class="keyword">end</span>
4158 
4159 <span class="comment">% aerial</span>
4160 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4161     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4162     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4163         guiprefs.aerial_path = aerial.path;
4164     <span class="keyword">else</span>
4165         guiprefs.aerial_path = pwd;
4166     <span class="keyword">end</span>
4167     does_exist = false(1,length(aerial.file));
4168     <span class="keyword">if</span> iscell(aerial.file)
4169     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4170         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4171     <span class="keyword">end</span>
4172     <span class="keyword">else</span>
4173         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4174     <span class="keyword">end</span>
4175     <span class="keyword">if</span> any(does_exist)
4176         guiprefs.aerial_file = aerial.file;
4177     <span class="keyword">else</span>
4178         guiprefs.aerial_file = {<span class="string">''</span>};
4179     <span class="keyword">end</span>
4180 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4181     guiprefs.aerial_path = pwd;
4182     guiprefs.aerial_file = {<span class="string">''</span>};
4183     
4184     aerial.path = pwd;
4185     aerial.file = {<span class="string">''</span>};
4186     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4187 <span class="keyword">end</span>
4188 
4189 <span class="comment">% shoreline</span>
4190 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4191     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4192     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4193         guiprefs.shoreline_path = shoreline.path;
4194     <span class="keyword">else</span>
4195         guiprefs.shoreline_path = pwd;
4196     <span class="keyword">end</span>
4197     
4198     <span class="keyword">if</span> iscell(shoreline.file)
4199         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4200             guiprefs.shoreline_file = shoreline.file;
4201         <span class="keyword">else</span>
4202             guiprefs.shoreline_file = <span class="string">''</span>;
4203         <span class="keyword">end</span>
4204     <span class="keyword">else</span>
4205         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4206             guiprefs.shoreline_file = shoreline.file;
4207         <span class="keyword">else</span>
4208             guiprefs.shoreline_file = <span class="string">''</span>;
4209         <span class="keyword">end</span>
4210     <span class="keyword">end</span>
4211 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4212     guiprefs.shoreline_path = pwd;
4213     guiprefs.shoreline_file = <span class="string">''</span>;
4214     
4215     shoreline.path = pwd;
4216     shoreline.file = <span class="string">''</span>;
4217     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4218 <span class="keyword">end</span>
4219 <span class="comment">% guiprefs.presentation = true;</span>
4220 <span class="comment">% guiprefs.print        = false;</span>
4221 
4222 <span class="comment">% for k = 1:length(prefs)</span>
4223 <span class="comment">%     newpref = '';</span>
4224 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4225 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4226 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4227 <span class="comment">%             newpref = stored_newpref;</span>
4228 <span class="comment">%         else</span>
4229 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4230 <span class="comment">%         end</span>
4231 <span class="comment">%     end</span>
4232 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4233 <span class="comment">% end</span>
4234 
4235 <span class="comment">% RENDERER</span>
4236 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4237     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4238     guiprefs.renderer = renderer;
4239 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4240     renderer           = <span class="string">'OpenGL'</span>;
4241     guiprefs.renderer  = renderer;
4242     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4243 <span class="keyword">end</span>
4244 
4245 <span class="comment">% UNITS</span>
4246 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4247     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4248     guiprefs.units = units;
4249 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4250     units           = <span class="string">'metric'</span>;
4251     guiprefs.units  = units;
4252     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4253 <span class="keyword">end</span>
4254 
4255 <span class="comment">% PLOTREF</span>
4256 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4257     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4258     guiprefs.plotref = plotref;
4259 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4260     plotref           = <span class="string">'dfs'</span>;
4261     guiprefs.plotref  = plotref;
4262     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4263 <span class="keyword">end</span>
4264 
4265 <span class="comment">% RUNCOUNTER</span>
4266 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4267     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4268     guiprefs.runcounter = runcounter;
4269 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4270     runcounter           = 1;
4271     guiprefs.runcounter  = runcounter;
4272     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4273 <span class="keyword">end</span>
4274 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4275 
4276 <span class="comment">% SETENDPOINTS</span>
4277 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4278     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4279     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4280         guiprefs.setendpoints_path = setendpoints.path;
4281     <span class="keyword">else</span>
4282         guiprefs.setendpoints_path = pwd;
4283     <span class="keyword">end</span>
4284     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4285         guiprefs.setendpoints_file = setendpoints.file;
4286     <span class="keyword">else</span>
4287         guiprefs.setendpoints_file = <span class="string">''</span>;
4288     <span class="keyword">end</span>
4289 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4290     guiprefs.setendpoints_path = pwd;
4291     guiprefs.setendpoints_file = <span class="string">''</span>;
4292     
4293     setendpoints.path = pwd;
4294     setendpoints.file = <span class="string">''</span>;
4295     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4296 <span class="keyword">end</span>
4297 
4298 <span class="comment">% [EOF] load_prefs</span>
4299 
4300 
4301 <span class="comment">% --------------------------------------------------------------------</span>
4302 <a name="_sub100" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4303 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4304 <span class="comment">% preferences data.</span>
4305 
4306 <span class="comment">% Preferences:</span>
4307 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4308 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4309 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4310 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4311 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4312 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4313 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4314 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4315 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4316 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4317 <span class="comment">% 'renderer'             Default graphics renderer</span>
4318 <span class="comment">% 'units'                Default plotting units</span>
4319 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4320 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4321 <span class="comment">%                        started</span>
4322 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4323 
4324 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4325 
4326 <span class="keyword">switch</span> pref
4327     <span class="keyword">case</span> <span class="string">'ascii'</span>
4328         ascii.path = guiprefs.ascii_path;
4329         ascii.file = guiprefs.ascii_file;
4330         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4331     <span class="keyword">case</span> <span class="string">'mat'</span>
4332         mat.path = guiprefs.mat_path;
4333         mat.file = guiprefs.mat_file;
4334         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4335     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4336         tecplot.path = guiprefs.tecplot_path;
4337         tecplot.file = guiprefs.tecplot_file;
4338         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4339     <span class="keyword">case</span> <span class="string">'kmz'</span>
4340         kmz.path = guiprefs.kmz_path;
4341         kmz.file = guiprefs.kmz_file;
4342         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4343     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4344         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4345         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4346         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4347     <span class="keyword">case</span> <span class="string">'log'</span>
4348         log.path = guiprefs.log_path;
4349         log.file = guiprefs.log_file;
4350         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4351     <span class="keyword">case</span> <span class="string">'iric'</span>
4352         iric.path = guiprefs.iric_path;
4353         iric.file = guiprefs.iric_file;
4354         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4355     <span class="keyword">case</span> <span class="string">'excel'</span>
4356         excel.path = guiprefs.excel_path;
4357         excel.file = guiprefs.excel_file;
4358         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4359     <span class="keyword">case</span> <span class="string">'aerial'</span>
4360         aerial.path = guiprefs.aerial_path;
4361         aerial.file = guiprefs.aerial_file;
4362         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4363     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4364         shoreline.path = guiprefs.shoreline_path;
4365         shoreline.file = guiprefs.shoreline_file;
4366         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4367     <span class="keyword">case</span> <span class="string">'renderer'</span>
4368         renderer = guiprefs.renderer;
4369         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4370     <span class="keyword">case</span> <span class="string">'units'</span>
4371         units = guiprefs.units;
4372         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4373     <span class="keyword">case</span> <span class="string">'plotref'</span>
4374         plotref = guiprefs.plotref;
4375         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4376     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4377         runcounter = guiprefs.runcounter;
4378         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4379     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4380         setendpoints.path = guiprefs.setendpoints_path;
4381         setendpoints.file = guiprefs.setendpoints_file;
4382         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4383     <span class="keyword">otherwise</span>
4384 <span class="keyword">end</span>
4385 
4386 <span class="comment">% if ismember(pref,prefs)</span>
4387 <span class="comment">%     setpref('VMT',pref,value)</span>
4388 <span class="comment">%</span>
4389 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4390 <span class="comment">%     guiprefs.(pref) = value;</span>
4391 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4392 <span class="comment">% end</span>
4393 
4394 <span class="comment">% [EOF] store_prefs</span>
4395 
4396 
4397 <span class="comment">% --------------------------------------------------------------------</span>
4398 <a name="_sub101" href="#_subfunctions" class="code">function initGUI(handles)</a>
4399 <span class="comment">% Initialize the UI controls in the GUI.</span>
4400 
4401 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4402 
4403 <span class="comment">% Set the name and version</span>
4404 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4405     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4406 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4407 
4408 <span class="comment">% Set the PLOT 1 axis labels</span>
4409 axes(handles.Plot1Shiptracks);
4410 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4411 xlabel(<span class="string">'UTM Easting (m)'</span>)
4412 ylabel(<span class="string">'UTM Northing (m)'</span>)
4413 box on
4414 grid on
4415 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4416 
4417 <span class="comment">%%%%%%%%%%%%</span>
4418 <span class="comment">% MENU BAR %</span>
4419 <span class="comment">%%%%%%%%%%%%</span>
4420 <span class="keyword">if</span> guiparams.english_units
4421     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4422     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4423 <span class="keyword">else</span>
4424     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4425     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4426 <span class="keyword">end</span>
4427 
4428 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4429     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4430     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4431 <span class="keyword">else</span>
4432     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4433     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4434 <span class="keyword">end</span>
4435 
4436 
4437 <span class="keyword">if</span> guiparams.print
4438     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4439     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4440     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4441     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4442 <span class="keyword">elseif</span> guiparams.presentation
4443     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4444     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4445     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4446     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4447 <span class="keyword">else</span>
4448 <span class="keyword">end</span>
4449 
4450 <span class="keyword">switch</span> guiparams.renderer
4451     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4452         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4453         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4454         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4455     <span class="keyword">case</span> <span class="string">'painters'</span>
4456         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4457         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4458         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4459     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4460         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4461         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4462         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4463 <span class="keyword">end</span>
4464 
4465 
4466 <span class="comment">%%%%%%%%%%%%%%%</span>
4467 <span class="comment">% DATA EXPORT %</span>
4468 <span class="comment">%%%%%%%%%%%%%%%</span>
4469 <span class="comment">% BathymetryPanel</span>
4470 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4471 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4472 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4473 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4474 
4475 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4476 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4477 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4478 <span class="comment">% PlanViewPanel</span>
4479 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4480 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4481 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4482 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4483 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4484 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4485 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4486 
4487 <span class="comment">%%%%%%%%%%%</span>
4488 <span class="comment">% OFFSETS %</span>
4489 <span class="comment">%%%%%%%%%%%</span>
4490 <span class="comment">% OffsetsPanel</span>
4491 set(handles.WaterSurfaceElevation,       <span class="string">'String'</span>,guiparams.water_surface_elevation)
4492 set(handles.BedElevation,                <span class="string">'String'</span>,guiparams.bed_elevation)
4493 set(handles.KMZVerticalOffset,           <span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
4494 
4495 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4496 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4497 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4498 <span class="comment">% ShiptracksPanel</span>
4499 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4500 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4501 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4502 
4503 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4504 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4505 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4506 <span class="comment">% CrossSectionsPanel</span>
4507 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4508     <span class="string">'Value'</span>, guiparams.idx_contour)
4509 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4510 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4511 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4512 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4513 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4514 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4515 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4516 set(handles.AllowVMTFlipFlux,           <span class="string">'Value'</span>, guiparams.allow_vmt_flip_flux)
4517 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4518     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4519 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4520 
4521 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4522 
4523 <span class="comment">% [EOF] initGUI</span>
4524 
4525 
4526 <span class="comment">% --------------------------------------------------------------------</span>
4527 <a name="_sub102" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4528 
4529 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4530 
4531 <span class="keyword">switch</span> enable_state
4532     <span class="keyword">case</span> <span class="string">'init'</span>
4533         guiparams.gui_state = <span class="string">'init'</span>;
4534         set([handles.menuFile
4535             handles.menuOpen
4536             handles.menuOpenASCII
4537             handles.menuOpenMAT
4538             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4539         
4540         set([handles.toolbarLoadData
4541             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4542         set([handles.toolbarSaveMatFile
4543             handles.toolbarSaveBathymetry
4544             handles.toolbarSaveFigures
4545             handles.toolbarSaveExcel
4546             handles.toolbarPlottingParameters
4547             handles.toolbarProcessingParameters
4548             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4549         
4550         set([handles.DepthRangeMin
4551             handles.DepthRangeMax
4552             handles.VectorScalePlanView
4553             handles.VectorSpacingPlanview
4554             handles.SmoothingWindowSize
4555             handles.DisplayShoreline
4556             handles.AddBackground
4557             handles.PlotPlanView
4558             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4559         
4560         set([handles.WaterSurfaceElevation
4561             handles.BedElevation
4562             handles.KMZVerticalOffset
4563             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4564         
4565         set([handles.HorizontalGridNodeSpacing
4566             handles.VerticalGridNodeSpacing
4567             handles.PlotShiptracks
4568             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4569         
4570         set([handles.Contour
4571             handles.VerticalExaggeration
4572             handles.VectorScaleCrossSection
4573             handles.HorizontalVectorSpacing
4574             handles.VerticalVectorSpacing
4575             handles.HorizontalSmoothingWindow
4576             handles.VerticalSmoothingWindow
4577             handles.PlotSecondaryFlowVectors
4578             handles.AllowVMTFlipFlux
4579             handles.AllowVMTFlipFluxText
4580             handles.SecondaryFlowVectorVariable
4581             handles.IncludeVerticalVelocity
4582             handles.IncludeVerticalVelocityText
4583             handles.PlotCrossSection
4584             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4585         
4586     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4587         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4588         set([handles.menuFile
4589             handles.menuOpen
4590             handles.menuOpenASCII
4591             handles.menuOpenMAT
4592             handles.menuSaveMAT
4593             handles.menuSaveTecplot
4594             handles.menuSaveKMZFile
4595             handles.menuParameters
4596             handles.menuPlottingParameters
4597             handles.menuMetric
4598             handles.menuEnglish
4599             handles.menuBathymetryExportSettings
4600             handles.menuExportMultibeamBathymetry
4601             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4602             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4603         
4604         set([handles.toolbarLoadData
4605             handles.toolbarSaveMatFile
4606             handles.toolbarSaveBathymetry
4607             handles.toolbarSaveExcel
4608             handles.toolbarSaveFigures
4609             handles.toolbarPlottingParameters
4610             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4611         set([handles.toolbarProcessingParameters
4612             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4613         
4614            
4615         set([handles.DepthRangeMin
4616             handles.DepthRangeMax
4617             handles.VectorScalePlanView
4618             handles.VectorSpacingPlanview
4619             handles.SmoothingWindowSize
4620             handles.DisplayShoreline
4621             handles.PlotPlanView
4622             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4623         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4624             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4625         <span class="keyword">else</span>
4626             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4627         <span class="keyword">end</span>
4628         
4629         set([handles.WaterSurfaceElevation
4630             handles.BedElevation
4631             handles.KMZVerticalOffset
4632             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4633         
4634         set([handles.HorizontalGridNodeSpacing
4635             handles.VerticalGridNodeSpacing
4636             handles.PlotShiptracks
4637             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4638         
4639         set([handles.Contour
4640             handles.VerticalExaggeration
4641             handles.VectorScaleCrossSection
4642             handles.HorizontalVectorSpacing
4643             handles.VerticalVectorSpacing
4644             handles.HorizontalSmoothingWindow
4645             handles.VerticalSmoothingWindow
4646             handles.PlotSecondaryFlowVectors
4647             handles.AllowVMTFlipFlux
4648             handles.AllowVMTFlipFluxText
4649             handles.SecondaryFlowVectorVariable
4650             handles.IncludeVerticalVelocity
4651             handles.IncludeVerticalVelocityText
4652             handles.PlotCrossSection
4653             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4654     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4655         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4656         set([handles.menuFile
4657             handles.menuOpen
4658             handles.menuOpenASCII
4659             handles.menuOpenMAT
4660             handles.menuParameters
4661             handles.menuPlottingParameters
4662             handles.menuMetric
4663             handles.menuEnglish
4664             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4665         set([handles.menuSaveMAT
4666             handles.menuBathymetryExportSettings
4667             handles.menuExportMultibeamBathymetry
4668             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4669             handles.menuSaveKMZFile
4670             handles.menuSaveTecplot
4671             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4672         
4673         set([handles.toolbarLoadData
4674             handles.toolbarSaveFigures
4675             handles.toolbarPlottingParameters
4676             handles.toolbarSaveExcel
4677             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4678         set([handles.toolbarProcessingParameters
4679             handles.toolbarSaveMatFile
4680             handles.toolbarSaveBathymetry
4681             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4682         
4683         set([handles.DepthRangeMin
4684             handles.DepthRangeMax
4685             handles.VectorScalePlanView
4686             handles.VectorSpacingPlanview
4687             handles.SmoothingWindowSize
4688             handles.DisplayShoreline
4689             handles.PlotPlanView
4690             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4691         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4692             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4693         <span class="keyword">else</span>
4694             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4695         <span class="keyword">end</span>
4696         
4697         set([handles.HorizontalGridNodeSpacing
4698             handles.VerticalGridNodeSpacing
4699             handles.PlotShiptracks
4700             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4701         
4702         set([handles.Contour
4703             handles.VerticalExaggeration
4704             handles.VectorScaleCrossSection
4705             handles.HorizontalVectorSpacing
4706             handles.VerticalVectorSpacing
4707             handles.HorizontalSmoothingWindow
4708             handles.VerticalSmoothingWindow
4709             handles.PlotSecondaryFlowVectors
4710             handles.AllowVMTFlipFlux
4711             handles.AllowVMTFlipFluxText
4712             handles.SecondaryFlowVectorVariable
4713             handles.IncludeVerticalVelocity
4714             handles.IncludeVerticalVelocityText
4715             handles.PlotCrossSection
4716             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4717     <span class="keyword">otherwise</span>
4718 <span class="keyword">end</span>
4719 
4720 <span class="comment">% Save Application Data</span>
4721 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4722 
4723 <span class="comment">% [EOF] set_enable</span>
4724 
4725 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4726 
4727 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4728 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4729 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4730 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4731 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4732 
4733 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4734 
4735 
4736 <span class="comment">% --------------------------------------------------------------------</span>
4737 <a name="_sub103" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4738     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4739 
4740 w = 500;
4741 h = 110;
4742 dx = 10;
4743 dy = 35;
4744 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4745 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4746     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4747     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4748     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4749     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4750     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4751     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4752     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4753     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4754     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4755     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4756 dialog_params.english_units               = english_units;
4757 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4758 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4759 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4760 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4761 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4762 
4763 <span class="comment">% Build the graphics:</span>
4764 <span class="comment">% -------------------</span>
4765 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4766     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4767     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4768     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4769 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4770     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4771     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4772     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4773     <span class="string">'Position'</span>,[15 35 100 22]);
4774 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4775     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4776     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4777     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4778     <span class="string">'Position'</span>,[15 10 100 22]);
4779 
4780 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4781     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4782     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4783     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4784 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4785     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4786     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4787     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4788     <span class="string">'Position'</span>,[15 35 100 22]);
4789 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4790     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4791     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4792     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4793     <span class="string">'Position'</span>,[15 10 100 22]);
4794 
4795 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4796     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4797     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4798     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4799 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4800     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4801     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4802     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4803     <span class="string">'Position'</span>,[15 35 100 22]);
4804 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4805     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4806     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4807     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4808     <span class="string">'Position'</span>,[15 10 100 22]);
4809 
4810 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4811     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4812     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4813     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4814     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4815 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4816     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4817     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4818     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4819     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4820 
4821 <span class="comment">% Update the UI controls:</span>
4822 <span class="comment">% -----------------------</span>
4823 <span class="keyword">if</span> dialog_params.english_units
4824     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4825     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4826 <span class="keyword">else</span>
4827     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4828     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4829 <span class="keyword">end</span>
4830 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4831     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4832     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4833 <span class="keyword">else</span>
4834     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4835     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4836 <span class="keyword">end</span>
4837 <span class="keyword">if</span> dialog_params.presentation
4838     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4839     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4840 <span class="keyword">else</span>
4841     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4842     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4843 <span class="keyword">end</span>
4844 
4845 <span class="comment">% Set the callbacks:</span>
4846 <span class="comment">% ------------------</span>
4847 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4848 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4849 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4850 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4851 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4852 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4853 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4854 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4855 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4856 
4857 <span class="comment">% Position the dialog and make it visible:</span>
4858 <span class="comment">% ----------------------------------------</span>
4859 fpos = get(hf,<span class="string">'Position'</span>);
4860 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4861 movegui(handles.Figure,dpos)
4862 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4863 
4864 <span class="comment">% Hold the dialog open:</span>
4865 <span class="comment">% ---------------------</span>
4866 waitfor(handles.OK)
4867 
4868 <span class="comment">% Return the outputs and close the dialog:</span>
4869 <span class="comment">% ----------------------------------------</span>
4870 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4871 english_units = dialog_params.english_units;
4872 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4873 plot_presentation_style =  dialog_params.presentation;
4874 plot_print_style =  dialog_params.print;
4875 
4876 delete(handles.Figure)
4877 
4878 <span class="comment">% [EOF] plotParametersDialog</span>
4879 
4880 
4881 <span class="comment">% --------------------------------------------------------------------</span>
4882 <a name="_sub104" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4883 
4884 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4885 <span class="keyword">switch</span> the_units
4886     <span class="keyword">case</span> <span class="string">'metric'</span>
4887         dialog_params.english_units = false;
4888         
4889         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4890         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4891     <span class="keyword">case</span> <span class="string">'english'</span>
4892         dialog_params.english_units = true;
4893         
4894         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4895         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4896     <span class="keyword">otherwise</span>
4897 <span class="keyword">end</span>
4898 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4899 
4900 <span class="comment">% [EOF] dialogUnits</span>
4901 
4902 <span class="comment">% --------------------------------------------------------------------</span>
4903 <a name="_sub105" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4904 
4905 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4906 <span class="keyword">switch</span> the_endpoints
4907     <span class="keyword">case</span> <span class="string">'auto'</span>
4908         dialog_params.set_cross_section_endpoints = false;
4909         
4910         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4911         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4912     <span class="keyword">case</span> <span class="string">'manual'</span>
4913         dialog_params.set_cross_section_endpoints = true;
4914         
4915         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4916         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4917     <span class="keyword">otherwise</span>
4918 <span class="keyword">end</span>
4919 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4920 
4921 <span class="comment">% [EOF] dialogEnpoints</span>
4922 
4923 <a name="_sub106" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4924 
4925 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4926 <span class="keyword">switch</span> the_style
4927     <span class="keyword">case</span> <span class="string">'presentation'</span>
4928         dialog_params.presentation  = true;
4929         dialog_params.print         = false;
4930         
4931         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4932         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4933     <span class="keyword">case</span> <span class="string">'print'</span>
4934         dialog_params.presentation  = false;
4935         dialog_params.print         = true;
4936         
4937         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4938         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4939     <span class="keyword">otherwise</span>
4940 <span class="keyword">end</span>
4941 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4942 
4943 <span class="comment">% [EOF] dialogEnpoints</span>
4944 
4945 <span class="comment">% --------------------------------------------------------------------</span>
4946 <a name="_sub107" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4947 
4948 delete(h_OK)
4949 
4950 <span class="comment">% [EOF] dialogOK</span>
4951 
4952 <span class="comment">% --------------------------------------------------------------------</span>
4953 <a name="_sub108" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4954 <span class="comment">% Return the original inputs</span>
4955 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4956 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4957 delete(handles.OK)
4958 
4959 <span class="comment">% [EOF] dialogCancel</span>
4960 
4961 <span class="comment">% --------------------------------------------------------------------</span>
4962 <a name="_sub109" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4963 
4964 delete(h_OK)
4965 
4966 <span class="comment">% [EOF] dialogCloseReq</span>
4967 
4968 <a name="_sub110" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4969     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4970 w = 230;
4971 h = 245;
4972 dx = 10;
4973 dy = 35;
4974 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4975 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4976     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4977     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4978     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4979     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4980     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4981     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4982     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4983     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4984     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4985     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4986 dialog_params.beam_angle             = beam_angle;
4987 dialog_params.magnetic_variation     = magnetic_variation;
4988 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4989     dialog_params.wse                = <span class="string">'tide'</span>;
4990     wse_string                       = <span class="string">'tide'</span>;
4991 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4992     dialog_params.wse                = <span class="string">'tide'</span>;
4993     wse_string                       = <span class="string">'tide'</span>;
4994 <span class="keyword">else</span>
4995     dialog_params.wse                = wse;
4996     wse_string                       = num2str(wse);
4997 <span class="keyword">end</span>
4998 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4999 dialog_params.output_auxiliary_data  = output_auxiliary_data;
5000 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5001 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5002 
5003 <span class="comment">% Build the graphics:</span>
5004 <span class="comment">% -------------------</span>
5005 ph = 150;
5006 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5007     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
5008     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5009     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5010 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5011     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5012     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
5013     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5014     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5015     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5016     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
5017 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5018     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5019     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
5020     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
5021     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5022     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5023     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
5024 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5025     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5026     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
5027     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5028     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5029     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5030     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
5031 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5032     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5033     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5034     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
5035     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5036     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5037     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
5038 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5039     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5040     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
5041     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5042     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5043     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5044     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
5045 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5046     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5047     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5048     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
5049     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5050     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5051     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
5052 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5053     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5054     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5055     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
5056     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
5057 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5058     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5059     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
5060     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5061     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
5062 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5063     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5064     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5065     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5066     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5067 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5068     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5069     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5070     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5071     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5072 
5073 <span class="comment">% Update the UI controls:</span>
5074 <span class="comment">% -----------------------</span>
5075 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
5076 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
5077 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
5078 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
5079 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
5080 
5081 <span class="comment">% Set the callbacks:</span>
5082 <span class="comment">% ------------------</span>
5083 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5084 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5085 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5086 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5087 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5088 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5089 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
5090 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
5091 
5092 <span class="comment">% Position the dialog and make it visible:</span>
5093 <span class="comment">% ----------------------------------------</span>
5094 fpos = get(hf,<span class="string">'Position'</span>);
5095 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5096 movegui(handles.Figure,dpos)
5097 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5098 
5099 <span class="comment">% Hold the dialog open:</span>
5100 <span class="comment">% ---------------------</span>
5101 waitfor(handles.OK)
5102 
5103 <span class="comment">% Return the outputs and close the dialog:</span>
5104 <span class="comment">% ----------------------------------------</span>
5105 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5106 beam_angle              = dialog_params.beam_angle;
5107 magnetic_variation      = dialog_params.magnetic_variation;
5108 wse                     = dialog_params.wse;
5109 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
5110 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
5111 
5112 delete(handles.Figure)
5113 
5114 <span class="comment">% [EOF] exportSettingsDialog</span>
5115 
5116 <span class="comment">% --------------------------------------------------------------------</span>
5117 <a name="_sub111" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
5118 
5119 <span class="comment">% Grab the current data</span>
5120 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5121 
5122 <span class="comment">% Set it according to the dialog box values</span>
5123 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
5124 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
5125 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
5126 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
5127 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
5128 
5129 <span class="comment">% Re-store the application data</span>
5130 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5131 
5132 <span class="comment">% [EOF] dialogExportSettings</span>
5133 
5134 <a name="_sub112" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
5135 
5136 w = 230;
5137 h = 200;
5138 dx = 10;
5139 dy = 35;
5140 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
5141 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
5142     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
5143     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5144     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
5145     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
5146     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5147     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5148     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5149     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
5150     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5151     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
5152 dialog_params.figure_names               = figure_names;
5153 dialog_params.selected_figures           = <span class="string">''</span>;
5154 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5155 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5156 
5157 <span class="comment">% Build the graphics:</span>
5158 <span class="comment">% -------------------</span>
5159 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5160     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
5161     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5162     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5163 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
5164     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
5165     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
5166     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
5167     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
5168     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
5169     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5170     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5171 
5172 
5173 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5174     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5175     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5176     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5177     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5178 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5179     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5180     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5181     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5182     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5183 
5184 <span class="comment">% Update the UI controls:</span>
5185 <span class="comment">% -----------------------</span>
5186 
5187 
5188 <span class="comment">% Set the callbacks:</span>
5189 <span class="comment">% ------------------</span>
5190 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5191 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub113" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5192 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5193 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5194 
5195 <span class="comment">% Position the dialog and make it visible:</span>
5196 <span class="comment">% ----------------------------------------</span>
5197 fpos = get(hf,<span class="string">'Position'</span>);
5198 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5199 movegui(handles.Figure,dpos)
5200 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5201 
5202 <span class="comment">% Hold the dialog open:</span>
5203 <span class="comment">% ---------------------</span>
5204 waitfor(handles.OK)
5205 
5206 <span class="comment">% Return the outputs and close the dialog:</span>
5207 <span class="comment">% ----------------------------------------</span>
5208 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5209 selected_figures = dialog_params.selected_figures;
5210 
5211 delete(handles.Figure)
5212 
5213 <span class="comment">% [EOF] openFiguresDialog</span>
5214 
5215 <span class="comment">% --------------------------------------------------------------------</span>
5216 <a name="_sub113" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5217 
5218 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5219 
5220 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5221 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5222 selected     = fig_names(idx_selected);
5223 dialog_params.selected_figures = selected;
5224 
5225 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5226 
5227 
5228 
5229 <span class="comment">% --------------------------------------------------------------------</span>
5230 <a name="_sub114" href="#_subfunctions" class="code">function icons = getIcons</a>
5231 
5232 <span class="comment">% Load data</span>
5233 idx = 1;
5234 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5235     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5236     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5237     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5238     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5239     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5240     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5241     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5242     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5243     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5244     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5245     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5246     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5247     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5248     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5249     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5250     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5251 
5252 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5253     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5254     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5255     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5256     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5257     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5258     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5259     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5260     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5261     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5262     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5263     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5264     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5265     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5266     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5267     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5268     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5269 
5270 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5271     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5272     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5273     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5274     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5275     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5276     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5277     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5278     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5279     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5280     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5281     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5282     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5283     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5284     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5285     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5286     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5287 
5288 <span class="comment">% Save data</span>
5289 idx = idx+1;
5290 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5291     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5292     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5293     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5294     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5295     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5296     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5297     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5298     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5299     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5300     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5301     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5302     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5303     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5304     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5305     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5306     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5307 
5308 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5309     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5310     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5311     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5312     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5313     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5314     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5315     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5316     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5317     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5318     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5319     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5320     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5321     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5322     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5323     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5324     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5325 
5326 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5327     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5328     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5329     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5330     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5331     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5332     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5333     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5334     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5335     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5336     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5337     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5338     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5339     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5340     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5341     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5342     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5343 
5344 <span class="comment">% Plotting parameters</span>
5345 idx = idx+1;
5346 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5347     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5348     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5349     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5350     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5351     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5352     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5353     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5354     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5355     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5356     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5357     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5358     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5359     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5360     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5361     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5362     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5363 
5364 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5365     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5366     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5367     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5368     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5369     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5370     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5371     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5372     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5373     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5374     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5375     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5376     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5377     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5378     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5379     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5380     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5381 
5382 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5383     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5384     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5385     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5386     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5387     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5388     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5389     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5390     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5391     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5392     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5393     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5394     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5395     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5396     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5397     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5398     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5399 
5400 <span class="comment">% Processing parameters</span>
5401 idx = idx+1;
5402 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5403     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5404     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5405     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5406     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5407     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5408     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5409     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5410     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5411     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5412     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5413     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5414     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5415     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5416     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5417     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5418     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5419 
5420 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5421     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5422     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5423     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5424     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5425     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5426     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5427     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5428     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5429     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5430     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5431     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5432     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5433     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5434     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5435     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5436     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5437 
5438 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5439     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5440     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5441     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5442     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5443     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5444     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5445     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5446     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5447     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5448     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5449     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5450     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5451     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5452     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5453     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5454     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5455 
5456 <span class="comment">% Export bathymetry dialog</span>
5457 idx = idx+1;
5458 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5459     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5460     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5461     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5462     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5463     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5464     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5465     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5466     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5467     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5468     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5469     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5470     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5471     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5472     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5473     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5474     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5475     ]/255;
5476 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5477     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5478     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5479     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5480     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5481     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5482     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5483     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5484     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5485     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5486     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5487     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5488     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5489     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5490     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5491     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5492     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5493     ]/255;
5494 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5495     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5496     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5497     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5498     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5499     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5500     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5501     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5502     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5503     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5504     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5505     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5506     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5507     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5508     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5509     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5510     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5511     ]/255;
5512 
5513 <span class="comment">% Export Figures Dialog</span>
5514 idx = idx + 1;
5515 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5516     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5517     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5518     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5519     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5520     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5521     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5522     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5523     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5524     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5525     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5526     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5527     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5528     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5529     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5530     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5531 
5532 
5533 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5534     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5535     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5536     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5537     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5538     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5539     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5540     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5541     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5542     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5543     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5544     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5545     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5546     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5547     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5548     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5549 
5550 
5551 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5552     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5553     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5554     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5555     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5556     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5557     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5558     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5559     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5560     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5561     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5562     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5563     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5564     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5565     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5566     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5567 
5568 <span class="comment">% Export Excel File</span>
5569 idx = idx + 1;
5570 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5571     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5572    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5573    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5574    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5575    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5576    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5577    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5578    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5579    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5580    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5581    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5582    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5583    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5584    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5585    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5586     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5587 
5588 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5589     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5590    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5591    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5592    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5593    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5594    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5595    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5596    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5597    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5598    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5599    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5600    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5601    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5602    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5603    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5604     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5605 
5606 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5607     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5608    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5609    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5610    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5611    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5612    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5613    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5614    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5615    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5616    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5617    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5618    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5619    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5620    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5621    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5622     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5623 
5624 <span class="comment">% Zoom In</span>
5625 idx = idx + 1;
5626 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5627     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5628 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5629     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5630 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5631     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5632 
5633 <span class="comment">% Zoom Out</span>
5634 idx = idx + 1;
5635 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5636     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5637 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5638     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5639 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5640     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5641 
5642 <span class="comment">% Pan</span>
5643 idx = idx + 1;
5644 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5645     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5646 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5647     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5648 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5649     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5650 <span class="comment">% [EOF] getIcons</span>
5651 
5652 <a name="_sub115" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5653 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5654 
5655 <span class="comment">% Check for any stored prefs</span>
5656 <span class="comment">% --------------------------</span>
5657 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5658 guiprefs = getpref(<span class="string">'VMT'</span>);
5659 
5660 <span class="comment">% Organized by GUI panels</span>
5661 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5662 <span class="comment">% SHIPTRACKS PLOT %</span>
5663 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5664 guiparams.horizontal_grid_node_spacing       = 1.0;
5665 guiparams.vertical_grid_node_spacing         = 0.4;
5666 
5667 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5668 <span class="comment">% CROSS SECTION PLOT %</span>
5669 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5670 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5671 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5672 guiparams.idx_contour                        = 1;
5673 guiparams.vertical_exaggeration              = 10;
5674 guiparams.vector_scale_cross_section         = 0.2;
5675 guiparams.horizontal_vector_spacing          = 1;
5676 guiparams.vertical_vector_spacing            = 1;
5677 guiparams.horizontal_smoothing_window        = 1;
5678 guiparams.vertical_smoothing_window          = 1;
5679 guiparams.plot_secondary_flow_vectors        = true;
5680 guiparams.allow_vmt_flip_flux                = true;
5681 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5682 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5683 guiparams.idx_secondary_flow_vector_variable = 1;
5684 guiparams.include_vertical_velocity          = true;
5685 
5686 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5687 <span class="comment">% PLAN VIEW PLOT %</span>
5688 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5689 guiparams.depth_range_min                    = 0;
5690 guiparams.depth_range_max                    = inf;
5691 guiparams.vector_scale_plan_view             = 1;
5692 guiparams.vector_spacing_plan_view           = 1;
5693 guiparams.smoothing_window_size              = 1;
5694 guiparams.display_shoreline                  = false;
5695 guiparams.add_background                     = false;
5696 
5697 <span class="comment">%%%%%%%%%%%</span>
5698 <span class="comment">% OFFSETS %</span>
5699 <span class="comment">%%%%%%%%%%%</span>
5700 guiparams.water_surface_elevation            = 0.0;
5701 guiparams.bed_elevation                      = 0.0;
5702 guiparams.KMZ_vertical_offset                = 0.0;
5703 
5704 <span class="comment">%%%%%%%%%%%%%%%</span>
5705 <span class="comment">% DATA EXPORT %</span>
5706 <span class="comment">%%%%%%%%%%%%%%%</span>
5707 guiparams.beam_angle                         = 20.0;
5708 guiparams.magnetic_variation                 = 0.0;
5709 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5710 guiparams.load_wse_tide_file                 = false;
5711 guiparams.output_auxiliary_data              = false;
5712 
5713 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5714 <span class="comment">% Contour variables %</span>
5715 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5716 idx = 1;
5717 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5718 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5719 idx = idx + 1;
5720 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5721 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5722 idx = idx + 1;
5723 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5724 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5725 idx = idx + 1;
5726 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5727 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5728 idx = idx + 1;
5729 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5730 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5731 idx = idx + 1;
5732 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5733 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5734 idx = idx + 1;
5735 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5736 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5737 idx = idx + 1;
5738 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5739 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5740 idx = idx + 1;
5741 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5742 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5743 idx = idx + 1;
5744 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5745 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5746 idx = idx + 1;
5747 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5748 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5749 idx = idx + 1;
5750 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5751 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5752 idx = idx + 1;
5753 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5754 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5755 idx = idx + 1;
5756 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5757 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5758 idx = idx + 1;
5759 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5760 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5761 idx = idx + 1;
5762 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5763 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5764 idx = idx + 1;
5765 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5766 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5767 idx = idx + 1;
5768 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5769 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5770 idx = idx + 1;
5771 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5772 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5773 idx = idx + 1;
5774 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5775 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5776 
5777 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5778 
5779 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5780 <span class="comment">% Secondary Flow Vector Variables %</span>
5781 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5782 idx = 1;
5783 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5784 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5785 idx = idx + 1;
5786 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5787 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5788 idx = idx + 1;
5789 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5790 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5791 idx = idx + 1;
5792 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5793 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5794 idx = idx + 1;
5795 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5796 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5797 
5798 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5799     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5800 
5801 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5802 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5803 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5804 <span class="comment">% Menu bar options</span>
5805 guiparams.presentation                       = true;
5806 guiparams.print                              = false;
5807 guiparams.set_cross_section_endpoints        = false;
5808 guiparams.unit_discharge_correction          = false;
5809 
5810 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5811     <span class="keyword">switch</span> guiprefs.units
5812         <span class="keyword">case</span> <span class="string">'metric'</span>
5813             guiparams.english_units          = false;
5814         <span class="keyword">case</span> <span class="string">'english'</span>
5815             guiparams.english_units          = true;
5816     <span class="keyword">end</span>
5817 <span class="keyword">else</span>
5818     guiparams.english_units                  = false;
5819 <span class="keyword">end</span>
5820 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5821     <span class="keyword">switch</span> guiprefs.plotref
5822         <span class="keyword">case</span> <span class="string">'dfs'</span>
5823             guiparams.plotref                 = <span class="string">'dfs'</span>;
5824         <span class="keyword">case</span> <span class="string">'hab'</span>
5825             guiparams.plotref                 = <span class="string">'hab'</span>;
5826     <span class="keyword">end</span>
5827 <span class="keyword">else</span>
5828     guiparams.plotref                         = <span class="string">'dfs'</span>;
5829 <span class="keyword">end</span>
5830 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5831 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5832 
5833 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5834     guiparams.renderer                       = guiprefs.renderer;
5835 <span class="keyword">else</span>
5836     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5837 <span class="keyword">end</span>
5838 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5839 <span class="comment">% guiparams.plot_planview                      = false;</span>
5840 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5841 
5842 <span class="comment">% File location defaults</span>
5843 guiparams.ascii_path                        = pwd;
5844 guiparams.ascii_file                        = <span class="string">''</span>;
5845 guiparams.mat_path                          = pwd;
5846 guiparams.mat_file                          = <span class="string">''</span>;
5847 guiparams.tecplot_path                      = pwd;
5848 guiparams.tecplot_file                      = <span class="string">''</span>;
5849 guiparams.kmz_path                          = pwd;
5850 guiparams.kmz_file                          = <span class="string">''</span>;
5851 guiparams.multibeambathymetry_path          = pwd;
5852 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5853 guiparams.log_path                          = pwd;
5854 guiparams.log_file                          = <span class="string">''</span>;
5855 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5856 <span class="comment">% application</span>
5857 <span class="keyword">if</span> isdeployed 
5858     guiparams.has_mapping_toolbox           = true;
5859 <span class="keyword">else</span>
5860     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5861         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5862 <span class="keyword">end</span>
5863 
5864 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5865 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5866 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5867 guiparams.z                      = [];
5868 guiparams.A                      = [];
5869 guiparams.V                      = [];
5870 guiparams.Map                    = [];
5871 guiparams.savefile               = [];
5872 guiparams.iric_anv_planview_data = [];
5873 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5874 <span class="comment">% guiparams.zmax = [];</span>
5875 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5876 guiparams.data_folder = <span class="string">''</span>;
5877 guiparams.data_files  = {<span class="string">''</span>};
5878 guiparams.gui_state   = <span class="string">'init'</span>;
5879 
5880 <span class="comment">% [EOF] createGUIparams</span>
5881 
5882 <a name="_sub116" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5883 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5884 
5885 <a name="_sub117" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5886 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5887 
5888 <span class="comment">% [EOF] VMT</span>
5889 
5890 
5891 
5892 
5893 
5894 <span class="comment">% --- Hidden keyboard commands</span>
5895 <a name="_sub118" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5896 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5897 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5898 <span class="comment">%</span>
5899 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5900 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5901 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5902 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5903 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5904 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5905 
5906 in1 = eventdata.Modifier; 
5907 in2 = eventdata.Key;
5908 
5909 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5910     input = [in1{:} in2];
5911 <span class="keyword">else</span>
5912     input = in2;
5913 <span class="keyword">end</span>
5914 
5915 <span class="keyword">switch</span> input
5916     <span class="comment">% Hidden SonTek M9 support</span>
5917     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5918         msgtxt = {<span class="keyword">...</span>
5919             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5920             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5921             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5922             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5923             <span class="string">''</span>;<span class="keyword">...</span>
5924             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5925             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5926             <span class="string">'PROVISIONAL at best.'</span>};
5927         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5928         
5929         <span class="comment">% Get the Application data:</span>
5930         <span class="comment">% -------------------------</span>
5931         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5932         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5933         
5934         <span class="comment">% Ask the user to select files:</span>
5935         <span class="comment">% -----------------------------</span>
5936         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5937         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5938         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5939             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5940         <span class="keyword">else</span>
5941             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5942         <span class="keyword">end</span>
5943         [filename,pathname] = <span class="keyword">...</span>
5944             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5945             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5946             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5947         
5948         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5949             guiparams.data_folder = pathname;
5950             <span class="keyword">if</span> ischar(filename)
5951                 filename = {filename};
5952             <span class="keyword">end</span>
5953             guiparams.data_files = filename;
5954             guiparams.mat_file = <span class="string">''</span>;
5955             
5956             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5957             
5958             
5959             
5960             <span class="comment">% Update the preferences:</span>
5961             <span class="comment">% -----------------------</span>
5962             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5963             guiprefs.ascii_path = pathname;
5964             guiprefs.ascii_file = filename;
5965             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5966             <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5967             
5968             <span class="comment">% Push messages to Log Window:</span>
5969             <span class="comment">% ----------------------------</span>
5970             log_text = {<span class="keyword">...</span>
5971                 <span class="string">''</span>;<span class="keyword">...</span>
5972                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5973                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5974                 guiparams.data_folder;
5975                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5976                 char(filename)};
5977             statusLogging(handles.LogWindow, log_text)
5978             
5979             <span class="comment">% Read the file(s)</span>
5980             <span class="comment">% ----------------</span>
5981             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5982             
5983             [~,~,savefile,A,z] = <span class="keyword">...</span>
5984                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5985             guiparams.savefile = savefile;
5986             guiparams.A        = A;
5987             guiparams.z        = z;
5988             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5989             
5990             
5991             <span class="comment">% Update the GUI:</span>
5992             <span class="comment">% ---------------</span>
5993             <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5994         <span class="keyword">end</span>  
5995     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5996         SontekMAT2KML;
5997     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5998         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5999         
6000     <span class="keyword">case</span> <span class="string">'controlalte'</span>
6001         VMT_BuildCustomFlatFile;
6002     <span class="keyword">otherwise</span>
6003         <span class="comment">%disp(input)</span>
6004 <span class="keyword">end</span>
6005 
6006 
6007 
6008 
6009 
6010 
6011 
6012 
6013 
6014</pre></div>
<hr><address>Generated on Thu 14-Jan-2016 15:28:39 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>