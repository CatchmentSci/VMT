<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub96" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub97" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub98" class="code">function initGUI(handles)</a></li><li><a href="#_sub99" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub100" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub101" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub102" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub103" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub104" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub106" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub108" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub110" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function icons = getIcons</a></li><li><a href="#_sub112" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub113" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub114" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub95" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub96" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub112" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.07'</span>; <span class="string">'r20150603'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub98" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub109" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.wse;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.wse = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.wse = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">end</span>
0651 <span class="comment">%  [EOF] loadTideFile</span>
0652 
0653 <span class="comment">% --------------------------------------------------------------------</span>
0654 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0655 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0656 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0657 
0658 
0659 <span class="comment">% --------------------------------------------------------------------</span>
0660 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0661 
0662 <span class="comment">% Get the Application Data:</span>
0663 <span class="comment">% -------------------------</span>
0664 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0665 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0666 PVdata    = guiparams.iric_anv_planview_data;
0667 iric_path = guiprefs.iric_path;
0668 iric_file = guiprefs.iric_file;
0669 
0670 <span class="comment">% Is there any planview data?</span>
0671 <span class="keyword">if</span> isempty(PVdata)
0672     <span class="comment">% Nothing to do, warn user</span>
0673     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0674     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0675 <span class="keyword">else</span>
0676     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0677     <span class="comment">% and smoothing (for iRiC)</span>
0678     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0679     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0680         fullfile(iric_path,iric_file));
0681     
0682     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0683         outfile = fullfile(iric_path,iric_file);
0684         log_text = vertcat(log_text,{outfile});
0685         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0686         outcount = fprintf(ofid,<span class="keyword">...</span>
0687             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0688         fclose(ofid);
0689     <span class="keyword">else</span>
0690         <span class="comment">% Return default iric_path and iric_file</span>
0691         iric_path = guiprefs.iric_path;
0692         iric_file = guiprefs.iric_file;
0693     <span class="keyword">end</span>
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% Push messages to Log Window:</span>
0697 <span class="comment">% ----------------------------</span>
0698 statusLogging(handles.LogWindow, log_text)
0699 
0700 <span class="comment">% Store the persistent preferences:</span>
0701 <span class="comment">% ---------------------------------</span>
0702 guiprefs.iric_file = iric_file;
0703 guiprefs.iric_path = iric_path;
0704 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0705 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0706 
0707 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0708 
0709 <span class="comment">% --------------------------------------------------------------------</span>
0710 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0711 <span class="comment">% Get the Application Data:</span>
0712 <span class="comment">% -------------------------</span>
0713 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0714 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0715 excel_path  = guiprefs.excel_path;
0716 excel_file  = guiprefs.excel_file;
0717 
0718 <span class="comment">% Push messages to Log Window:</span>
0719 <span class="comment">% ----------------------------</span>
0720 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0721 statusLogging(handles.LogWindow, log_text)
0722 
0723 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0724 <span class="comment">% data.</span>
0725 <span class="keyword">if</span> iscell(guiparams.mat_file)
0726     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0727     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0728     <span class="comment">% Refresh the Application Data:</span>
0729     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0730     z           = guiparams.z;
0731     A           = guiparams.A;
0732     V           = guiparams.V;
0733     Map         = guiparams.Map;
0734     wse         = guiparams.wse;
0735     PVdata      = guiparams.iric_anv_planview_data;
0736     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0737         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0738     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0739         fullfile(excel_path,excel_file));
0740     
0741     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0742         outfile = fullfile(excel_path,excel_file);
0743         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0744         
0745     <span class="keyword">else</span>
0746         <span class="comment">% Return default excel_path and excel_file</span>
0747         excel_path = guiprefs.excel_path;
0748         excel_file = guiprefs.excel_file;
0749         outfile = fullfile(excel_path,excel_file);
0750         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0751     <span class="keyword">end</span>
0752     
0753     <span class="comment">% Delete the old file if it exists</span>
0754     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0755         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0756             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0757             <span class="string">'already exists. Overwriting file...'</span>});
0758         delete(outfile)
0759     <span class="keyword">end</span>
0760     
0761     <span class="comment">% Save DAV data to an Excel File</span>
0762     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0763     vmin = num2str(guiparams.depth_range_min);
0764     vmax = num2str(guiparams.depth_range_max);
0765     pvheaders = {<span class="keyword">...</span>
0766         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0767         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0768         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0769         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0770     
0771 
0772     <span class="comment">% Initialize Variables</span>
0773     pvdata = []; Dist = [];
0774     X = []; Y = []; E = [];
0775     Ve = []; Vn =[]; Vm = []; Vd = [];
0776     
0777     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0778     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0779         <span class="comment">% Load current MAT-file</span>
0780         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0781         
0782         <span class="comment">% Location and Bathy</span>
0783         X = [X V.mcsX(1,:)];
0784         Y = [Y V.mcsY(1,:)];
0785         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0786         E = [E V.mcsBedElev];
0787         
0788         <span class="comment">% Build layer-averaged velocities</span>
0789         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0790         V.mcsX(indx,:) = nan;
0791         V.mcsY(indx,:) = nan;
0792         V.mcsEast(indx,:) = nan;
0793         V.mcsNorth(indx,:) = nan;
0794         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0795         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0796         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0797         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0798         
0799         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0800     <span class="keyword">end</span>
0801     
0802     <span class="comment">% Put output into 1 matrix</span>
0803     pvdata = [<span class="keyword">...</span>
0804         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0805         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0806         ];
0807     pvdata(isnan(pvdata)) = -9999;
0808     
0809     <span class="comment">% Create table and write to Excel</span>
0810     pvout = num2cell(pvdata');
0811     pvout = vertcat(pvheaders,pvout);
0812     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0813     
0814     <span class="comment">% Close out waitbar</span>
0815     waitbar(1,hwait)
0816     delete(hwait)
0817     
0818     <span class="comment">% Push messages to Log Window:</span>
0819     <span class="comment">% ----------------------------</span>
0820     statusLogging(handles.LogWindow, log_text)
0821 <span class="keyword">else</span>
0822     
0823     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0824     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0825     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0826     <span class="comment">% Refresh the Application Data:</span>
0827     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0828     z           = guiparams.z;
0829     A           = guiparams.A;
0830     V           = guiparams.V;
0831     Map         = guiparams.Map;
0832     wse         = guiparams.wse;
0833     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0834                                                     <span class="comment">% Planview Plot exactly</span>
0835         
0836     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0837     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0838         fullfile(excel_path,excel_file));
0839     
0840     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0841         outfile = fullfile(excel_path,excel_file);
0842         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0843         
0844         <span class="comment">% Delete the old file if it exists</span>
0845         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0846             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0847                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0848                 <span class="string">'already exists. Overwriting file...'</span>});
0849             delete(outfile)
0850         <span class="keyword">end</span>
0851         
0852         <span class="comment">% Push messages to Log Window:</span>
0853         <span class="comment">% ----------------------------</span>
0854         statusLogging(handles.LogWindow, log_text)
0855         
0856         <span class="comment">% Save MCS Summary to an Excel File</span>
0857         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0858         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0859         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0860         waitbar(1/5,hwait)
0861         <span class="keyword">if</span> isempty(guiparams.data_files(:)) <span class="comment">% Loaded MAT file</span>
0862             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0863             sout = {guiparams.mat_file};
0864         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0865             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0866             sout = guiparams.data_files';
0867         <span class="keyword">end</span>
0868         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0869         waitbar(2/7,hwait)
0870         sout = {<span class="keyword">...</span>
0871             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0872             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0873             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0875             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0877             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0878             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0879             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0880             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0881             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0882             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0883             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0884             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0885             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0886             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0887             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0888             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0889             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0890             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0891             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0892             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0893             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0894             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0895             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0896             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0897             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0898             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0899             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0900             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0901             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0902             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0903             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0904             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0905             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0906             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0907             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0908             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0909             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0910             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0911             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0912             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0913             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0914             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0915             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0916             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0917             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0918             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0919             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0920             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0921             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0922             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0923             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0924             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0925             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0926             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0927             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0928             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0929             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0930             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>
0931             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0932             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0933             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0934             };
0935         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
0936         waitbar(3/7,hwait)
0937         
0938         <span class="comment">% Save DAV data to an Excel File</span>
0939         vmin = num2str(guiparams.depth_range_min);
0940         vmax = num2str(guiparams.depth_range_max);
0941         pvheaders = {<span class="keyword">...</span>
0942             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0943             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0944             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0945             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0946         
0947         <span class="comment">% Create block style matrix of all processed data</span>
0948         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0949         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
0950         <span class="comment">% layer-averaging applied</span>
0951         pvdata = [];
0952         
0953         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0954         <span class="comment">% you are looking upstream into the transect</span>
0955         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0956         
0957         <span class="comment">% Build bathy data matrix</span>
0958         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0959         
0960         <span class="comment">% Build layer-averaged velocities</span>
0961         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0962         V.mcsX(indx,:) = nan;
0963         V.mcsY(indx,:) = nan;
0964         V.mcsEast(indx,:) = nan;
0965         V.mcsNorth(indx,:) = nan;
0966         pvdata = [<span class="keyword">...</span>
0967             pvdata;<span class="keyword">...</span>
0968             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0969             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0970             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0971             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0972         pvdata(isnan(pvdata)) = -9999;
0973         pvout = num2cell(pvdata');
0974         pvout = vertcat(pvheaders,pvout);
0975         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0976         waitbar(4/7,hwait)
0977         
0978         <span class="comment">% Save MCS data to an Excel File</span>
0979         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0980         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
0981         MCSheaders = {<span class="keyword">...</span>
0982             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0983             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0984             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0985             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0986             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0987             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0988             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0989             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0990             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0991             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0992             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0993             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0994             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0995             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0996             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0997             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0998         
0999         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1000         MCSdata = [<span class="keyword">...</span>
1001             V.mcsX(:)<span class="keyword">...</span>
1002             V.mcsY(:)<span class="keyword">...</span>
1003             V.mcsDist(:)<span class="keyword">...</span>
1004             vectorized_bed(:)<span class="keyword">...</span>
1005             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1006             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1007             V.mcsEast(:)<span class="keyword">...</span>
1008             V.mcsNorth(:)<span class="keyword">...</span>
1009             V.mcsVert(:)<span class="keyword">...</span>
1010             V.mcsMag(:)<span class="keyword">...</span>
1011             V.mcsDir(:)<span class="keyword">...</span>
1012             V.u(:)<span class="keyword">...</span>
1013             V.v(:)<span class="keyword">...</span>
1014             V.vp(:)<span class="keyword">...</span>
1015             V.vs(:)<span class="keyword">...</span>
1016             V.Roz.up(:)<span class="keyword">...</span>
1017             V.Roz.us(:)];
1018         MCSdata(isnan(MCSdata)) = -9999;
1019         
1020         MCSout = vertcat(MCSheaders,num2cell(MCSdata));
1021         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1022         waitbar(5/7,hwait)
1023                 
1024         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1025         <span class="comment">% results</span>
1026         <span class="comment">% Compute and sort the Distances such that when plotting in 2D</span>
1027         <span class="comment">% (Dist. vs. Depth), you are looking upstream into the transect</span>
1028         PVDist = [0 cumsum(hypot(diff(PVdata.outmat(1,:)),diff(PVdata.outmat(2,:))))];
1029         PVDist = sort(PVDist,<span class="string">'descend'</span>);
1030         PVheaders = {<span class="keyword">...</span>
1031             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
1032             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1033             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1034             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1035         PVtable = [<span class="keyword">...</span>
1036             PVdata.outmat(1,:);<span class="keyword">...</span>
1037             PVdata.outmat(2,:);<span class="keyword">...</span>
1038             PVDist;<span class="keyword">...</span>
1039             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1040             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1041             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1042             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1043         PVtable = (sortrows(PVtable',3))';
1044         PVtable(isnan(PVtable)) = -9999;
1045         PVout = num2cell(PVtable');
1046         PVout = vertcat(PVheaders,PVout);
1047         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1048         waitbar(6/7,hwait)
1049         
1050         <span class="comment">%% Save the actual MCS plot data, which includes the smoothed</span>
1051         <span class="comment">% results</span>
1052         <span class="comment">% Compute and sort the Distances such that when plotting in 2D</span>
1053         <span class="comment">% (Dist. vs. Depth), you are looking upstream into the transect</span>
1054         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1055         dist    = guiparams.mcsQuivers(:,1);
1056         depth   = guiparams.mcsQuivers(:,2);
1057         vcomp   = guiparams.mcsQuivers(:,3);
1058         wcomp   = guiparams.mcsQuivers(:,4);
1059         
1060         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1061         <span class="keyword">switch</span> guiparams.contour
1062             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1063                 wtp=[<span class="string">'V.uSmooth'</span>];
1064             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1065                 wtp=[<span class="string">'V.vSmooth'</span>];
1066             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1067                 wtp=[<span class="string">'V.wSmooth'</span>];
1068             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1069                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1070             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1071                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1072             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1073                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1074             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1075                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1076             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1077                 wtp=[<span class="string">'V.vpSmooth'</span>];
1078             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1079                 wtp=[<span class="string">'V.vsSmooth'</span>];
1080             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1081                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1082             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1083                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1084             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1085                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1086             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1087                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1088             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1089                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1090             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1091                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1092             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1093                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1094             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1095                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1096             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1097                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1098             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1099                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1100             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1101                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1102         <span class="keyword">end</span>
1103         Ucomp = eval(wtp);
1104         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1105         
1106         <span class="comment">% Save MCS data to an Excel File</span>
1107         <span class="comment">% This includes the smoothed data results from the plots.</span>
1108         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1109         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1110         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1111         mcsheaders = {<span class="keyword">...</span>
1112             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1113             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1114             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1115             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1116             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1117             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1118             };
1119         mcsdata = [<span class="keyword">...</span>
1120             dist(:)<span class="keyword">...</span>
1121             depth(:)<span class="keyword">...</span>
1122             ucomp(:)<span class="keyword">...</span>
1123             vcomp(:)<span class="keyword">...</span>
1124             wcomp(:)];
1125         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1126         ridx = ~isnan(ucomp);
1127         mcsdata = mcsdata(ridx,:);
1128         mcsdata(isnan(mcsdata)) = -9999;
1129         
1130         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
1131         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1132         waitbar(7/7,hwait)
1133     <span class="keyword">else</span>
1134         <span class="comment">% Return default excel_path and excel_file</span>
1135         excel_path = guiprefs.excel_path;
1136         excel_file = guiprefs.excel_file;
1137         outfile = fullfile(excel_path,excel_file);
1138         log_text = {<span class="string">'User aborted Excel export...'</span>};
1139     <span class="keyword">end</span>
1140     
1141     
1142 waitbar(1,hwait)    
1143 <span class="keyword">end</span>
1144 
1145 <span class="comment">% Push messages to Log Window:</span>
1146 <span class="comment">% ----------------------------</span>
1147 statusLogging(handles.LogWindow, log_text)
1148 
1149 <span class="comment">% Store the persistent preferences:</span>
1150 <span class="comment">% ---------------------------------</span>
1151 guiprefs.excel_file = excel_file;
1152 guiprefs.excel_path = excel_path;
1153 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1154 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1155 delete(hwait)
1156 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1157 
1158 <span class="comment">% --------------------------------------------------------------------</span>
1159 <a name="_sub27" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1160 <span class="comment">% Empty</span>
1161 
1162 <span class="comment">% --------------------------------------------------------------------</span>
1163 <a name="_sub28" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1164 <span class="comment">% Empty</span>
1165 
1166 <span class="comment">% --------------------------------------------------------------------</span>
1167 <a name="_sub29" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1168 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1169 
1170 <span class="comment">% Get the Application Data:</span>
1171 <span class="comment">% -------------------------</span>
1172 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1173 
1174 <span class="comment">% Update the GUI &amp; Application Data:</span>
1175 <span class="comment">% ----------------------------------</span>
1176 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1177 <span class="keyword">switch</span> status
1178     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1179         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1180         guiparams.unit_discharge_correction = false;
1181     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1182         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1183         guiparams.unit_discharge_correction = true;
1184 <span class="keyword">end</span>
1185 
1186 <span class="comment">% Re-store the Application data:</span>
1187 <span class="comment">% ------------------------------</span>
1188 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1189 
1190 
1191 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1192 
1193 <span class="comment">% --------------------------------------------------------------------</span>
1194 <a name="_sub30" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1195 <span class="comment">% Empty</span>
1196 
1197 <span class="comment">% --------------------------------------------------------------------</span>
1198 <a name="_sub31" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1199 <span class="comment">% Empty</span>
1200 
1201 <span class="comment">% --------------------------------------------------------------------</span>
1202 <a name="_sub32" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1203 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1204 
1205 <span class="comment">% Get the Application Data:</span>
1206 <span class="comment">% -------------------------</span>
1207 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1208 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1209 
1210 <span class="comment">% Update the Application Data:</span>
1211 <span class="comment">% ----------------------------</span>
1212 guiparams.english_units = false;
1213 guiprefs.units = <span class="string">'metric'</span>;
1214 
1215 <span class="comment">% Re-store the Application data:</span>
1216 <span class="comment">% ------------------------------</span>
1217 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1218 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1219 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1220 
1221 <span class="comment">% Update the GUI:</span>
1222 <span class="comment">% ---------------</span>
1223 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1224 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1225 
1226 <span class="comment">% [EOF] menuMetric_Callback</span>
1227 
1228 
1229 <span class="comment">% --------------------------------------------------------------------</span>
1230 <a name="_sub33" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1231 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1232 
1233 <span class="comment">% Get the Application Data:</span>
1234 <span class="comment">% -------------------------</span>
1235 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1236 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1237 
1238 <span class="comment">% Update the Application Data:</span>
1239 <span class="comment">% ----------------------------</span>
1240 guiparams.english_units = true;
1241 guiprefs.units = <span class="string">'english'</span>;
1242 
1243 <span class="comment">% Re-store the Application data:</span>
1244 <span class="comment">% ------------------------------</span>
1245 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1246 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1247 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1248 
1249 <span class="comment">% Update the GUI:</span>
1250 <span class="comment">% ---------------</span>
1251 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1252 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1253 
1254 <span class="comment">% [EOF] menuEnglish_Callback</span>
1255 
1256 <span class="comment">% --------------------------------------------------------------------</span>
1257 <a name="_sub34" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1258 <span class="comment">% Empty</span>
1259 
1260 <span class="comment">% --------------------------------------------------------------------</span>
1261 <a name="_sub35" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1262 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1263 <span class="comment">% surface)</span>
1264 
1265 <span class="comment">% Get the Application Data:</span>
1266 <span class="comment">% -------------------------</span>
1267 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1268 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1269 
1270 <span class="comment">% Update the Application Data:</span>
1271 <span class="comment">% ----------------------------</span>
1272 guiparams.plotref = <span class="string">'dfs'</span>;
1273 guiprefs.plotref  = <span class="string">'dfs'</span>;
1274 
1275 <span class="comment">% Re-store the Application data:</span>
1276 <span class="comment">% ------------------------------</span>
1277 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1278 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1279 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1280 
1281 <span class="comment">% Update the GUI:</span>
1282 <span class="comment">% ---------------</span>
1283 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1284 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1285 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1286 
1287 <span class="comment">% --------------------------------------------------------------------</span>
1288 <a name="_sub36" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1289 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1290 
1291 <span class="comment">% Get the Application Data:</span>
1292 <span class="comment">% -------------------------</span>
1293 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1294 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1295 
1296 <span class="comment">% Update the Application Data:</span>
1297 <span class="comment">% ----------------------------</span>
1298 guiparams.plotref = <span class="string">'hab'</span>;
1299 guiprefs.plotref  = <span class="string">'hab'</span>;
1300 
1301 <span class="comment">% Prompt and set eta</span>
1302 <span class="comment">% ------------------</span>
1303 prompt = <span class="string">'Enter elevation of the bottom (eta), in meters:'</span>;
1304 dlg_title = <span class="string">'Set bottom elevation for height above bottom reference'</span>;
1305 num_lines = 1;
1306 def = {num2str(guiparams.eta)};
1307 guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));
1308 
1309 
1310 <span class="comment">% Re-store the Application data:</span>
1311 <span class="comment">% ------------------------------</span>
1312 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1313 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1314 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1315 
1316 <span class="comment">% Update the GUI:</span>
1317 <span class="comment">% ---------------</span>
1318 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1319 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1320 
1321 
1322 
1323 
1324 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1325 
1326 <span class="comment">% --------------------------------------------------------------------</span>
1327 <a name="_sub37" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1328 <span class="comment">% Empty</span>
1329 
1330 <span class="comment">% --------------------------------------------------------------------</span>
1331 <a name="_sub38" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1332 <span class="comment">% Set cross-section endpoints automatically</span>
1333 
1334 <span class="comment">% Get the Application Data:</span>
1335 <span class="comment">% -------------------------</span>
1336 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1337 
1338 <span class="comment">% Update the Application Data:</span>
1339 <span class="comment">% ----------------------------</span>
1340 guiparams.set_cross_section_endpoints = false;
1341 
1342 <span class="comment">% Re-store the Application data:</span>
1343 <span class="comment">% ------------------------------</span>
1344 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1345 
1346 <span class="comment">% Update the GUI:</span>
1347 <span class="comment">% ---------------</span>
1348 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1349 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1350 
1351 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1352 
1353 
1354 <span class="comment">% --------------------------------------------------------------------</span>
1355 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1356 <span class="comment">% Set cross-section endpoints manually</span>
1357 
1358 <span class="comment">% Get the Application Data:</span>
1359 <span class="comment">% -------------------------</span>
1360 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1361 
1362 <span class="comment">% Update the Application Data:</span>
1363 <span class="comment">% ----------------------------</span>
1364 guiparams.set_cross_section_endpoints = true;
1365 
1366 <span class="comment">% Re-store the Application data:</span>
1367 <span class="comment">% ------------------------------</span>
1368 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1369 
1370 <span class="comment">% Update the GUI:</span>
1371 <span class="comment">% ---------------</span>
1372 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1373 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1374 
1375 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1376 
1377 
1378 
1379 
1380 <span class="comment">% --------------------------------------------------------------------</span>
1381 <a name="_sub40" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1382 <span class="comment">% Empty</span>
1383 
1384 <span class="comment">% --------------------------------------------------------------------</span>
1385 <a name="_sub41" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1386 
1387 <span class="comment">% Get the Application Data:</span>
1388 <span class="comment">% -------------------------</span>
1389 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1390 
1391 <span class="comment">% Update the Application Data:</span>
1392 <span class="comment">% ----------------------------</span>
1393 guiparams.print        = true;
1394 guiparams.presentation = false;
1395 
1396 <span class="comment">% Re-store the Application data:</span>
1397 <span class="comment">% ------------------------------</span>
1398 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1399 
1400 <span class="comment">% Update the GUI:</span>
1401 <span class="comment">% ---------------</span>
1402 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1403 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1404 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1405 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1406 
1407 <span class="comment">% Modify the existing figures</span>
1408 <span class="comment">% ---------------------------</span>
1409 <span class="comment">% Find what plots exist already</span>
1410 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1411 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1412 
1413 <span class="comment">% Defaults for Print Stlye Figure</span>
1414 BkgdColor   = <span class="string">'white'</span>;
1415 AxColor     = <span class="string">'black'</span>;
1416 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1417 FntSize     = 14;
1418 
1419 <span class="comment">% Loop through valid figures and adjust</span>
1420 <span class="comment">% -------------------------------------</span>
1421 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1422     
1423     <span class="keyword">for</span> i = 1:length(valid_names)
1424         <span class="keyword">switch</span> valid_names{i}
1425             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1426                 <span class="comment">% Focus the figure</span>
1427                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1428                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1429                     figure(hff)
1430                     
1431                     <span class="comment">% Make the changes to figure</span>
1432                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1433                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1434                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1435                     set(gca,<span class="string">'Color'</span>,FigColor)
1436                     set(gca,<span class="string">'XColor'</span>,AxColor)
1437                     set(gca,<span class="string">'YColor'</span>,AxColor)
1438                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1439                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1440                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1441                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1442                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1443                     
1444                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1445                     <span class="comment">% the file(s) and path for the data</span>
1446                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1447                     <span class="keyword">if</span> ~ismultiplot
1448                         filestr = guiparams.savefile;
1449                         wd = length(filestr);
1450                         hd = 1;
1451                     <span class="keyword">else</span>
1452                         <span class="comment">% Construct a filename</span>
1453                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1454                         wd        = max(cellfun(@length,filestr));
1455                         hd        = numel(filestr);
1456                             
1457                     <span class="keyword">end</span>
1458                     
1459                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1460                     disableMenuBar(hff)
1461                     set(fileinfotxt,<span class="keyword">...</span>
1462                         <span class="string">'string'</span>,filestr)
1463                     set(fileinfotxt,<span class="keyword">...</span>
1464                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1465                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1466                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1467                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1468                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1469                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1470                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1471                     
1472                 <span class="keyword">end</span>
1473             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1474                 <span class="comment">% Focus the figure</span>
1475                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1476                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1477                     figure(hff)
1478                     
1479                     <span class="comment">% Make the changes to figure</span>
1480                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1481                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1482                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1483                     set(gca,<span class="string">'Color'</span>,FigColor)
1484                     set(gca,<span class="string">'XColor'</span>,AxColor)
1485                     set(gca,<span class="string">'YColor'</span>,AxColor)
1486                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1487                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1488                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1489                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1490                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1491                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1492                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1493                     
1494                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1495                     <span class="comment">% the file(s) and path for the data</span>
1496                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1497                     <span class="keyword">if</span> ~ismultiplot
1498                         filestr = guiparams.savefile;
1499                         wd = length(filestr);
1500                         hd = 1;
1501                     <span class="keyword">else</span>
1502                         <span class="comment">% Construct a filename</span>
1503                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1504                         wd        = max(cellfun(@length,filestr));
1505                         hd        = numel(filestr);
1506                             
1507                     <span class="keyword">end</span>
1508                     
1509                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1510                     disableMenuBar(hff)
1511                     set(fileinfotxt,<span class="keyword">...</span>
1512                         <span class="string">'string'</span>,filestr)
1513                     set(fileinfotxt,<span class="keyword">...</span>
1514                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1515                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1516                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1517                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1518                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1519                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1520                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1521                 <span class="keyword">end</span>
1522             <span class="keyword">otherwise</span>
1523         <span class="keyword">end</span>
1524     <span class="keyword">end</span>
1525     
1526     
1527 <span class="keyword">end</span>
1528 
1529 
1530 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1531 
1532 
1533 <span class="comment">% --------------------------------------------------------------------</span>
1534 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1535 <span class="comment">% Get the Application Data:</span>
1536 <span class="comment">% -------------------------</span>
1537 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1538 
1539 <span class="comment">% Update the Application Data:</span>
1540 <span class="comment">% ----------------------------</span>
1541 guiparams.print        = false;
1542 guiparams.presentation = true;
1543 
1544 <span class="comment">% Re-store the Application data:</span>
1545 <span class="comment">% ------------------------------</span>
1546 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1547 
1548 <span class="comment">% Update the GUI:</span>
1549 <span class="comment">% ---------------</span>
1550 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1551 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1552 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1553 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1554 
1555 <span class="comment">% Modify the existing figures</span>
1556 <span class="comment">% ---------------------------</span>
1557 <span class="comment">% Find what plots exist already</span>
1558 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1559 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1560 
1561 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1562 <span class="comment">% --------------------------------------</span>
1563 BkgdColor   = <span class="string">'black'</span>;
1564 AxColor     = <span class="string">'white'</span>;
1565 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1566 FntSize     = 14;
1567 
1568 <span class="comment">% Loop through valid figures and adjust</span>
1569 <span class="comment">% -------------------------------------</span>
1570 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1571     
1572     <span class="keyword">for</span> i = 1:length(valid_names)
1573         <span class="keyword">switch</span> valid_names{i}
1574             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1575                 <span class="comment">% Focus the figure</span>
1576                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1577                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1578                     figure(hff)
1579                     
1580                     <span class="comment">% Make the changes to figure</span>
1581                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1582                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1583                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1584                     set(gca,<span class="string">'Color'</span>,FigColor)
1585                     set(gca,<span class="string">'XColor'</span>,AxColor)
1586                     set(gca,<span class="string">'YColor'</span>,AxColor)
1587                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1588                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1589                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1590                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1591                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1592                     
1593                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1594                     <span class="comment">% the file(s) and path for the data</span>
1595                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1596                     <span class="keyword">if</span> ~ismultiplot
1597                         filestr = guiparams.savefile;
1598                         wd = length(filestr);
1599                         hd = 1;
1600                     <span class="keyword">else</span>
1601                         <span class="comment">% Construct a filename</span>
1602                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1603                         wd        = max(cellfun(@length,filestr));
1604                         hd        = numel(filestr);
1605                             
1606                     <span class="keyword">end</span>
1607                     
1608                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1609                     disableMenuBar(hff)
1610                     set(fileinfotxt,<span class="keyword">...</span>
1611                         <span class="string">'string'</span>,filestr)
1612                     set(fileinfotxt,<span class="keyword">...</span>
1613                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1614                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1615                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1616                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1617                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1618                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1619                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1620                     
1621                 <span class="keyword">end</span>
1622             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1623                 <span class="comment">% Focus the figure</span>
1624                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1625                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1626                     figure(hff)
1627                     
1628                     <span class="comment">% Make the changes to figure</span>
1629                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1630                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1631                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1632                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1633                     set(gca,<span class="string">'XColor'</span>,AxColor)
1634                     set(gca,<span class="string">'YColor'</span>,AxColor)
1635                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1636                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1637                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1638                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1639                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1640                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1641                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1642                     
1643                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1644                     <span class="comment">% the file(s) and path for the data</span>
1645                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1646                     <span class="keyword">if</span> ~ismultiplot
1647                         filestr = guiparams.savefile;
1648                         wd = length(filestr);
1649                         hd = 1;
1650                     <span class="keyword">else</span>
1651                         <span class="comment">% Construct a filename</span>
1652                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1653                         wd        = max(cellfun(@length,filestr));
1654                         hd        = numel(filestr);
1655                             
1656                     <span class="keyword">end</span>
1657                     
1658                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1659                     disableMenuBar(hff)
1660                     set(fileinfotxt,<span class="keyword">...</span>
1661                         <span class="string">'string'</span>,filestr)
1662                     set(fileinfotxt,<span class="keyword">...</span>
1663                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1664                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1665                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1666                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1667                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1668                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1669                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1670                 <span class="keyword">end</span>
1671             <span class="keyword">otherwise</span>
1672         <span class="keyword">end</span>
1673     <span class="keyword">end</span>
1674     
1675     
1676 <span class="keyword">end</span>
1677 
1678 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1679 
1680 <span class="comment">% --------------------------------------------------------------------</span>
1681 <a name="_sub43" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1682 
1683 <span class="comment">% Get the Application data:</span>
1684 <span class="comment">% -------------------------</span>
1685 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1686 
1687 <span class="comment">% Initialize the answer:</span>
1688 <span class="comment">% ----------------------</span>
1689 numstr = {num2str(guiparams.vertical_offset)};
1690 answer = NaN;
1691 <span class="keyword">while</span> isnan(answer)
1692     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1693     
1694     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1695         <span class="keyword">return</span>
1696     <span class="keyword">end</span>
1697     
1698     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1699     <span class="comment">% A numeric char will be a double</span>
1700 <span class="keyword">end</span>
1701 
1702 <span class="comment">% Re-store the Application data:</span>
1703 <span class="comment">% ------------------------------</span>
1704 guiparams.vertical_offset = answer;
1705 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1706 
1707 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1708 
1709 <span class="comment">% --------------------------------------------------------------------</span>
1710 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1711 <span class="comment">% Not implemented</span>
1712 
1713 <span class="comment">% --------------------------------------------------------------------</span>
1714 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1715 <span class="comment">% Empty</span>
1716 
1717 <span class="comment">% --------------------------------------------------------------------</span>
1718 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1719 ASCII2GIS_GUI
1720 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1721 
1722 <span class="comment">% --------------------------------------------------------------------</span>
1723 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1724 
1725 <span class="comment">% Get the Application preferences:</span>
1726 <span class="comment">% --------------------------------</span>
1727 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1728 
1729 inpath = guiprefs.kmz_path;
1730 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1731     infile = guiprefs.kmz_file{1};
1732 <span class="keyword">else</span>
1733     infile = guiprefs.kmz_file;
1734 <span class="keyword">end</span>
1735 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1736 
1737 guiprefs.kmz_path = outpath;
1738 guiprefs.kmz_file = outfile;
1739 
1740 <span class="comment">% Update persistent preferences</span>
1741 <span class="comment">% -----------------------------</span>
1742 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1743 
1744 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1745 
1746 <span class="comment">% --------------------------------------------------------------------</span>
1747 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1748 <span class="comment">% Get the Application preferences:</span>
1749 <span class="comment">% --------------------------------</span>
1750 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1751 
1752 VMT_BatchMode;
1753 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1754 
1755 <span class="comment">% --------------------------------------------------------------------</span>
1756 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1757 <span class="comment">% Empty</span>
1758 
1759 <span class="comment">% --------------------------------------------------------------------</span>
1760 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1761 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1762 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1763     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1764     
1765 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1766     
1767     <span class="keyword">if</span> isdeployed
1768         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1769             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1770         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1771             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1772             errLogFileName},<span class="keyword">...</span>
1773             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1774             <span class="string">'error'</span>);
1775         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1776         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1777         fclose(fid);
1778         rethrow(err)
1779     <span class="keyword">else</span>
1780         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1781             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1782             <span class="string">'error'</span>);
1783         rethrow(err);
1784     <span class="keyword">end</span>
1785 <span class="keyword">end</span>
1786 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1787 
1788 <span class="comment">% --------------------------------------------------------------------</span>
1789 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1790 <span class="comment">% Get the Application data:</span>
1791 <span class="comment">% -------------------------</span>
1792 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1793 
1794 <span class="keyword">try</span>
1795     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1796 
1797 
1798 <span class="comment">% This catch is probably not necessary.</span>
1799 <span class="keyword">catch</span> err 
1800     <span class="keyword">if</span> isdeployed
1801         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1802             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1803         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1804             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1805             errLogFileName},<span class="keyword">...</span>
1806             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1807             <span class="string">'error'</span>);
1808         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1809         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1810         fclose(fid);
1811         rethrow(err)
1812     <span class="keyword">else</span>
1813         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1814             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1815             <span class="string">'error'</span>);
1816         rethrow(err);
1817     <span class="keyword">end</span>
1818 <span class="keyword">end</span>
1819 
1820 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1821 
1822 <span class="comment">% --------------------------------------------------------------------</span>
1823 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1824 
1825 <span class="comment">% Get the Application data:</span>
1826 <span class="comment">% -------------------------</span>
1827 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1828 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1829 
1830 <span class="comment">% Check version tag against the web, and display a message</span>
1831 <span class="keyword">try</span>
1832     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1833     webdata = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1834     <span class="keyword">if</span> length(webdata) &gt; 5
1835         current_vmt_version{1} = webdata(1:5);
1836         current_vmt_version{2} = webdata(8:16);
1837     <span class="keyword">else</span>
1838         current_vmt_version = webdata;
1839     <span class="keyword">end</span>
1840     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1841 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1842     <span class="keyword">if</span> isdeployed
1843         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1844             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1845         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1846             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1847             errLogFileName},<span class="keyword">...</span>
1848             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1849             <span class="string">'error'</span>);
1850         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1851         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1852         fclose(fid);
1853         rethrow(err)
1854     <span class="keyword">else</span>
1855         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1856             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1857             <span class="string">'error'</span>);
1858         rethrow(err);
1859     <span class="keyword">end</span>
1860 <span class="keyword">end</span>
1861 
1862 <span class="keyword">if</span> ischar(current_vmt_version)
1863     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1864         h = msgbox(<span class="keyword">...</span>
1865             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1866             <span class="string">''</span>;<span class="keyword">...</span>
1867             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1868             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1869     <span class="keyword">else</span>
1870         h = msgbox(<span class="keyword">...</span>
1871             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1872             <span class="string">''</span>;<span class="keyword">...</span>
1873             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1874             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1875     <span class="keyword">end</span>
1876 <span class="keyword">elseif</span> iscell(current_vmt_version)
1877     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1878         h = msgbox(<span class="keyword">...</span>
1879             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1880             <span class="string">''</span>;<span class="keyword">...</span>
1881             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1882             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1883     <span class="keyword">else</span>
1884         h = msgbox(<span class="keyword">...</span>
1885             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1886             <span class="string">''</span>;<span class="keyword">...</span>
1887             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1888             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1889     <span class="keyword">end</span>
1890 <span class="keyword">end</span>
1891 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1892 
1893 <span class="comment">% --------------------------------------------------------------------</span>
1894 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1895 
1896 <span class="comment">% Get the Application data:</span>
1897 <span class="comment">% -------------------------</span>
1898 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1899 messagestr = <span class="keyword">...</span>
1900     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1901     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1902     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1903     <span class="string">''</span>;<span class="keyword">...</span>
1904     <span class="string">''</span>;<span class="keyword">...</span>
1905     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1906     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1907     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1908     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1909     <span class="string">''</span>;<span class="keyword">...</span>
1910     <span class="string">''</span>;<span class="keyword">...</span>
1911     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1912     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1913     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1914     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1915     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1916     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1917     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1918 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1919 <span class="comment">% [EOF] menuAbout_Callback</span>
1920 
1921 
1922 
1923 
1924 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1925 <span class="comment">% TOOLBAR CALLBACKS %</span>
1926 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1927 
1928 <span class="comment">% --------------------------------------------------------------------</span>
1929 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1930 <span class="comment">% Read Files into Data Structure using tfile.</span>
1931 
1932 <span class="comment">% Get the Application data:</span>
1933 <span class="comment">% -------------------------</span>
1934 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1935 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1936 
1937 <span class="comment">% Ask the user to select files:</span>
1938 <span class="comment">% -----------------------------</span>
1939 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1940 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1941     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1942     current_file, <span class="keyword">...</span>
1943     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1944 
1945 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1946     guiparams.data_folder = pathname;
1947     <span class="keyword">if</span> ischar(filename)
1948         filename = {filename};
1949     <span class="keyword">end</span>
1950     guiparams.data_files = filename;
1951     guiparams.mat_file = <span class="string">''</span>;
1952     
1953     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1954     
1955    
1956     
1957     <span class="comment">% Update the preferences:</span>
1958     <span class="comment">% -----------------------</span>
1959     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1960     guiprefs.ascii_path = pathname;
1961     guiprefs.ascii_file = filename;
1962     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1963     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1964     
1965     <span class="comment">% Push messages to Log Window:</span>
1966     <span class="comment">% ----------------------------</span>
1967     log_text = {<span class="keyword">...</span>
1968         <span class="string">''</span>;<span class="keyword">...</span>
1969         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1970         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1971         guiparams.data_folder;
1972         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1973         char(filename)};
1974     statusLogging(handles.LogWindow, log_text)
1975     
1976     <span class="comment">% Read the file(s)</span>
1977     <span class="comment">% ----------------</span>
1978     [~,~,savefile,A,z] = <span class="keyword">...</span>
1979         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1980     guiparams.savefile = savefile;
1981     guiparams.A        = A;
1982     guiparams.z        = z;
1983     
1984     
1985     <span class="comment">% Set the vertical grid node spacing</span>
1986     <span class="comment">% ----------------------------------</span>
1987     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1988     <span class="comment">% Backwards compatible</span>
1989     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1990         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1991         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1992     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1993         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1994         guiparams.vertical_grid_node_spacing = 0.4;
1995     <span class="keyword">end</span>
1996     
1997     
1998     <span class="comment">% Save application data</span>
1999     <span class="comment">% ---------------------</span>
2000     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2001        
2002 <span class="comment">%</span>
2003 <span class="comment">%     % Preprocess the data:</span>
2004 <span class="comment">%     % --------------------</span>
2005 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2006 <span class="comment">%</span>
2007 <span class="comment">%     % Push messages to Log Window:</span>
2008 <span class="comment">%     % ----------------------------</span>
2009 <span class="comment">%     log_text = {...</span>
2010 <span class="comment">%         '   Preprocessing complete.';...</span>
2011 <span class="comment">%         '   Begin Data Processing...'};</span>
2012 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2013 <span class="comment">%</span>
2014 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2015 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2016 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2017 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2018 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2019 <span class="comment">%</span>
2020 <span class="comment">%     % Push messages to Log Window:</span>
2021 <span class="comment">%     % ----------------------------</span>
2022 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2023 <span class="comment">%</span>
2024 <span class="comment">%     % Store the data:</span>
2025 <span class="comment">%     % ---------------</span>
2026 <span class="comment">%     guiparams.z = z;</span>
2027 <span class="comment">%     guiparams.A = A;</span>
2028 <span class="comment">%     guiparams.V = V;</span>
2029 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2030     
2031           
2032     <span class="comment">% Update the GUI:</span>
2033     <span class="comment">% ---------------</span>
2034     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2035     
2036     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2037     
2038 <span class="keyword">end</span>
2039 <span class="comment">% [EOF] loadDataCallback</span>
2040 
2041 
2042 
2043 <span class="comment">% --------------------------------------------------------------------</span>
2044 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2045 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2046 
2047 <span class="comment">% Get the Application data:</span>
2048 <span class="comment">% -------------------------</span>
2049 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2050 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2051 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2052 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2053 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2054 
2055 [the_file,the_path] = <span class="keyword">...</span>
2056     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2057     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2058     fullfile(guiparams.mat_path,guiparams.savefile));
2059 
2060 <span class="comment">% Save the processed data to a MAT file:</span>
2061 <span class="comment">% --------------------------------------</span>
2062 <span class="keyword">if</span> ischar(the_file)
2063     guiparams.mat_path = the_path;
2064     guiparams.mat_file = the_file;
2065     guiparams.savefile = the_file;
2066     
2067     <span class="comment">% Re-store the Application data:</span>
2068     <span class="comment">% ------------------------------</span>
2069     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2070     
2071     <span class="comment">% Update the preferences:</span>
2072     <span class="comment">% -----------------------</span>
2073     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2074     guiprefs.mat_path = the_path;
2075     guiprefs.mat_file = the_file;
2076     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2077     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2078     
2079     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2080     savefile = fullfile(pathstr,[filename extension]);
2081     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2082     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2083     log_text = {<span class="keyword">...</span>
2084         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2085         savefile};
2086     statusLogging(handles.LogWindow,log_text)
2087     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2088 <span class="keyword">end</span>
2089 
2090 <span class="comment">% [EOF] saveDataCallback</span>
2091 
2092 
2093 <span class="comment">% --------------------------------------------------------------------</span>
2094 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2095 
2096 <span class="comment">% Get the Application data:</span>
2097 <span class="comment">% -------------------------</span>
2098 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2099 z   = guiparams.z;
2100 A   = guiparams.A;
2101 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2102 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2103 
2104 <span class="comment">% Compute multibeam bathymetry:</span>
2105 <span class="comment">% -----------------------------</span>
2106 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2107 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2108 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2109     guiparams.beam_angle, <span class="keyword">...</span>
2110     guiparams.magnetic_variation, <span class="keyword">...</span>
2111     guiparams.wse, <span class="keyword">...</span>
2112     guiparams.output_auxiliary_data);
2113 
2114 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2115 
2116 <span class="comment">% [EOF] saveBathymetryCallback</span>
2117 
2118 <span class="comment">% --------------------------------------------------------------------</span>
2119 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2120 
2121 <span class="comment">% Get the Application data:</span>
2122 <span class="comment">% -------------------------</span>
2123 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2124 
2125 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2126     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2127     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2128     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2129     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2130     handles.figure1);
2131 
2132 <span class="comment">% Update the GUI:</span>
2133 <span class="comment">% ---------------</span>
2134 <span class="keyword">if</span> guiparams.english_units
2135     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2136     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2137 <span class="keyword">else</span>
2138     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2139     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2140 <span class="keyword">end</span>
2141 
2142 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2143     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2144     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2145 <span class="keyword">else</span>
2146     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2147     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2148 <span class="keyword">end</span>
2149 
2150 <span class="keyword">if</span> guiparams.presentation
2151     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2152 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2153 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2154 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2155 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2156 <span class="keyword">else</span>
2157     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2158 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2159 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2160 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2161 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2162 <span class="keyword">end</span>
2163 
2164 <span class="comment">% Re-store the Application data:</span>
2165 <span class="comment">% ------------------------------</span>
2166 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2167 
2168 <span class="comment">% [EOF] plottingParametersCallback</span>
2169 
2170 
2171 <span class="comment">% --------------------------------------------------------------------</span>
2172 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2173 
2174 <span class="comment">% Get the Application data:</span>
2175 <span class="comment">% -------------------------</span>
2176 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2177 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2178 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2179 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2180 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2181 
2182 <span class="comment">% [EOF] processingParametersCallback</span>
2183 
2184 
2185 <span class="comment">% --------------------------------------------------------------------</span>
2186 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2187 <span class="comment">% Plot 1</span>
2188 
2189 <span class="comment">% Get the Application data:</span>
2190 <span class="comment">% -------------------------</span>
2191 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2192 z = guiparams.z;
2193 A = guiparams.A;
2194 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2195 <span class="comment">% Map = guiparams.Map;</span>
2196 
2197 
2198 <span class="comment">% Preprocess the data:</span>
2199 <span class="comment">% --------------------</span>
2200 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2201 
2202 <span class="comment">% Push messages to Log Window:</span>
2203 <span class="comment">% ----------------------------</span>
2204 log_text = {<span class="keyword">...</span>
2205     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2206     <span class="string">'   Begin Data Processing...'</span>};
2207 statusLogging(handles.LogWindow, log_text)
2208 
2209 <span class="comment">% Process the transects:</span>
2210 <span class="comment">% ----------------------</span>
2211 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2212 A(1).vgns = guiparams.vertical_grid_node_spacing;
2213 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2214 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2215     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2216 
2217 <span class="comment">% Compute the smoothed variables</span>
2218 <span class="comment">% ------------------------------</span>
2219 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2220 <span class="comment">% runtime.</span>
2221 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2222     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2223     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2224     guiparams.vertical_smoothing_window);
2225 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2226 
2227 <span class="comment">% Push messages to Log Window:</span>
2228 <span class="comment">% ----------------------------</span>
2229 statusLogging(handles.LogWindow, processing_log_text)
2230 
2231 <span class="comment">% Store the data:</span>
2232 <span class="comment">% ---------------</span>
2233 guiparams.z = z;
2234 guiparams.A = A;
2235 guiparams.V = V;
2236 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2237 
2238 <span class="comment">% Push messages to Log Window:</span>
2239 <span class="comment">% ----------------------------</span>
2240 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2241 statusLogging(handles.LogWindow, log_text)
2242 
2243 <span class="comment">% Create or replot the Shiptracks</span>
2244 <span class="comment">% -------------------------------</span>
2245 <span class="comment">% Grab the axes to the plot</span>
2246 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2247 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2248 
2249 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2250 <span class="comment">% New plot display window</span>
2251 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2252 <span class="comment">% h = figure(1); clf</span>
2253 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2254 
2255 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2256 
2257 
2258 <span class="comment">% --------------------------------------------------------------------</span>
2259 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2260 <span class="comment">% Plot 2</span>
2261 
2262 <span class="comment">% Get the Application data:</span>
2263 <span class="comment">% -------------------------</span>
2264 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2265 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2266 
2267 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2268     <span class="comment">% Push messages to Log Window:</span>
2269     <span class="comment">% ----------------------------</span>
2270     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2271     statusLogging(handles.LogWindow, log_text)
2272     
2273        
2274     <span class="comment">% Push plotting parameters to log window:</span>
2275     <span class="comment">% ---------------------------------------</span>
2276     log_text = {<span class="keyword">...</span>
2277         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2278         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2279         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2280         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2281         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2282         };
2283     statusLogging(handles.LogWindow, log_text)
2284     
2285     <span class="comment">% Plot the data:</span>
2286     <span class="comment">% --------------</span>
2287     z = [];
2288     A = [];
2289     V = [];
2290     Map = [];
2291     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2292     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2293         depth_range, <span class="keyword">...</span>
2294         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2295         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2296         guiparams.smoothing_window_size, <span class="keyword">...</span>
2297         guiparams.display_shoreline, <span class="keyword">...</span>
2298         guiparams.english_units, <span class="keyword">...</span>
2299         guiparams.mat_file, <span class="keyword">...</span>
2300         guiparams.mat_path); <span class="comment">% PLOT2</span>
2301     statusLogging(handles.LogWindow, log_text)
2302     
2303     <span class="comment">% Plot a Shoreline Map:</span>
2304     <span class="comment">% ---------------------</span>
2305     <span class="keyword">if</span> guiparams.display_shoreline
2306         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2307             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2308             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2309             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2310         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2311             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2312             Map.UTMe   = mapdata(:,1);
2313             Map.UTMn   = mapdata(:,2);
2314             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2315             <span class="comment">%Map.UTMzone = zone;</span>
2316         <span class="keyword">else</span>
2317             Map = [];
2318         <span class="keyword">end</span>
2319         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2320         log_text = {<span class="keyword">...</span>
2321             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2322             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2323             };
2324         statusLogging(handles.LogWindow, log_text)
2325     <span class="keyword">else</span>
2326         Map = [];
2327     <span class="keyword">end</span>
2328     
2329 <span class="keyword">else</span>
2330     z = guiparams.z;
2331     A = guiparams.A;
2332     <span class="comment">% V = guiparams.V;</span>
2333     Map = guiparams.Map;
2334     
2335     <span class="comment">% Push messages to Log Window:</span>
2336     <span class="comment">% ----------------------------</span>
2337     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2338     statusLogging(handles.LogWindow, log_text)
2339     
2340         
2341     <span class="comment">% Preprocess the data:</span>
2342     <span class="comment">% --------------------</span>
2343     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2344     
2345     <span class="comment">% Process the transects:</span>
2346     <span class="comment">% ----------------------</span>
2347     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2348     A(1).vgns = guiparams.vertical_grid_node_spacing;
2349     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2350     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2351         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2352     
2353     <span class="comment">% Compute the smoothed variables</span>
2354     <span class="comment">% ------------------------------</span>
2355     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2356     <span class="comment">% runtime.</span>
2357     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2358         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2359         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2360         guiparams.vertical_smoothing_window);
2361     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2362     
2363     <span class="comment">% Push messages to Log Window:</span>
2364     <span class="comment">% ----------------------------</span>
2365     statusLogging(handles.LogWindow, processing_log_text)
2366     
2367     <span class="comment">% Plot the cross section:</span>
2368     <span class="comment">% -----------------------</span>
2369     log_text = {<span class="keyword">...</span>
2370         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2371         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2372         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2373         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2374         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2375         };
2376     statusLogging(handles.LogWindow, log_text)
2377     
2378     <span class="comment">% Plot the data:</span>
2379     <span class="comment">% --------------</span>
2380     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2381     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2382     
2383     
2384     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2385         depth_range, <span class="keyword">...</span>
2386         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2387         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2388         guiparams.smoothing_window_size, <span class="keyword">...</span>
2389         guiparams.display_shoreline, <span class="keyword">...</span>
2390         guiparams.english_units, <span class="keyword">...</span>
2391         guiparams.mat_file, <span class="keyword">...</span>
2392         guiparams.mat_path); <span class="comment">% PLOT2</span>
2393     statusLogging(handles.LogWindow, log_text)
2394     
2395     <span class="comment">% Plot User Set Endpoints</span>
2396     <span class="comment">% -----------------------</span>
2397     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2398         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2399         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2400         x = data(:,1);
2401         y = data(:,2);
2402         
2403         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2404         figure(fh); hold on
2405         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2406         hold off
2407     <span class="keyword">end</span>
2408     
2409     <span class="comment">% Plot a Shoreline Map:</span>
2410     <span class="comment">% ---------------------</span>
2411     <span class="keyword">if</span> guiparams.display_shoreline
2412         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2413             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2414             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2415             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2416         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2417             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2418             Map.UTMe   = mapdata(:,1);
2419             Map.UTMn   = mapdata(:,2);
2420             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2421             <span class="comment">%Map.UTMzone = zone;</span>
2422         <span class="keyword">else</span>
2423             Map = [];
2424         <span class="keyword">end</span>
2425         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2426         log_text = {<span class="keyword">...</span>
2427             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2428             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2429             };
2430         statusLogging(handles.LogWindow, log_text)
2431     <span class="keyword">else</span>
2432         Map = [];
2433     <span class="keyword">end</span>
2434     
2435 <span class="keyword">end</span>
2436 
2437 <span class="keyword">if</span> guiparams.add_background
2438     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2439     statusLogging(handles.LogWindow, log_text)
2440 <span class="keyword">end</span>
2441 
2442 <span class="comment">% Update guiparams</span>
2443 <span class="comment">% ----------------</span>
2444 guiparams.z   = z;
2445 guiparams.A   = A;
2446 guiparams.V   = V;
2447 guiparams.Map = Map;
2448 guiparams.iric_anv_planview_data = PVdata;
2449 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2450 
2451 <span class="comment">% Update preferences</span>
2452 <span class="comment">% ------------------</span>
2453 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2454 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2455 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2456 
2457 <span class="comment">% Force plot to be formated properly</span>
2458 <span class="comment">% ----------------------------------</span>
2459 <span class="keyword">if</span> guiparams.presentation
2460     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2461 <span class="keyword">else</span>
2462     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2463 <span class="keyword">end</span>
2464 <span class="keyword">switch</span> guiparams.renderer
2465     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2466         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2467     <span class="keyword">case</span> <span class="string">'painters'</span>
2468         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2469     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2470         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2471 <span class="keyword">end</span>
2472 
2473 <span class="comment">% Focus the figure</span>
2474 <span class="comment">% ----------------</span>
2475 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2476 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2477     figure(hff)
2478 <span class="keyword">end</span>
2479 
2480 <span class="comment">% Start the Graphics Control Gui</span>
2481 <span class="comment">% ------------------------------</span>
2482 VMT_GraphicsControl
2483 
2484 <span class="comment">% [EOF] planviewPlotCallback</span>
2485 
2486 
2487 <span class="comment">% --------------------------------------------------------------------</span>
2488 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2489 <span class="comment">% Plot 3</span>
2490 
2491 <span class="comment">% Get the Application data:</span>
2492 <span class="comment">% -------------------------</span>
2493 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2494 z = guiparams.z;
2495 A = guiparams.A;
2496 <span class="comment">% V = guiparams.V;</span>
2497 <span class="comment">% Map = guiparams.Map;</span>
2498 
2499 <span class="comment">% Preprocess the data:</span>
2500 <span class="comment">% --------------------</span>
2501 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2502 
2503 <span class="comment">% Push messages to Log Window:</span>
2504 <span class="comment">% ----------------------------</span>
2505 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2506 statusLogging(handles.LogWindow, log_text)
2507 
2508 <span class="comment">% Process the transects:</span>
2509 <span class="comment">% ----------------------</span>
2510 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2511 A(1).vgns = guiparams.vertical_grid_node_spacing;
2512 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2513 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2514     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2515 
2516 <span class="comment">% Push messages to Log Window:</span>
2517 <span class="comment">% ----------------------------</span>
2518 statusLogging(handles.LogWindow, processing_log_text)
2519 
2520 <span class="comment">% Plot the cross section:</span>
2521 <span class="comment">% -----------------------</span>
2522 log_text = {<span class="keyword">...</span>
2523     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2524     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2525     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2526     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2527     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2528     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2529     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2530     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2531     };
2532 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2533     log_text = vertcat(log_text, {<span class="keyword">...</span>
2534         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2535         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2536         });
2537 <span class="keyword">end</span>
2538 <span class="comment">% Push messages to Log Window:</span>
2539 <span class="comment">% ----------------------------</span>
2540 statusLogging(handles.LogWindow, log_text)
2541 
2542 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2543     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2544 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2545 <span class="comment">%         ...guiparams.contour, ...</span>
2546 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2547 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2548     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2549         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2550         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2551         guiparams.vertical_smoothing_window);
2552     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2553     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2554         guiparams.contour, <span class="keyword">...</span>
2555         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2556         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2557         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2558         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2559         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2560         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2561         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2562     
2563 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2564     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2565         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2566         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2567         guiparams.vertical_smoothing_window);
2568     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2569     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2570         guiparams.contour, <span class="keyword">...</span>
2571         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2572         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2573     
2574     guiparams.zmin = zmin;
2575     guiparams.zmax = zmax;
2576     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2577 <span class="keyword">end</span>
2578 
2579 <span class="comment">% Force plot to be formated properly</span>
2580 <span class="comment">% ----------------------------------</span>
2581 <span class="keyword">if</span> guiparams.presentation
2582     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2583 <span class="keyword">else</span>
2584     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2585 <span class="keyword">end</span>
2586 <span class="keyword">switch</span> guiparams.renderer
2587     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2588         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2589     <span class="keyword">case</span> <span class="string">'painters'</span>
2590         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2591     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2592         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2593 <span class="keyword">end</span>
2594 
2595 <span class="comment">% Focus the figure</span>
2596 <span class="comment">% ----------------</span>
2597 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2598 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2599     figure(hff)
2600 <span class="keyword">end</span>
2601 
2602 <span class="comment">% Re-store the Application data:</span>
2603 <span class="comment">% ------------------------------</span>
2604 guiparams.V = V;
2605 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2606 
2607 <span class="comment">% Start the Graphics Control Gui</span>
2608 <span class="comment">% ------------------------------</span>
2609 VMT_GraphicsControl
2610 
2611 <span class="comment">% Push messages to Log Window:</span>
2612 <span class="comment">% ----------------------------</span>
2613 statusLogging(handles.LogWindow, plot_cont_log_text)
2614 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2615 
2616 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2617 
2618 
2619 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2620 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2621 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2622 
2623 <span class="comment">% --------------------------------------------------------------------</span>
2624 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2625 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2626 
2627 <span class="comment">% Get the Application data:</span>
2628 <span class="comment">% -------------------------</span>
2629 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2630 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2631 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2632 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2633 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2634 
2635 [the_file,the_path] = <span class="keyword">...</span>
2636     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2637     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2638     fullfile(guiparams.mat_path,guiparams.savefile));
2639 
2640 <span class="comment">% Save the processed data to a MAT file:</span>
2641 <span class="comment">% --------------------------------------</span>
2642 <span class="keyword">if</span> ischar(the_file)
2643     guiparams.mat_path = the_path;
2644     guiparams.mat_file = the_file;
2645     guiparams.savefile = the_file;
2646     
2647     <span class="comment">% Re-store the Application data:</span>
2648     <span class="comment">% ------------------------------</span>
2649     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2650     
2651     <span class="comment">% Update the preferences:</span>
2652     <span class="comment">% -----------------------</span>
2653     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2654     guiprefs.mat_path = the_path;
2655     guiprefs.mat_file = the_file;
2656     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2657     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2658     
2659     [~,filename,extension] = fileparts(guiparams.savefile);
2660     savefile = [filename extension];
2661     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2662         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2663     disp(<span class="string">'Saving Processed Data File...'</span>)
2664     disp(savefile)
2665     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2666 <span class="keyword">end</span>
2667 
2668 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2669 
2670 
2671 <span class="comment">% --------------------------------------------------------------------</span>
2672 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2673 
2674 <span class="comment">% Get the Application data:</span>
2675 <span class="comment">% -------------------------</span>
2676 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2677 <span class="comment">% z   = guiparams.z;</span>
2678 <span class="comment">% A   = guiparams.A;</span>
2679 V   = guiparams.V;
2680 <span class="comment">% Map = guiparams.Map;</span>
2681 
2682 [the_file,the_path] = <span class="keyword">...</span>
2683     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2684     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2685     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2686 
2687 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2688 <span class="comment">% ------------------------------------------</span>
2689 <span class="keyword">if</span> ischar(the_file)
2690     guiparams.tecplot_path = the_path;
2691     guiparams.tecplot_file = the_file;
2692     
2693     <span class="comment">% Re-store the Application data:</span>
2694     <span class="comment">% ------------------------------</span>
2695     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2696     
2697     <span class="comment">% Update the preferences:</span>
2698     <span class="comment">% -----------------------</span>
2699     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2700     guiprefs.tecplot_path = the_path;
2701     guiprefs.tecplot_file = the_file;
2702     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2703     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2704     
2705     <span class="comment">% Push to log window</span>
2706     <span class="comment">% ------------------</span>
2707     log_text = {<span class="keyword">...</span>
2708         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2709         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2710         the_path;<span class="keyword">...</span>
2711         [<span class="string">'Filename: '</span> the_file]};
2712     statusLogging(handles.LogWindow,log_text)
2713         
2714     <span class="keyword">if</span> isempty(V)
2715         A = guiparams.A;
2716         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2717         A(1).vgns = guiparams.vertical_grid_node_spacing;
2718         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2719         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2720             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2721             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2722             guiparams.eta);
2723     <span class="keyword">end</span>
2724     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2725     
2726     <span class="comment">% Push to log window</span>
2727     <span class="comment">% ------------------</span>
2728     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2729     statusLogging(handles.LogWindow,log_text)
2730     
2731     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2732     
2733     <span class="comment">% Push to log window</span>
2734     <span class="comment">% ------------------</span>
2735     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2736     statusLogging(handles.LogWindow,log_text)
2737    
2738 <span class="keyword">end</span>
2739 
2740 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2741 
2742 
2743 <span class="comment">% --------------------------------------------------------------------</span>
2744 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2745 
2746 <span class="comment">% Get the Application data:</span>
2747 <span class="comment">% -------------------------</span>
2748 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2749 <span class="comment">% z   = guiparams.z;</span>
2750 A   = guiparams.A;
2751 V   = guiparams.V;
2752 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2753 
2754 [the_file,the_path] = <span class="keyword">...</span>
2755     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2756     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2757     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2758 
2759 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2760 <span class="comment">% -----------------------------------------------------</span>
2761 <span class="keyword">if</span> ischar(the_file)
2762     guiparams.kmz_path = the_path;
2763     guiparams.kmz_file = the_file;
2764     
2765     <span class="comment">% Re-store the Application data:</span>
2766     <span class="comment">% ------------------------------</span>
2767     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2768     
2769     <span class="comment">% Update the preferences:</span>
2770     <span class="comment">% -----------------------</span>
2771     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2772     guiprefs.kmz_path = the_path;
2773     guiprefs.kmz_file = the_file;
2774     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2775     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2776     
2777     <span class="comment">%     if guiparams.display_shoreline</span>
2778     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2779     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2780     <span class="comment">%                             guiparams.vertical_offset);</span>
2781     <span class="comment">%     end</span>
2782     <span class="keyword">if</span> isempty(V)
2783         A = guiparams.A;
2784         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2785         A(1).vgns = guiparams.vertical_grid_node_spacing;
2786         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2787         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2788             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2789             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2790             guiparams.eta);
2791     <span class="keyword">end</span>
2792     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2793         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2794         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2795         guiparams.vertical_offset);
2796 <span class="keyword">end</span>
2797 
2798 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2799 
2800 
2801 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2802 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2803 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2804 
2805 <span class="comment">% --------------------------------------------------------------------</span>
2806 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2807 
2808 <span class="comment">% Get the Application data:</span>
2809 <span class="comment">% -------------------------</span>
2810 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2811 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2812 z = guiparams.z;
2813 A = guiparams.A;
2814 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2815 <span class="comment">% Map = guiparams.Map;</span>
2816 setends = guiparams.set_cross_section_endpoints;
2817 
2818 [the_file,the_path] = <span class="keyword">...</span>
2819     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2820     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2821     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2822     guiprefs.multibeambathymetry_file));
2823 
2824 <span class="keyword">if</span> ischar(the_file)
2825     guiparams.multibeambathymetry_path = the_path;
2826     guiparams.multibeambathymetry_file = the_file;
2827     
2828     <span class="comment">% Re-store the Application data:</span>
2829     <span class="comment">% ------------------------------</span>
2830     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2831     
2832     <span class="comment">% Update the preferences:</span>
2833     <span class="comment">% -----------------------</span>
2834     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2835     guiprefs.multibeambathymetry_path = the_path;
2836     guiprefs.multibeambathymetry_file = the_file;
2837     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2838     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2839     
2840     <span class="keyword">if</span> guiparams.output_auxiliary_data
2841     <span class="keyword">end</span>
2842     
2843     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2844     
2845     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2846         guiparams.multibeambathymetry_file);
2847     
2848     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2849         [<span class="string">'   '</span> savefile]};
2850     statusLogging(handles.LogWindow,log_text)
2851     
2852     <span class="comment">% Process the transects:</span>
2853     <span class="comment">% ----------------------</span>
2854     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2855     A(1).vgns = guiparams.vertical_grid_node_spacing;
2856     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2857     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2858         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2859     
2860     <span class="comment">% Compute the smoothed variables</span>
2861     <span class="comment">% ------------------------------</span>
2862     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2863     <span class="comment">% runtime.</span>
2864     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2865         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2866         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2867         guiparams.vertical_smoothing_window);
2868     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2869     <span class="comment">% Push messages to Log Window:</span>
2870     <span class="comment">% ----------------------------</span>
2871     statusLogging(handles.LogWindow, processing_log_text)
2872 
2873     
2874     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2875         guiparams.A, <span class="keyword">...</span>
2876         savefile, <span class="keyword">...</span>
2877         guiparams.beam_angle, <span class="keyword">...</span>
2878         guiparams.magnetic_variation, <span class="keyword">...</span>
2879         guiparams.wse, <span class="keyword">...</span>
2880         guiparams.output_auxiliary_data);
2881     
2882     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2883     
2884 <span class="keyword">end</span>
2885 
2886 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2887 
2888 
2889 <span class="comment">% --------------------------------------------------------------------</span>
2890 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2891 <span class="comment">% Get the beam angle</span>
2892 
2893 <span class="comment">% Get the Application data:</span>
2894 <span class="comment">% -------------------------</span>
2895 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2896 
2897 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2898 <span class="comment">% ----------------------------------------------------------------</span>
2899 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2900 is_a_number = ~isnan(new_beam_angle);
2901 is_positive = new_beam_angle&gt;=0;
2902 
2903 <span class="comment">% Modify the Application data:</span>
2904 <span class="comment">% ----------------------------</span>
2905 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2906     guiparams.beam_angle = new_beam_angle;
2907     
2908     <span class="comment">% Re-store the Application data:</span>
2909     <span class="comment">% ------------------------------</span>
2910     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2911     
2912 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2913     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2914 <span class="keyword">end</span>
2915 
2916 <span class="comment">% [EOF] BeamAngle_Callback</span>
2917 
2918 
2919 <span class="comment">% --------------------------------------------------------------------</span>
2920 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2921 <span class="comment">% Get the Magnetic Variation</span>
2922 
2923 <span class="comment">% Get the Application data:</span>
2924 <span class="comment">% -------------------------</span>
2925 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2926 
2927 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2928 <span class="comment">% ----------------------------------------------------------------</span>
2929 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2930 is_a_number = ~isnan(new_magnetic_variation);
2931 is_positive = new_magnetic_variation&gt;=0;
2932 
2933 <span class="comment">% Modify the Application data:</span>
2934 <span class="comment">% ----------------------------</span>
2935 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2936     guiparams.magnetic_variation = new_magnetic_variation;
2937     
2938     <span class="comment">% Re-store the Application data:</span>
2939     <span class="comment">% ------------------------------</span>
2940     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2941     
2942 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2943     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2944 <span class="keyword">end</span>
2945 
2946 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2947 
2948 
2949 <span class="comment">% --------------------------------------------------------------------</span>
2950 <a name="_sub68" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2951 
2952 <span class="comment">% Get the Application data:</span>
2953 <span class="comment">% -------------------------</span>
2954 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2955 
2956 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2957 <span class="comment">% ----------------------------------------------------------------</span>
2958 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2959 is_a_number = ~isnan(new_wse);
2960 is_positive = new_wse&gt;=0;
2961 
2962 <span class="comment">% Modify the Application data:</span>
2963 <span class="comment">% ----------------------------</span>
2964 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2965     guiparams.wse = new_wse;
2966     
2967     <span class="comment">% Re-store the Application data:</span>
2968     <span class="comment">% ------------------------------</span>
2969     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2970     
2971 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2972     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2973 <span class="keyword">end</span>
2974 
2975 <span class="comment">% [EOF] WSE_Callback</span>
2976 
2977 
2978 <span class="comment">% --------------------------------------------------------------------</span>
2979 <a name="_sub69" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2980 <span class="comment">% Bathymetry Auxiliary Data</span>
2981 
2982 <span class="comment">% Get the Application data:</span>
2983 <span class="comment">% -------------------------</span>
2984 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2985 
2986 <span class="comment">% Modify the Application data:</span>
2987 <span class="comment">% ----------------------------</span>
2988 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2989 
2990 <span class="comment">% Re-store the Application data:</span>
2991 <span class="comment">% ------------------------------</span>
2992 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2993 
2994 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2995 
2996 
2997 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2998 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2999 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3000 
3001 <span class="comment">% --------------------------------------------------------------------</span>
3002 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3003 
3004 <span class="comment">% Get the Application data:</span>
3005 <span class="comment">% -------------------------</span>
3006 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3007 
3008 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3009 <span class="comment">% ----------------------------------------------------------------</span>
3010 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3011 is_a_number = ~isnan(new_depth_range_min);
3012 is_positive = new_depth_range_min&gt;=0;
3013 
3014 <span class="comment">% Modify the Application data:</span>
3015 <span class="comment">% ----------------------------</span>
3016 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3017     guiparams.depth_range_min = new_depth_range_min;
3018     
3019     <span class="comment">% Re-store the Application data:</span>
3020     <span class="comment">% ------------------------------</span>
3021     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3022     
3023 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3024     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3025 <span class="keyword">end</span>
3026 
3027 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3028 
3029 
3030 <span class="comment">% --------------------------------------------------------------------</span>
3031 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3032 
3033 <span class="comment">% Get the Application data:</span>
3034 <span class="comment">% -------------------------</span>
3035 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3036 
3037 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3038 <span class="comment">% ----------------------------------------------------------------</span>
3039 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3040 is_a_number = ~isnan(new_depth_range_max);
3041 is_positive = new_depth_range_max&gt;=0;
3042 
3043 <span class="comment">% Modify the Application data:</span>
3044 <span class="comment">% ----------------------------</span>
3045 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3046     guiparams.depth_range_max = new_depth_range_max;
3047     
3048     <span class="comment">% Re-store the Application data:</span>
3049     <span class="comment">% ------------------------------</span>
3050     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3051     
3052 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3053     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3054 <span class="keyword">end</span>
3055 
3056 <span class="comment">% [EOF] DepthMax_Callback</span>
3057 
3058 
3059 <span class="comment">% --------------------------------------------------------------------</span>
3060 <a name="_sub72" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3061 <span class="comment">% Set quiver scale (contour)</span>
3062 
3063 <span class="comment">% Get the Application data:</span>
3064 <span class="comment">% -------------------------</span>
3065 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3066 
3067 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3068 <span class="comment">% ----------------------------------------------------------------</span>
3069 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3070 is_a_number = ~isnan(new_vector_scale_plan_view);
3071 is_positive = new_vector_scale_plan_view&gt;=0;
3072 
3073 <span class="comment">% Modify the Application data:</span>
3074 <span class="comment">% ----------------------------</span>
3075 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3076     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
3077     
3078     <span class="comment">% Re-store the Application data:</span>
3079     <span class="comment">% ------------------------------</span>
3080     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3081     
3082 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3083     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3084 <span class="keyword">end</span>
3085 
3086 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3087 
3088 
3089 <span class="comment">% --------------------------------------------------------------------</span>
3090 <a name="_sub73" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3091 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3092 
3093 <span class="comment">% Get the Application data:</span>
3094 <span class="comment">% -------------------------</span>
3095 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3096 
3097 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3098 <span class="comment">% ----------------------------------------------------------------</span>
3099 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3100 is_a_number = ~isnan(new_vector_spacing_plan_view);
3101 is_positive = new_vector_spacing_plan_view&gt;=0;
3102 
3103 <span class="comment">% Modify the Application data:</span>
3104 <span class="comment">% ----------------------------</span>
3105 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3106     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3107     
3108     <span class="comment">% Re-store the Application data:</span>
3109     <span class="comment">% ------------------------------</span>
3110     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3111     
3112 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3113     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3114 <span class="keyword">end</span>
3115 
3116 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3117 
3118 
3119 <span class="comment">% --------------------------------------------------------------------</span>
3120 <a name="_sub74" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3121 <span class="comment">% Plan View smoothing window size</span>
3122 
3123 <span class="comment">% Get the Application data:</span>
3124 <span class="comment">% -------------------------</span>
3125 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3126 
3127 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3128 <span class="comment">% ----------------------------------------------------------------</span>
3129 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3130 is_a_number = ~isnan(new_smoothing_window_size);
3131 is_positive = new_smoothing_window_size&gt;=0;
3132 
3133 <span class="comment">% Modify the Application data:</span>
3134 <span class="comment">% ----------------------------</span>
3135 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3136     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3137     
3138     <span class="comment">% Re-store the Application data:</span>
3139     <span class="comment">% ------------------------------</span>
3140     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3141     
3142 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3143     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3144 <span class="keyword">end</span>
3145 
3146 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3147 
3148 
3149 <span class="comment">% --------------------------------------------------------------------</span>
3150 <a name="_sub75" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3151 
3152 <span class="comment">% Get the Application data:</span>
3153 <span class="comment">% -------------------------</span>
3154 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3155 
3156 <span class="comment">% Modify the Application data:</span>
3157 <span class="comment">% ----------------------------</span>
3158 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3159 
3160 <span class="comment">% Re-store the Application data:</span>
3161 <span class="comment">% ------------------------------</span>
3162 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3163 
3164 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3165 
3166 
3167 <span class="comment">% --------------------------------------------------------------------</span>
3168 <a name="_sub76" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3169 
3170 <span class="comment">% Get the Application data:</span>
3171 <span class="comment">% -------------------------</span>
3172 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3173 
3174 <span class="comment">% Modify the Application data:</span>
3175 <span class="comment">% ----------------------------</span>
3176 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3177 
3178 <span class="comment">% Re-store the Application data:</span>
3179 <span class="comment">% ------------------------------</span>
3180 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3181 
3182 <span class="comment">% [EOF] AddBackground_Callback</span>
3183 
3184 
3185 <span class="comment">% --------------------------------------------------------------------</span>
3186 <a name="_sub77" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3187 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3188 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3189 
3190 
3191 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3192 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3193 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3194 
3195 <span class="comment">% --------------------------------------------------------------------</span>
3196 <a name="_sub78" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3197 <span class="comment">% Set the horizontal grid node spacing</span>
3198 
3199 <span class="comment">% Get the Application data:</span>
3200 <span class="comment">% -------------------------</span>
3201 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3202 
3203 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3204 <span class="comment">% ----------------------------------------------------------------</span>
3205 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3206 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3207 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3208 
3209 <span class="comment">% Modify the Application data:</span>
3210 <span class="comment">% ----------------------------</span>
3211 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3212     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3213     
3214     <span class="comment">% Re-store the Application data:</span>
3215     <span class="comment">% ------------------------------</span>
3216     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3217     
3218 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3219     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3220 <span class="keyword">end</span>
3221 
3222 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3223 
3224 <span class="comment">% --------------------------------------------------------------------</span>
3225 <a name="_sub79" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3226 <span class="comment">% Set the horizontal grid node spacing</span>
3227 
3228 <span class="comment">% Get the Application data:</span>
3229 <span class="comment">% -------------------------</span>
3230 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3231 
3232 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3233 <span class="comment">% ----------------------------------------------------------------</span>
3234 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3235 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3236 is_positive = new_vertical_grid_node_spacing&gt;=0;
3237 
3238 <span class="comment">% Modify the Application data:</span>
3239 <span class="comment">% ----------------------------</span>
3240 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3241     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3242     
3243     <span class="comment">% Re-store the Application data:</span>
3244     <span class="comment">% ------------------------------</span>
3245     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3246     
3247 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3248     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3249 <span class="keyword">end</span>
3250 
3251 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3252 
3253 <span class="comment">% --------------------------------------------------------------------</span>
3254 <a name="_sub80" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3255 <span class="comment">% Set the cross section endpoints manually</span>
3256 
3257 <span class="comment">% Get the Application data:</span>
3258 <span class="comment">% -------------------------</span>
3259 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3260 
3261 <span class="comment">% Modify the Application data:</span>
3262 <span class="comment">% ----------------------------</span>
3263 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3264 
3265 <span class="comment">% Re-store the Application data:</span>
3266 <span class="comment">% ------------------------------</span>
3267 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3268 
3269 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3270 
3271 
3272 <span class="comment">% --------------------------------------------------------------------</span>
3273 <a name="_sub81" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3274 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3275 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3276 
3277 
3278 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3279 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3280 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3281 
3282 <span class="comment">% --------------------------------------------------------------------</span>
3283 <a name="_sub82" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3284 
3285 <span class="comment">% Get the Application data:</span>
3286 <span class="comment">% -------------------------</span>
3287 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3288 
3289 <span class="comment">% Modify the Application data:</span>
3290 <span class="comment">% ----------------------------</span>
3291 idx_variable = get(hObject,<span class="string">'Value'</span>);
3292 guiparams.idx_contour = idx_variable;
3293 guiparams.contour = guiparams.contours(idx_variable).variable;
3294 
3295 <span class="comment">% Re-store the Application data:</span>
3296 <span class="comment">% ------------------------------</span>
3297 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3298 
3299 <span class="comment">% [EOF] Contour_Callback</span>
3300 
3301 
3302 <span class="comment">% --------------------------------------------------------------------</span>
3303 <a name="_sub83" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3304 <span class="comment">% Set vertical exaggeration</span>
3305 
3306 <span class="comment">% Get the Application data:</span>
3307 <span class="comment">% -------------------------</span>
3308 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3309 
3310 <span class="comment">% Modify the Application data:</span>
3311 <span class="comment">% ----------------------------</span>
3312 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3313 
3314 <span class="comment">% Re-store the Application data:</span>
3315 <span class="comment">% ------------------------------</span>
3316 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3317 
3318 <span class="comment">% Update the GUI:</span>
3319 <span class="comment">% ---------------</span>
3320 <span class="comment">% updateGUI(handles,guiparams)</span>
3321 
3322 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3323 
3324 
3325 <span class="comment">% --------------------------------------------------------------------</span>
3326 <a name="_sub84" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3327 
3328 <span class="comment">% Get the Application data:</span>
3329 <span class="comment">% -------------------------</span>
3330 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3331 
3332 <span class="comment">% Modify the Application data:</span>
3333 <span class="comment">% ----------------------------</span>
3334 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3335 
3336 <span class="comment">% Re-store the Application data:</span>
3337 <span class="comment">% ------------------------------</span>
3338 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3339 
3340 <span class="comment">% Update the GUI:</span>
3341 <span class="comment">% ---------------</span>
3342 <span class="comment">% updateGUI(handles,guiparams)</span>
3343 
3344 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3345 
3346 
3347 <span class="comment">% --------------------------------------------------------------------</span>
3348 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3349 
3350 <span class="comment">% Get the Application data:</span>
3351 <span class="comment">% -------------------------</span>
3352 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3353 
3354 <span class="comment">% Modify the Application data:</span>
3355 <span class="comment">% ----------------------------</span>
3356 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3357 
3358 <span class="comment">% Re-store the Application data:</span>
3359 <span class="comment">% ------------------------------</span>
3360 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3361 
3362 <span class="comment">% Update the GUI:</span>
3363 <span class="comment">% ---------------</span>
3364 <span class="comment">% updateGUI(handles,guiparams)</span>
3365 
3366 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3367 
3368 
3369 <span class="comment">% --------------------------------------------------------------------</span>
3370 <a name="_sub86" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3371 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3372 
3373 <span class="comment">% Get the Application data:</span>
3374 <span class="comment">% -------------------------</span>
3375 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3376 
3377 <span class="comment">% Modify the Application data:</span>
3378 <span class="comment">% ----------------------------</span>
3379 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3380 
3381 <span class="comment">% Re-store the Application data:</span>
3382 <span class="comment">% ------------------------------</span>
3383 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3384 
3385 <span class="comment">% Update the GUI:</span>
3386 <span class="comment">% ---------------</span>
3387 <span class="comment">% updateGUI(handles,guiparams)</span>
3388 
3389 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3390 
3391 
3392 <span class="comment">% --------------------------------------------------------------------</span>
3393 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3394 <span class="comment">% Horizontal Smoothing</span>
3395 
3396 <span class="comment">% Get the Application data:</span>
3397 <span class="comment">% -------------------------</span>
3398 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3399 
3400 <span class="comment">% Modify the Application data:</span>
3401 <span class="comment">% ----------------------------</span>
3402 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3403 
3404 <span class="comment">% Re-store the Application data:</span>
3405 <span class="comment">% ------------------------------</span>
3406 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3407 
3408 <span class="comment">% Update the GUI:</span>
3409 <span class="comment">% ---------------</span>
3410 <span class="comment">% updateGUI(handles,guiparams)</span>
3411 
3412 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3413 
3414 
3415 <span class="comment">% --------------------------------------------------------------------</span>
3416 <a name="_sub88" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3417 <span class="comment">% Vertical Smoothing</span>
3418 
3419 <span class="comment">% Get the Application data:</span>
3420 <span class="comment">% -------------------------</span>
3421 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3422 
3423 <span class="comment">% Modify the Application data:</span>
3424 <span class="comment">% ----------------------------</span>
3425 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3426 
3427 <span class="comment">% Re-store the Application data:</span>
3428 <span class="comment">% ------------------------------</span>
3429 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3430 
3431 <span class="comment">% Update the GUI:</span>
3432 <span class="comment">% ---------------</span>
3433 <span class="comment">% updateGUI(handles,guiparams)</span>
3434 
3435 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3436 
3437 
3438 <span class="comment">% --------------------------------------------------------------------</span>
3439 <a name="_sub89" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3440 
3441 <span class="comment">% Get the Application data:</span>
3442 <span class="comment">% -------------------------</span>
3443 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3444 
3445 <span class="comment">% Modify the Application data:</span>
3446 <span class="comment">% ----------------------------</span>
3447 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3448 
3449 <span class="comment">% Re-store the Application data:</span>
3450 <span class="comment">% ------------------------------</span>
3451 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3452 
3453 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3454 
3455 
3456 <span class="comment">% --------------------------------------------------------------------</span>
3457 <a name="_sub90" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3458 
3459 <span class="comment">% Get the Application data:</span>
3460 <span class="comment">% -------------------------</span>
3461 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3462 
3463 <span class="comment">% Modify the Application data:</span>
3464 <span class="comment">% ----------------------------</span>
3465 idx_variable = get(hObject,<span class="string">'Value'</span>);
3466 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3467 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3468 
3469 <span class="comment">% Re-store the Application data:</span>
3470 <span class="comment">% ------------------------------</span>
3471 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3472 
3473 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3474 
3475 
3476 <span class="comment">% --------------------------------------------------------------------</span>
3477 <a name="_sub91" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3478 
3479 <span class="comment">% Get the Application data:</span>
3480 <span class="comment">% -------------------------</span>
3481 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3482 
3483 <span class="comment">% Modify the Application data:</span>
3484 <span class="comment">% ----------------------------</span>
3485 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3486 
3487 <span class="comment">% Re-store the Application data:</span>
3488 <span class="comment">% ------------------------------</span>
3489 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3490 
3491 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3492 
3493 
3494 <span class="comment">% --------------------------------------------------------------------</span>
3495 <a name="_sub92" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3496 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3497 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3498 
3499 
3500 <span class="comment">% --------------------------------------------------------------------</span>
3501 <a name="_sub93" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3502 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3503 <span class="comment">% [EOF] ClearLog_Callback</span>
3504 
3505 <span class="comment">% --------------------------------------------------------------------</span>
3506 <a name="_sub94" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3507 
3508 <span class="comment">% Get the Application data:</span>
3509 <span class="comment">% -------------------------</span>
3510 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3511 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3512 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3513 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3514 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3515 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3516 
3517 [the_file,the_path] = <span class="keyword">...</span>
3518     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3519     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3520     fullfile(guiprefs.log_path,guiprefs.log_file));
3521 
3522 <span class="comment">% Save the log to a TXT file:</span>
3523 <span class="comment">% ---------------------------</span>
3524 <span class="keyword">if</span> ischar(the_file)
3525     guiparams.log_path = the_path;
3526     guiparams.log_file = the_file;
3527     <span class="comment">%guiparams.savefile = the_file;</span>
3528     
3529     <span class="comment">% Re-store the Application data:</span>
3530     <span class="comment">% ------------------------------</span>
3531     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3532     
3533     <span class="comment">% Update the preferences:</span>
3534     <span class="comment">% -----------------------</span>
3535     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3536     guiprefs.log_path = the_path;
3537     guiprefs.log_file = the_file;
3538     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3539     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3540     
3541     [~,filename,extension] = fileparts(the_file);
3542     savefile = [the_path filename extension];
3543     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3544         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3545     
3546     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3547     [nrows,~]= size(logfile);
3548     fid = fopen(savefile, <span class="string">'w'</span>);
3549     <span class="keyword">for</span> row=1:nrows
3550         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3551     <span class="keyword">end</span>
3552     fclose(fid);
3553 <span class="keyword">end</span>
3554 <span class="comment">% [EOF] SaveLog_Callback</span>
3555 
3556 <span class="comment">%%%%%%%%%%%%%%%%</span>
3557 <span class="comment">% SUBFUNCTIONS %</span>
3558 <span class="comment">%%%%%%%%%%%%%%%%</span>
3559 
3560 <span class="comment">% --------------------------------------------------------------------</span>
3561 <a name="_sub95" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3562 
3563 icons = <a href="#_sub111" class="code" title="subfunction icons = getIcons">getIcons</a>;
3564 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3565 
3566 <span class="comment">% Load data</span>
3567 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3568 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3569 <span class="comment">% icon(icon==0) = NaN;</span>
3570 handles.toolbarLoadData = <span class="keyword">...</span>
3571     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3572     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3573     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3574 
3575 <span class="comment">% Save data</span>
3576 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3577 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3578 <span class="comment">% icon(icon==0) = NaN;</span>
3579 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3580     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3581     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3582     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3583     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3584 
3585 
3586 <span class="comment">% Save bathymetry</span>
3587 <span class="comment">%icon = ones(16,16,3);</span>
3588 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3589     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3590     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3591     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3592 
3593 <span class="comment">% Save figures</span>
3594 <span class="comment">% icon = ones(16,16,3);</span>
3595 handles.toolbarSaveFigures = <span class="keyword">...</span>
3596     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3597     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3598     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3599 
3600 <span class="comment">% Save Excel File</span>
3601 <span class="comment">% icon = ones(16,16,3);</span>
3602 handles.toolbarSaveExcel = <span class="keyword">...</span>
3603     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3604     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3605     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3606 
3607 
3608 <span class="comment">% Plotting parameters</span>
3609 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3610 <span class="comment">% icon = ind2rgb(icon,map);</span>
3611 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3612     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3613     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3614     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3615     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3616 
3617 <span class="comment">% Processing parameters</span>
3618 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3619 <span class="comment">% icon = ind2rgb(icon,map);</span>
3620 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3621     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3622     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3623     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3624 
3625 <span class="comment">% Zoom In</span>
3626 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3627 <span class="comment">% icon = ind2rgb(icon,map);</span>
3628 <span class="comment">% handles.toolbarZoomIn = ...</span>
3629 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3630 <span class="comment">%     'CData',        icons(8).data, ...</span>
3631 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3632 <span class="comment">%     'Separator',     'on');</span>
3633 
3634 <span class="comment">% Zoom Out</span>
3635 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3636 <span class="comment">% icon = ind2rgb(icon,map);</span>
3637 <span class="comment">% handles.toolbarZoomOut = ...</span>
3638 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3639 <span class="comment">%     'CData',        icons(9).data, ...</span>
3640 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3641 
3642 <span class="comment">% Pan</span>
3643 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3644 <span class="comment">% icon = ind2rgb(icon,map);</span>
3645 <span class="comment">% handles.toolbarPan = ...</span>
3646 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3647 <span class="comment">%     'CData',        icons(10).data, ...</span>
3648 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3649 
3650 
3651 
3652 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3653 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3654 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3655 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3656 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3657 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3658 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3659 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3660 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3661 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3662 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3663 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3664 
3665 <span class="comment">% [EOF] buildtoolbar</span>
3666 
3667 
3668 <span class="comment">% --------------------------------------------------------------------</span>
3669 <a name="_sub96" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3670 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3671 <span class="comment">% already exist.</span>
3672 
3673 <span class="comment">% Preferences:</span>
3674 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3675 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3676 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3677 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3678 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3679 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3680 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3681 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3682 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3683 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3684 <span class="comment">% 'renderer'             Default graphics renderer</span>
3685 <span class="comment">% 'units'                Default plotting units</span>
3686 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3687 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3688 <span class="comment">%                        started</span>
3689 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3690 
3691 <span class="comment">% Originals</span>
3692 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3693 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3694 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3695 
3696 <span class="comment">% ASCII</span>
3697 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3698     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3699     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3700         guiprefs.ascii_path = ascii.path;
3701     <span class="keyword">else</span>
3702         guiprefs.ascii_path = pwd;
3703     <span class="keyword">end</span>
3704     does_exist = false(1,length(ascii.file));
3705     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3706         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3707     <span class="keyword">end</span>
3708     <span class="keyword">if</span> any(does_exist)
3709         guiprefs.ascii_file = ascii.file(does_exist);
3710     <span class="keyword">else</span>
3711         guiprefs.ascii_file = {<span class="string">''</span>};
3712     <span class="keyword">end</span>
3713 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3714     guiprefs.ascii_path = pwd;
3715     guiprefs.ascii_file = {<span class="string">''</span>};
3716     
3717     ascii.path = pwd;
3718     ascii.file = {<span class="string">''</span>};
3719     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3720 <span class="keyword">end</span>
3721 
3722 <span class="comment">% MAT</span>
3723 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3724     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3725     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3726         guiprefs.mat_path = mat.path;
3727     <span class="keyword">else</span>
3728         guiprefs.mat_path = pwd;
3729     <span class="keyword">end</span>
3730     
3731     <span class="keyword">if</span> iscell(mat.file)
3732         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3733             guiprefs.mat_file = mat.file;
3734         <span class="keyword">else</span>
3735             guiprefs.mat_file = <span class="string">''</span>;
3736         <span class="keyword">end</span>
3737     <span class="keyword">else</span>
3738         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3739             guiprefs.mat_file = mat.file;
3740         <span class="keyword">else</span>
3741             guiprefs.mat_file = <span class="string">''</span>;
3742         <span class="keyword">end</span>
3743     <span class="keyword">end</span>
3744 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3745     guiprefs.mat_path = pwd;
3746     guiprefs.mat_file = <span class="string">''</span>;
3747     
3748     mat.path = pwd;
3749     mat.file = <span class="string">''</span>;
3750     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3751 <span class="keyword">end</span>
3752 
3753 <span class="comment">% TECPLOT</span>
3754 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3755     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3756     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3757         guiprefs.tecplot_path = tecplot.path;
3758     <span class="keyword">else</span>
3759         guiprefs.tecplot_path = pwd;
3760     <span class="keyword">end</span>
3761     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3762         guiprefs.tecplot_file = tecplot.file;
3763     <span class="keyword">else</span>
3764         guiprefs.tecplot_file = <span class="string">''</span>;
3765     <span class="keyword">end</span>
3766 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3767     guiprefs.tecplot_path = pwd;
3768     guiprefs.tecplot_file = <span class="string">''</span>;
3769     
3770     tecplot.path = pwd;
3771     tecplot.file = <span class="string">''</span>;
3772     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3773 <span class="keyword">end</span>
3774 
3775 <span class="comment">% KMZ</span>
3776 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3777     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3778     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3779         guiprefs.kmz_path = kmz.path;
3780     <span class="keyword">else</span>
3781         guiprefs.kmz_path = pwd;
3782     <span class="keyword">end</span>
3783     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3784         guiprefs.kmz_file = kmz.file;
3785     <span class="keyword">else</span>
3786         guiprefs.kmz_file = <span class="string">''</span>;
3787     <span class="keyword">end</span>
3788 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3789     guiprefs.kmz_path = pwd;
3790     guiprefs.kmz_file = <span class="string">''</span>;
3791     
3792     kmz.path = pwd;
3793     kmz.file = <span class="string">''</span>;
3794     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3795 <span class="keyword">end</span>
3796 
3797 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3798 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3799     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3800     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3801         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3802     <span class="keyword">else</span>
3803         guiprefs.multibeambathymetry_path = pwd;
3804     <span class="keyword">end</span>
3805     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3806         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3807     <span class="keyword">else</span>
3808         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3809     <span class="keyword">end</span>
3810 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3811     guiprefs.multibeambathymetry_path = pwd;
3812     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3813     
3814     multibeambathymetry.path = pwd;
3815     multibeambathymetry.file = <span class="string">''</span>;
3816     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3817 <span class="keyword">end</span>
3818 
3819 <span class="comment">% Log</span>
3820 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3821     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3822     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3823         guiprefs.log_path = log.path;
3824     <span class="keyword">else</span>
3825         guiprefs.log_path = pwd;
3826     <span class="keyword">end</span>
3827     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3828         guiprefs.log_file = log.file;
3829     <span class="keyword">else</span>
3830         guiprefs.log_file = <span class="string">''</span>;
3831     <span class="keyword">end</span>
3832 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3833     guiprefs.log_path = pwd;
3834     guiprefs.log_file = <span class="string">''</span>;
3835     
3836     log.path = pwd;
3837     log.file = <span class="string">''</span>;
3838     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3839 <span class="keyword">end</span>
3840 
3841 <span class="comment">% iRic</span>
3842 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3843     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3844     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3845         guiprefs.iric_path = iric.path;
3846     <span class="keyword">else</span>
3847         guiprefs.iric_path = pwd;
3848     <span class="keyword">end</span>
3849     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3850         guiprefs.iric_file = iric.file;
3851     <span class="keyword">else</span>
3852         guiprefs.iric_file = <span class="string">''</span>;
3853     <span class="keyword">end</span>
3854 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3855     guiprefs.iric_path = pwd;
3856     guiprefs.iric_file = <span class="string">''</span>;
3857     
3858     iric.path = pwd;
3859     iric.file = <span class="string">''</span>;
3860     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3861 <span class="keyword">end</span>
3862 
3863 <span class="comment">% excel</span>
3864 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3865     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3866     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3867         guiprefs.excel_path = excel.path;
3868     <span class="keyword">else</span>
3869         guiprefs.excel_path = pwd;
3870     <span class="keyword">end</span>
3871     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3872         guiprefs.excel_file = excel.file;
3873     <span class="keyword">else</span>
3874         guiprefs.excel_file = <span class="string">''</span>;
3875     <span class="keyword">end</span>
3876 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3877     guiprefs.excel_path = pwd;
3878     guiprefs.excel_file = <span class="string">''</span>;
3879     
3880     excel.path = pwd;
3881     excel.file = <span class="string">''</span>;
3882     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3883 <span class="keyword">end</span>
3884 
3885 <span class="comment">% aerial</span>
3886 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3887     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3888     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3889         guiprefs.aerial_path = aerial.path;
3890     <span class="keyword">else</span>
3891         guiprefs.aerial_path = pwd;
3892     <span class="keyword">end</span>
3893     does_exist = false(1,length(aerial.file));
3894     <span class="keyword">if</span> iscell(aerial.file)
3895     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3896         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3897     <span class="keyword">end</span>
3898     <span class="keyword">else</span>
3899         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3900     <span class="keyword">end</span>
3901     <span class="keyword">if</span> any(does_exist)
3902         guiprefs.aerial_file = aerial.file;
3903     <span class="keyword">else</span>
3904         guiprefs.aerial_file = {<span class="string">''</span>};
3905     <span class="keyword">end</span>
3906 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3907     guiprefs.aerial_path = pwd;
3908     guiprefs.aerial_file = {<span class="string">''</span>};
3909     
3910     aerial.path = pwd;
3911     aerial.file = {<span class="string">''</span>};
3912     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3913 <span class="keyword">end</span>
3914 
3915 <span class="comment">% shoreline</span>
3916 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3917     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3918     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3919         guiprefs.shoreline_path = shoreline.path;
3920     <span class="keyword">else</span>
3921         guiprefs.shoreline_path = pwd;
3922     <span class="keyword">end</span>
3923     
3924     <span class="keyword">if</span> iscell(shoreline.file)
3925         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3926             guiprefs.shoreline_file = shoreline.file;
3927         <span class="keyword">else</span>
3928             guiprefs.shoreline_file = <span class="string">''</span>;
3929         <span class="keyword">end</span>
3930     <span class="keyword">else</span>
3931         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3932             guiprefs.shoreline_file = shoreline.file;
3933         <span class="keyword">else</span>
3934             guiprefs.shoreline_file = <span class="string">''</span>;
3935         <span class="keyword">end</span>
3936     <span class="keyword">end</span>
3937 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3938     guiprefs.shoreline_path = pwd;
3939     guiprefs.shoreline_file = <span class="string">''</span>;
3940     
3941     shoreline.path = pwd;
3942     shoreline.file = <span class="string">''</span>;
3943     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3944 <span class="keyword">end</span>
3945 <span class="comment">% guiprefs.presentation = true;</span>
3946 <span class="comment">% guiprefs.print        = false;</span>
3947 
3948 <span class="comment">% for k = 1:length(prefs)</span>
3949 <span class="comment">%     newpref = '';</span>
3950 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3951 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3952 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3953 <span class="comment">%             newpref = stored_newpref;</span>
3954 <span class="comment">%         else</span>
3955 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3956 <span class="comment">%         end</span>
3957 <span class="comment">%     end</span>
3958 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3959 <span class="comment">% end</span>
3960 
3961 <span class="comment">% RENDERER</span>
3962 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3963     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3964     guiprefs.renderer = renderer;
3965 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3966     renderer           = <span class="string">'OpenGL'</span>;
3967     guiprefs.renderer  = renderer;
3968     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3969 <span class="keyword">end</span>
3970 
3971 <span class="comment">% UNITS</span>
3972 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3973     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3974     guiprefs.units = units;
3975 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
3976     units           = <span class="string">'metric'</span>;
3977     guiprefs.units  = units;
3978     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3979 <span class="keyword">end</span>
3980 
3981 <span class="comment">% PLOTREF</span>
3982 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
3983     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
3984     guiprefs.plotref = plotref;
3985 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
3986     plotref           = <span class="string">'dfs'</span>;
3987     guiprefs.plotref  = plotref;
3988     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
3989 <span class="keyword">end</span>
3990 
3991 <span class="comment">% RUNCOUNTER</span>
3992 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3993     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3994     guiprefs.runcounter = runcounter;
3995 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3996     runcounter           = 1;
3997     guiprefs.runcounter  = runcounter;
3998     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3999 <span class="keyword">end</span>
4000 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4001 
4002 <span class="comment">% SETENDPOINTS</span>
4003 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4004     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4005     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4006         guiprefs.setendpoints_path = setendpoints.path;
4007     <span class="keyword">else</span>
4008         guiprefs.setendpoints_path = pwd;
4009     <span class="keyword">end</span>
4010     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4011         guiprefs.setendpoints_file = setendpoints.file;
4012     <span class="keyword">else</span>
4013         guiprefs.setendpoints_file = <span class="string">''</span>;
4014     <span class="keyword">end</span>
4015 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4016     guiprefs.setendpoints_path = pwd;
4017     guiprefs.setendpoints_file = <span class="string">''</span>;
4018     
4019     setendpoints.path = pwd;
4020     setendpoints.file = <span class="string">''</span>;
4021     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4022 <span class="keyword">end</span>
4023 
4024 <span class="comment">% [EOF] load_prefs</span>
4025 
4026 
4027 <span class="comment">% --------------------------------------------------------------------</span>
4028 <a name="_sub97" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4029 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4030 <span class="comment">% preferences data.</span>
4031 
4032 <span class="comment">% Preferences:</span>
4033 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4034 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4035 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4036 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4037 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4038 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4039 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4040 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4041 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4042 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4043 <span class="comment">% 'renderer'             Default graphics renderer</span>
4044 <span class="comment">% 'units'                Default plotting units</span>
4045 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4046 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4047 <span class="comment">%                        started</span>
4048 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4049 
4050 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4051 
4052 <span class="keyword">switch</span> pref
4053     <span class="keyword">case</span> <span class="string">'ascii'</span>
4054         ascii.path = guiprefs.ascii_path;
4055         ascii.file = guiprefs.ascii_file;
4056         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4057     <span class="keyword">case</span> <span class="string">'mat'</span>
4058         mat.path = guiprefs.mat_path;
4059         mat.file = guiprefs.mat_file;
4060         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4061     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4062         tecplot.path = guiprefs.tecplot_path;
4063         tecplot.file = guiprefs.tecplot_file;
4064         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4065     <span class="keyword">case</span> <span class="string">'kmz'</span>
4066         kmz.path = guiprefs.kmz_path;
4067         kmz.file = guiprefs.kmz_file;
4068         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4069     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4070         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4071         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4072         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4073     <span class="keyword">case</span> <span class="string">'log'</span>
4074         log.path = guiprefs.log_path;
4075         log.file = guiprefs.log_file;
4076         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4077     <span class="keyword">case</span> <span class="string">'iric'</span>
4078         iric.path = guiprefs.iric_path;
4079         iric.file = guiprefs.iric_file;
4080         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4081     <span class="keyword">case</span> <span class="string">'excel'</span>
4082         excel.path = guiprefs.excel_path;
4083         excel.file = guiprefs.excel_file;
4084         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4085     <span class="keyword">case</span> <span class="string">'aerial'</span>
4086         aerial.path = guiprefs.aerial_path;
4087         aerial.file = guiprefs.aerial_file;
4088         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4089     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4090         shoreline.path = guiprefs.shoreline_path;
4091         shoreline.file = guiprefs.shoreline_file;
4092         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4093     <span class="keyword">case</span> <span class="string">'renderer'</span>
4094         renderer = guiprefs.renderer;
4095         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4096     <span class="keyword">case</span> <span class="string">'units'</span>
4097         units = guiprefs.units;
4098         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4099     <span class="keyword">case</span> <span class="string">'plotref'</span>
4100         plotref = guiprefs.plotref;
4101         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4102     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4103         runcounter = guiprefs.runcounter;
4104         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4105     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4106         setendpoints.path = guiprefs.setendpoints_path;
4107         setendpoints.file = guiprefs.setendpoints_file;
4108         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4109     <span class="keyword">otherwise</span>
4110 <span class="keyword">end</span>
4111 
4112 <span class="comment">% if ismember(pref,prefs)</span>
4113 <span class="comment">%     setpref('VMT',pref,value)</span>
4114 <span class="comment">%</span>
4115 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4116 <span class="comment">%     guiprefs.(pref) = value;</span>
4117 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4118 <span class="comment">% end</span>
4119 
4120 <span class="comment">% [EOF] store_prefs</span>
4121 
4122 
4123 <span class="comment">% --------------------------------------------------------------------</span>
4124 <a name="_sub98" href="#_subfunctions" class="code">function initGUI(handles)</a>
4125 <span class="comment">% Initialize the UI controls in the GUI.</span>
4126 
4127 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4128 
4129 <span class="comment">% Set the name and version</span>
4130 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4131     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4132 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4133 
4134 <span class="comment">% Set the PLOT 1 axis labels</span>
4135 axes(handles.Plot1Shiptracks);
4136 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4137 xlabel(<span class="string">'UTM Easting (m)'</span>)
4138 ylabel(<span class="string">'UTM Northing (m)'</span>)
4139 box on
4140 grid on
4141 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4142 
4143 <span class="comment">%%%%%%%%%%%%</span>
4144 <span class="comment">% MENU BAR %</span>
4145 <span class="comment">%%%%%%%%%%%%</span>
4146 <span class="keyword">if</span> guiparams.english_units
4147     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4148     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4149 <span class="keyword">else</span>
4150     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4151     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4152 <span class="keyword">end</span>
4153 
4154 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4155     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4156     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4157 <span class="keyword">else</span>
4158     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4159     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4160 <span class="keyword">end</span>
4161 
4162 
4163 <span class="keyword">if</span> guiparams.print
4164     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4165     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4166     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4167     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4168 <span class="keyword">elseif</span> guiparams.presentation
4169     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4170     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4171     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4172     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4173 <span class="keyword">else</span>
4174 <span class="keyword">end</span>
4175 
4176 <span class="keyword">switch</span> guiparams.renderer
4177     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4178         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4179         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4180         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4181     <span class="keyword">case</span> <span class="string">'painters'</span>
4182         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4183         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4184         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4185     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4186         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4187         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4188         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4189 <span class="keyword">end</span>
4190 
4191 
4192 <span class="comment">%%%%%%%%%%%%%%%</span>
4193 <span class="comment">% DATA EXPORT %</span>
4194 <span class="comment">%%%%%%%%%%%%%%%</span>
4195 <span class="comment">% BathymetryPanel</span>
4196 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4197 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4198 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4199 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4200 
4201 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4202 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4203 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4204 <span class="comment">% PlanViewPanel</span>
4205 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4206 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4207 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4208 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4209 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4210 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4211 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4212 
4213 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4214 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4216 <span class="comment">% ShiptracksPanel</span>
4217 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4218 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4219 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4220 
4221 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4222 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4223 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4224 <span class="comment">% CrossSectionsPanel</span>
4225 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4226     <span class="string">'Value'</span>, guiparams.idx_contour)
4227 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4228 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4229 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4230 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4231 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4232 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4233 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4234 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4235     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4236 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4237 
4238 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4239 
4240 <span class="comment">% [EOF] initGUI</span>
4241 
4242 
4243 <span class="comment">% --------------------------------------------------------------------</span>
4244 <a name="_sub99" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4245 
4246 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4247 
4248 <span class="keyword">switch</span> enable_state
4249     <span class="keyword">case</span> <span class="string">'init'</span>
4250         guiparams.gui_state = <span class="string">'init'</span>;
4251         set([handles.menuFile
4252             handles.menuOpen
4253             handles.menuOpenASCII
4254             handles.menuOpenMAT
4255             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4256         
4257         set([handles.toolbarLoadData
4258             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4259         set([handles.toolbarSaveMatFile
4260             handles.toolbarSaveBathymetry
4261             handles.toolbarSaveFigures
4262             handles.toolbarSaveExcel
4263             handles.toolbarPlottingParameters
4264             handles.toolbarProcessingParameters
4265             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4266         
4267         set([handles.DepthRangeMin
4268             handles.DepthRangeMax
4269             handles.VectorScalePlanView
4270             handles.VectorSpacingPlanview
4271             handles.SmoothingWindowSize
4272             handles.DisplayShoreline
4273             handles.AddBackground
4274             handles.PlotPlanView
4275             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4276         
4277         set([handles.HorizontalGridNodeSpacing
4278             handles.VerticalGridNodeSpacing
4279             handles.PlotShiptracks
4280             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4281         
4282         set([handles.Contour
4283             handles.VerticalExaggeration
4284             handles.VectorScaleCrossSection
4285             handles.HorizontalVectorSpacing
4286             handles.VerticalVectorSpacing
4287             handles.HorizontalSmoothingWindow
4288             handles.VerticalSmoothingWindow
4289             handles.PlotSecondaryFlowVectors
4290             handles.SecondaryFlowVectorVariable
4291             handles.IncludeVerticalVelocity
4292             handles.PlotCrossSection
4293             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4294         
4295     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4296         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4297         set([handles.menuFile
4298             handles.menuOpen
4299             handles.menuOpenASCII
4300             handles.menuOpenMAT
4301             handles.menuSaveMAT
4302             handles.menuSaveTecplot
4303             handles.menuSaveKMZFile
4304             handles.menuParameters
4305             handles.menuPlottingParameters
4306             handles.menuMetric
4307             handles.menuEnglish
4308             handles.menuBathymetryExportSettings
4309             handles.menuExportMultibeamBathymetry
4310             handles.menuKMZVerticalOffset
4311             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4312         
4313         set([handles.toolbarLoadData
4314             handles.toolbarSaveMatFile
4315             handles.toolbarSaveBathymetry
4316             handles.toolbarSaveExcel
4317             handles.toolbarSaveFigures
4318             handles.toolbarPlottingParameters
4319             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4320         set([handles.toolbarProcessingParameters
4321             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4322         
4323            
4324         set([handles.DepthRangeMin
4325             handles.DepthRangeMax
4326             handles.VectorScalePlanView
4327             handles.VectorSpacingPlanview
4328             handles.SmoothingWindowSize
4329             handles.DisplayShoreline
4330             handles.PlotPlanView
4331             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4332         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4333             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4334         <span class="keyword">else</span>
4335             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4336         <span class="keyword">end</span>
4337         
4338         set([handles.HorizontalGridNodeSpacing
4339             handles.VerticalGridNodeSpacing
4340             handles.PlotShiptracks
4341             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4342         
4343         set([handles.Contour
4344             handles.VerticalExaggeration
4345             handles.VectorScaleCrossSection
4346             handles.HorizontalVectorSpacing
4347             handles.VerticalVectorSpacing
4348             handles.HorizontalSmoothingWindow
4349             handles.VerticalSmoothingWindow
4350             handles.PlotSecondaryFlowVectors
4351             handles.SecondaryFlowVectorVariable
4352             handles.IncludeVerticalVelocity
4353             handles.PlotCrossSection
4354             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4355     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4356         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4357         set([handles.menuFile
4358             handles.menuOpen
4359             handles.menuOpenASCII
4360             handles.menuOpenMAT
4361             handles.menuParameters
4362             handles.menuPlottingParameters
4363             handles.menuMetric
4364             handles.menuEnglish
4365             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4366         set([handles.menuSaveMAT
4367             handles.menuBathymetryExportSettings
4368             handles.menuExportMultibeamBathymetry
4369             handles.menuKMZVerticalOffset
4370             handles.menuSaveKMZFile
4371             handles.menuSaveTecplot
4372             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4373         
4374         set([handles.toolbarLoadData
4375             handles.toolbarSaveFigures
4376             handles.toolbarPlottingParameters
4377             handles.toolbarSaveExcel
4378             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4379         set([handles.toolbarProcessingParameters
4380             handles.toolbarSaveMatFile
4381             handles.toolbarSaveBathymetry
4382             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4383         
4384         set([handles.DepthRangeMin
4385             handles.DepthRangeMax
4386             handles.VectorScalePlanView
4387             handles.VectorSpacingPlanview
4388             handles.SmoothingWindowSize
4389             handles.DisplayShoreline
4390             handles.PlotPlanView
4391             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4392         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4393             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4394         <span class="keyword">else</span>
4395             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4396         <span class="keyword">end</span>
4397         
4398         set([handles.HorizontalGridNodeSpacing
4399             handles.VerticalGridNodeSpacing
4400             handles.PlotShiptracks
4401             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4402         
4403         set([handles.Contour
4404             handles.VerticalExaggeration
4405             handles.VectorScaleCrossSection
4406             handles.HorizontalVectorSpacing
4407             handles.VerticalVectorSpacing
4408             handles.HorizontalSmoothingWindow
4409             handles.VerticalSmoothingWindow
4410             handles.PlotSecondaryFlowVectors
4411             handles.SecondaryFlowVectorVariable
4412             handles.IncludeVerticalVelocity
4413             handles.PlotCrossSection
4414             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4415     <span class="keyword">otherwise</span>
4416 <span class="keyword">end</span>
4417 
4418 <span class="comment">% Save Application Data</span>
4419 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4420 
4421 <span class="comment">% [EOF] set_enable</span>
4422 
4423 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4424 
4425 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4426 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4427 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4428 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4429 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4430 
4431 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4432 
4433 
4434 <span class="comment">% --------------------------------------------------------------------</span>
4435 <a name="_sub100" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4436     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4437 
4438 w = 500;
4439 h = 110;
4440 dx = 10;
4441 dy = 35;
4442 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4443 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4444     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4445     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4446     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4447     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4448     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4449     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4450     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4451     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4452     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4453     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4454 dialog_params.english_units               = english_units;
4455 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4456 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4457 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4458 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4459 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4460 
4461 <span class="comment">% Build the graphics:</span>
4462 <span class="comment">% -------------------</span>
4463 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4464     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4465     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4466     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4467 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4468     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4469     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4470     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4471     <span class="string">'Position'</span>,[15 35 100 22]);
4472 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4473     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4474     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4475     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4476     <span class="string">'Position'</span>,[15 10 100 22]);
4477 
4478 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4479     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4480     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4481     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4482 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4483     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4484     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4485     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4486     <span class="string">'Position'</span>,[15 35 100 22]);
4487 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4488     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4489     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4490     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4491     <span class="string">'Position'</span>,[15 10 100 22]);
4492 
4493 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4494     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4495     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4496     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4497 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4498     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4499     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4500     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4501     <span class="string">'Position'</span>,[15 35 100 22]);
4502 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4503     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4504     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4505     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4506     <span class="string">'Position'</span>,[15 10 100 22]);
4507 
4508 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4509     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4510     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4511     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4512     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4513 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4514     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4515     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4516     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4517     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4518 
4519 <span class="comment">% Update the UI controls:</span>
4520 <span class="comment">% -----------------------</span>
4521 <span class="keyword">if</span> dialog_params.english_units
4522     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4523     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4524 <span class="keyword">else</span>
4525     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4526     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4527 <span class="keyword">end</span>
4528 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4529     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4530     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4531 <span class="keyword">else</span>
4532     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4533     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4534 <span class="keyword">end</span>
4535 <span class="keyword">if</span> dialog_params.presentation
4536     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4537     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4538 <span class="keyword">else</span>
4539     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4540     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4541 <span class="keyword">end</span>
4542 
4543 <span class="comment">% Set the callbacks:</span>
4544 <span class="comment">% ------------------</span>
4545 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4546 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4547 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4548 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4549 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4550 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4551 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4552 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4553 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4554 
4555 <span class="comment">% Position the dialog and make it visible:</span>
4556 <span class="comment">% ----------------------------------------</span>
4557 fpos = get(hf,<span class="string">'Position'</span>);
4558 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4559 movegui(handles.Figure,dpos)
4560 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4561 
4562 <span class="comment">% Hold the dialog open:</span>
4563 <span class="comment">% ---------------------</span>
4564 waitfor(handles.OK)
4565 
4566 <span class="comment">% Return the outputs and close the dialog:</span>
4567 <span class="comment">% ----------------------------------------</span>
4568 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4569 english_units = dialog_params.english_units;
4570 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4571 plot_presentation_style =  dialog_params.presentation;
4572 plot_print_style =  dialog_params.print;
4573 
4574 delete(handles.Figure)
4575 
4576 <span class="comment">% [EOF] plotParametersDialog</span>
4577 
4578 
4579 <span class="comment">% --------------------------------------------------------------------</span>
4580 <a name="_sub101" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4581 
4582 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4583 <span class="keyword">switch</span> the_units
4584     <span class="keyword">case</span> <span class="string">'metric'</span>
4585         dialog_params.english_units = false;
4586         
4587         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4588         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4589     <span class="keyword">case</span> <span class="string">'english'</span>
4590         dialog_params.english_units = true;
4591         
4592         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4593         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4594     <span class="keyword">otherwise</span>
4595 <span class="keyword">end</span>
4596 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4597 
4598 <span class="comment">% [EOF] dialogUnits</span>
4599 
4600 <span class="comment">% --------------------------------------------------------------------</span>
4601 <a name="_sub102" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4602 
4603 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4604 <span class="keyword">switch</span> the_endpoints
4605     <span class="keyword">case</span> <span class="string">'auto'</span>
4606         dialog_params.set_cross_section_endpoints = false;
4607         
4608         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4609         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4610     <span class="keyword">case</span> <span class="string">'manual'</span>
4611         dialog_params.set_cross_section_endpoints = true;
4612         
4613         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4614         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4615     <span class="keyword">otherwise</span>
4616 <span class="keyword">end</span>
4617 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4618 
4619 <span class="comment">% [EOF] dialogEnpoints</span>
4620 
4621 <a name="_sub103" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4622 
4623 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4624 <span class="keyword">switch</span> the_style
4625     <span class="keyword">case</span> <span class="string">'presentation'</span>
4626         dialog_params.presentation  = true;
4627         dialog_params.print         = false;
4628         
4629         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4630         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4631     <span class="keyword">case</span> <span class="string">'print'</span>
4632         dialog_params.presentation  = false;
4633         dialog_params.print         = true;
4634         
4635         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4636         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4637     <span class="keyword">otherwise</span>
4638 <span class="keyword">end</span>
4639 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4640 
4641 <span class="comment">% [EOF] dialogEnpoints</span>
4642 
4643 <span class="comment">% --------------------------------------------------------------------</span>
4644 <a name="_sub104" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4645 
4646 delete(h_OK)
4647 
4648 <span class="comment">% [EOF] dialogOK</span>
4649 
4650 <span class="comment">% --------------------------------------------------------------------</span>
4651 <a name="_sub105" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4652 <span class="comment">% Return the original inputs</span>
4653 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4654 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4655 delete(handles.OK)
4656 
4657 <span class="comment">% [EOF] dialogCancel</span>
4658 
4659 <span class="comment">% --------------------------------------------------------------------</span>
4660 <a name="_sub106" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4661 
4662 delete(h_OK)
4663 
4664 <span class="comment">% [EOF] dialogCloseReq</span>
4665 
4666 <a name="_sub107" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4667     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4668 w = 230;
4669 h = 245;
4670 dx = 10;
4671 dy = 35;
4672 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4673 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4674     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4675     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4676     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4677     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4678     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4679     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4680     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4681     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4682     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4683     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4684 dialog_params.beam_angle             = beam_angle;
4685 dialog_params.magnetic_variation     = magnetic_variation;
4686 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded</span>
4687     dialog_params.wse                = <span class="string">'tide'</span>;
4688     wse_string                       = <span class="string">'tide'</span>;
4689 <span class="keyword">else</span>
4690     dialog_params.wse                = wse;
4691     wse_string                       = num2str(wse);
4692 <span class="keyword">end</span>
4693 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4694 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4695 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4696 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4697 
4698 <span class="comment">% Build the graphics:</span>
4699 <span class="comment">% -------------------</span>
4700 ph = 150;
4701 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4702     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4703     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4704     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4705 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4706     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4707     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4708     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4709     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4710     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4711     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4712 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4713     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4714     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4715     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4716     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4717     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4718     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4719 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4720     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4721     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4722     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4723     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4724     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4725     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4726 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4727     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4728     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4729     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4730     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4731     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4732     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4733 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4734     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4735     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4736     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4737     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4738     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4739     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4740 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4741     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4742     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4743     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4744     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4745     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4746     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4747 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4748     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4749     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4750     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4751     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4752 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4753     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4754     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4755     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4756     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4757 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4758     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4759     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4760     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4761     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4762 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4763     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4764     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4765     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4766     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4767 
4768 <span class="comment">% Update the UI controls:</span>
4769 <span class="comment">% -----------------------</span>
4770 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4771 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4772 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4773 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4774 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4775 
4776 <span class="comment">% Set the callbacks:</span>
4777 <span class="comment">% ------------------</span>
4778 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4779 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4780 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4781 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4782 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4783 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4784 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4785 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4786 
4787 <span class="comment">% Position the dialog and make it visible:</span>
4788 <span class="comment">% ----------------------------------------</span>
4789 fpos = get(hf,<span class="string">'Position'</span>);
4790 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4791 movegui(handles.Figure,dpos)
4792 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4793 
4794 <span class="comment">% Hold the dialog open:</span>
4795 <span class="comment">% ---------------------</span>
4796 waitfor(handles.OK)
4797 
4798 <span class="comment">% Return the outputs and close the dialog:</span>
4799 <span class="comment">% ----------------------------------------</span>
4800 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4801 beam_angle              = dialog_params.beam_angle;
4802 magnetic_variation      = dialog_params.magnetic_variation;
4803 wse                     = str2num(dialog_params.wse);
4804 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4805 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4806 
4807 delete(handles.Figure)
4808 
4809 <span class="comment">% [EOF] exportSettingsDialog</span>
4810 
4811 <span class="comment">% --------------------------------------------------------------------</span>
4812 <a name="_sub108" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4813 
4814 <span class="comment">% Grab the current data</span>
4815 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4816 
4817 <span class="comment">% Set it according to the dialog box values</span>
4818 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4819 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4820 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4821 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4822 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4823 
4824 <span class="comment">% Re-store the application data</span>
4825 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4826 
4827 <span class="comment">% [EOF] dialogExportSettings</span>
4828 
4829 <a name="_sub109" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4830 
4831 w = 230;
4832 h = 200;
4833 dx = 10;
4834 dy = 35;
4835 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4836 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4837     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4838     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4839     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4840     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4841     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4842     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4843     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4844     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4845     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4846     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4847 dialog_params.figure_names               = figure_names;
4848 dialog_params.selected_figures           = <span class="string">''</span>;
4849 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4850 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4851 
4852 <span class="comment">% Build the graphics:</span>
4853 <span class="comment">% -------------------</span>
4854 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4855     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4856     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4857     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4858 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4859     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4860     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4861     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4862     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4863     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4864     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4865     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4866 
4867 
4868 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4869     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4870     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4871     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4872     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4873 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4874     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4875     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4876     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4877     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4878 
4879 <span class="comment">% Update the UI controls:</span>
4880 <span class="comment">% -----------------------</span>
4881 
4882 
4883 <span class="comment">% Set the callbacks:</span>
4884 <span class="comment">% ------------------</span>
4885 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4886 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4887 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4888 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4889 
4890 <span class="comment">% Position the dialog and make it visible:</span>
4891 <span class="comment">% ----------------------------------------</span>
4892 fpos = get(hf,<span class="string">'Position'</span>);
4893 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4894 movegui(handles.Figure,dpos)
4895 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4896 
4897 <span class="comment">% Hold the dialog open:</span>
4898 <span class="comment">% ---------------------</span>
4899 waitfor(handles.OK)
4900 
4901 <span class="comment">% Return the outputs and close the dialog:</span>
4902 <span class="comment">% ----------------------------------------</span>
4903 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4904 selected_figures = dialog_params.selected_figures;
4905 
4906 delete(handles.Figure)
4907 
4908 <span class="comment">% [EOF] openFiguresDialog</span>
4909 
4910 <span class="comment">% --------------------------------------------------------------------</span>
4911 <a name="_sub110" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4912 
4913 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4914 
4915 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4916 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4917 selected     = fig_names(idx_selected);
4918 dialog_params.selected_figures = selected;
4919 
4920 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4921 
4922 
4923 
4924 <span class="comment">% --------------------------------------------------------------------</span>
4925 <a name="_sub111" href="#_subfunctions" class="code">function icons = getIcons</a>
4926 
4927 <span class="comment">% Load data</span>
4928 idx = 1;
4929 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4930     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4931     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4932     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4933     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4934     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4935     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4936     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4937     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4938     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4939     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4940     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4941     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4942     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4943     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4944     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4945     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4946 
4947 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4948     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4949     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4950     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4951     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4952     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4953     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4954     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4955     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4956     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4957     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4958     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4959     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4960     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4961     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4962     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4963     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4964 
4965 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4966     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4967     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4968     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4969     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4970     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4971     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4972     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4973     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4974     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4975     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4976     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4977     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4978     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4979     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4980     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4981     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4982 
4983 <span class="comment">% Save data</span>
4984 idx = idx+1;
4985 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4986     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4987     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4988     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4989     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4990     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4991     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4992     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4993     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4994     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4995     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4996     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4997     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4998     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4999     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5000     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5001     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5002 
5003 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5004     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5005     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5006     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5007     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5008     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5009     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5010     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5011     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5012     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5013     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5014     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5015     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5016     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5017     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5018     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5019     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5020 
5021 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5022     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5023     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5024     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5025     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5026     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5027     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5028     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5029     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5030     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5031     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5032     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5033     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5034     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5035     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5036     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5037     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5038 
5039 <span class="comment">% Plotting parameters</span>
5040 idx = idx+1;
5041 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5042     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5043     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5044     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5045     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5046     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5047     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5048     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5049     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5050     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5051     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5052     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5053     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5054     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5055     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5056     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5057     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5058 
5059 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5060     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5061     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5062     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5063     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5064     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5065     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5066     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5067     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5068     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5069     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5070     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5071     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5072     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5073     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5074     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5075     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5076 
5077 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5078     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5079     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5080     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5081     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5082     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5083     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5084     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5085     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5086     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5087     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5088     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5089     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5090     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5091     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5092     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5093     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5094 
5095 <span class="comment">% Processing parameters</span>
5096 idx = idx+1;
5097 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5098     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5099     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5100     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5101     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5102     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5103     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5104     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5105     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5106     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5107     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5108     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5109     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5110     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5111     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5112     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5113     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5114 
5115 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5116     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5117     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5118     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5119     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5120     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5121     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5122     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5123     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5124     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5125     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5126     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5127     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5128     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5129     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5130     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5131     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5132 
5133 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5134     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5135     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5136     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5137     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5138     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5139     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5140     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5141     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5142     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5143     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5144     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5145     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5146     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5147     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5148     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5149     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5150 
5151 <span class="comment">% Export bathymetry dialog</span>
5152 idx = idx+1;
5153 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5154     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5155     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5156     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5157     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5158     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5159     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5160     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5161     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5162     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5163     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5164     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5165     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5166     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5167     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5168     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5169     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5170     ]/255;
5171 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5172     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5173     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5174     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5175     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5176     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5177     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5178     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5179     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5180     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5181     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5182     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5183     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5184     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5185     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5186     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5187     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5188     ]/255;
5189 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5190     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5191     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5192     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5193     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5194     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5195     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5196     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5197     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5198     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5199     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5200     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5201     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5202     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5203     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5204     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5205     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5206     ]/255;
5207 
5208 <span class="comment">% Export Figures Dialog</span>
5209 idx = idx + 1;
5210 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5211     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5212     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5213     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5214     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5215     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5216     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5217     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5218     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5219     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5220     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5221     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5222     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5223     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5224     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5225     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5226 
5227 
5228 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5229     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5230     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5231     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5232     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5233     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5234     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5235     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5236     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5237     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5238     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5239     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5240     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5241     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5242     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5243     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5244 
5245 
5246 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5247     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5248     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5249     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5250     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5251     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5252     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5253     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5254     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5255     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5256     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5257     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5258     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5259     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5260     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5261     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5262 
5263 <span class="comment">% Export Excel File</span>
5264 idx = idx + 1;
5265 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5266     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5267    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5268    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5269    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5270    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5271    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5272    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5273    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5274    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5275    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5276    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5277    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5278    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5279    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5280    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5281     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5282 
5283 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5284     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5285    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5286    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5287    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5288    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5289    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5290    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5291    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5292    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5293    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5294    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5295    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5296    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5297    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5298    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5299     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5300 
5301 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5302     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5303    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5304    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5305    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5306    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5307    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5308    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5309    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5310    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5311    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5312    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5313    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5314    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5315    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5316    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5317     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5318 
5319 <span class="comment">% Zoom In</span>
5320 idx = idx + 1;
5321 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5322     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5323 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5324     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5325 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5326     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5327 
5328 <span class="comment">% Zoom Out</span>
5329 idx = idx + 1;
5330 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5331     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5332 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5333     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5334 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5335     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5336 
5337 <span class="comment">% Pan</span>
5338 idx = idx + 1;
5339 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5340     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5341 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5342     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5343 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5344     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5345 <span class="comment">% [EOF] getIcons</span>
5346 
5347 <a name="_sub112" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5348 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5349 
5350 <span class="comment">% Check for any stored prefs</span>
5351 <span class="comment">% --------------------------</span>
5352 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5353 guiprefs = getpref(<span class="string">'VMT'</span>);
5354 
5355 <span class="comment">% Organized by GUI panels</span>
5356 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5357 <span class="comment">% SHIPTRACKS PLOT %</span>
5358 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5359 guiparams.horizontal_grid_node_spacing       = 1.0;
5360 guiparams.vertical_grid_node_spacing         = 0.4;
5361 
5362 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5363 <span class="comment">% CROSS SECTION PLOT %</span>
5364 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5365 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5366 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5367 guiparams.idx_contour                        = 1;
5368 guiparams.vertical_exaggeration              = 10;
5369 guiparams.vector_scale_cross_section         = 0.2;
5370 guiparams.horizontal_vector_spacing          = 1;
5371 guiparams.vertical_vector_spacing            = 1;
5372 guiparams.horizontal_smoothing_window        = 1;
5373 guiparams.vertical_smoothing_window          = 1;
5374 guiparams.plot_secondary_flow_vectors        = true;
5375 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5376 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5377 guiparams.idx_secondary_flow_vector_variable = 1;
5378 guiparams.include_vertical_velocity          = true;
5379 
5380 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5381 <span class="comment">% PLAN VIEW PLOT %</span>
5382 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5383 guiparams.depth_range_min                    = 0;
5384 guiparams.depth_range_max                    = inf;
5385 guiparams.vector_scale_plan_view             = 1;
5386 guiparams.vector_spacing_plan_view           = 1;
5387 guiparams.smoothing_window_size              = 1;
5388 guiparams.display_shoreline                  = false;
5389 guiparams.add_background                     = false;
5390 
5391 <span class="comment">%%%%%%%%%%%%%%%</span>
5392 <span class="comment">% DATA EXPORT %</span>
5393 <span class="comment">%%%%%%%%%%%%%%%</span>
5394 guiparams.beam_angle                         = 20.0;
5395 guiparams.magnetic_variation                 = 0.0;
5396 guiparams.wse                                = 0.0;
5397 guiparams.load_wse_tide_file                 = false;
5398 guiparams.output_auxiliary_data              = false;
5399 
5400 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5401 <span class="comment">% Contour variables %</span>
5402 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5403 idx = 1;
5404 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5405 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5406 idx = idx + 1;
5407 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5408 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5409 idx = idx + 1;
5410 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5411 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5412 idx = idx + 1;
5413 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5414 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5415 idx = idx + 1;
5416 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5417 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5418 idx = idx + 1;
5419 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5420 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5421 idx = idx + 1;
5422 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5423 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5424 idx = idx + 1;
5425 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5426 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5427 idx = idx + 1;
5428 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5429 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5430 idx = idx + 1;
5431 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5432 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5433 idx = idx + 1;
5434 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5435 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5436 idx = idx + 1;
5437 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5438 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5439 idx = idx + 1;
5440 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5441 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5442 idx = idx + 1;
5443 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5444 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5445 idx = idx + 1;
5446 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5447 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5448 idx = idx + 1;
5449 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5450 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5451 idx = idx + 1;
5452 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5453 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5454 idx = idx + 1;
5455 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5456 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5457 idx = idx + 1;
5458 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5459 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5460 idx = idx + 1;
5461 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5462 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5463 
5464 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5465 
5466 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5467 <span class="comment">% Secondary Flow Vector Variables %</span>
5468 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5469 idx = 1;
5470 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5471 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5472 idx = idx + 1;
5473 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5474 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5475 idx = idx + 1;
5476 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5477 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5478 idx = idx + 1;
5479 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5480 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5481 idx = idx + 1;
5482 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5483 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5484 
5485 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5486     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5487 
5488 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5489 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5490 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5491 <span class="comment">% Menu bar options</span>
5492 guiparams.presentation                       = true;
5493 guiparams.print                              = false;
5494 guiparams.set_cross_section_endpoints        = false;
5495 guiparams.unit_discharge_correction          = false;
5496 
5497 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5498     <span class="keyword">switch</span> guiprefs.units
5499         <span class="keyword">case</span> <span class="string">'metric'</span>
5500             guiparams.english_units          = false;
5501         <span class="keyword">case</span> <span class="string">'english'</span>
5502             guiparams.english_units          = true;
5503     <span class="keyword">end</span>
5504 <span class="keyword">else</span>
5505     guiparams.english_units                  = false;
5506 <span class="keyword">end</span>
5507 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5508     <span class="keyword">switch</span> guiprefs.plotref
5509         <span class="keyword">case</span> <span class="string">'dfs'</span>
5510             guiparams.plotref                 = <span class="string">'dfs'</span>;
5511         <span class="keyword">case</span> <span class="string">'hab'</span>
5512             guiparams.plotref                 = <span class="string">'hab'</span>;
5513     <span class="keyword">end</span>
5514 <span class="keyword">else</span>
5515     guiparams.plotref                         = <span class="string">'dfs'</span>;
5516 <span class="keyword">end</span>
5517 guiparams.eta                                 = 100; <span class="comment">% Used in HAB reference</span>
5518 guiparams.vertical_offset                     = 0;
5519 
5520 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5521     guiparams.renderer                       = guiprefs.renderer;
5522 <span class="keyword">else</span>
5523     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5524 <span class="keyword">end</span>
5525 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5526 <span class="comment">% guiparams.plot_planview                      = false;</span>
5527 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5528 
5529 <span class="comment">% File location defaults</span>
5530 guiparams.ascii_path                        = pwd;
5531 guiparams.ascii_file                        = <span class="string">''</span>;
5532 guiparams.mat_path                          = pwd;
5533 guiparams.mat_file                          = <span class="string">''</span>;
5534 guiparams.tecplot_path                      = pwd;
5535 guiparams.tecplot_file                      = <span class="string">''</span>;
5536 guiparams.kmz_path                          = pwd;
5537 guiparams.kmz_file                          = <span class="string">''</span>;
5538 guiparams.multibeambathymetry_path          = pwd;
5539 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5540 guiparams.log_path                          = pwd;
5541 guiparams.log_file                          = <span class="string">''</span>;
5542 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5543 <span class="comment">% application</span>
5544 <span class="keyword">if</span> isdeployed 
5545     guiparams.has_mapping_toolbox           = true;
5546 <span class="keyword">else</span>
5547     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5548         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5549 <span class="keyword">end</span>
5550 
5551 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5552 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5553 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5554 guiparams.z                      = [];
5555 guiparams.A                      = [];
5556 guiparams.V                      = [];
5557 guiparams.Map                    = [];
5558 guiparams.savefile               = [];
5559 guiparams.iric_anv_planview_data = [];
5560 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5561 <span class="comment">% guiparams.zmax = [];</span>
5562 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5563 guiparams.data_folder = <span class="string">''</span>;
5564 guiparams.data_files  = {<span class="string">''</span>};
5565 guiparams.gui_state   = <span class="string">'init'</span>;
5566 
5567 <span class="comment">% [EOF] createGUIparams</span>
5568 
5569 <a name="_sub113" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5570 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5571 
5572 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5573 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5574 
5575 <span class="comment">% [EOF] VMT</span>
5576 
5577 
5578 
5579 
5580 
5581 <span class="comment">% --- Hidden keyboard commands</span>
5582 <a name="_sub115" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5583 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5584 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5585 <span class="comment">%</span>
5586 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5587 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5588 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5589 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5590 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5591 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5592 
5593 in1 = eventdata.Modifier; 
5594 in2 = eventdata.Key;
5595 
5596 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5597     input = [in1{:} in2];
5598 <span class="keyword">else</span>
5599     input = in2;
5600 <span class="keyword">end</span>
5601 
5602 <span class="keyword">switch</span> input
5603     <span class="comment">% Hidden SonTek M9 support</span>
5604     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5605         msgtxt = {<span class="keyword">...</span>
5606             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5607             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5608             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5609             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5610             <span class="string">''</span>;<span class="keyword">...</span>
5611             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5612             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5613             <span class="string">'PROVISIONAL at best.'</span>};
5614         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5615         
5616         <span class="comment">% Get the Application data:</span>
5617         <span class="comment">% -------------------------</span>
5618         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5619         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5620         
5621         <span class="comment">% Ask the user to select files:</span>
5622         <span class="comment">% -----------------------------</span>
5623         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5624         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5625         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5626             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5627         <span class="keyword">else</span>
5628             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5629         <span class="keyword">end</span>
5630         [filename,pathname] = <span class="keyword">...</span>
5631             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5632             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5633             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5634         
5635         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5636             guiparams.data_folder = pathname;
5637             <span class="keyword">if</span> ischar(filename)
5638                 filename = {filename};
5639             <span class="keyword">end</span>
5640             guiparams.data_files = filename;
5641             guiparams.mat_file = <span class="string">''</span>;
5642             
5643             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5644             
5645             
5646             
5647             <span class="comment">% Update the preferences:</span>
5648             <span class="comment">% -----------------------</span>
5649             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5650             guiprefs.ascii_path = pathname;
5651             guiprefs.ascii_file = filename;
5652             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5653             <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5654             
5655             <span class="comment">% Push messages to Log Window:</span>
5656             <span class="comment">% ----------------------------</span>
5657             log_text = {<span class="keyword">...</span>
5658                 <span class="string">''</span>;<span class="keyword">...</span>
5659                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5660                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5661                 guiparams.data_folder;
5662                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5663                 char(filename)};
5664             statusLogging(handles.LogWindow, log_text)
5665             
5666             <span class="comment">% Read the file(s)</span>
5667             <span class="comment">% ----------------</span>
5668             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5669             
5670             [~,~,savefile,A,z] = <span class="keyword">...</span>
5671                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5672             guiparams.savefile = savefile;
5673             guiparams.A        = A;
5674             guiparams.z        = z;
5675             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5676             
5677             
5678             <span class="comment">% Update the GUI:</span>
5679             <span class="comment">% ---------------</span>
5680             <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5681         <span class="keyword">end</span>  
5682     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5683         SontekMAT2KML;
5684     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5685         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5686         
5687     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5688         VMT_BuildCustomFlatFile;
5689     <span class="keyword">otherwise</span>
5690         <span class="comment">%disp(input)</span>
5691 <span class="keyword">end</span>
5692 
5693</pre></div>
<hr><address>Generated on Wed 03-Jun-2015 15:32:57 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>