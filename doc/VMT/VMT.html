<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub25" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub96" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub97" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub98" class="code">function initGUI(handles)</a></li><li><a href="#_sub99" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub100" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub101" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub102" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub103" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub104" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub106" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub108" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub110" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function icons = getIcons</a></li><li><a href="#_sub112" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub113" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub114" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 <span class="comment">% Adress 2015b java bug #1293244</span>
0034 javax.swing.UIManager.setLookAndFeel(<span class="string">'com.sun.java.swing.plaf.windows.WindowsLookAndFeel'</span>)
0035 gui_Singleton = 1;
0036 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0037     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0038     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0039     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0040     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0041     <span class="string">'gui_Callback'</span>,   []);
0042 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0043     gui_State.gui_Callback = str2func(varargin{1});
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0047 <span class="keyword">try</span>
0048 <span class="keyword">if</span> nargout
0049     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">else</span>
0051     gui_mainfcn(gui_State, varargin{:});
0052 <span class="keyword">end</span>
0053 
0054 <span class="keyword">catch</span> err
0055     <span class="keyword">if</span> isdeployed
0056         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0057             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0058         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0059             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0060             errLogFileName},<span class="keyword">...</span>
0061             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0062             <span class="string">'error'</span>);
0063         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0064         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0065         fclose(fid);
0066         rethrow(err)
0067     <span class="keyword">else</span>
0068         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0069             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0070             <span class="string">'error'</span>);
0071         rethrow(err);
0072     <span class="keyword">end</span>
0073 <span class="keyword">end</span>
0074 <span class="comment">% End initialization code - DO NOT EDIT</span>
0075 
0076 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0077 
0078 <span class="comment">% --- Executes just before VMT is made visible.</span>
0079 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0080 <span class="comment">% This function has no output args, see OutputFcn.</span>
0081 <span class="comment">% hObject    handle to figure</span>
0082 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0083 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0084 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0085 
0086 <span class="comment">% Choose default command line output for VMT</span>
0087 handles.output = hObject;
0088 
0089 <span class="comment">% Build the GUI toolbar:</span>
0090 <span class="comment">% ----------------------</span>
0091 handles = <a href="#_sub95" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0092 
0093 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0094 <span class="comment">% ----------------------------------------</span>
0095 <span class="keyword">if</span> ~isdeployed
0096     utilspath = [pwd filesep <span class="string">'utils'</span>];
0097     docspath  = [pwd filesep <span class="string">'doc'</span>];
0098     toolspath = [pwd filesep <span class="string">'tools'</span>];
0099     addpath(utilspath,docspath,toolspath)
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">% Update handles structure</span>
0103 <span class="comment">% ------------------------</span>
0104 guidata(hObject, handles);
0105 
0106 <span class="comment">% Load the GUI preferences:</span>
0107 <span class="comment">% -------------------------</span>
0108 <a href="#_sub96" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0109 
0110 <span class="comment">% Initialize the GUI parameters:</span>
0111 <span class="comment">% ------------------------------</span>
0112 guiparams = <a href="#_sub112" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0113 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20170426'</span>};
0114 
0115 <span class="comment">% Draw the VMT Background</span>
0116 <span class="comment">% -----------------</span>
0117 pos = get(handles.figure1,<span class="string">'position'</span>);
0118 axes(handles.VMTBackground);
0119 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0120     X = imread(<span class="string">'VMT_Background.png'</span>);
0121     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0122 <span class="comment">% else</span>
0123 <span class="comment">%     X = imread('VMT_Background.png');</span>
0124 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0125 <span class="comment">%     X = uint8(X);</span>
0126 <span class="comment">%     imshow(X,'Border','tight')</span>
0127 <span class="comment">% end</span>
0128 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0129 
0130 <span class="comment">% Store the application data:</span>
0131 <span class="comment">% ---------------------------</span>
0132 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0133 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0134 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0135 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0136 
0137 <span class="comment">% Auto-check for updates</span>
0138 <span class="comment">% ----------------------</span>
0139 thres = 20; 
0140 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0141 time_to_check = (mod(runcounter,thres)==0);
0142 <span class="keyword">if</span> time_to_check
0143     <a href="#_sub54" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0144 <span class="keyword">end</span>
0145 
0146 <span class="comment">% Initialize the GUI:</span>
0147 <span class="comment">% -------------------</span>
0148 <a href="#_sub98" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0149 <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0150 
0151 <span class="comment">% Allow VMT GUI to be resized depending on the screen resolution</span>
0152 <span class="comment">% set(0,'units','pixels')</span>
0153 <span class="comment">% Pix_SS = get(0,'screensize');</span>
0154 <span class="comment">% movegui(handles.figure1,'center')</span>
0155 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0156 
0157 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0158 <span class="comment">% the root</span>
0159 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0160 
0161 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0162 <span class="comment">% uiwait(handles.figure1);</span>
0163 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0164 
0165 
0166 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0167 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0168 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0169 <span class="comment">% hObject    handle to figure</span>
0170 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0171 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0172 
0173 <span class="comment">% Get default command line output from handles structure</span>
0174 varargout{1} = handles.output;
0175 <span class="comment">% [EOF] VMT_OutputFcn</span>
0176 
0177 <span class="comment">% --- Executes when figure1 is resized.</span>
0178 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0179 
0180 <span class="comment">% Draw the VMT Background</span>
0181 <span class="comment">% -----------------</span>
0182 pos = get(handles.figure1,<span class="string">'position'</span>);
0183 axes(handles.VMTBackground);
0184 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0185     X = imread(<span class="string">'VMT_Background.png'</span>);
0186     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0187 <span class="comment">% else</span>
0188 <span class="comment">%     X = imread('VMT_Background.png');</span>
0189 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0190 <span class="comment">%     X = uint8(X);</span>
0191 <span class="comment">%     imshow(X,'Border','tight')</span>
0192 <span class="comment">% end</span>
0193 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0194 
0195 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0196 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0197 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0198 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0199 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0200 
0201 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0202 who_called = get(hObject,<span class="string">'tag'</span>);
0203 close_button = questdlg(<span class="keyword">...</span>
0204     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0205     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0206 <span class="keyword">switch</span> close_button
0207     <span class="keyword">case</span> <span class="string">'Yes'</span>
0208         closereq
0209         close all hidden
0210     <span class="keyword">otherwise</span>
0211         <span class="keyword">return</span>
0212 <span class="keyword">end</span>
0213 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0214 
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 <span class="comment">% MENU BAR CALLBACKS %</span>
0217 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0221 <span class="comment">% Empty</span>
0222 
0223 <span class="comment">% --------------------------------------------------------------------</span>
0224 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0225 <span class="comment">% Empty</span>
0226 
0227 <span class="comment">% --------------------------------------------------------------------</span>
0228 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0229 <a href="#_sub56" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0230 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0231 
0232 <span class="comment">% --------------------------------------------------------------------</span>
0233 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a>
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0254     guiparams.data_folder = pathname;
0255     <span class="keyword">if</span> ischar(filename)
0256         filename = {filename};
0257     <span class="keyword">end</span>
0258     guiparams.data_files = filename;
0259     guiparams.mat_file = <span class="string">''</span>;
0260     
0261     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0262     
0263     
0264     
0265     <span class="comment">% Update the preferences:</span>
0266     <span class="comment">% -----------------------</span>
0267     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0268     guiprefs.ascii_path = pathname;
0269     guiprefs.ascii_file = filename;
0270     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0271     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
0272     
0273     <span class="comment">% Push messages to Log Window:</span>
0274     <span class="comment">% ----------------------------</span>
0275     log_text = {<span class="keyword">...</span>
0276         <span class="string">''</span>;<span class="keyword">...</span>
0277         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
0278         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
0279         guiparams.data_folder;
0280         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
0281         char(filename)};
0282     statusLogging(handles.LogWindow, log_text)
0283     
0284     <span class="comment">% Read the file(s)</span>
0285     <span class="comment">% ----------------</span>
0286     <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
0287     
0288     [~,~,savefile,A,z] = <span class="keyword">...</span>
0289         <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
0290     guiparams.savefile = savefile;
0291     guiparams.A        = A;
0292     guiparams.z        = z;
0293     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0294     
0295     
0296     <span class="comment">% Update the GUI:</span>
0297     <span class="comment">% ---------------</span>
0298     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0299 <span class="keyword">end</span>
0300 <span class="comment">% [EOF] menuOpenSonTekMAT_Callback</span>
0301 
0302 <span class="comment">% --------------------------------------------------------------------</span>
0303 <a name="_sub9" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0304 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
0305 <span class="comment">% Get the Application data:</span>
0306 <span class="comment">% -------------------------</span>
0307 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0308 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0309 
0310 <span class="comment">% Ask the user to select files:</span>
0311 <span class="comment">% -----------------------------</span>
0312 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0313 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0314 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0315     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0316 <span class="keyword">else</span>
0317     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0318 <span class="keyword">end</span>
0319 [filename,pathname] = <span class="keyword">...</span>
0320     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0321     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0322     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0323 
0324 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0325     temp_filename = filename;
0326 <span class="keyword">elseif</span> iscell(filename)
0327     temp_filename = filename{1};
0328 <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0329     errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0330         <span class="string">'Invalid File...'</span>)
0331 <span class="keyword">end</span>
0332     
0333 <span class="comment">% Load the data:</span>
0334 <span class="comment">% --------------</span>
0335 vars = load(fullfile(pathname,temp_filename)); <span class="comment">%Use first file to get the HGNS and VGNS</span>
0336 
0337 <span class="comment">% Make sure the selected file is a valid file:</span>
0338 <span class="comment">% --------------------------------------------</span>
0339 varnames = fieldnames(vars);
0340 <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0341     guiparams.mat_path = pathname;
0342     guiparams.mat_file = temp_filename;
0343     guiparams.z = vars.z;
0344     guiparams.A = vars.A;
0345     guiparams.V = vars.V;
0346 
0347     <span class="comment">% Update the preferences:</span>
0348     <span class="comment">% -----------------------</span>
0349     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0350     guiprefs.mat_path = pathname;
0351     guiprefs.mat_file = temp_filename;
0352     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0353     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0354 
0355     <span class="comment">% Re-store the Application Data:</span>
0356     <span class="comment">% ------------------------------</span>
0357     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0358 
0359     <span class="comment">% Update the GUI:</span>
0360     <span class="comment">% ---------------</span>
0361     set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0362     guiparams.horizontal_grid_node_spacing = vars.A(1).hgns;
0363     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0364 <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0365     errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0366         <span class="string">'Invalid File...'</span>)
0367 <span class="keyword">end</span>
0368 
0369 <span class="comment">% Set the vertical grid node spacing</span>
0370 <span class="comment">% ----------------------------------</span>
0371 <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0372 <span class="comment">% Backwards compatible</span>
0373 <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0374     set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0375     guiparams.vertical_grid_node_spacing = double(vars.A(1).Sup.binSize_cm(1))/100;
0376 <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0377     set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0378     guiparams.vertical_grid_node_spacing = 0.4;
0379 <span class="keyword">end</span>
0380 
0381 <span class="comment">% Update the Application Data:</span>
0382 <span class="comment">% ------------------------------</span>
0383 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0384     
0385 <span class="keyword">if</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0386     <span class="comment">% Set the filenames</span>
0387     <span class="comment">% -----------------</span>
0388     guiparams.mat_path = pathname;
0389     guiparams.mat_file = filename;
0390     
0391     <span class="comment">% Push status to log window</span>
0392     <span class="comment">% -------------------------</span>
0393     log_text = {<span class="keyword">...</span>
0394         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0395         <span class="string">'Directory:'</span>};
0396     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0397     statusLogging(handles.LogWindow,log_text)
0398     
0399     <span class="comment">% Update the Application Data:</span>
0400     <span class="comment">% ------------------------------</span>
0401     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0402     
0403     <span class="comment">% Update the persistent preferences:</span>
0404     <span class="comment">% ----------------------------------</span>
0405     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0406     guiprefs.mat_path = pathname;
0407     guiprefs.mat_file = filename;
0408     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0409     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0410         
0411     <span class="comment">% Update the GUI:</span>
0412     <span class="comment">% ---------------</span>
0413     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0414 <span class="keyword">end</span>
0415 
0416 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0417 
0418 <span class="comment">% --------------------------------------------------------------------</span>
0419 <a name="_sub10" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0420 <span class="comment">% Empty</span>
0421 
0422 <span class="comment">% --------------------------------------------------------------------</span>
0423 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0424 <a href="#_sub57" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0425 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0426 
0427 <span class="comment">% --------------------------------------------------------------------</span>
0428 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0429 <a href="#_sub65" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0430 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0431 
0432 <span class="comment">% --------------------------------------------------------------------</span>
0433 <a name="_sub13" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0434 <a href="#_sub66" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0435 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0436 
0437 <span class="comment">% --------------------------------------------------------------------</span>
0438 <a name="_sub14" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0439 <span class="comment">% Empty</span>
0440 
0441 <span class="comment">% --------------------------------------------------------------------</span>
0442 <a name="_sub15" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0443 <span class="comment">% Empty</span>
0444 
0445 <span class="comment">% --------------------------------------------------------------------</span>
0446 <a name="_sub16" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0447 
0448 <span class="comment">% Get the Application Data:</span>
0449 <span class="comment">% -------------------------</span>
0450 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0451 
0452 <span class="comment">% Update the Application Data:</span>
0453 <span class="comment">% ----------------------------</span>
0454 guiparams.print        = true;
0455 guiparams.presentation = false;
0456 
0457 <span class="comment">% Re-store the Application data:</span>
0458 <span class="comment">% ------------------------------</span>
0459 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0460 
0461 <span class="comment">% Update the GUI:</span>
0462 <span class="comment">% ---------------</span>
0463 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0464 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0465 
0466 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0467 
0468 
0469 <span class="comment">% --------------------------------------------------------------------</span>
0470 <a name="_sub17" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0471 
0472 <span class="comment">% Get the Application Data:</span>
0473 <span class="comment">% -------------------------</span>
0474 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0475 
0476 <span class="comment">% Update the Application Data:</span>
0477 <span class="comment">% ----------------------------</span>
0478 guiparams.print        = false;
0479 guiparams.presentation = true;
0480 
0481 <span class="comment">% Re-store the Application data:</span>
0482 <span class="comment">% ------------------------------</span>
0483 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0484 
0485 <span class="comment">% Update the GUI:</span>
0486 <span class="comment">% ---------------</span>
0487 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0488 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0489 
0490 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0491 
0492 <span class="comment">% --------------------------------------------------------------------</span>
0493 <a name="_sub18" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0494 <span class="comment">%  --- Empty ---</span>
0495 
0496 <span class="comment">% --------------------------------------------------------------------</span>
0497 <a name="_sub19" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0498 <span class="comment">% Get the Application Data:</span>
0499 <span class="comment">% -------------------------</span>
0500 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0501 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0502 
0503 <span class="comment">% Update the Application Data:</span>
0504 <span class="comment">% ----------------------------</span>
0505 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0506 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0507 
0508 <span class="comment">% Re-store the Application data:</span>
0509 <span class="comment">% ------------------------------</span>
0510 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0511 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0512 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0513 
0514 <span class="comment">% Update the GUI:</span>
0515 <span class="comment">% ---------------</span>
0516 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0517 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0518 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0519 
0520 <span class="comment">% Modify the existing figures</span>
0521 <span class="comment">% ---------------------------</span>
0522 <span class="comment">% Find what plots exist already</span>
0523 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0524 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0525 
0526 <span class="comment">% Loop through valid figures and adjust</span>
0527 <span class="comment">% -------------------------------------</span>
0528 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0529     <span class="keyword">for</span> i = 1:length(valid_names)
0530         <span class="comment">% Focus the figure</span>
0531         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0532         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0533             figure(hff)
0534             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0535         <span class="keyword">end</span>
0536         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0537         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0538             figure(hff)
0539             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0540         <span class="keyword">end</span>
0541     <span class="keyword">end</span>
0542 <span class="keyword">end</span>
0543 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0544 
0545 
0546 <span class="comment">% --------------------------------------------------------------------</span>
0547 <a name="_sub20" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0548 <span class="comment">% Get the Application Data:</span>
0549 <span class="comment">% -------------------------</span>
0550 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0551 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0552 
0553 <span class="comment">% Update the Application Data:</span>
0554 <span class="comment">% ----------------------------</span>
0555 guiparams.renderer  = <span class="string">'painters'</span>;
0556 guiprefs.renderer   = <span class="string">'painters'</span>;
0557 
0558 <span class="comment">% Re-store the Application data:</span>
0559 <span class="comment">% ------------------------------</span>
0560 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0561 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0562 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0563 
0564 <span class="comment">% Update the GUI:</span>
0565 <span class="comment">% ---------------</span>
0566 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0567 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0568 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0569 
0570 <span class="comment">% Modify the existing figures</span>
0571 <span class="comment">% ---------------------------</span>
0572 <span class="comment">% Find what plots exist already</span>
0573 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0574 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0575 
0576 <span class="comment">% Loop through valid figures and adjust</span>
0577 <span class="comment">% -------------------------------------</span>
0578 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0579     <span class="keyword">for</span> i = 1:length(valid_names)
0580         <span class="comment">% Focus the figure</span>
0581         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0582         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0583             figure(hff)
0584             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0585         <span class="keyword">end</span>
0586         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0587         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0588             figure(hff)
0589             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0590         <span class="keyword">end</span>
0591     <span class="keyword">end</span>
0592 <span class="keyword">end</span>
0593 <span class="comment">% [EOF] menuPainters_Callback</span>
0594 
0595 <span class="comment">% --------------------------------------------------------------------</span>
0596 <a name="_sub21" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0597 <span class="comment">% Get the Application Data:</span>
0598 <span class="comment">% -------------------------</span>
0599 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0600 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0601 
0602 <span class="comment">% Update the Application Data:</span>
0603 <span class="comment">% ----------------------------</span>
0604 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0605 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0606 
0607 <span class="comment">% Re-store the Application data:</span>
0608 <span class="comment">% ------------------------------</span>
0609 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0610 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0611 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0612 
0613 <span class="comment">% Update the GUI:</span>
0614 <span class="comment">% ---------------</span>
0615 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0616 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0617 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0618 
0619 <span class="comment">% Modify the existing figures</span>
0620 <span class="comment">% ---------------------------</span>
0621 <span class="comment">% Find what plots exist already</span>
0622 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0623 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0624 
0625 <span class="comment">% Loop through valid figures and adjust</span>
0626 <span class="comment">% -------------------------------------</span>
0627 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0628     <span class="keyword">for</span> i = 1:length(valid_names)
0629         <span class="comment">% Focus the figure</span>
0630         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0631         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0632             figure(hff)
0633             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0634         <span class="keyword">end</span>
0635         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0636         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0637             figure(hff)
0638             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0639         <span class="keyword">end</span>
0640     <span class="keyword">end</span>
0641 <span class="keyword">end</span>
0642 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0643 
0644 <span class="comment">% --------------------------------------------------------------------</span>
0645 <a name="_sub22" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0646 <span class="comment">% Get the Application data:</span>
0647 <span class="comment">% -------------------------</span>
0648 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0649 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0650 
0651 <span class="comment">% Find what plots exist already</span>
0652 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0653 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0654 
0655 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0656 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0657 <span class="keyword">if</span> ~isempty(idx)
0658     fig_names(idx) = [];
0659 <span class="keyword">end</span>
0660 
0661 <span class="keyword">if</span> guiparams.presentation
0662     figure_style = <span class="string">'presentation'</span>;
0663 <span class="keyword">else</span>
0664     figure_style = <span class="string">'print'</span>;
0665 <span class="keyword">end</span>
0666 
0667 [selected_figures] = <a href="#_sub109" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0668 
0669 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0670     <span class="keyword">return</span>
0671 <span class="keyword">else</span>
0672     <span class="keyword">for</span> i = 1:length(selected_figures)
0673         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0674     <span class="keyword">end</span>
0675 <span class="keyword">end</span>
0676 
0677 
0678 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0679 
0680 <span class="comment">% --------------------------------------------------------------------</span>
0681 <a name="_sub23" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0682 <span class="comment">% Get the Application data:</span>
0683 <span class="comment">% -------------------------</span>
0684 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0685 beam_angle             = guiparams.beam_angle; 
0686 magnetic_variation     = guiparams.magnetic_variation; 
0687 wse                    = guiparams.water_surface_elevation;
0688 output_auxiliary_data  = guiparams.output_auxiliary_data;
0689 load_wse_tide_file     = guiparams.load_wse_tide_file;
0690 
0691 <span class="comment">% Open dialog and allow user to select settings</span>
0692 <span class="comment">% ---------------------------------------------</span>
0693 [beam_angle,<span class="keyword">...</span>
0694     magnetic_variation,<span class="keyword">...</span>
0695     wse,<span class="keyword">...</span>
0696     output_auxiliary_data,<span class="keyword">...</span>
0697     load_wse_tide_file] = <span class="keyword">...</span>
0698     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0699 
0700 <span class="comment">% Re-store the Application data:</span>
0701 <span class="comment">% ------------------------------</span>
0702 guiparams.beam_angle            = beam_angle;
0703 guiparams.magnetic_variation    = magnetic_variation; 
0704 guiparams.load_wse_tide_file    = load_wse_tide_file;
0705 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0706       infile = fullfile(<span class="keyword">...</span>
0707         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0708         guiparams.multibeambathymetry_file);
0709     [wsedata] = <a href="#_sub24" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0710     guiparams.water_surface_elevation = wsedata;
0711 <span class="keyword">else</span>
0712       guiparams.water_surface_elevation = wse;
0713 <span class="keyword">end</span>
0714 guiparams.output_auxiliary_data = output_auxiliary_data;
0715 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0716 
0717 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0718 
0719 <span class="comment">% --------------------------------------------------------------------</span>
0720 <a name="_sub24" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0721 <span class="comment">% wsedata.obstime</span>
0722 <span class="comment">% wsedata.elev</span>
0723 
0724 <span class="comment">% Determine Files to Process</span>
0725 <span class="comment">% Ask the user to select files:</span>
0726 <span class="comment">% -----------------------------</span>
0727 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0728     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0729     infile, <span class="keyword">...</span>
0730     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0731 
0732 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0733     data = csvread(fullfile(zPathName,zFileName));
0734     wsedata.obstime = datenum(data(:,1:6));
0735     wsedata.elev    = data(:,7);
0736 <span class="keyword">else</span>
0737     wsedata.obstime = [];
0738     wsedata.elev    = [];
0739     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0740 <span class="keyword">end</span>
0741 <span class="comment">%  [EOF] loadTideFile</span>
0742 
0743 <span class="comment">% --------------------------------------------------------------------</span>
0744 <a name="_sub25" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0745 <a href="#_sub67" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0746 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0747 
0748 
0749 <span class="comment">% --------------------------------------------------------------------</span>
0750 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0751 
0752 <span class="comment">% Get the Application Data:</span>
0753 <span class="comment">% -------------------------</span>
0754 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0755 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0756 PVdata    = guiparams.iric_anv_planview_data;
0757 iric_path = guiprefs.iric_path;
0758 iric_file = guiprefs.iric_file;
0759 
0760 <span class="comment">% Is there any planview data?</span>
0761 <span class="keyword">if</span> isempty(PVdata)
0762     <span class="comment">% Nothing to do, warn user</span>
0763     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0764     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0765 <span class="keyword">else</span>
0766     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0767     <span class="comment">% and smoothing (for iRiC)</span>
0768     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0769     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0770         fullfile(iric_path,iric_file));
0771     
0772     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0773         outfile = fullfile(iric_path,iric_file);
0774         log_text = vertcat(log_text,{outfile});
0775         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0776         outcount = fprintf(ofid,<span class="keyword">...</span>
0777             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0778         fclose(ofid);
0779     <span class="keyword">else</span>
0780         <span class="comment">% Return default iric_path and iric_file</span>
0781         iric_path = guiprefs.iric_path;
0782         iric_file = guiprefs.iric_file;
0783     <span class="keyword">end</span>
0784 <span class="keyword">end</span>
0785 
0786 <span class="comment">% Push messages to Log Window:</span>
0787 <span class="comment">% ----------------------------</span>
0788 statusLogging(handles.LogWindow, log_text)
0789 
0790 <span class="comment">% Store the persistent preferences:</span>
0791 <span class="comment">% ---------------------------------</span>
0792 guiprefs.iric_file = iric_file;
0793 guiprefs.iric_path = iric_path;
0794 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0795 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0796 
0797 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0798 
0799 <span class="comment">% --------------------------------------------------------------------</span>
0800 <a name="_sub27" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0801 <span class="comment">% Get the Application Data:</span>
0802 <span class="comment">% -------------------------</span>
0803 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0804 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0805 excel_path  = guiprefs.excel_path;
0806 excel_file  = guiprefs.excel_file;
0807 
0808 <span class="comment">% Push messages to Log Window:</span>
0809 <span class="comment">% ----------------------------</span>
0810 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0811 statusLogging(handles.LogWindow, log_text)
0812 
0813 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0814 <span class="comment">% data.</span>
0815 <span class="keyword">if</span> iscell(guiparams.mat_file)
0816     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0817     <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0818     <span class="comment">% Refresh the Application Data:</span>
0819     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0820     z           = guiparams.z;
0821     A           = guiparams.A;
0822     V           = guiparams.V;
0823     Map         = guiparams.Map;
0824     wse         = guiparams.water_surface_elevation;
0825     PVdata      = guiparams.iric_anv_planview_data;
0826     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0827         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0828     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0829         fullfile(excel_path,excel_file));
0830     
0831     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0832         outfile = fullfile(excel_path,excel_file);
0833         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0834         
0835     <span class="keyword">else</span>
0836         <span class="comment">% Return default excel_path and excel_file</span>
0837         excel_path = guiprefs.excel_path;
0838         excel_file = guiprefs.excel_file;
0839         outfile = fullfile(excel_path,excel_file);
0840         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0841     <span class="keyword">end</span>
0842     
0843     <span class="comment">% Delete the old file if it exists</span>
0844     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0845         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0846             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0847             <span class="string">'already exists. Overwriting file...'</span>});
0848         delete(outfile)
0849     <span class="keyword">end</span>
0850     
0851     <span class="comment">% Save MCS Summary to an Excel File</span>
0852     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0853     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0854     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0855     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0856         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0857         sout = guiparams.mat_file';
0858     <span class="keyword">end</span>
0859     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0860     sout = {<span class="keyword">...</span>
0861         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0862         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0863         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0864         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0865         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0866         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0867         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0868         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0869         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0870         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0871         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0872         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0873         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0875         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0877         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0878         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0879         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0880         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0881         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0882         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0883         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0884         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0885         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0886         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0887         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0888         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0889         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0890         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0891         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0892         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0893         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0894         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0895         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0896         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0897         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0898         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0899         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0900         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0901         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0902         };
0903     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0904     
0905     <span class="comment">% Save DAV data to an Excel File</span>
0906     vmin = num2str(guiparams.depth_range_min);
0907     vmax = num2str(guiparams.depth_range_max);
0908     pvheaders = {<span class="keyword">...</span>
0909         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0910         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0911         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0912         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0913 
0914     <span class="comment">% Initialize Variables</span>
0915     pvdata = []; Dist = []; ID = {};
0916     X = []; Y = []; E = []; T = [];
0917     Ve = []; Vn =[]; Vm = []; Vd = [];
0918     
0919     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0920     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0921         <span class="comment">% Load current MAT-file</span>
0922         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0923         
0924         <span class="comment">% Location, Time and Bathy</span>
0925         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0926         X = [X V.mcsX(1,:)];
0927         Y = [Y V.mcsY(1,:)];
0928         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0929         E = [E V.mcsBedElev];
0930         T = [T V.mcsTime(1,:)];
0931                 
0932         <span class="comment">% Build layer-averaged velocities</span>
0933         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0934         V.mcsX(indx,:) = nan;
0935         V.mcsY(indx,:) = nan;
0936         V.mcsEast(indx,:) = nan;
0937         V.mcsNorth(indx,:) = nan;
0938         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0939         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0940         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0941         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0942         
0943         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0944     <span class="keyword">end</span>
0945     
0946     <span class="comment">% Put output into 1 matrix</span>
0947     pvdata = [<span class="keyword">...</span>
0948         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0949         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0950         ];
0951     pvdata(isnan(pvdata)) = -9999;
0952     
0953     <span class="comment">% Create table and write to Excel</span>
0954     pvout = num2cell(pvdata');
0955     pvout = horzcat(ID,pvout);
0956     timestamp = cellstr(nandatestr(T));
0957     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0958     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0959     
0960     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0961     <span class="comment">% results</span>
0962     PVheaders = {<span class="keyword">...</span>
0963         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0964         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0965         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0966         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0967         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0968     PVtable = [<span class="keyword">...</span>
0969         PVdata.outmat(1,:);<span class="keyword">...</span>
0970         PVdata.outmat(2,:);<span class="keyword">...</span>
0971         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0972         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0973         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0974         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0975         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0976     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0977     PVtable(isnan(PVtable)) = -9999;
0978     PVout = horzcat(<span class="keyword">...</span>
0979         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0980         PVdata.outfile,<span class="keyword">...</span>
0981         num2cell(PVtable'));
0982     PVout = vertcat(PVheaders,PVout);
0983     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0984     
0985     <span class="comment">% Close out waitbar</span>
0986     waitbar(1,hwait)
0987     delete(hwait)
0988     
0989     <span class="comment">% Push messages to Log Window:</span>
0990     <span class="comment">% ----------------------------</span>
0991     statusLogging(handles.LogWindow, log_text)
0992 <span class="keyword">else</span>
0993     
0994     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0995     <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0996     <a href="#_sub63" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0997     <span class="comment">% Refresh the Application Data:</span>
0998     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0999     z           = guiparams.z;
1000     A           = guiparams.A;
1001     V           = guiparams.V;
1002     Map         = guiparams.Map;
1003     wse         = guiparams.water_surface_elevation;
1004     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
1005                                                     <span class="comment">% Planview Plot exactly</span>
1006     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
1007                                  <span class="comment">% planview plot</span>
1008         
1009     log_text = {<span class="string">'Writing data to Excel file...'</span>};
1010     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
1011         fullfile(excel_path,excel_file));
1012     
1013     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1014         outfile = fullfile(excel_path,excel_file);
1015         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
1016         
1017         <span class="comment">% Delete the old file if it exists</span>
1018         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
1019             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
1020                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
1021                 <span class="string">'already exists. Overwriting file...'</span>});
1022             delete(outfile)
1023         <span class="keyword">end</span>
1024         
1025         <span class="comment">% Push messages to Log Window:</span>
1026         <span class="comment">% ----------------------------</span>
1027         statusLogging(handles.LogWindow, log_text)
1028         
1029         <span class="comment">% Save MCS Summary to an Excel File</span>
1030         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
1031         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
1032         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
1033         waitbar(1/5,hwait)
1034         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
1035             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
1036             sout = {guiparams.mat_file};
1037         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
1038             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
1039             sout = guiparams.data_files';
1040         <span class="keyword">end</span>
1041         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
1042         waitbar(2/7,hwait)
1043         <span class="keyword">for</span> zi=1:z; 
1044             mintime(zi) = nanmin(A(zi).Comp.enstime); 
1045             maxtime(zi) = nanmin(A(zi).Comp.enstime); 
1046         <span class="keyword">end</span>
1047         sout = {<span class="keyword">...</span>
1048             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1049             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1050             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1051             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1052             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1053             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
1054             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
1055             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
1056             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(mintime));<span class="keyword">...</span>
1057             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(maxtime));<span class="keyword">...</span>
1058             <span class="string">'Time of first velocity grid node:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
1059             <span class="string">'Time of last velocity grid node:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
1060             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1061             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1062             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1063             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1064             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1065             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1066             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1067             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1068             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
1069             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
1070             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1071             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
1072             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
1073             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
1074             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
1075             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1076             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
1077             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1078             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1079             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
1080             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
1081             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
1082             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1083             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1084             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1085             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1086             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1087             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1088             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1089             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1090             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1091             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1092             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1093             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1094             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1095             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1096             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1097             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1098             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1099             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1100             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1101             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1102             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1103             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1104             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1105             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1106             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1107             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1108             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1109             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1110             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1111             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1112             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1113             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1114             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1115             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1116             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1117             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1118             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1119             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1120             };
1121         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1122         waitbar(3/7,hwait)
1123         
1124         <span class="comment">% Save DAV data to an Excel File</span>
1125         vmin = num2str(guiparams.depth_range_min);
1126         vmax = num2str(guiparams.depth_range_max);
1127         pvheaders = {<span class="keyword">...</span>
1128             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1129             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1130             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1131             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1132             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1133             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1134         
1135         <span class="comment">% Create block style matrix of all processed data</span>
1136         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1137         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1138         <span class="comment">% layer-averaging applied</span>
1139         pvdata = [];
1140         
1141         <span class="comment">% Stationing from LEFT bank</span>
1142         Dist = V.mcsDist;
1143         
1144         <span class="comment">% Build bathy data matrix</span>
1145         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1146         
1147         <span class="comment">% Build layer-averaged velocities</span>
1148         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1149         V.mcsX(indx,:) = nan;
1150         V.mcsY(indx,:) = nan;
1151         V.mcsEast(indx,:) = nan;
1152         V.mcsNorth(indx,:) = nan;
1153         pvdata = [<span class="keyword">...</span>
1154             pvdata;<span class="keyword">...</span>
1155             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1156             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1157             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1158             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1159         pvdata(isnan(pvdata)) = -9999;
1160         pvout = num2cell(pvdata');
1161         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1162         timestr = nandatestr(V.mcsTime(1,:));
1163         timestamp = cellstr(timestr);
1164         pvout = horzcat(timestamp,pvout);
1165         pvout = vertcat(pvheaders,pvout);
1166         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1167         waitbar(4/7,hwait)
1168         
1169         <span class="comment">% Save MCS data to an Excel File</span>
1170         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1171         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1172         MCSheaders = {<span class="keyword">...</span>
1173             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1174             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1175             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1176             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1177             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1178             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1179             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1180             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1181             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1182             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1183             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1184             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1185             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1186             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1187             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1188             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1189             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1190         
1191         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1192         MCSdata = [<span class="keyword">...</span>
1193             V.mcsX(:)<span class="keyword">...</span>
1194             V.mcsY(:)<span class="keyword">...</span>
1195             V.mcsDist(:)<span class="keyword">...</span>
1196             vectorized_bed(:)<span class="keyword">...</span>
1197             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1198             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1199             V.mcsEast(:)<span class="keyword">...</span>
1200             V.mcsNorth(:)<span class="keyword">...</span>
1201             V.mcsVert(:)<span class="keyword">...</span>
1202             V.mcsMag(:)<span class="keyword">...</span>
1203             V.mcsDir(:)<span class="keyword">...</span>
1204             V.u(:)<span class="keyword">...</span>
1205             V.v(:)<span class="keyword">...</span>
1206             V.vp(:)<span class="keyword">...</span>
1207             V.vs(:)<span class="keyword">...</span>
1208             V.Roz.up(:)<span class="keyword">...</span>
1209             V.Roz.us(:)];
1210         MCSdata(isnan(MCSdata)) = -9999;
1211         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1212         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1213         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1214         waitbar(5/7,hwait)
1215                 
1216         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1217         <span class="comment">% results</span>
1218         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1219         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1220         PVheaders = {<span class="keyword">...</span>
1221             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1222             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1223             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1224             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1225             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1226             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1227             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1228             <span class="string">'Vel_dir_deg'</span>};
1229         PVtable = [<span class="keyword">...</span>
1230             PVdata.outmat(1,:);<span class="keyword">...</span>
1231             PVdata.outmat(2,:);<span class="keyword">...</span>
1232             PVDist;<span class="keyword">...</span>
1233             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1234             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1235             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1236             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1237         PVtable = (sortrows(PVtable',3))';
1238         PVtable(isnan(PVtable)) = -9999;
1239         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1240         PVout = vertcat(PVheaders,PVout);
1241         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1242         waitbar(6/7,hwait)
1243         
1244         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1245         <span class="comment">% results</span>
1246         <span class="comment">% Distance is from the LEFT bank</span>
1247         <span class="comment">% Doesn't include the reference vector</span>
1248         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1249         dist    = guiparams.mcsQuivers(1:end-1,1);
1250         depth   = guiparams.mcsQuivers(1:end-1,2);
1251         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1252         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1253         
1254         <span class="comment">% Compute an UTM coordinate for the vector</span>
1255         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1256         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1257         
1258         <span class="comment">% Compute a Time for each vector</span>
1259         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1260         
1261         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1262         <span class="keyword">switch</span> guiparams.contour
1263             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1264                 wtp=[<span class="string">'V.uSmooth'</span>];
1265             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1266                 wtp=[<span class="string">'V.vSmooth'</span>];
1267             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1268                 wtp=[<span class="string">'V.wSmooth'</span>];
1269             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1270                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1271             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1272                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1273             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1274                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1275             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1276                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1277             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1278                 wtp=[<span class="string">'V.vpSmooth'</span>];
1279             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1280                 wtp=[<span class="string">'V.vsSmooth'</span>];
1281             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1282                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1283             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1284                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1285             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1286                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1287             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1288                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1289             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1290                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1291             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1292                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1293             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1294                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1295             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1296                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1297             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1298                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1299             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1300                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1301             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1302                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1303         <span class="keyword">end</span>
1304         Ucomp = eval(wtp);
1305         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1306         
1307         <span class="comment">% Save MCS data to an Excel File</span>
1308         <span class="comment">% This includes the smoothed data results from the plots.</span>
1309         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1310         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1311         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1312         mcsheaders = {<span class="keyword">...</span>
1313             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1314             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1315             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1316             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1317             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1318             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1319             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1320             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1321             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1322             };
1323         mcsdata = [<span class="keyword">...</span>
1324             pUTMx(:)<span class="keyword">...</span>
1325             pUTMy(:)<span class="keyword">...</span>
1326             dist(:)<span class="keyword">...</span>
1327             depth(:)<span class="keyword">...</span>
1328             ucomp(:)<span class="keyword">...</span>
1329             vcomp(:)<span class="keyword">...</span>
1330             wcomp(:)];
1331         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1332         ridx = ~isnan(ucomp);
1333         mcsdata = mcsdata(ridx,:);
1334         mcsdata(isnan(mcsdata)) = -9999;
1335         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1336         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1337         waitbar(7/7,hwait)
1338     <span class="keyword">else</span>
1339         <span class="comment">% Return default excel_path and excel_file</span>
1340         excel_path = guiprefs.excel_path;
1341         excel_file = guiprefs.excel_file;
1342         outfile = fullfile(excel_path,excel_file);
1343         log_text = {<span class="string">'User aborted Excel export...'</span>};
1344     <span class="keyword">end</span>
1345     
1346     
1347 waitbar(1,hwait)  
1348 delete(hwait)
1349 <span class="keyword">end</span>
1350 
1351 <span class="comment">% Push messages to Log Window:</span>
1352 <span class="comment">% ----------------------------</span>
1353 statusLogging(handles.LogWindow, log_text)
1354 
1355 <span class="comment">% Store the persistent preferences:</span>
1356 <span class="comment">% ---------------------------------</span>
1357 guiprefs.excel_file = excel_file;
1358 guiprefs.excel_path = excel_path;
1359 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1360 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1361 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1362 
1363 
1364 <span class="comment">% --------------------------------------------------------------------</span>
1365 <a name="_sub28" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1366 <span class="comment">% Call separate GUI</span>
1367 VMT_BuildCustomFlatFile;
1368 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1369 
1370 <span class="comment">% --------------------------------------------------------------------</span>
1371 <a name="_sub29" href="#_subfunctions" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a>
1372 <span class="comment">% Empty</span>
1373 
1374 <span class="comment">% --------------------------------------------------------------------</span>
1375 <a name="_sub30" href="#_subfunctions" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a>
1376 <span class="comment">% Empty</span>
1377 
1378 <span class="comment">% --------------------------------------------------------------------</span>
1379 <a name="_sub31" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1380 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1381 
1382 <span class="comment">% Get the Application Data:</span>
1383 <span class="comment">% -------------------------</span>
1384 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1385 
1386 <span class="comment">% Update the GUI &amp; Application Data:</span>
1387 <span class="comment">% ----------------------------------</span>
1388 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1389 <span class="keyword">switch</span> status
1390     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1391         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1392         guiparams.unit_discharge_correction = false;
1393     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1394         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1395         guiparams.unit_discharge_correction = true;
1396 <span class="keyword">end</span>
1397 
1398 <span class="comment">% Re-store the Application data:</span>
1399 <span class="comment">% ------------------------------</span>
1400 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1401 
1402 
1403 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1404 
1405 <span class="comment">% --------------------------------------------------------------------</span>
1406 <a name="_sub32" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1407 <span class="comment">% Empty</span>
1408 
1409 <span class="comment">% --------------------------------------------------------------------</span>
1410 <a name="_sub33" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1411 <span class="comment">% Empty</span>
1412 
1413 <span class="comment">% --------------------------------------------------------------------</span>
1414 <a name="_sub34" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1415 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1416 
1417 <span class="comment">% Get the Application Data:</span>
1418 <span class="comment">% -------------------------</span>
1419 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1420 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1421 
1422 <span class="comment">% Update the Application Data:</span>
1423 <span class="comment">% ----------------------------</span>
1424 guiparams.english_units = false;
1425 guiprefs.units = <span class="string">'metric'</span>;
1426 
1427 <span class="comment">% Re-store the Application data:</span>
1428 <span class="comment">% ------------------------------</span>
1429 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1430 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1431 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1432 
1433 <span class="comment">% Update the GUI:</span>
1434 <span class="comment">% ---------------</span>
1435 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1436 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1437 
1438 <span class="comment">% [EOF] menuMetric_Callback</span>
1439 
1440 
1441 <span class="comment">% --------------------------------------------------------------------</span>
1442 <a name="_sub35" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1443 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1444 
1445 <span class="comment">% Get the Application Data:</span>
1446 <span class="comment">% -------------------------</span>
1447 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1448 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1449 
1450 <span class="comment">% Update the Application Data:</span>
1451 <span class="comment">% ----------------------------</span>
1452 guiparams.english_units = true;
1453 guiprefs.units = <span class="string">'english'</span>;
1454 
1455 <span class="comment">% Re-store the Application data:</span>
1456 <span class="comment">% ------------------------------</span>
1457 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1458 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1459 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1460 
1461 <span class="comment">% Update the GUI:</span>
1462 <span class="comment">% ---------------</span>
1463 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1464 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1465 
1466 <span class="comment">% [EOF] menuEnglish_Callback</span>
1467 
1468 <span class="comment">% --------------------------------------------------------------------</span>
1469 <a name="_sub36" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1470 <span class="comment">% Empty</span>
1471 
1472 <span class="comment">% --------------------------------------------------------------------</span>
1473 <a name="_sub37" href="#_subfunctions" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a>
1474 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1475 <span class="comment">% surface)</span>
1476 
1477 <span class="comment">% Get the Application Data:</span>
1478 <span class="comment">% -------------------------</span>
1479 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1480 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1481 
1482 <span class="keyword">switch</span> guiparams.plotref
1483     <span class="keyword">case</span> <span class="string">'dfs'</span>  <span class="comment">% Depth from surface</span>
1484         <span class="comment">% Update the Application Data:</span>
1485         <span class="comment">% ----------------------------</span>
1486         guiparams.plotref = <span class="string">'dfs'</span>;
1487         guiprefs.plotref  = <span class="string">'dfs'</span>;
1488         
1489         <span class="comment">% Re-store the Application data:</span>
1490         <span class="comment">% ------------------------------</span>
1491         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1492         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1493         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1494         
1495         <span class="comment">% Update the GUI:</span>
1496         <span class="comment">% ---------------</span>
1497         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1498     <span class="keyword">case</span> <span class="string">'hab'</span> <span class="comment">% Height above bed</span>
1499         <span class="comment">% Update the Application Data:</span>
1500         <span class="comment">% ----------------------------</span>
1501         guiparams.plotref = <span class="string">'hab'</span>;
1502         guiprefs.plotref  = <span class="string">'hab'</span>;
1503         
1504         <span class="comment">% Re-store the Application data:</span>
1505         <span class="comment">% ------------------------------</span>
1506         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1507         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1508         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1509         
1510         <span class="comment">% Update the GUI:</span>
1511         <span class="comment">% ---------------</span>
1512         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1513 <span class="keyword">end</span>
1514 <span class="comment">% [EOF] VerticalReference_Callback</span>
1515 
1516 
1517 <span class="comment">% --------------------------------------------------------------------</span>
1518 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1519 <span class="comment">% Empty</span>
1520 
1521 <span class="comment">% --------------------------------------------------------------------</span>
1522 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1523 <span class="comment">% Set cross-section endpoints automatically</span>
1524 
1525 <span class="comment">% Get the Application Data:</span>
1526 <span class="comment">% -------------------------</span>
1527 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1528 
1529 <span class="comment">% Update the Application Data:</span>
1530 <span class="comment">% ----------------------------</span>
1531 guiparams.set_cross_section_endpoints = false;
1532 
1533 <span class="comment">% Re-store the Application data:</span>
1534 <span class="comment">% ------------------------------</span>
1535 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1536 
1537 <span class="comment">% Update the GUI:</span>
1538 <span class="comment">% ---------------</span>
1539 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1540 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1541 
1542 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1543 
1544 
1545 <span class="comment">% --------------------------------------------------------------------</span>
1546 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1547 <span class="comment">% Set cross-section endpoints manually</span>
1548 
1549 <span class="comment">% Get the Application Data:</span>
1550 <span class="comment">% -------------------------</span>
1551 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1552 
1553 <span class="comment">% Update the Application Data:</span>
1554 <span class="comment">% ----------------------------</span>
1555 guiparams.set_cross_section_endpoints = true;
1556 
1557 <span class="comment">% Re-store the Application data:</span>
1558 <span class="comment">% ------------------------------</span>
1559 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1560 
1561 <span class="comment">% Update the GUI:</span>
1562 <span class="comment">% ---------------</span>
1563 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1564 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1565 
1566 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1567 
1568 
1569 
1570 
1571 <span class="comment">% --------------------------------------------------------------------</span>
1572 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1573 <span class="comment">% Empty</span>
1574 
1575 <span class="comment">% --------------------------------------------------------------------</span>
1576 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1577 
1578 <span class="comment">% Get the Application Data:</span>
1579 <span class="comment">% -------------------------</span>
1580 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1581 
1582 <span class="comment">% Update the Application Data:</span>
1583 <span class="comment">% ----------------------------</span>
1584 guiparams.print        = true;
1585 guiparams.presentation = false;
1586 
1587 <span class="comment">% Re-store the Application data:</span>
1588 <span class="comment">% ------------------------------</span>
1589 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1590 
1591 <span class="comment">% Update the GUI:</span>
1592 <span class="comment">% ---------------</span>
1593 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1594 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1595 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1596 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1597 
1598 <span class="comment">% Modify the existing figures</span>
1599 <span class="comment">% ---------------------------</span>
1600 <span class="comment">% Find what plots exist already</span>
1601 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1602 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1603 
1604 <span class="comment">% Defaults for Print Stlye Figure</span>
1605 BkgdColor   = <span class="string">'white'</span>;
1606 AxColor     = <span class="string">'black'</span>;
1607 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1608 FntSize     = 14;
1609 
1610 <span class="comment">% Loop through valid figures and adjust</span>
1611 <span class="comment">% -------------------------------------</span>
1612 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1613     
1614     <span class="keyword">for</span> i = 1:length(valid_names)
1615         <span class="keyword">switch</span> valid_names{i}
1616             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1617                 <span class="comment">% Focus the figure</span>
1618                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1619                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1620                     figure(hff)
1621                     
1622                     <span class="comment">% Make the changes to figure</span>
1623                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1624                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1625                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1626                     set(gca,<span class="string">'Color'</span>,FigColor)
1627                     set(gca,<span class="string">'XColor'</span>,AxColor)
1628                     set(gca,<span class="string">'YColor'</span>,AxColor)
1629                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1630                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1631                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1632                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1633                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1634                         <span class="string">'YColor'</span>,AxColor);
1635                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1636                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1637                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1638                     
1639                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1640                     <span class="comment">% the file(s) and path for the data</span>
1641                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1642                     <span class="keyword">if</span> ~ismultiplot
1643                         filestr = guiparams.savefile;
1644                         wd = length(filestr);
1645                         hd = 1;
1646                     <span class="keyword">else</span>
1647                         <span class="comment">% Construct a filename</span>
1648                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1649                         wd        = max(cellfun(@length,filestr));
1650                         hd        = numel(filestr);
1651                             
1652                     <span class="keyword">end</span>
1653                     
1654                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1655                     disableMenuBar(hff)
1656                     set(fileinfotxt,<span class="keyword">...</span>
1657                         <span class="string">'string'</span>,filestr)
1658                     set(fileinfotxt,<span class="keyword">...</span>
1659                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1660                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1661                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1662                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1663                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1664                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1665                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1666                     
1667                 <span class="keyword">end</span>
1668             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1669                 <span class="comment">% Focus the figure</span>
1670                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1671                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1672                     figure(hff)
1673                     
1674                     <span class="comment">% Make the changes to figure</span>
1675                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1676                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1677                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1678                     set(gca,<span class="string">'Color'</span>,FigColor)
1679                     set(gca,<span class="string">'XColor'</span>,AxColor)
1680                     set(gca,<span class="string">'YColor'</span>,AxColor)
1681                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1682                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1683                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1684                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1685                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1686                         <span class="string">'YColor'</span>,AxColor);
1687                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1688                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1689                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1690                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1691                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1692                     
1693                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1694                     <span class="comment">% the file(s) and path for the data</span>
1695                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1696                     <span class="keyword">if</span> ~ismultiplot
1697                         filestr = guiparams.savefile;
1698                         wd = length(filestr);
1699                         hd = 1;
1700                     <span class="keyword">else</span>
1701                         <span class="comment">% Construct a filename</span>
1702                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1703                         wd        = max(cellfun(@length,filestr));
1704                         hd        = numel(filestr);
1705                             
1706                     <span class="keyword">end</span>
1707                     
1708                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1709                     disableMenuBar(hff)
1710                     set(fileinfotxt,<span class="keyword">...</span>
1711                         <span class="string">'string'</span>,filestr)
1712                     set(fileinfotxt,<span class="keyword">...</span>
1713                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1714                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1715                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1716                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1717                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1718                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1719                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1720                 <span class="keyword">end</span>
1721             <span class="keyword">otherwise</span>
1722         <span class="keyword">end</span>
1723     <span class="keyword">end</span>
1724     
1725     
1726 <span class="keyword">end</span>
1727 
1728 
1729 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1730 
1731 
1732 <span class="comment">% --------------------------------------------------------------------</span>
1733 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1734 <span class="comment">% Get the Application Data:</span>
1735 <span class="comment">% -------------------------</span>
1736 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1737 
1738 <span class="comment">% Update the Application Data:</span>
1739 <span class="comment">% ----------------------------</span>
1740 guiparams.print        = false;
1741 guiparams.presentation = true;
1742 
1743 <span class="comment">% Re-store the Application data:</span>
1744 <span class="comment">% ------------------------------</span>
1745 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1746 
1747 <span class="comment">% Update the GUI:</span>
1748 <span class="comment">% ---------------</span>
1749 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1750 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1751 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1752 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1753 
1754 <span class="comment">% Modify the existing figures</span>
1755 <span class="comment">% ---------------------------</span>
1756 <span class="comment">% Find what plots exist already</span>
1757 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1758 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1759 
1760 <span class="comment">% Defaults for Presentation Style Figure</span>
1761 <span class="comment">% --------------------------------------</span>
1762 BkgdColor   = <span class="string">'black'</span>;
1763 AxColor     = <span class="string">'white'</span>;
1764 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1765 FntSize     = 14;
1766 
1767 <span class="comment">% Loop through valid figures and adjust</span>
1768 <span class="comment">% -------------------------------------</span>
1769 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1770     
1771     <span class="keyword">for</span> i = 1:length(valid_names)
1772         <span class="keyword">switch</span> valid_names{i}
1773             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1774                 <span class="comment">% Focus the figure</span>
1775                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1776                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1777                     figure(hff)
1778                     
1779                     <span class="comment">% Make the changes to figure</span>
1780                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1781                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1782                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1783                     set(gca,<span class="string">'Color'</span>,FigColor)
1784                     set(gca,<span class="string">'XColor'</span>,AxColor)
1785                     set(gca,<span class="string">'YColor'</span>,AxColor)
1786                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1787                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1788                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1789                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1790                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1791                         <span class="string">'YColor'</span>,AxColor);
1792                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1793                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1794                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1795                     
1796                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1797                     <span class="comment">% the file(s) and path for the data</span>
1798                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1799                     <span class="keyword">if</span> ~ismultiplot
1800                         filestr = guiparams.savefile;
1801                         wd = length(filestr);
1802                         hd = 1;
1803                     <span class="keyword">else</span>
1804                         <span class="comment">% Construct a filename</span>
1805                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1806                         wd        = max(cellfun(@length,filestr));
1807                         hd        = numel(filestr);
1808                             
1809                     <span class="keyword">end</span>
1810                     
1811                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1812                     disableMenuBar(hff)
1813                     set(fileinfotxt,<span class="keyword">...</span>
1814                         <span class="string">'string'</span>,filestr)
1815                     set(fileinfotxt,<span class="keyword">...</span>
1816                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1817                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1818                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1819                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1820                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1821                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1822                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1823                     
1824                 <span class="keyword">end</span>
1825             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1826                 <span class="comment">% Focus the figure</span>
1827                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1828                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1829                     figure(hff)
1830                     
1831                     <span class="comment">% Make the changes to figure</span>
1832                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1833                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1834                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1835                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1836                     set(gca,<span class="string">'XColor'</span>,AxColor)
1837                     set(gca,<span class="string">'YColor'</span>,AxColor)
1838                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1839                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1840                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1841                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1842                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1843                         <span class="string">'YColor'</span>,AxColor);
1844                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1845                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1846                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1847                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1848                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1849                     
1850                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1851                     <span class="comment">% the file(s) and path for the data</span>
1852                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1853                     <span class="keyword">if</span> ~ismultiplot
1854                         filestr = guiparams.savefile;
1855                         wd = length(filestr);
1856                         hd = 1;
1857                     <span class="keyword">else</span>
1858                         <span class="comment">% Construct a filename</span>
1859                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1860                         wd        = max(cellfun(@length,filestr));
1861                         hd        = numel(filestr);
1862                             
1863                     <span class="keyword">end</span>
1864                     
1865                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1866                     disableMenuBar(hff)
1867                     set(fileinfotxt,<span class="keyword">...</span>
1868                         <span class="string">'string'</span>,filestr)
1869                     set(fileinfotxt,<span class="keyword">...</span>
1870                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1871                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1872                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1873                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1874                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1875                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1876                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1877                 <span class="keyword">end</span>
1878             <span class="keyword">otherwise</span>
1879         <span class="keyword">end</span>
1880     <span class="keyword">end</span>
1881     
1882     
1883 <span class="keyword">end</span>
1884 
1885 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1886 
1887 <span class="comment">% --------------------------------------------------------------------</span>
1888 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1889 <span class="comment">%</span>
1890 <span class="comment">% % Get the Application data:</span>
1891 <span class="comment">% % -------------------------</span>
1892 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1893 <span class="comment">%</span>
1894 <span class="comment">% % Initialize the answer:</span>
1895 <span class="comment">% % ----------------------</span>
1896 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1897 <span class="comment">% answer = NaN;</span>
1898 <span class="comment">% while isnan(answer)</span>
1899 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1900 <span class="comment">%</span>
1901 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1902 <span class="comment">%         return</span>
1903 <span class="comment">%     end</span>
1904 <span class="comment">%</span>
1905 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1906 <span class="comment">%     % A numeric char will be a double</span>
1907 <span class="comment">% end</span>
1908 <span class="comment">%</span>
1909 <span class="comment">% % Re-store the Application data:</span>
1910 <span class="comment">% % ------------------------------</span>
1911 <span class="comment">% guiparams.vertical_offset = answer;</span>
1912 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1913 <span class="comment">%</span>
1914 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1915 
1916 <span class="comment">% --------------------------------------------------------------------</span>
1917 <a name="_sub44" href="#_subfunctions" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a>
1918 <span class="comment">% Get the Application Data:</span>
1919 <span class="comment">% -------------------------</span>
1920 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1921 
1922 <span class="comment">% Open the Advanced Settings SubGUI</span>
1923 <span class="comment">%----------------------------------</span>
1924 AdvancedSettings_subgui();
1925 uiwait(findobj(<span class="string">'Name'</span>,<span class="string">'Advanced Settings'</span>));
1926 
1927 <span class="comment">% Get the data back from the Advanced Settings SubGUI</span>
1928 <span class="comment">% and store them back in the VMT memory</span>
1929 <span class="comment">%----------------------------------------------------</span>
1930 guiparams = getpref(<span class="string">'VMTadvancedsettings'</span>,<span class="string">'guiparams'</span>);
1931 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1932 
1933 <span class="comment">% Process Vertical Reference Changes</span>
1934 <a href="#_sub37" class="code" title="subfunction VerticalReference_Callback(hObject, eventdata, handles)">VerticalReference_Callback</a>(hObject, eventdata, handles)
1935 
1936 
1937 
1938 <span class="comment">% --------------------------------------------------------------------</span>
1939 <a name="_sub45" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1940 <span class="comment">% Not implemented</span>
1941 
1942 <span class="comment">% --------------------------------------------------------------------</span>
1943 <a name="_sub46" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1944 <span class="comment">% Empty</span>
1945 
1946 <span class="comment">% --------------------------------------------------------------------</span>
1947 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1948 ASCII2GIS_GUI
1949 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1950 
1951 <span class="comment">% --------------------------------------------------------------------</span>
1952 <a name="_sub48" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1953 
1954 <span class="comment">% Get the Application preferences:</span>
1955 <span class="comment">% --------------------------------</span>
1956 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1957 
1958 inpath = guiprefs.kmz_path;
1959 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1960     infile = guiprefs.kmz_file{1};
1961 <span class="keyword">else</span>
1962     infile = guiprefs.kmz_file;
1963 <span class="keyword">end</span>
1964 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1965 
1966 guiprefs.kmz_path = outpath;
1967 guiprefs.kmz_file = outfile;
1968 
1969 <span class="comment">% Update persistent preferences</span>
1970 <span class="comment">% -----------------------------</span>
1971 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1972 
1973 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1974 
1975 <span class="comment">% --------------------------------------------------------------------</span>
1976 <a name="_sub49" href="#_subfunctions" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a>
1977 SontekMAT2KML;
1978 <span class="comment">% [EOF] menuSonTekMAT2KML_Callback</span>
1979 
1980 <span class="comment">% --------------------------------------------------------------------</span>
1981 <a name="_sub50" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1982 <span class="comment">% Get the Application preferences:</span>
1983 <span class="comment">% --------------------------------</span>
1984 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1985 
1986 VMT_BatchMode;
1987 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1988 
1989 <span class="comment">% --------------------------------------------------------------------</span>
1990 <a name="_sub51" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1991 <span class="comment">% Empty</span>
1992 
1993 <span class="comment">% --------------------------------------------------------------------</span>
1994 <a name="_sub52" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1995 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1996 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1997     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1998     
1999 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
2000     
2001     <span class="keyword">if</span> isdeployed
2002         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
2003             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
2004         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
2005             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
2006             errLogFileName},<span class="keyword">...</span>
2007             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2008             <span class="string">'error'</span>);
2009         fid = fopen(errLogFileName,<span class="string">'W'</span>);
2010         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
2011         fclose(fid);
2012         rethrow(err)
2013     <span class="keyword">else</span>
2014         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
2015             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2016             <span class="string">'error'</span>);
2017         rethrow(err);
2018     <span class="keyword">end</span>
2019 <span class="keyword">end</span>
2020 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
2021 
2022 <span class="comment">% --------------------------------------------------------------------</span>
2023 <a name="_sub53" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
2024 <span class="comment">% Get the Application data:</span>
2025 <span class="comment">% -------------------------</span>
2026 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
2027 
2028 <span class="keyword">try</span>
2029     open([pwd filesep <span class="string">'/doc/index.html'</span>])
2030 
2031 
2032 <span class="comment">% This catch is probably not necessary.</span>
2033 <span class="keyword">catch</span> err 
2034     <span class="keyword">if</span> isdeployed
2035         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
2036             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
2037         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
2038             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
2039             errLogFileName},<span class="keyword">...</span>
2040             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2041             <span class="string">'error'</span>);
2042         fid = fopen(errLogFileName,<span class="string">'W'</span>);
2043         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
2044         fclose(fid);
2045         rethrow(err)
2046     <span class="keyword">else</span>
2047         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
2048             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2049             <span class="string">'error'</span>);
2050         rethrow(err);
2051     <span class="keyword">end</span>
2052 <span class="keyword">end</span>
2053 
2054 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
2055 
2056 <span class="comment">% --------------------------------------------------------------------</span>
2057 <a name="_sub54" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
2058 
2059 <span class="comment">% Get the Application data:</span>
2060 <span class="comment">% -------------------------</span>
2061 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2062 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2063 
2064 <span class="comment">% Check version tag against the web, and display a message</span>
2065 <span class="keyword">try</span>
2066     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
2067     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
2068     <span class="keyword">if</span> length(webdata) &gt; 5
2069         current_vmt_version{1} = webdata(1:5);
2070         current_vmt_version{2} = webdata(8:16);
2071     <span class="keyword">else</span>
2072         current_vmt_version = webdata;
2073     <span class="keyword">end</span>
2074     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
2075 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
2076     <span class="keyword">if</span> isdeployed
2077         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
2078             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
2079         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
2080             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
2081             errLogFileName},<span class="keyword">...</span>
2082             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2083             <span class="string">'error'</span>);
2084         fid = fopen(errLogFileName,<span class="string">'W'</span>);
2085         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
2086         fclose(fid);
2087         rethrow(err)
2088     <span class="keyword">else</span>
2089         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
2090             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2091             <span class="string">'error'</span>);
2092         rethrow(err);
2093     <span class="keyword">end</span>
2094 <span class="keyword">end</span>
2095 
2096 <span class="keyword">if</span> ischar(current_vmt_version)
2097     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2098         h = msgbox(<span class="keyword">...</span>
2099             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2100             <span class="string">''</span>;<span class="keyword">...</span>
2101             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2102             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2103     <span class="keyword">else</span>
2104         h = msgbox(<span class="keyword">...</span>
2105             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2106             <span class="string">''</span>;<span class="keyword">...</span>
2107             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2108             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2109     <span class="keyword">end</span>
2110 <span class="keyword">elseif</span> iscell(current_vmt_version)
2111     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2112         h = msgbox(<span class="keyword">...</span>
2113             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2114             <span class="string">''</span>;<span class="keyword">...</span>
2115             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2116             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2117     <span class="keyword">else</span>
2118         h = msgbox(<span class="keyword">...</span>
2119             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2120             <span class="string">''</span>;<span class="keyword">...</span>
2121             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2122             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2123     <span class="keyword">end</span>
2124 <span class="keyword">end</span>
2125 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2126 
2127 <span class="comment">% --------------------------------------------------------------------</span>
2128 <a name="_sub55" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2129 
2130 <span class="comment">% Get the Application data:</span>
2131 <span class="comment">% -------------------------</span>
2132 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2133 messagestr = <span class="keyword">...</span>
2134     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2135     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2136     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2137     <span class="string">''</span>;<span class="keyword">...</span>
2138     <span class="string">''</span>;<span class="keyword">...</span>
2139     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2140     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2141     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2142     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2143     <span class="string">''</span>;<span class="keyword">...</span>
2144     <span class="string">''</span>;<span class="keyword">...</span>
2145     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2146     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2147     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2148     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2149     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2150     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2151     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2152 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2153 <span class="comment">% [EOF] menuAbout_Callback</span>
2154 
2155 
2156 
2157 
2158 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2159 <span class="comment">% TOOLBAR CALLBACKS %</span>
2160 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2161 
2162 <span class="comment">% --------------------------------------------------------------------</span>
2163 <a name="_sub56" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2164 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
2165 <span class="comment">% Read Files into Data Structure using tfile.</span>
2166 
2167 <span class="comment">% Get the Application data:</span>
2168 <span class="comment">% -------------------------</span>
2169 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2170 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2171 
2172 <span class="comment">% Ask the user to select files:</span>
2173 <span class="comment">% -----------------------------</span>
2174 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2175 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2176     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2177     current_file, <span class="keyword">...</span>
2178     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2179 
2180 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2181     guiparams.data_folder = pathname;
2182     <span class="keyword">if</span> ischar(filename)
2183         filename = {filename};
2184     <span class="keyword">end</span>
2185     guiparams.data_files = filename;
2186     guiparams.mat_file = <span class="string">''</span>;
2187     
2188     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2189     
2190    
2191     
2192     <span class="comment">% Update the preferences:</span>
2193     <span class="comment">% -----------------------</span>
2194     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2195     guiprefs.ascii_path = pathname;
2196     guiprefs.ascii_file = filename;
2197     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2198     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2199     
2200     <span class="comment">% Push messages to Log Window:</span>
2201     <span class="comment">% ----------------------------</span>
2202     log_text = {<span class="keyword">...</span>
2203         <span class="string">''</span>;<span class="keyword">...</span>
2204         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2205         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2206         guiparams.data_folder;
2207         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2208         char(filename)};
2209     statusLogging(handles.LogWindow, log_text)
2210     
2211     <span class="comment">% Read the file(s)</span>
2212     <span class="comment">% ----------------</span>
2213     [~,~,savefile,A,z] = <span class="keyword">...</span>
2214         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2215     guiparams.savefile = savefile;
2216     guiparams.A        = A;
2217     guiparams.z        = z;
2218     
2219     
2220     <span class="comment">% Set the vertical grid node spacing</span>
2221     <span class="comment">% ----------------------------------</span>
2222     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2223     <span class="comment">% Backwards compatible</span>
2224     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2225         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2226         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2227     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2228         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2229         guiparams.vertical_grid_node_spacing = 0.4;
2230     <span class="keyword">end</span>
2231     
2232     
2233     <span class="comment">% Save application data</span>
2234     <span class="comment">% ---------------------</span>
2235     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2236        
2237 <span class="comment">%</span>
2238 <span class="comment">%     % Preprocess the data:</span>
2239 <span class="comment">%     % --------------------</span>
2240 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2241 <span class="comment">%</span>
2242 <span class="comment">%     % Push messages to Log Window:</span>
2243 <span class="comment">%     % ----------------------------</span>
2244 <span class="comment">%     log_text = {...</span>
2245 <span class="comment">%         '   Preprocessing complete.';...</span>
2246 <span class="comment">%         '   Begin Data Processing...'};</span>
2247 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2248 <span class="comment">%</span>
2249 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2250 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2251 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2252 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2253 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2254 <span class="comment">%</span>
2255 <span class="comment">%     % Push messages to Log Window:</span>
2256 <span class="comment">%     % ----------------------------</span>
2257 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2258 <span class="comment">%</span>
2259 <span class="comment">%     % Store the data:</span>
2260 <span class="comment">%     % ---------------</span>
2261 <span class="comment">%     guiparams.z = z;</span>
2262 <span class="comment">%     guiparams.A = A;</span>
2263 <span class="comment">%     guiparams.V = V;</span>
2264 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2265     
2266           
2267     <span class="comment">% Update the GUI:</span>
2268     <span class="comment">% ---------------</span>
2269     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2270     
2271     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2272     
2273 <span class="keyword">end</span>
2274 <span class="comment">% [EOF] loadDataCallback</span>
2275 
2276 
2277 
2278 <span class="comment">% --------------------------------------------------------------------</span>
2279 <a name="_sub57" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2280 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2281 
2282 <span class="comment">% Get the Application data:</span>
2283 <span class="comment">% -------------------------</span>
2284 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2285 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2286 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2287 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2288 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2289 
2290 [the_file,the_path] = <span class="keyword">...</span>
2291     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2292     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2293     fullfile(guiparams.mat_path,guiparams.savefile));
2294 
2295 <span class="comment">% Save the processed data to a MAT file:</span>
2296 <span class="comment">% --------------------------------------</span>
2297 <span class="keyword">if</span> ischar(the_file)
2298     guiparams.mat_path = the_path;
2299     guiparams.mat_file = the_file;
2300     guiparams.savefile = the_file;
2301     
2302     <span class="comment">% Re-store the Application data:</span>
2303     <span class="comment">% ------------------------------</span>
2304     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2305     
2306     <span class="comment">% Update the preferences:</span>
2307     <span class="comment">% -----------------------</span>
2308     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2309     guiprefs.mat_path = the_path;
2310     guiprefs.mat_file = the_file;
2311     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2312     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2313     
2314     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2315     savefile = fullfile(pathstr,[filename extension]);
2316     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2317     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2318     log_text = {<span class="keyword">...</span>
2319         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2320         savefile};
2321     statusLogging(handles.LogWindow,log_text)
2322     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2323 <span class="keyword">end</span>
2324 
2325 <span class="comment">% [EOF] saveDataCallback</span>
2326 
2327 
2328 <span class="comment">% --------------------------------------------------------------------</span>
2329 <a name="_sub58" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2330 
2331 <span class="comment">% Get the Application data:</span>
2332 <span class="comment">% -------------------------</span>
2333 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2334 z   = guiparams.z;
2335 A   = guiparams.A;
2336 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2337 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2338 
2339 <span class="comment">% Compute multibeam bathymetry:</span>
2340 <span class="comment">% -----------------------------</span>
2341 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2342 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2343 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2344     guiparams.beam_angle, <span class="keyword">...</span>
2345     guiparams.magnetic_variation, <span class="keyword">...</span>
2346     guiparams.water_surface_elevation, <span class="keyword">...</span>
2347     guiparams.output_auxiliary_data);
2348 
2349 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2350 
2351 <span class="comment">% [EOF] saveBathymetryCallback</span>
2352 
2353 <span class="comment">% --------------------------------------------------------------------</span>
2354 <a name="_sub59" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2355 
2356 <span class="comment">% Get the Application data:</span>
2357 <span class="comment">% -------------------------</span>
2358 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2359 
2360 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2361     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2362     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2363     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2364     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2365     handles.figure1);
2366 
2367 <span class="comment">% Update the GUI:</span>
2368 <span class="comment">% ---------------</span>
2369 <span class="keyword">if</span> guiparams.english_units
2370     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2371     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2372 <span class="keyword">else</span>
2373     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2374     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2375 <span class="keyword">end</span>
2376 
2377 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2378     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2379     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2380 <span class="keyword">else</span>
2381     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2382     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2383 <span class="keyword">end</span>
2384 
2385 <span class="keyword">if</span> guiparams.presentation
2386     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2387 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2388 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2389 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2390 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2391 <span class="keyword">else</span>
2392     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2393 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2394 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2395 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2396 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2397 <span class="keyword">end</span>
2398 
2399 <span class="comment">% Re-store the Application data:</span>
2400 <span class="comment">% ------------------------------</span>
2401 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2402 
2403 <span class="comment">% [EOF] plottingParametersCallback</span>
2404 
2405 
2406 <span class="comment">% --------------------------------------------------------------------</span>
2407 <a name="_sub60" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2408 
2409 <span class="comment">% Get the Application data:</span>
2410 <span class="comment">% -------------------------</span>
2411 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2412 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2413 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2414 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2415 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2416 
2417 <span class="comment">% [EOF] processingParametersCallback</span>
2418 
2419 
2420 <span class="comment">% --------------------------------------------------------------------</span>
2421 <a name="_sub61" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2422 <span class="comment">% Plot 1</span>
2423 
2424 <span class="comment">% Get the Application data:</span>
2425 <span class="comment">% -------------------------</span>
2426 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2427 z = guiparams.z;
2428 A = guiparams.A;
2429 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2430 <span class="comment">% Map = guiparams.Map;</span>
2431 
2432 
2433 <span class="comment">% Preprocess the data:</span>
2434 <span class="comment">% --------------------</span>
2435 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2436 
2437 <span class="comment">% Push messages to Log Window:</span>
2438 <span class="comment">% ----------------------------</span>
2439 log_text = {<span class="keyword">...</span>
2440     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2441     <span class="string">'   Begin Data Processing...'</span>};
2442 statusLogging(handles.LogWindow, log_text)
2443 
2444 <span class="comment">% Process the transects:</span>
2445 <span class="comment">% ----------------------</span>
2446 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2447 A(1).vgns = guiparams.vertical_grid_node_spacing;
2448 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2449 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2450     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2451 
2452 <span class="comment">% Compute the smoothed variables</span>
2453 <span class="comment">% ------------------------------</span>
2454 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2455 <span class="comment">% runtime.</span>
2456 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2457     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2458     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2459     guiparams.vertical_smoothing_window);
2460 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2461 
2462 <span class="comment">% Push messages to Log Window:</span>
2463 <span class="comment">% ----------------------------</span>
2464 statusLogging(handles.LogWindow, processing_log_text)
2465 
2466 <span class="comment">% Store the data:</span>
2467 <span class="comment">% ---------------</span>
2468 guiparams.z = z;
2469 guiparams.A = A;
2470 guiparams.V = V;
2471 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2472 
2473 <span class="comment">% Push messages to Log Window:</span>
2474 <span class="comment">% ----------------------------</span>
2475 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2476 statusLogging(handles.LogWindow, log_text)
2477 
2478 <span class="comment">% Create or replot the Shiptracks</span>
2479 <span class="comment">% -------------------------------</span>
2480 <span class="comment">% Grab the axes to the plot</span>
2481 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2482 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2483 
2484 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2485 <span class="comment">% New plot display window</span>
2486 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2487 <span class="comment">% h = figure(1); clf</span>
2488 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2489 
2490 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2491 
2492 
2493 <span class="comment">% --------------------------------------------------------------------</span>
2494 <a name="_sub62" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2495 <span class="comment">% Plot 2</span>
2496 
2497 <span class="comment">% Get the Application data:</span>
2498 <span class="comment">% -------------------------</span>
2499 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2500 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2501 
2502 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2503     <span class="comment">% Push messages to Log Window:</span>
2504     <span class="comment">% ----------------------------</span>
2505     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2506     statusLogging(handles.LogWindow, log_text)
2507     
2508        
2509     <span class="comment">% Push plotting parameters to log window:</span>
2510     <span class="comment">% ---------------------------------------</span>
2511     log_text = {<span class="keyword">...</span>
2512         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2513         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2514         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2515         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2516         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2517         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2518         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2519         };
2520     statusLogging(handles.LogWindow, log_text)
2521     
2522     <span class="comment">% Plot the data:</span>
2523     <span class="comment">% --------------</span>
2524     z = [];
2525     A = [];
2526     V = [];
2527     Map = [];
2528     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2529     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2530         depth_range, <span class="keyword">...</span>
2531         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2532         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2533         guiparams.smoothing_window_size, <span class="keyword">...</span>
2534         guiparams.display_shoreline, <span class="keyword">...</span>
2535         guiparams.english_units, <span class="keyword">...</span>
2536         guiparams.mat_file, <span class="keyword">...</span>
2537         guiparams.mat_path, <span class="keyword">...</span>
2538         guiparams.plotref); <span class="comment">% PLOT2</span>
2539     statusLogging(handles.LogWindow, log_text)
2540     
2541     <span class="comment">% Plot a Shoreline Map:</span>
2542     <span class="comment">% ---------------------</span>
2543     <span class="keyword">if</span> guiparams.display_shoreline
2544         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2545             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2546             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2547             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2548         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2549             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2550             Map.UTMe   = mapdata(:,1);
2551             Map.UTMn   = mapdata(:,2);
2552             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2553             <span class="comment">%Map.UTMzone = zone;</span>
2554         <span class="keyword">else</span>
2555             Map = [];
2556         <span class="keyword">end</span>
2557         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2558         log_text = {<span class="keyword">...</span>
2559             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2560             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2561             };
2562         statusLogging(handles.LogWindow, log_text)
2563     <span class="keyword">else</span>
2564         Map = [];
2565     <span class="keyword">end</span>
2566     
2567 <span class="keyword">else</span>
2568     z = guiparams.z;
2569     A = guiparams.A;
2570     <span class="comment">% V = guiparams.V;</span>
2571     Map = guiparams.Map;
2572     
2573     <span class="comment">% Push messages to Log Window:</span>
2574     <span class="comment">% ----------------------------</span>
2575     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2576     statusLogging(handles.LogWindow, log_text)
2577     
2578         
2579     <span class="comment">% Preprocess the data:</span>
2580     <span class="comment">% --------------------</span>
2581     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2582     
2583     <span class="comment">% Process the transects:</span>
2584     <span class="comment">% ----------------------</span>
2585     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2586     A(1).vgns = guiparams.vertical_grid_node_spacing;
2587     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2588     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2589     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2590     
2591     <span class="comment">% Compute the smoothed variables</span>
2592     <span class="comment">% ------------------------------</span>
2593     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2594     <span class="comment">% runtime.</span>
2595     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2596         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2597         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2598         guiparams.vertical_smoothing_window);
2599     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2600     
2601     <span class="comment">% Push messages to Log Window:</span>
2602     <span class="comment">% ----------------------------</span>
2603     statusLogging(handles.LogWindow, processing_log_text)
2604     
2605     <span class="comment">% Plot the cross section:</span>
2606     <span class="comment">% -----------------------</span>
2607     log_text = {<span class="keyword">...</span>
2608         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2609         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2610         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2611         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2612         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2613         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2614         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2615         };
2616     statusLogging(handles.LogWindow, log_text)
2617     
2618     <span class="comment">% Plot the data:</span>
2619     <span class="comment">% --------------</span>
2620     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2621     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2622     
2623     
2624     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2625         depth_range, <span class="keyword">...</span>
2626         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2627         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2628         guiparams.smoothing_window_size, <span class="keyword">...</span>
2629         guiparams.display_shoreline, <span class="keyword">...</span>
2630         guiparams.english_units, <span class="keyword">...</span>
2631         guiparams.mat_file, <span class="keyword">...</span>
2632         guiparams.mat_path, <span class="keyword">...</span>
2633         guiparams.plotref); <span class="comment">% PLOT2</span>
2634     statusLogging(handles.LogWindow, log_text)
2635     
2636     <span class="comment">% Plot User Set Endpoints</span>
2637     <span class="comment">% -----------------------</span>
2638     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2639         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2640         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2641         x = data(:,1);
2642         y = data(:,2);
2643         
2644         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2645         figure(fh); hold on
2646         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2647         hold off
2648     <span class="keyword">end</span>
2649     
2650     <span class="comment">% Plot a Shoreline Map:</span>
2651     <span class="comment">% ---------------------</span>
2652     <span class="keyword">if</span> guiparams.display_shoreline
2653         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2654             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2655             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2656             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2657         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2658             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2659             Map.UTMe   = mapdata(:,1);
2660             Map.UTMn   = mapdata(:,2);
2661             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2662             <span class="comment">%Map.UTMzone = zone;</span>
2663         <span class="keyword">else</span>
2664             Map = [];
2665         <span class="keyword">end</span>
2666         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2667         log_text = {<span class="keyword">...</span>
2668             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2669             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2670             };
2671         statusLogging(handles.LogWindow, log_text)
2672     <span class="keyword">else</span>
2673         Map = [];
2674     <span class="keyword">end</span>
2675     
2676 <span class="keyword">end</span>
2677 
2678 <span class="keyword">if</span> guiparams.add_background
2679     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2680     statusLogging(handles.LogWindow, log_text)
2681 <span class="keyword">end</span>
2682 
2683 <span class="comment">% Update guiparams</span>
2684 <span class="comment">% ----------------</span>
2685 guiparams.z   = z;
2686 guiparams.A   = A;
2687 guiparams.V   = V;
2688 guiparams.Map = Map;
2689 guiparams.iric_anv_planview_data = PVdata;
2690 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2691 
2692 <span class="comment">% Update preferences</span>
2693 <span class="comment">% ------------------</span>
2694 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2695 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2696 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2697 
2698 <span class="comment">% Force plot to be formated properly</span>
2699 <span class="comment">% ----------------------------------</span>
2700 <span class="keyword">if</span> guiparams.presentation
2701     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2702 <span class="keyword">else</span>
2703     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2704 <span class="keyword">end</span>
2705 <span class="keyword">switch</span> guiparams.renderer
2706     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2707         <a href="#_sub19" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2708     <span class="keyword">case</span> <span class="string">'painters'</span>
2709         <a href="#_sub20" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2710     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2711         <a href="#_sub21" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2712 <span class="keyword">end</span>
2713 
2714 <span class="comment">% Focus the figure</span>
2715 <span class="comment">% ----------------</span>
2716 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2717 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2718     figure(hff)
2719 <span class="keyword">end</span>
2720 
2721 <span class="comment">% Start the Graphics Control Gui</span>
2722 <span class="comment">% ------------------------------</span>
2723 VMT_GraphicsControl
2724 
2725 <span class="comment">% [EOF] planviewPlotCallback</span>
2726 
2727 
2728 <span class="comment">% --------------------------------------------------------------------</span>
2729 <a name="_sub63" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2730 <span class="comment">% Plot 3</span>
2731 
2732 <span class="comment">% Get the Application data:</span>
2733 <span class="comment">% -------------------------</span>
2734 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2735 z = guiparams.z;
2736 A = guiparams.A;
2737 <span class="comment">% V = guiparams.V;</span>
2738 <span class="comment">% Map = guiparams.Map;</span>
2739 
2740 <span class="comment">% Preprocess the data:</span>
2741 <span class="comment">% --------------------</span>
2742 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2743 
2744 <span class="comment">% Push messages to Log Window:</span>
2745 <span class="comment">% ----------------------------</span>
2746 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2747 statusLogging(handles.LogWindow, log_text)
2748 
2749 <span class="comment">% Process the transects:</span>
2750 <span class="comment">% ----------------------</span>
2751 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2752 A(1).vgns = guiparams.vertical_grid_node_spacing;
2753 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2754 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2755     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2756 
2757 <span class="comment">% Push messages to Log Window:</span>
2758 <span class="comment">% ----------------------------</span>
2759 statusLogging(handles.LogWindow, processing_log_text)
2760 
2761 <span class="comment">% Plot the cross section:</span>
2762 <span class="comment">% -----------------------</span>
2763 log_text = {<span class="keyword">...</span>
2764     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2765     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2766     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2767     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2768     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2769     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2770     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2771     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2772     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2773     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2774     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2775     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2776     
2777     };
2778 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2779     log_text = vertcat(log_text, {<span class="keyword">...</span>
2780         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2781         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2782         });
2783 <span class="keyword">end</span>
2784 <span class="comment">% Push messages to Log Window:</span>
2785 <span class="comment">% ----------------------------</span>
2786 statusLogging(handles.LogWindow, log_text)
2787 
2788 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2789     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2790 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2791 <span class="comment">%         ...guiparams.contour, ...</span>
2792 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2793 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2794     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2795         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2796         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2797         guiparams.vertical_smoothing_window);
2798     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2799     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2800         guiparams.contour, <span class="keyword">...</span>
2801         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2802         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2803         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2804         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2805         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2806         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2807         guiparams.english_units,<span class="keyword">...</span>
2808         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2809         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2810     
2811 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2812     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2813         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2814         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2815         guiparams.vertical_smoothing_window);
2816     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2817     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2818         guiparams.contour, <span class="keyword">...</span>
2819         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2820         guiparams.english_units, <span class="keyword">...</span>
2821         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2822         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2823     
2824     guiparams.zmin = zmin;
2825     guiparams.zmax = zmax;
2826     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2827 <span class="keyword">end</span>
2828 
2829 <span class="comment">% Force plot to be formated properly</span>
2830 <span class="comment">% ----------------------------------</span>
2831 <span class="keyword">if</span> guiparams.presentation
2832     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2833 <span class="keyword">else</span>
2834     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2835 <span class="keyword">end</span>
2836 <span class="keyword">switch</span> guiparams.renderer
2837     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2838         <a href="#_sub19" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2839     <span class="keyword">case</span> <span class="string">'painters'</span>
2840         <a href="#_sub20" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2841     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2842         <a href="#_sub21" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2843 <span class="keyword">end</span>
2844 
2845 <span class="comment">% Focus the figure</span>
2846 <span class="comment">% ----------------</span>
2847 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2848 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2849     figure(hff)
2850 <span class="keyword">end</span>
2851 
2852 <span class="comment">% Re-store the Application data:</span>
2853 <span class="comment">% ------------------------------</span>
2854 guiparams.V = V;
2855 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2856 
2857 <span class="comment">% Start the Graphics Control Gui</span>
2858 <span class="comment">% ------------------------------</span>
2859 VMT_GraphicsControl
2860 
2861 <span class="comment">% Push messages to Log Window:</span>
2862 <span class="comment">% ----------------------------</span>
2863 statusLogging(handles.LogWindow, plot_cont_log_text)
2864 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2865 
2866 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2867 
2868 
2869 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2870 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2871 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2872 
2873 <span class="comment">% --------------------------------------------------------------------</span>
2874 <a name="_sub64" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2875 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2876 
2877 <span class="comment">% Get the Application data:</span>
2878 <span class="comment">% -------------------------</span>
2879 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2880 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2881 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2882 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2883 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2884 
2885 [the_file,the_path] = <span class="keyword">...</span>
2886     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2887     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2888     fullfile(guiparams.mat_path,guiparams.savefile));
2889 
2890 <span class="comment">% Save the processed data to a MAT file:</span>
2891 <span class="comment">% --------------------------------------</span>
2892 <span class="keyword">if</span> ischar(the_file)
2893     guiparams.mat_path = the_path;
2894     guiparams.mat_file = the_file;
2895     guiparams.savefile = the_file;
2896     
2897     <span class="comment">% Re-store the Application data:</span>
2898     <span class="comment">% ------------------------------</span>
2899     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2900     
2901     <span class="comment">% Update the preferences:</span>
2902     <span class="comment">% -----------------------</span>
2903     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2904     guiprefs.mat_path = the_path;
2905     guiprefs.mat_file = the_file;
2906     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2907     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2908     
2909     [~,filename,extension] = fileparts(guiparams.savefile);
2910     savefile = [filename extension];
2911     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2912         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2913     disp(<span class="string">'Saving Processed Data File...'</span>)
2914     disp(savefile)
2915     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2916 <span class="keyword">end</span>
2917 
2918 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2919 
2920 
2921 <span class="comment">% --------------------------------------------------------------------</span>
2922 <a name="_sub65" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2923 
2924 <span class="comment">% Get the Application data:</span>
2925 <span class="comment">% -------------------------</span>
2926 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2927 <span class="comment">% z   = guiparams.z;</span>
2928 <span class="comment">% A   = guiparams.A;</span>
2929 V   = guiparams.V;
2930 <span class="comment">% Map = guiparams.Map;</span>
2931 
2932 [the_file,the_path] = <span class="keyword">...</span>
2933     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2934     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2935     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2936 
2937 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2938 <span class="comment">% ------------------------------------------</span>
2939 <span class="keyword">if</span> ischar(the_file)
2940     guiparams.tecplot_path = the_path;
2941     guiparams.tecplot_file = the_file;
2942     
2943     <span class="comment">% Re-store the Application data:</span>
2944     <span class="comment">% ------------------------------</span>
2945     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2946     
2947     <span class="comment">% Update the preferences:</span>
2948     <span class="comment">% -----------------------</span>
2949     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2950     guiprefs.tecplot_path = the_path;
2951     guiprefs.tecplot_file = the_file;
2952     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2953     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2954     
2955     <span class="comment">% Push to log window</span>
2956     <span class="comment">% ------------------</span>
2957     log_text = {<span class="keyword">...</span>
2958         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2959         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2960         the_path;<span class="keyword">...</span>
2961         [<span class="string">'Filename: '</span> the_file]};
2962     statusLogging(handles.LogWindow,log_text)
2963         
2964     <span class="keyword">if</span> isempty(V)
2965         A = guiparams.A;
2966         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2967         A(1).vgns = guiparams.vertical_grid_node_spacing;
2968         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2969         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2970     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2971     <span class="keyword">end</span>
2972     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2973     
2974     <span class="comment">% Push to log window</span>
2975     <span class="comment">% ------------------</span>
2976     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2977     statusLogging(handles.LogWindow,log_text)
2978     
2979     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2980     
2981     <span class="comment">% Push to log window</span>
2982     <span class="comment">% ------------------</span>
2983     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2984     statusLogging(handles.LogWindow,log_text)
2985    
2986 <span class="keyword">end</span>
2987 
2988 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2989 
2990 
2991 <span class="comment">% --------------------------------------------------------------------</span>
2992 <a name="_sub66" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2993 
2994 <span class="comment">% Get the Application data:</span>
2995 <span class="comment">% -------------------------</span>
2996 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2997 <span class="comment">% z   = guiparams.z;</span>
2998 A   = guiparams.A;
2999 V   = guiparams.V;
3000 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
3001 
3002 [the_file,the_path] = <span class="keyword">...</span>
3003     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
3004     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
3005     fullfile(guiparams.kmz_path,guiparams.kmz_file));
3006 
3007 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
3008 <span class="comment">% -----------------------------------------------------</span>
3009 <span class="keyword">if</span> ischar(the_file)
3010     guiparams.kmz_path = the_path;
3011     guiparams.kmz_file = the_file;
3012     
3013     <span class="comment">% Re-store the Application data:</span>
3014     <span class="comment">% ------------------------------</span>
3015     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3016     
3017     <span class="comment">% Update the preferences:</span>
3018     <span class="comment">% -----------------------</span>
3019     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3020     guiprefs.kmz_path = the_path;
3021     guiprefs.kmz_file = the_file;
3022     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3023     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
3024     
3025     <span class="comment">%     if guiparams.display_shoreline</span>
3026     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
3027     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
3028     <span class="comment">%                             guiparams.vertical_offset);</span>
3029     <span class="comment">%     end</span>
3030     <span class="keyword">if</span> isempty(V)
3031         A = guiparams.A;
3032         A(1).hgns = guiparams.horizontal_grid_node_spacing;
3033         A(1).vgns = guiparams.vertical_grid_node_spacing;
3034         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3035         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3036     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
3037     <span class="keyword">end</span>
3038     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
3039         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
3040         guiparams.vertical_exaggeration, <span class="keyword">...</span>
3041         guiparams.KMZ_vertical_offset);
3042 <span class="keyword">end</span>
3043 
3044 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
3045 
3046 
3047 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3048 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
3049 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3050 
3051 <span class="comment">% --------------------------------------------------------------------</span>
3052 <a name="_sub67" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
3053 
3054 <span class="comment">% Get the Application data:</span>
3055 <span class="comment">% -------------------------</span>
3056 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3057 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3058 z = guiparams.z;
3059 A = guiparams.A;
3060 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
3061 <span class="comment">% Map = guiparams.Map;</span>
3062 setends = guiparams.set_cross_section_endpoints;
3063 
3064 [the_file,the_path] = <span class="keyword">...</span>
3065     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
3066     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
3067     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
3068     guiprefs.multibeambathymetry_file));
3069 
3070 <span class="keyword">if</span> ischar(the_file)
3071     guiparams.multibeambathymetry_path = the_path;
3072     guiparams.multibeambathymetry_file = the_file;
3073     
3074     <span class="comment">% Re-store the Application data:</span>
3075     <span class="comment">% ------------------------------</span>
3076     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3077     
3078     <span class="comment">% Update the preferences:</span>
3079     <span class="comment">% -----------------------</span>
3080     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3081     guiprefs.multibeambathymetry_path = the_path;
3082     guiprefs.multibeambathymetry_file = the_file;
3083     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3084     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
3085     
3086     <span class="keyword">if</span> guiparams.output_auxiliary_data
3087     <span class="keyword">end</span>
3088     
3089     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
3090     
3091     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
3092         guiparams.multibeambathymetry_file);
3093     
3094     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
3095         [<span class="string">'   '</span> savefile]};
3096     statusLogging(handles.LogWindow,log_text)
3097     
3098     <span class="comment">% Process the transects:</span>
3099     <span class="comment">% ----------------------</span>
3100     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3101     A(1).vgns = guiparams.vertical_grid_node_spacing;
3102     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3103     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3104     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
3105     
3106     <span class="comment">% Compute the smoothed variables</span>
3107     <span class="comment">% ------------------------------</span>
3108     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3109     <span class="comment">% runtime.</span>
3110     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3111         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3112         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3113         guiparams.vertical_smoothing_window);
3114     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3115     <span class="comment">% Push messages to Log Window:</span>
3116     <span class="comment">% ----------------------------</span>
3117     statusLogging(handles.LogWindow, processing_log_text)
3118 
3119     
3120     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3121         guiparams.A, <span class="keyword">...</span>
3122         savefile, <span class="keyword">...</span>
3123         guiparams.beam_angle, <span class="keyword">...</span>
3124         guiparams.magnetic_variation, <span class="keyword">...</span>
3125         guiparams.water_surface_elevation, <span class="keyword">...</span>
3126         guiparams.output_auxiliary_data);
3127     
3128     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3129     
3130 <span class="keyword">end</span>
3131 
3132 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3133 
3134 
3135 <span class="comment">% --------------------------------------------------------------------</span>
3136 <a name="_sub68" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3137 <span class="comment">% Get the beam angle</span>
3138 
3139 <span class="comment">% Get the Application data:</span>
3140 <span class="comment">% -------------------------</span>
3141 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3142 
3143 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3144 <span class="comment">% ----------------------------------------------------------------</span>
3145 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3146 is_a_number = ~isnan(new_beam_angle);
3147 is_positive = new_beam_angle&gt;=0;
3148 
3149 <span class="comment">% Modify the Application data:</span>
3150 <span class="comment">% ----------------------------</span>
3151 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3152     guiparams.beam_angle = new_beam_angle;
3153     
3154     <span class="comment">% Re-store the Application data:</span>
3155     <span class="comment">% ------------------------------</span>
3156     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3157     
3158 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3159     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3160 <span class="keyword">end</span>
3161 
3162 <span class="comment">% [EOF] BeamAngle_Callback</span>
3163 
3164 
3165 <span class="comment">% --------------------------------------------------------------------</span>
3166 <a name="_sub69" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3167 <span class="comment">% Get the Magnetic Variation</span>
3168 
3169 <span class="comment">% Get the Application data:</span>
3170 <span class="comment">% -------------------------</span>
3171 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3172 
3173 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3174 <span class="comment">% ----------------------------------------------------------------</span>
3175 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3176 is_a_number = ~isnan(new_magnetic_variation);
3177 is_positive = new_magnetic_variation&gt;=0;
3178 
3179 <span class="comment">% Modify the Application data:</span>
3180 <span class="comment">% ----------------------------</span>
3181 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3182     guiparams.magnetic_variation = new_magnetic_variation;
3183     
3184     <span class="comment">% Re-store the Application data:</span>
3185     <span class="comment">% ------------------------------</span>
3186     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3187     
3188 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3189     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3190 <span class="keyword">end</span>
3191 
3192 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3193 
3194 
3195 <span class="comment">% % --------------------------------------------------------------------</span>
3196 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3197 <span class="comment">%</span>
3198 <span class="comment">% % Get the Application data:</span>
3199 <span class="comment">% % -------------------------</span>
3200 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3201 <span class="comment">%</span>
3202 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3203 <span class="comment">% % ----------------------------------------------------------------</span>
3204 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3205 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3206 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3207 <span class="comment">%</span>
3208 <span class="comment">% % Modify the Application data:</span>
3209 <span class="comment">% % ----------------------------</span>
3210 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3211 <span class="comment">%     guiparams.wse = new_wse;</span>
3212 <span class="comment">%</span>
3213 <span class="comment">%     % Re-store the Application data:</span>
3214 <span class="comment">%     % ------------------------------</span>
3215 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3216 <span class="comment">%</span>
3217 <span class="comment">% else % Reject the (incorrect) input</span>
3218 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3219 <span class="comment">% end</span>
3220 <span class="comment">%</span>
3221 <span class="comment">% % [EOF] WSE_Callback</span>
3222 
3223 
3224 <span class="comment">% --------------------------------------------------------------------</span>
3225 <a name="_sub70" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3226 <span class="comment">% Bathymetry Auxiliary Data</span>
3227 
3228 <span class="comment">% Get the Application data:</span>
3229 <span class="comment">% -------------------------</span>
3230 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3231 
3232 <span class="comment">% Modify the Application data:</span>
3233 <span class="comment">% ----------------------------</span>
3234 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3235 
3236 <span class="comment">% Re-store the Application data:</span>
3237 <span class="comment">% ------------------------------</span>
3238 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3239 
3240 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3241 
3242 
3243 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3244 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3245 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3246 
3247 <span class="comment">% --------------------------------------------------------------------</span>
3248 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3249 
3250 <span class="comment">% Get the Application data:</span>
3251 <span class="comment">% -------------------------</span>
3252 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3253 
3254 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3255 <span class="comment">% ----------------------------------------------------------------</span>
3256 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3257 is_a_number = ~isnan(new_depth_range_min);
3258 is_positive = new_depth_range_min&gt;=0;
3259 
3260 <span class="comment">% Modify the Application data:</span>
3261 <span class="comment">% ----------------------------</span>
3262 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3263     guiparams.depth_range_min = new_depth_range_min;
3264     
3265     <span class="comment">% Re-store the Application data:</span>
3266     <span class="comment">% ------------------------------</span>
3267     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3268     
3269 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3270     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3271 <span class="keyword">end</span>
3272 
3273 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3274 
3275 
3276 <span class="comment">% --------------------------------------------------------------------</span>
3277 <a name="_sub72" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3278 
3279 <span class="comment">% Get the Application data:</span>
3280 <span class="comment">% -------------------------</span>
3281 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3282 
3283 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3284 <span class="comment">% ----------------------------------------------------------------</span>
3285 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3286 is_a_number = ~isnan(new_depth_range_max);
3287 is_positive = new_depth_range_max&gt;=0;
3288 
3289 <span class="comment">% Modify the Application data:</span>
3290 <span class="comment">% ----------------------------</span>
3291 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3292     guiparams.depth_range_max = new_depth_range_max;
3293     
3294     <span class="comment">% Re-store the Application data:</span>
3295     <span class="comment">% ------------------------------</span>
3296     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3297     
3298 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3299     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3300 <span class="keyword">end</span>
3301 
3302 <span class="comment">% [EOF] DepthMax_Callback</span>
3303 
3304 
3305 <span class="comment">% --------------------------------------------------------------------</span>
3306 <a name="_sub73" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3307 <span class="comment">% Set quiver scale (contour)</span>
3308 
3309 <span class="comment">% Get the Application data:</span>
3310 <span class="comment">% -------------------------</span>
3311 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3312 
3313 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3314 <span class="comment">% ----------------------------------------------------------------</span>
3315 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3316 is_a_number = ~isnan(new_vector_scale_plan_view);
3317 is_positive = new_vector_scale_plan_view&gt;=0;
3318 
3319 <span class="comment">% Modify the Application data:</span>
3320 <span class="comment">% ----------------------------</span>
3321 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3322     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3323     
3324     <span class="comment">% Re-store the Application data:</span>
3325     <span class="comment">% ------------------------------</span>
3326     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3327     
3328 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3329     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3330 <span class="keyword">end</span>
3331 
3332 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3333 
3334 
3335 <span class="comment">% --------------------------------------------------------------------</span>
3336 <a name="_sub74" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3337 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3338 
3339 <span class="comment">% Get the Application data:</span>
3340 <span class="comment">% -------------------------</span>
3341 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3342 
3343 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3344 <span class="comment">% ----------------------------------------------------------------</span>
3345 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3346 is_a_number = ~isnan(new_vector_spacing_plan_view);
3347 is_positive = new_vector_spacing_plan_view&gt;=0;
3348 
3349 <span class="comment">% Modify the Application data:</span>
3350 <span class="comment">% ----------------------------</span>
3351 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3352     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3353     
3354     <span class="comment">% Re-store the Application data:</span>
3355     <span class="comment">% ------------------------------</span>
3356     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3357     
3358 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3359     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3360 <span class="keyword">end</span>
3361 
3362 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3363 
3364 
3365 <span class="comment">% --------------------------------------------------------------------</span>
3366 <a name="_sub75" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3367 <span class="comment">% Plan View smoothing window size</span>
3368 
3369 <span class="comment">% Get the Application data:</span>
3370 <span class="comment">% -------------------------</span>
3371 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3372 
3373 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3374 <span class="comment">% ----------------------------------------------------------------</span>
3375 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3376 is_a_number = ~isnan(new_smoothing_window_size);
3377 is_positive = new_smoothing_window_size&gt;=0;
3378 
3379 <span class="comment">% Modify the Application data:</span>
3380 <span class="comment">% ----------------------------</span>
3381 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3382     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3383     
3384     <span class="comment">% Re-store the Application data:</span>
3385     <span class="comment">% ------------------------------</span>
3386     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3387     
3388 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3389     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3390 <span class="keyword">end</span>
3391 
3392 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3393 
3394 
3395 <span class="comment">% --------------------------------------------------------------------</span>
3396 <a name="_sub76" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3397 
3398 <span class="comment">% Get the Application data:</span>
3399 <span class="comment">% -------------------------</span>
3400 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3401 
3402 <span class="comment">% Modify the Application data:</span>
3403 <span class="comment">% ----------------------------</span>
3404 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3405 
3406 <span class="comment">% Re-store the Application data:</span>
3407 <span class="comment">% ------------------------------</span>
3408 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3409 
3410 <span class="comment">% [EOF] AddBackground_Callback</span>
3411 
3412 
3413 <span class="comment">% --------------------------------------------------------------------</span>
3414 <a name="_sub77" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3415 <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3416 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3417 
3418 
3419 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3420 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3421 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3422 
3423 <span class="comment">% --------------------------------------------------------------------</span>
3424 <a name="_sub78" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3425 <span class="comment">% Set the horizontal grid node spacing</span>
3426 
3427 <span class="comment">% Get the Application data:</span>
3428 <span class="comment">% -------------------------</span>
3429 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3430 
3431 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3432 <span class="comment">% ----------------------------------------------------------------</span>
3433 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3434 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3435 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3436 
3437 <span class="comment">% Modify the Application data:</span>
3438 <span class="comment">% ----------------------------</span>
3439 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3440     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3441     
3442     <span class="comment">% Re-store the Application data:</span>
3443     <span class="comment">% ------------------------------</span>
3444     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3445     
3446 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3447     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3448 <span class="keyword">end</span>
3449 
3450 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3451 
3452 <span class="comment">% --------------------------------------------------------------------</span>
3453 <a name="_sub79" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3454 <span class="comment">% Set the horizontal grid node spacing</span>
3455 
3456 <span class="comment">% Get the Application data:</span>
3457 <span class="comment">% -------------------------</span>
3458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3459 
3460 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3461 <span class="comment">% ----------------------------------------------------------------</span>
3462 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3463 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3464 is_positive = new_vertical_grid_node_spacing&gt;=0;
3465 
3466 <span class="comment">% Modify the Application data:</span>
3467 <span class="comment">% ----------------------------</span>
3468 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3469     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3470     
3471     <span class="comment">% Re-store the Application data:</span>
3472     <span class="comment">% ------------------------------</span>
3473     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3474     
3475 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3476     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3477 <span class="keyword">end</span>
3478 
3479 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3480 
3481 <span class="comment">% --------------------------------------------------------------------</span>
3482 <a name="_sub80" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3483 <span class="comment">% Set the cross section endpoints manually</span>
3484 
3485 <span class="comment">% Get the Application data:</span>
3486 <span class="comment">% -------------------------</span>
3487 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3488 
3489 <span class="comment">% Modify the Application data:</span>
3490 <span class="comment">% ----------------------------</span>
3491 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3492 
3493 <span class="comment">% Re-store the Application data:</span>
3494 <span class="comment">% ------------------------------</span>
3495 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3496 
3497 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3498 
3499 
3500 <span class="comment">% --------------------------------------------------------------------</span>
3501 <a name="_sub81" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3502 <a href="#_sub61" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3503 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3504 
3505 
3506 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3507 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3508 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3509 
3510 <span class="comment">% --------------------------------------------------------------------</span>
3511 <a name="_sub82" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3512 
3513 <span class="comment">% Get the Application data:</span>
3514 <span class="comment">% -------------------------</span>
3515 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3516 
3517 <span class="comment">% Modify the Application data:</span>
3518 <span class="comment">% ----------------------------</span>
3519 idx_variable = get(hObject,<span class="string">'Value'</span>);
3520 guiparams.idx_contour = idx_variable;
3521 guiparams.contour = guiparams.contours(idx_variable).variable;
3522 
3523 <span class="comment">% Re-store the Application data:</span>
3524 <span class="comment">% ------------------------------</span>
3525 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3526 
3527 <span class="comment">% [EOF] Contour_Callback</span>
3528 
3529 
3530 <span class="comment">% --------------------------------------------------------------------</span>
3531 <a name="_sub83" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3532 <span class="comment">% Set vertical exaggeration</span>
3533 
3534 <span class="comment">% Get the Application data:</span>
3535 <span class="comment">% -------------------------</span>
3536 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3537 
3538 <span class="comment">% Modify the Application data:</span>
3539 <span class="comment">% ----------------------------</span>
3540 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3541 
3542 <span class="comment">% Re-store the Application data:</span>
3543 <span class="comment">% ------------------------------</span>
3544 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3545 
3546 <span class="comment">% Update the GUI:</span>
3547 <span class="comment">% ---------------</span>
3548 <span class="comment">% updateGUI(handles,guiparams)</span>
3549 
3550 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3551 
3552 
3553 <span class="comment">% --------------------------------------------------------------------</span>
3554 <a name="_sub84" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3555 
3556 <span class="comment">% Get the Application data:</span>
3557 <span class="comment">% -------------------------</span>
3558 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3559 
3560 <span class="comment">% Modify the Application data:</span>
3561 <span class="comment">% ----------------------------</span>
3562 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3563 
3564 <span class="comment">% Re-store the Application data:</span>
3565 <span class="comment">% ------------------------------</span>
3566 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3567 
3568 <span class="comment">% Update the GUI:</span>
3569 <span class="comment">% ---------------</span>
3570 <span class="comment">% updateGUI(handles,guiparams)</span>
3571 
3572 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3573 
3574 
3575 <span class="comment">% --------------------------------------------------------------------</span>
3576 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3577 
3578 <span class="comment">% Get the Application data:</span>
3579 <span class="comment">% -------------------------</span>
3580 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3581 
3582 <span class="comment">% Modify the Application data:</span>
3583 <span class="comment">% ----------------------------</span>
3584 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3585 
3586 <span class="comment">% Re-store the Application data:</span>
3587 <span class="comment">% ------------------------------</span>
3588 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3589 
3590 <span class="comment">% Update the GUI:</span>
3591 <span class="comment">% ---------------</span>
3592 <span class="comment">% updateGUI(handles,guiparams)</span>
3593 
3594 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3595 
3596 
3597 <span class="comment">% --------------------------------------------------------------------</span>
3598 <a name="_sub86" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3599 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3600 
3601 <span class="comment">% Get the Application data:</span>
3602 <span class="comment">% -------------------------</span>
3603 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3604 
3605 <span class="comment">% Modify the Application data:</span>
3606 <span class="comment">% ----------------------------</span>
3607 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3608 
3609 <span class="comment">% Re-store the Application data:</span>
3610 <span class="comment">% ------------------------------</span>
3611 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3612 
3613 <span class="comment">% Update the GUI:</span>
3614 <span class="comment">% ---------------</span>
3615 <span class="comment">% updateGUI(handles,guiparams)</span>
3616 
3617 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3618 
3619 
3620 <span class="comment">% --------------------------------------------------------------------</span>
3621 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3622 <span class="comment">% Horizontal Smoothing</span>
3623 
3624 <span class="comment">% Get the Application data:</span>
3625 <span class="comment">% -------------------------</span>
3626 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3627 
3628 <span class="comment">% Modify the Application data:</span>
3629 <span class="comment">% ----------------------------</span>
3630 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3631 
3632 <span class="comment">% Re-store the Application data:</span>
3633 <span class="comment">% ------------------------------</span>
3634 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3635 
3636 <span class="comment">% Update the GUI:</span>
3637 <span class="comment">% ---------------</span>
3638 <span class="comment">% updateGUI(handles,guiparams)</span>
3639 
3640 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3641 
3642 
3643 <span class="comment">% --------------------------------------------------------------------</span>
3644 <a name="_sub88" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3645 <span class="comment">% Vertical Smoothing</span>
3646 
3647 <span class="comment">% Get the Application data:</span>
3648 <span class="comment">% -------------------------</span>
3649 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3650 
3651 <span class="comment">% Modify the Application data:</span>
3652 <span class="comment">% ----------------------------</span>
3653 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3654 
3655 <span class="comment">% Re-store the Application data:</span>
3656 <span class="comment">% ------------------------------</span>
3657 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3658 
3659 <span class="comment">% Update the GUI:</span>
3660 <span class="comment">% ---------------</span>
3661 <span class="comment">% updateGUI(handles,guiparams)</span>
3662 
3663 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3664 
3665 
3666 <span class="comment">% --------------------------------------------------------------------</span>
3667 <a name="_sub89" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3668 
3669 <span class="comment">% Get the Application data:</span>
3670 <span class="comment">% -------------------------</span>
3671 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3672 
3673 <span class="comment">% Modify the Application data:</span>
3674 <span class="comment">% ----------------------------</span>
3675 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3676 
3677 <span class="comment">% Re-store the Application data:</span>
3678 <span class="comment">% ------------------------------</span>
3679 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3680 
3681 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3682 
3683 
3684 <span class="comment">% --------------------------------------------------------------------</span>
3685 <a name="_sub90" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3686 
3687 <span class="comment">% Get the Application data:</span>
3688 <span class="comment">% -------------------------</span>
3689 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3690 
3691 <span class="comment">% Modify the Application data:</span>
3692 <span class="comment">% ----------------------------</span>
3693 idx_variable = get(hObject,<span class="string">'Value'</span>);
3694 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3695 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3696 
3697 <span class="comment">% Re-store the Application data:</span>
3698 <span class="comment">% ------------------------------</span>
3699 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3700 
3701 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3702 
3703 
3704 <span class="comment">% --------------------------------------------------------------------</span>
3705 <a name="_sub91" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3706 
3707 <span class="comment">% Get the Application data:</span>
3708 <span class="comment">% -------------------------</span>
3709 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3710 
3711 <span class="comment">% Modify the Application data:</span>
3712 <span class="comment">% ----------------------------</span>
3713 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3714 
3715 <span class="comment">% Re-store the Application data:</span>
3716 <span class="comment">% ------------------------------</span>
3717 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3718 
3719 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3720 
3721 
3722 <span class="comment">% --------------------------------------------------------------------</span>
3723 <a name="_sub92" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3724 <a href="#_sub63" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3725 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3726 
3727 
3728 <span class="comment">% --------------------------------------------------------------------</span>
3729 <a name="_sub93" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3730 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3731 <span class="comment">% [EOF] ClearLog_Callback</span>
3732 
3733 <span class="comment">% --------------------------------------------------------------------</span>
3734 <a name="_sub94" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3735 
3736 <span class="comment">% Get the Application data:</span>
3737 <span class="comment">% -------------------------</span>
3738 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3739 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3740 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3741 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3742 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3743 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3744 
3745 [the_file,the_path] = <span class="keyword">...</span>
3746     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3747     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3748     fullfile(guiprefs.log_path,guiprefs.log_file));
3749 
3750 <span class="comment">% Save the log to a TXT file:</span>
3751 <span class="comment">% ---------------------------</span>
3752 <span class="keyword">if</span> ischar(the_file)
3753     guiparams.log_path = the_path;
3754     guiparams.log_file = the_file;
3755     <span class="comment">%guiparams.savefile = the_file;</span>
3756     
3757     <span class="comment">% Re-store the Application data:</span>
3758     <span class="comment">% ------------------------------</span>
3759     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3760     
3761     <span class="comment">% Update the preferences:</span>
3762     <span class="comment">% -----------------------</span>
3763     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3764     guiprefs.log_path = the_path;
3765     guiprefs.log_file = the_file;
3766     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3767     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3768     
3769     [~,filename,extension] = fileparts(the_file);
3770     savefile = [the_path filename extension];
3771     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3772         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3773     
3774     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3775     [nrows,~]= size(logfile);
3776     fid = fopen(savefile, <span class="string">'w'</span>);
3777     <span class="keyword">for</span> row=1:nrows
3778         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3779     <span class="keyword">end</span>
3780     fclose(fid);
3781 <span class="keyword">end</span>
3782 <span class="comment">% [EOF] SaveLog_Callback</span>
3783 
3784 <span class="comment">%%%%%%%%%%%%%%%%</span>
3785 <span class="comment">% SUBFUNCTIONS %</span>
3786 <span class="comment">%%%%%%%%%%%%%%%%</span>
3787 
3788 <span class="comment">% --------------------------------------------------------------------</span>
3789 <a name="_sub95" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3790 
3791 icons = <a href="#_sub111" class="code" title="subfunction icons = getIcons">getIcons</a>;
3792 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3793 
3794 <span class="comment">% Load data</span>
3795 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3796 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3797 <span class="comment">% icon(icon==0) = NaN;</span>
3798 handles.toolbarLoadData = <span class="keyword">...</span>
3799     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3800     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3801     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3802 
3803 <span class="comment">% Save data</span>
3804 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3805 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3806 <span class="comment">% icon(icon==0) = NaN;</span>
3807 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3808     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3809     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3810     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3811     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3812 
3813 
3814 <span class="comment">% Save bathymetry</span>
3815 <span class="comment">%icon = ones(16,16,3);</span>
3816 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3817     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3818     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3819     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3820 
3821 <span class="comment">% Save figures</span>
3822 <span class="comment">% icon = ones(16,16,3);</span>
3823 handles.toolbarSaveFigures = <span class="keyword">...</span>
3824     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3825     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3826     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3827 
3828 <span class="comment">% Save Excel File</span>
3829 <span class="comment">% icon = ones(16,16,3);</span>
3830 handles.toolbarSaveExcel = <span class="keyword">...</span>
3831     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3832     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3833     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3834 
3835 
3836 <span class="comment">% Plotting parameters</span>
3837 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3838 <span class="comment">% icon = ind2rgb(icon,map);</span>
3839 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3840     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3841     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3842     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3843     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3844 
3845 <span class="comment">% Processing parameters</span>
3846 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3847 <span class="comment">% icon = ind2rgb(icon,map);</span>
3848 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3849     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3850     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3851     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3852 
3853 <span class="comment">% Zoom In</span>
3854 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3855 <span class="comment">% icon = ind2rgb(icon,map);</span>
3856 <span class="comment">% handles.toolbarZoomIn = ...</span>
3857 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3858 <span class="comment">%     'CData',        icons(8).data, ...</span>
3859 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3860 <span class="comment">%     'Separator',     'on');</span>
3861 
3862 <span class="comment">% Zoom Out</span>
3863 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3864 <span class="comment">% icon = ind2rgb(icon,map);</span>
3865 <span class="comment">% handles.toolbarZoomOut = ...</span>
3866 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3867 <span class="comment">%     'CData',        icons(9).data, ...</span>
3868 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3869 
3870 <span class="comment">% Pan</span>
3871 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3872 <span class="comment">% icon = ind2rgb(icon,map);</span>
3873 <span class="comment">% handles.toolbarPan = ...</span>
3874 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3875 <span class="comment">%     'CData',        icons(10).data, ...</span>
3876 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3877 
3878 
3879 
3880 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3881 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3882 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub67" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3883 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub22" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3884 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub27" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3885 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub59" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3886 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub60" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3887 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3888 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3889 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3890 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3891 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3892 
3893 <span class="comment">% [EOF] buildtoolbar</span>
3894 
3895 
3896 <span class="comment">% --------------------------------------------------------------------</span>
3897 <a name="_sub96" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3898 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3899 <span class="comment">% already exist.</span>
3900 
3901 <span class="comment">% Preferences:</span>
3902 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3903 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3904 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3905 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3906 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3907 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3908 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3909 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3910 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3911 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3912 <span class="comment">% 'renderer'             Default graphics renderer</span>
3913 <span class="comment">% 'units'                Default plotting units</span>
3914 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3915 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3916 <span class="comment">%                        started</span>
3917 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3918 
3919 <span class="comment">% Originals</span>
3920 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3921 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3922 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3923 
3924 <span class="comment">% ASCII</span>
3925 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3926     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3927     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3928         guiprefs.ascii_path = ascii.path;
3929     <span class="keyword">else</span>
3930         guiprefs.ascii_path = pwd;
3931     <span class="keyword">end</span>
3932     does_exist = false(1,length(ascii.file));
3933     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3934         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3935     <span class="keyword">end</span>
3936     <span class="keyword">if</span> any(does_exist)
3937         guiprefs.ascii_file = ascii.file(does_exist);
3938     <span class="keyword">else</span>
3939         guiprefs.ascii_file = {<span class="string">''</span>};
3940     <span class="keyword">end</span>
3941 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3942     guiprefs.ascii_path = pwd;
3943     guiprefs.ascii_file = {<span class="string">''</span>};
3944     
3945     ascii.path = pwd;
3946     ascii.file = {<span class="string">''</span>};
3947     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3948 <span class="keyword">end</span>
3949 
3950 <span class="comment">% MAT</span>
3951 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3952     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3953     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3954         guiprefs.mat_path = mat.path;
3955     <span class="keyword">else</span>
3956         guiprefs.mat_path = pwd;
3957     <span class="keyword">end</span>
3958     
3959     <span class="keyword">if</span> iscell(mat.file)
3960         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3961             guiprefs.mat_file = mat.file;
3962         <span class="keyword">else</span>
3963             guiprefs.mat_file = <span class="string">''</span>;
3964         <span class="keyword">end</span>
3965     <span class="keyword">else</span>
3966         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3967             guiprefs.mat_file = mat.file;
3968         <span class="keyword">else</span>
3969             guiprefs.mat_file = <span class="string">''</span>;
3970         <span class="keyword">end</span>
3971     <span class="keyword">end</span>
3972 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3973     guiprefs.mat_path = pwd;
3974     guiprefs.mat_file = <span class="string">''</span>;
3975     
3976     mat.path = pwd;
3977     mat.file = <span class="string">''</span>;
3978     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3979 <span class="keyword">end</span>
3980 
3981 <span class="comment">% TECPLOT</span>
3982 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3983     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3984     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3985         guiprefs.tecplot_path = tecplot.path;
3986     <span class="keyword">else</span>
3987         guiprefs.tecplot_path = pwd;
3988     <span class="keyword">end</span>
3989     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3990         guiprefs.tecplot_file = tecplot.file;
3991     <span class="keyword">else</span>
3992         guiprefs.tecplot_file = <span class="string">''</span>;
3993     <span class="keyword">end</span>
3994 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3995     guiprefs.tecplot_path = pwd;
3996     guiprefs.tecplot_file = <span class="string">''</span>;
3997     
3998     tecplot.path = pwd;
3999     tecplot.file = <span class="string">''</span>;
4000     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4001 <span class="keyword">end</span>
4002 
4003 <span class="comment">% KMZ</span>
4004 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
4005     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
4006     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
4007         guiprefs.kmz_path = kmz.path;
4008     <span class="keyword">else</span>
4009         guiprefs.kmz_path = pwd;
4010     <span class="keyword">end</span>
4011     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
4012         guiprefs.kmz_file = kmz.file;
4013     <span class="keyword">else</span>
4014         guiprefs.kmz_file = <span class="string">''</span>;
4015     <span class="keyword">end</span>
4016 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
4017     guiprefs.kmz_path = pwd;
4018     guiprefs.kmz_file = <span class="string">''</span>;
4019     
4020     kmz.path = pwd;
4021     kmz.file = <span class="string">''</span>;
4022     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4023 <span class="keyword">end</span>
4024 
4025 <span class="comment">% MULTIBEAM BATHYMETRY</span>
4026 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
4027     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
4028     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
4029         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
4030     <span class="keyword">else</span>
4031         guiprefs.multibeambathymetry_path = pwd;
4032     <span class="keyword">end</span>
4033     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
4034         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
4035     <span class="keyword">else</span>
4036         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4037     <span class="keyword">end</span>
4038 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
4039     guiprefs.multibeambathymetry_path = pwd;
4040     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4041     
4042     multibeambathymetry.path = pwd;
4043     multibeambathymetry.file = <span class="string">''</span>;
4044     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4045 <span class="keyword">end</span>
4046 
4047 <span class="comment">% Log</span>
4048 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
4049     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
4050     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
4051         guiprefs.log_path = log.path;
4052     <span class="keyword">else</span>
4053         guiprefs.log_path = pwd;
4054     <span class="keyword">end</span>
4055     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
4056         guiprefs.log_file = log.file;
4057     <span class="keyword">else</span>
4058         guiprefs.log_file = <span class="string">''</span>;
4059     <span class="keyword">end</span>
4060 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4061     guiprefs.log_path = pwd;
4062     guiprefs.log_file = <span class="string">''</span>;
4063     
4064     log.path = pwd;
4065     log.file = <span class="string">''</span>;
4066     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4067 <span class="keyword">end</span>
4068 
4069 <span class="comment">% iRic</span>
4070 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
4071     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
4072     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
4073         guiprefs.iric_path = iric.path;
4074     <span class="keyword">else</span>
4075         guiprefs.iric_path = pwd;
4076     <span class="keyword">end</span>
4077     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
4078         guiprefs.iric_file = iric.file;
4079     <span class="keyword">else</span>
4080         guiprefs.iric_file = <span class="string">''</span>;
4081     <span class="keyword">end</span>
4082 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4083     guiprefs.iric_path = pwd;
4084     guiprefs.iric_file = <span class="string">''</span>;
4085     
4086     iric.path = pwd;
4087     iric.file = <span class="string">''</span>;
4088     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4089 <span class="keyword">end</span>
4090 
4091 <span class="comment">% excel</span>
4092 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
4093     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
4094     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
4095         guiprefs.excel_path = excel.path;
4096     <span class="keyword">else</span>
4097         guiprefs.excel_path = pwd;
4098     <span class="keyword">end</span>
4099     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4100         guiprefs.excel_file = excel.file;
4101     <span class="keyword">else</span>
4102         guiprefs.excel_file = <span class="string">''</span>;
4103     <span class="keyword">end</span>
4104 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4105     guiprefs.excel_path = pwd;
4106     guiprefs.excel_file = <span class="string">''</span>;
4107     
4108     excel.path = pwd;
4109     excel.file = <span class="string">''</span>;
4110     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4111 <span class="keyword">end</span>
4112 
4113 <span class="comment">% aerial</span>
4114 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4115     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4116     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4117         guiprefs.aerial_path = aerial.path;
4118     <span class="keyword">else</span>
4119         guiprefs.aerial_path = pwd;
4120     <span class="keyword">end</span>
4121     does_exist = false(1,length(aerial.file));
4122     <span class="keyword">if</span> iscell(aerial.file)
4123     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4124         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4125     <span class="keyword">end</span>
4126     <span class="keyword">else</span>
4127         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4128     <span class="keyword">end</span>
4129     <span class="keyword">if</span> any(does_exist)
4130         guiprefs.aerial_file = aerial.file;
4131     <span class="keyword">else</span>
4132         guiprefs.aerial_file = {<span class="string">''</span>};
4133     <span class="keyword">end</span>
4134 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4135     guiprefs.aerial_path = pwd;
4136     guiprefs.aerial_file = {<span class="string">''</span>};
4137     
4138     aerial.path = pwd;
4139     aerial.file = {<span class="string">''</span>};
4140     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4141 <span class="keyword">end</span>
4142 
4143 <span class="comment">% shoreline</span>
4144 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4145     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4146     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4147         guiprefs.shoreline_path = shoreline.path;
4148     <span class="keyword">else</span>
4149         guiprefs.shoreline_path = pwd;
4150     <span class="keyword">end</span>
4151     
4152     <span class="keyword">if</span> iscell(shoreline.file)
4153         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4154             guiprefs.shoreline_file = shoreline.file;
4155         <span class="keyword">else</span>
4156             guiprefs.shoreline_file = <span class="string">''</span>;
4157         <span class="keyword">end</span>
4158     <span class="keyword">else</span>
4159         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4160             guiprefs.shoreline_file = shoreline.file;
4161         <span class="keyword">else</span>
4162             guiprefs.shoreline_file = <span class="string">''</span>;
4163         <span class="keyword">end</span>
4164     <span class="keyword">end</span>
4165 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4166     guiprefs.shoreline_path = pwd;
4167     guiprefs.shoreline_file = <span class="string">''</span>;
4168     
4169     shoreline.path = pwd;
4170     shoreline.file = <span class="string">''</span>;
4171     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4172 <span class="keyword">end</span>
4173 <span class="comment">% guiprefs.presentation = true;</span>
4174 <span class="comment">% guiprefs.print        = false;</span>
4175 
4176 <span class="comment">% for k = 1:length(prefs)</span>
4177 <span class="comment">%     newpref = '';</span>
4178 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4179 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4180 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4181 <span class="comment">%             newpref = stored_newpref;</span>
4182 <span class="comment">%         else</span>
4183 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4184 <span class="comment">%         end</span>
4185 <span class="comment">%     end</span>
4186 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4187 <span class="comment">% end</span>
4188 
4189 <span class="comment">% RENDERER</span>
4190 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4191     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4192     guiprefs.renderer = renderer;
4193 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4194     renderer           = <span class="string">'OpenGL'</span>;
4195     guiprefs.renderer  = renderer;
4196     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4197 <span class="keyword">end</span>
4198 
4199 <span class="comment">% UNITS</span>
4200 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4201     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4202     guiprefs.units = units;
4203 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4204     units           = <span class="string">'metric'</span>;
4205     guiprefs.units  = units;
4206     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4207 <span class="keyword">end</span>
4208 
4209 <span class="comment">% PLOTREF</span>
4210 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4211     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4212     guiprefs.plotref = plotref;
4213 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4214     plotref           = <span class="string">'dfs'</span>;
4215     guiprefs.plotref  = plotref;
4216     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4217 <span class="keyword">end</span>
4218 
4219 <span class="comment">% RUNCOUNTER</span>
4220 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4221     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4222     guiprefs.runcounter = runcounter;
4223 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4224     runcounter           = 1;
4225     guiprefs.runcounter  = runcounter;
4226     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4227 <span class="keyword">end</span>
4228 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4229 
4230 <span class="comment">% SETENDPOINTS</span>
4231 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4232     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4233     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4234         guiprefs.setendpoints_path = setendpoints.path;
4235     <span class="keyword">else</span>
4236         guiprefs.setendpoints_path = pwd;
4237     <span class="keyword">end</span>
4238     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4239         guiprefs.setendpoints_file = setendpoints.file;
4240     <span class="keyword">else</span>
4241         guiprefs.setendpoints_file = <span class="string">''</span>;
4242     <span class="keyword">end</span>
4243 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4244     guiprefs.setendpoints_path = pwd;
4245     guiprefs.setendpoints_file = <span class="string">''</span>;
4246     
4247     setendpoints.path = pwd;
4248     setendpoints.file = <span class="string">''</span>;
4249     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4250 <span class="keyword">end</span>
4251 
4252 <span class="comment">% [EOF] load_prefs</span>
4253 
4254 
4255 <span class="comment">% --------------------------------------------------------------------</span>
4256 <a name="_sub97" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4257 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4258 <span class="comment">% preferences data.</span>
4259 
4260 <span class="comment">% Preferences:</span>
4261 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4262 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4263 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4264 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4265 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4266 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4267 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4268 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4269 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4270 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4271 <span class="comment">% 'renderer'             Default graphics renderer</span>
4272 <span class="comment">% 'units'                Default plotting units</span>
4273 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4274 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4275 <span class="comment">%                        started</span>
4276 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4277 
4278 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4279 
4280 <span class="keyword">switch</span> pref
4281     <span class="keyword">case</span> <span class="string">'ascii'</span>
4282         ascii.path = guiprefs.ascii_path;
4283         ascii.file = guiprefs.ascii_file;
4284         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4285     <span class="keyword">case</span> <span class="string">'mat'</span>
4286         mat.path = guiprefs.mat_path;
4287         mat.file = guiprefs.mat_file;
4288         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4289     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4290         tecplot.path = guiprefs.tecplot_path;
4291         tecplot.file = guiprefs.tecplot_file;
4292         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4293     <span class="keyword">case</span> <span class="string">'kmz'</span>
4294         kmz.path = guiprefs.kmz_path;
4295         kmz.file = guiprefs.kmz_file;
4296         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4297     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4298         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4299         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4300         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4301     <span class="keyword">case</span> <span class="string">'log'</span>
4302         log.path = guiprefs.log_path;
4303         log.file = guiprefs.log_file;
4304         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4305     <span class="keyword">case</span> <span class="string">'iric'</span>
4306         iric.path = guiprefs.iric_path;
4307         iric.file = guiprefs.iric_file;
4308         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4309     <span class="keyword">case</span> <span class="string">'excel'</span>
4310         excel.path = guiprefs.excel_path;
4311         excel.file = guiprefs.excel_file;
4312         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4313     <span class="keyword">case</span> <span class="string">'aerial'</span>
4314         aerial.path = guiprefs.aerial_path;
4315         aerial.file = guiprefs.aerial_file;
4316         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4317     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4318         shoreline.path = guiprefs.shoreline_path;
4319         shoreline.file = guiprefs.shoreline_file;
4320         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4321     <span class="keyword">case</span> <span class="string">'renderer'</span>
4322         renderer = guiprefs.renderer;
4323         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4324     <span class="keyword">case</span> <span class="string">'units'</span>
4325         units = guiprefs.units;
4326         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4327     <span class="keyword">case</span> <span class="string">'plotref'</span>
4328         plotref = guiprefs.plotref;
4329         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4330     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4331         runcounter = guiprefs.runcounter;
4332         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4333     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4334         setendpoints.path = guiprefs.setendpoints_path;
4335         setendpoints.file = guiprefs.setendpoints_file;
4336         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4337     <span class="keyword">otherwise</span>
4338 <span class="keyword">end</span>
4339 
4340 <span class="comment">% if ismember(pref,prefs)</span>
4341 <span class="comment">%     setpref('VMT',pref,value)</span>
4342 <span class="comment">%</span>
4343 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4344 <span class="comment">%     guiprefs.(pref) = value;</span>
4345 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4346 <span class="comment">% end</span>
4347 
4348 <span class="comment">% [EOF] store_prefs</span>
4349 
4350 
4351 <span class="comment">% --------------------------------------------------------------------</span>
4352 <a name="_sub98" href="#_subfunctions" class="code">function initGUI(handles)</a>
4353 <span class="comment">% Initialize the UI controls in the GUI.</span>
4354 
4355 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4356 
4357 <span class="comment">% Set the name and version</span>
4358 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4359     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4360 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4361 
4362 <span class="comment">% Set the PLOT 1 axis labels</span>
4363 axes(handles.Plot1Shiptracks);
4364 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4365 xlabel(<span class="string">'UTM Easting (m)'</span>)
4366 ylabel(<span class="string">'UTM Northing (m)'</span>)
4367 box on
4368 grid on
4369 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4370 
4371 <span class="comment">%%%%%%%%%%%%</span>
4372 <span class="comment">% MENU BAR %</span>
4373 <span class="comment">%%%%%%%%%%%%</span>
4374 <span class="keyword">if</span> guiparams.english_units
4375     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4376     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4377 <span class="keyword">else</span>
4378     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4379     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4380 <span class="keyword">end</span>
4381 
4382 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4383     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4384     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4385 <span class="keyword">else</span>
4386     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4387     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4388 <span class="keyword">end</span>
4389 
4390 
4391 <span class="keyword">if</span> guiparams.print
4392     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4393     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4394     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4395     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4396 <span class="keyword">elseif</span> guiparams.presentation
4397     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4398     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4399     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4400     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4401 <span class="keyword">else</span>
4402 <span class="keyword">end</span>
4403 
4404 <span class="keyword">switch</span> guiparams.renderer
4405     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4406         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4407         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4408         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4409     <span class="keyword">case</span> <span class="string">'painters'</span>
4410         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4411         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4412         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4413     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4414         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4415         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4416         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4417 <span class="keyword">end</span>
4418 
4419 
4420 <span class="comment">%%%%%%%%%%%%%%%</span>
4421 <span class="comment">% DATA EXPORT %</span>
4422 <span class="comment">%%%%%%%%%%%%%%%</span>
4423 <span class="comment">% BathymetryPanel</span>
4424 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4425 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4426 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4427 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4428 
4429 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4430 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4431 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4432 <span class="comment">% PlanViewPanel</span>
4433 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4434 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4435 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4436 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4437 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4438 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4439 
4440 
4441 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4442 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4443 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4444 <span class="comment">% ShiptracksPanel</span>
4445 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4446 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4447 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4448 
4449 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4450 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4451 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4452 <span class="comment">% CrossSectionsPanel</span>
4453 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4454     <span class="string">'Value'</span>, guiparams.idx_contour)
4455 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4456 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4457 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4458 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4459 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4460 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4461 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4462 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4463     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4464 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4465 
4466 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4467 
4468 <span class="comment">% [EOF] initGUI</span>
4469 
4470 
4471 <span class="comment">% --------------------------------------------------------------------</span>
4472 <a name="_sub99" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4473 
4474 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4475 
4476 <span class="keyword">switch</span> enable_state
4477     <span class="keyword">case</span> <span class="string">'init'</span>
4478         guiparams.gui_state = <span class="string">'init'</span>;
4479         set([handles.menuFile
4480             handles.menuOpen
4481             handles.menuOpenASCII
4482             handles.menuOpenMAT
4483             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4484         
4485         set([handles.toolbarLoadData
4486             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4487         set([handles.toolbarSaveMatFile
4488             handles.toolbarSaveBathymetry
4489             handles.toolbarSaveFigures
4490             handles.toolbarSaveExcel
4491             handles.toolbarPlottingParameters
4492             handles.toolbarProcessingParameters
4493             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4494         
4495         set([handles.DepthRangeMin
4496             handles.DepthRangeMax
4497             handles.VectorScalePlanView
4498             handles.VectorSpacingPlanview
4499             handles.SmoothingWindowSize
4500             handles.AddBackground
4501             handles.PlotPlanView
4502             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4503       
4504         set([handles.HorizontalGridNodeSpacing
4505             handles.VerticalGridNodeSpacing
4506             handles.PlotShiptracks
4507             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4508         
4509         set([handles.Contour
4510             handles.VerticalExaggeration
4511             handles.VectorScaleCrossSection
4512             handles.HorizontalVectorSpacing
4513             handles.VerticalVectorSpacing
4514             handles.HorizontalSmoothingWindow
4515             handles.VerticalSmoothingWindow
4516             handles.PlotSecondaryFlowVectors
4517             handles.SecondaryFlowVectorVariable
4518             handles.IncludeVerticalVelocity
4519             handles.IncludeVerticalVelocityText
4520             handles.PlotCrossSection
4521             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4522         
4523     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4524         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4525         set([handles.menuFile
4526             handles.menuOpen
4527             handles.menuOpenASCII
4528             handles.menuOpenMAT
4529             handles.menuSaveMAT
4530             handles.menuSaveTecplot
4531             handles.menuSaveKMZFile
4532             handles.menuSettings
4533             handles.menuPlottingParameters
4534             handles.menuMetric
4535             handles.menuEnglish
4536             handles.menuBathymetryExportSettings
4537             handles.menuExportMultibeamBathymetry
4538             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4539             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4540         
4541         set([handles.toolbarLoadData
4542             handles.toolbarSaveMatFile
4543             handles.toolbarSaveBathymetry
4544             handles.toolbarSaveExcel
4545             handles.toolbarSaveFigures
4546             handles.toolbarPlottingParameters
4547             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4548         set([handles.toolbarProcessingParameters
4549             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4550         
4551            
4552         set([handles.DepthRangeMin
4553             handles.DepthRangeMax
4554             handles.VectorScalePlanView
4555             handles.VectorSpacingPlanview
4556             handles.SmoothingWindowSize
4557             handles.PlotPlanView
4558             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4559         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4560             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4561         <span class="keyword">else</span>
4562             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4563         <span class="keyword">end</span>
4564         
4565         set([handles.HorizontalGridNodeSpacing
4566             handles.VerticalGridNodeSpacing
4567             handles.PlotShiptracks
4568             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4569         
4570         set([handles.Contour
4571             handles.VerticalExaggeration
4572             handles.VectorScaleCrossSection
4573             handles.HorizontalVectorSpacing
4574             handles.VerticalVectorSpacing
4575             handles.HorizontalSmoothingWindow
4576             handles.VerticalSmoothingWindow
4577             handles.PlotSecondaryFlowVectors
4578             handles.SecondaryFlowVectorVariable
4579             handles.IncludeVerticalVelocity
4580             handles.IncludeVerticalVelocityText
4581             handles.PlotCrossSection
4582             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4583     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4584         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4585         set([handles.menuFile
4586             handles.menuOpen
4587             handles.menuOpenASCII
4588             handles.menuOpenMAT
4589             handles.menuSettings
4590             handles.menuPlottingParameters
4591             handles.menuMetric
4592             handles.menuEnglish
4593             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4594         set([handles.menuSaveMAT
4595             handles.menuBathymetryExportSettings
4596             handles.menuExportMultibeamBathymetry
4597             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4598             handles.menuSaveKMZFile
4599             handles.menuSaveTecplot
4600             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4601         
4602         set([handles.toolbarLoadData
4603             handles.toolbarSaveFigures
4604             handles.toolbarPlottingParameters
4605             handles.toolbarSaveExcel
4606             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4607         set([handles.toolbarProcessingParameters
4608             handles.toolbarSaveMatFile
4609             handles.toolbarSaveBathymetry
4610             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4611         
4612         set([handles.DepthRangeMin
4613             handles.DepthRangeMax
4614             handles.VectorScalePlanView
4615             handles.VectorSpacingPlanview
4616             handles.SmoothingWindowSize
4617             handles.PlotPlanView
4618             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4619         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4620             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4621         <span class="keyword">else</span>
4622             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4623         <span class="keyword">end</span>
4624         
4625         set([handles.HorizontalGridNodeSpacing
4626             handles.VerticalGridNodeSpacing
4627             handles.PlotShiptracks
4628             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4629         
4630         set([handles.Contour
4631             handles.VerticalExaggeration
4632             handles.VectorScaleCrossSection
4633             handles.HorizontalVectorSpacing
4634             handles.VerticalVectorSpacing
4635             handles.HorizontalSmoothingWindow
4636             handles.VerticalSmoothingWindow
4637             handles.PlotSecondaryFlowVectors
4638             handles.SecondaryFlowVectorVariable
4639             handles.IncludeVerticalVelocity
4640             handles.IncludeVerticalVelocityText
4641             handles.PlotCrossSection
4642             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4643     <span class="keyword">otherwise</span>
4644 <span class="keyword">end</span>
4645 
4646 <span class="comment">% Save Application Data</span>
4647 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4648 
4649 <span class="comment">% [EOF] set_enable</span>
4650 
4651 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4652 
4653 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4654 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4655 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4656 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4657 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4658 
4659 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4660 
4661 
4662 <span class="comment">% --------------------------------------------------------------------</span>
4663 <a name="_sub100" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4664     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4665 
4666 w = 500;
4667 h = 110;
4668 dx = 10;
4669 dy = 35;
4670 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4671 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4672     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4673     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4674     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4675     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4676     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4677     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4678     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4679     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4680     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4681     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4682 dialog_params.english_units               = english_units;
4683 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4684 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4685 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4686 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4687 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4688 
4689 <span class="comment">% Build the graphics:</span>
4690 <span class="comment">% -------------------</span>
4691 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4692     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4693     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4694     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4695 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4696     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4697     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4698     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4699     <span class="string">'Position'</span>,[15 35 100 22]);
4700 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4701     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4702     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4703     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4704     <span class="string">'Position'</span>,[15 10 100 22]);
4705 
4706 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4707     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4708     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4709     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4710 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4711     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4712     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4713     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4714     <span class="string">'Position'</span>,[15 35 100 22]);
4715 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4716     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4717     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4718     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4719     <span class="string">'Position'</span>,[15 10 100 22]);
4720 
4721 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4722     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4723     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4724     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4725 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4726     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4727     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4728     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4729     <span class="string">'Position'</span>,[15 35 100 22]);
4730 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4731     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4732     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4733     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4734     <span class="string">'Position'</span>,[15 10 100 22]);
4735 
4736 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4737     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4738     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4739     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4740     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4741 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4742     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4743     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4744     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4745     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4746 
4747 <span class="comment">% Update the UI controls:</span>
4748 <span class="comment">% -----------------------</span>
4749 <span class="keyword">if</span> dialog_params.english_units
4750     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4751     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4752 <span class="keyword">else</span>
4753     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4754     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4755 <span class="keyword">end</span>
4756 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4757     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4758     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4759 <span class="keyword">else</span>
4760     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4761     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4762 <span class="keyword">end</span>
4763 <span class="keyword">if</span> dialog_params.presentation
4764     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4765     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4766 <span class="keyword">else</span>
4767     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4768     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4769 <span class="keyword">end</span>
4770 
4771 <span class="comment">% Set the callbacks:</span>
4772 <span class="comment">% ------------------</span>
4773 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4774 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4775 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4776 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4777 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4778 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4779 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4780 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4781 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4782 
4783 <span class="comment">% Position the dialog and make it visible:</span>
4784 <span class="comment">% ----------------------------------------</span>
4785 fpos = get(hf,<span class="string">'Position'</span>);
4786 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4787 movegui(handles.Figure,dpos)
4788 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4789 
4790 <span class="comment">% Hold the dialog open:</span>
4791 <span class="comment">% ---------------------</span>
4792 waitfor(handles.OK)
4793 
4794 <span class="comment">% Return the outputs and close the dialog:</span>
4795 <span class="comment">% ----------------------------------------</span>
4796 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4797 english_units = dialog_params.english_units;
4798 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4799 plot_presentation_style =  dialog_params.presentation;
4800 plot_print_style =  dialog_params.print;
4801 
4802 delete(handles.Figure)
4803 
4804 <span class="comment">% [EOF] plotParametersDialog</span>
4805 
4806 
4807 <span class="comment">% --------------------------------------------------------------------</span>
4808 <a name="_sub101" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4809 
4810 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4811 <span class="keyword">switch</span> the_units
4812     <span class="keyword">case</span> <span class="string">'metric'</span>
4813         dialog_params.english_units = false;
4814         
4815         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4816         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4817     <span class="keyword">case</span> <span class="string">'english'</span>
4818         dialog_params.english_units = true;
4819         
4820         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4821         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4822     <span class="keyword">otherwise</span>
4823 <span class="keyword">end</span>
4824 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4825 
4826 <span class="comment">% [EOF] dialogUnits</span>
4827 
4828 <span class="comment">% --------------------------------------------------------------------</span>
4829 <a name="_sub102" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4830 
4831 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4832 <span class="keyword">switch</span> the_endpoints
4833     <span class="keyword">case</span> <span class="string">'auto'</span>
4834         dialog_params.set_cross_section_endpoints = false;
4835         
4836         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4837         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4838     <span class="keyword">case</span> <span class="string">'manual'</span>
4839         dialog_params.set_cross_section_endpoints = true;
4840         
4841         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4842         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4843     <span class="keyword">otherwise</span>
4844 <span class="keyword">end</span>
4845 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4846 
4847 <span class="comment">% [EOF] dialogEnpoints</span>
4848 
4849 <a name="_sub103" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4850 
4851 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4852 <span class="keyword">switch</span> the_style
4853     <span class="keyword">case</span> <span class="string">'presentation'</span>
4854         dialog_params.presentation  = true;
4855         dialog_params.print         = false;
4856         
4857         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4858         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4859     <span class="keyword">case</span> <span class="string">'print'</span>
4860         dialog_params.presentation  = false;
4861         dialog_params.print         = true;
4862         
4863         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4864         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4865     <span class="keyword">otherwise</span>
4866 <span class="keyword">end</span>
4867 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4868 
4869 <span class="comment">% [EOF] dialogEnpoints</span>
4870 
4871 <span class="comment">% --------------------------------------------------------------------</span>
4872 <a name="_sub104" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4873 
4874 delete(h_OK)
4875 
4876 <span class="comment">% [EOF] dialogOK</span>
4877 
4878 <span class="comment">% --------------------------------------------------------------------</span>
4879 <a name="_sub105" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4880 <span class="comment">% Return the original inputs</span>
4881 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4882 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4883 delete(handles.OK)
4884 
4885 <span class="comment">% [EOF] dialogCancel</span>
4886 
4887 <span class="comment">% --------------------------------------------------------------------</span>
4888 <a name="_sub106" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4889 
4890 delete(h_OK)
4891 
4892 <span class="comment">% [EOF] dialogCloseReq</span>
4893 
4894 <a name="_sub107" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4895     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4896 w = 230;
4897 h = 245;
4898 dx = 10;
4899 dy = 35;
4900 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4901 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4902     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4903     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4904     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4905     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4906     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4907     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4908     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4909     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4910     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4911     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4912 dialog_params.beam_angle             = beam_angle;
4913 dialog_params.magnetic_variation     = magnetic_variation;
4914 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4915     dialog_params.wse                = <span class="string">'tide'</span>;
4916     wse_string                       = <span class="string">'tide'</span>;
4917 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4918     dialog_params.wse                = <span class="string">'tide'</span>;
4919     wse_string                       = <span class="string">'tide'</span>;
4920 <span class="keyword">else</span>
4921     dialog_params.wse                = wse;
4922     wse_string                       = num2str(wse);
4923 <span class="keyword">end</span>
4924 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4925 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4926 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4927 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4928 
4929 <span class="comment">% Build the graphics:</span>
4930 <span class="comment">% -------------------</span>
4931 ph = 150;
4932 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4933     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4934     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4935     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4936 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4937     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4938     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4939     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4940     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4941     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4942     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4943 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4944     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4945     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4946     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4947     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4948     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4949     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4950 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4951     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4952     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4953     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4954     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4955     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4956     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4957 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4958     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4959     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4960     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4961     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4962     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4963     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4964 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4965     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4966     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4967     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4968     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4969     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4970     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4971 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4972     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4973     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4974     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4975     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4976     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4977     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4978 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4979     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4980     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4981     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4982     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4983 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4984     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4985     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4986     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4987     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4988 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4989     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4990     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4991     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4992     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4993 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4994     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4995     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4996     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4997     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4998 
4999 <span class="comment">% Update the UI controls:</span>
5000 <span class="comment">% -----------------------</span>
5001 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
5002 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
5003 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
5004 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
5005 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
5006 
5007 <span class="comment">% Set the callbacks:</span>
5008 <span class="comment">% ------------------</span>
5009 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5010 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5011 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5012 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5013 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5014 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5015 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
5016 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
5017 
5018 <span class="comment">% Position the dialog and make it visible:</span>
5019 <span class="comment">% ----------------------------------------</span>
5020 fpos = get(hf,<span class="string">'Position'</span>);
5021 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5022 movegui(handles.Figure,dpos)
5023 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5024 
5025 <span class="comment">% Hold the dialog open:</span>
5026 <span class="comment">% ---------------------</span>
5027 waitfor(handles.OK)
5028 
5029 <span class="comment">% Return the outputs and close the dialog:</span>
5030 <span class="comment">% ----------------------------------------</span>
5031 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5032 beam_angle              = dialog_params.beam_angle;
5033 magnetic_variation      = dialog_params.magnetic_variation;
5034 wse                     = dialog_params.wse;
5035 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
5036 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
5037 
5038 delete(handles.Figure)
5039 
5040 <span class="comment">% [EOF] exportSettingsDialog</span>
5041 
5042 <span class="comment">% --------------------------------------------------------------------</span>
5043 <a name="_sub108" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
5044 
5045 <span class="comment">% Grab the current data</span>
5046 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5047 
5048 <span class="comment">% Set it according to the dialog box values</span>
5049 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
5050 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
5051 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
5052 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
5053 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
5054 
5055 <span class="comment">% Re-store the application data</span>
5056 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5057 
5058 <span class="comment">% [EOF] dialogExportSettings</span>
5059 
5060 <a name="_sub109" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
5061 
5062 w = 230;
5063 h = 200;
5064 dx = 10;
5065 dy = 35;
5066 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
5067 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
5068     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
5069     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5070     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
5071     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
5072     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5073     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5074     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5075     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
5076     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5077     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
5078 dialog_params.figure_names               = figure_names;
5079 dialog_params.selected_figures           = <span class="string">''</span>;
5080 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5081 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5082 
5083 <span class="comment">% Build the graphics:</span>
5084 <span class="comment">% -------------------</span>
5085 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5086     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
5087     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5088     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5089 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
5090     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
5091     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
5092     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
5093     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
5094     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
5095     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5096     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5097 
5098 
5099 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5100     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5101     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5102     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5103     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5104 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5105     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5106     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5107     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5108     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5109 
5110 <span class="comment">% Update the UI controls:</span>
5111 <span class="comment">% -----------------------</span>
5112 
5113 
5114 <span class="comment">% Set the callbacks:</span>
5115 <span class="comment">% ------------------</span>
5116 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5117 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5118 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5119 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5120 
5121 <span class="comment">% Position the dialog and make it visible:</span>
5122 <span class="comment">% ----------------------------------------</span>
5123 fpos = get(hf,<span class="string">'Position'</span>);
5124 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5125 movegui(handles.Figure,dpos)
5126 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5127 
5128 <span class="comment">% Hold the dialog open:</span>
5129 <span class="comment">% ---------------------</span>
5130 waitfor(handles.OK)
5131 
5132 <span class="comment">% Return the outputs and close the dialog:</span>
5133 <span class="comment">% ----------------------------------------</span>
5134 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5135 selected_figures = dialog_params.selected_figures;
5136 
5137 delete(handles.Figure)
5138 
5139 <span class="comment">% [EOF] openFiguresDialog</span>
5140 
5141 <span class="comment">% --------------------------------------------------------------------</span>
5142 <a name="_sub110" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5143 
5144 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5145 
5146 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5147 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5148 selected     = fig_names(idx_selected);
5149 dialog_params.selected_figures = selected;
5150 
5151 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5152 
5153 
5154 
5155 <span class="comment">% --------------------------------------------------------------------</span>
5156 <a name="_sub111" href="#_subfunctions" class="code">function icons = getIcons</a>
5157 
5158 <span class="comment">% Load data</span>
5159 idx = 1;
5160 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5161     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5162     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5163     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5164     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5165     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5166     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5167     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5168     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5169     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5170     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5171     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5172     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5173     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5174     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5175     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5176     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5177 
5178 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5179     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5180     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5181     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5182     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5183     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5184     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5185     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5186     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5187     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5188     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5189     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5190     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5191     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5192     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5193     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5194     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5195 
5196 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5197     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5198     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5199     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5200     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5201     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5202     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5203     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5204     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5205     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5206     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5207     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5208     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5209     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5210     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5211     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5212     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5213 
5214 <span class="comment">% Save data</span>
5215 idx = idx+1;
5216 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5217     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5218     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5219     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5220     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5221     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5222     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5223     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5224     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5225     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5226     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5227     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5228     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5229     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5230     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5231     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5232     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5233 
5234 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5235     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5236     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5237     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5238     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5239     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5240     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5241     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5242     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5243     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5244     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5245     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5246     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5247     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5248     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5249     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5250     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5251 
5252 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5253     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5254     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5255     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5256     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5257     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5258     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5259     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5260     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5261     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5262     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5263     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5264     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5265     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5266     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5267     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5268     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5269 
5270 <span class="comment">% Plotting parameters</span>
5271 idx = idx+1;
5272 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5273     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5274     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5275     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5276     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5277     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5278     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5279     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5280     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5281     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5282     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5283     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5284     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5285     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5286     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5287     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5288     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5289 
5290 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5291     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5292     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5293     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5294     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5295     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5296     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5297     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5298     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5299     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5300     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5301     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5302     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5303     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5304     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5305     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5306     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5307 
5308 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5309     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5310     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5311     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5312     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5313     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5314     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5315     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5316     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5317     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5318     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5319     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5320     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5321     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5322     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5323     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5324     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5325 
5326 <span class="comment">% Processing parameters</span>
5327 idx = idx+1;
5328 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5329     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5330     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5331     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5332     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5333     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5334     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5335     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5336     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5337     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5338     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5339     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5340     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5341     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5342     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5343     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5344     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5345 
5346 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5347     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5348     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5349     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5350     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5351     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5352     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5353     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5354     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5355     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5356     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5357     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5358     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5359     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5360     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5361     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5362     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5363 
5364 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5365     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5366     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5367     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5368     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5369     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5370     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5371     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5372     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5373     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5374     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5375     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5376     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5377     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5378     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5379     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5380     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5381 
5382 <span class="comment">% Export bathymetry dialog</span>
5383 idx = idx+1;
5384 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5385     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5386     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5387     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5388     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5389     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5390     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5391     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5392     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5393     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5394     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5395     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5396     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5397     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5398     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5399     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5400     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5401     ]/255;
5402 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5403     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5404     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5405     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5406     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5407     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5408     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5409     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5410     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5411     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5412     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5413     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5414     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5415     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5416     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5417     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5418     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5419     ]/255;
5420 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5421     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5422     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5423     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5424     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5425     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5426     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5427     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5428     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5429     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5430     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5431     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5432     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5433     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5434     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5435     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5436     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5437     ]/255;
5438 
5439 <span class="comment">% Export Figures Dialog</span>
5440 idx = idx + 1;
5441 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5442     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5443     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5444     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5445     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5446     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5447     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5448     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5449     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5450     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5451     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5452     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5453     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5454     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5455     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5456     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5457 
5458 
5459 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5460     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5461     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5462     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5463     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5464     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5465     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5466     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5467     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5468     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5469     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5470     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5471     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5472     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5473     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5474     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5475 
5476 
5477 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5478     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5479     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5480     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5481     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5482     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5483     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5484     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5485     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5486     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5487     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5488     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5489     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5490     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5491     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5492     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5493 
5494 <span class="comment">% Export Excel File</span>
5495 idx = idx + 1;
5496 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5497     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5498    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5499    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5500    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5501    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5502    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5503    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5504    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5505    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5506    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5507    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5508    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5509    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5510    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5511    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5512     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5513 
5514 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5515     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5516    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5517    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5518    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5519    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5520    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5521    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5522    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5523    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5524    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5525    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5526    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5527    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5528    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5529    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5530     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5531 
5532 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5533     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5534    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5535    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5536    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5537    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5538    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5539    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5540    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5541    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5542    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5543    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5544    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5545    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5546    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5547    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5548     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5549 
5550 <span class="comment">% Zoom In</span>
5551 idx = idx + 1;
5552 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5553     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5554 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5555     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5556 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5557     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5558 
5559 <span class="comment">% Zoom Out</span>
5560 idx = idx + 1;
5561 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5562     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5563 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5564     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5565 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5566     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5567 
5568 <span class="comment">% Pan</span>
5569 idx = idx + 1;
5570 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5571     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5572 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5573     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5574 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5575     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5576 <span class="comment">% [EOF] getIcons</span>
5577 
5578 <a name="_sub112" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5579 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5580 
5581 <span class="comment">% Check for any stored prefs</span>
5582 <span class="comment">% --------------------------</span>
5583 <span class="comment">% Units and the graphics renderer are stored as persistent prefs</span>
5584 guiprefs = getpref(<span class="string">'VMT'</span>);
5585 
5586 <span class="comment">% Organized by GUI panels</span>
5587 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5588 <span class="comment">% SHIPTRACKS PLOT %</span>
5589 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5590 guiparams.horizontal_grid_node_spacing       = 1.0;
5591 guiparams.vertical_grid_node_spacing         = 0.4;
5592 
5593 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5594 <span class="comment">% CROSS SECTION PLOT %</span>
5595 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5596 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5597 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5598 guiparams.idx_contour                        = 1;
5599 guiparams.vertical_exaggeration              = 10;
5600 guiparams.vector_scale_cross_section         = 0.2;
5601 guiparams.horizontal_vector_spacing          = 1;
5602 guiparams.vertical_vector_spacing            = 1;
5603 guiparams.horizontal_smoothing_window        = 1;
5604 guiparams.vertical_smoothing_window          = 1;
5605 guiparams.plot_secondary_flow_vectors        = true;
5606 guiparams.allow_vmt_flip_flux                = true;
5607 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5608 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5609 guiparams.idx_secondary_flow_vector_variable = 1;
5610 guiparams.include_vertical_velocity          = true;
5611 
5612 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5613 <span class="comment">% PLAN VIEW PLOT %</span>
5614 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5615 guiparams.depth_range_min                    = 0;
5616 guiparams.depth_range_max                    = inf;
5617 guiparams.vector_scale_plan_view             = 1;
5618 guiparams.vector_spacing_plan_view           = 1;
5619 guiparams.smoothing_window_size              = 1;
5620 guiparams.display_shoreline                  = false;
5621 guiparams.add_background                     = false;
5622 
5623 <span class="comment">%%%%%%%%%%%</span>
5624 <span class="comment">% OFFSETS %</span>
5625 <span class="comment">%%%%%%%%%%%</span>
5626 guiparams.water_surface_elevation            = 0.0;
5627 guiparams.bed_elevation                      = 0.0;
5628 guiparams.KMZ_vertical_offset                = 0.0;
5629 
5630 <span class="comment">%%%%%%%%%%%%%%%</span>
5631 <span class="comment">% DATA EXPORT %</span>
5632 <span class="comment">%%%%%%%%%%%%%%%</span>
5633 guiparams.beam_angle                         = 20.0;
5634 guiparams.magnetic_variation                 = 0.0;
5635 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5636 guiparams.load_wse_tide_file                 = false;
5637 guiparams.output_auxiliary_data              = false;
5638 
5639 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5640 <span class="comment">% Contour variables %</span>
5641 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5642 idx = 1;
5643 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5644 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5645 idx = idx + 1;
5646 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5647 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5648 idx = idx + 1;
5649 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5650 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5651 idx = idx + 1;
5652 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5653 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5654 idx = idx + 1;
5655 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5656 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5657 idx = idx + 1;
5658 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5659 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5660 idx = idx + 1;
5661 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5662 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5663 idx = idx + 1;
5664 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5665 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5666 idx = idx + 1;
5667 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5668 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5669 idx = idx + 1;
5670 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5671 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5672 idx = idx + 1;
5673 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5674 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5675 idx = idx + 1;
5676 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5677 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5678 idx = idx + 1;
5679 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5680 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5681 idx = idx + 1;
5682 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5683 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5684 idx = idx + 1;
5685 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5686 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5687 idx = idx + 1;
5688 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5689 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5690 idx = idx + 1;
5691 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5692 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5693 idx = idx + 1;
5694 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5695 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5696 idx = idx + 1;
5697 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5698 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5699 idx = idx + 1;
5700 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5701 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5702 
5703 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5704 
5705 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5706 <span class="comment">% Secondary Flow Vector Variables %</span>
5707 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5708 idx = 1;
5709 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5710 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5711 idx = idx + 1;
5712 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5713 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5714 idx = idx + 1;
5715 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5716 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5717 idx = idx + 1;
5718 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5719 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5720 idx = idx + 1;
5721 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5722 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5723 
5724 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5725     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5726 
5727 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5728 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5729 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5730 <span class="comment">% Menu bar options</span>
5731 guiparams.presentation                       = true;
5732 guiparams.print                              = false;
5733 guiparams.set_cross_section_endpoints        = false;
5734 guiparams.unit_discharge_correction          = false;
5735 guiparams.start_bank                         = <span class="string">'auto'</span>;
5736 
5737 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5738     <span class="keyword">switch</span> guiprefs.units
5739         <span class="keyword">case</span> <span class="string">'metric'</span>
5740             guiparams.english_units          = false;
5741         <span class="keyword">case</span> <span class="string">'english'</span>
5742             guiparams.english_units          = true;
5743     <span class="keyword">end</span>
5744 <span class="keyword">else</span>
5745     guiparams.english_units                  = false;
5746 <span class="keyword">end</span>
5747 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5748     <span class="keyword">switch</span> guiprefs.plotref
5749         <span class="keyword">case</span> <span class="string">'dfs'</span>
5750             guiparams.plotref                 = <span class="string">'dfs'</span>;
5751         <span class="keyword">case</span> <span class="string">'hab'</span>
5752             guiparams.plotref                 = <span class="string">'hab'</span>;
5753     <span class="keyword">end</span>
5754 <span class="keyword">else</span>
5755     guiparams.plotref                         = <span class="string">'dfs'</span>;
5756 <span class="keyword">end</span>
5757 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5758 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5759 
5760 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5761     guiparams.renderer                       = guiprefs.renderer;
5762 <span class="keyword">else</span>
5763     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5764 <span class="keyword">end</span>
5765 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5766 <span class="comment">% guiparams.plot_planview                      = false;</span>
5767 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5768 
5769 <span class="comment">% File location defaults</span>
5770 guiparams.ascii_path                        = pwd;
5771 guiparams.ascii_file                        = <span class="string">''</span>;
5772 guiparams.mat_path                          = pwd;
5773 guiparams.mat_file                          = <span class="string">''</span>;
5774 guiparams.tecplot_path                      = pwd;
5775 guiparams.tecplot_file                      = <span class="string">''</span>;
5776 guiparams.kmz_path                          = pwd;
5777 guiparams.kmz_file                          = <span class="string">''</span>;
5778 guiparams.multibeambathymetry_path          = pwd;
5779 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5780 guiparams.log_path                          = pwd;
5781 guiparams.log_file                          = <span class="string">''</span>;
5782 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5783 <span class="comment">% application</span>
5784 <span class="keyword">if</span> isdeployed 
5785     guiparams.has_mapping_toolbox           = true;
5786 <span class="keyword">else</span>
5787     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5788         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5789 <span class="keyword">end</span>
5790 
5791 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5792 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5793 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5794 guiparams.z                      = [];
5795 guiparams.A                      = [];
5796 guiparams.V                      = [];
5797 guiparams.Map                    = [];
5798 guiparams.savefile               = [];
5799 guiparams.iric_anv_planview_data = [];
5800 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5801 <span class="comment">% guiparams.zmax = [];</span>
5802 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5803 guiparams.data_folder = <span class="string">''</span>;
5804 guiparams.data_files  = {<span class="string">''</span>};
5805 guiparams.gui_state   = <span class="string">'init'</span>;
5806 
5807 <span class="comment">% [EOF] createGUIparams</span>
5808 
5809 <a name="_sub113" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5810 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5811 
5812 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5813 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5814 
5815 <span class="comment">% [EOF] VMT</span>
5816 
5817 
5818 
5819 <span class="comment">% --- Hidden keyboard commands</span>
5820 <a name="_sub115" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5821 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5822 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5823 <span class="comment">%</span>
5824 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5825 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5826 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5827 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5828 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5829 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5830 
5831 in1 = eventdata.Modifier; 
5832 in2 = eventdata.Key;
5833 
5834 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5835     input = [in1{:} in2];
5836 <span class="keyword">else</span>
5837     input = in2;
5838 <span class="keyword">end</span>
5839 
5840 <span class="keyword">switch</span> input
5841     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5842         <a href="#_sub52" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5843         
5844     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5845         VMT_BuildCustomFlatFile;
5846     <span class="keyword">otherwise</span>
5847         <span class="comment">%disp(input)</span>
5848 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 26-Apr-2017 15:36:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>