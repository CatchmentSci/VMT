<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub96" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub97" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub98" class="code">function initGUI(handles)</a></li><li><a href="#_sub99" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub100" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub101" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub102" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub103" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub104" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub106" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub108" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub110" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function icons = getIcons</a></li><li><a href="#_sub112" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub113" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub114" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub95" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub96" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub112" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.07'</span>; <span class="string">'r20150109'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub98" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub109" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.wse;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.wse = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.wse = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">end</span>
0651 <span class="comment">%  [EOF] loadTideFile</span>
0652 
0653 <span class="comment">% --------------------------------------------------------------------</span>
0654 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0655 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0656 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0657 
0658 
0659 <span class="comment">% --------------------------------------------------------------------</span>
0660 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0661 
0662 <span class="comment">% Get the Application Data:</span>
0663 <span class="comment">% -------------------------</span>
0664 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0665 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0666 PVdata    = guiparams.iric_anv_planview_data;
0667 iric_path = guiprefs.iric_path;
0668 iric_file = guiprefs.iric_file;
0669 
0670 <span class="comment">% Is there any planview data?</span>
0671 <span class="keyword">if</span> isempty(PVdata)
0672     <span class="comment">% Nothing to do, warn user</span>
0673     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0674     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0675 <span class="keyword">else</span>
0676     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0677     <span class="comment">% and smoothing (for iRiC)</span>
0678     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0679     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0680         fullfile(iric_path,iric_file));
0681     
0682     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0683         outfile = fullfile(iric_path,iric_file);
0684         log_text = vertcat(log_text,{outfile});
0685         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0686         outcount = fprintf(ofid,<span class="keyword">...</span>
0687             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0688         fclose(ofid);
0689     <span class="keyword">else</span>
0690         <span class="comment">% Return default iric_path and iric_file</span>
0691         iric_path = guiprefs.iric_path;
0692         iric_file = guiprefs.iric_file;
0693     <span class="keyword">end</span>
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% Push messages to Log Window:</span>
0697 <span class="comment">% ----------------------------</span>
0698 statusLogging(handles.LogWindow, log_text)
0699 
0700 <span class="comment">% Store the persistent preferences:</span>
0701 <span class="comment">% ---------------------------------</span>
0702 guiprefs.iric_file = iric_file;
0703 guiprefs.iric_path = iric_path;
0704 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0705 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0706 
0707 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0708 
0709 <span class="comment">% --------------------------------------------------------------------</span>
0710 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0711 <span class="comment">% Get the Application Data:</span>
0712 <span class="comment">% -------------------------</span>
0713 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0714 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0715 excel_path  = guiprefs.excel_path;
0716 excel_file  = guiprefs.excel_file;
0717 
0718 <span class="comment">% Push messages to Log Window:</span>
0719 <span class="comment">% ----------------------------</span>
0720 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0721 statusLogging(handles.LogWindow, log_text)
0722 
0723 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0724 <span class="comment">% data.</span>
0725 <span class="keyword">if</span> iscell(guiparams.mat_file)
0726     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0727     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0728     <span class="comment">% Refresh the Application Data:</span>
0729     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0730     z           = guiparams.z;
0731     A           = guiparams.A;
0732     V           = guiparams.V;
0733     Map         = guiparams.Map;
0734     wse         = guiparams.wse;
0735     PVdata      = guiparams.iric_anv_planview_data;
0736     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0737         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0738     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0739         fullfile(excel_path,excel_file));
0740     
0741     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0742         outfile = fullfile(excel_path,excel_file);
0743         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0744         
0745     <span class="keyword">else</span>
0746         <span class="comment">% Return default excel_path and excel_file</span>
0747         excel_path = guiprefs.excel_path;
0748         excel_file = guiprefs.excel_file;
0749         outfile = fullfile(excel_path,excel_file);
0750         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0751     <span class="keyword">end</span>
0752     
0753     <span class="comment">% Delete the old file if it exists</span>
0754     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0755         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0756             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0757             <span class="string">'already exists. Overwriting file...'</span>});
0758         delete(outfile)
0759     <span class="keyword">end</span>
0760     
0761     <span class="comment">% Save DAV data to an Excel File</span>
0762     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0763     vmin = num2str(guiparams.depth_range_min);
0764     vmax = num2str(guiparams.depth_range_max);
0765     pvheaders = {<span class="keyword">...</span>
0766         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0767         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0768         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0769         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0770     
0771 
0772     <span class="comment">% Initialize Variables</span>
0773     pvdata = []; Dist = [];
0774     X = []; Y = []; E = [];
0775     Ve = []; Vn =[]; Vm = []; Vd = [];
0776     
0777     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0778     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0779         <span class="comment">% Load current MAT-file</span>
0780         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0781         
0782         <span class="comment">% Location and Bathy</span>
0783         X = [X V.mcsX(1,:)];
0784         Y = [Y V.mcsY(1,:)];
0785         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0786         E = [E V.mcsBedElev];
0787         
0788         <span class="comment">% Build layer-averaged velocities</span>
0789         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0790         V.mcsX(indx,:) = nan;
0791         V.mcsY(indx,:) = nan;
0792         V.mcsEast(indx,:) = nan;
0793         V.mcsNorth(indx,:) = nan;
0794         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0795         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0796         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0797         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0798         
0799         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0800     <span class="keyword">end</span>
0801     
0802     <span class="comment">% Put output into 1 matrix</span>
0803     pvdata = [<span class="keyword">...</span>
0804         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0805         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0806         ];
0807     pvdata(isnan(pvdata)) = -9999;
0808     
0809     <span class="comment">% Create table and write to Excel</span>
0810     pvout = num2cell(pvdata');
0811     pvout = vertcat(pvheaders,pvout);
0812     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0813     
0814     <span class="comment">% Close out waitbar</span>
0815     waitbar(1,hwait)
0816     delete(hwait)
0817     
0818     <span class="comment">% Push messages to Log Window:</span>
0819     <span class="comment">% ----------------------------</span>
0820     statusLogging(handles.LogWindow, log_text)
0821 <span class="keyword">else</span>
0822     
0823     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0824     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0825     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0826     <span class="comment">% Refresh the Application Data:</span>
0827     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0828     z           = guiparams.z;
0829     A           = guiparams.A;
0830     V           = guiparams.V;
0831     Map         = guiparams.Map;
0832     wse         = guiparams.wse;
0833     PVdata      = guiparams.iric_anv_planview_data;
0834     
0835     
0836     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0837     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0838         fullfile(excel_path,excel_file));
0839     
0840     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0841         outfile = fullfile(excel_path,excel_file);
0842         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0843         
0844         <span class="comment">% Delete the old file if it exists</span>
0845         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0846             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0847                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0848                 <span class="string">'already exists. Overwriting file...'</span>});
0849             delete(outfile)
0850         <span class="keyword">end</span>
0851         
0852         <span class="comment">% Push messages to Log Window:</span>
0853         <span class="comment">% ----------------------------</span>
0854         statusLogging(handles.LogWindow, log_text)
0855         
0856         <span class="comment">% Save MCS Summary to an Excel File</span>
0857         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0858         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0859         sout = guiparams.data_files';
0860         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0861         sout = {<span class="keyword">...</span>
0862             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0863             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0864             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0865             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0866             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0867             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0868             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0869             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0870             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0871             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0872             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0873             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0875             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0877             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0878             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0879             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0880         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0881         
0882         <span class="comment">% Save DAV data to an Excel File</span>
0883         vmin = num2str(guiparams.depth_range_min);
0884         vmax = num2str(guiparams.depth_range_max);
0885         pvheaders = {<span class="keyword">...</span>
0886             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0887             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0888             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0889             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0890         
0891         <span class="comment">% Create block style matrix of all processed data</span>
0892         pvdata = [];
0893         
0894         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0895         <span class="comment">% you are looking upstream into the transect</span>
0896         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0897         
0898         <span class="comment">% Build bathy data matrix</span>
0899         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0900         
0901         <span class="comment">% Build layer-averaged velocities</span>
0902         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0903         V.mcsX(indx,:) = nan;
0904         V.mcsY(indx,:) = nan;
0905         V.mcsEast(indx,:) = nan;
0906         V.mcsNorth(indx,:) = nan;
0907         pvdata = [<span class="keyword">...</span>
0908             pvdata;<span class="keyword">...</span>
0909             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0910             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0911             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0912             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0913         pvdata(isnan(pvdata)) = -9999;
0914         pvout = num2cell(pvdata');
0915         pvout = vertcat(pvheaders,pvout);
0916         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0917         waitbar(4/5,hwait)
0918         
0919         <span class="comment">% Save MCS data to an Excel File</span>
0920         mcsheaders = {<span class="keyword">...</span>
0921             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0922             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0923             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0924             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0925             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0926             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0927             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0928             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0929             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0930             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0931             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0932             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0933             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0934             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0935             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0936             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0937         
0938         mcsdata = [<span class="keyword">...</span>
0939             V.mcsX(:)<span class="keyword">...</span>
0940             V.mcsY(:)<span class="keyword">...</span>
0941             V.mcsDist(:)<span class="keyword">...</span>
0942             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0943             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0944             V.mcsEast(:)<span class="keyword">...</span>
0945             V.mcsNorth(:)<span class="keyword">...</span>
0946             V.mcsVert(:)<span class="keyword">...</span>
0947             V.mcsMag(:)<span class="keyword">...</span>
0948             V.mcsDir(:)<span class="keyword">...</span>
0949             V.u(:)<span class="keyword">...</span>
0950             V.v(:)<span class="keyword">...</span>
0951             V.vp(:)<span class="keyword">...</span>
0952             V.vs(:)<span class="keyword">...</span>
0953             V.Roz.up(:)<span class="keyword">...</span>
0954             V.Roz.us(:)];
0955         mcsdata(isnan(mcsdata)) = -9999;
0956         
0957         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0958         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0959         waitbar(1,hwait)
0960         delete(hwait)
0961         
0962     <span class="keyword">else</span>
0963         <span class="comment">% Return default excel_path and excel_file</span>
0964         excel_path = guiprefs.excel_path;
0965         excel_file = guiprefs.excel_file;
0966         outfile = fullfile(excel_path,excel_file);
0967         log_text = {<span class="string">'User aborted Excel export...'</span>};
0968     <span class="keyword">end</span>
0969     
0970     
0971     
0972 <span class="keyword">end</span>
0973 
0974 <span class="comment">% Push messages to Log Window:</span>
0975 <span class="comment">% ----------------------------</span>
0976 statusLogging(handles.LogWindow, log_text)
0977 
0978 <span class="comment">% Store the persistent preferences:</span>
0979 <span class="comment">% ---------------------------------</span>
0980 guiprefs.excel_file = excel_file;
0981 guiprefs.excel_path = excel_path;
0982 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0983 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0984 
0985 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0986 
0987 <span class="comment">% --------------------------------------------------------------------</span>
0988 <a name="_sub27" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0989 <span class="comment">% Empty</span>
0990 
0991 <span class="comment">% --------------------------------------------------------------------</span>
0992 <a name="_sub28" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0993 <span class="comment">% Empty</span>
0994 
0995 <span class="comment">% --------------------------------------------------------------------</span>
0996 <a name="_sub29" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0997 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0998 
0999 <span class="comment">% Get the Application Data:</span>
1000 <span class="comment">% -------------------------</span>
1001 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1002 
1003 <span class="comment">% Update the GUI &amp; Application Data:</span>
1004 <span class="comment">% ----------------------------------</span>
1005 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1006 <span class="keyword">switch</span> status
1007     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1008         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1009         guiparams.unit_discharge_correction = false;
1010     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1011         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1012         guiparams.unit_discharge_correction = true;
1013 <span class="keyword">end</span>
1014 
1015 <span class="comment">% Re-store the Application data:</span>
1016 <span class="comment">% ------------------------------</span>
1017 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1018 
1019 
1020 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1021 
1022 <span class="comment">% --------------------------------------------------------------------</span>
1023 <a name="_sub30" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1024 <span class="comment">% Empty</span>
1025 
1026 <span class="comment">% --------------------------------------------------------------------</span>
1027 <a name="_sub31" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1028 <span class="comment">% Empty</span>
1029 
1030 <span class="comment">% --------------------------------------------------------------------</span>
1031 <a name="_sub32" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1032 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1033 
1034 <span class="comment">% Get the Application Data:</span>
1035 <span class="comment">% -------------------------</span>
1036 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1037 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1038 
1039 <span class="comment">% Update the Application Data:</span>
1040 <span class="comment">% ----------------------------</span>
1041 guiparams.english_units = false;
1042 guiprefs.units = <span class="string">'metric'</span>;
1043 
1044 <span class="comment">% Re-store the Application data:</span>
1045 <span class="comment">% ------------------------------</span>
1046 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1047 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1048 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1049 
1050 <span class="comment">% Update the GUI:</span>
1051 <span class="comment">% ---------------</span>
1052 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1053 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1054 
1055 <span class="comment">% [EOF] menuMetric_Callback</span>
1056 
1057 
1058 <span class="comment">% --------------------------------------------------------------------</span>
1059 <a name="_sub33" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1060 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1061 
1062 <span class="comment">% Get the Application Data:</span>
1063 <span class="comment">% -------------------------</span>
1064 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1065 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1066 
1067 <span class="comment">% Update the Application Data:</span>
1068 <span class="comment">% ----------------------------</span>
1069 guiparams.english_units = true;
1070 guiprefs.units = <span class="string">'english'</span>;
1071 
1072 <span class="comment">% Re-store the Application data:</span>
1073 <span class="comment">% ------------------------------</span>
1074 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1075 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1076 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1077 
1078 <span class="comment">% Update the GUI:</span>
1079 <span class="comment">% ---------------</span>
1080 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1081 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1082 
1083 <span class="comment">% [EOF] menuEnglish_Callback</span>
1084 
1085 <span class="comment">% --------------------------------------------------------------------</span>
1086 <a name="_sub34" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1087 <span class="comment">% Empty</span>
1088 
1089 <span class="comment">% --------------------------------------------------------------------</span>
1090 <a name="_sub35" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1091 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1092 <span class="comment">% surface)</span>
1093 
1094 <span class="comment">% Get the Application Data:</span>
1095 <span class="comment">% -------------------------</span>
1096 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1097 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1098 
1099 <span class="comment">% Update the Application Data:</span>
1100 <span class="comment">% ----------------------------</span>
1101 guiparams.plotref = <span class="string">'dfs'</span>;
1102 guiprefs.plotref  = <span class="string">'dfs'</span>;
1103 
1104 <span class="comment">% Re-store the Application data:</span>
1105 <span class="comment">% ------------------------------</span>
1106 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1107 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1108 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1109 
1110 <span class="comment">% Update the GUI:</span>
1111 <span class="comment">% ---------------</span>
1112 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1113 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1114 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1115 
1116 <span class="comment">% --------------------------------------------------------------------</span>
1117 <a name="_sub36" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1118 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1119 
1120 <span class="comment">% Get the Application Data:</span>
1121 <span class="comment">% -------------------------</span>
1122 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1123 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1124 
1125 <span class="comment">% Update the Application Data:</span>
1126 <span class="comment">% ----------------------------</span>
1127 guiparams.plotref = <span class="string">'hab'</span>;
1128 guiprefs.plotref  = <span class="string">'hab'</span>;
1129 
1130 <span class="comment">% Prompt and set eta</span>
1131 <span class="comment">% ------------------</span>
1132 prompt = <span class="string">'Enter elevation of the bottom (eta), in meters:'</span>;
1133 dlg_title = <span class="string">'Set bottom elevation for height above bottom reference'</span>;
1134 num_lines = 1;
1135 def = {num2str(guiparams.eta)};
1136 guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));
1137 
1138 
1139 <span class="comment">% Re-store the Application data:</span>
1140 <span class="comment">% ------------------------------</span>
1141 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1142 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1143 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1144 
1145 <span class="comment">% Update the GUI:</span>
1146 <span class="comment">% ---------------</span>
1147 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1148 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1149 
1150 
1151 
1152 
1153 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1154 
1155 <span class="comment">% --------------------------------------------------------------------</span>
1156 <a name="_sub37" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1157 <span class="comment">% Empty</span>
1158 
1159 <span class="comment">% --------------------------------------------------------------------</span>
1160 <a name="_sub38" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1161 <span class="comment">% Set cross-section endpoints automatically</span>
1162 
1163 <span class="comment">% Get the Application Data:</span>
1164 <span class="comment">% -------------------------</span>
1165 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1166 
1167 <span class="comment">% Update the Application Data:</span>
1168 <span class="comment">% ----------------------------</span>
1169 guiparams.set_cross_section_endpoints = false;
1170 
1171 <span class="comment">% Re-store the Application data:</span>
1172 <span class="comment">% ------------------------------</span>
1173 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1174 
1175 <span class="comment">% Update the GUI:</span>
1176 <span class="comment">% ---------------</span>
1177 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1178 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1179 
1180 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1181 
1182 
1183 <span class="comment">% --------------------------------------------------------------------</span>
1184 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1185 <span class="comment">% Set cross-section endpoints manually</span>
1186 
1187 <span class="comment">% Get the Application Data:</span>
1188 <span class="comment">% -------------------------</span>
1189 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1190 
1191 <span class="comment">% Update the Application Data:</span>
1192 <span class="comment">% ----------------------------</span>
1193 guiparams.set_cross_section_endpoints = true;
1194 
1195 <span class="comment">% Re-store the Application data:</span>
1196 <span class="comment">% ------------------------------</span>
1197 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1198 
1199 <span class="comment">% Update the GUI:</span>
1200 <span class="comment">% ---------------</span>
1201 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1202 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1203 
1204 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1205 
1206 
1207 
1208 
1209 <span class="comment">% --------------------------------------------------------------------</span>
1210 <a name="_sub40" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1211 <span class="comment">% Empty</span>
1212 
1213 <span class="comment">% --------------------------------------------------------------------</span>
1214 <a name="_sub41" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1215 
1216 <span class="comment">% Get the Application Data:</span>
1217 <span class="comment">% -------------------------</span>
1218 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1219 
1220 <span class="comment">% Update the Application Data:</span>
1221 <span class="comment">% ----------------------------</span>
1222 guiparams.print        = true;
1223 guiparams.presentation = false;
1224 
1225 <span class="comment">% Re-store the Application data:</span>
1226 <span class="comment">% ------------------------------</span>
1227 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1228 
1229 <span class="comment">% Update the GUI:</span>
1230 <span class="comment">% ---------------</span>
1231 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1232 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1233 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1234 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1235 
1236 <span class="comment">% Modify the existing figures</span>
1237 <span class="comment">% ---------------------------</span>
1238 <span class="comment">% Find what plots exist already</span>
1239 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1240 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1241 
1242 <span class="comment">% Defaults for Print Stlye Figure</span>
1243 BkgdColor   = <span class="string">'white'</span>;
1244 AxColor     = <span class="string">'black'</span>;
1245 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1246 FntSize     = 14;
1247 
1248 <span class="comment">% Loop through valid figures and adjust</span>
1249 <span class="comment">% -------------------------------------</span>
1250 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1251     
1252     <span class="keyword">for</span> i = 1:length(valid_names)
1253         <span class="keyword">switch</span> valid_names{i}
1254             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1255                 <span class="comment">% Focus the figure</span>
1256                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1257                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1258                     figure(hff)
1259                     
1260                     <span class="comment">% Make the changes to figure</span>
1261                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1262                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1263                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1264                     set(gca,<span class="string">'Color'</span>,FigColor)
1265                     set(gca,<span class="string">'XColor'</span>,AxColor)
1266                     set(gca,<span class="string">'YColor'</span>,AxColor)
1267                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1268                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1269                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1270                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1271                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1272                     
1273                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1274                     <span class="comment">% the file(s) and path for the data</span>
1275                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1276                     <span class="keyword">if</span> ~ismultiplot
1277                         filestr = guiparams.savefile;
1278                         wd = length(filestr);
1279                         hd = 1;
1280                     <span class="keyword">else</span>
1281                         <span class="comment">% Construct a filename</span>
1282                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1283                         wd        = max(cellfun(@length,filestr));
1284                         hd        = numel(filestr);
1285                             
1286                     <span class="keyword">end</span>
1287                     
1288                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1289                     disableMenuBar(hff)
1290                     set(fileinfotxt,<span class="keyword">...</span>
1291                         <span class="string">'string'</span>,filestr)
1292                     set(fileinfotxt,<span class="keyword">...</span>
1293                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1294                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1295                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1296                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1297                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1298                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1299                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1300                     
1301                 <span class="keyword">end</span>
1302             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1303                 <span class="comment">% Focus the figure</span>
1304                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1305                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1306                     figure(hff)
1307                     
1308                     <span class="comment">% Make the changes to figure</span>
1309                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1310                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1311                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1312                     set(gca,<span class="string">'Color'</span>,FigColor)
1313                     set(gca,<span class="string">'XColor'</span>,AxColor)
1314                     set(gca,<span class="string">'YColor'</span>,AxColor)
1315                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1316                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1317                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1318                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1319                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1320                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1321                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1322                     
1323                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1324                     <span class="comment">% the file(s) and path for the data</span>
1325                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1326                     <span class="keyword">if</span> ~ismultiplot
1327                         filestr = guiparams.savefile;
1328                         wd = length(filestr);
1329                         hd = 1;
1330                     <span class="keyword">else</span>
1331                         <span class="comment">% Construct a filename</span>
1332                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1333                         wd        = max(cellfun(@length,filestr));
1334                         hd        = numel(filestr);
1335                             
1336                     <span class="keyword">end</span>
1337                     
1338                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1339                     disableMenuBar(hff)
1340                     set(fileinfotxt,<span class="keyword">...</span>
1341                         <span class="string">'string'</span>,filestr)
1342                     set(fileinfotxt,<span class="keyword">...</span>
1343                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1344                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1345                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1346                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1347                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1348                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1349                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1350                 <span class="keyword">end</span>
1351             <span class="keyword">otherwise</span>
1352         <span class="keyword">end</span>
1353     <span class="keyword">end</span>
1354     
1355     
1356 <span class="keyword">end</span>
1357 
1358 
1359 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1360 
1361 
1362 <span class="comment">% --------------------------------------------------------------------</span>
1363 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1364 <span class="comment">% Get the Application Data:</span>
1365 <span class="comment">% -------------------------</span>
1366 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1367 
1368 <span class="comment">% Update the Application Data:</span>
1369 <span class="comment">% ----------------------------</span>
1370 guiparams.print        = false;
1371 guiparams.presentation = true;
1372 
1373 <span class="comment">% Re-store the Application data:</span>
1374 <span class="comment">% ------------------------------</span>
1375 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1376 
1377 <span class="comment">% Update the GUI:</span>
1378 <span class="comment">% ---------------</span>
1379 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1380 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1381 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1382 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1383 
1384 <span class="comment">% Modify the existing figures</span>
1385 <span class="comment">% ---------------------------</span>
1386 <span class="comment">% Find what plots exist already</span>
1387 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1388 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1389 
1390 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1391 <span class="comment">% --------------------------------------</span>
1392 BkgdColor   = <span class="string">'black'</span>;
1393 AxColor     = <span class="string">'white'</span>;
1394 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1395 FntSize     = 14;
1396 
1397 <span class="comment">% Loop through valid figures and adjust</span>
1398 <span class="comment">% -------------------------------------</span>
1399 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1400     
1401     <span class="keyword">for</span> i = 1:length(valid_names)
1402         <span class="keyword">switch</span> valid_names{i}
1403             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1404                 <span class="comment">% Focus the figure</span>
1405                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1406                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1407                     figure(hff)
1408                     
1409                     <span class="comment">% Make the changes to figure</span>
1410                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1411                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1412                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1413                     set(gca,<span class="string">'Color'</span>,FigColor)
1414                     set(gca,<span class="string">'XColor'</span>,AxColor)
1415                     set(gca,<span class="string">'YColor'</span>,AxColor)
1416                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1417                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1418                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1419                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1420                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1421                     
1422                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1423                     <span class="comment">% the file(s) and path for the data</span>
1424                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1425                     <span class="keyword">if</span> ~ismultiplot
1426                         filestr = guiparams.savefile;
1427                         wd = length(filestr);
1428                         hd = 1;
1429                     <span class="keyword">else</span>
1430                         <span class="comment">% Construct a filename</span>
1431                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1432                         wd        = max(cellfun(@length,filestr));
1433                         hd        = numel(filestr);
1434                             
1435                     <span class="keyword">end</span>
1436                     
1437                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1438                     disableMenuBar(hff)
1439                     set(fileinfotxt,<span class="keyword">...</span>
1440                         <span class="string">'string'</span>,filestr)
1441                     set(fileinfotxt,<span class="keyword">...</span>
1442                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1443                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1444                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1445                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1446                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1447                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1448                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1449                     
1450                 <span class="keyword">end</span>
1451             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1452                 <span class="comment">% Focus the figure</span>
1453                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1454                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1455                     figure(hff)
1456                     
1457                     <span class="comment">% Make the changes to figure</span>
1458                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1459                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1460                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1461                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1462                     set(gca,<span class="string">'XColor'</span>,AxColor)
1463                     set(gca,<span class="string">'YColor'</span>,AxColor)
1464                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1465                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1466                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1467                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1468                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1469                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1470                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1471                     
1472                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1473                     <span class="comment">% the file(s) and path for the data</span>
1474                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1475                     <span class="keyword">if</span> ~ismultiplot
1476                         filestr = guiparams.savefile;
1477                         wd = length(filestr);
1478                         hd = 1;
1479                     <span class="keyword">else</span>
1480                         <span class="comment">% Construct a filename</span>
1481                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1482                         wd        = max(cellfun(@length,filestr));
1483                         hd        = numel(filestr);
1484                             
1485                     <span class="keyword">end</span>
1486                     
1487                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1488                     disableMenuBar(hff)
1489                     set(fileinfotxt,<span class="keyword">...</span>
1490                         <span class="string">'string'</span>,filestr)
1491                     set(fileinfotxt,<span class="keyword">...</span>
1492                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1493                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1494                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1495                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1496                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1497                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1498                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1499                 <span class="keyword">end</span>
1500             <span class="keyword">otherwise</span>
1501         <span class="keyword">end</span>
1502     <span class="keyword">end</span>
1503     
1504     
1505 <span class="keyword">end</span>
1506 
1507 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1508 
1509 <span class="comment">% --------------------------------------------------------------------</span>
1510 <a name="_sub43" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1511 
1512 <span class="comment">% Get the Application data:</span>
1513 <span class="comment">% -------------------------</span>
1514 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1515 
1516 <span class="comment">% Initialize the answer:</span>
1517 <span class="comment">% ----------------------</span>
1518 numstr = {num2str(guiparams.vertical_offset)};
1519 answer = NaN;
1520 <span class="keyword">while</span> isnan(answer)
1521     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1522     
1523     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1524         <span class="keyword">return</span>
1525     <span class="keyword">end</span>
1526     
1527     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1528     <span class="comment">% A numeric char will be a double</span>
1529 <span class="keyword">end</span>
1530 
1531 <span class="comment">% Re-store the Application data:</span>
1532 <span class="comment">% ------------------------------</span>
1533 guiparams.vertical_offset = answer;
1534 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1535 
1536 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1537 
1538 <span class="comment">% --------------------------------------------------------------------</span>
1539 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1540 <span class="comment">% Not implemented</span>
1541 
1542 <span class="comment">% --------------------------------------------------------------------</span>
1543 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1544 <span class="comment">% Empty</span>
1545 
1546 <span class="comment">% --------------------------------------------------------------------</span>
1547 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1548 ASCII2GIS_GUI
1549 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1550 
1551 <span class="comment">% --------------------------------------------------------------------</span>
1552 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1553 
1554 <span class="comment">% Get the Application preferences:</span>
1555 <span class="comment">% --------------------------------</span>
1556 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1557 
1558 inpath = guiprefs.kmz_path;
1559 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1560     infile = guiprefs.kmz_file{1};
1561 <span class="keyword">else</span>
1562     infile = guiprefs.kmz_file;
1563 <span class="keyword">end</span>
1564 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1565 
1566 guiprefs.kmz_path = outpath;
1567 guiprefs.kmz_file = outfile;
1568 
1569 <span class="comment">% Update persistent preferences</span>
1570 <span class="comment">% -----------------------------</span>
1571 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1572 
1573 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1574 
1575 <span class="comment">% --------------------------------------------------------------------</span>
1576 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1577 <span class="comment">% Get the Application preferences:</span>
1578 <span class="comment">% --------------------------------</span>
1579 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1580 
1581 VMT_BatchMode;
1582 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1583 
1584 <span class="comment">% --------------------------------------------------------------------</span>
1585 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1586 <span class="comment">% Empty</span>
1587 
1588 <span class="comment">% --------------------------------------------------------------------</span>
1589 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1590 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1591 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1592     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1593     
1594 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1595     
1596     <span class="keyword">if</span> isdeployed
1597         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1598             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1599         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1600             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1601             errLogFileName},<span class="keyword">...</span>
1602             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1603             <span class="string">'error'</span>);
1604         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1605         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1606         fclose(fid);
1607         rethrow(err)
1608     <span class="keyword">else</span>
1609         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1610             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1611             <span class="string">'error'</span>);
1612         rethrow(err);
1613     <span class="keyword">end</span>
1614 <span class="keyword">end</span>
1615 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1616 
1617 <span class="comment">% --------------------------------------------------------------------</span>
1618 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1619 <span class="comment">% Get the Application data:</span>
1620 <span class="comment">% -------------------------</span>
1621 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1622 
1623 <span class="keyword">try</span>
1624     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1625 
1626 
1627 <span class="comment">% This catch is probably not necessary.</span>
1628 <span class="keyword">catch</span> err 
1629     <span class="keyword">if</span> isdeployed
1630         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1631             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1632         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1633             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1634             errLogFileName},<span class="keyword">...</span>
1635             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1636             <span class="string">'error'</span>);
1637         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1638         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1639         fclose(fid);
1640         rethrow(err)
1641     <span class="keyword">else</span>
1642         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1643             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1644             <span class="string">'error'</span>);
1645         rethrow(err);
1646     <span class="keyword">end</span>
1647 <span class="keyword">end</span>
1648 
1649 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1650 
1651 <span class="comment">% --------------------------------------------------------------------</span>
1652 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1653 
1654 <span class="comment">% Get the Application data:</span>
1655 <span class="comment">% -------------------------</span>
1656 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1657 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1658 
1659 <span class="comment">% Check version tag against the web, and display a message</span>
1660 <span class="keyword">try</span>
1661     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1662     webdata = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1663     <span class="keyword">if</span> length(webdata) &gt; 5
1664         current_vmt_version{1} = webdata(1:5);
1665         current_vmt_version{2} = webdata(8:16);
1666     <span class="keyword">else</span>
1667         current_vmt_version = webdata;
1668     <span class="keyword">end</span>
1669     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1670 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1671     <span class="keyword">if</span> isdeployed
1672         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1673             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1674         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1675             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1676             errLogFileName},<span class="keyword">...</span>
1677             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1678             <span class="string">'error'</span>);
1679         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1680         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1681         fclose(fid);
1682         rethrow(err)
1683     <span class="keyword">else</span>
1684         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1685             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1686             <span class="string">'error'</span>);
1687         rethrow(err);
1688     <span class="keyword">end</span>
1689 <span class="keyword">end</span>
1690 
1691 <span class="keyword">if</span> ischar(current_vmt_version)
1692     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1693         h = msgbox(<span class="keyword">...</span>
1694             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1695             <span class="string">''</span>;<span class="keyword">...</span>
1696             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1697             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1698     <span class="keyword">else</span>
1699         h = msgbox(<span class="keyword">...</span>
1700             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1701             <span class="string">''</span>;<span class="keyword">...</span>
1702             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1703             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1704     <span class="keyword">end</span>
1705 <span class="keyword">elseif</span> iscell(current_vmt_version)
1706     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1707         h = msgbox(<span class="keyword">...</span>
1708             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1709             <span class="string">''</span>;<span class="keyword">...</span>
1710             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1711             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1712     <span class="keyword">else</span>
1713         h = msgbox(<span class="keyword">...</span>
1714             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1715             <span class="string">''</span>;<span class="keyword">...</span>
1716             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1717             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1718     <span class="keyword">end</span>
1719 <span class="keyword">end</span>
1720 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1721 
1722 <span class="comment">% --------------------------------------------------------------------</span>
1723 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1724 
1725 <span class="comment">% Get the Application data:</span>
1726 <span class="comment">% -------------------------</span>
1727 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1728 messagestr = <span class="keyword">...</span>
1729     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1730     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1731     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1732     <span class="string">''</span>;<span class="keyword">...</span>
1733     <span class="string">''</span>;<span class="keyword">...</span>
1734     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1735     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1736     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1737     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1738     <span class="string">''</span>;<span class="keyword">...</span>
1739     <span class="string">''</span>;<span class="keyword">...</span>
1740     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1741     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1742     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1743     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1744     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1745     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1746     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1747 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1748 <span class="comment">% [EOF] menuAbout_Callback</span>
1749 
1750 
1751 
1752 
1753 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1754 <span class="comment">% TOOLBAR CALLBACKS %</span>
1755 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1756 
1757 <span class="comment">% --------------------------------------------------------------------</span>
1758 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1759 <span class="comment">% Read Files into Data Structure using tfile.</span>
1760 
1761 <span class="comment">% Get the Application data:</span>
1762 <span class="comment">% -------------------------</span>
1763 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1764 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1765 
1766 <span class="comment">% Ask the user to select files:</span>
1767 <span class="comment">% -----------------------------</span>
1768 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1769 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1770     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1771     current_file, <span class="keyword">...</span>
1772     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1773 
1774 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1775     guiparams.data_folder = pathname;
1776     <span class="keyword">if</span> ischar(filename)
1777         filename = {filename};
1778     <span class="keyword">end</span>
1779     guiparams.data_files = filename;
1780     guiparams.mat_file = <span class="string">''</span>;
1781     
1782     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1783     
1784    
1785     
1786     <span class="comment">% Update the preferences:</span>
1787     <span class="comment">% -----------------------</span>
1788     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1789     guiprefs.ascii_path = pathname;
1790     guiprefs.ascii_file = filename;
1791     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1792     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1793     
1794     <span class="comment">% Push messages to Log Window:</span>
1795     <span class="comment">% ----------------------------</span>
1796     log_text = {<span class="keyword">...</span>
1797         <span class="string">''</span>;<span class="keyword">...</span>
1798         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1799         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1800         guiparams.data_folder;
1801         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1802         char(filename)};
1803     statusLogging(handles.LogWindow, log_text)
1804     
1805     <span class="comment">% Read the file(s)</span>
1806     <span class="comment">% ----------------</span>
1807     [~,~,savefile,A,z] = <span class="keyword">...</span>
1808         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1809     guiparams.savefile = savefile;
1810     guiparams.A        = A;
1811     guiparams.z        = z;
1812     
1813     
1814     <span class="comment">% Set the vertical grid node spacing</span>
1815     <span class="comment">% ----------------------------------</span>
1816     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1817     <span class="comment">% Backwards compatible</span>
1818     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1819         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1820         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1821     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1822         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1823         guiparams.vertical_grid_node_spacing = 0.4;
1824     <span class="keyword">end</span>
1825     
1826     
1827     <span class="comment">% Save application data</span>
1828     <span class="comment">% ---------------------</span>
1829     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1830        
1831 <span class="comment">%</span>
1832 <span class="comment">%     % Preprocess the data:</span>
1833 <span class="comment">%     % --------------------</span>
1834 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1835 <span class="comment">%</span>
1836 <span class="comment">%     % Push messages to Log Window:</span>
1837 <span class="comment">%     % ----------------------------</span>
1838 <span class="comment">%     log_text = {...</span>
1839 <span class="comment">%         '   Preprocessing complete.';...</span>
1840 <span class="comment">%         '   Begin Data Processing...'};</span>
1841 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1842 <span class="comment">%</span>
1843 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1844 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1845 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1846 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1847 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
1848 <span class="comment">%</span>
1849 <span class="comment">%     % Push messages to Log Window:</span>
1850 <span class="comment">%     % ----------------------------</span>
1851 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1852 <span class="comment">%</span>
1853 <span class="comment">%     % Store the data:</span>
1854 <span class="comment">%     % ---------------</span>
1855 <span class="comment">%     guiparams.z = z;</span>
1856 <span class="comment">%     guiparams.A = A;</span>
1857 <span class="comment">%     guiparams.V = V;</span>
1858 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1859     
1860           
1861     <span class="comment">% Update the GUI:</span>
1862     <span class="comment">% ---------------</span>
1863     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1864     
1865     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1866     
1867 <span class="keyword">end</span>
1868 <span class="comment">% [EOF] loadDataCallback</span>
1869 
1870 
1871 
1872 <span class="comment">% --------------------------------------------------------------------</span>
1873 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1874 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1875 
1876 <span class="comment">% Get the Application data:</span>
1877 <span class="comment">% -------------------------</span>
1878 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1879 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1880 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1881 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1882 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1883 
1884 [the_file,the_path] = <span class="keyword">...</span>
1885     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1886     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1887     fullfile(guiparams.mat_path,guiparams.savefile));
1888 
1889 <span class="comment">% Save the processed data to a MAT file:</span>
1890 <span class="comment">% --------------------------------------</span>
1891 <span class="keyword">if</span> ischar(the_file)
1892     guiparams.mat_path = the_path;
1893     guiparams.mat_file = the_file;
1894     guiparams.savefile = the_file;
1895     
1896     <span class="comment">% Re-store the Application data:</span>
1897     <span class="comment">% ------------------------------</span>
1898     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1899     
1900     <span class="comment">% Update the preferences:</span>
1901     <span class="comment">% -----------------------</span>
1902     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1903     guiprefs.mat_path = the_path;
1904     guiprefs.mat_file = the_file;
1905     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1906     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1907     
1908     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1909     savefile = fullfile(pathstr,[filename extension]);
1910     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1911     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1912     log_text = {<span class="keyword">...</span>
1913         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1914         savefile};
1915     statusLogging(handles.LogWindow,log_text)
1916     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1917 <span class="keyword">end</span>
1918 
1919 <span class="comment">% [EOF] saveDataCallback</span>
1920 
1921 
1922 <span class="comment">% --------------------------------------------------------------------</span>
1923 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1924 
1925 <span class="comment">% Get the Application data:</span>
1926 <span class="comment">% -------------------------</span>
1927 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1928 z   = guiparams.z;
1929 A   = guiparams.A;
1930 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1931 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1932 
1933 <span class="comment">% Compute multibeam bathymetry:</span>
1934 <span class="comment">% -----------------------------</span>
1935 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1936 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1937 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1938     guiparams.beam_angle, <span class="keyword">...</span>
1939     guiparams.magnetic_variation, <span class="keyword">...</span>
1940     guiparams.wse, <span class="keyword">...</span>
1941     guiparams.output_auxiliary_data);
1942 
1943 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1944 
1945 <span class="comment">% [EOF] saveBathymetryCallback</span>
1946 
1947 <span class="comment">% --------------------------------------------------------------------</span>
1948 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1949 
1950 <span class="comment">% Get the Application data:</span>
1951 <span class="comment">% -------------------------</span>
1952 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1953 
1954 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1955     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1956     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1957     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1958     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1959     handles.figure1);
1960 
1961 <span class="comment">% Update the GUI:</span>
1962 <span class="comment">% ---------------</span>
1963 <span class="keyword">if</span> guiparams.english_units
1964     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1965     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1966 <span class="keyword">else</span>
1967     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1968     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1969 <span class="keyword">end</span>
1970 
1971 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1972     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1973     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1974 <span class="keyword">else</span>
1975     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1976     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1977 <span class="keyword">end</span>
1978 
1979 <span class="keyword">if</span> guiparams.presentation
1980     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1981 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1982 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1983 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1984 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1985 <span class="keyword">else</span>
1986     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1987 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1988 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1989 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1990 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1991 <span class="keyword">end</span>
1992 
1993 <span class="comment">% Re-store the Application data:</span>
1994 <span class="comment">% ------------------------------</span>
1995 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1996 
1997 <span class="comment">% [EOF] plottingParametersCallback</span>
1998 
1999 
2000 <span class="comment">% --------------------------------------------------------------------</span>
2001 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2002 
2003 <span class="comment">% Get the Application data:</span>
2004 <span class="comment">% -------------------------</span>
2005 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2006 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2007 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2008 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2009 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2010 
2011 <span class="comment">% [EOF] processingParametersCallback</span>
2012 
2013 
2014 <span class="comment">% --------------------------------------------------------------------</span>
2015 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2016 <span class="comment">% Plot 1</span>
2017 
2018 <span class="comment">% Get the Application data:</span>
2019 <span class="comment">% -------------------------</span>
2020 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2021 z = guiparams.z;
2022 A = guiparams.A;
2023 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2024 <span class="comment">% Map = guiparams.Map;</span>
2025 
2026 
2027 <span class="comment">% Preprocess the data:</span>
2028 <span class="comment">% --------------------</span>
2029 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2030 
2031 <span class="comment">% Push messages to Log Window:</span>
2032 <span class="comment">% ----------------------------</span>
2033 log_text = {<span class="keyword">...</span>
2034     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2035     <span class="string">'   Begin Data Processing...'</span>};
2036 statusLogging(handles.LogWindow, log_text)
2037 
2038 <span class="comment">% Process the transects:</span>
2039 <span class="comment">% ----------------------</span>
2040 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2041 A(1).vgns = guiparams.vertical_grid_node_spacing;
2042 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2043 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2044     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2045 
2046 <span class="comment">% Compute the smoothed variables</span>
2047 <span class="comment">% ------------------------------</span>
2048 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2049 <span class="comment">% runtime.</span>
2050 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2051     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2052     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2053     guiparams.vertical_smoothing_window);
2054 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2055 
2056 <span class="comment">% Push messages to Log Window:</span>
2057 <span class="comment">% ----------------------------</span>
2058 statusLogging(handles.LogWindow, processing_log_text)
2059 
2060 <span class="comment">% Store the data:</span>
2061 <span class="comment">% ---------------</span>
2062 guiparams.z = z;
2063 guiparams.A = A;
2064 guiparams.V = V;
2065 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2066 
2067 <span class="comment">% Push messages to Log Window:</span>
2068 <span class="comment">% ----------------------------</span>
2069 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2070 statusLogging(handles.LogWindow, log_text)
2071 
2072 <span class="comment">% Create or replot the Shiptracks</span>
2073 <span class="comment">% -------------------------------</span>
2074 <span class="comment">% Grab the axes to the plot</span>
2075 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2076 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2077 
2078 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2079 <span class="comment">% New plot display window</span>
2080 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2081 <span class="comment">% h = figure(1); clf</span>
2082 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2083 
2084 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2085 
2086 
2087 <span class="comment">% --------------------------------------------------------------------</span>
2088 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2089 <span class="comment">% Plot 2</span>
2090 
2091 <span class="comment">% Get the Application data:</span>
2092 <span class="comment">% -------------------------</span>
2093 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2094 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2095 
2096 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2097     <span class="comment">% Push messages to Log Window:</span>
2098     <span class="comment">% ----------------------------</span>
2099     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2100     statusLogging(handles.LogWindow, log_text)
2101     
2102        
2103     <span class="comment">% Push plotting parameters to log window:</span>
2104     <span class="comment">% ---------------------------------------</span>
2105     log_text = {<span class="keyword">...</span>
2106         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2107         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2108         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2109         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2110         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2111         };
2112     statusLogging(handles.LogWindow, log_text)
2113     
2114     <span class="comment">% Plot the data:</span>
2115     <span class="comment">% --------------</span>
2116     z = [];
2117     A = [];
2118     V = [];
2119     Map = [];
2120     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2121     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2122         depth_range, <span class="keyword">...</span>
2123         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2124         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2125         guiparams.smoothing_window_size, <span class="keyword">...</span>
2126         guiparams.display_shoreline, <span class="keyword">...</span>
2127         guiparams.english_units, <span class="keyword">...</span>
2128         guiparams.mat_file, <span class="keyword">...</span>
2129         guiparams.mat_path); <span class="comment">% PLOT2</span>
2130     statusLogging(handles.LogWindow, log_text)
2131     
2132     <span class="comment">% Plot a Shoreline Map:</span>
2133     <span class="comment">% ---------------------</span>
2134     <span class="keyword">if</span> guiparams.display_shoreline
2135         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2136             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2137             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2138             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2139         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2140             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2141             Map.UTMe   = mapdata(:,1);
2142             Map.UTMn   = mapdata(:,2);
2143             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2144             <span class="comment">%Map.UTMzone = zone;</span>
2145         <span class="keyword">else</span>
2146             Map = [];
2147         <span class="keyword">end</span>
2148         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2149         log_text = {<span class="keyword">...</span>
2150             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2151             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2152             };
2153         statusLogging(handles.LogWindow, log_text)
2154     <span class="keyword">else</span>
2155         Map = [];
2156     <span class="keyword">end</span>
2157     
2158 <span class="keyword">else</span>
2159     z = guiparams.z;
2160     A = guiparams.A;
2161     <span class="comment">% V = guiparams.V;</span>
2162     Map = guiparams.Map;
2163     
2164     <span class="comment">% Push messages to Log Window:</span>
2165     <span class="comment">% ----------------------------</span>
2166     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2167     statusLogging(handles.LogWindow, log_text)
2168     
2169         
2170     <span class="comment">% Preprocess the data:</span>
2171     <span class="comment">% --------------------</span>
2172     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2173     
2174     <span class="comment">% Process the transects:</span>
2175     <span class="comment">% ----------------------</span>
2176     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2177     A(1).vgns = guiparams.vertical_grid_node_spacing;
2178     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2179     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2180         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2181     
2182     <span class="comment">% Compute the smoothed variables</span>
2183     <span class="comment">% ------------------------------</span>
2184     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2185     <span class="comment">% runtime.</span>
2186     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2187         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2188         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2189         guiparams.vertical_smoothing_window);
2190     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2191     
2192     <span class="comment">% Push messages to Log Window:</span>
2193     <span class="comment">% ----------------------------</span>
2194     statusLogging(handles.LogWindow, processing_log_text)
2195     
2196     <span class="comment">% Plot the cross section:</span>
2197     <span class="comment">% -----------------------</span>
2198     log_text = {<span class="keyword">...</span>
2199         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2200         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2201         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2202         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2203         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2204         };
2205     statusLogging(handles.LogWindow, log_text)
2206     
2207     <span class="comment">% Plot the data:</span>
2208     <span class="comment">% --------------</span>
2209     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2210     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2211     
2212     
2213     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2214         depth_range, <span class="keyword">...</span>
2215         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2216         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2217         guiparams.smoothing_window_size, <span class="keyword">...</span>
2218         guiparams.display_shoreline, <span class="keyword">...</span>
2219         guiparams.english_units, <span class="keyword">...</span>
2220         guiparams.mat_file, <span class="keyword">...</span>
2221         guiparams.mat_path); <span class="comment">% PLOT2</span>
2222     statusLogging(handles.LogWindow, log_text)
2223     
2224     <span class="comment">% Plot User Set Endpoints</span>
2225     <span class="comment">% -----------------------</span>
2226     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2227         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2228         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2229         x = data(:,1);
2230         y = data(:,2);
2231         
2232         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2233         figure(fh); hold on
2234         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2235         hold off
2236     <span class="keyword">end</span>
2237     
2238     <span class="comment">% Plot a Shoreline Map:</span>
2239     <span class="comment">% ---------------------</span>
2240     <span class="keyword">if</span> guiparams.display_shoreline
2241         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2242             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2243             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2244             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2245         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2246             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2247             Map.UTMe   = mapdata(:,1);
2248             Map.UTMn   = mapdata(:,2);
2249             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2250             <span class="comment">%Map.UTMzone = zone;</span>
2251         <span class="keyword">else</span>
2252             Map = [];
2253         <span class="keyword">end</span>
2254         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2255         log_text = {<span class="keyword">...</span>
2256             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2257             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2258             };
2259         statusLogging(handles.LogWindow, log_text)
2260     <span class="keyword">else</span>
2261         Map = [];
2262     <span class="keyword">end</span>
2263     
2264 <span class="keyword">end</span>
2265 
2266 <span class="keyword">if</span> guiparams.add_background
2267     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2268     statusLogging(handles.LogWindow, log_text)
2269 <span class="keyword">end</span>
2270 
2271 <span class="comment">% Update guiparams</span>
2272 <span class="comment">% ----------------</span>
2273 guiparams.z   = z;
2274 guiparams.A   = A;
2275 guiparams.V   = V;
2276 guiparams.Map = Map;
2277 guiparams.iric_anv_planview_data = PVdata;
2278 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2279 
2280 <span class="comment">% Update preferences</span>
2281 <span class="comment">% ------------------</span>
2282 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2283 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2284 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2285 
2286 <span class="comment">% Force plot to be formated properly</span>
2287 <span class="comment">% ----------------------------------</span>
2288 <span class="keyword">if</span> guiparams.presentation
2289     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2290 <span class="keyword">else</span>
2291     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2292 <span class="keyword">end</span>
2293 <span class="keyword">switch</span> guiparams.renderer
2294     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2295         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2296     <span class="keyword">case</span> <span class="string">'painters'</span>
2297         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2298     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2299         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2300 <span class="keyword">end</span>
2301 
2302 <span class="comment">% Focus the figure</span>
2303 <span class="comment">% ----------------</span>
2304 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2305 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2306     figure(hff)
2307 <span class="keyword">end</span>
2308 
2309 <span class="comment">% Start the Graphics Control Gui</span>
2310 <span class="comment">% ------------------------------</span>
2311 VMT_GraphicsControl
2312 
2313 <span class="comment">% [EOF] planviewPlotCallback</span>
2314 
2315 
2316 <span class="comment">% --------------------------------------------------------------------</span>
2317 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2318 <span class="comment">% Plot 3</span>
2319 
2320 <span class="comment">% Get the Application data:</span>
2321 <span class="comment">% -------------------------</span>
2322 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2323 z = guiparams.z;
2324 A = guiparams.A;
2325 <span class="comment">% V = guiparams.V;</span>
2326 <span class="comment">% Map = guiparams.Map;</span>
2327 
2328 <span class="comment">% Preprocess the data:</span>
2329 <span class="comment">% --------------------</span>
2330 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2331 
2332 <span class="comment">% Push messages to Log Window:</span>
2333 <span class="comment">% ----------------------------</span>
2334 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2335 statusLogging(handles.LogWindow, log_text)
2336 
2337 <span class="comment">% Process the transects:</span>
2338 <span class="comment">% ----------------------</span>
2339 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2340 A(1).vgns = guiparams.vertical_grid_node_spacing;
2341 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2342 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2343     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2344 
2345 <span class="comment">% Push messages to Log Window:</span>
2346 <span class="comment">% ----------------------------</span>
2347 statusLogging(handles.LogWindow, processing_log_text)
2348 
2349 <span class="comment">% Plot the cross section:</span>
2350 <span class="comment">% -----------------------</span>
2351 log_text = {<span class="keyword">...</span>
2352     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2353     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2354     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2355     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2356     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2357     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2358     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2359     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2360     };
2361 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2362     log_text = vertcat(log_text, {<span class="keyword">...</span>
2363         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2364         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2365         });
2366 <span class="keyword">end</span>
2367 <span class="comment">% Push messages to Log Window:</span>
2368 <span class="comment">% ----------------------------</span>
2369 statusLogging(handles.LogWindow, log_text)
2370 
2371 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2372     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2373 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2374 <span class="comment">%         ...guiparams.contour, ...</span>
2375 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2376 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2377     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2378         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2379         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2380         guiparams.vertical_smoothing_window);
2381     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2382     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2383         guiparams.contour, <span class="keyword">...</span>
2384         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2385         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2386         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2387         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2388         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2389         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2390         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2391     
2392 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2393     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2394         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2395         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2396         guiparams.vertical_smoothing_window);
2397     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2398     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2399         guiparams.contour, <span class="keyword">...</span>
2400         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2401         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2402     
2403     guiparams.zmin = zmin;
2404     guiparams.zmax = zmax;
2405     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2406 <span class="keyword">end</span>
2407 
2408 <span class="comment">% Force plot to be formated properly</span>
2409 <span class="comment">% ----------------------------------</span>
2410 <span class="keyword">if</span> guiparams.presentation
2411     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2412 <span class="keyword">else</span>
2413     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2414 <span class="keyword">end</span>
2415 <span class="keyword">switch</span> guiparams.renderer
2416     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2417         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2418     <span class="keyword">case</span> <span class="string">'painters'</span>
2419         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2420     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2421         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2422 <span class="keyword">end</span>
2423 
2424 <span class="comment">% Focus the figure</span>
2425 <span class="comment">% ----------------</span>
2426 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2427 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2428     figure(hff)
2429 <span class="keyword">end</span>
2430 
2431 <span class="comment">% Re-store the Application data:</span>
2432 <span class="comment">% ------------------------------</span>
2433 guiparams.V = V;
2434 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2435 
2436 <span class="comment">% Start the Graphics Control Gui</span>
2437 <span class="comment">% ------------------------------</span>
2438 VMT_GraphicsControl
2439 
2440 <span class="comment">% Push messages to Log Window:</span>
2441 <span class="comment">% ----------------------------</span>
2442 statusLogging(handles.LogWindow, plot_cont_log_text)
2443 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2444 
2445 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2446 
2447 
2448 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2449 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2450 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2451 
2452 <span class="comment">% --------------------------------------------------------------------</span>
2453 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2454 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2455 
2456 <span class="comment">% Get the Application data:</span>
2457 <span class="comment">% -------------------------</span>
2458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2459 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2460 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2461 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2462 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2463 
2464 [the_file,the_path] = <span class="keyword">...</span>
2465     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2466     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2467     fullfile(guiparams.mat_path,guiparams.savefile));
2468 
2469 <span class="comment">% Save the processed data to a MAT file:</span>
2470 <span class="comment">% --------------------------------------</span>
2471 <span class="keyword">if</span> ischar(the_file)
2472     guiparams.mat_path = the_path;
2473     guiparams.mat_file = the_file;
2474     guiparams.savefile = the_file;
2475     
2476     <span class="comment">% Re-store the Application data:</span>
2477     <span class="comment">% ------------------------------</span>
2478     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2479     
2480     <span class="comment">% Update the preferences:</span>
2481     <span class="comment">% -----------------------</span>
2482     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2483     guiprefs.mat_path = the_path;
2484     guiprefs.mat_file = the_file;
2485     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2486     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2487     
2488     [~,filename,extension] = fileparts(guiparams.savefile);
2489     savefile = [filename extension];
2490     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2491         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2492     disp(<span class="string">'Saving Processed Data File...'</span>)
2493     disp(savefile)
2494     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2495 <span class="keyword">end</span>
2496 
2497 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2498 
2499 
2500 <span class="comment">% --------------------------------------------------------------------</span>
2501 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2502 
2503 <span class="comment">% Get the Application data:</span>
2504 <span class="comment">% -------------------------</span>
2505 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2506 <span class="comment">% z   = guiparams.z;</span>
2507 <span class="comment">% A   = guiparams.A;</span>
2508 V   = guiparams.V;
2509 <span class="comment">% Map = guiparams.Map;</span>
2510 
2511 [the_file,the_path] = <span class="keyword">...</span>
2512     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2513     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2514     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2515 
2516 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2517 <span class="comment">% ------------------------------------------</span>
2518 <span class="keyword">if</span> ischar(the_file)
2519     guiparams.tecplot_path = the_path;
2520     guiparams.tecplot_file = the_file;
2521     
2522     <span class="comment">% Re-store the Application data:</span>
2523     <span class="comment">% ------------------------------</span>
2524     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2525     
2526     <span class="comment">% Update the preferences:</span>
2527     <span class="comment">% -----------------------</span>
2528     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2529     guiprefs.tecplot_path = the_path;
2530     guiprefs.tecplot_file = the_file;
2531     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2532     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2533     
2534     <span class="comment">% Push to log window</span>
2535     <span class="comment">% ------------------</span>
2536     log_text = {<span class="keyword">...</span>
2537         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2538         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2539         the_path;<span class="keyword">...</span>
2540         [<span class="string">'Filename: '</span> the_file]};
2541     statusLogging(handles.LogWindow,log_text)
2542         
2543     <span class="keyword">if</span> isempty(V)
2544         A = guiparams.A;
2545         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2546         A(1).vgns = guiparams.vertical_grid_node_spacing;
2547         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2548         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2549             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2550             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2551             guiparams.eta);
2552     <span class="keyword">end</span>
2553     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2554     
2555     <span class="comment">% Push to log window</span>
2556     <span class="comment">% ------------------</span>
2557     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2558     statusLogging(handles.LogWindow,log_text)
2559     
2560     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2561     
2562     <span class="comment">% Push to log window</span>
2563     <span class="comment">% ------------------</span>
2564     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2565     statusLogging(handles.LogWindow,log_text)
2566    
2567 <span class="keyword">end</span>
2568 
2569 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2570 
2571 
2572 <span class="comment">% --------------------------------------------------------------------</span>
2573 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2574 
2575 <span class="comment">% Get the Application data:</span>
2576 <span class="comment">% -------------------------</span>
2577 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2578 <span class="comment">% z   = guiparams.z;</span>
2579 A   = guiparams.A;
2580 V   = guiparams.V;
2581 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2582 
2583 [the_file,the_path] = <span class="keyword">...</span>
2584     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2585     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2586     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2587 
2588 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2589 <span class="comment">% -----------------------------------------------------</span>
2590 <span class="keyword">if</span> ischar(the_file)
2591     guiparams.kmz_path = the_path;
2592     guiparams.kmz_file = the_file;
2593     
2594     <span class="comment">% Re-store the Application data:</span>
2595     <span class="comment">% ------------------------------</span>
2596     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2597     
2598     <span class="comment">% Update the preferences:</span>
2599     <span class="comment">% -----------------------</span>
2600     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2601     guiprefs.kmz_path = the_path;
2602     guiprefs.kmz_file = the_file;
2603     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2604     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2605     
2606     <span class="comment">%     if guiparams.display_shoreline</span>
2607     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2608     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2609     <span class="comment">%                             guiparams.vertical_offset);</span>
2610     <span class="comment">%     end</span>
2611     <span class="keyword">if</span> isempty(V)
2612         A = guiparams.A;
2613         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2614         A(1).vgns = guiparams.vertical_grid_node_spacing;
2615         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2616         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2617             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2618             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2619             guiparams.eta);
2620     <span class="keyword">end</span>
2621     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2622         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2623         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2624         guiparams.vertical_offset);
2625 <span class="keyword">end</span>
2626 
2627 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2628 
2629 
2630 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2631 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2632 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2633 
2634 <span class="comment">% --------------------------------------------------------------------</span>
2635 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2636 
2637 <span class="comment">% Get the Application data:</span>
2638 <span class="comment">% -------------------------</span>
2639 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2640 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2641 z = guiparams.z;
2642 A = guiparams.A;
2643 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2644 <span class="comment">% Map = guiparams.Map;</span>
2645 setends = guiparams.set_cross_section_endpoints;
2646 
2647 [the_file,the_path] = <span class="keyword">...</span>
2648     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2649     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2650     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2651     guiprefs.multibeambathymetry_file));
2652 
2653 <span class="keyword">if</span> ischar(the_file)
2654     guiparams.multibeambathymetry_path = the_path;
2655     guiparams.multibeambathymetry_file = the_file;
2656     
2657     <span class="comment">% Re-store the Application data:</span>
2658     <span class="comment">% ------------------------------</span>
2659     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2660     
2661     <span class="comment">% Update the preferences:</span>
2662     <span class="comment">% -----------------------</span>
2663     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2664     guiprefs.multibeambathymetry_path = the_path;
2665     guiprefs.multibeambathymetry_file = the_file;
2666     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2667     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2668     
2669     <span class="keyword">if</span> guiparams.output_auxiliary_data
2670     <span class="keyword">end</span>
2671     
2672     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2673     
2674     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2675         guiparams.multibeambathymetry_file);
2676     
2677     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2678         [<span class="string">'   '</span> savefile]};
2679     statusLogging(handles.LogWindow,log_text)
2680     
2681     <span class="comment">% Process the transects:</span>
2682     <span class="comment">% ----------------------</span>
2683     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2684     A(1).vgns = guiparams.vertical_grid_node_spacing;
2685     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2686     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2687         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2688     
2689     <span class="comment">% Compute the smoothed variables</span>
2690     <span class="comment">% ------------------------------</span>
2691     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2692     <span class="comment">% runtime.</span>
2693     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2694         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2695         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2696         guiparams.vertical_smoothing_window);
2697     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2698     <span class="comment">% Push messages to Log Window:</span>
2699     <span class="comment">% ----------------------------</span>
2700     statusLogging(handles.LogWindow, processing_log_text)
2701 
2702     
2703     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2704         guiparams.A, <span class="keyword">...</span>
2705         savefile, <span class="keyword">...</span>
2706         guiparams.beam_angle, <span class="keyword">...</span>
2707         guiparams.magnetic_variation, <span class="keyword">...</span>
2708         guiparams.wse, <span class="keyword">...</span>
2709         guiparams.output_auxiliary_data);
2710     
2711     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2712     
2713 <span class="keyword">end</span>
2714 
2715 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2716 
2717 
2718 <span class="comment">% --------------------------------------------------------------------</span>
2719 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2720 <span class="comment">% Get the beam angle</span>
2721 
2722 <span class="comment">% Get the Application data:</span>
2723 <span class="comment">% -------------------------</span>
2724 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2725 
2726 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2727 <span class="comment">% ----------------------------------------------------------------</span>
2728 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2729 is_a_number = ~isnan(new_beam_angle);
2730 is_positive = new_beam_angle&gt;=0;
2731 
2732 <span class="comment">% Modify the Application data:</span>
2733 <span class="comment">% ----------------------------</span>
2734 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2735     guiparams.beam_angle = new_beam_angle;
2736     
2737     <span class="comment">% Re-store the Application data:</span>
2738     <span class="comment">% ------------------------------</span>
2739     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2740     
2741 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2742     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2743 <span class="keyword">end</span>
2744 
2745 <span class="comment">% [EOF] BeamAngle_Callback</span>
2746 
2747 
2748 <span class="comment">% --------------------------------------------------------------------</span>
2749 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2750 <span class="comment">% Get the Magnetic Variation</span>
2751 
2752 <span class="comment">% Get the Application data:</span>
2753 <span class="comment">% -------------------------</span>
2754 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2755 
2756 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2757 <span class="comment">% ----------------------------------------------------------------</span>
2758 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2759 is_a_number = ~isnan(new_magnetic_variation);
2760 is_positive = new_magnetic_variation&gt;=0;
2761 
2762 <span class="comment">% Modify the Application data:</span>
2763 <span class="comment">% ----------------------------</span>
2764 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2765     guiparams.magnetic_variation = new_magnetic_variation;
2766     
2767     <span class="comment">% Re-store the Application data:</span>
2768     <span class="comment">% ------------------------------</span>
2769     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2770     
2771 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2772     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2773 <span class="keyword">end</span>
2774 
2775 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2776 
2777 
2778 <span class="comment">% --------------------------------------------------------------------</span>
2779 <a name="_sub68" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2780 
2781 <span class="comment">% Get the Application data:</span>
2782 <span class="comment">% -------------------------</span>
2783 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2784 
2785 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2786 <span class="comment">% ----------------------------------------------------------------</span>
2787 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2788 is_a_number = ~isnan(new_wse);
2789 is_positive = new_wse&gt;=0;
2790 
2791 <span class="comment">% Modify the Application data:</span>
2792 <span class="comment">% ----------------------------</span>
2793 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2794     guiparams.wse = new_wse;
2795     
2796     <span class="comment">% Re-store the Application data:</span>
2797     <span class="comment">% ------------------------------</span>
2798     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2799     
2800 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2801     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2802 <span class="keyword">end</span>
2803 
2804 <span class="comment">% [EOF] WSE_Callback</span>
2805 
2806 
2807 <span class="comment">% --------------------------------------------------------------------</span>
2808 <a name="_sub69" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2809 <span class="comment">% Bathymetry Auxiliary Data</span>
2810 
2811 <span class="comment">% Get the Application data:</span>
2812 <span class="comment">% -------------------------</span>
2813 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2814 
2815 <span class="comment">% Modify the Application data:</span>
2816 <span class="comment">% ----------------------------</span>
2817 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2818 
2819 <span class="comment">% Re-store the Application data:</span>
2820 <span class="comment">% ------------------------------</span>
2821 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2822 
2823 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2824 
2825 
2826 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2827 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2828 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2829 
2830 <span class="comment">% --------------------------------------------------------------------</span>
2831 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2832 
2833 <span class="comment">% Get the Application data:</span>
2834 <span class="comment">% -------------------------</span>
2835 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2836 
2837 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2838 <span class="comment">% ----------------------------------------------------------------</span>
2839 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2840 is_a_number = ~isnan(new_depth_range_min);
2841 is_positive = new_depth_range_min&gt;=0;
2842 
2843 <span class="comment">% Modify the Application data:</span>
2844 <span class="comment">% ----------------------------</span>
2845 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2846     guiparams.depth_range_min = new_depth_range_min;
2847     
2848     <span class="comment">% Re-store the Application data:</span>
2849     <span class="comment">% ------------------------------</span>
2850     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2851     
2852 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2853     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2854 <span class="keyword">end</span>
2855 
2856 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2857 
2858 
2859 <span class="comment">% --------------------------------------------------------------------</span>
2860 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2861 
2862 <span class="comment">% Get the Application data:</span>
2863 <span class="comment">% -------------------------</span>
2864 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2865 
2866 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2867 <span class="comment">% ----------------------------------------------------------------</span>
2868 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2869 is_a_number = ~isnan(new_depth_range_max);
2870 is_positive = new_depth_range_max&gt;=0;
2871 
2872 <span class="comment">% Modify the Application data:</span>
2873 <span class="comment">% ----------------------------</span>
2874 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2875     guiparams.depth_range_max = new_depth_range_max;
2876     
2877     <span class="comment">% Re-store the Application data:</span>
2878     <span class="comment">% ------------------------------</span>
2879     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2880     
2881 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2882     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2883 <span class="keyword">end</span>
2884 
2885 <span class="comment">% [EOF] DepthMax_Callback</span>
2886 
2887 
2888 <span class="comment">% --------------------------------------------------------------------</span>
2889 <a name="_sub72" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2890 <span class="comment">% Set quiver scale (contour)</span>
2891 
2892 <span class="comment">% Get the Application data:</span>
2893 <span class="comment">% -------------------------</span>
2894 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2895 
2896 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2897 <span class="comment">% ----------------------------------------------------------------</span>
2898 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2899 is_a_number = ~isnan(new_vector_scale_plan_view);
2900 is_positive = new_vector_scale_plan_view&gt;=0;
2901 
2902 <span class="comment">% Modify the Application data:</span>
2903 <span class="comment">% ----------------------------</span>
2904 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2905     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2906     
2907     <span class="comment">% Re-store the Application data:</span>
2908     <span class="comment">% ------------------------------</span>
2909     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2910     
2911 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2912     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2913 <span class="keyword">end</span>
2914 
2915 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2916 
2917 
2918 <span class="comment">% --------------------------------------------------------------------</span>
2919 <a name="_sub73" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2920 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2921 
2922 <span class="comment">% Get the Application data:</span>
2923 <span class="comment">% -------------------------</span>
2924 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2925 
2926 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2927 <span class="comment">% ----------------------------------------------------------------</span>
2928 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2929 is_a_number = ~isnan(new_vector_spacing_plan_view);
2930 is_positive = new_vector_spacing_plan_view&gt;=0;
2931 
2932 <span class="comment">% Modify the Application data:</span>
2933 <span class="comment">% ----------------------------</span>
2934 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2935     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2936     
2937     <span class="comment">% Re-store the Application data:</span>
2938     <span class="comment">% ------------------------------</span>
2939     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2940     
2941 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2942     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2943 <span class="keyword">end</span>
2944 
2945 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2946 
2947 
2948 <span class="comment">% --------------------------------------------------------------------</span>
2949 <a name="_sub74" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2950 <span class="comment">% Plan View smoothing window size</span>
2951 
2952 <span class="comment">% Get the Application data:</span>
2953 <span class="comment">% -------------------------</span>
2954 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2955 
2956 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2957 <span class="comment">% ----------------------------------------------------------------</span>
2958 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2959 is_a_number = ~isnan(new_smoothing_window_size);
2960 is_positive = new_smoothing_window_size&gt;=0;
2961 
2962 <span class="comment">% Modify the Application data:</span>
2963 <span class="comment">% ----------------------------</span>
2964 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2965     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2966     
2967     <span class="comment">% Re-store the Application data:</span>
2968     <span class="comment">% ------------------------------</span>
2969     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2970     
2971 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2972     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2973 <span class="keyword">end</span>
2974 
2975 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2976 
2977 
2978 <span class="comment">% --------------------------------------------------------------------</span>
2979 <a name="_sub75" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2980 
2981 <span class="comment">% Get the Application data:</span>
2982 <span class="comment">% -------------------------</span>
2983 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2984 
2985 <span class="comment">% Modify the Application data:</span>
2986 <span class="comment">% ----------------------------</span>
2987 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2988 
2989 <span class="comment">% Re-store the Application data:</span>
2990 <span class="comment">% ------------------------------</span>
2991 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2992 
2993 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2994 
2995 
2996 <span class="comment">% --------------------------------------------------------------------</span>
2997 <a name="_sub76" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2998 
2999 <span class="comment">% Get the Application data:</span>
3000 <span class="comment">% -------------------------</span>
3001 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3002 
3003 <span class="comment">% Modify the Application data:</span>
3004 <span class="comment">% ----------------------------</span>
3005 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3006 
3007 <span class="comment">% Re-store the Application data:</span>
3008 <span class="comment">% ------------------------------</span>
3009 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3010 
3011 <span class="comment">% [EOF] AddBackground_Callback</span>
3012 
3013 
3014 <span class="comment">% --------------------------------------------------------------------</span>
3015 <a name="_sub77" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3016 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3017 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3018 
3019 
3020 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3021 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3022 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3023 
3024 <span class="comment">% --------------------------------------------------------------------</span>
3025 <a name="_sub78" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3026 <span class="comment">% Set the horizontal grid node spacing</span>
3027 
3028 <span class="comment">% Get the Application data:</span>
3029 <span class="comment">% -------------------------</span>
3030 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3031 
3032 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3033 <span class="comment">% ----------------------------------------------------------------</span>
3034 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3035 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3036 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3037 
3038 <span class="comment">% Modify the Application data:</span>
3039 <span class="comment">% ----------------------------</span>
3040 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3041     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3042     
3043     <span class="comment">% Re-store the Application data:</span>
3044     <span class="comment">% ------------------------------</span>
3045     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3046     
3047 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3048     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3049 <span class="keyword">end</span>
3050 
3051 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3052 
3053 <span class="comment">% --------------------------------------------------------------------</span>
3054 <a name="_sub79" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3055 <span class="comment">% Set the horizontal grid node spacing</span>
3056 
3057 <span class="comment">% Get the Application data:</span>
3058 <span class="comment">% -------------------------</span>
3059 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3060 
3061 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3062 <span class="comment">% ----------------------------------------------------------------</span>
3063 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3064 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3065 is_positive = new_vertical_grid_node_spacing&gt;=0;
3066 
3067 <span class="comment">% Modify the Application data:</span>
3068 <span class="comment">% ----------------------------</span>
3069 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3070     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3071     
3072     <span class="comment">% Re-store the Application data:</span>
3073     <span class="comment">% ------------------------------</span>
3074     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3075     
3076 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3077     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3078 <span class="keyword">end</span>
3079 
3080 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3081 
3082 <span class="comment">% --------------------------------------------------------------------</span>
3083 <a name="_sub80" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3084 <span class="comment">% Set the cross section endpoints manually</span>
3085 
3086 <span class="comment">% Get the Application data:</span>
3087 <span class="comment">% -------------------------</span>
3088 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3089 
3090 <span class="comment">% Modify the Application data:</span>
3091 <span class="comment">% ----------------------------</span>
3092 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3093 
3094 <span class="comment">% Re-store the Application data:</span>
3095 <span class="comment">% ------------------------------</span>
3096 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3097 
3098 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3099 
3100 
3101 <span class="comment">% --------------------------------------------------------------------</span>
3102 <a name="_sub81" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3103 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3104 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3105 
3106 
3107 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3108 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3109 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3110 
3111 <span class="comment">% --------------------------------------------------------------------</span>
3112 <a name="_sub82" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3113 
3114 <span class="comment">% Get the Application data:</span>
3115 <span class="comment">% -------------------------</span>
3116 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3117 
3118 <span class="comment">% Modify the Application data:</span>
3119 <span class="comment">% ----------------------------</span>
3120 idx_variable = get(hObject,<span class="string">'Value'</span>);
3121 guiparams.idx_contour = idx_variable;
3122 guiparams.contour = guiparams.contours(idx_variable).variable;
3123 
3124 <span class="comment">% Re-store the Application data:</span>
3125 <span class="comment">% ------------------------------</span>
3126 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3127 
3128 <span class="comment">% [EOF] Contour_Callback</span>
3129 
3130 
3131 <span class="comment">% --------------------------------------------------------------------</span>
3132 <a name="_sub83" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3133 <span class="comment">% Set vertical exaggeration</span>
3134 
3135 <span class="comment">% Get the Application data:</span>
3136 <span class="comment">% -------------------------</span>
3137 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3138 
3139 <span class="comment">% Modify the Application data:</span>
3140 <span class="comment">% ----------------------------</span>
3141 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3142 
3143 <span class="comment">% Re-store the Application data:</span>
3144 <span class="comment">% ------------------------------</span>
3145 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3146 
3147 <span class="comment">% Update the GUI:</span>
3148 <span class="comment">% ---------------</span>
3149 <span class="comment">% updateGUI(handles,guiparams)</span>
3150 
3151 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3152 
3153 
3154 <span class="comment">% --------------------------------------------------------------------</span>
3155 <a name="_sub84" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3156 
3157 <span class="comment">% Get the Application data:</span>
3158 <span class="comment">% -------------------------</span>
3159 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3160 
3161 <span class="comment">% Modify the Application data:</span>
3162 <span class="comment">% ----------------------------</span>
3163 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3164 
3165 <span class="comment">% Re-store the Application data:</span>
3166 <span class="comment">% ------------------------------</span>
3167 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3168 
3169 <span class="comment">% Update the GUI:</span>
3170 <span class="comment">% ---------------</span>
3171 <span class="comment">% updateGUI(handles,guiparams)</span>
3172 
3173 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3174 
3175 
3176 <span class="comment">% --------------------------------------------------------------------</span>
3177 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3178 
3179 <span class="comment">% Get the Application data:</span>
3180 <span class="comment">% -------------------------</span>
3181 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3182 
3183 <span class="comment">% Modify the Application data:</span>
3184 <span class="comment">% ----------------------------</span>
3185 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3186 
3187 <span class="comment">% Re-store the Application data:</span>
3188 <span class="comment">% ------------------------------</span>
3189 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3190 
3191 <span class="comment">% Update the GUI:</span>
3192 <span class="comment">% ---------------</span>
3193 <span class="comment">% updateGUI(handles,guiparams)</span>
3194 
3195 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3196 
3197 
3198 <span class="comment">% --------------------------------------------------------------------</span>
3199 <a name="_sub86" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3200 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3201 
3202 <span class="comment">% Get the Application data:</span>
3203 <span class="comment">% -------------------------</span>
3204 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3205 
3206 <span class="comment">% Modify the Application data:</span>
3207 <span class="comment">% ----------------------------</span>
3208 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3209 
3210 <span class="comment">% Re-store the Application data:</span>
3211 <span class="comment">% ------------------------------</span>
3212 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3213 
3214 <span class="comment">% Update the GUI:</span>
3215 <span class="comment">% ---------------</span>
3216 <span class="comment">% updateGUI(handles,guiparams)</span>
3217 
3218 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3219 
3220 
3221 <span class="comment">% --------------------------------------------------------------------</span>
3222 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3223 <span class="comment">% Horizontal Smoothing</span>
3224 
3225 <span class="comment">% Get the Application data:</span>
3226 <span class="comment">% -------------------------</span>
3227 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3228 
3229 <span class="comment">% Modify the Application data:</span>
3230 <span class="comment">% ----------------------------</span>
3231 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3232 
3233 <span class="comment">% Re-store the Application data:</span>
3234 <span class="comment">% ------------------------------</span>
3235 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3236 
3237 <span class="comment">% Update the GUI:</span>
3238 <span class="comment">% ---------------</span>
3239 <span class="comment">% updateGUI(handles,guiparams)</span>
3240 
3241 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3242 
3243 
3244 <span class="comment">% --------------------------------------------------------------------</span>
3245 <a name="_sub88" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3246 <span class="comment">% Vertical Smoothing</span>
3247 
3248 <span class="comment">% Get the Application data:</span>
3249 <span class="comment">% -------------------------</span>
3250 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3251 
3252 <span class="comment">% Modify the Application data:</span>
3253 <span class="comment">% ----------------------------</span>
3254 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3255 
3256 <span class="comment">% Re-store the Application data:</span>
3257 <span class="comment">% ------------------------------</span>
3258 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3259 
3260 <span class="comment">% Update the GUI:</span>
3261 <span class="comment">% ---------------</span>
3262 <span class="comment">% updateGUI(handles,guiparams)</span>
3263 
3264 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3265 
3266 
3267 <span class="comment">% --------------------------------------------------------------------</span>
3268 <a name="_sub89" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3269 
3270 <span class="comment">% Get the Application data:</span>
3271 <span class="comment">% -------------------------</span>
3272 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3273 
3274 <span class="comment">% Modify the Application data:</span>
3275 <span class="comment">% ----------------------------</span>
3276 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3277 
3278 <span class="comment">% Re-store the Application data:</span>
3279 <span class="comment">% ------------------------------</span>
3280 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3281 
3282 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3283 
3284 
3285 <span class="comment">% --------------------------------------------------------------------</span>
3286 <a name="_sub90" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3287 
3288 <span class="comment">% Get the Application data:</span>
3289 <span class="comment">% -------------------------</span>
3290 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3291 
3292 <span class="comment">% Modify the Application data:</span>
3293 <span class="comment">% ----------------------------</span>
3294 idx_variable = get(hObject,<span class="string">'Value'</span>);
3295 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3296 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3297 
3298 <span class="comment">% Re-store the Application data:</span>
3299 <span class="comment">% ------------------------------</span>
3300 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3301 
3302 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3303 
3304 
3305 <span class="comment">% --------------------------------------------------------------------</span>
3306 <a name="_sub91" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3307 
3308 <span class="comment">% Get the Application data:</span>
3309 <span class="comment">% -------------------------</span>
3310 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3311 
3312 <span class="comment">% Modify the Application data:</span>
3313 <span class="comment">% ----------------------------</span>
3314 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3315 
3316 <span class="comment">% Re-store the Application data:</span>
3317 <span class="comment">% ------------------------------</span>
3318 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3319 
3320 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3321 
3322 
3323 <span class="comment">% --------------------------------------------------------------------</span>
3324 <a name="_sub92" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3325 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3326 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3327 
3328 
3329 <span class="comment">% --------------------------------------------------------------------</span>
3330 <a name="_sub93" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3331 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3332 <span class="comment">% [EOF] ClearLog_Callback</span>
3333 
3334 <span class="comment">% --------------------------------------------------------------------</span>
3335 <a name="_sub94" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3336 
3337 <span class="comment">% Get the Application data:</span>
3338 <span class="comment">% -------------------------</span>
3339 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3340 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3341 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3342 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3343 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3344 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3345 
3346 [the_file,the_path] = <span class="keyword">...</span>
3347     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3348     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3349     fullfile(guiprefs.log_path,guiprefs.log_file));
3350 
3351 <span class="comment">% Save the log to a TXT file:</span>
3352 <span class="comment">% ---------------------------</span>
3353 <span class="keyword">if</span> ischar(the_file)
3354     guiparams.log_path = the_path;
3355     guiparams.log_file = the_file;
3356     <span class="comment">%guiparams.savefile = the_file;</span>
3357     
3358     <span class="comment">% Re-store the Application data:</span>
3359     <span class="comment">% ------------------------------</span>
3360     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3361     
3362     <span class="comment">% Update the preferences:</span>
3363     <span class="comment">% -----------------------</span>
3364     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3365     guiprefs.log_path = the_path;
3366     guiprefs.log_file = the_file;
3367     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3368     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3369     
3370     [~,filename,extension] = fileparts(the_file);
3371     savefile = [the_path filename extension];
3372     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3373         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3374     
3375     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3376     [nrows,~]= size(logfile);
3377     fid = fopen(savefile, <span class="string">'w'</span>);
3378     <span class="keyword">for</span> row=1:nrows
3379         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3380     <span class="keyword">end</span>
3381     fclose(fid);
3382 <span class="keyword">end</span>
3383 <span class="comment">% [EOF] SaveLog_Callback</span>
3384 
3385 <span class="comment">%%%%%%%%%%%%%%%%</span>
3386 <span class="comment">% SUBFUNCTIONS %</span>
3387 <span class="comment">%%%%%%%%%%%%%%%%</span>
3388 
3389 <span class="comment">% --------------------------------------------------------------------</span>
3390 <a name="_sub95" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3391 
3392 icons = <a href="#_sub111" class="code" title="subfunction icons = getIcons">getIcons</a>;
3393 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3394 
3395 <span class="comment">% Load data</span>
3396 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3397 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3398 <span class="comment">% icon(icon==0) = NaN;</span>
3399 handles.toolbarLoadData = <span class="keyword">...</span>
3400     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3401     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3402     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3403 
3404 <span class="comment">% Save data</span>
3405 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3406 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3407 <span class="comment">% icon(icon==0) = NaN;</span>
3408 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3409     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3410     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3411     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3412     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3413 
3414 
3415 <span class="comment">% Save bathymetry</span>
3416 <span class="comment">%icon = ones(16,16,3);</span>
3417 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3418     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3419     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3420     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3421 
3422 <span class="comment">% Save figures</span>
3423 <span class="comment">% icon = ones(16,16,3);</span>
3424 handles.toolbarSaveFigures = <span class="keyword">...</span>
3425     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3426     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3427     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3428 
3429 <span class="comment">% Save Excel File</span>
3430 <span class="comment">% icon = ones(16,16,3);</span>
3431 handles.toolbarSaveExcel = <span class="keyword">...</span>
3432     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3433     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3434     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3435 
3436 
3437 <span class="comment">% Plotting parameters</span>
3438 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3439 <span class="comment">% icon = ind2rgb(icon,map);</span>
3440 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3441     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3442     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3443     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3444     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3445 
3446 <span class="comment">% Processing parameters</span>
3447 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3448 <span class="comment">% icon = ind2rgb(icon,map);</span>
3449 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3450     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3451     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3452     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3453 
3454 <span class="comment">% Zoom In</span>
3455 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3456 <span class="comment">% icon = ind2rgb(icon,map);</span>
3457 <span class="comment">% handles.toolbarZoomIn = ...</span>
3458 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3459 <span class="comment">%     'CData',        icons(8).data, ...</span>
3460 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3461 <span class="comment">%     'Separator',     'on');</span>
3462 
3463 <span class="comment">% Zoom Out</span>
3464 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3465 <span class="comment">% icon = ind2rgb(icon,map);</span>
3466 <span class="comment">% handles.toolbarZoomOut = ...</span>
3467 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3468 <span class="comment">%     'CData',        icons(9).data, ...</span>
3469 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3470 
3471 <span class="comment">% Pan</span>
3472 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3473 <span class="comment">% icon = ind2rgb(icon,map);</span>
3474 <span class="comment">% handles.toolbarPan = ...</span>
3475 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3476 <span class="comment">%     'CData',        icons(10).data, ...</span>
3477 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3478 
3479 
3480 
3481 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3482 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3483 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3484 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3485 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3486 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3487 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3488 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3489 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3490 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3491 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3492 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3493 
3494 <span class="comment">% [EOF] buildtoolbar</span>
3495 
3496 
3497 <span class="comment">% --------------------------------------------------------------------</span>
3498 <a name="_sub96" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3499 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3500 <span class="comment">% already exist.</span>
3501 
3502 <span class="comment">% Preferences:</span>
3503 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3504 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3505 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3506 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3507 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3508 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3509 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3510 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3511 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3512 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3513 <span class="comment">% 'renderer'             Default graphics renderer</span>
3514 <span class="comment">% 'units'                Default plotting units</span>
3515 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3516 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3517 <span class="comment">%                        started</span>
3518 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3519 
3520 <span class="comment">% Originals</span>
3521 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3522 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3523 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3524 
3525 <span class="comment">% ASCII</span>
3526 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3527     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3528     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3529         guiprefs.ascii_path = ascii.path;
3530     <span class="keyword">else</span>
3531         guiprefs.ascii_path = pwd;
3532     <span class="keyword">end</span>
3533     does_exist = false(1,length(ascii.file));
3534     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3535         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3536     <span class="keyword">end</span>
3537     <span class="keyword">if</span> any(does_exist)
3538         guiprefs.ascii_file = ascii.file(does_exist);
3539     <span class="keyword">else</span>
3540         guiprefs.ascii_file = {<span class="string">''</span>};
3541     <span class="keyword">end</span>
3542 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3543     guiprefs.ascii_path = pwd;
3544     guiprefs.ascii_file = {<span class="string">''</span>};
3545     
3546     ascii.path = pwd;
3547     ascii.file = {<span class="string">''</span>};
3548     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3549 <span class="keyword">end</span>
3550 
3551 <span class="comment">% MAT</span>
3552 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3553     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3554     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3555         guiprefs.mat_path = mat.path;
3556     <span class="keyword">else</span>
3557         guiprefs.mat_path = pwd;
3558     <span class="keyword">end</span>
3559     
3560     <span class="keyword">if</span> iscell(mat.file)
3561         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3562             guiprefs.mat_file = mat.file;
3563         <span class="keyword">else</span>
3564             guiprefs.mat_file = <span class="string">''</span>;
3565         <span class="keyword">end</span>
3566     <span class="keyword">else</span>
3567         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3568             guiprefs.mat_file = mat.file;
3569         <span class="keyword">else</span>
3570             guiprefs.mat_file = <span class="string">''</span>;
3571         <span class="keyword">end</span>
3572     <span class="keyword">end</span>
3573 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3574     guiprefs.mat_path = pwd;
3575     guiprefs.mat_file = <span class="string">''</span>;
3576     
3577     mat.path = pwd;
3578     mat.file = <span class="string">''</span>;
3579     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3580 <span class="keyword">end</span>
3581 
3582 <span class="comment">% TECPLOT</span>
3583 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3584     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3585     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3586         guiprefs.tecplot_path = tecplot.path;
3587     <span class="keyword">else</span>
3588         guiprefs.tecplot_path = pwd;
3589     <span class="keyword">end</span>
3590     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3591         guiprefs.tecplot_file = tecplot.file;
3592     <span class="keyword">else</span>
3593         guiprefs.tecplot_file = <span class="string">''</span>;
3594     <span class="keyword">end</span>
3595 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3596     guiprefs.tecplot_path = pwd;
3597     guiprefs.tecplot_file = <span class="string">''</span>;
3598     
3599     tecplot.path = pwd;
3600     tecplot.file = <span class="string">''</span>;
3601     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3602 <span class="keyword">end</span>
3603 
3604 <span class="comment">% KMZ</span>
3605 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3606     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3607     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3608         guiprefs.kmz_path = kmz.path;
3609     <span class="keyword">else</span>
3610         guiprefs.kmz_path = pwd;
3611     <span class="keyword">end</span>
3612     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3613         guiprefs.kmz_file = kmz.file;
3614     <span class="keyword">else</span>
3615         guiprefs.kmz_file = <span class="string">''</span>;
3616     <span class="keyword">end</span>
3617 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3618     guiprefs.kmz_path = pwd;
3619     guiprefs.kmz_file = <span class="string">''</span>;
3620     
3621     kmz.path = pwd;
3622     kmz.file = <span class="string">''</span>;
3623     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3624 <span class="keyword">end</span>
3625 
3626 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3627 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3628     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3629     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3630         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3631     <span class="keyword">else</span>
3632         guiprefs.multibeambathymetry_path = pwd;
3633     <span class="keyword">end</span>
3634     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3635         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3636     <span class="keyword">else</span>
3637         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3638     <span class="keyword">end</span>
3639 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3640     guiprefs.multibeambathymetry_path = pwd;
3641     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3642     
3643     multibeambathymetry.path = pwd;
3644     multibeambathymetry.file = <span class="string">''</span>;
3645     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3646 <span class="keyword">end</span>
3647 
3648 <span class="comment">% Log</span>
3649 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3650     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3651     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3652         guiprefs.log_path = log.path;
3653     <span class="keyword">else</span>
3654         guiprefs.log_path = pwd;
3655     <span class="keyword">end</span>
3656     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3657         guiprefs.log_file = log.file;
3658     <span class="keyword">else</span>
3659         guiprefs.log_file = <span class="string">''</span>;
3660     <span class="keyword">end</span>
3661 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3662     guiprefs.log_path = pwd;
3663     guiprefs.log_file = <span class="string">''</span>;
3664     
3665     log.path = pwd;
3666     log.file = <span class="string">''</span>;
3667     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3668 <span class="keyword">end</span>
3669 
3670 <span class="comment">% iRic</span>
3671 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3672     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3673     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3674         guiprefs.iric_path = iric.path;
3675     <span class="keyword">else</span>
3676         guiprefs.iric_path = pwd;
3677     <span class="keyword">end</span>
3678     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3679         guiprefs.iric_file = iric.file;
3680     <span class="keyword">else</span>
3681         guiprefs.iric_file = <span class="string">''</span>;
3682     <span class="keyword">end</span>
3683 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3684     guiprefs.iric_path = pwd;
3685     guiprefs.iric_file = <span class="string">''</span>;
3686     
3687     iric.path = pwd;
3688     iric.file = <span class="string">''</span>;
3689     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3690 <span class="keyword">end</span>
3691 
3692 <span class="comment">% excel</span>
3693 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3694     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3695     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3696         guiprefs.excel_path = excel.path;
3697     <span class="keyword">else</span>
3698         guiprefs.excel_path = pwd;
3699     <span class="keyword">end</span>
3700     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3701         guiprefs.excel_file = excel.file;
3702     <span class="keyword">else</span>
3703         guiprefs.excel_file = <span class="string">''</span>;
3704     <span class="keyword">end</span>
3705 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3706     guiprefs.excel_path = pwd;
3707     guiprefs.excel_file = <span class="string">''</span>;
3708     
3709     excel.path = pwd;
3710     excel.file = <span class="string">''</span>;
3711     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3712 <span class="keyword">end</span>
3713 
3714 <span class="comment">% aerial</span>
3715 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3716     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3717     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3718         guiprefs.aerial_path = aerial.path;
3719     <span class="keyword">else</span>
3720         guiprefs.aerial_path = pwd;
3721     <span class="keyword">end</span>
3722     does_exist = false(1,length(aerial.file));
3723     <span class="keyword">if</span> iscell(aerial.file)
3724     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3725         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3726     <span class="keyword">end</span>
3727     <span class="keyword">else</span>
3728         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3729     <span class="keyword">end</span>
3730     <span class="keyword">if</span> any(does_exist)
3731         guiprefs.aerial_file = aerial.file;
3732     <span class="keyword">else</span>
3733         guiprefs.aerial_file = {<span class="string">''</span>};
3734     <span class="keyword">end</span>
3735 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3736     guiprefs.aerial_path = pwd;
3737     guiprefs.aerial_file = {<span class="string">''</span>};
3738     
3739     aerial.path = pwd;
3740     aerial.file = {<span class="string">''</span>};
3741     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3742 <span class="keyword">end</span>
3743 
3744 <span class="comment">% shoreline</span>
3745 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3746     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3747     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3748         guiprefs.shoreline_path = shoreline.path;
3749     <span class="keyword">else</span>
3750         guiprefs.shoreline_path = pwd;
3751     <span class="keyword">end</span>
3752     
3753     <span class="keyword">if</span> iscell(shoreline.file)
3754         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3755             guiprefs.shoreline_file = shoreline.file;
3756         <span class="keyword">else</span>
3757             guiprefs.shoreline_file = <span class="string">''</span>;
3758         <span class="keyword">end</span>
3759     <span class="keyword">else</span>
3760         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3761             guiprefs.shoreline_file = shoreline.file;
3762         <span class="keyword">else</span>
3763             guiprefs.shoreline_file = <span class="string">''</span>;
3764         <span class="keyword">end</span>
3765     <span class="keyword">end</span>
3766 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3767     guiprefs.shoreline_path = pwd;
3768     guiprefs.shoreline_file = <span class="string">''</span>;
3769     
3770     shoreline.path = pwd;
3771     shoreline.file = <span class="string">''</span>;
3772     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3773 <span class="keyword">end</span>
3774 <span class="comment">% guiprefs.presentation = true;</span>
3775 <span class="comment">% guiprefs.print        = false;</span>
3776 
3777 <span class="comment">% for k = 1:length(prefs)</span>
3778 <span class="comment">%     newpref = '';</span>
3779 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3780 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3781 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3782 <span class="comment">%             newpref = stored_newpref;</span>
3783 <span class="comment">%         else</span>
3784 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3785 <span class="comment">%         end</span>
3786 <span class="comment">%     end</span>
3787 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3788 <span class="comment">% end</span>
3789 
3790 <span class="comment">% RENDERER</span>
3791 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3792     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3793     guiprefs.renderer = renderer;
3794 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3795     renderer           = <span class="string">'OpenGL'</span>;
3796     guiprefs.renderer  = renderer;
3797     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3798 <span class="keyword">end</span>
3799 
3800 <span class="comment">% UNITS</span>
3801 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3802     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3803     guiprefs.units = units;
3804 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
3805     units           = <span class="string">'metric'</span>;
3806     guiprefs.units  = units;
3807     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3808 <span class="keyword">end</span>
3809 
3810 <span class="comment">% PLOTREF</span>
3811 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
3812     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
3813     guiprefs.plotref = plotref;
3814 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
3815     plotref           = <span class="string">'dfs'</span>;
3816     guiprefs.plotref  = plotref;
3817     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
3818 <span class="keyword">end</span>
3819 
3820 <span class="comment">% RUNCOUNTER</span>
3821 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3822     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3823     guiprefs.runcounter = runcounter;
3824 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3825     runcounter           = 1;
3826     guiprefs.runcounter  = runcounter;
3827     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3828 <span class="keyword">end</span>
3829 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3830 
3831 <span class="comment">% SETENDPOINTS</span>
3832 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
3833     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
3834     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
3835         guiprefs.setendpoints_path = setendpoints.path;
3836     <span class="keyword">else</span>
3837         guiprefs.setendpoints_path = pwd;
3838     <span class="keyword">end</span>
3839     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
3840         guiprefs.setendpoints_file = setendpoints.file;
3841     <span class="keyword">else</span>
3842         guiprefs.setendpoints_file = <span class="string">''</span>;
3843     <span class="keyword">end</span>
3844 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3845     guiprefs.setendpoints_path = pwd;
3846     guiprefs.setendpoints_file = <span class="string">''</span>;
3847     
3848     setendpoints.path = pwd;
3849     setendpoints.file = <span class="string">''</span>;
3850     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3851 <span class="keyword">end</span>
3852 
3853 <span class="comment">% [EOF] load_prefs</span>
3854 
3855 
3856 <span class="comment">% --------------------------------------------------------------------</span>
3857 <a name="_sub97" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3858 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3859 <span class="comment">% preferences data.</span>
3860 
3861 <span class="comment">% Preferences:</span>
3862 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3863 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3864 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3865 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3866 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3867 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3868 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3869 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3870 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3871 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3872 <span class="comment">% 'renderer'             Default graphics renderer</span>
3873 <span class="comment">% 'units'                Default plotting units</span>
3874 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3875 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3876 <span class="comment">%                        started</span>
3877 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
3878 
3879 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3880 
3881 <span class="keyword">switch</span> pref
3882     <span class="keyword">case</span> <span class="string">'ascii'</span>
3883         ascii.path = guiprefs.ascii_path;
3884         ascii.file = guiprefs.ascii_file;
3885         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3886     <span class="keyword">case</span> <span class="string">'mat'</span>
3887         mat.path = guiprefs.mat_path;
3888         mat.file = guiprefs.mat_file;
3889         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3890     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3891         tecplot.path = guiprefs.tecplot_path;
3892         tecplot.file = guiprefs.tecplot_file;
3893         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3894     <span class="keyword">case</span> <span class="string">'kmz'</span>
3895         kmz.path = guiprefs.kmz_path;
3896         kmz.file = guiprefs.kmz_file;
3897         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3898     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3899         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3900         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3901         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3902     <span class="keyword">case</span> <span class="string">'log'</span>
3903         log.path = guiprefs.log_path;
3904         log.file = guiprefs.log_file;
3905         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3906     <span class="keyword">case</span> <span class="string">'iric'</span>
3907         iric.path = guiprefs.iric_path;
3908         iric.file = guiprefs.iric_file;
3909         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3910     <span class="keyword">case</span> <span class="string">'excel'</span>
3911         excel.path = guiprefs.excel_path;
3912         excel.file = guiprefs.excel_file;
3913         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3914     <span class="keyword">case</span> <span class="string">'aerial'</span>
3915         aerial.path = guiprefs.aerial_path;
3916         aerial.file = guiprefs.aerial_file;
3917         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3918     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3919         shoreline.path = guiprefs.shoreline_path;
3920         shoreline.file = guiprefs.shoreline_file;
3921         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3922     <span class="keyword">case</span> <span class="string">'renderer'</span>
3923         renderer = guiprefs.renderer;
3924         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3925     <span class="keyword">case</span> <span class="string">'units'</span>
3926         units = guiprefs.units;
3927         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3928     <span class="keyword">case</span> <span class="string">'plotref'</span>
3929         plotref = guiprefs.plotref;
3930         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
3931     <span class="keyword">case</span> <span class="string">'runcounter'</span>
3932         runcounter = guiprefs.runcounter;
3933         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3934     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
3935         setendpoints.path = guiprefs.setendpoints_path;
3936         setendpoints.file = guiprefs.setendpoints_file;
3937         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3938     <span class="keyword">otherwise</span>
3939 <span class="keyword">end</span>
3940 
3941 <span class="comment">% if ismember(pref,prefs)</span>
3942 <span class="comment">%     setpref('VMT',pref,value)</span>
3943 <span class="comment">%</span>
3944 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3945 <span class="comment">%     guiprefs.(pref) = value;</span>
3946 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3947 <span class="comment">% end</span>
3948 
3949 <span class="comment">% [EOF] store_prefs</span>
3950 
3951 
3952 <span class="comment">% --------------------------------------------------------------------</span>
3953 <a name="_sub98" href="#_subfunctions" class="code">function initGUI(handles)</a>
3954 <span class="comment">% Initialize the UI controls in the GUI.</span>
3955 
3956 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3957 
3958 <span class="comment">% Set the name and version</span>
3959 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
3960     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3961 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3962 
3963 <span class="comment">% Set the PLOT 1 axis labels</span>
3964 axes(handles.Plot1Shiptracks);
3965 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3966 xlabel(<span class="string">'UTM Easting (m)'</span>)
3967 ylabel(<span class="string">'UTM Northing (m)'</span>)
3968 box on
3969 grid on
3970 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3971 
3972 <span class="comment">%%%%%%%%%%%%</span>
3973 <span class="comment">% MENU BAR %</span>
3974 <span class="comment">%%%%%%%%%%%%</span>
3975 <span class="keyword">if</span> guiparams.english_units
3976     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3977     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3978 <span class="keyword">else</span>
3979     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3980     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3981 <span class="keyword">end</span>
3982 
3983 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3984     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3985     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3986 <span class="keyword">else</span>
3987     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3988     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3989 <span class="keyword">end</span>
3990 
3991 
3992 <span class="keyword">if</span> guiparams.print
3993     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3994     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3995     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3996     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3997 <span class="keyword">elseif</span> guiparams.presentation
3998     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3999     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4000     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4001     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4002 <span class="keyword">else</span>
4003 <span class="keyword">end</span>
4004 
4005 <span class="keyword">switch</span> guiparams.renderer
4006     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4007         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4008         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4009         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4010     <span class="keyword">case</span> <span class="string">'painters'</span>
4011         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4012         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4013         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4014     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4015         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4016         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4017         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4018 <span class="keyword">end</span>
4019 
4020 
4021 <span class="comment">%%%%%%%%%%%%%%%</span>
4022 <span class="comment">% DATA EXPORT %</span>
4023 <span class="comment">%%%%%%%%%%%%%%%</span>
4024 <span class="comment">% BathymetryPanel</span>
4025 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4026 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4027 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4028 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4029 
4030 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4031 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4032 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4033 <span class="comment">% PlanViewPanel</span>
4034 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4035 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4036 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4037 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4038 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4039 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4040 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4041 
4042 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4043 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4044 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4045 <span class="comment">% ShiptracksPanel</span>
4046 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4047 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4048 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4049 
4050 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4051 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4052 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4053 <span class="comment">% CrossSectionsPanel</span>
4054 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4055     <span class="string">'Value'</span>, guiparams.idx_contour)
4056 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4057 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4058 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4059 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4060 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4061 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4062 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4063 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4064     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4065 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4066 
4067 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4068 
4069 <span class="comment">% [EOF] initGUI</span>
4070 
4071 
4072 <span class="comment">% --------------------------------------------------------------------</span>
4073 <a name="_sub99" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4074 
4075 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4076 
4077 <span class="keyword">switch</span> enable_state
4078     <span class="keyword">case</span> <span class="string">'init'</span>
4079         guiparams.gui_state = <span class="string">'init'</span>;
4080         set([handles.menuFile
4081             handles.menuOpen
4082             handles.menuOpenASCII
4083             handles.menuOpenMAT
4084             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4085         
4086         set([handles.toolbarLoadData
4087             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4088         set([handles.toolbarSaveMatFile
4089             handles.toolbarSaveBathymetry
4090             handles.toolbarSaveFigures
4091             handles.toolbarSaveExcel
4092             handles.toolbarPlottingParameters
4093             handles.toolbarProcessingParameters
4094             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4095         
4096         set([handles.DepthRangeMin
4097             handles.DepthRangeMax
4098             handles.VectorScalePlanView
4099             handles.VectorSpacingPlanview
4100             handles.SmoothingWindowSize
4101             handles.DisplayShoreline
4102             handles.AddBackground
4103             handles.PlotPlanView
4104             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4105         
4106         set([handles.HorizontalGridNodeSpacing
4107             handles.VerticalGridNodeSpacing
4108             handles.PlotShiptracks
4109             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4110         
4111         set([handles.Contour
4112             handles.VerticalExaggeration
4113             handles.VectorScaleCrossSection
4114             handles.HorizontalVectorSpacing
4115             handles.VerticalVectorSpacing
4116             handles.HorizontalSmoothingWindow
4117             handles.VerticalSmoothingWindow
4118             handles.PlotSecondaryFlowVectors
4119             handles.SecondaryFlowVectorVariable
4120             handles.IncludeVerticalVelocity
4121             handles.PlotCrossSection
4122             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4123         
4124     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4125         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4126         set([handles.menuFile
4127             handles.menuOpen
4128             handles.menuOpenASCII
4129             handles.menuOpenMAT
4130             handles.menuSaveMAT
4131             handles.menuSaveTecplot
4132             handles.menuSaveKMZFile
4133             handles.menuParameters
4134             handles.menuPlottingParameters
4135             handles.menuMetric
4136             handles.menuEnglish
4137             handles.menuBathymetryExportSettings
4138             handles.menuExportMultibeamBathymetry
4139             handles.menuKMZVerticalOffset
4140             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4141         
4142         set([handles.toolbarLoadData
4143             handles.toolbarSaveMatFile
4144             handles.toolbarSaveBathymetry
4145             handles.toolbarSaveExcel
4146             handles.toolbarSaveFigures
4147             handles.toolbarPlottingParameters
4148             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4149         set([handles.toolbarProcessingParameters
4150             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4151         
4152            
4153         set([handles.DepthRangeMin
4154             handles.DepthRangeMax
4155             handles.VectorScalePlanView
4156             handles.VectorSpacingPlanview
4157             handles.SmoothingWindowSize
4158             handles.DisplayShoreline
4159             handles.PlotPlanView
4160             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4161         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4162             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4163         <span class="keyword">else</span>
4164             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4165         <span class="keyword">end</span>
4166         
4167         set([handles.HorizontalGridNodeSpacing
4168             handles.VerticalGridNodeSpacing
4169             handles.PlotShiptracks
4170             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4171         
4172         set([handles.Contour
4173             handles.VerticalExaggeration
4174             handles.VectorScaleCrossSection
4175             handles.HorizontalVectorSpacing
4176             handles.VerticalVectorSpacing
4177             handles.HorizontalSmoothingWindow
4178             handles.VerticalSmoothingWindow
4179             handles.PlotSecondaryFlowVectors
4180             handles.SecondaryFlowVectorVariable
4181             handles.IncludeVerticalVelocity
4182             handles.PlotCrossSection
4183             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4184     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4185         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4186         set([handles.menuFile
4187             handles.menuOpen
4188             handles.menuOpenASCII
4189             handles.menuOpenMAT
4190             handles.menuParameters
4191             handles.menuPlottingParameters
4192             handles.menuMetric
4193             handles.menuEnglish
4194             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4195         set([handles.menuSaveMAT
4196             handles.menuBathymetryExportSettings
4197             handles.menuExportMultibeamBathymetry
4198             handles.menuKMZVerticalOffset
4199             handles.menuSaveKMZFile
4200             handles.menuSaveTecplot
4201             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4202         
4203         set([handles.toolbarLoadData
4204             handles.toolbarSaveFigures
4205             handles.toolbarPlottingParameters
4206             handles.toolbarSaveExcel
4207             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4208         set([handles.toolbarProcessingParameters
4209             handles.toolbarSaveMatFile
4210             handles.toolbarSaveBathymetry
4211             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4212         
4213         set([handles.DepthRangeMin
4214             handles.DepthRangeMax
4215             handles.VectorScalePlanView
4216             handles.VectorSpacingPlanview
4217             handles.SmoothingWindowSize
4218             handles.DisplayShoreline
4219             handles.PlotPlanView
4220             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4221         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4222             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4223         <span class="keyword">else</span>
4224             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4225         <span class="keyword">end</span>
4226         
4227         set([handles.HorizontalGridNodeSpacing
4228             handles.VerticalGridNodeSpacing
4229             handles.PlotShiptracks
4230             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4231         
4232         set([handles.Contour
4233             handles.VerticalExaggeration
4234             handles.VectorScaleCrossSection
4235             handles.HorizontalVectorSpacing
4236             handles.VerticalVectorSpacing
4237             handles.HorizontalSmoothingWindow
4238             handles.VerticalSmoothingWindow
4239             handles.PlotSecondaryFlowVectors
4240             handles.SecondaryFlowVectorVariable
4241             handles.IncludeVerticalVelocity
4242             handles.PlotCrossSection
4243             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4244     <span class="keyword">otherwise</span>
4245 <span class="keyword">end</span>
4246 
4247 <span class="comment">% Save Application Data</span>
4248 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4249 
4250 <span class="comment">% [EOF] set_enable</span>
4251 
4252 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4253 
4254 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4255 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4256 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4257 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4258 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4259 
4260 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4261 
4262 
4263 <span class="comment">% --------------------------------------------------------------------</span>
4264 <a name="_sub100" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4265     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4266 
4267 w = 500;
4268 h = 110;
4269 dx = 10;
4270 dy = 35;
4271 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4272 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4273     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4274     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4275     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4276     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4277     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4278     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4279     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4280     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4281     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4282     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4283 dialog_params.english_units               = english_units;
4284 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4285 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4286 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4287 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4288 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4289 
4290 <span class="comment">% Build the graphics:</span>
4291 <span class="comment">% -------------------</span>
4292 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4293     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4294     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4295     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4296 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4297     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4298     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4299     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4300     <span class="string">'Position'</span>,[15 35 100 22]);
4301 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4302     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4303     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4304     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4305     <span class="string">'Position'</span>,[15 10 100 22]);
4306 
4307 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4308     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4309     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4310     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4311 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4312     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4313     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4314     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4315     <span class="string">'Position'</span>,[15 35 100 22]);
4316 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4317     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4318     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4319     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4320     <span class="string">'Position'</span>,[15 10 100 22]);
4321 
4322 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4323     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4324     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4325     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4326 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4327     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4328     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4329     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4330     <span class="string">'Position'</span>,[15 35 100 22]);
4331 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4332     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4333     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4334     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4335     <span class="string">'Position'</span>,[15 10 100 22]);
4336 
4337 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4338     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4339     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4340     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4341     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4342 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4343     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4344     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4345     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4346     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4347 
4348 <span class="comment">% Update the UI controls:</span>
4349 <span class="comment">% -----------------------</span>
4350 <span class="keyword">if</span> dialog_params.english_units
4351     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4352     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4353 <span class="keyword">else</span>
4354     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4355     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4356 <span class="keyword">end</span>
4357 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4358     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4359     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4360 <span class="keyword">else</span>
4361     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4362     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4363 <span class="keyword">end</span>
4364 <span class="keyword">if</span> dialog_params.presentation
4365     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4366     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4367 <span class="keyword">else</span>
4368     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4369     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4370 <span class="keyword">end</span>
4371 
4372 <span class="comment">% Set the callbacks:</span>
4373 <span class="comment">% ------------------</span>
4374 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4375 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4376 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4377 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4378 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4379 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4380 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4381 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4382 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4383 
4384 <span class="comment">% Position the dialog and make it visible:</span>
4385 <span class="comment">% ----------------------------------------</span>
4386 fpos = get(hf,<span class="string">'Position'</span>);
4387 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4388 movegui(handles.Figure,dpos)
4389 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4390 
4391 <span class="comment">% Hold the dialog open:</span>
4392 <span class="comment">% ---------------------</span>
4393 waitfor(handles.OK)
4394 
4395 <span class="comment">% Return the outputs and close the dialog:</span>
4396 <span class="comment">% ----------------------------------------</span>
4397 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4398 english_units = dialog_params.english_units;
4399 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4400 plot_presentation_style =  dialog_params.presentation;
4401 plot_print_style =  dialog_params.print;
4402 
4403 delete(handles.Figure)
4404 
4405 <span class="comment">% [EOF] plotParametersDialog</span>
4406 
4407 
4408 <span class="comment">% --------------------------------------------------------------------</span>
4409 <a name="_sub101" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4410 
4411 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4412 <span class="keyword">switch</span> the_units
4413     <span class="keyword">case</span> <span class="string">'metric'</span>
4414         dialog_params.english_units = false;
4415         
4416         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4417         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4418     <span class="keyword">case</span> <span class="string">'english'</span>
4419         dialog_params.english_units = true;
4420         
4421         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4422         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4423     <span class="keyword">otherwise</span>
4424 <span class="keyword">end</span>
4425 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4426 
4427 <span class="comment">% [EOF] dialogUnits</span>
4428 
4429 <span class="comment">% --------------------------------------------------------------------</span>
4430 <a name="_sub102" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4431 
4432 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4433 <span class="keyword">switch</span> the_endpoints
4434     <span class="keyword">case</span> <span class="string">'auto'</span>
4435         dialog_params.set_cross_section_endpoints = false;
4436         
4437         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4438         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4439     <span class="keyword">case</span> <span class="string">'manual'</span>
4440         dialog_params.set_cross_section_endpoints = true;
4441         
4442         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4443         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4444     <span class="keyword">otherwise</span>
4445 <span class="keyword">end</span>
4446 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4447 
4448 <span class="comment">% [EOF] dialogEnpoints</span>
4449 
4450 <a name="_sub103" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4451 
4452 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4453 <span class="keyword">switch</span> the_style
4454     <span class="keyword">case</span> <span class="string">'presentation'</span>
4455         dialog_params.presentation  = true;
4456         dialog_params.print         = false;
4457         
4458         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4459         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4460     <span class="keyword">case</span> <span class="string">'print'</span>
4461         dialog_params.presentation  = false;
4462         dialog_params.print         = true;
4463         
4464         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4465         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4466     <span class="keyword">otherwise</span>
4467 <span class="keyword">end</span>
4468 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4469 
4470 <span class="comment">% [EOF] dialogEnpoints</span>
4471 
4472 <span class="comment">% --------------------------------------------------------------------</span>
4473 <a name="_sub104" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4474 
4475 delete(h_OK)
4476 
4477 <span class="comment">% [EOF] dialogOK</span>
4478 
4479 <span class="comment">% --------------------------------------------------------------------</span>
4480 <a name="_sub105" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4481 <span class="comment">% Return the original inputs</span>
4482 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4483 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4484 delete(handles.OK)
4485 
4486 <span class="comment">% [EOF] dialogCancel</span>
4487 
4488 <span class="comment">% --------------------------------------------------------------------</span>
4489 <a name="_sub106" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4490 
4491 delete(h_OK)
4492 
4493 <span class="comment">% [EOF] dialogCloseReq</span>
4494 
4495 <a name="_sub107" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4496     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4497 w = 230;
4498 h = 245;
4499 dx = 10;
4500 dy = 35;
4501 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4502 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4503     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4504     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4505     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4506     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4507     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4508     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4509     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4510     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4511     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4512     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4513 dialog_params.beam_angle             = beam_angle;
4514 dialog_params.magnetic_variation     = magnetic_variation;
4515 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded</span>
4516     dialog_params.wse                = <span class="string">'tide'</span>;
4517     wse_string                       = <span class="string">'tide'</span>;
4518 <span class="keyword">else</span>
4519     dialog_params.wse                = wse;
4520     wse_string                       = num2str(wse);
4521 <span class="keyword">end</span>
4522 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4523 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4524 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4525 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4526 
4527 <span class="comment">% Build the graphics:</span>
4528 <span class="comment">% -------------------</span>
4529 ph = 150;
4530 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4531     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4532     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4533     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4534 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4535     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4536     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4537     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4538     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4539     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4540     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4541 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4542     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4543     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4544     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4545     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4546     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4547     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4548 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4549     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4550     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4551     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4552     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4553     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4554     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4555 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4556     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4557     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4558     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4559     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4560     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4561     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4562 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4563     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4564     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4565     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4566     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4567     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4568     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4569 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4570     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4571     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4572     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4573     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4574     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4575     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4576 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4577     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4578     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4579     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4580     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4581 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4582     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4583     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4584     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4585     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4586 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4587     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4588     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4589     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4590     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4591 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4592     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4593     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4594     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4595     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4596 
4597 <span class="comment">% Update the UI controls:</span>
4598 <span class="comment">% -----------------------</span>
4599 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4600 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4601 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4602 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4603 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4604 
4605 <span class="comment">% Set the callbacks:</span>
4606 <span class="comment">% ------------------</span>
4607 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4608 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4609 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4610 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4611 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4612 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4613 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4614 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4615 
4616 <span class="comment">% Position the dialog and make it visible:</span>
4617 <span class="comment">% ----------------------------------------</span>
4618 fpos = get(hf,<span class="string">'Position'</span>);
4619 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4620 movegui(handles.Figure,dpos)
4621 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4622 
4623 <span class="comment">% Hold the dialog open:</span>
4624 <span class="comment">% ---------------------</span>
4625 waitfor(handles.OK)
4626 
4627 <span class="comment">% Return the outputs and close the dialog:</span>
4628 <span class="comment">% ----------------------------------------</span>
4629 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4630 beam_angle              = dialog_params.beam_angle;
4631 magnetic_variation      = dialog_params.magnetic_variation;
4632 wse                     = dialog_params.wse;
4633 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4634 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4635 
4636 delete(handles.Figure)
4637 
4638 <span class="comment">% [EOF] exportSettingsDialog</span>
4639 
4640 <span class="comment">% --------------------------------------------------------------------</span>
4641 <a name="_sub108" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4642 
4643 <span class="comment">% Grab the current data</span>
4644 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4645 
4646 <span class="comment">% Set it according to the dialog box values</span>
4647 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4648 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4649 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4650 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4651 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4652 
4653 <span class="comment">% Re-store the application data</span>
4654 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4655 
4656 <span class="comment">% [EOF] dialogExportSettings</span>
4657 
4658 <a name="_sub109" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4659 
4660 w = 230;
4661 h = 200;
4662 dx = 10;
4663 dy = 35;
4664 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4665 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4666     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4667     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4668     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4669     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4670     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4671     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4672     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4673     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4674     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4675     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4676 dialog_params.figure_names               = figure_names;
4677 dialog_params.selected_figures           = <span class="string">''</span>;
4678 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4679 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4680 
4681 <span class="comment">% Build the graphics:</span>
4682 <span class="comment">% -------------------</span>
4683 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4684     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4685     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4686     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4687 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4688     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4689     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4690     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4691     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4692     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4693     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4694     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4695 
4696 
4697 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4698     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4699     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4700     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4701     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4702 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4703     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4704     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4705     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4706     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4707 
4708 <span class="comment">% Update the UI controls:</span>
4709 <span class="comment">% -----------------------</span>
4710 
4711 
4712 <span class="comment">% Set the callbacks:</span>
4713 <span class="comment">% ------------------</span>
4714 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4715 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4716 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4717 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4718 
4719 <span class="comment">% Position the dialog and make it visible:</span>
4720 <span class="comment">% ----------------------------------------</span>
4721 fpos = get(hf,<span class="string">'Position'</span>);
4722 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4723 movegui(handles.Figure,dpos)
4724 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4725 
4726 <span class="comment">% Hold the dialog open:</span>
4727 <span class="comment">% ---------------------</span>
4728 waitfor(handles.OK)
4729 
4730 <span class="comment">% Return the outputs and close the dialog:</span>
4731 <span class="comment">% ----------------------------------------</span>
4732 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4733 selected_figures = dialog_params.selected_figures;
4734 
4735 delete(handles.Figure)
4736 
4737 <span class="comment">% [EOF] openFiguresDialog</span>
4738 
4739 <span class="comment">% --------------------------------------------------------------------</span>
4740 <a name="_sub110" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4741 
4742 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4743 
4744 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4745 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4746 selected     = fig_names(idx_selected);
4747 dialog_params.selected_figures = selected;
4748 
4749 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4750 
4751 
4752 
4753 <span class="comment">% --------------------------------------------------------------------</span>
4754 <a name="_sub111" href="#_subfunctions" class="code">function icons = getIcons</a>
4755 
4756 <span class="comment">% Load data</span>
4757 idx = 1;
4758 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4759     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4760     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4761     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4762     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4763     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4764     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4765     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4766     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4767     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4768     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4769     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4770     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4771     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4772     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4773     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4774     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4775 
4776 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4777     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4778     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4779     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4780     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4781     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4782     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4783     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4784     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4785     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4786     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4787     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4788     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4789     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4790     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4791     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4792     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4793 
4794 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4795     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4796     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4797     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4798     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4799     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4800     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4801     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4802     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4803     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4804     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4805     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4806     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4807     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4808     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4809     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4810     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4811 
4812 <span class="comment">% Save data</span>
4813 idx = idx+1;
4814 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4815     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4816     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4817     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4818     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4819     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4820     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4821     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4822     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4823     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4824     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4825     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4826     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4827     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4828     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4829     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4830     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4831 
4832 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4833     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4834     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4835     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4836     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4837     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4838     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4839     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4840     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4841     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4842     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4843     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4844     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4845     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4846     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4847     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4848     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4849 
4850 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4851     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4852     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4853     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4854     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4855     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4856     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4857     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4858     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4859     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4860     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4861     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4862     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4863     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4864     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4865     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4866     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4867 
4868 <span class="comment">% Plotting parameters</span>
4869 idx = idx+1;
4870 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4871     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4872     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4873     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4874     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4875     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4876     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4877     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4878     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4879     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4880     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4881     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4882     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4883     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4884     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4885     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4886     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4887 
4888 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4889     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4890     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4891     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4892     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4893     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4894     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4895     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4896     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4897     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4898     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4899     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4900     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4901     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4902     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4903     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4904     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4905 
4906 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4907     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4908     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4909     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4910     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4911     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4912     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4913     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4914     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4915     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4916     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4917     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4918     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4919     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4920     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4921     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4922     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4923 
4924 <span class="comment">% Processing parameters</span>
4925 idx = idx+1;
4926 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4927     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4928     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4929     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4930     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4931     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4932     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4933     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4934     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4935     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4936     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4937     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4938     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4939     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4940     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4941     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4942     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4943 
4944 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4945     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4946     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4947     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4948     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4949     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4950     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4951     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4952     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4953     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4954     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4955     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4956     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4957     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4958     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4959     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4960     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4961 
4962 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4963     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4964     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4965     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4966     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4967     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4968     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4969     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4970     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4971     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4972     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4973     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4974     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4975     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4976     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4977     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4978     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4979 
4980 <span class="comment">% Export bathymetry dialog</span>
4981 idx = idx+1;
4982 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4983     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4984     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4985     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4986     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4987     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4988     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4989     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4990     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4991     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4992     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4993     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4994     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4995     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4996     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4997     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4998     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4999     ]/255;
5000 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5001     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5002     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5003     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5004     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5005     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5006     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5007     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5008     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5009     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5010     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5011     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5012     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5013     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5014     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5015     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5016     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5017     ]/255;
5018 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5019     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5020     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5021     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5022     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5023     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5024     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5025     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5026     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5027     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5028     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5029     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5030     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5031     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5032     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5033     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5034     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5035     ]/255;
5036 
5037 <span class="comment">% Export Figures Dialog</span>
5038 idx = idx + 1;
5039 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5040     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5041     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5042     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5043     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5044     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5045     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5046     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5047     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5048     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5049     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5050     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5051     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5052     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5053     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5054     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5055 
5056 
5057 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5058     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5059     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5060     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5061     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5062     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5063     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5064     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5065     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5066     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5067     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5068     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5069     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5070     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5071     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5072     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5073 
5074 
5075 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5076     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5077     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5078     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5079     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5080     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5081     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5082     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5083     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5084     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5085     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5086     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5087     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5088     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5089     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5090     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5091 
5092 <span class="comment">% Export Excel File</span>
5093 idx = idx + 1;
5094 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5095     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5096    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5097    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5098    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5099    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5100    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5101    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5102    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5103    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5104    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5105    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5106    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5107    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5108    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5109    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5110     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5111 
5112 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5113     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5114    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5115    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5116    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5117    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5118    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5119    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5120    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5121    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5122    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5123    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5124    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5125    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5126    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5127    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5128     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5129 
5130 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5131     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5132    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5133    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5134    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5135    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5136    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5137    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5138    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5139    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5140    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5141    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5142    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5143    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5144    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5145    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5146     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5147 
5148 <span class="comment">% Zoom In</span>
5149 idx = idx + 1;
5150 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5151     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5152 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5153     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5154 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5155     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5156 
5157 <span class="comment">% Zoom Out</span>
5158 idx = idx + 1;
5159 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5160     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5161 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5162     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5163 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5164     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5165 
5166 <span class="comment">% Pan</span>
5167 idx = idx + 1;
5168 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5169     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5170 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5171     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5172 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5173     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5174 <span class="comment">% [EOF] getIcons</span>
5175 
5176 <a name="_sub112" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5177 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5178 
5179 <span class="comment">% Check for any stored prefs</span>
5180 <span class="comment">% --------------------------</span>
5181 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5182 guiprefs = getpref(<span class="string">'VMT'</span>);
5183 
5184 <span class="comment">% Organized by GUI panels</span>
5185 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5186 <span class="comment">% SHIPTRACKS PLOT %</span>
5187 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5188 guiparams.horizontal_grid_node_spacing       = 1.0;
5189 guiparams.vertical_grid_node_spacing         = 0.4;
5190 
5191 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5192 <span class="comment">% CROSS SECTION PLOT %</span>
5193 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5194 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5195 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5196 guiparams.idx_contour                        = 1;
5197 guiparams.vertical_exaggeration              = 10;
5198 guiparams.vector_scale_cross_section         = 0.2;
5199 guiparams.horizontal_vector_spacing          = 1;
5200 guiparams.vertical_vector_spacing            = 1;
5201 guiparams.horizontal_smoothing_window        = 1;
5202 guiparams.vertical_smoothing_window          = 1;
5203 guiparams.plot_secondary_flow_vectors        = true;
5204 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5205 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5206 guiparams.idx_secondary_flow_vector_variable = 1;
5207 guiparams.include_vertical_velocity          = true;
5208 
5209 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5210 <span class="comment">% PLAN VIEW PLOT %</span>
5211 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5212 guiparams.depth_range_min                    = 0;
5213 guiparams.depth_range_max                    = inf;
5214 guiparams.vector_scale_plan_view             = 1;
5215 guiparams.vector_spacing_plan_view           = 1;
5216 guiparams.smoothing_window_size              = 1;
5217 guiparams.display_shoreline                  = false;
5218 guiparams.add_background                     = false;
5219 
5220 <span class="comment">%%%%%%%%%%%%%%%</span>
5221 <span class="comment">% DATA EXPORT %</span>
5222 <span class="comment">%%%%%%%%%%%%%%%</span>
5223 guiparams.beam_angle                         = 20.0;
5224 guiparams.magnetic_variation                 = 0.0;
5225 guiparams.wse                                = 0.0;
5226 guiparams.load_wse_tide_file                 = false;
5227 guiparams.output_auxiliary_data              = false;
5228 
5229 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5230 <span class="comment">% Contour variables %</span>
5231 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5232 idx = 1;
5233 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5234 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5235 idx = idx + 1;
5236 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5237 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5238 idx = idx + 1;
5239 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5240 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5241 idx = idx + 1;
5242 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5243 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5244 idx = idx + 1;
5245 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5246 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5247 idx = idx + 1;
5248 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5249 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5250 idx = idx + 1;
5251 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5252 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5253 idx = idx + 1;
5254 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5255 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5256 idx = idx + 1;
5257 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5258 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5259 idx = idx + 1;
5260 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5261 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5262 idx = idx + 1;
5263 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5264 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5265 idx = idx + 1;
5266 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5267 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5268 idx = idx + 1;
5269 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5270 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5271 idx = idx + 1;
5272 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5273 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5274 idx = idx + 1;
5275 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5276 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5277 idx = idx + 1;
5278 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5279 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5280 idx = idx + 1;
5281 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5282 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5283 idx = idx + 1;
5284 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5285 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5286 idx = idx + 1;
5287 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5288 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5289 idx = idx + 1;
5290 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5291 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5292 
5293 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5294 
5295 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5296 <span class="comment">% Secondary Flow Vector Variables %</span>
5297 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5298 idx = 1;
5299 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5300 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5301 idx = idx + 1;
5302 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5303 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5304 idx = idx + 1;
5305 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5306 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5307 idx = idx + 1;
5308 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5309 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5310 idx = idx + 1;
5311 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5312 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5313 
5314 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5315     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5316 
5317 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5318 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5319 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5320 <span class="comment">% Menu bar options</span>
5321 guiparams.presentation                       = true;
5322 guiparams.print                              = false;
5323 guiparams.set_cross_section_endpoints        = false;
5324 guiparams.unit_discharge_correction          = false;
5325 
5326 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5327     <span class="keyword">switch</span> guiprefs.units
5328         <span class="keyword">case</span> <span class="string">'metric'</span>
5329             guiparams.english_units          = false;
5330         <span class="keyword">case</span> <span class="string">'english'</span>
5331             guiparams.english_units          = true;
5332     <span class="keyword">end</span>
5333 <span class="keyword">else</span>
5334     guiparams.english_units                  = false;
5335 <span class="keyword">end</span>
5336 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5337     <span class="keyword">switch</span> guiprefs.plotref
5338         <span class="keyword">case</span> <span class="string">'dfs'</span>
5339             guiparams.plotref                 = <span class="string">'dfs'</span>;
5340         <span class="keyword">case</span> <span class="string">'hab'</span>
5341             guiparams.plotref                 = <span class="string">'hab'</span>;
5342     <span class="keyword">end</span>
5343 <span class="keyword">else</span>
5344     guiparams.plotref                         = <span class="string">'dfs'</span>;
5345 <span class="keyword">end</span>
5346 guiparams.eta                                 = 100; <span class="comment">% Used in HAB reference</span>
5347 guiparams.vertical_offset                     = 0;
5348 
5349 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5350     guiparams.renderer                       = guiprefs.renderer;
5351 <span class="keyword">else</span>
5352     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5353 <span class="keyword">end</span>
5354 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5355 <span class="comment">% guiparams.plot_planview                      = false;</span>
5356 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5357 
5358 <span class="comment">% File location defaults</span>
5359 guiparams.ascii_path                        = pwd;
5360 guiparams.ascii_file                        = <span class="string">''</span>;
5361 guiparams.mat_path                          = pwd;
5362 guiparams.mat_file                          = <span class="string">''</span>;
5363 guiparams.tecplot_path                      = pwd;
5364 guiparams.tecplot_file                      = <span class="string">''</span>;
5365 guiparams.kmz_path                          = pwd;
5366 guiparams.kmz_file                          = <span class="string">''</span>;
5367 guiparams.multibeambathymetry_path          = pwd;
5368 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5369 guiparams.log_path                          = pwd;
5370 guiparams.log_file                          = <span class="string">''</span>;
5371 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5372 <span class="comment">% application</span>
5373 <span class="keyword">if</span> isdeployed 
5374     guiparams.has_mapping_toolbox           = true;
5375 <span class="keyword">else</span>
5376     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5377         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5378 <span class="keyword">end</span>
5379 
5380 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5381 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5382 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5383 guiparams.z                      = [];
5384 guiparams.A                      = [];
5385 guiparams.V                      = [];
5386 guiparams.Map                    = [];
5387 guiparams.savefile               = [];
5388 guiparams.iric_anv_planview_data = [];
5389 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5390 <span class="comment">% guiparams.zmax = [];</span>
5391 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5392 guiparams.data_folder = <span class="string">''</span>;
5393 guiparams.data_files  = {<span class="string">''</span>};
5394 guiparams.gui_state   = <span class="string">'init'</span>;
5395 
5396 <span class="comment">% [EOF] createGUIparams</span>
5397 
5398 <a name="_sub113" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5399 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5400 
5401 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5402 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5403 
5404 <span class="comment">% [EOF] VMT</span>
5405 
5406 
5407 
5408 
5409 
5410 <span class="comment">% --- Hidden keyboard commands</span>
5411 <a name="_sub115" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5412 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5413 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5414 <span class="comment">%</span>
5415 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5416 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5417 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5418 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5419 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5420 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5421 
5422 in1 = eventdata.Modifier; 
5423 in2 = eventdata.Key;
5424 
5425 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5426     input = [in1{:} in2];
5427 <span class="keyword">else</span>
5428     input = in2;
5429 <span class="keyword">end</span>
5430 
5431 <span class="keyword">switch</span> input
5432     <span class="comment">% Hidden SonTek M9 support</span>
5433     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5434         msgtxt = {<span class="keyword">...</span>
5435             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5436             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5437             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5438             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5439             <span class="string">''</span>;<span class="keyword">...</span>
5440             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5441             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5442             <span class="string">'PROVISIONAL at best.'</span>};
5443         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5444         
5445         <span class="comment">% Get the Application data:</span>
5446         <span class="comment">% -------------------------</span>
5447         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5448         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5449         
5450         <span class="comment">% Ask the user to select files:</span>
5451         <span class="comment">% -----------------------------</span>
5452         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5453         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5454         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5455             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5456         <span class="keyword">else</span>
5457             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5458         <span class="keyword">end</span>
5459         [filename,pathname] = <span class="keyword">...</span>
5460             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5461             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5462             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5463         
5464         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5465             guiparams.data_folder = pathname;
5466             <span class="keyword">if</span> ischar(filename)
5467                 filename = {filename};
5468             <span class="keyword">end</span>
5469             guiparams.data_files = filename;
5470             guiparams.mat_file = <span class="string">''</span>;
5471             
5472             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5473             
5474             
5475             
5476             <span class="comment">% Update the preferences:</span>
5477             <span class="comment">% -----------------------</span>
5478             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5479             guiprefs.ascii_path = pathname;
5480             guiprefs.ascii_file = filename;
5481             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5482             <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5483             
5484             <span class="comment">% Push messages to Log Window:</span>
5485             <span class="comment">% ----------------------------</span>
5486             log_text = {<span class="keyword">...</span>
5487                 <span class="string">''</span>;<span class="keyword">...</span>
5488                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5489                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5490                 guiparams.data_folder;
5491                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5492                 char(filename)};
5493             statusLogging(handles.LogWindow, log_text)
5494             
5495             <span class="comment">% Read the file(s)</span>
5496             <span class="comment">% ----------------</span>
5497             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5498             
5499             [~,~,savefile,A,z] = <span class="keyword">...</span>
5500                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5501             guiparams.savefile = savefile;
5502             guiparams.A        = A;
5503             guiparams.z        = z;
5504             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5505             
5506             
5507             <span class="comment">% Update the GUI:</span>
5508             <span class="comment">% ---------------</span>
5509             <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5510         <span class="keyword">end</span>  
5511     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5512         SontekMAT2KML;
5513     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5514         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5515         
5516     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5517         VMT_BuildCustomFlatFile;
5518     <span class="keyword">otherwise</span>
5519         <span class="comment">%disp(input)</span>
5520 <span class="keyword">end</span>
5521 
5522</pre></div>
<hr><address>Generated on Fri 09-Jan-2015 10:58:02 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>