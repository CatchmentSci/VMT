<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub92" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub93" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub94" class="code">function initGUI(handles)</a></li><li><a href="#_sub95" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub96" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub97" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub98" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub99" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub100" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub101" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub102" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub103" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a></li><li><a href="#_sub104" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub105" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub106" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function icons = getIcons</a></li><li><a href="#_sub108" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub109" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub110" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub111" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub91" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     filesep = <span class="string">'\'</span>; <span class="comment">% windows</span>
0095     utilspath = [pwd filesep <span class="string">'utils'</span>];
0096     docspath  = [pwd filesep <span class="string">'doc'</span>];
0097     toolspath = [pwd filesep <span class="string">'tools'</span>];
0098     addpath(utilspath,docspath,toolspath)
0099 <span class="keyword">end</span>
0100 
0101 <span class="comment">% Update handles structure</span>
0102 <span class="comment">% ------------------------</span>
0103 guidata(hObject, handles);
0104 
0105 <span class="comment">% Load the GUI preferences:</span>
0106 <span class="comment">% -------------------------</span>
0107 <a href="#_sub92" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0108 
0109 <span class="comment">% Initialize the GUI parameters:</span>
0110 <span class="comment">% ------------------------------</span>
0111 guiparams = <a href="#_sub108" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0112 guiparams.vmt_version = {<span class="string">'v4.06'</span>; <span class="string">'r20140917'</span>};
0113 
0114 <span class="comment">% Draw the VMT Background</span>
0115 <span class="comment">% -----------------</span>
0116 pos = get(handles.figure1,<span class="string">'position'</span>);
0117 axes(handles.VMTBackground);
0118 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0119     X = imread(<span class="string">'VMT_Background.png'</span>);
0120     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0121 <span class="comment">% else</span>
0122 <span class="comment">%     X = imread('VMT_Background.png');</span>
0123 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0124 <span class="comment">%     X = uint8(X);</span>
0125 <span class="comment">%     imshow(X,'Border','tight')</span>
0126 <span class="comment">% end</span>
0127 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0128 
0129 <span class="comment">% Store the application data:</span>
0130 <span class="comment">% ---------------------------</span>
0131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0132 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0133 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0134 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0135 
0136 <span class="comment">% Auto-check for updates</span>
0137 <span class="comment">% ----------------------</span>
0138 thres = 20; 
0139 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0140 time_to_check = (mod(runcounter,thres)==0);
0141 <span class="keyword">if</span> time_to_check
0142     <a href="#_sub48" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0143 <span class="keyword">end</span>
0144 
0145 <span class="comment">% Initialize the GUI:</span>
0146 <span class="comment">% -------------------</span>
0147 <a href="#_sub94" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0148 <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0149 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0150 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0151 pos = get(handles.figure1,<span class="string">'Position'</span>);
0152 <span class="comment">% pos(3) = 545;</span>
0153 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0154 movegui(handles.figure1,<span class="string">'center'</span>)
0155 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0156 
0157 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0158 <span class="comment">% the root</span>
0159 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0160 
0161 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0162 <span class="comment">% uiwait(handles.figure1);</span>
0163 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0164 
0165 
0166 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0167 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0168 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0169 <span class="comment">% hObject    handle to figure</span>
0170 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0171 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0172 
0173 <span class="comment">% Get default command line output from handles structure</span>
0174 varargout{1} = handles.output;
0175 <span class="comment">% [EOF] VMT_OutputFcn</span>
0176 
0177 <span class="comment">% --- Executes when figure1 is resized.</span>
0178 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0179 
0180 <span class="comment">% Draw the VMT Background</span>
0181 <span class="comment">% -----------------</span>
0182 pos = get(handles.figure1,<span class="string">'position'</span>);
0183 axes(handles.VMTBackground);
0184 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0185     X = imread(<span class="string">'VMT_Background.png'</span>);
0186     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0187 <span class="comment">% else</span>
0188 <span class="comment">%     X = imread('VMT_Background.png');</span>
0189 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0190 <span class="comment">%     X = uint8(X);</span>
0191 <span class="comment">%     imshow(X,'Border','tight')</span>
0192 <span class="comment">% end</span>
0193 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0194 
0195 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0196 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0197 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0198 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0199 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0200 
0201 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0202 who_called = get(hObject,<span class="string">'tag'</span>);
0203 close_button = questdlg(<span class="keyword">...</span>
0204     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0205     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0206 <span class="keyword">switch</span> close_button
0207     <span class="keyword">case</span> <span class="string">'Yes'</span>
0208         closereq
0209         close all hidden
0210     <span class="keyword">otherwise</span>
0211         <span class="keyword">return</span>
0212 <span class="keyword">end</span>
0213 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0214 
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 <span class="comment">% MENU BAR CALLBACKS %</span>
0217 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0221 <span class="comment">% Empty</span>
0222 
0223 <span class="comment">% --------------------------------------------------------------------</span>
0224 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0225 <span class="comment">% Empty</span>
0226 
0227 <span class="comment">% --------------------------------------------------------------------</span>
0228 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0229 <a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0230 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0231 
0232 <span class="comment">% --------------------------------------------------------------------</span>
0233 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0234 
0235 <span class="comment">% Get the Application data:</span>
0236 <span class="comment">% -------------------------</span>
0237 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0238 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0239 
0240 <span class="comment">% Ask the user to select files:</span>
0241 <span class="comment">% -----------------------------</span>
0242 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0243 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0244 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0245     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0246 <span class="keyword">else</span>
0247     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0248 <span class="keyword">end</span>
0249 [filename,pathname] = <span class="keyword">...</span>
0250     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0251     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0252     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0253 
0254 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0255     <span class="comment">% Load the data:</span>
0256     <span class="comment">% --------------</span>
0257     vars = load(fullfile(pathname,filename));
0258     
0259     <span class="comment">% Make sure the selected file is a valid file:</span>
0260     <span class="comment">% --------------------------------------------</span>
0261     varnames = fieldnames(vars);
0262     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0263         guiparams.mat_path = pathname;
0264         guiparams.mat_file = filename;
0265         guiparams.z = vars.z;
0266         guiparams.A = vars.A;
0267         guiparams.V = vars.V;
0268         
0269         <span class="comment">% Update the preferences:</span>
0270         <span class="comment">% -----------------------</span>
0271         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0272         guiprefs.mat_path = pathname;
0273         guiprefs.mat_file = filename;
0274         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0275         <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0276                      
0277         <span class="comment">% Re-store the Application Data:</span>
0278         <span class="comment">% ------------------------------</span>
0279         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0280         
0281         <span class="comment">% Update the GUI:</span>
0282         <span class="comment">% ---------------</span>
0283         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0284         <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0285     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0286         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0287             <span class="string">'Invalid File...'</span>)
0288     <span class="keyword">end</span>
0289     
0290     <span class="comment">% Set the vertical grid node spacing</span>
0291     <span class="comment">% ----------------------------------</span>
0292     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0293     <span class="comment">% Backwards compatible</span>
0294     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0295         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0296     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0297         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0298     <span class="keyword">end</span>
0299     
0300 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0301     <span class="comment">% Set the filenames</span>
0302     <span class="comment">% -----------------</span>
0303     guiparams.mat_path = pathname;
0304     guiparams.mat_file = filename;
0305     
0306     <span class="comment">% Push status to log window</span>
0307     <span class="comment">% -------------------------</span>
0308     log_text = {<span class="keyword">...</span>
0309         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0310         <span class="string">'Directory:'</span>};
0311     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0312     statusLogging(handles.LogWindow,log_text)
0313     
0314     <span class="comment">% Update the Application Data:</span>
0315     <span class="comment">% ------------------------------</span>
0316     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0317     
0318     <span class="comment">% Update the persistent preferences:</span>
0319     <span class="comment">% ----------------------------------</span>
0320     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0321     guiprefs.mat_path = pathname;
0322     guiprefs.mat_file = filename;
0323     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0324     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0325         
0326     <span class="comment">% Update the GUI:</span>
0327     <span class="comment">% ---------------</span>
0328     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0329 <span class="keyword">end</span>
0330 
0331 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0332 
0333 <span class="comment">% --------------------------------------------------------------------</span>
0334 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0335 <span class="comment">% Empty</span>
0336 
0337 <span class="comment">% --------------------------------------------------------------------</span>
0338 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0339 <a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0340 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0341 
0342 <span class="comment">% --------------------------------------------------------------------</span>
0343 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0344 <a href="#_sub59" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0345 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0346 
0347 <span class="comment">% --------------------------------------------------------------------</span>
0348 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0349 <a href="#_sub60" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0350 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0351 
0352 <span class="comment">% --------------------------------------------------------------------</span>
0353 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0354 <span class="comment">% Empty</span>
0355 
0356 <span class="comment">% --------------------------------------------------------------------</span>
0357 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0358 <span class="comment">% Empty</span>
0359 
0360 <span class="comment">% --------------------------------------------------------------------</span>
0361 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0362 
0363 <span class="comment">% Get the Application Data:</span>
0364 <span class="comment">% -------------------------</span>
0365 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0366 
0367 <span class="comment">% Update the Application Data:</span>
0368 <span class="comment">% ----------------------------</span>
0369 guiparams.print        = true;
0370 guiparams.presentation = false;
0371 
0372 <span class="comment">% Re-store the Application data:</span>
0373 <span class="comment">% ------------------------------</span>
0374 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0375 
0376 <span class="comment">% Update the GUI:</span>
0377 <span class="comment">% ---------------</span>
0378 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0380 
0381 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0382 
0383 
0384 <span class="comment">% --------------------------------------------------------------------</span>
0385 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0386 
0387 <span class="comment">% Get the Application Data:</span>
0388 <span class="comment">% -------------------------</span>
0389 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0390 
0391 <span class="comment">% Update the Application Data:</span>
0392 <span class="comment">% ----------------------------</span>
0393 guiparams.print        = false;
0394 guiparams.presentation = true;
0395 
0396 <span class="comment">% Re-store the Application data:</span>
0397 <span class="comment">% ------------------------------</span>
0398 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0399 
0400 <span class="comment">% Update the GUI:</span>
0401 <span class="comment">% ---------------</span>
0402 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0403 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0404 
0405 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0406 
0407 <span class="comment">% --------------------------------------------------------------------</span>
0408 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0409 <span class="comment">%  --- Empty ---</span>
0410 
0411 <span class="comment">% --------------------------------------------------------------------</span>
0412 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0413 <span class="comment">% Get the Application Data:</span>
0414 <span class="comment">% -------------------------</span>
0415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0416 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0417 
0418 <span class="comment">% Update the Application Data:</span>
0419 <span class="comment">% ----------------------------</span>
0420 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0421 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0422 
0423 <span class="comment">% Re-store the Application data:</span>
0424 <span class="comment">% ------------------------------</span>
0425 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0426 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0427 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0428 
0429 <span class="comment">% Update the GUI:</span>
0430 <span class="comment">% ---------------</span>
0431 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0432 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0434 
0435 <span class="comment">% Modify the existing figures</span>
0436 <span class="comment">% ---------------------------</span>
0437 <span class="comment">% Find what plots exist already</span>
0438 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0439 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0440 
0441 <span class="comment">% Loop through valid figures and adjust</span>
0442 <span class="comment">% -------------------------------------</span>
0443 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0444     <span class="keyword">for</span> i = 1:length(valid_names)
0445         <span class="comment">% Focus the figure</span>
0446         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0447         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0448             figure(hff)
0449             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0450         <span class="keyword">end</span>
0451         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0452         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0453             figure(hff)
0454             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0455         <span class="keyword">end</span>
0456     <span class="keyword">end</span>
0457 <span class="keyword">end</span>
0458 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0459 
0460 
0461 <span class="comment">% --------------------------------------------------------------------</span>
0462 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0463 <span class="comment">% Get the Application Data:</span>
0464 <span class="comment">% -------------------------</span>
0465 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0466 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0467 
0468 <span class="comment">% Update the Application Data:</span>
0469 <span class="comment">% ----------------------------</span>
0470 guiparams.renderer  = <span class="string">'painters'</span>;
0471 guiprefs.renderer   = <span class="string">'painters'</span>;
0472 
0473 <span class="comment">% Re-store the Application data:</span>
0474 <span class="comment">% ------------------------------</span>
0475 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0476 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0477 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0478 
0479 <span class="comment">% Update the GUI:</span>
0480 <span class="comment">% ---------------</span>
0481 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0482 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0483 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0484 
0485 <span class="comment">% Modify the existing figures</span>
0486 <span class="comment">% ---------------------------</span>
0487 <span class="comment">% Find what plots exist already</span>
0488 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0489 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0490 
0491 <span class="comment">% Loop through valid figures and adjust</span>
0492 <span class="comment">% -------------------------------------</span>
0493 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0494     <span class="keyword">for</span> i = 1:length(valid_names)
0495         <span class="comment">% Focus the figure</span>
0496         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0497         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0498             figure(hff)
0499             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0500         <span class="keyword">end</span>
0501         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0502         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0503             figure(hff)
0504             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0505         <span class="keyword">end</span>
0506     <span class="keyword">end</span>
0507 <span class="keyword">end</span>
0508 <span class="comment">% [EOF] menuPainters_Callback</span>
0509 
0510 <span class="comment">% --------------------------------------------------------------------</span>
0511 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0512 <span class="comment">% Get the Application Data:</span>
0513 <span class="comment">% -------------------------</span>
0514 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0515 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0516 
0517 <span class="comment">% Update the Application Data:</span>
0518 <span class="comment">% ----------------------------</span>
0519 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0520 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0521 
0522 <span class="comment">% Re-store the Application data:</span>
0523 <span class="comment">% ------------------------------</span>
0524 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0525 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0526 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0527 
0528 <span class="comment">% Update the GUI:</span>
0529 <span class="comment">% ---------------</span>
0530 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0532 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0533 
0534 <span class="comment">% Modify the existing figures</span>
0535 <span class="comment">% ---------------------------</span>
0536 <span class="comment">% Find what plots exist already</span>
0537 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0538 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0539 
0540 <span class="comment">% Loop through valid figures and adjust</span>
0541 <span class="comment">% -------------------------------------</span>
0542 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0543     <span class="keyword">for</span> i = 1:length(valid_names)
0544         <span class="comment">% Focus the figure</span>
0545         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0546         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0547             figure(hff)
0548             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0549         <span class="keyword">end</span>
0550         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0551         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0552             figure(hff)
0553             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0554         <span class="keyword">end</span>
0555     <span class="keyword">end</span>
0556 <span class="keyword">end</span>
0557 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0558 
0559 <span class="comment">% --------------------------------------------------------------------</span>
0560 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0561 <span class="comment">% Get the Application data:</span>
0562 <span class="comment">% -------------------------</span>
0563 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0564 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0565 
0566 <span class="comment">% Find what plots exist already</span>
0567 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0568 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0569 
0570 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0571 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0572 <span class="keyword">if</span> ~isempty(idx)
0573     fig_names(idx) = [];
0574 <span class="keyword">end</span>
0575 
0576 <span class="keyword">if</span> guiparams.presentation
0577     figure_style = <span class="string">'presentation'</span>;
0578 <span class="keyword">else</span>
0579     figure_style = <span class="string">'print'</span>;
0580 <span class="keyword">end</span>
0581 
0582 [selected_figures] = <a href="#_sub105" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0583 
0584 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0585     <span class="keyword">return</span>
0586 <span class="keyword">else</span>
0587     <span class="keyword">for</span> i = 1:length(selected_figures)
0588         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0589     <span class="keyword">end</span>
0590 <span class="keyword">end</span>
0591 
0592 
0593 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0594 
0595 <span class="comment">% --------------------------------------------------------------------</span>
0596 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0597 <span class="comment">% Get the Application data:</span>
0598 <span class="comment">% -------------------------</span>
0599 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0600 beam_angle             = guiparams.beam_angle; 
0601 magnetic_variation     = guiparams.magnetic_variation; 
0602 wse                    = guiparams.wse;
0603 output_auxiliary_data  = guiparams.output_auxiliary_data; 
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data] = <span class="keyword">...</span>
0611     <a href="#_sub103" class="code" title="subfunction [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)">exportSettingsDialog</a>(beam_angle,magnetic_variation,wse,output_auxiliary_data,handles.figure1);
0612 
0613 <span class="comment">% Re-store the Application data:</span>
0614 <span class="comment">% ------------------------------</span>
0615 guiparams.beam_angle            = beam_angle;
0616 guiparams.magnetic_variation    = magnetic_variation; 
0617 guiparams.wse                   = wse;
0618 guiparams.output_auxiliary_data = output_auxiliary_data;
0619 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0620 
0621 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0622 
0623 <span class="comment">% --------------------------------------------------------------------</span>
0624 <a name="_sub23" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0625 <a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0626 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0627 
0628 
0629 <span class="comment">% --------------------------------------------------------------------</span>
0630 <a name="_sub24" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0631 
0632 <span class="comment">% Get the Application Data:</span>
0633 <span class="comment">% -------------------------</span>
0634 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0635 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0636 PVdata    = guiparams.iric_anv_planview_data;
0637 iric_path = guiprefs.iric_path;
0638 iric_file = guiprefs.iric_file;
0639 
0640 <span class="comment">% Is there any planview data?</span>
0641 <span class="keyword">if</span> isempty(PVdata)
0642     <span class="comment">% Nothing to do, warn user</span>
0643     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0644     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0645 <span class="keyword">else</span>
0646     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0647     <span class="comment">% and smoothing (for iRiC)</span>
0648     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0649     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0650         fullfile(iric_path,iric_file));
0651     
0652     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0653         outfile = fullfile(iric_path,iric_file);
0654         log_text = vertcat(log_text,{outfile});
0655         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0656         outcount = fprintf(ofid,<span class="keyword">...</span>
0657             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0658         fclose(ofid);
0659     <span class="keyword">else</span>
0660         <span class="comment">% Return default iric_path and iric_file</span>
0661         iric_path = guiprefs.iric_path;
0662         iric_file = guiprefs.iric_file;
0663     <span class="keyword">end</span>
0664 <span class="keyword">end</span>
0665 
0666 <span class="comment">% Push messages to Log Window:</span>
0667 <span class="comment">% ----------------------------</span>
0668 statusLogging(handles.LogWindow, log_text)
0669 
0670 <span class="comment">% Store the persistent preferences:</span>
0671 <span class="comment">% ---------------------------------</span>
0672 guiprefs.iric_file = iric_file;
0673 guiprefs.iric_path = iric_path;
0674 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0675 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0676 
0677 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0678 
0679 <span class="comment">% --------------------------------------------------------------------</span>
0680 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0681 <span class="comment">% Get the Application Data:</span>
0682 <span class="comment">% -------------------------</span>
0683 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0684 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0685 excel_path  = guiprefs.excel_path;
0686 excel_file  = guiprefs.excel_file;
0687 
0688 <span class="comment">% Push messages to Log Window:</span>
0689 <span class="comment">% ----------------------------</span>
0690 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0691 statusLogging(handles.LogWindow, log_text)
0692 
0693 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0694 <span class="comment">% data.</span>
0695 <span class="keyword">if</span> iscell(guiparams.mat_file)
0696     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0697     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0698     <span class="comment">% Refresh the Application Data:</span>
0699     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0700     z           = guiparams.z;
0701     A           = guiparams.A;
0702     V           = guiparams.V;
0703     Map         = guiparams.Map;
0704     wse         = guiparams.wse;
0705     PVdata      = guiparams.iric_anv_planview_data;
0706     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0707         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0708     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0709         fullfile(excel_path,excel_file));
0710     
0711     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0712         outfile = fullfile(excel_path,excel_file);
0713         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0714         
0715     <span class="keyword">else</span>
0716         <span class="comment">% Return default excel_path and excel_file</span>
0717         excel_path = guiprefs.excel_path;
0718         excel_file = guiprefs.excel_file;
0719         outfile = fullfile(excel_path,excel_file);
0720         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0721     <span class="keyword">end</span>
0722     
0723     <span class="comment">% Delete the old file if it exists</span>
0724     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0725         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0726             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0727             <span class="string">'already exists. Overwriting file...'</span>});
0728         delete(outfile)
0729     <span class="keyword">end</span>
0730     
0731     <span class="comment">% Save DAV data to an Excel File</span>
0732     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0733     vmin = num2str(guiparams.depth_range_min);
0734     vmax = num2str(guiparams.depth_range_max);
0735     pvheaders = {<span class="keyword">...</span>
0736         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0737         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0738         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0739         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0740     
0741 
0742     <span class="comment">% Initialize Variables</span>
0743     pvdata = []; Dist = [];
0744     X = []; Y = []; E = [];
0745     Ve = []; Vn =[]; Vm = []; Vd = [];
0746     
0747     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0748     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0749         <span class="comment">% Load current MAT-file</span>
0750         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0751         
0752         <span class="comment">% Location and Bathy</span>
0753         X = [X V.mcsX(1,:)];
0754         Y = [Y V.mcsY(1,:)];
0755         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0756         E = [E V.mcsBedElev];
0757         
0758         <span class="comment">% Build layer-averaged velocities</span>
0759         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0760         V.mcsX(indx,:) = nan;
0761         V.mcsY(indx,:) = nan;
0762         V.mcsEast(indx,:) = nan;
0763         V.mcsNorth(indx,:) = nan;
0764         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0765         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0766         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0767         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0768         
0769         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0770     <span class="keyword">end</span>
0771     
0772     <span class="comment">% Put output into 1 matrix</span>
0773     pvdata = [<span class="keyword">...</span>
0774         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0775         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0776         ];
0777     pvdata(isnan(pvdata)) = -9999;
0778     
0779     <span class="comment">% Create table and write to Excel</span>
0780     pvout = num2cell(pvdata');
0781     pvout = vertcat(pvheaders,pvout);
0782     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0783     
0784     <span class="comment">% Close out waitbar</span>
0785     waitbar(1,hwait)
0786     delete(hwait)
0787     
0788     <span class="comment">% Push messages to Log Window:</span>
0789     <span class="comment">% ----------------------------</span>
0790     statusLogging(handles.LogWindow, log_text)
0791 <span class="keyword">else</span>
0792     
0793     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0794     <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0795     <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0796     <span class="comment">% Refresh the Application Data:</span>
0797     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0798     z           = guiparams.z;
0799     A           = guiparams.A;
0800     V           = guiparams.V;
0801     Map         = guiparams.Map;
0802     wse         = guiparams.wse;
0803     PVdata      = guiparams.iric_anv_planview_data;
0804     
0805     
0806     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0807     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0808         fullfile(excel_path,excel_file));
0809     
0810     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0811         outfile = fullfile(excel_path,excel_file);
0812         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0813         
0814         <span class="comment">% Delete the old file if it exists</span>
0815         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0816             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0817                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0818                 <span class="string">'already exists. Overwriting file...'</span>});
0819             delete(outfile)
0820         <span class="keyword">end</span>
0821         
0822         <span class="comment">% Push messages to Log Window:</span>
0823         <span class="comment">% ----------------------------</span>
0824         statusLogging(handles.LogWindow, log_text)
0825         
0826         <span class="comment">% Save MCS Summary to an Excel File</span>
0827         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0828         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); waitbar(1/5,hwait)
0829         sout = guiparams.data_files';
0830         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); waitbar(2/5,hwait)
0831         sout = {<span class="keyword">...</span>
0832             <span class="string">'VMT: Summary of Mean Cross Section'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0833             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0834             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0835             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0836             <span class="string">'Mean Cross Section (MCS) Properties'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0837             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0838             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> single(guiparams.A(1).Sup.binSize_cm)/100;<span class="keyword">...</span>
0839             <span class="string">'Endpoints:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0840             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0841             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0842             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0843             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0844             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.mfd;<span class="keyword">...</span>
0845             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0846             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0847             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0848             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0849             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta};
0850         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); waitbar(3/5,hwait)
0851         
0852         <span class="comment">% Save DAV data to an Excel File</span>
0853         vmin = num2str(guiparams.depth_range_min);
0854         vmax = num2str(guiparams.depth_range_max);
0855         pvheaders = {<span class="keyword">...</span>
0856             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0857             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0858             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0859             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0860         
0861         <span class="comment">% Create block style matrix of all processed data</span>
0862         pvdata = [];
0863         
0864         <span class="comment">% Sort the Distances such that when plotting in 2D (Dist. vs. Depth),</span>
0865         <span class="comment">% you are looking upstream into the transect</span>
0866         Dist = sort(V.mcsDist,2,<span class="string">'descend'</span>);
0867         
0868         <span class="comment">% Build bathy data matrix</span>
0869         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0870         
0871         <span class="comment">% Build layer-averaged velocities</span>
0872         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0873         V.mcsX(indx,:) = nan;
0874         V.mcsY(indx,:) = nan;
0875         V.mcsEast(indx,:) = nan;
0876         V.mcsNorth(indx,:) = nan;
0877         pvdata = [<span class="keyword">...</span>
0878             pvdata;<span class="keyword">...</span>
0879             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0880             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0881             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0882             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0883         pvdata(isnan(pvdata)) = -9999;
0884         pvout = num2cell(pvdata');
0885         pvout = vertcat(pvheaders,pvout);
0886         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0887         waitbar(4/5,hwait)
0888         
0889         <span class="comment">% Save MCS data to an Excel File</span>
0890         mcsheaders = {<span class="keyword">...</span>
0891             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0892             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0893             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0894             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0895             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0896             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0897             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0898             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0899             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0900             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0901             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0902             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0903             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0904             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0905             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0906             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0907         
0908         mcsdata = [<span class="keyword">...</span>
0909             V.mcsX(:)<span class="keyword">...</span>
0910             V.mcsY(:)<span class="keyword">...</span>
0911             V.mcsDist(:)<span class="keyword">...</span>
0912             (wse - V.mcsDepth(:))<span class="keyword">...</span>
0913             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
0914             V.mcsEast(:)<span class="keyword">...</span>
0915             V.mcsNorth(:)<span class="keyword">...</span>
0916             V.mcsVert(:)<span class="keyword">...</span>
0917             V.mcsMag(:)<span class="keyword">...</span>
0918             V.mcsDir(:)<span class="keyword">...</span>
0919             V.u(:)<span class="keyword">...</span>
0920             V.v(:)<span class="keyword">...</span>
0921             V.vp(:)<span class="keyword">...</span>
0922             V.vs(:)<span class="keyword">...</span>
0923             V.Roz.up(:)<span class="keyword">...</span>
0924             V.Roz.us(:)];
0925         mcsdata(isnan(mcsdata)) = -9999;
0926         
0927         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
0928         xlswrite(outfile,mcsout,<span class="string">'MeanCrossSection'</span>);
0929         waitbar(1,hwait)
0930         delete(hwait)
0931         
0932     <span class="keyword">else</span>
0933         <span class="comment">% Return default excel_path and excel_file</span>
0934         excel_path = guiprefs.excel_path;
0935         excel_file = guiprefs.excel_file;
0936         outfile = fullfile(excel_path,excel_file);
0937         log_text = {<span class="string">'User aborted Excel export...'</span>};
0938     <span class="keyword">end</span>
0939     
0940     
0941     
0942 <span class="keyword">end</span>
0943 
0944 <span class="comment">% Push messages to Log Window:</span>
0945 <span class="comment">% ----------------------------</span>
0946 statusLogging(handles.LogWindow, log_text)
0947 
0948 <span class="comment">% Store the persistent preferences:</span>
0949 <span class="comment">% ---------------------------------</span>
0950 guiprefs.excel_file = excel_file;
0951 guiprefs.excel_path = excel_path;
0952 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0953 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0954 
0955 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0956 
0957 <span class="comment">% --------------------------------------------------------------------</span>
0958 <a name="_sub26" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
0959 <span class="comment">% Empty</span>
0960 
0961 <span class="comment">% --------------------------------------------------------------------</span>
0962 <a name="_sub27" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
0963 <span class="comment">% Empty</span>
0964 
0965 <span class="comment">% --------------------------------------------------------------------</span>
0966 <a name="_sub28" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0967 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0968 
0969 <span class="comment">% Get the Application Data:</span>
0970 <span class="comment">% -------------------------</span>
0971 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0972 
0973 <span class="comment">% Update the GUI &amp; Application Data:</span>
0974 <span class="comment">% ----------------------------------</span>
0975 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0976 <span class="keyword">switch</span> status
0977     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0978         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0979         guiparams.unit_discharge_correction = false;
0980     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0981         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0982         guiparams.unit_discharge_correction = true;
0983 <span class="keyword">end</span>
0984 
0985 <span class="comment">% Re-store the Application data:</span>
0986 <span class="comment">% ------------------------------</span>
0987 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0988 
0989 
0990 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
0991 
0992 <span class="comment">% --------------------------------------------------------------------</span>
0993 <a name="_sub29" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
0994 <span class="comment">% Empty</span>
0995 
0996 <span class="comment">% --------------------------------------------------------------------</span>
0997 <a name="_sub30" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
0998 <span class="comment">% Empty</span>
0999 
1000 <span class="comment">% --------------------------------------------------------------------</span>
1001 <a name="_sub31" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1002 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1003 
1004 <span class="comment">% Get the Application Data:</span>
1005 <span class="comment">% -------------------------</span>
1006 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1007 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1008 
1009 <span class="comment">% Update the Application Data:</span>
1010 <span class="comment">% ----------------------------</span>
1011 guiparams.english_units = false;
1012 guiprefs.units = <span class="string">'metric'</span>;
1013 
1014 <span class="comment">% Re-store the Application data:</span>
1015 <span class="comment">% ------------------------------</span>
1016 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1017 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1018 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1019 
1020 <span class="comment">% Update the GUI:</span>
1021 <span class="comment">% ---------------</span>
1022 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1023 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1024 
1025 <span class="comment">% [EOF] menuMetric_Callback</span>
1026 
1027 
1028 <span class="comment">% --------------------------------------------------------------------</span>
1029 <a name="_sub32" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1030 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1031 
1032 <span class="comment">% Get the Application Data:</span>
1033 <span class="comment">% -------------------------</span>
1034 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1035 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1036 
1037 <span class="comment">% Update the Application Data:</span>
1038 <span class="comment">% ----------------------------</span>
1039 guiparams.english_units = true;
1040 guiprefs.units = <span class="string">'english'</span>;
1041 
1042 <span class="comment">% Re-store the Application data:</span>
1043 <span class="comment">% ------------------------------</span>
1044 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1045 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1046 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1047 
1048 <span class="comment">% Update the GUI:</span>
1049 <span class="comment">% ---------------</span>
1050 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1051 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1052 
1053 <span class="comment">% [EOF] menuEnglish_Callback</span>
1054 
1055 
1056 <span class="comment">% --------------------------------------------------------------------</span>
1057 <a name="_sub33" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1058 <span class="comment">% Empty</span>
1059 
1060 <span class="comment">% --------------------------------------------------------------------</span>
1061 <a name="_sub34" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1062 <span class="comment">% Set cross-section endpoints automatically</span>
1063 
1064 <span class="comment">% Get the Application Data:</span>
1065 <span class="comment">% -------------------------</span>
1066 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1067 
1068 <span class="comment">% Update the Application Data:</span>
1069 <span class="comment">% ----------------------------</span>
1070 guiparams.set_cross_section_endpoints = false;
1071 
1072 <span class="comment">% Re-store the Application data:</span>
1073 <span class="comment">% ------------------------------</span>
1074 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1075 
1076 <span class="comment">% Update the GUI:</span>
1077 <span class="comment">% ---------------</span>
1078 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1079 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1080 
1081 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1082 
1083 
1084 <span class="comment">% --------------------------------------------------------------------</span>
1085 <a name="_sub35" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1086 <span class="comment">% Set cross-section endpoints manually</span>
1087 
1088 <span class="comment">% Get the Application Data:</span>
1089 <span class="comment">% -------------------------</span>
1090 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1091 
1092 <span class="comment">% Update the Application Data:</span>
1093 <span class="comment">% ----------------------------</span>
1094 guiparams.set_cross_section_endpoints = true;
1095 
1096 <span class="comment">% Re-store the Application data:</span>
1097 <span class="comment">% ------------------------------</span>
1098 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1099 
1100 <span class="comment">% Update the GUI:</span>
1101 <span class="comment">% ---------------</span>
1102 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1103 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1104 
1105 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1106 
1107 
1108 
1109 
1110 <span class="comment">% --------------------------------------------------------------------</span>
1111 <a name="_sub36" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1112 <span class="comment">% Empty</span>
1113 
1114 <span class="comment">% --------------------------------------------------------------------</span>
1115 <a name="_sub37" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1116 
1117 <span class="comment">% Get the Application Data:</span>
1118 <span class="comment">% -------------------------</span>
1119 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1120 
1121 <span class="comment">% Update the Application Data:</span>
1122 <span class="comment">% ----------------------------</span>
1123 guiparams.print        = true;
1124 guiparams.presentation = false;
1125 
1126 <span class="comment">% Re-store the Application data:</span>
1127 <span class="comment">% ------------------------------</span>
1128 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1129 
1130 <span class="comment">% Update the GUI:</span>
1131 <span class="comment">% ---------------</span>
1132 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1133 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1134 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1135 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1136 
1137 <span class="comment">% Modify the existing figures</span>
1138 <span class="comment">% ---------------------------</span>
1139 <span class="comment">% Find what plots exist already</span>
1140 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1141 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1142 
1143 <span class="comment">% Defaults for Print Stlye Figure</span>
1144 BkgdColor   = <span class="string">'white'</span>;
1145 AxColor     = <span class="string">'black'</span>;
1146 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1147 FntSize     = 14;
1148 
1149 <span class="comment">% Loop through valid figures and adjust</span>
1150 <span class="comment">% -------------------------------------</span>
1151 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1152     
1153     <span class="keyword">for</span> i = 1:length(valid_names)
1154         <span class="keyword">switch</span> valid_names{i}
1155             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1156                 <span class="comment">% Focus the figure</span>
1157                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1158                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1159                     figure(hff)
1160                     
1161                     <span class="comment">% Make the changes to figure</span>
1162                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1163                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1164                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1165                     set(gca,<span class="string">'Color'</span>,FigColor)
1166                     set(gca,<span class="string">'XColor'</span>,AxColor)
1167                     set(gca,<span class="string">'YColor'</span>,AxColor)
1168                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1169                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1170                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1171                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1172                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1173                     
1174                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1175                     <span class="comment">% the file(s) and path for the data</span>
1176                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1177                     <span class="keyword">if</span> ~ismultiplot
1178                         filestr = guiparams.savefile;
1179                         wd = length(filestr);
1180                         hd = 1;
1181                     <span class="keyword">else</span>
1182                         <span class="comment">% Construct a filename</span>
1183                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1184                         wd        = max(cellfun(@length,filestr));
1185                         hd        = numel(filestr);
1186                             
1187                     <span class="keyword">end</span>
1188                     
1189                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1190                     disableMenuBar(hff)
1191                     set(fileinfotxt,<span class="keyword">...</span>
1192                         <span class="string">'string'</span>,filestr)
1193                     set(fileinfotxt,<span class="keyword">...</span>
1194                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1195                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1196                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1197                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1198                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1199                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1200                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1201                     
1202                 <span class="keyword">end</span>
1203             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1204                 <span class="comment">% Focus the figure</span>
1205                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1206                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1207                     figure(hff)
1208                     
1209                     <span class="comment">% Make the changes to figure</span>
1210                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1211                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1212                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1213                     set(gca,<span class="string">'Color'</span>,FigColor)
1214                     set(gca,<span class="string">'XColor'</span>,AxColor)
1215                     set(gca,<span class="string">'YColor'</span>,AxColor)
1216                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1217                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1218                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1219                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1220                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1221                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1222                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1223                     
1224                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1225                     <span class="comment">% the file(s) and path for the data</span>
1226                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1227                     <span class="keyword">if</span> ~ismultiplot
1228                         filestr = guiparams.savefile;
1229                         wd = length(filestr);
1230                         hd = 1;
1231                     <span class="keyword">else</span>
1232                         <span class="comment">% Construct a filename</span>
1233                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1234                         wd        = max(cellfun(@length,filestr));
1235                         hd        = numel(filestr);
1236                             
1237                     <span class="keyword">end</span>
1238                     
1239                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1240                     disableMenuBar(hff)
1241                     set(fileinfotxt,<span class="keyword">...</span>
1242                         <span class="string">'string'</span>,filestr)
1243                     set(fileinfotxt,<span class="keyword">...</span>
1244                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1245                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1246                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1247                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1248                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1249                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1250                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1251                 <span class="keyword">end</span>
1252             <span class="keyword">otherwise</span>
1253         <span class="keyword">end</span>
1254     <span class="keyword">end</span>
1255     
1256     
1257 <span class="keyword">end</span>
1258 
1259 
1260 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1261 
1262 
1263 <span class="comment">% --------------------------------------------------------------------</span>
1264 <a name="_sub38" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1265 <span class="comment">% Get the Application Data:</span>
1266 <span class="comment">% -------------------------</span>
1267 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1268 
1269 <span class="comment">% Update the Application Data:</span>
1270 <span class="comment">% ----------------------------</span>
1271 guiparams.print        = false;
1272 guiparams.presentation = true;
1273 
1274 <span class="comment">% Re-store the Application data:</span>
1275 <span class="comment">% ------------------------------</span>
1276 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1277 
1278 <span class="comment">% Update the GUI:</span>
1279 <span class="comment">% ---------------</span>
1280 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1281 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1282 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1283 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1284 
1285 <span class="comment">% Modify the existing figures</span>
1286 <span class="comment">% ---------------------------</span>
1287 <span class="comment">% Find what plots exist already</span>
1288 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1289 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1290 
1291 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1292 <span class="comment">% --------------------------------------</span>
1293 BkgdColor   = <span class="string">'black'</span>;
1294 AxColor     = <span class="string">'white'</span>;
1295 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1296 FntSize     = 14;
1297 
1298 <span class="comment">% Loop through valid figures and adjust</span>
1299 <span class="comment">% -------------------------------------</span>
1300 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1301     
1302     <span class="keyword">for</span> i = 1:length(valid_names)
1303         <span class="keyword">switch</span> valid_names{i}
1304             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1305                 <span class="comment">% Focus the figure</span>
1306                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1307                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1308                     figure(hff)
1309                     
1310                     <span class="comment">% Make the changes to figure</span>
1311                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1312                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1313                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1314                     set(gca,<span class="string">'Color'</span>,FigColor)
1315                     set(gca,<span class="string">'XColor'</span>,AxColor)
1316                     set(gca,<span class="string">'YColor'</span>,AxColor)
1317                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1318                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1319                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1320                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1321                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1322                     
1323                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1324                     <span class="comment">% the file(s) and path for the data</span>
1325                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1326                     <span class="keyword">if</span> ~ismultiplot
1327                         filestr = guiparams.savefile;
1328                         wd = length(filestr);
1329                         hd = 1;
1330                     <span class="keyword">else</span>
1331                         <span class="comment">% Construct a filename</span>
1332                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1333                         wd        = max(cellfun(@length,filestr));
1334                         hd        = numel(filestr);
1335                             
1336                     <span class="keyword">end</span>
1337                     
1338                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1339                     disableMenuBar(hff)
1340                     set(fileinfotxt,<span class="keyword">...</span>
1341                         <span class="string">'string'</span>,filestr)
1342                     set(fileinfotxt,<span class="keyword">...</span>
1343                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1344                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1345                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1346                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1347                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1348                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1349                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1350                     
1351                 <span class="keyword">end</span>
1352             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1353                 <span class="comment">% Focus the figure</span>
1354                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1355                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1356                     figure(hff)
1357                     
1358                     <span class="comment">% Make the changes to figure</span>
1359                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1360                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1361                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1362                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1363                     set(gca,<span class="string">'XColor'</span>,AxColor)
1364                     set(gca,<span class="string">'YColor'</span>,AxColor)
1365                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1366                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1367                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1368                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1369                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1370                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1371                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1372                     
1373                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1374                     <span class="comment">% the file(s) and path for the data</span>
1375                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1376                     <span class="keyword">if</span> ~ismultiplot
1377                         filestr = guiparams.savefile;
1378                         wd = length(filestr);
1379                         hd = 1;
1380                     <span class="keyword">else</span>
1381                         <span class="comment">% Construct a filename</span>
1382                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1383                         wd        = max(cellfun(@length,filestr));
1384                         hd        = numel(filestr);
1385                             
1386                     <span class="keyword">end</span>
1387                     
1388                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1389                     disableMenuBar(hff)
1390                     set(fileinfotxt,<span class="keyword">...</span>
1391                         <span class="string">'string'</span>,filestr)
1392                     set(fileinfotxt,<span class="keyword">...</span>
1393                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1394                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1395                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1396                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1397                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1398                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1399                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1400                 <span class="keyword">end</span>
1401             <span class="keyword">otherwise</span>
1402         <span class="keyword">end</span>
1403     <span class="keyword">end</span>
1404     
1405     
1406 <span class="keyword">end</span>
1407 
1408 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1409 
1410 <span class="comment">% --------------------------------------------------------------------</span>
1411 <a name="_sub39" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1412 
1413 <span class="comment">% Get the Application data:</span>
1414 <span class="comment">% -------------------------</span>
1415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1416 
1417 <span class="comment">% Initialize the answer:</span>
1418 <span class="comment">% ----------------------</span>
1419 numstr = {num2str(guiparams.vertical_offset)};
1420 answer = NaN;
1421 <span class="keyword">while</span> isnan(answer)
1422     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1423     
1424     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1425         <span class="keyword">return</span>
1426     <span class="keyword">end</span>
1427     
1428     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1429     <span class="comment">% A numeric char will be a double</span>
1430 <span class="keyword">end</span>
1431 
1432 <span class="comment">% Re-store the Application data:</span>
1433 <span class="comment">% ------------------------------</span>
1434 guiparams.vertical_offset = answer;
1435 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1436 
1437 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1438 
1439 <span class="comment">% --------------------------------------------------------------------</span>
1440 <a name="_sub40" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1441 <span class="comment">% Not implemented</span>
1442 
1443 <span class="comment">% --------------------------------------------------------------------</span>
1444 <a name="_sub41" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1445 <span class="comment">% Empty</span>
1446 
1447 <span class="comment">% --------------------------------------------------------------------</span>
1448 <a name="_sub42" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1449 ASCII2GIS_GUI
1450 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1451 
1452 <span class="comment">% --------------------------------------------------------------------</span>
1453 <a name="_sub43" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1454 
1455 <span class="comment">% Get the Application preferences:</span>
1456 <span class="comment">% --------------------------------</span>
1457 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1458 
1459 inpath = guiprefs.kmz_path;
1460 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1461     infile = guiprefs.kmz_file{1};
1462 <span class="keyword">else</span>
1463     infile = guiprefs.kmz_file;
1464 <span class="keyword">end</span>
1465 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1466 
1467 guiprefs.kmz_path = outpath;
1468 guiprefs.kmz_file = outfile;
1469 
1470 <span class="comment">% Update persistent preferences</span>
1471 <span class="comment">% -----------------------------</span>
1472 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1473 
1474 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1475 
1476 <span class="comment">% --------------------------------------------------------------------</span>
1477 <a name="_sub44" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1478 <span class="comment">% Get the Application preferences:</span>
1479 <span class="comment">% --------------------------------</span>
1480 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1481 
1482 VMT_BatchMode;
1483 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1484 
1485 <span class="comment">% --------------------------------------------------------------------</span>
1486 <a name="_sub45" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1487 <span class="comment">% Empty</span>
1488 
1489 <span class="comment">% --------------------------------------------------------------------</span>
1490 <a name="_sub46" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1491 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1492 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1493     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version <span class="string">'.pdf'</span>]);
1494     
1495 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1496     
1497     <span class="keyword">if</span> isdeployed
1498         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1499             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1500         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1501             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1502             errLogFileName},<span class="keyword">...</span>
1503             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1504             <span class="string">'error'</span>);
1505         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1506         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1507         fclose(fid);
1508         rethrow(err)
1509     <span class="keyword">else</span>
1510         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1511             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1512             <span class="string">'error'</span>);
1513         rethrow(err);
1514     <span class="keyword">end</span>
1515 <span class="keyword">end</span>
1516 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1517 
1518 <span class="comment">% --------------------------------------------------------------------</span>
1519 <a name="_sub47" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1520 <span class="comment">% Get the Application data:</span>
1521 <span class="comment">% -------------------------</span>
1522 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1523 
1524 <span class="keyword">try</span>
1525     <span class="comment">% Construct a URL to a local file which can be interpreted by any</span>
1526     <span class="comment">% web-browser</span>
1527     rootpath = strrep(pwd,filesep,<span class="string">'/'</span>);
1528     webaddress = [<span class="string">'file:///'</span> rootpath <span class="string">'/doc/index.html'</span>];
1529     system([<span class="string">'start '</span> webaddress]);
1530 <span class="comment">%     [stat,h,url] = web(webaddress) % Produced with m2html (FEX)</span>
1531 <span class="keyword">catch</span> err 
1532     <span class="keyword">if</span> isdeployed
1533         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1534             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1535         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1536             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1537             errLogFileName},<span class="keyword">...</span>
1538             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1539             <span class="string">'error'</span>);
1540         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1541         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1542         fclose(fid);
1543         rethrow(err)
1544     <span class="keyword">else</span>
1545         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1546             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1547             <span class="string">'error'</span>);
1548         rethrow(err);
1549     <span class="keyword">end</span>
1550 <span class="keyword">end</span>
1551 
1552 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1553 
1554 <span class="comment">% --------------------------------------------------------------------</span>
1555 <a name="_sub48" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1556 
1557 <span class="comment">% Get the Application data:</span>
1558 <span class="comment">% -------------------------</span>
1559 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1560 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1561 
1562 <span class="comment">% Check version tag against the web, and display a message</span>
1563 <span class="keyword">try</span>
1564     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1565     webdata = urlread(<span class="string">'http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1566     <span class="keyword">if</span> length(webdata) &gt; 5
1567         current_vmt_version{1} = webdata(1:5);
1568         current_vmt_version{2} = webdata(8:16);
1569     <span class="keyword">else</span>
1570         current_vmt_version = webdata;
1571     <span class="keyword">end</span>
1572     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1573 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1574     <span class="keyword">if</span> isdeployed
1575         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1576             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1577         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1578             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1579             errLogFileName},<span class="keyword">...</span>
1580             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1581             <span class="string">'error'</span>);
1582         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1583         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1584         fclose(fid);
1585         rethrow(err)
1586     <span class="keyword">else</span>
1587         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1588             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1589             <span class="string">'error'</span>);
1590         rethrow(err);
1591     <span class="keyword">end</span>
1592 <span class="keyword">end</span>
1593 
1594 <span class="keyword">if</span> ischar(current_vmt_version)
1595     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1596         h = msgbox(<span class="keyword">...</span>
1597             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1598             <span class="string">''</span>;<span class="keyword">...</span>
1599             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1600             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1601     <span class="keyword">else</span>
1602         h = msgbox(<span class="keyword">...</span>
1603             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1604             <span class="string">''</span>;<span class="keyword">...</span>
1605             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1606             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1607     <span class="keyword">end</span>
1608 <span class="keyword">elseif</span> iscell(current_vmt_version)
1609     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1610         h = msgbox(<span class="keyword">...</span>
1611             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1612             <span class="string">''</span>;<span class="keyword">...</span>
1613             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1614             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1615     <span class="keyword">else</span>
1616         h = msgbox(<span class="keyword">...</span>
1617             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1618             <span class="string">''</span>;<span class="keyword">...</span>
1619             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1620             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1621     <span class="keyword">end</span>
1622 <span class="keyword">end</span>
1623 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1624 
1625 <span class="comment">% --------------------------------------------------------------------</span>
1626 <a name="_sub49" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1627 
1628 <span class="comment">% Get the Application data:</span>
1629 <span class="comment">% -------------------------</span>
1630 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1631 messagestr = <span class="keyword">...</span>
1632     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1633     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1634     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1635     <span class="string">''</span>;<span class="keyword">...</span>
1636     <span class="string">''</span>;<span class="keyword">...</span>
1637     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1638     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1639     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1640     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1641     <span class="string">''</span>;<span class="keyword">...</span>
1642     <span class="string">''</span>;<span class="keyword">...</span>
1643     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1644     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1645     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1646     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1647     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1648     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1649     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1650 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1651 <span class="comment">% [EOF] menuAbout_Callback</span>
1652 
1653 
1654 
1655 
1656 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1657 <span class="comment">% TOOLBAR CALLBACKS %</span>
1658 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1659 
1660 <span class="comment">% --------------------------------------------------------------------</span>
1661 <a name="_sub50" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1662 <span class="comment">% Read Files into Data Structure using tfile.</span>
1663 
1664 <span class="comment">% Get the Application data:</span>
1665 <span class="comment">% -------------------------</span>
1666 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1667 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1668 
1669 <span class="comment">% Ask the user to select files:</span>
1670 <span class="comment">% -----------------------------</span>
1671 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1672 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1673     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1674     current_file, <span class="keyword">...</span>
1675     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1676 
1677 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1678     guiparams.data_folder = pathname;
1679     <span class="keyword">if</span> ischar(filename)
1680         filename = {filename};
1681     <span class="keyword">end</span>
1682     guiparams.data_files = filename;
1683     guiparams.mat_file = <span class="string">''</span>;
1684     
1685     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1686     
1687    
1688     
1689     <span class="comment">% Update the preferences:</span>
1690     <span class="comment">% -----------------------</span>
1691     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1692     guiprefs.ascii_path = pathname;
1693     guiprefs.ascii_file = filename;
1694     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1695     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1696     
1697     <span class="comment">% Push messages to Log Window:</span>
1698     <span class="comment">% ----------------------------</span>
1699     log_text = {<span class="keyword">...</span>
1700         <span class="string">''</span>;<span class="keyword">...</span>
1701         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1702         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1703         guiparams.data_folder;
1704         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1705         char(filename)};
1706     statusLogging(handles.LogWindow, log_text)
1707     
1708     <span class="comment">% Read the file(s)</span>
1709     <span class="comment">% ----------------</span>
1710     [~,~,savefile,A,z] = <span class="keyword">...</span>
1711         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1712     guiparams.savefile = savefile;
1713     guiparams.A        = A;
1714     guiparams.z        = z;
1715     
1716     
1717     <span class="comment">% Set the vertical grid node spacing</span>
1718     <span class="comment">% ----------------------------------</span>
1719     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1720     <span class="comment">% Backwards compatible</span>
1721     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1722         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1723         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1724     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1725         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1726         guiparams.vertical_grid_node_spacing = 0.4;
1727     <span class="keyword">end</span>
1728     
1729     
1730     <span class="comment">% Save application data</span>
1731     <span class="comment">% ---------------------</span>
1732     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1733        
1734 <span class="comment">%</span>
1735 <span class="comment">%     % Preprocess the data:</span>
1736 <span class="comment">%     % --------------------</span>
1737 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1738 <span class="comment">%</span>
1739 <span class="comment">%     % Push messages to Log Window:</span>
1740 <span class="comment">%     % ----------------------------</span>
1741 <span class="comment">%     log_text = {...</span>
1742 <span class="comment">%         '   Preprocessing complete.';...</span>
1743 <span class="comment">%         '   Begin Data Processing...'};</span>
1744 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1745 <span class="comment">%</span>
1746 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1747 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1748 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1749 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1750 <span class="comment">%         guiparams.unit_discharge_correction);</span>
1751 <span class="comment">%</span>
1752 <span class="comment">%     % Push messages to Log Window:</span>
1753 <span class="comment">%     % ----------------------------</span>
1754 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1755 <span class="comment">%</span>
1756 <span class="comment">%     % Store the data:</span>
1757 <span class="comment">%     % ---------------</span>
1758 <span class="comment">%     guiparams.z = z;</span>
1759 <span class="comment">%     guiparams.A = A;</span>
1760 <span class="comment">%     guiparams.V = V;</span>
1761 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1762     
1763           
1764     <span class="comment">% Update the GUI:</span>
1765     <span class="comment">% ---------------</span>
1766     <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1767     
1768     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1769     
1770 <span class="keyword">end</span>
1771 <span class="comment">% [EOF] loadDataCallback</span>
1772 
1773 
1774 
1775 <span class="comment">% --------------------------------------------------------------------</span>
1776 <a name="_sub51" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1777 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1778 
1779 <span class="comment">% Get the Application data:</span>
1780 <span class="comment">% -------------------------</span>
1781 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1782 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1783 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1784 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1785 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1786 
1787 [the_file,the_path] = <span class="keyword">...</span>
1788     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1789     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1790     fullfile(guiparams.mat_path,guiparams.savefile));
1791 
1792 <span class="comment">% Save the processed data to a MAT file:</span>
1793 <span class="comment">% --------------------------------------</span>
1794 <span class="keyword">if</span> ischar(the_file)
1795     guiparams.mat_path = the_path;
1796     guiparams.mat_file = the_file;
1797     guiparams.savefile = the_file;
1798     
1799     <span class="comment">% Re-store the Application data:</span>
1800     <span class="comment">% ------------------------------</span>
1801     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1802     
1803     <span class="comment">% Update the preferences:</span>
1804     <span class="comment">% -----------------------</span>
1805     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1806     guiprefs.mat_path = the_path;
1807     guiprefs.mat_file = the_file;
1808     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1809     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1810     
1811     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1812     savefile = fullfile(pathstr,[filename extension]);
1813     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1814     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1815     log_text = {<span class="keyword">...</span>
1816         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1817         savefile};
1818     statusLogging(handles.LogWindow,log_text)
1819     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1820 <span class="keyword">end</span>
1821 
1822 <span class="comment">% [EOF] saveDataCallback</span>
1823 
1824 
1825 <span class="comment">% --------------------------------------------------------------------</span>
1826 <a name="_sub52" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1827 
1828 <span class="comment">% Get the Application data:</span>
1829 <span class="comment">% -------------------------</span>
1830 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1831 z   = guiparams.z;
1832 A   = guiparams.A;
1833 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1834 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1835 
1836 <span class="comment">% Compute multibeam bathymetry:</span>
1837 <span class="comment">% -----------------------------</span>
1838 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1839 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1840 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1841     guiparams.beam_angle, <span class="keyword">...</span>
1842     guiparams.magnetic_variation, <span class="keyword">...</span>
1843     guiparams.wse, <span class="keyword">...</span>
1844     guiparams.output_auxiliary_data);
1845 
1846 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1847 
1848 <span class="comment">% [EOF] saveBathymetryCallback</span>
1849 
1850 <span class="comment">% --------------------------------------------------------------------</span>
1851 <a name="_sub53" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1852 
1853 <span class="comment">% Get the Application data:</span>
1854 <span class="comment">% -------------------------</span>
1855 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1856 
1857 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1858     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1859     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1860     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1861     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1862     handles.figure1);
1863 
1864 <span class="comment">% Update the GUI:</span>
1865 <span class="comment">% ---------------</span>
1866 <span class="keyword">if</span> guiparams.english_units
1867     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1868     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1869 <span class="keyword">else</span>
1870     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1871     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1872 <span class="keyword">end</span>
1873 
1874 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1875     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1876     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1877 <span class="keyword">else</span>
1878     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1879     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1880 <span class="keyword">end</span>
1881 
1882 <span class="keyword">if</span> guiparams.presentation
1883     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1884 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1885 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1886 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1887 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
1888 <span class="keyword">else</span>
1889     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
1890 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
1891 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
1892 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
1893 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
1894 <span class="keyword">end</span>
1895 
1896 <span class="comment">% Re-store the Application data:</span>
1897 <span class="comment">% ------------------------------</span>
1898 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1899 
1900 <span class="comment">% [EOF] plottingParametersCallback</span>
1901 
1902 
1903 <span class="comment">% --------------------------------------------------------------------</span>
1904 <a name="_sub54" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
1905 
1906 <span class="comment">% Get the Application data:</span>
1907 <span class="comment">% -------------------------</span>
1908 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1909 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1910 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1911 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1912 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1913 
1914 <span class="comment">% [EOF] processingParametersCallback</span>
1915 
1916 
1917 <span class="comment">% --------------------------------------------------------------------</span>
1918 <a name="_sub55" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
1919 <span class="comment">% Plot 1</span>
1920 
1921 <span class="comment">% Get the Application data:</span>
1922 <span class="comment">% -------------------------</span>
1923 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1924 z = guiparams.z;
1925 A = guiparams.A;
1926 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
1927 <span class="comment">% Map = guiparams.Map;</span>
1928 
1929 
1930 <span class="comment">% Preprocess the data:</span>
1931 <span class="comment">% --------------------</span>
1932 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
1933 
1934 <span class="comment">% Push messages to Log Window:</span>
1935 <span class="comment">% ----------------------------</span>
1936 log_text = {<span class="keyword">...</span>
1937     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
1938     <span class="string">'   Begin Data Processing...'</span>};
1939 statusLogging(handles.LogWindow, log_text)
1940 
1941 <span class="comment">% Process the transects:</span>
1942 <span class="comment">% ----------------------</span>
1943 A(1).hgns = guiparams.horizontal_grid_node_spacing;
1944 A(1).vgns = guiparams.vertical_grid_node_spacing;
1945 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
1946 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
1947     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
1948 
1949 <span class="comment">% Compute the smoothed variables</span>
1950 <span class="comment">% ------------------------------</span>
1951 <span class="comment">% This is required so that the V struc is complete at any point during</span>
1952 <span class="comment">% runtime.</span>
1953 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
1954     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
1955     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
1956     guiparams.vertical_smoothing_window);
1957 
1958 <span class="comment">% Push messages to Log Window:</span>
1959 <span class="comment">% ----------------------------</span>
1960 statusLogging(handles.LogWindow, processing_log_text)
1961 
1962 <span class="comment">% Store the data:</span>
1963 <span class="comment">% ---------------</span>
1964 guiparams.z = z;
1965 guiparams.A = A;
1966 guiparams.V = V;
1967 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1968 
1969 <span class="comment">% Push messages to Log Window:</span>
1970 <span class="comment">% ----------------------------</span>
1971 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
1972 statusLogging(handles.LogWindow, log_text)
1973 
1974 <span class="comment">% Create or replot the Shiptracks</span>
1975 <span class="comment">% -------------------------------</span>
1976 <span class="comment">% Grab the axes to the plot</span>
1977 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
1978 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
1979 
1980 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1981 <span class="comment">% New plot display window</span>
1982 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
1983 <span class="comment">% h = figure(1); clf</span>
1984 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
1985 
1986 <span class="comment">% [EOF] shiptracksPlotCallback</span>
1987 
1988 
1989 <span class="comment">% --------------------------------------------------------------------</span>
1990 <a name="_sub56" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
1991 <span class="comment">% Plot 2</span>
1992 
1993 <span class="comment">% Get the Application data:</span>
1994 <span class="comment">% -------------------------</span>
1995 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1996 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1997 
1998 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
1999     <span class="comment">% Push messages to Log Window:</span>
2000     <span class="comment">% ----------------------------</span>
2001     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2002     statusLogging(handles.LogWindow, log_text)
2003     
2004        
2005     <span class="comment">% Push plotting parameters to log window:</span>
2006     <span class="comment">% ---------------------------------------</span>
2007     log_text = {<span class="keyword">...</span>
2008         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2009         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2010         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2011         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2012         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2013         };
2014     statusLogging(handles.LogWindow, log_text)
2015     
2016     <span class="comment">% Plot the data:</span>
2017     <span class="comment">% --------------</span>
2018     z = [];
2019     A = [];
2020     V = [];
2021     Map = [];
2022     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2023     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2024         depth_range, <span class="keyword">...</span>
2025         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2026         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2027         guiparams.smoothing_window_size, <span class="keyword">...</span>
2028         guiparams.display_shoreline, <span class="keyword">...</span>
2029         guiparams.english_units, <span class="keyword">...</span>
2030         guiparams.mat_file, <span class="keyword">...</span>
2031         guiparams.mat_path); <span class="comment">% PLOT2</span>
2032     statusLogging(handles.LogWindow, log_text)
2033     
2034     <span class="comment">% Plot a Shoreline Map:</span>
2035     <span class="comment">% ---------------------</span>
2036     <span class="keyword">if</span> guiparams.display_shoreline
2037         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2038             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2039             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2040             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2041         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2042             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2043             Map.UTMe   = mapdata(:,1);
2044             Map.UTMn   = mapdata(:,2);
2045             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2046             <span class="comment">%Map.UTMzone = zone;</span>
2047         <span class="keyword">else</span>
2048             Map = [];
2049         <span class="keyword">end</span>
2050         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2051         log_text = {<span class="keyword">...</span>
2052             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2053             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2054             };
2055         statusLogging(handles.LogWindow, log_text)
2056     <span class="keyword">else</span>
2057         Map = [];
2058     <span class="keyword">end</span>
2059     
2060 <span class="keyword">else</span>
2061     z = guiparams.z;
2062     A = guiparams.A;
2063     <span class="comment">% V = guiparams.V;</span>
2064     Map = guiparams.Map;
2065     
2066     <span class="comment">% Push messages to Log Window:</span>
2067     <span class="comment">% ----------------------------</span>
2068     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2069     statusLogging(handles.LogWindow, log_text)
2070     
2071         
2072     <span class="comment">% Preprocess the data:</span>
2073     <span class="comment">% --------------------</span>
2074     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2075     
2076     <span class="comment">% Process the transects:</span>
2077     <span class="comment">% ----------------------</span>
2078     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2079     A(1).vgns = guiparams.vertical_grid_node_spacing;
2080     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2081     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2082         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2083     
2084     <span class="comment">% Compute the smoothed variables</span>
2085     <span class="comment">% ------------------------------</span>
2086     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2087     <span class="comment">% runtime.</span>
2088     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2089         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2090         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2091         guiparams.vertical_smoothing_window);
2092     
2093     <span class="comment">% Push messages to Log Window:</span>
2094     <span class="comment">% ----------------------------</span>
2095     statusLogging(handles.LogWindow, processing_log_text)
2096     
2097     <span class="comment">% Plot the cross section:</span>
2098     <span class="comment">% -----------------------</span>
2099     log_text = {<span class="keyword">...</span>
2100         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2101         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2102         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2103         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2104         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2105         };
2106     statusLogging(handles.LogWindow, log_text)
2107     
2108     <span class="comment">% Plot the data:</span>
2109     <span class="comment">% --------------</span>
2110     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2111     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2112     
2113     
2114     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2115         depth_range, <span class="keyword">...</span>
2116         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2117         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2118         guiparams.smoothing_window_size, <span class="keyword">...</span>
2119         guiparams.display_shoreline, <span class="keyword">...</span>
2120         guiparams.english_units, <span class="keyword">...</span>
2121         guiparams.mat_file, <span class="keyword">...</span>
2122         guiparams.mat_path); <span class="comment">% PLOT2</span>
2123     statusLogging(handles.LogWindow, log_text)
2124     
2125     <span class="comment">% Plot User Set Endpoints</span>
2126     <span class="comment">% -----------------------</span>
2127     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2128         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2129         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2130         x = data(:,1);
2131         y = data(:,2);
2132         
2133         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2134         figure(fh); hold on
2135         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2136         hold off
2137     <span class="keyword">end</span>
2138     
2139     <span class="comment">% Plot a Shoreline Map:</span>
2140     <span class="comment">% ---------------------</span>
2141     <span class="keyword">if</span> guiparams.display_shoreline
2142         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2143             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2144             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2145             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2146         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2147             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2148             Map.UTMe   = mapdata(:,1);
2149             Map.UTMn   = mapdata(:,2);
2150             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2151             <span class="comment">%Map.UTMzone = zone;</span>
2152         <span class="keyword">else</span>
2153             Map = [];
2154         <span class="keyword">end</span>
2155         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2156         log_text = {<span class="keyword">...</span>
2157             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2158             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2159             };
2160         statusLogging(handles.LogWindow, log_text)
2161     <span class="keyword">else</span>
2162         Map = [];
2163     <span class="keyword">end</span>
2164     
2165 <span class="keyword">end</span>
2166 
2167 <span class="keyword">if</span> guiparams.add_background
2168     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2169     statusLogging(handles.LogWindow, log_text)
2170 <span class="keyword">end</span>
2171 
2172 <span class="comment">% Update guiparams</span>
2173 <span class="comment">% ----------------</span>
2174 guiparams.z   = z;
2175 guiparams.A   = A;
2176 guiparams.V   = V;
2177 guiparams.Map = Map;
2178 guiparams.iric_anv_planview_data = PVdata;
2179 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2180 
2181 <span class="comment">% Update preferences</span>
2182 <span class="comment">% ------------------</span>
2183 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2184 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2185 <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2186 
2187 <span class="comment">% Force plot to be formated properly</span>
2188 <span class="comment">% ----------------------------------</span>
2189 <span class="keyword">if</span> guiparams.presentation
2190     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2191 <span class="keyword">else</span>
2192     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2193 <span class="keyword">end</span>
2194 <span class="keyword">switch</span> guiparams.renderer
2195     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2196         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2197     <span class="keyword">case</span> <span class="string">'painters'</span>
2198         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2199     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2200         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2201 <span class="keyword">end</span>
2202 
2203 <span class="comment">% Focus the figure</span>
2204 <span class="comment">% ----------------</span>
2205 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2206 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2207     figure(hff)
2208 <span class="keyword">end</span>
2209 
2210 <span class="comment">% Start the Graphics Control Gui</span>
2211 <span class="comment">% ------------------------------</span>
2212 VMT_GraphicsControl
2213 
2214 <span class="comment">% [EOF] planviewPlotCallback</span>
2215 
2216 
2217 <span class="comment">% --------------------------------------------------------------------</span>
2218 <a name="_sub57" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2219 <span class="comment">% Plot 3</span>
2220 
2221 <span class="comment">% Get the Application data:</span>
2222 <span class="comment">% -------------------------</span>
2223 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2224 z = guiparams.z;
2225 A = guiparams.A;
2226 <span class="comment">% V = guiparams.V;</span>
2227 <span class="comment">% Map = guiparams.Map;</span>
2228 
2229 <span class="comment">% Preprocess the data:</span>
2230 <span class="comment">% --------------------</span>
2231 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2232 
2233 <span class="comment">% Push messages to Log Window:</span>
2234 <span class="comment">% ----------------------------</span>
2235 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2236 statusLogging(handles.LogWindow, log_text)
2237 
2238 <span class="comment">% Process the transects:</span>
2239 <span class="comment">% ----------------------</span>
2240 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2241 A(1).vgns = guiparams.vertical_grid_node_spacing;
2242 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2243 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2244     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2245 
2246 <span class="comment">% Push messages to Log Window:</span>
2247 <span class="comment">% ----------------------------</span>
2248 statusLogging(handles.LogWindow, processing_log_text)
2249 
2250 <span class="comment">% Plot the cross section:</span>
2251 <span class="comment">% -----------------------</span>
2252 log_text = {<span class="keyword">...</span>
2253     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2254     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2255     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2256     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2257     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2258     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2259     sprintf(<span class="string">'   Horizontal smooting window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2260     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2261     };
2262 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2263     log_text = vertcat(log_text, {<span class="keyword">...</span>
2264         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2265         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2266         });
2267 <span class="keyword">end</span>
2268 <span class="comment">% Push messages to Log Window:</span>
2269 <span class="comment">% ----------------------------</span>
2270 statusLogging(handles.LogWindow, log_text)
2271 
2272 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2273     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2274 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2275 <span class="comment">%         ...guiparams.contour, ...</span>
2276 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2277 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2278     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2279         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2280         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2281         guiparams.vertical_smoothing_window);
2282     [~,A,V,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2283         guiparams.contour, <span class="keyword">...</span>
2284         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2285         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2286         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2287         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2288         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2289         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2290         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2291     
2292 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2293     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2294         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2295         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2296         guiparams.vertical_smoothing_window);
2297     
2298     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2299         guiparams.contour, <span class="keyword">...</span>
2300         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2301         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2302     
2303     guiparams.zmin = zmin;
2304     guiparams.zmax = zmax;
2305     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2306 <span class="keyword">end</span>
2307 
2308 <span class="comment">% Force plot to be formated properly</span>
2309 <span class="comment">% ----------------------------------</span>
2310 <span class="keyword">if</span> guiparams.presentation
2311     <a href="#_sub38" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2312 <span class="keyword">else</span>
2313     <a href="#_sub37" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2314 <span class="keyword">end</span>
2315 <span class="keyword">switch</span> guiparams.renderer
2316     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2317         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2318     <span class="keyword">case</span> <span class="string">'painters'</span>
2319         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2320     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2321         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2322 <span class="keyword">end</span>
2323 
2324 <span class="comment">% Focus the figure</span>
2325 <span class="comment">% ----------------</span>
2326 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2327 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2328     figure(hff)
2329 <span class="keyword">end</span>
2330 
2331 <span class="comment">% Re-store the Application data:</span>
2332 <span class="comment">% ------------------------------</span>
2333 guiparams.V = V;
2334 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2335 
2336 <span class="comment">% Start the Graphics Control Gui</span>
2337 <span class="comment">% ------------------------------</span>
2338 VMT_GraphicsControl
2339 
2340 <span class="comment">% Push messages to Log Window:</span>
2341 <span class="comment">% ----------------------------</span>
2342 statusLogging(handles.LogWindow, plot_cont_log_text)
2343 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2344 
2345 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2346 
2347 
2348 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2349 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2350 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2351 
2352 <span class="comment">% --------------------------------------------------------------------</span>
2353 <a name="_sub58" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2354 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2355 
2356 <span class="comment">% Get the Application data:</span>
2357 <span class="comment">% -------------------------</span>
2358 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2359 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2360 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2361 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2362 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2363 
2364 [the_file,the_path] = <span class="keyword">...</span>
2365     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2366     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2367     fullfile(guiparams.mat_path,guiparams.savefile));
2368 
2369 <span class="comment">% Save the processed data to a MAT file:</span>
2370 <span class="comment">% --------------------------------------</span>
2371 <span class="keyword">if</span> ischar(the_file)
2372     guiparams.mat_path = the_path;
2373     guiparams.mat_file = the_file;
2374     guiparams.savefile = the_file;
2375     
2376     <span class="comment">% Re-store the Application data:</span>
2377     <span class="comment">% ------------------------------</span>
2378     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2379     
2380     <span class="comment">% Update the preferences:</span>
2381     <span class="comment">% -----------------------</span>
2382     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2383     guiprefs.mat_path = the_path;
2384     guiprefs.mat_file = the_file;
2385     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2386     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2387     
2388     [~,filename,extension] = fileparts(guiparams.savefile);
2389     savefile = [filename extension];
2390     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2391         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2392     disp(<span class="string">'Saving Processed Data File...'</span>)
2393     disp(savefile)
2394     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2395 <span class="keyword">end</span>
2396 
2397 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2398 
2399 
2400 <span class="comment">% --------------------------------------------------------------------</span>
2401 <a name="_sub59" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2402 
2403 <span class="comment">% Get the Application data:</span>
2404 <span class="comment">% -------------------------</span>
2405 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2406 <span class="comment">% z   = guiparams.z;</span>
2407 <span class="comment">% A   = guiparams.A;</span>
2408 V   = guiparams.V;
2409 <span class="comment">% Map = guiparams.Map;</span>
2410 
2411 [the_file,the_path] = <span class="keyword">...</span>
2412     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2413     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2414     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2415 
2416 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2417 <span class="comment">% ------------------------------------------</span>
2418 <span class="keyword">if</span> ischar(the_file)
2419     guiparams.tecplot_path = the_path;
2420     guiparams.tecplot_file = the_file;
2421     
2422     <span class="comment">% Re-store the Application data:</span>
2423     <span class="comment">% ------------------------------</span>
2424     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2425     
2426     <span class="comment">% Update the preferences:</span>
2427     <span class="comment">% -----------------------</span>
2428     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2429     guiprefs.tecplot_path = the_path;
2430     guiprefs.tecplot_file = the_file;
2431     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2432     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2433     
2434     <span class="comment">% Push to log window</span>
2435     <span class="comment">% ------------------</span>
2436     log_text = {<span class="keyword">...</span>
2437         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2438         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2439         the_path;<span class="keyword">...</span>
2440         [<span class="string">'Filename: '</span> the_file]};
2441     statusLogging(handles.LogWindow,log_text)
2442         
2443     <span class="keyword">if</span> isempty(V)
2444         A = guiparams.A;
2445         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2446         A(1).vgns = guiparams.vertical_grid_node_spacing;
2447         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2448         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2449             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2450             guiparams.unit_discharge_correction);
2451     <span class="keyword">end</span>
2452     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2453     
2454     <span class="comment">% Push to log window</span>
2455     <span class="comment">% ------------------</span>
2456     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2457     statusLogging(handles.LogWindow,log_text)
2458     
2459     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2460     
2461     <span class="comment">% Push to log window</span>
2462     <span class="comment">% ------------------</span>
2463     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2464     statusLogging(handles.LogWindow,log_text)
2465    
2466 <span class="keyword">end</span>
2467 
2468 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2469 
2470 
2471 <span class="comment">% --------------------------------------------------------------------</span>
2472 <a name="_sub60" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2473 
2474 <span class="comment">% Get the Application data:</span>
2475 <span class="comment">% -------------------------</span>
2476 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2477 <span class="comment">% z   = guiparams.z;</span>
2478 A   = guiparams.A;
2479 V   = guiparams.V;
2480 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2481 
2482 [the_file,the_path] = <span class="keyword">...</span>
2483     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2484     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2485     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2486 
2487 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2488 <span class="comment">% -----------------------------------------------------</span>
2489 <span class="keyword">if</span> ischar(the_file)
2490     guiparams.kmz_path = the_path;
2491     guiparams.kmz_file = the_file;
2492     
2493     <span class="comment">% Re-store the Application data:</span>
2494     <span class="comment">% ------------------------------</span>
2495     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2496     
2497     <span class="comment">% Update the preferences:</span>
2498     <span class="comment">% -----------------------</span>
2499     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2500     guiprefs.kmz_path = the_path;
2501     guiprefs.kmz_file = the_file;
2502     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2503     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2504     
2505     <span class="comment">%     if guiparams.display_shoreline</span>
2506     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2507     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2508     <span class="comment">%                             guiparams.vertical_offset);</span>
2509     <span class="comment">%     end</span>
2510     <span class="keyword">if</span> isempty(V)
2511         A = guiparams.A;
2512         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2513         A(1).vgns = guiparams.vertical_grid_node_spacing;
2514         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2515         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2516             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2517             guiparams.unit_discharge_correction);
2518     <span class="keyword">end</span>
2519     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2520         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2521         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2522         guiparams.vertical_offset);
2523 <span class="keyword">end</span>
2524 
2525 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2526 
2527 
2528 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2529 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2530 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2531 
2532 <span class="comment">% --------------------------------------------------------------------</span>
2533 <a name="_sub61" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2534 
2535 <span class="comment">% Get the Application data:</span>
2536 <span class="comment">% -------------------------</span>
2537 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2538 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2539 z = guiparams.z;
2540 A = guiparams.A;
2541 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2542 <span class="comment">% Map = guiparams.Map;</span>
2543 setends = guiparams.set_cross_section_endpoints;
2544 
2545 [the_file,the_path] = <span class="keyword">...</span>
2546     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2547     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2548     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2549     guiprefs.multibeambathymetry_file));
2550 
2551 <span class="keyword">if</span> ischar(the_file)
2552     guiparams.multibeambathymetry_path = the_path;
2553     guiparams.multibeambathymetry_file = the_file;
2554     
2555     <span class="comment">% Re-store the Application data:</span>
2556     <span class="comment">% ------------------------------</span>
2557     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2558     
2559     <span class="comment">% Update the preferences:</span>
2560     <span class="comment">% -----------------------</span>
2561     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2562     guiprefs.multibeambathymetry_path = the_path;
2563     guiprefs.multibeambathymetry_file = the_file;
2564     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2565     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2566     
2567     <span class="keyword">if</span> guiparams.output_auxiliary_data
2568     <span class="keyword">end</span>
2569     
2570     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2571     
2572     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2573         guiparams.multibeambathymetry_file);
2574     
2575     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2576         [<span class="string">'   '</span> savefile]};
2577     statusLogging(handles.LogWindow,log_text)
2578     
2579     <span class="comment">% Process the transects:</span>
2580     <span class="comment">% ----------------------</span>
2581     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2582     A(1).vgns = guiparams.vertical_grid_node_spacing;
2583     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2584     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2585         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction);
2586     
2587     <span class="comment">% Compute the smoothed variables</span>
2588     <span class="comment">% ------------------------------</span>
2589     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2590     <span class="comment">% runtime.</span>
2591     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2592         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2593         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2594         guiparams.vertical_smoothing_window);
2595     
2596     <span class="comment">% Push messages to Log Window:</span>
2597     <span class="comment">% ----------------------------</span>
2598     statusLogging(handles.LogWindow, processing_log_text)
2599 
2600     
2601     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2602         guiparams.A, <span class="keyword">...</span>
2603         savefile, <span class="keyword">...</span>
2604         guiparams.beam_angle, <span class="keyword">...</span>
2605         guiparams.magnetic_variation, <span class="keyword">...</span>
2606         guiparams.wse, <span class="keyword">...</span>
2607         guiparams.output_auxiliary_data);
2608     
2609     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2610     
2611 <span class="keyword">end</span>
2612 
2613 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2614 
2615 
2616 <span class="comment">% --------------------------------------------------------------------</span>
2617 <a name="_sub62" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2618 <span class="comment">% Get the beam angle</span>
2619 
2620 <span class="comment">% Get the Application data:</span>
2621 <span class="comment">% -------------------------</span>
2622 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2623 
2624 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2625 <span class="comment">% ----------------------------------------------------------------</span>
2626 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2627 is_a_number = ~isnan(new_beam_angle);
2628 is_positive = new_beam_angle&gt;=0;
2629 
2630 <span class="comment">% Modify the Application data:</span>
2631 <span class="comment">% ----------------------------</span>
2632 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2633     guiparams.beam_angle = new_beam_angle;
2634     
2635     <span class="comment">% Re-store the Application data:</span>
2636     <span class="comment">% ------------------------------</span>
2637     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2638     
2639 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2640     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2641 <span class="keyword">end</span>
2642 
2643 <span class="comment">% [EOF] BeamAngle_Callback</span>
2644 
2645 
2646 <span class="comment">% --------------------------------------------------------------------</span>
2647 <a name="_sub63" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2648 <span class="comment">% Get the Magnetic Variation</span>
2649 
2650 <span class="comment">% Get the Application data:</span>
2651 <span class="comment">% -------------------------</span>
2652 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2653 
2654 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2655 <span class="comment">% ----------------------------------------------------------------</span>
2656 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2657 is_a_number = ~isnan(new_magnetic_variation);
2658 is_positive = new_magnetic_variation&gt;=0;
2659 
2660 <span class="comment">% Modify the Application data:</span>
2661 <span class="comment">% ----------------------------</span>
2662 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2663     guiparams.magnetic_variation = new_magnetic_variation;
2664     
2665     <span class="comment">% Re-store the Application data:</span>
2666     <span class="comment">% ------------------------------</span>
2667     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2668     
2669 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2670     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2671 <span class="keyword">end</span>
2672 
2673 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2674 
2675 
2676 <span class="comment">% --------------------------------------------------------------------</span>
2677 <a name="_sub64" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2678 
2679 <span class="comment">% Get the Application data:</span>
2680 <span class="comment">% -------------------------</span>
2681 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2682 
2683 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2684 <span class="comment">% ----------------------------------------------------------------</span>
2685 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2686 is_a_number = ~isnan(new_wse);
2687 is_positive = new_wse&gt;=0;
2688 
2689 <span class="comment">% Modify the Application data:</span>
2690 <span class="comment">% ----------------------------</span>
2691 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2692     guiparams.wse = new_wse;
2693     
2694     <span class="comment">% Re-store the Application data:</span>
2695     <span class="comment">% ------------------------------</span>
2696     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2697     
2698 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2699     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2700 <span class="keyword">end</span>
2701 
2702 <span class="comment">% [EOF] WSE_Callback</span>
2703 
2704 
2705 <span class="comment">% --------------------------------------------------------------------</span>
2706 <a name="_sub65" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2707 <span class="comment">% Bathymetry Auxiliary Data</span>
2708 
2709 <span class="comment">% Get the Application data:</span>
2710 <span class="comment">% -------------------------</span>
2711 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2712 
2713 <span class="comment">% Modify the Application data:</span>
2714 <span class="comment">% ----------------------------</span>
2715 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2716 
2717 <span class="comment">% Re-store the Application data:</span>
2718 <span class="comment">% ------------------------------</span>
2719 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2720 
2721 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2722 
2723 
2724 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2725 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2726 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2727 
2728 <span class="comment">% --------------------------------------------------------------------</span>
2729 <a name="_sub66" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2730 
2731 <span class="comment">% Get the Application data:</span>
2732 <span class="comment">% -------------------------</span>
2733 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2734 
2735 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2736 <span class="comment">% ----------------------------------------------------------------</span>
2737 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2738 is_a_number = ~isnan(new_depth_range_min);
2739 is_positive = new_depth_range_min&gt;=0;
2740 
2741 <span class="comment">% Modify the Application data:</span>
2742 <span class="comment">% ----------------------------</span>
2743 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2744     guiparams.depth_range_min = new_depth_range_min;
2745     
2746     <span class="comment">% Re-store the Application data:</span>
2747     <span class="comment">% ------------------------------</span>
2748     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2749     
2750 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2751     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2752 <span class="keyword">end</span>
2753 
2754 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2755 
2756 
2757 <span class="comment">% --------------------------------------------------------------------</span>
2758 <a name="_sub67" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2759 
2760 <span class="comment">% Get the Application data:</span>
2761 <span class="comment">% -------------------------</span>
2762 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2763 
2764 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2765 <span class="comment">% ----------------------------------------------------------------</span>
2766 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2767 is_a_number = ~isnan(new_depth_range_max);
2768 is_positive = new_depth_range_max&gt;=0;
2769 
2770 <span class="comment">% Modify the Application data:</span>
2771 <span class="comment">% ----------------------------</span>
2772 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2773     guiparams.depth_range_max = new_depth_range_max;
2774     
2775     <span class="comment">% Re-store the Application data:</span>
2776     <span class="comment">% ------------------------------</span>
2777     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2778     
2779 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2780     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2781 <span class="keyword">end</span>
2782 
2783 <span class="comment">% [EOF] DepthMax_Callback</span>
2784 
2785 
2786 <span class="comment">% --------------------------------------------------------------------</span>
2787 <a name="_sub68" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2788 <span class="comment">% Set quiver scale (contour)</span>
2789 
2790 <span class="comment">% Get the Application data:</span>
2791 <span class="comment">% -------------------------</span>
2792 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2793 
2794 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2795 <span class="comment">% ----------------------------------------------------------------</span>
2796 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2797 is_a_number = ~isnan(new_vector_scale_plan_view);
2798 is_positive = new_vector_scale_plan_view&gt;=0;
2799 
2800 <span class="comment">% Modify the Application data:</span>
2801 <span class="comment">% ----------------------------</span>
2802 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2803     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
2804     
2805     <span class="comment">% Re-store the Application data:</span>
2806     <span class="comment">% ------------------------------</span>
2807     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2808     
2809 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2810     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
2811 <span class="keyword">end</span>
2812 
2813 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
2814 
2815 
2816 <span class="comment">% --------------------------------------------------------------------</span>
2817 <a name="_sub69" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
2818 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
2819 
2820 <span class="comment">% Get the Application data:</span>
2821 <span class="comment">% -------------------------</span>
2822 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2823 
2824 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2825 <span class="comment">% ----------------------------------------------------------------</span>
2826 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2827 is_a_number = ~isnan(new_vector_spacing_plan_view);
2828 is_positive = new_vector_spacing_plan_view&gt;=0;
2829 
2830 <span class="comment">% Modify the Application data:</span>
2831 <span class="comment">% ----------------------------</span>
2832 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2833     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
2834     
2835     <span class="comment">% Re-store the Application data:</span>
2836     <span class="comment">% ------------------------------</span>
2837     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2838     
2839 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2840     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
2841 <span class="keyword">end</span>
2842 
2843 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
2844 
2845 
2846 <span class="comment">% --------------------------------------------------------------------</span>
2847 <a name="_sub70" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
2848 <span class="comment">% Plan View smoothing window size</span>
2849 
2850 <span class="comment">% Get the Application data:</span>
2851 <span class="comment">% -------------------------</span>
2852 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2853 
2854 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2855 <span class="comment">% ----------------------------------------------------------------</span>
2856 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
2857 is_a_number = ~isnan(new_smoothing_window_size);
2858 is_positive = new_smoothing_window_size&gt;=0;
2859 
2860 <span class="comment">% Modify the Application data:</span>
2861 <span class="comment">% ----------------------------</span>
2862 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2863     guiparams.smoothing_window_size = round(new_smoothing_window_size);
2864     
2865     <span class="comment">% Re-store the Application data:</span>
2866     <span class="comment">% ------------------------------</span>
2867     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2868     
2869 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2870     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
2871 <span class="keyword">end</span>
2872 
2873 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
2874 
2875 
2876 <span class="comment">% --------------------------------------------------------------------</span>
2877 <a name="_sub71" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
2878 
2879 <span class="comment">% Get the Application data:</span>
2880 <span class="comment">% -------------------------</span>
2881 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2882 
2883 <span class="comment">% Modify the Application data:</span>
2884 <span class="comment">% ----------------------------</span>
2885 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2886 
2887 <span class="comment">% Re-store the Application data:</span>
2888 <span class="comment">% ------------------------------</span>
2889 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2890 
2891 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
2892 
2893 
2894 <span class="comment">% --------------------------------------------------------------------</span>
2895 <a name="_sub72" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
2896 
2897 <span class="comment">% Get the Application data:</span>
2898 <span class="comment">% -------------------------</span>
2899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2900 
2901 <span class="comment">% Modify the Application data:</span>
2902 <span class="comment">% ----------------------------</span>
2903 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2904 
2905 <span class="comment">% Re-store the Application data:</span>
2906 <span class="comment">% ------------------------------</span>
2907 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2908 
2909 <span class="comment">% [EOF] AddBackground_Callback</span>
2910 
2911 
2912 <span class="comment">% --------------------------------------------------------------------</span>
2913 <a name="_sub73" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
2914 <a href="#_sub56" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
2915 <span class="comment">% [EOF] PlotPlanView_Callback</span>
2916 
2917 
2918 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2919 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
2920 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2921 
2922 <span class="comment">% --------------------------------------------------------------------</span>
2923 <a name="_sub74" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2924 <span class="comment">% Set the horizontal grid node spacing</span>
2925 
2926 <span class="comment">% Get the Application data:</span>
2927 <span class="comment">% -------------------------</span>
2928 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2929 
2930 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2931 <span class="comment">% ----------------------------------------------------------------</span>
2932 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2933 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
2934 is_positive = new_horizontal_grid_node_spacing&gt;=0;
2935 
2936 <span class="comment">% Modify the Application data:</span>
2937 <span class="comment">% ----------------------------</span>
2938 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2939     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
2940     
2941     <span class="comment">% Re-store the Application data:</span>
2942     <span class="comment">% ------------------------------</span>
2943     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2944     
2945 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2946     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
2947 <span class="keyword">end</span>
2948 
2949 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
2950 
2951 <span class="comment">% --------------------------------------------------------------------</span>
2952 <a name="_sub75" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
2953 <span class="comment">% Set the horizontal grid node spacing</span>
2954 
2955 <span class="comment">% Get the Application data:</span>
2956 <span class="comment">% -------------------------</span>
2957 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2958 
2959 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2960 <span class="comment">% ----------------------------------------------------------------</span>
2961 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
2962 is_a_number = ~isnan(new_vertical_grid_node_spacing);
2963 is_positive = new_vertical_grid_node_spacing&gt;=0;
2964 
2965 <span class="comment">% Modify the Application data:</span>
2966 <span class="comment">% ----------------------------</span>
2967 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2968     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
2969     
2970     <span class="comment">% Re-store the Application data:</span>
2971     <span class="comment">% ------------------------------</span>
2972     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2973     
2974 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2975     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
2976 <span class="keyword">end</span>
2977 
2978 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
2979 
2980 <span class="comment">% --------------------------------------------------------------------</span>
2981 <a name="_sub76" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
2982 <span class="comment">% Set the cross section endpoints manually</span>
2983 
2984 <span class="comment">% Get the Application data:</span>
2985 <span class="comment">% -------------------------</span>
2986 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2987 
2988 <span class="comment">% Modify the Application data:</span>
2989 <span class="comment">% ----------------------------</span>
2990 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2991 
2992 <span class="comment">% Re-store the Application data:</span>
2993 <span class="comment">% ------------------------------</span>
2994 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2995 
2996 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
2997 
2998 
2999 <span class="comment">% --------------------------------------------------------------------</span>
3000 <a name="_sub77" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3001 <a href="#_sub55" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3002 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3003 
3004 
3005 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3006 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3007 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3008 
3009 <span class="comment">% --------------------------------------------------------------------</span>
3010 <a name="_sub78" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3011 
3012 <span class="comment">% Get the Application data:</span>
3013 <span class="comment">% -------------------------</span>
3014 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3015 
3016 <span class="comment">% Modify the Application data:</span>
3017 <span class="comment">% ----------------------------</span>
3018 idx_variable = get(hObject,<span class="string">'Value'</span>);
3019 guiparams.idx_contour = idx_variable;
3020 guiparams.contour = guiparams.contours(idx_variable).variable;
3021 
3022 <span class="comment">% Re-store the Application data:</span>
3023 <span class="comment">% ------------------------------</span>
3024 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3025 
3026 <span class="comment">% [EOF] Contour_Callback</span>
3027 
3028 
3029 <span class="comment">% --------------------------------------------------------------------</span>
3030 <a name="_sub79" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3031 <span class="comment">% Set vertical exaggeration</span>
3032 
3033 <span class="comment">% Get the Application data:</span>
3034 <span class="comment">% -------------------------</span>
3035 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3036 
3037 <span class="comment">% Modify the Application data:</span>
3038 <span class="comment">% ----------------------------</span>
3039 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3040 
3041 <span class="comment">% Re-store the Application data:</span>
3042 <span class="comment">% ------------------------------</span>
3043 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3044 
3045 <span class="comment">% Update the GUI:</span>
3046 <span class="comment">% ---------------</span>
3047 <span class="comment">% updateGUI(handles,guiparams)</span>
3048 
3049 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3050 
3051 
3052 <span class="comment">% --------------------------------------------------------------------</span>
3053 <a name="_sub80" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3054 
3055 <span class="comment">% Get the Application data:</span>
3056 <span class="comment">% -------------------------</span>
3057 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3058 
3059 <span class="comment">% Modify the Application data:</span>
3060 <span class="comment">% ----------------------------</span>
3061 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3062 
3063 <span class="comment">% Re-store the Application data:</span>
3064 <span class="comment">% ------------------------------</span>
3065 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3066 
3067 <span class="comment">% Update the GUI:</span>
3068 <span class="comment">% ---------------</span>
3069 <span class="comment">% updateGUI(handles,guiparams)</span>
3070 
3071 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3072 
3073 
3074 <span class="comment">% --------------------------------------------------------------------</span>
3075 <a name="_sub81" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3076 
3077 <span class="comment">% Get the Application data:</span>
3078 <span class="comment">% -------------------------</span>
3079 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3080 
3081 <span class="comment">% Modify the Application data:</span>
3082 <span class="comment">% ----------------------------</span>
3083 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3084 
3085 <span class="comment">% Re-store the Application data:</span>
3086 <span class="comment">% ------------------------------</span>
3087 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3088 
3089 <span class="comment">% Update the GUI:</span>
3090 <span class="comment">% ---------------</span>
3091 <span class="comment">% updateGUI(handles,guiparams)</span>
3092 
3093 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3094 
3095 
3096 <span class="comment">% --------------------------------------------------------------------</span>
3097 <a name="_sub82" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3098 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3099 
3100 <span class="comment">% Get the Application data:</span>
3101 <span class="comment">% -------------------------</span>
3102 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3103 
3104 <span class="comment">% Modify the Application data:</span>
3105 <span class="comment">% ----------------------------</span>
3106 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3107 
3108 <span class="comment">% Re-store the Application data:</span>
3109 <span class="comment">% ------------------------------</span>
3110 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3111 
3112 <span class="comment">% Update the GUI:</span>
3113 <span class="comment">% ---------------</span>
3114 <span class="comment">% updateGUI(handles,guiparams)</span>
3115 
3116 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3117 
3118 
3119 <span class="comment">% --------------------------------------------------------------------</span>
3120 <a name="_sub83" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3121 <span class="comment">% Horizontal Smoothing</span>
3122 
3123 <span class="comment">% Get the Application data:</span>
3124 <span class="comment">% -------------------------</span>
3125 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3126 
3127 <span class="comment">% Modify the Application data:</span>
3128 <span class="comment">% ----------------------------</span>
3129 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3130 
3131 <span class="comment">% Re-store the Application data:</span>
3132 <span class="comment">% ------------------------------</span>
3133 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3134 
3135 <span class="comment">% Update the GUI:</span>
3136 <span class="comment">% ---------------</span>
3137 <span class="comment">% updateGUI(handles,guiparams)</span>
3138 
3139 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3140 
3141 
3142 <span class="comment">% --------------------------------------------------------------------</span>
3143 <a name="_sub84" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3144 <span class="comment">% Vertical Smoothing</span>
3145 
3146 <span class="comment">% Get the Application data:</span>
3147 <span class="comment">% -------------------------</span>
3148 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3149 
3150 <span class="comment">% Modify the Application data:</span>
3151 <span class="comment">% ----------------------------</span>
3152 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3153 
3154 <span class="comment">% Re-store the Application data:</span>
3155 <span class="comment">% ------------------------------</span>
3156 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3157 
3158 <span class="comment">% Update the GUI:</span>
3159 <span class="comment">% ---------------</span>
3160 <span class="comment">% updateGUI(handles,guiparams)</span>
3161 
3162 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3163 
3164 
3165 <span class="comment">% --------------------------------------------------------------------</span>
3166 <a name="_sub85" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3167 
3168 <span class="comment">% Get the Application data:</span>
3169 <span class="comment">% -------------------------</span>
3170 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3171 
3172 <span class="comment">% Modify the Application data:</span>
3173 <span class="comment">% ----------------------------</span>
3174 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3175 
3176 <span class="comment">% Re-store the Application data:</span>
3177 <span class="comment">% ------------------------------</span>
3178 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3179 
3180 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3181 
3182 
3183 <span class="comment">% --------------------------------------------------------------------</span>
3184 <a name="_sub86" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3185 
3186 <span class="comment">% Get the Application data:</span>
3187 <span class="comment">% -------------------------</span>
3188 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3189 
3190 <span class="comment">% Modify the Application data:</span>
3191 <span class="comment">% ----------------------------</span>
3192 idx_variable = get(hObject,<span class="string">'Value'</span>);
3193 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3194 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3195 
3196 <span class="comment">% Re-store the Application data:</span>
3197 <span class="comment">% ------------------------------</span>
3198 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3199 
3200 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3201 
3202 
3203 <span class="comment">% --------------------------------------------------------------------</span>
3204 <a name="_sub87" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3205 
3206 <span class="comment">% Get the Application data:</span>
3207 <span class="comment">% -------------------------</span>
3208 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3209 
3210 <span class="comment">% Modify the Application data:</span>
3211 <span class="comment">% ----------------------------</span>
3212 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3213 
3214 <span class="comment">% Re-store the Application data:</span>
3215 <span class="comment">% ------------------------------</span>
3216 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3217 
3218 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3219 
3220 
3221 <span class="comment">% --------------------------------------------------------------------</span>
3222 <a name="_sub88" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3223 <a href="#_sub57" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3224 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3225 
3226 
3227 <span class="comment">% --------------------------------------------------------------------</span>
3228 <a name="_sub89" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3229 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3230 <span class="comment">% [EOF] ClearLog_Callback</span>
3231 
3232 <span class="comment">% --------------------------------------------------------------------</span>
3233 <a name="_sub90" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3234 
3235 <span class="comment">% Get the Application data:</span>
3236 <span class="comment">% -------------------------</span>
3237 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3238 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3239 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3240 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3241 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3242 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3243 
3244 [the_file,the_path] = <span class="keyword">...</span>
3245     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3246     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3247     fullfile(guiprefs.log_path,guiprefs.log_file));
3248 
3249 <span class="comment">% Save the log to a TXT file:</span>
3250 <span class="comment">% ---------------------------</span>
3251 <span class="keyword">if</span> ischar(the_file)
3252     guiparams.log_path = the_path;
3253     guiparams.log_file = the_file;
3254     <span class="comment">%guiparams.savefile = the_file;</span>
3255     
3256     <span class="comment">% Re-store the Application data:</span>
3257     <span class="comment">% ------------------------------</span>
3258     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3259     
3260     <span class="comment">% Update the preferences:</span>
3261     <span class="comment">% -----------------------</span>
3262     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3263     guiprefs.log_path = the_path;
3264     guiprefs.log_file = the_file;
3265     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3266     <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3267     
3268     [~,filename,extension] = fileparts(the_file);
3269     savefile = [the_path filename extension];
3270     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3271         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3272     
3273     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3274     [nrows,~]= size(logfile);
3275     fid = fopen(savefile, <span class="string">'w'</span>);
3276     <span class="keyword">for</span> row=1:nrows
3277         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3278     <span class="keyword">end</span>
3279     fclose(fid);
3280 <span class="keyword">end</span>
3281 <span class="comment">% [EOF] SaveLog_Callback</span>
3282 
3283 <span class="comment">%%%%%%%%%%%%%%%%</span>
3284 <span class="comment">% SUBFUNCTIONS %</span>
3285 <span class="comment">%%%%%%%%%%%%%%%%</span>
3286 
3287 <span class="comment">% --------------------------------------------------------------------</span>
3288 <a name="_sub91" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3289 
3290 icons = <a href="#_sub107" class="code" title="subfunction icons = getIcons">getIcons</a>;
3291 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3292 
3293 <span class="comment">% Load data</span>
3294 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3295 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3296 <span class="comment">% icon(icon==0) = NaN;</span>
3297 handles.toolbarLoadData = <span class="keyword">...</span>
3298     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3299     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3300     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3301 
3302 <span class="comment">% Save data</span>
3303 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3304 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3305 <span class="comment">% icon(icon==0) = NaN;</span>
3306 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3307     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3308     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3309     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3310     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3311 
3312 
3313 <span class="comment">% Save bathymetry</span>
3314 <span class="comment">%icon = ones(16,16,3);</span>
3315 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3316     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3317     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3318     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3319 
3320 <span class="comment">% Save figures</span>
3321 <span class="comment">% icon = ones(16,16,3);</span>
3322 handles.toolbarSaveFigures = <span class="keyword">...</span>
3323     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3324     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3325     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3326 
3327 <span class="comment">% Save Excel File</span>
3328 <span class="comment">% icon = ones(16,16,3);</span>
3329 handles.toolbarSaveExcel = <span class="keyword">...</span>
3330     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3331     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3332     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3333 
3334 
3335 <span class="comment">% Plotting parameters</span>
3336 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3337 <span class="comment">% icon = ind2rgb(icon,map);</span>
3338 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3339     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3340     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3341     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3342     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3343 
3344 <span class="comment">% Processing parameters</span>
3345 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3346 <span class="comment">% icon = ind2rgb(icon,map);</span>
3347 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3348     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3349     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3350     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3351 
3352 <span class="comment">% Zoom In</span>
3353 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3354 <span class="comment">% icon = ind2rgb(icon,map);</span>
3355 <span class="comment">% handles.toolbarZoomIn = ...</span>
3356 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3357 <span class="comment">%     'CData',        icons(8).data, ...</span>
3358 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3359 <span class="comment">%     'Separator',     'on');</span>
3360 
3361 <span class="comment">% Zoom Out</span>
3362 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3363 <span class="comment">% icon = ind2rgb(icon,map);</span>
3364 <span class="comment">% handles.toolbarZoomOut = ...</span>
3365 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3366 <span class="comment">%     'CData',        icons(9).data, ...</span>
3367 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3368 
3369 <span class="comment">% Pan</span>
3370 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3371 <span class="comment">% icon = ind2rgb(icon,map);</span>
3372 <span class="comment">% handles.toolbarPan = ...</span>
3373 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3374 <span class="comment">%     'CData',        icons(10).data, ...</span>
3375 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3376 
3377 
3378 
3379 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub50" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3380 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub51" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3381 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub61" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3382 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3383 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub25" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3384 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub53" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3385 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3386 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3387 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3388 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3389 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3390 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3391 
3392 <span class="comment">% [EOF] buildtoolbar</span>
3393 
3394 
3395 <span class="comment">% --------------------------------------------------------------------</span>
3396 <a name="_sub92" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3397 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3398 <span class="comment">% already exist.</span>
3399 
3400 <span class="comment">% Preferences:</span>
3401 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3402 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3403 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3404 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3405 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3406 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3407 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3408 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3409 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3410 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3411 <span class="comment">% 'renderer'             Default graphics renderer</span>
3412 <span class="comment">% 'units'                Default plotting units</span>
3413 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3414 <span class="comment">%                        started</span>
3415 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3416 
3417 <span class="comment">% Originals</span>
3418 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3419 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3420 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3421 
3422 <span class="comment">% ASCII</span>
3423 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3424     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3425     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3426         guiprefs.ascii_path = ascii.path;
3427     <span class="keyword">else</span>
3428         guiprefs.ascii_path = pwd;
3429     <span class="keyword">end</span>
3430     does_exist = false(1,length(ascii.file));
3431     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3432         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3433     <span class="keyword">end</span>
3434     <span class="keyword">if</span> any(does_exist)
3435         guiprefs.ascii_file = ascii.file(does_exist);
3436     <span class="keyword">else</span>
3437         guiprefs.ascii_file = {<span class="string">''</span>};
3438     <span class="keyword">end</span>
3439 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3440     guiprefs.ascii_path = pwd;
3441     guiprefs.ascii_file = {<span class="string">''</span>};
3442     
3443     ascii.path = pwd;
3444     ascii.file = {<span class="string">''</span>};
3445     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3446 <span class="keyword">end</span>
3447 
3448 <span class="comment">% MAT</span>
3449 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3450     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3451     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3452         guiprefs.mat_path = mat.path;
3453     <span class="keyword">else</span>
3454         guiprefs.mat_path = pwd;
3455     <span class="keyword">end</span>
3456     
3457     <span class="keyword">if</span> iscell(mat.file)
3458         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3459             guiprefs.mat_file = mat.file;
3460         <span class="keyword">else</span>
3461             guiprefs.mat_file = <span class="string">''</span>;
3462         <span class="keyword">end</span>
3463     <span class="keyword">else</span>
3464         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3465             guiprefs.mat_file = mat.file;
3466         <span class="keyword">else</span>
3467             guiprefs.mat_file = <span class="string">''</span>;
3468         <span class="keyword">end</span>
3469     <span class="keyword">end</span>
3470 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3471     guiprefs.mat_path = pwd;
3472     guiprefs.mat_file = <span class="string">''</span>;
3473     
3474     mat.path = pwd;
3475     mat.file = <span class="string">''</span>;
3476     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3477 <span class="keyword">end</span>
3478 
3479 <span class="comment">% TECPLOT</span>
3480 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3481     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3482     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3483         guiprefs.tecplot_path = tecplot.path;
3484     <span class="keyword">else</span>
3485         guiprefs.tecplot_path = pwd;
3486     <span class="keyword">end</span>
3487     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3488         guiprefs.tecplot_file = tecplot.file;
3489     <span class="keyword">else</span>
3490         guiprefs.tecplot_file = <span class="string">''</span>;
3491     <span class="keyword">end</span>
3492 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3493     guiprefs.tecplot_path = pwd;
3494     guiprefs.tecplot_file = <span class="string">''</span>;
3495     
3496     tecplot.path = pwd;
3497     tecplot.file = <span class="string">''</span>;
3498     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3499 <span class="keyword">end</span>
3500 
3501 <span class="comment">% KMZ</span>
3502 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3503     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3504     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3505         guiprefs.kmz_path = kmz.path;
3506     <span class="keyword">else</span>
3507         guiprefs.kmz_path = pwd;
3508     <span class="keyword">end</span>
3509     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3510         guiprefs.kmz_file = kmz.file;
3511     <span class="keyword">else</span>
3512         guiprefs.kmz_file = <span class="string">''</span>;
3513     <span class="keyword">end</span>
3514 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3515     guiprefs.kmz_path = pwd;
3516     guiprefs.kmz_file = <span class="string">''</span>;
3517     
3518     kmz.path = pwd;
3519     kmz.file = <span class="string">''</span>;
3520     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3521 <span class="keyword">end</span>
3522 
3523 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3524 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3525     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3526     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3527         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3528     <span class="keyword">else</span>
3529         guiprefs.multibeambathymetry_path = pwd;
3530     <span class="keyword">end</span>
3531     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3532         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3533     <span class="keyword">else</span>
3534         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3535     <span class="keyword">end</span>
3536 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3537     guiprefs.multibeambathymetry_path = pwd;
3538     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3539     
3540     multibeambathymetry.path = pwd;
3541     multibeambathymetry.file = <span class="string">''</span>;
3542     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3543 <span class="keyword">end</span>
3544 
3545 <span class="comment">% Log</span>
3546 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3547     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3548     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3549         guiprefs.log_path = log.path;
3550     <span class="keyword">else</span>
3551         guiprefs.log_path = pwd;
3552     <span class="keyword">end</span>
3553     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3554         guiprefs.log_file = log.file;
3555     <span class="keyword">else</span>
3556         guiprefs.log_file = <span class="string">''</span>;
3557     <span class="keyword">end</span>
3558 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3559     guiprefs.log_path = pwd;
3560     guiprefs.log_file = <span class="string">''</span>;
3561     
3562     log.path = pwd;
3563     log.file = <span class="string">''</span>;
3564     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3565 <span class="keyword">end</span>
3566 
3567 <span class="comment">% iRic</span>
3568 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3569     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3570     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3571         guiprefs.iric_path = iric.path;
3572     <span class="keyword">else</span>
3573         guiprefs.iric_path = pwd;
3574     <span class="keyword">end</span>
3575     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3576         guiprefs.iric_file = iric.file;
3577     <span class="keyword">else</span>
3578         guiprefs.iric_file = <span class="string">''</span>;
3579     <span class="keyword">end</span>
3580 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3581     guiprefs.iric_path = pwd;
3582     guiprefs.iric_file = <span class="string">''</span>;
3583     
3584     iric.path = pwd;
3585     iric.file = <span class="string">''</span>;
3586     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3587 <span class="keyword">end</span>
3588 
3589 <span class="comment">% excel</span>
3590 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3591     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3592     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3593         guiprefs.excel_path = excel.path;
3594     <span class="keyword">else</span>
3595         guiprefs.excel_path = pwd;
3596     <span class="keyword">end</span>
3597     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3598         guiprefs.excel_file = excel.file;
3599     <span class="keyword">else</span>
3600         guiprefs.excel_file = <span class="string">''</span>;
3601     <span class="keyword">end</span>
3602 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3603     guiprefs.excel_path = pwd;
3604     guiprefs.excel_file = <span class="string">''</span>;
3605     
3606     excel.path = pwd;
3607     excel.file = <span class="string">''</span>;
3608     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3609 <span class="keyword">end</span>
3610 
3611 <span class="comment">% aerial</span>
3612 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3613     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3614     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3615         guiprefs.aerial_path = aerial.path;
3616     <span class="keyword">else</span>
3617         guiprefs.aerial_path = pwd;
3618     <span class="keyword">end</span>
3619     does_exist = false(1,length(aerial.file));
3620     <span class="keyword">if</span> iscell(aerial.file)
3621     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3622         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3623     <span class="keyword">end</span>
3624     <span class="keyword">else</span>
3625         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3626     <span class="keyword">end</span>
3627     <span class="keyword">if</span> any(does_exist)
3628         guiprefs.aerial_file = aerial.file;
3629     <span class="keyword">else</span>
3630         guiprefs.aerial_file = {<span class="string">''</span>};
3631     <span class="keyword">end</span>
3632 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3633     guiprefs.aerial_path = pwd;
3634     guiprefs.aerial_file = {<span class="string">''</span>};
3635     
3636     aerial.path = pwd;
3637     aerial.file = {<span class="string">''</span>};
3638     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3639 <span class="keyword">end</span>
3640 
3641 <span class="comment">% shoreline</span>
3642 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3643     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3644     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3645         guiprefs.shoreline_path = shoreline.path;
3646     <span class="keyword">else</span>
3647         guiprefs.shoreline_path = pwd;
3648     <span class="keyword">end</span>
3649     
3650     <span class="keyword">if</span> iscell(shoreline.file)
3651         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3652             guiprefs.shoreline_file = shoreline.file;
3653         <span class="keyword">else</span>
3654             guiprefs.shoreline_file = <span class="string">''</span>;
3655         <span class="keyword">end</span>
3656     <span class="keyword">else</span>
3657         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3658             guiprefs.shoreline_file = shoreline.file;
3659         <span class="keyword">else</span>
3660             guiprefs.shoreline_file = <span class="string">''</span>;
3661         <span class="keyword">end</span>
3662     <span class="keyword">end</span>
3663 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3664     guiprefs.shoreline_path = pwd;
3665     guiprefs.shoreline_file = <span class="string">''</span>;
3666     
3667     shoreline.path = pwd;
3668     shoreline.file = <span class="string">''</span>;
3669     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3670 <span class="keyword">end</span>
3671 <span class="comment">% guiprefs.presentation = true;</span>
3672 <span class="comment">% guiprefs.print        = false;</span>
3673 
3674 <span class="comment">% for k = 1:length(prefs)</span>
3675 <span class="comment">%     newpref = '';</span>
3676 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3677 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3678 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3679 <span class="comment">%             newpref = stored_newpref;</span>
3680 <span class="comment">%         else</span>
3681 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3682 <span class="comment">%         end</span>
3683 <span class="comment">%     end</span>
3684 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3685 <span class="comment">% end</span>
3686 
3687 <span class="comment">% RENDERER</span>
3688 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3689     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3690     guiprefs.renderer = renderer;
3691 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3692     renderer           = <span class="string">'OpenGL'</span>;
3693     guiprefs.renderer  = renderer;
3694     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3695 <span class="keyword">end</span>
3696 
3697 <span class="comment">% UNITS</span>
3698 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3699     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3700     guiprefs.units = units;
3701 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3702     units           = <span class="string">'metric'</span>;
3703     guiprefs.units  = renderer;
3704     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3705 <span class="keyword">end</span>
3706 
3707 <span class="comment">% RUNCOUNTER</span>
3708 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3709     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3710     guiprefs.runcounter = runcounter;
3711 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3712     runcounter           = 1;
3713     guiprefs.runcounter  = runcounter;
3714     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3715 <span class="keyword">end</span>
3716 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3717 
3718 <span class="comment">% SETENDPOINTS</span>
3719 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
3720     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
3721     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
3722         guiprefs.setendpoints_path = setendpoints.path;
3723     <span class="keyword">else</span>
3724         guiprefs.setendpoints_path = pwd;
3725     <span class="keyword">end</span>
3726     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
3727         guiprefs.setendpoints_file = setendpoints.file;
3728     <span class="keyword">else</span>
3729         guiprefs.setendpoints_file = <span class="string">''</span>;
3730     <span class="keyword">end</span>
3731 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3732     guiprefs.setendpoints_path = pwd;
3733     guiprefs.setendpoints_file = <span class="string">''</span>;
3734     
3735     setendpoints.path = pwd;
3736     setendpoints.file = <span class="string">''</span>;
3737     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3738 <span class="keyword">end</span>
3739 
3740 <span class="comment">% [EOF] load_prefs</span>
3741 
3742 
3743 <span class="comment">% --------------------------------------------------------------------</span>
3744 <a name="_sub93" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3745 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3746 <span class="comment">% preferences data.</span>
3747 
3748 <span class="comment">% Preferences:</span>
3749 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3750 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3751 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3752 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3753 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3754 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3755 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3756 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3757 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3758 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3759 <span class="comment">% 'renderer'             Default graphics renderer</span>
3760 <span class="comment">% 'units'                Default plotting units</span>
3761 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3762 <span class="comment">%                        started</span>
3763 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
3764 
3765 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3766 
3767 <span class="keyword">switch</span> pref
3768     <span class="keyword">case</span> <span class="string">'ascii'</span>
3769         ascii.path = guiprefs.ascii_path;
3770         ascii.file = guiprefs.ascii_file;
3771         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3772     <span class="keyword">case</span> <span class="string">'mat'</span>
3773         mat.path = guiprefs.mat_path;
3774         mat.file = guiprefs.mat_file;
3775         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3776     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3777         tecplot.path = guiprefs.tecplot_path;
3778         tecplot.file = guiprefs.tecplot_file;
3779         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3780     <span class="keyword">case</span> <span class="string">'kmz'</span>
3781         kmz.path = guiprefs.kmz_path;
3782         kmz.file = guiprefs.kmz_file;
3783         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3784     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3785         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3786         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3787         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3788     <span class="keyword">case</span> <span class="string">'log'</span>
3789         log.path = guiprefs.log_path;
3790         log.file = guiprefs.log_file;
3791         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3792     <span class="keyword">case</span> <span class="string">'iric'</span>
3793         iric.path = guiprefs.iric_path;
3794         iric.file = guiprefs.iric_file;
3795         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3796     <span class="keyword">case</span> <span class="string">'excel'</span>
3797         excel.path = guiprefs.excel_path;
3798         excel.file = guiprefs.excel_file;
3799         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3800     <span class="keyword">case</span> <span class="string">'aerial'</span>
3801         aerial.path = guiprefs.aerial_path;
3802         aerial.file = guiprefs.aerial_file;
3803         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3804     <span class="keyword">case</span> <span class="string">'shoreline'</span>
3805         shoreline.path = guiprefs.shoreline_path;
3806         shoreline.file = guiprefs.shoreline_file;
3807         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3808     <span class="keyword">case</span> <span class="string">'renderer'</span>
3809         renderer = guiprefs.renderer;
3810         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3811     <span class="keyword">case</span> <span class="string">'units'</span>
3812         units = guiprefs.units;
3813         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3814     <span class="keyword">case</span> <span class="string">'runcounter'</span>
3815         runcounter = guiprefs.runcounter;
3816         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3817     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
3818         setendpoints.path = guiprefs.setendpoints_path;
3819         setendpoints.file = guiprefs.setendpoints_file;
3820         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3821     <span class="keyword">otherwise</span>
3822 <span class="keyword">end</span>
3823 
3824 <span class="comment">% if ismember(pref,prefs)</span>
3825 <span class="comment">%     setpref('VMT',pref,value)</span>
3826 <span class="comment">%</span>
3827 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
3828 <span class="comment">%     guiprefs.(pref) = value;</span>
3829 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
3830 <span class="comment">% end</span>
3831 
3832 <span class="comment">% [EOF] store_prefs</span>
3833 
3834 
3835 <span class="comment">% --------------------------------------------------------------------</span>
3836 <a name="_sub94" href="#_subfunctions" class="code">function initGUI(handles)</a>
3837 <span class="comment">% Initialize the UI controls in the GUI.</span>
3838 
3839 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3840 
3841 <span class="comment">% Set the name and version</span>
3842 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
3843     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
3844 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
3845 
3846 <span class="comment">% Set the PLOT 1 axis labels</span>
3847 axes(handles.Plot1Shiptracks);
3848 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
3849 xlabel(<span class="string">'UTM Easting (m)'</span>)
3850 ylabel(<span class="string">'UTM Northing (m)'</span>)
3851 box on
3852 grid on
3853 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
3854 
3855 <span class="comment">%%%%%%%%%%%%</span>
3856 <span class="comment">% MENU BAR %</span>
3857 <span class="comment">%%%%%%%%%%%%</span>
3858 <span class="keyword">if</span> guiparams.english_units
3859     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3860     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3861 <span class="keyword">else</span>
3862     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3863     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3864 <span class="keyword">end</span>
3865 
3866 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
3867     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3868     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3869 <span class="keyword">else</span>
3870     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3871     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3872 <span class="keyword">end</span>
3873 
3874 
3875 <span class="keyword">if</span> guiparams.print
3876     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3877     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
3878     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3879     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3880 <span class="keyword">elseif</span> guiparams.presentation
3881     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3882     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
3883     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3884     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3885 <span class="keyword">else</span>
3886 <span class="keyword">end</span>
3887 
3888 <span class="keyword">switch</span> guiparams.renderer
3889     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
3890         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3891         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3892         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3893     <span class="keyword">case</span> <span class="string">'painters'</span>
3894         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3895         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3896         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3897     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
3898         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3899         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
3900         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
3901 <span class="keyword">end</span>
3902 
3903 
3904 <span class="comment">%%%%%%%%%%%%%%%</span>
3905 <span class="comment">% DATA EXPORT %</span>
3906 <span class="comment">%%%%%%%%%%%%%%%</span>
3907 <span class="comment">% BathymetryPanel</span>
3908 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
3909 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
3910 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
3911 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
3912 
3913 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3914 <span class="comment">% PLOTTING/PLAN VIEW %</span>
3915 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
3916 <span class="comment">% PlanViewPanel</span>
3917 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
3918 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
3919 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3920 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3921 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
3922 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
3923 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
3924 
3925 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3926 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
3927 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
3928 <span class="comment">% ShiptracksPanel</span>
3929 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3930 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3931 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
3932 
3933 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3934 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
3935 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3936 <span class="comment">% CrossSectionsPanel</span>
3937 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
3938     <span class="string">'Value'</span>, guiparams.idx_contour)
3939 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
3940 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
3941 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
3942 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
3943 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
3944 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
3945 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
3946 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
3947     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
3948 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
3949 
3950 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
3951 
3952 <span class="comment">% [EOF] initGUI</span>
3953 
3954 
3955 <span class="comment">% --------------------------------------------------------------------</span>
3956 <a name="_sub95" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
3957 
3958 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3959 
3960 <span class="keyword">switch</span> enable_state
3961     <span class="keyword">case</span> <span class="string">'init'</span>
3962         guiparams.gui_state = <span class="string">'init'</span>;
3963         set([handles.menuFile
3964             handles.menuOpen
3965             handles.menuOpenASCII
3966             handles.menuOpenMAT
3967             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3968         
3969         set([handles.toolbarLoadData
3970             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
3971         set([handles.toolbarSaveMatFile
3972             handles.toolbarSaveBathymetry
3973             handles.toolbarSaveFigures
3974             handles.toolbarSaveExcel
3975             handles.toolbarPlottingParameters
3976             handles.toolbarProcessingParameters
3977             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3978         
3979         set([handles.DepthRangeMin
3980             handles.DepthRangeMax
3981             handles.VectorScalePlanView
3982             handles.VectorSpacingPlanview
3983             handles.SmoothingWindowSize
3984             handles.DisplayShoreline
3985             handles.AddBackground
3986             handles.PlotPlanView
3987             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3988         
3989         set([handles.HorizontalGridNodeSpacing
3990             handles.VerticalGridNodeSpacing
3991             handles.PlotShiptracks
3992             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
3993         
3994         set([handles.Contour
3995             handles.VerticalExaggeration
3996             handles.VectorScaleCrossSection
3997             handles.HorizontalVectorSpacing
3998             handles.VerticalVectorSpacing
3999             handles.HorizontalSmoothingWindow
4000             handles.VerticalSmoothingWindow
4001             handles.PlotSecondaryFlowVectors
4002             handles.SecondaryFlowVectorVariable
4003             handles.IncludeVerticalVelocity
4004             handles.PlotCrossSection
4005             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4006         
4007     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4008         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4009         set([handles.menuFile
4010             handles.menuOpen
4011             handles.menuOpenASCII
4012             handles.menuOpenMAT
4013             handles.menuSaveMAT
4014             handles.menuSaveTecplot
4015             handles.menuSaveKMZFile
4016             handles.menuParameters
4017             handles.menuPlottingParameters
4018             handles.menuMetric
4019             handles.menuEnglish
4020             handles.menuBathymetryExportSettings
4021             handles.menuExportMultibeamBathymetry
4022             handles.menuKMZVerticalOffset
4023             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4024         
4025         set([handles.toolbarLoadData
4026             handles.toolbarSaveMatFile
4027             handles.toolbarSaveBathymetry
4028             handles.toolbarSaveExcel
4029             handles.toolbarSaveFigures
4030             handles.toolbarPlottingParameters
4031             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4032         set([handles.toolbarProcessingParameters
4033             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4034         
4035            
4036         set([handles.DepthRangeMin
4037             handles.DepthRangeMax
4038             handles.VectorScalePlanView
4039             handles.VectorSpacingPlanview
4040             handles.SmoothingWindowSize
4041             handles.DisplayShoreline
4042             handles.PlotPlanView
4043             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4044         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4045             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4046         <span class="keyword">else</span>
4047             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4048         <span class="keyword">end</span>
4049         
4050         set([handles.HorizontalGridNodeSpacing
4051             handles.VerticalGridNodeSpacing
4052             handles.PlotShiptracks
4053             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4054         
4055         set([handles.Contour
4056             handles.VerticalExaggeration
4057             handles.VectorScaleCrossSection
4058             handles.HorizontalVectorSpacing
4059             handles.VerticalVectorSpacing
4060             handles.HorizontalSmoothingWindow
4061             handles.VerticalSmoothingWindow
4062             handles.PlotSecondaryFlowVectors
4063             handles.SecondaryFlowVectorVariable
4064             handles.IncludeVerticalVelocity
4065             handles.PlotCrossSection
4066             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4067     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4068         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4069         set([handles.menuFile
4070             handles.menuOpen
4071             handles.menuOpenASCII
4072             handles.menuOpenMAT
4073             handles.menuParameters
4074             handles.menuPlottingParameters
4075             handles.menuMetric
4076             handles.menuEnglish
4077             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4078         set([handles.menuSaveMAT
4079             handles.menuBathymetryExportSettings
4080             handles.menuExportMultibeamBathymetry
4081             handles.menuKMZVerticalOffset
4082             handles.menuSaveKMZFile
4083             handles.menuSaveTecplot
4084             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4085         
4086         set([handles.toolbarLoadData
4087             handles.toolbarSaveFigures
4088             handles.toolbarPlottingParameters
4089             handles.toolbarSaveExcel
4090             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4091         set([handles.toolbarProcessingParameters
4092             handles.toolbarSaveMatFile
4093             handles.toolbarSaveBathymetry
4094             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4095         
4096         set([handles.DepthRangeMin
4097             handles.DepthRangeMax
4098             handles.VectorScalePlanView
4099             handles.VectorSpacingPlanview
4100             handles.SmoothingWindowSize
4101             handles.DisplayShoreline
4102             handles.PlotPlanView
4103             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4104         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4105             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4106         <span class="keyword">else</span>
4107             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4108         <span class="keyword">end</span>
4109         
4110         set([handles.HorizontalGridNodeSpacing
4111             handles.VerticalGridNodeSpacing
4112             handles.PlotShiptracks
4113             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4114         
4115         set([handles.Contour
4116             handles.VerticalExaggeration
4117             handles.VectorScaleCrossSection
4118             handles.HorizontalVectorSpacing
4119             handles.VerticalVectorSpacing
4120             handles.HorizontalSmoothingWindow
4121             handles.VerticalSmoothingWindow
4122             handles.PlotSecondaryFlowVectors
4123             handles.SecondaryFlowVectorVariable
4124             handles.IncludeVerticalVelocity
4125             handles.PlotCrossSection
4126             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4127     <span class="keyword">otherwise</span>
4128 <span class="keyword">end</span>
4129 
4130 <span class="comment">% Save Application Data</span>
4131 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4132 
4133 <span class="comment">% [EOF] set_enable</span>
4134 
4135 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4136 
4137 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4138 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4139 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4140 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4141 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4142 
4143 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4144 
4145 
4146 <span class="comment">% --------------------------------------------------------------------</span>
4147 <a name="_sub96" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4148     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4149 
4150 w = 500;
4151 h = 110;
4152 dx = 10;
4153 dy = 35;
4154 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4155 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4156     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4157     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4158     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4159     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4160     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4161     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4162     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4163     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4164     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4165     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4166 dialog_params.english_units               = english_units;
4167 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4168 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4169 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4170 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4171 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4172 
4173 <span class="comment">% Build the graphics:</span>
4174 <span class="comment">% -------------------</span>
4175 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4176     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4177     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4178     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4179 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4180     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4181     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4182     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4183     <span class="string">'Position'</span>,[15 35 100 22]);
4184 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4185     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4186     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4187     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4188     <span class="string">'Position'</span>,[15 10 100 22]);
4189 
4190 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4191     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4192     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4193     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4194 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4195     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4196     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4197     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4198     <span class="string">'Position'</span>,[15 35 100 22]);
4199 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4200     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4201     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4202     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4203     <span class="string">'Position'</span>,[15 10 100 22]);
4204 
4205 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4206     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4207     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4208     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4209 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4210     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4211     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4212     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4213     <span class="string">'Position'</span>,[15 35 100 22]);
4214 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4215     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4216     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4217     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4218     <span class="string">'Position'</span>,[15 10 100 22]);
4219 
4220 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4221     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4222     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4223     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4224     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4225 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4226     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4227     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4228     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4229     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4230 
4231 <span class="comment">% Update the UI controls:</span>
4232 <span class="comment">% -----------------------</span>
4233 <span class="keyword">if</span> dialog_params.english_units
4234     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4235     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4236 <span class="keyword">else</span>
4237     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4238     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4239 <span class="keyword">end</span>
4240 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4241     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4242     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4243 <span class="keyword">else</span>
4244     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4245     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4246 <span class="keyword">end</span>
4247 <span class="keyword">if</span> dialog_params.presentation
4248     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4249     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4250 <span class="keyword">else</span>
4251     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4252     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4253 <span class="keyword">end</span>
4254 
4255 <span class="comment">% Set the callbacks:</span>
4256 <span class="comment">% ------------------</span>
4257 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4258 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4259 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub97" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4260 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4261 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub98" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4262 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4263 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4264 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4265 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4266 
4267 <span class="comment">% Position the dialog and make it visible:</span>
4268 <span class="comment">% ----------------------------------------</span>
4269 fpos = get(hf,<span class="string">'Position'</span>);
4270 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4271 movegui(handles.Figure,dpos)
4272 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4273 
4274 <span class="comment">% Hold the dialog open:</span>
4275 <span class="comment">% ---------------------</span>
4276 waitfor(handles.OK)
4277 
4278 <span class="comment">% Return the outputs and close the dialog:</span>
4279 <span class="comment">% ----------------------------------------</span>
4280 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4281 english_units = dialog_params.english_units;
4282 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4283 plot_presentation_style =  dialog_params.presentation;
4284 plot_print_style =  dialog_params.print;
4285 
4286 delete(handles.Figure)
4287 
4288 <span class="comment">% [EOF] plotParametersDialog</span>
4289 
4290 
4291 <span class="comment">% --------------------------------------------------------------------</span>
4292 <a name="_sub97" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4293 
4294 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4295 <span class="keyword">switch</span> the_units
4296     <span class="keyword">case</span> <span class="string">'metric'</span>
4297         dialog_params.english_units = false;
4298         
4299         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4300         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4301     <span class="keyword">case</span> <span class="string">'english'</span>
4302         dialog_params.english_units = true;
4303         
4304         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4305         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4306     <span class="keyword">otherwise</span>
4307 <span class="keyword">end</span>
4308 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4309 
4310 <span class="comment">% [EOF] dialogUnits</span>
4311 
4312 <span class="comment">% --------------------------------------------------------------------</span>
4313 <a name="_sub98" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4314 
4315 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4316 <span class="keyword">switch</span> the_endpoints
4317     <span class="keyword">case</span> <span class="string">'auto'</span>
4318         dialog_params.set_cross_section_endpoints = false;
4319         
4320         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4321         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4322     <span class="keyword">case</span> <span class="string">'manual'</span>
4323         dialog_params.set_cross_section_endpoints = true;
4324         
4325         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4326         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4327     <span class="keyword">otherwise</span>
4328 <span class="keyword">end</span>
4329 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4330 
4331 <span class="comment">% [EOF] dialogEnpoints</span>
4332 
4333 <a name="_sub99" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4334 
4335 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4336 <span class="keyword">switch</span> the_style
4337     <span class="keyword">case</span> <span class="string">'presentation'</span>
4338         dialog_params.presentation  = true;
4339         dialog_params.print         = false;
4340         
4341         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4342         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4343     <span class="keyword">case</span> <span class="string">'print'</span>
4344         dialog_params.presentation  = false;
4345         dialog_params.print         = true;
4346         
4347         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4348         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4349     <span class="keyword">otherwise</span>
4350 <span class="keyword">end</span>
4351 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4352 
4353 <span class="comment">% [EOF] dialogEnpoints</span>
4354 
4355 <span class="comment">% --------------------------------------------------------------------</span>
4356 <a name="_sub100" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4357 
4358 delete(h_OK)
4359 
4360 <span class="comment">% [EOF] dialogOK</span>
4361 
4362 <span class="comment">% --------------------------------------------------------------------</span>
4363 <a name="_sub101" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4364 <span class="comment">% Return the original inputs</span>
4365 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4366 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4367 delete(handles.OK)
4368 
4369 <span class="comment">% [EOF] dialogCancel</span>
4370 
4371 <span class="comment">% --------------------------------------------------------------------</span>
4372 <a name="_sub102" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4373 
4374 delete(h_OK)
4375 
4376 <span class="comment">% [EOF] dialogCloseReq</span>
4377 
4378 <a name="_sub103" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data] = exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,hf)</a>
4379 w = 230;
4380 h = 200;
4381 dx = 10;
4382 dy = 35;
4383 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4384 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4385     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4386     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4387     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4388     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4389     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4390     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4391     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4392     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4393     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4394     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4395 dialog_params.beam_angle             = beam_angle;
4396 dialog_params.magnetic_variation     = magnetic_variation;
4397 dialog_params.wse                    = wse;
4398 dialog_params.output_auxiliary_data = output_auxiliary_data;
4399 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4400 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4401 
4402 <span class="comment">% Build the graphics:</span>
4403 <span class="comment">% -------------------</span>
4404 ph = 150;
4405 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4406     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4407     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4408     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4409 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4410     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4411     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4412     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4413     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4414     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4415     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4416 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4417     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4418     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4419     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4420     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4421     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4422     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4423 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4424     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4425     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4426     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4427     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4428     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4429     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4430 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4431     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4432     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4433     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4434     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4435     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4436     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4437 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4438     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4439     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4440     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4441     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4442     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4443     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4444 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4445     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4446     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4447     <span class="string">'String'</span>,num2str(wse),<span class="keyword">...</span>
4448     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4449     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4450     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4451 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4452     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4453     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4454     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4455     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4456 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4457     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4458     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4459     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4460     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4461 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4462     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4463     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4464     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4465     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4466 
4467 <span class="comment">% Update the UI controls:</span>
4468 <span class="comment">% -----------------------</span>
4469 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4470 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4471 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4472 set(handles.OutputauxiliaryData,     <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4473 
4474 <span class="comment">% Set the callbacks:</span>
4475 <span class="comment">% ------------------</span>
4476 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4477 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4478 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4479 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4480 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4481 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4482 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4483 
4484 <span class="comment">% Position the dialog and make it visible:</span>
4485 <span class="comment">% ----------------------------------------</span>
4486 fpos = get(hf,<span class="string">'Position'</span>);
4487 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4488 movegui(handles.Figure,dpos)
4489 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4490 
4491 <span class="comment">% Hold the dialog open:</span>
4492 <span class="comment">% ---------------------</span>
4493 waitfor(handles.OK)
4494 
4495 <span class="comment">% Return the outputs and close the dialog:</span>
4496 <span class="comment">% ----------------------------------------</span>
4497 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4498 beam_angle              = dialog_params.beam_angle;
4499 magnetic_variation      = dialog_params.magnetic_variation;
4500 wse                     = str2double(dialog_params.wse);
4501 output_auxiliary_data  = logical(dialog_params.output_auxiliary_data);
4502 
4503 delete(handles.Figure)
4504 
4505 <span class="comment">% [EOF] exportSettingsDialog</span>
4506 
4507 <span class="comment">% --------------------------------------------------------------------</span>
4508 <a name="_sub104" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4509 
4510 <span class="comment">% Grab the current data</span>
4511 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4512 
4513 <span class="comment">% Set it according to the dialog box values</span>
4514 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4515 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4516 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4517 dialog_params.output_auxiliary_data    = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4518 
4519 <span class="comment">% Re-store the application data</span>
4520 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4521 
4522 <span class="comment">% [EOF] dialogExportSettings</span>
4523 
4524 <a name="_sub105" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4525 
4526 w = 230;
4527 h = 200;
4528 dx = 10;
4529 dy = 35;
4530 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4531 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4532     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4533     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4534     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4535     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4536     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4537     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4538     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4539     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4540     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4541     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4542 dialog_params.figure_names               = figure_names;
4543 dialog_params.selected_figures           = <span class="string">''</span>;
4544 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4545 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4546 
4547 <span class="comment">% Build the graphics:</span>
4548 <span class="comment">% -------------------</span>
4549 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4550     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4551     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4552     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4553 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4554     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4555     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4556     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4557     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4558     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4559     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4560     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4561 
4562 
4563 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4564     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4565     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4566     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4567     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4568 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4569     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4570     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4571     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4572     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4573 
4574 <span class="comment">% Update the UI controls:</span>
4575 <span class="comment">% -----------------------</span>
4576 
4577 
4578 <span class="comment">% Set the callbacks:</span>
4579 <span class="comment">% ------------------</span>
4580 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub102" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4581 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4582 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4583 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4584 
4585 <span class="comment">% Position the dialog and make it visible:</span>
4586 <span class="comment">% ----------------------------------------</span>
4587 fpos = get(hf,<span class="string">'Position'</span>);
4588 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4589 movegui(handles.Figure,dpos)
4590 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4591 
4592 <span class="comment">% Hold the dialog open:</span>
4593 <span class="comment">% ---------------------</span>
4594 waitfor(handles.OK)
4595 
4596 <span class="comment">% Return the outputs and close the dialog:</span>
4597 <span class="comment">% ----------------------------------------</span>
4598 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4599 selected_figures = dialog_params.selected_figures;
4600 
4601 delete(handles.Figure)
4602 
4603 <span class="comment">% [EOF] openFiguresDialog</span>
4604 
4605 <span class="comment">% --------------------------------------------------------------------</span>
4606 <a name="_sub106" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4607 
4608 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4609 
4610 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4611 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4612 selected     = fig_names(idx_selected);
4613 dialog_params.selected_figures = selected;
4614 
4615 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4616 
4617 
4618 
4619 <span class="comment">% --------------------------------------------------------------------</span>
4620 <a name="_sub107" href="#_subfunctions" class="code">function icons = getIcons</a>
4621 
4622 <span class="comment">% Load data</span>
4623 idx = 1;
4624 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4625     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4626     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4627     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4628     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4629     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4630     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4631     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4632     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4633     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4634     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4635     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4636     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4637     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4638     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4639     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4640     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4641 
4642 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4643     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4644     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4645     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4646     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4647     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4648     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4649     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4650     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4651     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4652     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4653     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4654     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4655     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4656     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4657     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4658     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4659 
4660 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4661     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4662     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4663     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4664     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4665     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4666     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4667     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4668     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4669     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4670     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4671     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4672     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4673     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4674     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4675     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4676     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4677 
4678 <span class="comment">% Save data</span>
4679 idx = idx+1;
4680 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4681     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4682     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4683     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4684     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4685     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4686     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4687     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4688     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4689     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4690     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4691     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4692     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4693     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4694     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4695     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4696     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4697 
4698 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4699     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4700     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4701     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4702     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4703     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4704     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4705     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4706     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4707     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4708     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4709     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4710     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4711     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4712     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4713     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4714     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4715 
4716 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4717     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4718     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4719     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4720     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4721     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4722     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4723     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4724     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4725     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4726     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4727     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4728     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4729     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4730     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4731     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4732     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4733 
4734 <span class="comment">% Plotting parameters</span>
4735 idx = idx+1;
4736 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4737     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4738     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4739     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4740     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4741     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4742     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4743     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4744     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4745     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4746     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4747     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4748     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4749     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4750     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4751     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4752     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4753 
4754 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4755     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4756     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4757     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4758     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4759     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4760     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4761     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4762     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4763     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4764     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4765     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4766     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4767     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4768     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4769     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
4770     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
4771 
4772 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4773     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4774     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4775     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4776     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4777     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4778     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4779     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4780     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4781     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4782     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4783     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4784     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4785     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4786     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
4787     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
4788     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
4789 
4790 <span class="comment">% Processing parameters</span>
4791 idx = idx+1;
4792 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4793     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4794     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4795     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4796     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4797     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
4798     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4799     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4800     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4801     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
4802     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4803     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4804     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4805     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
4806     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
4807     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4808     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4809 
4810 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4811     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4812     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4813     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4814     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4815     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4816     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4817     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4818     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4819     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4820     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4821     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4822     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4823     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4824     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4825     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4826     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4827 
4828 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4829     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
4830     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
4831     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4832     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4833     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
4834     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4835     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4836     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4837     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
4838     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4839     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4840     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4841     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
4842     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
4843     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4844     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
4845 
4846 <span class="comment">% Export bathymetry dialog</span>
4847 idx = idx+1;
4848 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4849     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
4850     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
4851     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
4852     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
4853     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
4854     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
4855     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
4856     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
4857     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
4858     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
4859     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
4860     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
4861     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
4862     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
4863     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
4864     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
4865     ]/255;
4866 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4867     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4868     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4869     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4870     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4871     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4872     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4873     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4874     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4875     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4876     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4877     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4878     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4879     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4880     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4881     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4882     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4883     ]/255;
4884 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4885     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
4886     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
4887     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
4888     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
4889     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
4890     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
4891     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
4892     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
4893     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
4894     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
4895     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
4896     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
4897     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
4898     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
4899     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
4900     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
4901     ]/255;
4902 
4903 <span class="comment">% Export Figures Dialog</span>
4904 idx = idx + 1;
4905 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4906     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4907     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
4908     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
4909     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
4910     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
4911     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
4912     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
4913     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
4914     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
4915     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
4916     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
4917     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
4918     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
4919     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
4920     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4921 
4922 
4923 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4924     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
4925     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
4926     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
4927     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
4928     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
4929     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
4930     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
4931     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
4932     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
4933     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
4934     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
4935     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
4936     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
4937     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
4938     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4939 
4940 
4941 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4942     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
4943     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
4944     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
4945     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
4946     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
4947     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
4948     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
4949     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
4950     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
4951     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
4952     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
4953     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
4954     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
4955     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
4956     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
4957 
4958 <span class="comment">% Export Excel File</span>
4959 idx = idx + 1;
4960 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4961     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
4962    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
4963    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
4964    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
4965    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
4966    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
4967    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
4968    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
4969    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
4970    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
4971    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
4972    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
4973    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
4974    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
4975    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
4976     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
4977 
4978 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4979     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
4980    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
4981    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
4982    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
4983    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
4984    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
4985    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
4986    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
4987    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
4988    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
4989    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
4990    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
4991    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
4992    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
4993    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
4994     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
4995 
4996 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4997     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
4998    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
4999    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5000    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5001    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5002    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5003    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5004    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5005    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5006    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5007    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5008    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5009    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5010    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5011    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5012     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5013 
5014 <span class="comment">% Zoom In</span>
5015 idx = idx + 1;
5016 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5017     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5018 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5019     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5020 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5021     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5022 
5023 <span class="comment">% Zoom Out</span>
5024 idx = idx + 1;
5025 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5026     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5027 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5028     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5029 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5030     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5031 
5032 <span class="comment">% Pan</span>
5033 idx = idx + 1;
5034 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5035     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5036 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5037     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5038 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5039     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5040 <span class="comment">% [EOF] getIcons</span>
5041 
5042 <a name="_sub108" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5043 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5044 
5045 <span class="comment">% Check for any stored prefs</span>
5046 <span class="comment">% --------------------------</span>
5047 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5048 guiprefs = getpref(<span class="string">'VMT'</span>);
5049 
5050 <span class="comment">% Organized by GUI panels</span>
5051 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5052 <span class="comment">% SHIPTRACKS PLOT %</span>
5053 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5054 guiparams.horizontal_grid_node_spacing       = 1.0;
5055 guiparams.vertical_grid_node_spacing         = 0.4;
5056 
5057 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5058 <span class="comment">% CROSS SECTION PLOT %</span>
5059 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5060 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5061 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5062 guiparams.idx_contour                        = 1;
5063 guiparams.vertical_exaggeration              = 10;
5064 guiparams.vector_scale_cross_section         = 0.2;
5065 guiparams.horizontal_vector_spacing          = 1;
5066 guiparams.vertical_vector_spacing            = 1;
5067 guiparams.horizontal_smoothing_window        = 1;
5068 guiparams.vertical_smoothing_window          = 1;
5069 guiparams.plot_secondary_flow_vectors        = true;
5070 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5071 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5072 guiparams.idx_secondary_flow_vector_variable = 1;
5073 guiparams.include_vertical_velocity          = true;
5074 
5075 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5076 <span class="comment">% PLAN VIEW PLOT %</span>
5077 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5078 guiparams.depth_range_min                    = 0;
5079 guiparams.depth_range_max                    = inf;
5080 guiparams.vector_scale_plan_view             = 1;
5081 guiparams.vector_spacing_plan_view           = 1;
5082 guiparams.smoothing_window_size              = 1;
5083 guiparams.display_shoreline                  = false;
5084 guiparams.add_background                     = false;
5085 
5086 <span class="comment">%%%%%%%%%%%%%%%</span>
5087 <span class="comment">% DATA EXPORT %</span>
5088 <span class="comment">%%%%%%%%%%%%%%%</span>
5089 guiparams.beam_angle                         = 20.0;
5090 guiparams.magnetic_variation                 = 0.0;
5091 guiparams.wse                                = 0.0;
5092 guiparams.output_auxiliary_data              = false;
5093 
5094 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5095 <span class="comment">% Contour variables %</span>
5096 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5097 idx = 1;
5098 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5099 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5100 idx = idx + 1;
5101 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5102 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5103 idx = idx + 1;
5104 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5105 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5106 idx = idx + 1;
5107 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5108 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5109 idx = idx + 1;
5110 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5111 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5112 idx = idx + 1;
5113 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5114 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5115 idx = idx + 1;
5116 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5117 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5118 idx = idx + 1;
5119 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5120 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5121 idx = idx + 1;
5122 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5123 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5124 idx = idx + 1;
5125 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5126 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5127 idx = idx + 1;
5128 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5129 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5130 idx = idx + 1;
5131 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5132 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5133 idx = idx + 1;
5134 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5135 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5136 idx = idx + 1;
5137 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5138 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5139 idx = idx + 1;
5140 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5141 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5142 idx = idx + 1;
5143 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5144 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5145 idx = idx + 1;
5146 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5147 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5148 
5149 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5150 
5151 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5152 <span class="comment">% Secondary Flow Vector Variables %</span>
5153 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5154 idx = 1;
5155 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5156 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5157 idx = idx + 1;
5158 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5159 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5160 idx = idx + 1;
5161 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5162 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5163 idx = idx + 1;
5164 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5165 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5166 idx = idx + 1;
5167 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5168 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5169 
5170 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5171     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5172 
5173 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5174 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5175 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5176 <span class="comment">% Menu bar options</span>
5177 guiparams.presentation                       = true;
5178 guiparams.print                              = false;
5179 guiparams.set_cross_section_endpoints        = false;
5180 guiparams.unit_discharge_correction          = false;
5181 
5182 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5183     <span class="keyword">switch</span> guiprefs.units
5184         <span class="keyword">case</span> <span class="string">'metric'</span>
5185             guiparams.english_units          = false;
5186         <span class="keyword">case</span> <span class="string">'english'</span>
5187             guiparams.english_units          = true;
5188     <span class="keyword">end</span>
5189 <span class="keyword">else</span>
5190     guiparams.english_units                  = false;
5191 <span class="keyword">end</span>
5192 guiparams.vertical_offset                    = 0;
5193 
5194 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5195     guiparams.renderer                       = guiprefs.renderer;
5196 <span class="keyword">else</span>
5197     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5198 <span class="keyword">end</span>
5199 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5200 <span class="comment">% guiparams.plot_planview                      = false;</span>
5201 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5202 
5203 <span class="comment">% File location defaults</span>
5204 guiparams.ascii_path                        = pwd;
5205 guiparams.ascii_file                        = <span class="string">''</span>;
5206 guiparams.mat_path                          = pwd;
5207 guiparams.mat_file                          = <span class="string">''</span>;
5208 guiparams.tecplot_path                      = pwd;
5209 guiparams.tecplot_file                      = <span class="string">''</span>;
5210 guiparams.kmz_path                          = pwd;
5211 guiparams.kmz_file                          = <span class="string">''</span>;
5212 guiparams.multibeambathymetry_path          = pwd;
5213 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5214 guiparams.log_path                          = pwd;
5215 guiparams.log_file                          = <span class="string">''</span>;
5216 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5217 <span class="comment">% application</span>
5218 <span class="keyword">if</span> isdeployed 
5219     guiparams.has_mapping_toolbox           = true;
5220 <span class="keyword">else</span>
5221     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5222         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5223 <span class="keyword">end</span>
5224 
5225 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5226 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5227 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5228 guiparams.z                      = [];
5229 guiparams.A                      = [];
5230 guiparams.V                      = [];
5231 guiparams.Map                    = [];
5232 guiparams.savefile               = [];
5233 guiparams.iric_anv_planview_data = [];
5234 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5235 <span class="comment">% guiparams.zmax = [];</span>
5236 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5237 guiparams.data_folder = <span class="string">''</span>;
5238 guiparams.data_files  = {<span class="string">''</span>};
5239 guiparams.gui_state   = <span class="string">'init'</span>;
5240 
5241 <span class="comment">% [EOF] createGUIparams</span>
5242 
5243 <a name="_sub109" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5244 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5245 
5246 <a name="_sub110" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5247 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5248 
5249 <span class="comment">% [EOF] VMT</span>
5250 
5251 
5252 
5253 
5254 
5255 <span class="comment">% --- Hidden keyboard commands</span>
5256 <a name="_sub111" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5257 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5258 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5259 <span class="comment">%</span>
5260 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5261 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5262 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5263 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5264 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5265 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5266 
5267 in1 = eventdata.Modifier; 
5268 in2 = eventdata.Key;
5269 
5270 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5271     input = [in1{:} in2];
5272 <span class="keyword">else</span>
5273     input = in2;
5274 <span class="keyword">end</span>
5275 
5276 <span class="keyword">switch</span> input
5277     <span class="comment">% Hidden SonTek M9 support</span>
5278     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5279         msgtxt = {<span class="keyword">...</span>
5280             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5281             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5282             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5283             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5284             <span class="string">''</span>;<span class="keyword">...</span>
5285             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5286             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5287             <span class="string">'PROVISIONAL at best.'</span>};
5288         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5289         
5290         <span class="comment">% Get the Application data:</span>
5291         <span class="comment">% -------------------------</span>
5292         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5293         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5294         
5295         <span class="comment">% Ask the user to select files:</span>
5296         <span class="comment">% -----------------------------</span>
5297         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5298         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5299         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5300             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5301         <span class="keyword">else</span>
5302             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5303         <span class="keyword">end</span>
5304         [filename,pathname] = <span class="keyword">...</span>
5305             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5306             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5307             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5308         
5309         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5310             guiparams.data_folder = pathname;
5311             <span class="keyword">if</span> ischar(filename)
5312                 filename = {filename};
5313             <span class="keyword">end</span>
5314             guiparams.data_files = filename;
5315             guiparams.mat_file = <span class="string">''</span>;
5316             
5317             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5318             
5319             
5320             
5321             <span class="comment">% Update the preferences:</span>
5322             <span class="comment">% -----------------------</span>
5323             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5324             guiprefs.ascii_path = pathname;
5325             guiprefs.ascii_file = filename;
5326             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5327             <a href="#_sub93" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5328             
5329             <span class="comment">% Push messages to Log Window:</span>
5330             <span class="comment">% ----------------------------</span>
5331             log_text = {<span class="keyword">...</span>
5332                 <span class="string">''</span>;<span class="keyword">...</span>
5333                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5334                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5335                 guiparams.data_folder;
5336                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5337                 char(filename)};
5338             statusLogging(handles.LogWindow, log_text)
5339             
5340             <span class="comment">% Read the file(s)</span>
5341             <span class="comment">% ----------------</span>
5342             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5343             
5344             [~,~,savefile,A,z] = <span class="keyword">...</span>
5345                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5346             guiparams.savefile = savefile;
5347             guiparams.A        = A;
5348             guiparams.z        = z;
5349             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5350             
5351             
5352             <span class="comment">% Update the GUI:</span>
5353             <span class="comment">% ---------------</span>
5354             <a href="#_sub95" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5355         <span class="keyword">end</span>  
5356     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5357         SontekMAT2KML;
5358     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5359         <a href="#_sub46" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5360         
5361     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5362         VMT_BuildCustomFlatFile;
5363     <span class="keyword">otherwise</span>
5364         <span class="comment">%disp(input)</span>
5365 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 02-Oct-2014 09:38:47 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>