<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub97" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub98" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub99" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub100" class="code">function initGUI(handles)</a></li><li><a href="#_sub101" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub102" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub103" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub104" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub105" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub106" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub108" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub109" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub110" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub112" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub113" class="code">function icons = getIcons</a></li><li><a href="#_sub114" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub115" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub116" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub117" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub97" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub98" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub114" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20151210'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub100" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub101" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub101" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub101" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub111" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.water_surface_elevation;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.water_surface_elevation = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.water_surface_elevation = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">else</span>
0651     wsedata.obstime = [];
0652     wsedata.elev    = [];
0653     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0654 <span class="keyword">end</span>
0655 <span class="comment">%  [EOF] loadTideFile</span>
0656 
0657 <span class="comment">% --------------------------------------------------------------------</span>
0658 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0659 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0660 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0661 
0662 
0663 <span class="comment">% --------------------------------------------------------------------</span>
0664 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0665 
0666 <span class="comment">% Get the Application Data:</span>
0667 <span class="comment">% -------------------------</span>
0668 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0669 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0670 PVdata    = guiparams.iric_anv_planview_data;
0671 iric_path = guiprefs.iric_path;
0672 iric_file = guiprefs.iric_file;
0673 
0674 <span class="comment">% Is there any planview data?</span>
0675 <span class="keyword">if</span> isempty(PVdata)
0676     <span class="comment">% Nothing to do, warn user</span>
0677     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0678     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0679 <span class="keyword">else</span>
0680     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0681     <span class="comment">% and smoothing (for iRiC)</span>
0682     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0683     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0684         fullfile(iric_path,iric_file));
0685     
0686     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0687         outfile = fullfile(iric_path,iric_file);
0688         log_text = vertcat(log_text,{outfile});
0689         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0690         outcount = fprintf(ofid,<span class="keyword">...</span>
0691             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0692         fclose(ofid);
0693     <span class="keyword">else</span>
0694         <span class="comment">% Return default iric_path and iric_file</span>
0695         iric_path = guiprefs.iric_path;
0696         iric_file = guiprefs.iric_file;
0697     <span class="keyword">end</span>
0698 <span class="keyword">end</span>
0699 
0700 <span class="comment">% Push messages to Log Window:</span>
0701 <span class="comment">% ----------------------------</span>
0702 statusLogging(handles.LogWindow, log_text)
0703 
0704 <span class="comment">% Store the persistent preferences:</span>
0705 <span class="comment">% ---------------------------------</span>
0706 guiprefs.iric_file = iric_file;
0707 guiprefs.iric_path = iric_path;
0708 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0709 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0710 
0711 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0712 
0713 <span class="comment">% --------------------------------------------------------------------</span>
0714 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0715 <span class="comment">% Get the Application Data:</span>
0716 <span class="comment">% -------------------------</span>
0717 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0718 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0719 excel_path  = guiprefs.excel_path;
0720 excel_file  = guiprefs.excel_file;
0721 
0722 <span class="comment">% Push messages to Log Window:</span>
0723 <span class="comment">% ----------------------------</span>
0724 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0725 statusLogging(handles.LogWindow, log_text)
0726 
0727 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0728 <span class="comment">% data.</span>
0729 <span class="keyword">if</span> iscell(guiparams.mat_file)
0730     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0731     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0732     <span class="comment">% Refresh the Application Data:</span>
0733     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0734     z           = guiparams.z;
0735     A           = guiparams.A;
0736     V           = guiparams.V;
0737     Map         = guiparams.Map;
0738     wse         = guiparams.water_surface_elevation;
0739     PVdata      = guiparams.iric_anv_planview_data;
0740     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0741         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0742     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0743         fullfile(excel_path,excel_file));
0744     
0745     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0746         outfile = fullfile(excel_path,excel_file);
0747         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0748         
0749     <span class="keyword">else</span>
0750         <span class="comment">% Return default excel_path and excel_file</span>
0751         excel_path = guiprefs.excel_path;
0752         excel_file = guiprefs.excel_file;
0753         outfile = fullfile(excel_path,excel_file);
0754         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0755     <span class="keyword">end</span>
0756     
0757     <span class="comment">% Delete the old file if it exists</span>
0758     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0759         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0760             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0761             <span class="string">'already exists. Overwriting file...'</span>});
0762         delete(outfile)
0763     <span class="keyword">end</span>
0764     
0765     <span class="comment">% Save MCS Summary to an Excel File</span>
0766     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0767     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0768     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0769     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0770         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0771         sout = guiparams.mat_file';
0772     <span class="keyword">end</span>
0773     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0774     sout = {<span class="keyword">...</span>
0775         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0776         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0777         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0778         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0779         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0780         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0781         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0782         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0783         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0784         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0785         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0786         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0787         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0788         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0789         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0790         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0791         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0792         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0793         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0794         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0795         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0796         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0797         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0798         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0799         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0800         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0801         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0802         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0803         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0804         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0805         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0806         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0807         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0808         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0809         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0810         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0811         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0812         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0813         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0814         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0815         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0816         };
0817     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0818     
0819     <span class="comment">% Save DAV data to an Excel File</span>
0820     vmin = num2str(guiparams.depth_range_min);
0821     vmax = num2str(guiparams.depth_range_max);
0822     pvheaders = {<span class="keyword">...</span>
0823         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0824         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0825         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0826         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0827 
0828     <span class="comment">% Initialize Variables</span>
0829     pvdata = []; Dist = []; ID = {};
0830     X = []; Y = []; E = []; T = [];
0831     Ve = []; Vn =[]; Vm = []; Vd = [];
0832     
0833     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0834     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0835         <span class="comment">% Load current MAT-file</span>
0836         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0837         
0838         <span class="comment">% Location, Time and Bathy</span>
0839         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0840         X = [X V.mcsX(1,:)];
0841         Y = [Y V.mcsY(1,:)];
0842         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0843         E = [E V.mcsBedElev];
0844         T = [T V.mcsTime(1,:)];
0845                 
0846         <span class="comment">% Build layer-averaged velocities</span>
0847         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0848         V.mcsX(indx,:) = nan;
0849         V.mcsY(indx,:) = nan;
0850         V.mcsEast(indx,:) = nan;
0851         V.mcsNorth(indx,:) = nan;
0852         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0853         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0854         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0855         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0856         
0857         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0858     <span class="keyword">end</span>
0859     
0860     <span class="comment">% Put output into 1 matrix</span>
0861     pvdata = [<span class="keyword">...</span>
0862         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0863         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0864         ];
0865     pvdata(isnan(pvdata)) = -9999;
0866     
0867     <span class="comment">% Create table and write to Excel</span>
0868     pvout = num2cell(pvdata');
0869     pvout = horzcat(ID,pvout);
0870     timestamp = cellstr(nandatestr(T));
0871     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0872     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0873     
0874     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0875     <span class="comment">% results</span>
0876     PVheaders = {<span class="keyword">...</span>
0877         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0878         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0879         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0880         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0881         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0882     PVtable = [<span class="keyword">...</span>
0883         PVdata.outmat(1,:);<span class="keyword">...</span>
0884         PVdata.outmat(2,:);<span class="keyword">...</span>
0885         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0886         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0887         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0888         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0889         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0890     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0891     PVtable(isnan(PVtable)) = -9999;
0892     PVout = horzcat(<span class="keyword">...</span>
0893         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0894         PVdata.outfile,<span class="keyword">...</span>
0895         num2cell(PVtable'));
0896     PVout = vertcat(PVheaders,PVout);
0897     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0898     
0899     <span class="comment">% Close out waitbar</span>
0900     waitbar(1,hwait)
0901     delete(hwait)
0902     
0903     <span class="comment">% Push messages to Log Window:</span>
0904     <span class="comment">% ----------------------------</span>
0905     statusLogging(handles.LogWindow, log_text)
0906 <span class="keyword">else</span>
0907     
0908     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0909     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0910     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0911     <span class="comment">% Refresh the Application Data:</span>
0912     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0913     z           = guiparams.z;
0914     A           = guiparams.A;
0915     V           = guiparams.V;
0916     Map         = guiparams.Map;
0917     wse         = guiparams.water_surface_elevation;
0918     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0919                                                     <span class="comment">% Planview Plot exactly</span>
0920     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
0921                                  <span class="comment">% planview plot</span>
0922         
0923     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0924     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0925         fullfile(excel_path,excel_file));
0926     
0927     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0928         outfile = fullfile(excel_path,excel_file);
0929         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0930         
0931         <span class="comment">% Delete the old file if it exists</span>
0932         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0933             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0934                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0935                 <span class="string">'already exists. Overwriting file...'</span>});
0936             delete(outfile)
0937         <span class="keyword">end</span>
0938         
0939         <span class="comment">% Push messages to Log Window:</span>
0940         <span class="comment">% ----------------------------</span>
0941         statusLogging(handles.LogWindow, log_text)
0942         
0943         <span class="comment">% Save MCS Summary to an Excel File</span>
0944         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0945         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0946         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0947         waitbar(1/5,hwait)
0948         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
0949             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0950             sout = {guiparams.mat_file};
0951         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0952             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0953             sout = guiparams.data_files';
0954         <span class="keyword">end</span>
0955         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0956         waitbar(2/7,hwait)
0957         sout = {<span class="keyword">...</span>
0958             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0959             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0960             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0961             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0962             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0963             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0964             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0965             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0966             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0967             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0968             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0969             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0970             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0971             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0972             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0973             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0974             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0975             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0976             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0977             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0978             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0979             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0980             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0981             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0982             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0983             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0984             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0985             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0986             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0987             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0988             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0989             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0990             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0991             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0992             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0993             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0994             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0995             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0996             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0997             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0998             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0999             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1000             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1001             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1002             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1003             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1004             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1005             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1006             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1007             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1008             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1009             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1010             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1011             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1012             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1013             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1014             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1015             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1016             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1017             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1018             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1019             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1020             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1021             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1022             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1023             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1024             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1025             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1026             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1027             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1028             };
1029         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1030         waitbar(3/7,hwait)
1031         
1032         <span class="comment">% Save DAV data to an Excel File</span>
1033         vmin = num2str(guiparams.depth_range_min);
1034         vmax = num2str(guiparams.depth_range_max);
1035         pvheaders = {<span class="keyword">...</span>
1036             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1037             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1038             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1039             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1040             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1041             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1042         
1043         <span class="comment">% Create block style matrix of all processed data</span>
1044         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1045         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1046         <span class="comment">% layer-averaging applied</span>
1047         pvdata = [];
1048         
1049         <span class="comment">% Stationing from LEFT bank</span>
1050         Dist = V.mcsDist;
1051         
1052         <span class="comment">% Build bathy data matrix</span>
1053         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1054         
1055         <span class="comment">% Build layer-averaged velocities</span>
1056         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1057         V.mcsX(indx,:) = nan;
1058         V.mcsY(indx,:) = nan;
1059         V.mcsEast(indx,:) = nan;
1060         V.mcsNorth(indx,:) = nan;
1061         pvdata = [<span class="keyword">...</span>
1062             pvdata;<span class="keyword">...</span>
1063             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1064             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1065             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1066             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1067         pvdata(isnan(pvdata)) = -9999;
1068         pvout = num2cell(pvdata');
1069         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1070         timestr = nandatestr(V.mcsTime(1,:));
1071         timestamp = cellstr(timestr);
1072         pvout = horzcat(timestamp,pvout);
1073         pvout = vertcat(pvheaders,pvout);
1074         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1075         waitbar(4/7,hwait)
1076         
1077         <span class="comment">% Save MCS data to an Excel File</span>
1078         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1079         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1080         MCSheaders = {<span class="keyword">...</span>
1081             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1082             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1083             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1084             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1085             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1086             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1087             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1088             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1089             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1090             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1091             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1092             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1093             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1094             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1095             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1096             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1097             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1098         
1099         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1100         MCSdata = [<span class="keyword">...</span>
1101             V.mcsX(:)<span class="keyword">...</span>
1102             V.mcsY(:)<span class="keyword">...</span>
1103             V.mcsDist(:)<span class="keyword">...</span>
1104             vectorized_bed(:)<span class="keyword">...</span>
1105             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1106             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1107             V.mcsEast(:)<span class="keyword">...</span>
1108             V.mcsNorth(:)<span class="keyword">...</span>
1109             V.mcsVert(:)<span class="keyword">...</span>
1110             V.mcsMag(:)<span class="keyword">...</span>
1111             V.mcsDir(:)<span class="keyword">...</span>
1112             V.u(:)<span class="keyword">...</span>
1113             V.v(:)<span class="keyword">...</span>
1114             V.vp(:)<span class="keyword">...</span>
1115             V.vs(:)<span class="keyword">...</span>
1116             V.Roz.up(:)<span class="keyword">...</span>
1117             V.Roz.us(:)];
1118         MCSdata(isnan(MCSdata)) = -9999;
1119         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1120         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1121         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1122         waitbar(5/7,hwait)
1123                 
1124         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1125         <span class="comment">% results</span>
1126         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1127         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1128         PVheaders = {<span class="keyword">...</span>
1129             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1130             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1131             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1132             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1133             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1134             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1135             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1136             <span class="string">'Vel_dir_deg'</span>};
1137         PVtable = [<span class="keyword">...</span>
1138             PVdata.outmat(1,:);<span class="keyword">...</span>
1139             PVdata.outmat(2,:);<span class="keyword">...</span>
1140             PVDist;<span class="keyword">...</span>
1141             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1142             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1143             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1144             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1145         PVtable = (sortrows(PVtable',3))';
1146         PVtable(isnan(PVtable)) = -9999;
1147         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1148         PVout = vertcat(PVheaders,PVout);
1149         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1150         waitbar(6/7,hwait)
1151         
1152         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1153         <span class="comment">% results</span>
1154         <span class="comment">% Distance is from the LEFT bank</span>
1155         <span class="comment">% Doesn't include the reference vector</span>
1156         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1157         dist    = guiparams.mcsQuivers(1:end-1,1);
1158         depth   = guiparams.mcsQuivers(1:end-1,2);
1159         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1160         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1161         
1162         <span class="comment">% Compute an UTM coordinate for the vector</span>
1163         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1164         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1165         
1166         <span class="comment">% Compute a Time for each vector</span>
1167         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1168         
1169         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1170         <span class="keyword">switch</span> guiparams.contour
1171             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1172                 wtp=[<span class="string">'V.uSmooth'</span>];
1173             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1174                 wtp=[<span class="string">'V.vSmooth'</span>];
1175             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1176                 wtp=[<span class="string">'V.wSmooth'</span>];
1177             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1178                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1179             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1180                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1181             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1182                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1183             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1184                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1185             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1186                 wtp=[<span class="string">'V.vpSmooth'</span>];
1187             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1188                 wtp=[<span class="string">'V.vsSmooth'</span>];
1189             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1190                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1191             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1192                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1193             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1194                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1195             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1196                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1197             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1198                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1199             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1200                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1201             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1202                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1203             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1204                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1205             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1206                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1207             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1208                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1209             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1210                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1211         <span class="keyword">end</span>
1212         Ucomp = eval(wtp);
1213         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1214         
1215         <span class="comment">% Save MCS data to an Excel File</span>
1216         <span class="comment">% This includes the smoothed data results from the plots.</span>
1217         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1218         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1219         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1220         mcsheaders = {<span class="keyword">...</span>
1221             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1222             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1223             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1224             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1225             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1226             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1227             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1228             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1229             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1230             };
1231         mcsdata = [<span class="keyword">...</span>
1232             pUTMx(:)<span class="keyword">...</span>
1233             pUTMy(:)<span class="keyword">...</span>
1234             dist(:)<span class="keyword">...</span>
1235             depth(:)<span class="keyword">...</span>
1236             ucomp(:)<span class="keyword">...</span>
1237             vcomp(:)<span class="keyword">...</span>
1238             wcomp(:)];
1239         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1240         ridx = ~isnan(ucomp);
1241         mcsdata = mcsdata(ridx,:);
1242         mcsdata(isnan(mcsdata)) = -9999;
1243         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1244         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1245         waitbar(7/7,hwait)
1246     <span class="keyword">else</span>
1247         <span class="comment">% Return default excel_path and excel_file</span>
1248         excel_path = guiprefs.excel_path;
1249         excel_file = guiprefs.excel_file;
1250         outfile = fullfile(excel_path,excel_file);
1251         log_text = {<span class="string">'User aborted Excel export...'</span>};
1252     <span class="keyword">end</span>
1253     
1254     
1255 waitbar(1,hwait)  
1256 delete(hwait)
1257 <span class="keyword">end</span>
1258 
1259 <span class="comment">% Push messages to Log Window:</span>
1260 <span class="comment">% ----------------------------</span>
1261 statusLogging(handles.LogWindow, log_text)
1262 
1263 <span class="comment">% Store the persistent preferences:</span>
1264 <span class="comment">% ---------------------------------</span>
1265 guiprefs.excel_file = excel_file;
1266 guiprefs.excel_path = excel_path;
1267 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1268 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1269 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1270 
1271 
1272 <span class="comment">% --------------------------------------------------------------------</span>
1273 <a name="_sub27" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1274 <span class="comment">% Call separate GUI</span>
1275 VMT_BuildCustomFlatFile;
1276 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1277 
1278 <span class="comment">% --------------------------------------------------------------------</span>
1279 <a name="_sub28" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1280 <span class="comment">% Empty</span>
1281 
1282 <span class="comment">% --------------------------------------------------------------------</span>
1283 <a name="_sub29" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1284 <span class="comment">% Empty</span>
1285 
1286 <span class="comment">% --------------------------------------------------------------------</span>
1287 <a name="_sub30" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1288 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1289 
1290 <span class="comment">% Get the Application Data:</span>
1291 <span class="comment">% -------------------------</span>
1292 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1293 
1294 <span class="comment">% Update the GUI &amp; Application Data:</span>
1295 <span class="comment">% ----------------------------------</span>
1296 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1297 <span class="keyword">switch</span> status
1298     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1299         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1300         guiparams.unit_discharge_correction = false;
1301     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1302         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1303         guiparams.unit_discharge_correction = true;
1304 <span class="keyword">end</span>
1305 
1306 <span class="comment">% Re-store the Application data:</span>
1307 <span class="comment">% ------------------------------</span>
1308 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1309 
1310 
1311 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1312 
1313 <span class="comment">% --------------------------------------------------------------------</span>
1314 <a name="_sub31" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1315 <span class="comment">% Empty</span>
1316 
1317 <span class="comment">% --------------------------------------------------------------------</span>
1318 <a name="_sub32" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1319 <span class="comment">% Empty</span>
1320 
1321 <span class="comment">% --------------------------------------------------------------------</span>
1322 <a name="_sub33" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1323 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1324 
1325 <span class="comment">% Get the Application Data:</span>
1326 <span class="comment">% -------------------------</span>
1327 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1328 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1329 
1330 <span class="comment">% Update the Application Data:</span>
1331 <span class="comment">% ----------------------------</span>
1332 guiparams.english_units = false;
1333 guiprefs.units = <span class="string">'metric'</span>;
1334 
1335 <span class="comment">% Re-store the Application data:</span>
1336 <span class="comment">% ------------------------------</span>
1337 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1338 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1339 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1340 
1341 <span class="comment">% Update the GUI:</span>
1342 <span class="comment">% ---------------</span>
1343 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1344 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1345 
1346 <span class="comment">% [EOF] menuMetric_Callback</span>
1347 
1348 
1349 <span class="comment">% --------------------------------------------------------------------</span>
1350 <a name="_sub34" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1351 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1352 
1353 <span class="comment">% Get the Application Data:</span>
1354 <span class="comment">% -------------------------</span>
1355 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1356 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1357 
1358 <span class="comment">% Update the Application Data:</span>
1359 <span class="comment">% ----------------------------</span>
1360 guiparams.english_units = true;
1361 guiprefs.units = <span class="string">'english'</span>;
1362 
1363 <span class="comment">% Re-store the Application data:</span>
1364 <span class="comment">% ------------------------------</span>
1365 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1366 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1367 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1368 
1369 <span class="comment">% Update the GUI:</span>
1370 <span class="comment">% ---------------</span>
1371 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1372 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1373 
1374 <span class="comment">% [EOF] menuEnglish_Callback</span>
1375 
1376 <span class="comment">% --------------------------------------------------------------------</span>
1377 <a name="_sub35" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1378 <span class="comment">% Empty</span>
1379 
1380 <span class="comment">% --------------------------------------------------------------------</span>
1381 <a name="_sub36" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1382 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1383 <span class="comment">% surface)</span>
1384 
1385 <span class="comment">% Get the Application Data:</span>
1386 <span class="comment">% -------------------------</span>
1387 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1388 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1389 
1390 <span class="comment">% Update the Application Data:</span>
1391 <span class="comment">% ----------------------------</span>
1392 guiparams.plotref = <span class="string">'dfs'</span>;
1393 guiprefs.plotref  = <span class="string">'dfs'</span>;
1394 
1395 <span class="comment">% Re-store the Application data:</span>
1396 <span class="comment">% ------------------------------</span>
1397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1398 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1399 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1400 
1401 <span class="comment">% Update the GUI:</span>
1402 <span class="comment">% ---------------</span>
1403 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1404 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1405 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1406 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1407 
1408 <span class="comment">% --------------------------------------------------------------------</span>
1409 <a name="_sub37" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1410 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1411 
1412 <span class="comment">% Get the Application Data:</span>
1413 <span class="comment">% -------------------------</span>
1414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1416 
1417 <span class="comment">% Update the Application Data:</span>
1418 <span class="comment">% ----------------------------</span>
1419 guiparams.plotref = <span class="string">'hab'</span>;
1420 guiprefs.plotref  = <span class="string">'hab'</span>;
1421 
1422 <span class="comment">% % Prompt and set eta</span>
1423 <span class="comment">% % ------------------</span>
1424 <span class="comment">% prompt = 'Enter elevation of the bottom (eta), in meters:';</span>
1425 <span class="comment">% dlg_title = 'Set bottom elevation for height above bottom reference';</span>
1426 <span class="comment">% num_lines = 1;</span>
1427 <span class="comment">% def = {num2str(guiparams.eta)};</span>
1428 <span class="comment">% guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));</span>
1429 
1430 
1431 <span class="comment">% Re-store the Application data:</span>
1432 <span class="comment">% ------------------------------</span>
1433 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1434 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1435 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1436 
1437 <span class="comment">% Update the GUI:</span>
1438 <span class="comment">% ---------------</span>
1439 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1440 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1441 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1442 
1443 
1444 
1445 
1446 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1447 
1448 <span class="comment">% --------------------------------------------------------------------</span>
1449 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1450 <span class="comment">% Empty</span>
1451 
1452 <span class="comment">% --------------------------------------------------------------------</span>
1453 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1454 <span class="comment">% Set cross-section endpoints automatically</span>
1455 
1456 <span class="comment">% Get the Application Data:</span>
1457 <span class="comment">% -------------------------</span>
1458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1459 
1460 <span class="comment">% Update the Application Data:</span>
1461 <span class="comment">% ----------------------------</span>
1462 guiparams.set_cross_section_endpoints = false;
1463 
1464 <span class="comment">% Re-store the Application data:</span>
1465 <span class="comment">% ------------------------------</span>
1466 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1467 
1468 <span class="comment">% Update the GUI:</span>
1469 <span class="comment">% ---------------</span>
1470 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1471 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1472 
1473 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1474 
1475 
1476 <span class="comment">% --------------------------------------------------------------------</span>
1477 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1478 <span class="comment">% Set cross-section endpoints manually</span>
1479 
1480 <span class="comment">% Get the Application Data:</span>
1481 <span class="comment">% -------------------------</span>
1482 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1483 
1484 <span class="comment">% Update the Application Data:</span>
1485 <span class="comment">% ----------------------------</span>
1486 guiparams.set_cross_section_endpoints = true;
1487 
1488 <span class="comment">% Re-store the Application data:</span>
1489 <span class="comment">% ------------------------------</span>
1490 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1491 
1492 <span class="comment">% Update the GUI:</span>
1493 <span class="comment">% ---------------</span>
1494 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1495 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1496 
1497 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1498 
1499 
1500 
1501 
1502 <span class="comment">% --------------------------------------------------------------------</span>
1503 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1504 <span class="comment">% Empty</span>
1505 
1506 <span class="comment">% --------------------------------------------------------------------</span>
1507 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1508 
1509 <span class="comment">% Get the Application Data:</span>
1510 <span class="comment">% -------------------------</span>
1511 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1512 
1513 <span class="comment">% Update the Application Data:</span>
1514 <span class="comment">% ----------------------------</span>
1515 guiparams.print        = true;
1516 guiparams.presentation = false;
1517 
1518 <span class="comment">% Re-store the Application data:</span>
1519 <span class="comment">% ------------------------------</span>
1520 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1521 
1522 <span class="comment">% Update the GUI:</span>
1523 <span class="comment">% ---------------</span>
1524 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1525 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1526 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1527 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1528 
1529 <span class="comment">% Modify the existing figures</span>
1530 <span class="comment">% ---------------------------</span>
1531 <span class="comment">% Find what plots exist already</span>
1532 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1533 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1534 
1535 <span class="comment">% Defaults for Print Stlye Figure</span>
1536 BkgdColor   = <span class="string">'white'</span>;
1537 AxColor     = <span class="string">'black'</span>;
1538 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1539 FntSize     = 14;
1540 
1541 <span class="comment">% Loop through valid figures and adjust</span>
1542 <span class="comment">% -------------------------------------</span>
1543 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1544     
1545     <span class="keyword">for</span> i = 1:length(valid_names)
1546         <span class="keyword">switch</span> valid_names{i}
1547             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1548                 <span class="comment">% Focus the figure</span>
1549                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1550                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1551                     figure(hff)
1552                     
1553                     <span class="comment">% Make the changes to figure</span>
1554                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1555                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1556                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1557                     set(gca,<span class="string">'Color'</span>,FigColor)
1558                     set(gca,<span class="string">'XColor'</span>,AxColor)
1559                     set(gca,<span class="string">'YColor'</span>,AxColor)
1560                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1561                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1562                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1563                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1564                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1565                         <span class="string">'YColor'</span>,AxColor);
1566                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1567                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1568                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1569                     
1570                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1571                     <span class="comment">% the file(s) and path for the data</span>
1572                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1573                     <span class="keyword">if</span> ~ismultiplot
1574                         filestr = guiparams.savefile;
1575                         wd = length(filestr);
1576                         hd = 1;
1577                     <span class="keyword">else</span>
1578                         <span class="comment">% Construct a filename</span>
1579                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1580                         wd        = max(cellfun(@length,filestr));
1581                         hd        = numel(filestr);
1582                             
1583                     <span class="keyword">end</span>
1584                     
1585                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1586                     disableMenuBar(hff)
1587                     set(fileinfotxt,<span class="keyword">...</span>
1588                         <span class="string">'string'</span>,filestr)
1589                     set(fileinfotxt,<span class="keyword">...</span>
1590                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1591                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1592                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1593                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1594                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1595                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1596                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1597                     
1598                 <span class="keyword">end</span>
1599             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1600                 <span class="comment">% Focus the figure</span>
1601                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1602                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1603                     figure(hff)
1604                     
1605                     <span class="comment">% Make the changes to figure</span>
1606                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1607                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1608                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1609                     set(gca,<span class="string">'Color'</span>,FigColor)
1610                     set(gca,<span class="string">'XColor'</span>,AxColor)
1611                     set(gca,<span class="string">'YColor'</span>,AxColor)
1612                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1613                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1614                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1615                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1616                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1617                         <span class="string">'YColor'</span>,AxColor);
1618                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1619                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1620                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1621                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1622                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1623                     
1624                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1625                     <span class="comment">% the file(s) and path for the data</span>
1626                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1627                     <span class="keyword">if</span> ~ismultiplot
1628                         filestr = guiparams.savefile;
1629                         wd = length(filestr);
1630                         hd = 1;
1631                     <span class="keyword">else</span>
1632                         <span class="comment">% Construct a filename</span>
1633                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1634                         wd        = max(cellfun(@length,filestr));
1635                         hd        = numel(filestr);
1636                             
1637                     <span class="keyword">end</span>
1638                     
1639                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1640                     disableMenuBar(hff)
1641                     set(fileinfotxt,<span class="keyword">...</span>
1642                         <span class="string">'string'</span>,filestr)
1643                     set(fileinfotxt,<span class="keyword">...</span>
1644                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1645                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1646                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1647                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1648                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1649                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1650                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1651                 <span class="keyword">end</span>
1652             <span class="keyword">otherwise</span>
1653         <span class="keyword">end</span>
1654     <span class="keyword">end</span>
1655     
1656     
1657 <span class="keyword">end</span>
1658 
1659 
1660 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1661 
1662 
1663 <span class="comment">% --------------------------------------------------------------------</span>
1664 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1665 <span class="comment">% Get the Application Data:</span>
1666 <span class="comment">% -------------------------</span>
1667 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1668 
1669 <span class="comment">% Update the Application Data:</span>
1670 <span class="comment">% ----------------------------</span>
1671 guiparams.print        = false;
1672 guiparams.presentation = true;
1673 
1674 <span class="comment">% Re-store the Application data:</span>
1675 <span class="comment">% ------------------------------</span>
1676 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1677 
1678 <span class="comment">% Update the GUI:</span>
1679 <span class="comment">% ---------------</span>
1680 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1681 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1682 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1683 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1684 
1685 <span class="comment">% Modify the existing figures</span>
1686 <span class="comment">% ---------------------------</span>
1687 <span class="comment">% Find what plots exist already</span>
1688 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1689 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1690 
1691 <span class="comment">% Defaults for Presentation Style Figure</span>
1692 <span class="comment">% --------------------------------------</span>
1693 BkgdColor   = <span class="string">'black'</span>;
1694 AxColor     = <span class="string">'white'</span>;
1695 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1696 FntSize     = 14;
1697 
1698 <span class="comment">% Loop through valid figures and adjust</span>
1699 <span class="comment">% -------------------------------------</span>
1700 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1701     
1702     <span class="keyword">for</span> i = 1:length(valid_names)
1703         <span class="keyword">switch</span> valid_names{i}
1704             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1705                 <span class="comment">% Focus the figure</span>
1706                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1707                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1708                     figure(hff)
1709                     
1710                     <span class="comment">% Make the changes to figure</span>
1711                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1712                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1713                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1714                     set(gca,<span class="string">'Color'</span>,FigColor)
1715                     set(gca,<span class="string">'XColor'</span>,AxColor)
1716                     set(gca,<span class="string">'YColor'</span>,AxColor)
1717                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1718                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1719                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1720                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1721                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1722                         <span class="string">'YColor'</span>,AxColor);
1723                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1724                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1725                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1726                     
1727                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1728                     <span class="comment">% the file(s) and path for the data</span>
1729                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1730                     <span class="keyword">if</span> ~ismultiplot
1731                         filestr = guiparams.savefile;
1732                         wd = length(filestr);
1733                         hd = 1;
1734                     <span class="keyword">else</span>
1735                         <span class="comment">% Construct a filename</span>
1736                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1737                         wd        = max(cellfun(@length,filestr));
1738                         hd        = numel(filestr);
1739                             
1740                     <span class="keyword">end</span>
1741                     
1742                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1743                     disableMenuBar(hff)
1744                     set(fileinfotxt,<span class="keyword">...</span>
1745                         <span class="string">'string'</span>,filestr)
1746                     set(fileinfotxt,<span class="keyword">...</span>
1747                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1748                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1749                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1750                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1751                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1752                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1753                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1754                     
1755                 <span class="keyword">end</span>
1756             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1757                 <span class="comment">% Focus the figure</span>
1758                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1759                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1760                     figure(hff)
1761                     
1762                     <span class="comment">% Make the changes to figure</span>
1763                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1764                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1765                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1766                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1767                     set(gca,<span class="string">'XColor'</span>,AxColor)
1768                     set(gca,<span class="string">'YColor'</span>,AxColor)
1769                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1770                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1771                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1772                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1773                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1774                         <span class="string">'YColor'</span>,AxColor);
1775                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1776                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1777                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1778                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1779                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1780                     
1781                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1782                     <span class="comment">% the file(s) and path for the data</span>
1783                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1784                     <span class="keyword">if</span> ~ismultiplot
1785                         filestr = guiparams.savefile;
1786                         wd = length(filestr);
1787                         hd = 1;
1788                     <span class="keyword">else</span>
1789                         <span class="comment">% Construct a filename</span>
1790                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1791                         wd        = max(cellfun(@length,filestr));
1792                         hd        = numel(filestr);
1793                             
1794                     <span class="keyword">end</span>
1795                     
1796                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1797                     disableMenuBar(hff)
1798                     set(fileinfotxt,<span class="keyword">...</span>
1799                         <span class="string">'string'</span>,filestr)
1800                     set(fileinfotxt,<span class="keyword">...</span>
1801                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1802                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1803                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1804                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1805                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1806                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1807                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1808                 <span class="keyword">end</span>
1809             <span class="keyword">otherwise</span>
1810         <span class="keyword">end</span>
1811     <span class="keyword">end</span>
1812     
1813     
1814 <span class="keyword">end</span>
1815 
1816 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1817 
1818 <span class="comment">% --------------------------------------------------------------------</span>
1819 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1820 <span class="comment">%</span>
1821 <span class="comment">% % Get the Application data:</span>
1822 <span class="comment">% % -------------------------</span>
1823 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1824 <span class="comment">%</span>
1825 <span class="comment">% % Initialize the answer:</span>
1826 <span class="comment">% % ----------------------</span>
1827 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1828 <span class="comment">% answer = NaN;</span>
1829 <span class="comment">% while isnan(answer)</span>
1830 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1831 <span class="comment">%</span>
1832 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1833 <span class="comment">%         return</span>
1834 <span class="comment">%     end</span>
1835 <span class="comment">%</span>
1836 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1837 <span class="comment">%     % A numeric char will be a double</span>
1838 <span class="comment">% end</span>
1839 <span class="comment">%</span>
1840 <span class="comment">% % Re-store the Application data:</span>
1841 <span class="comment">% % ------------------------------</span>
1842 <span class="comment">% guiparams.vertical_offset = answer;</span>
1843 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1844 <span class="comment">%</span>
1845 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1846 
1847 <span class="comment">% --------------------------------------------------------------------</span>
1848 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1849 <span class="comment">% Not implemented</span>
1850 
1851 <span class="comment">% --------------------------------------------------------------------</span>
1852 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1853 <span class="comment">% Empty</span>
1854 
1855 <span class="comment">% --------------------------------------------------------------------</span>
1856 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1857 ASCII2GIS_GUI
1858 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1859 
1860 <span class="comment">% --------------------------------------------------------------------</span>
1861 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1862 
1863 <span class="comment">% Get the Application preferences:</span>
1864 <span class="comment">% --------------------------------</span>
1865 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1866 
1867 inpath = guiprefs.kmz_path;
1868 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1869     infile = guiprefs.kmz_file{1};
1870 <span class="keyword">else</span>
1871     infile = guiprefs.kmz_file;
1872 <span class="keyword">end</span>
1873 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1874 
1875 guiprefs.kmz_path = outpath;
1876 guiprefs.kmz_file = outfile;
1877 
1878 <span class="comment">% Update persistent preferences</span>
1879 <span class="comment">% -----------------------------</span>
1880 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1881 
1882 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1883 
1884 <span class="comment">% --------------------------------------------------------------------</span>
1885 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1886 <span class="comment">% Get the Application preferences:</span>
1887 <span class="comment">% --------------------------------</span>
1888 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1889 
1890 VMT_BatchMode;
1891 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1892 
1893 <span class="comment">% --------------------------------------------------------------------</span>
1894 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1895 <span class="comment">% Empty</span>
1896 
1897 <span class="comment">% --------------------------------------------------------------------</span>
1898 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1900 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1901     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1902     
1903 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1904     
1905     <span class="keyword">if</span> isdeployed
1906         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1907             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1908         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1909             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1910             errLogFileName},<span class="keyword">...</span>
1911             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1912             <span class="string">'error'</span>);
1913         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1914         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1915         fclose(fid);
1916         rethrow(err)
1917     <span class="keyword">else</span>
1918         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1919             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1920             <span class="string">'error'</span>);
1921         rethrow(err);
1922     <span class="keyword">end</span>
1923 <span class="keyword">end</span>
1924 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1925 
1926 <span class="comment">% --------------------------------------------------------------------</span>
1927 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1928 <span class="comment">% Get the Application data:</span>
1929 <span class="comment">% -------------------------</span>
1930 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1931 
1932 <span class="keyword">try</span>
1933     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1934 
1935 
1936 <span class="comment">% This catch is probably not necessary.</span>
1937 <span class="keyword">catch</span> err 
1938     <span class="keyword">if</span> isdeployed
1939         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1940             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1941         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1942             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1943             errLogFileName},<span class="keyword">...</span>
1944             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1945             <span class="string">'error'</span>);
1946         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1947         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1948         fclose(fid);
1949         rethrow(err)
1950     <span class="keyword">else</span>
1951         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1952             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1953             <span class="string">'error'</span>);
1954         rethrow(err);
1955     <span class="keyword">end</span>
1956 <span class="keyword">end</span>
1957 
1958 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1959 
1960 <span class="comment">% --------------------------------------------------------------------</span>
1961 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1962 
1963 <span class="comment">% Get the Application data:</span>
1964 <span class="comment">% -------------------------</span>
1965 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1966 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1967 
1968 <span class="comment">% Check version tag against the web, and display a message</span>
1969 <span class="keyword">try</span>
1970     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1971     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1972     <span class="keyword">if</span> length(webdata) &gt; 5
1973         current_vmt_version{1} = webdata(1:5);
1974         current_vmt_version{2} = webdata(8:16);
1975     <span class="keyword">else</span>
1976         current_vmt_version = webdata;
1977     <span class="keyword">end</span>
1978     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1979 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1980     <span class="keyword">if</span> isdeployed
1981         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1982             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1983         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1984             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1985             errLogFileName},<span class="keyword">...</span>
1986             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1987             <span class="string">'error'</span>);
1988         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1989         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1990         fclose(fid);
1991         rethrow(err)
1992     <span class="keyword">else</span>
1993         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1994             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1995             <span class="string">'error'</span>);
1996         rethrow(err);
1997     <span class="keyword">end</span>
1998 <span class="keyword">end</span>
1999 
2000 <span class="keyword">if</span> ischar(current_vmt_version)
2001     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2002         h = msgbox(<span class="keyword">...</span>
2003             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2004             <span class="string">''</span>;<span class="keyword">...</span>
2005             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2006             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2007     <span class="keyword">else</span>
2008         h = msgbox(<span class="keyword">...</span>
2009             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2010             <span class="string">''</span>;<span class="keyword">...</span>
2011             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2012             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2013     <span class="keyword">end</span>
2014 <span class="keyword">elseif</span> iscell(current_vmt_version)
2015     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2016         h = msgbox(<span class="keyword">...</span>
2017             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2018             <span class="string">''</span>;<span class="keyword">...</span>
2019             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2020             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2021     <span class="keyword">else</span>
2022         h = msgbox(<span class="keyword">...</span>
2023             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2024             <span class="string">''</span>;<span class="keyword">...</span>
2025             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2026             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2027     <span class="keyword">end</span>
2028 <span class="keyword">end</span>
2029 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2030 
2031 <span class="comment">% --------------------------------------------------------------------</span>
2032 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2033 
2034 <span class="comment">% Get the Application data:</span>
2035 <span class="comment">% -------------------------</span>
2036 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2037 messagestr = <span class="keyword">...</span>
2038     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2039     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2040     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2041     <span class="string">''</span>;<span class="keyword">...</span>
2042     <span class="string">''</span>;<span class="keyword">...</span>
2043     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2044     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2045     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2046     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2047     <span class="string">''</span>;<span class="keyword">...</span>
2048     <span class="string">''</span>;<span class="keyword">...</span>
2049     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2050     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2051     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2052     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2053     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2054     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2055     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2056 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2057 <span class="comment">% [EOF] menuAbout_Callback</span>
2058 
2059 
2060 
2061 
2062 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2063 <span class="comment">% TOOLBAR CALLBACKS %</span>
2064 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2065 
2066 <span class="comment">% --------------------------------------------------------------------</span>
2067 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2068 <span class="comment">% Read Files into Data Structure using tfile.</span>
2069 
2070 <span class="comment">% Get the Application data:</span>
2071 <span class="comment">% -------------------------</span>
2072 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2073 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2074 
2075 <span class="comment">% Ask the user to select files:</span>
2076 <span class="comment">% -----------------------------</span>
2077 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2078 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2079     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2080     current_file, <span class="keyword">...</span>
2081     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2082 
2083 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2084     guiparams.data_folder = pathname;
2085     <span class="keyword">if</span> ischar(filename)
2086         filename = {filename};
2087     <span class="keyword">end</span>
2088     guiparams.data_files = filename;
2089     guiparams.mat_file = <span class="string">''</span>;
2090     
2091     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2092     
2093    
2094     
2095     <span class="comment">% Update the preferences:</span>
2096     <span class="comment">% -----------------------</span>
2097     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2098     guiprefs.ascii_path = pathname;
2099     guiprefs.ascii_file = filename;
2100     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2101     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2102     
2103     <span class="comment">% Push messages to Log Window:</span>
2104     <span class="comment">% ----------------------------</span>
2105     log_text = {<span class="keyword">...</span>
2106         <span class="string">''</span>;<span class="keyword">...</span>
2107         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2108         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2109         guiparams.data_folder;
2110         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2111         char(filename)};
2112     statusLogging(handles.LogWindow, log_text)
2113     
2114     <span class="comment">% Read the file(s)</span>
2115     <span class="comment">% ----------------</span>
2116     [~,~,savefile,A,z] = <span class="keyword">...</span>
2117         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2118     guiparams.savefile = savefile;
2119     guiparams.A        = A;
2120     guiparams.z        = z;
2121     
2122     
2123     <span class="comment">% Set the vertical grid node spacing</span>
2124     <span class="comment">% ----------------------------------</span>
2125     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2126     <span class="comment">% Backwards compatible</span>
2127     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2128         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2129         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2130     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2131         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2132         guiparams.vertical_grid_node_spacing = 0.4;
2133     <span class="keyword">end</span>
2134     
2135     
2136     <span class="comment">% Save application data</span>
2137     <span class="comment">% ---------------------</span>
2138     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2139        
2140 <span class="comment">%</span>
2141 <span class="comment">%     % Preprocess the data:</span>
2142 <span class="comment">%     % --------------------</span>
2143 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2144 <span class="comment">%</span>
2145 <span class="comment">%     % Push messages to Log Window:</span>
2146 <span class="comment">%     % ----------------------------</span>
2147 <span class="comment">%     log_text = {...</span>
2148 <span class="comment">%         '   Preprocessing complete.';...</span>
2149 <span class="comment">%         '   Begin Data Processing...'};</span>
2150 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2151 <span class="comment">%</span>
2152 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2153 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2154 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2155 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2156 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2157 <span class="comment">%</span>
2158 <span class="comment">%     % Push messages to Log Window:</span>
2159 <span class="comment">%     % ----------------------------</span>
2160 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2161 <span class="comment">%</span>
2162 <span class="comment">%     % Store the data:</span>
2163 <span class="comment">%     % ---------------</span>
2164 <span class="comment">%     guiparams.z = z;</span>
2165 <span class="comment">%     guiparams.A = A;</span>
2166 <span class="comment">%     guiparams.V = V;</span>
2167 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2168     
2169           
2170     <span class="comment">% Update the GUI:</span>
2171     <span class="comment">% ---------------</span>
2172     <a href="#_sub101" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2173     
2174     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2175     
2176 <span class="keyword">end</span>
2177 <span class="comment">% [EOF] loadDataCallback</span>
2178 
2179 
2180 
2181 <span class="comment">% --------------------------------------------------------------------</span>
2182 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2183 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2184 
2185 <span class="comment">% Get the Application data:</span>
2186 <span class="comment">% -------------------------</span>
2187 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2188 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2189 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2190 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2191 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2192 
2193 [the_file,the_path] = <span class="keyword">...</span>
2194     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2195     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2196     fullfile(guiparams.mat_path,guiparams.savefile));
2197 
2198 <span class="comment">% Save the processed data to a MAT file:</span>
2199 <span class="comment">% --------------------------------------</span>
2200 <span class="keyword">if</span> ischar(the_file)
2201     guiparams.mat_path = the_path;
2202     guiparams.mat_file = the_file;
2203     guiparams.savefile = the_file;
2204     
2205     <span class="comment">% Re-store the Application data:</span>
2206     <span class="comment">% ------------------------------</span>
2207     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2208     
2209     <span class="comment">% Update the preferences:</span>
2210     <span class="comment">% -----------------------</span>
2211     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2212     guiprefs.mat_path = the_path;
2213     guiprefs.mat_file = the_file;
2214     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2215     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2216     
2217     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2218     savefile = fullfile(pathstr,[filename extension]);
2219     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2220     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2221     log_text = {<span class="keyword">...</span>
2222         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2223         savefile};
2224     statusLogging(handles.LogWindow,log_text)
2225     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2226 <span class="keyword">end</span>
2227 
2228 <span class="comment">% [EOF] saveDataCallback</span>
2229 
2230 
2231 <span class="comment">% --------------------------------------------------------------------</span>
2232 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2233 
2234 <span class="comment">% Get the Application data:</span>
2235 <span class="comment">% -------------------------</span>
2236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2237 z   = guiparams.z;
2238 A   = guiparams.A;
2239 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2240 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2241 
2242 <span class="comment">% Compute multibeam bathymetry:</span>
2243 <span class="comment">% -----------------------------</span>
2244 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2245 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2246 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2247     guiparams.beam_angle, <span class="keyword">...</span>
2248     guiparams.magnetic_variation, <span class="keyword">...</span>
2249     guiparams.water_surface_elevation, <span class="keyword">...</span>
2250     guiparams.output_auxiliary_data);
2251 
2252 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2253 
2254 <span class="comment">% [EOF] saveBathymetryCallback</span>
2255 
2256 <span class="comment">% --------------------------------------------------------------------</span>
2257 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2258 
2259 <span class="comment">% Get the Application data:</span>
2260 <span class="comment">% -------------------------</span>
2261 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2262 
2263 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2264     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2265     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2266     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2267     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2268     handles.figure1);
2269 
2270 <span class="comment">% Update the GUI:</span>
2271 <span class="comment">% ---------------</span>
2272 <span class="keyword">if</span> guiparams.english_units
2273     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2274     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2275 <span class="keyword">else</span>
2276     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2277     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2278 <span class="keyword">end</span>
2279 
2280 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2281     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2282     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2283 <span class="keyword">else</span>
2284     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2285     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2286 <span class="keyword">end</span>
2287 
2288 <span class="keyword">if</span> guiparams.presentation
2289     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2290 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2291 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2292 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2293 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2294 <span class="keyword">else</span>
2295     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2296 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2297 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2298 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2299 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2300 <span class="keyword">end</span>
2301 
2302 <span class="comment">% Re-store the Application data:</span>
2303 <span class="comment">% ------------------------------</span>
2304 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2305 
2306 <span class="comment">% [EOF] plottingParametersCallback</span>
2307 
2308 
2309 <span class="comment">% --------------------------------------------------------------------</span>
2310 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2311 
2312 <span class="comment">% Get the Application data:</span>
2313 <span class="comment">% -------------------------</span>
2314 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2315 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2316 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2317 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2318 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2319 
2320 <span class="comment">% [EOF] processingParametersCallback</span>
2321 
2322 
2323 <span class="comment">% --------------------------------------------------------------------</span>
2324 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2325 <span class="comment">% Plot 1</span>
2326 
2327 <span class="comment">% Get the Application data:</span>
2328 <span class="comment">% -------------------------</span>
2329 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2330 z = guiparams.z;
2331 A = guiparams.A;
2332 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2333 <span class="comment">% Map = guiparams.Map;</span>
2334 
2335 
2336 <span class="comment">% Preprocess the data:</span>
2337 <span class="comment">% --------------------</span>
2338 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2339 
2340 <span class="comment">% Push messages to Log Window:</span>
2341 <span class="comment">% ----------------------------</span>
2342 log_text = {<span class="keyword">...</span>
2343     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2344     <span class="string">'   Begin Data Processing...'</span>};
2345 statusLogging(handles.LogWindow, log_text)
2346 
2347 <span class="comment">% Process the transects:</span>
2348 <span class="comment">% ----------------------</span>
2349 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2350 A(1).vgns = guiparams.vertical_grid_node_spacing;
2351 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2352 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2353     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2354 
2355 <span class="comment">% Compute the smoothed variables</span>
2356 <span class="comment">% ------------------------------</span>
2357 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2358 <span class="comment">% runtime.</span>
2359 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2360     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2361     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2362     guiparams.vertical_smoothing_window);
2363 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2364 
2365 <span class="comment">% Push messages to Log Window:</span>
2366 <span class="comment">% ----------------------------</span>
2367 statusLogging(handles.LogWindow, processing_log_text)
2368 
2369 <span class="comment">% Store the data:</span>
2370 <span class="comment">% ---------------</span>
2371 guiparams.z = z;
2372 guiparams.A = A;
2373 guiparams.V = V;
2374 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2375 
2376 <span class="comment">% Push messages to Log Window:</span>
2377 <span class="comment">% ----------------------------</span>
2378 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2379 statusLogging(handles.LogWindow, log_text)
2380 
2381 <span class="comment">% Create or replot the Shiptracks</span>
2382 <span class="comment">% -------------------------------</span>
2383 <span class="comment">% Grab the axes to the plot</span>
2384 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2385 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2386 
2387 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2388 <span class="comment">% New plot display window</span>
2389 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2390 <span class="comment">% h = figure(1); clf</span>
2391 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2392 
2393 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2394 
2395 
2396 <span class="comment">% --------------------------------------------------------------------</span>
2397 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2398 <span class="comment">% Plot 2</span>
2399 
2400 <span class="comment">% Get the Application data:</span>
2401 <span class="comment">% -------------------------</span>
2402 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2403 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2404 
2405 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2406     <span class="comment">% Push messages to Log Window:</span>
2407     <span class="comment">% ----------------------------</span>
2408     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2409     statusLogging(handles.LogWindow, log_text)
2410     
2411        
2412     <span class="comment">% Push plotting parameters to log window:</span>
2413     <span class="comment">% ---------------------------------------</span>
2414     log_text = {<span class="keyword">...</span>
2415         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2416         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2417         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2418         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2419         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2420         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2421         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2422         };
2423     statusLogging(handles.LogWindow, log_text)
2424     
2425     <span class="comment">% Plot the data:</span>
2426     <span class="comment">% --------------</span>
2427     z = [];
2428     A = [];
2429     V = [];
2430     Map = [];
2431     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2432     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2433         depth_range, <span class="keyword">...</span>
2434         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2435         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2436         guiparams.smoothing_window_size, <span class="keyword">...</span>
2437         guiparams.display_shoreline, <span class="keyword">...</span>
2438         guiparams.english_units, <span class="keyword">...</span>
2439         guiparams.mat_file, <span class="keyword">...</span>
2440         guiparams.mat_path, <span class="keyword">...</span>
2441         guiparams.plotref); <span class="comment">% PLOT2</span>
2442     statusLogging(handles.LogWindow, log_text)
2443     
2444     <span class="comment">% Plot a Shoreline Map:</span>
2445     <span class="comment">% ---------------------</span>
2446     <span class="keyword">if</span> guiparams.display_shoreline
2447         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2448             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2449             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2450             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2451         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2452             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2453             Map.UTMe   = mapdata(:,1);
2454             Map.UTMn   = mapdata(:,2);
2455             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2456             <span class="comment">%Map.UTMzone = zone;</span>
2457         <span class="keyword">else</span>
2458             Map = [];
2459         <span class="keyword">end</span>
2460         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2461         log_text = {<span class="keyword">...</span>
2462             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2463             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2464             };
2465         statusLogging(handles.LogWindow, log_text)
2466     <span class="keyword">else</span>
2467         Map = [];
2468     <span class="keyword">end</span>
2469     
2470 <span class="keyword">else</span>
2471     z = guiparams.z;
2472     A = guiparams.A;
2473     <span class="comment">% V = guiparams.V;</span>
2474     Map = guiparams.Map;
2475     
2476     <span class="comment">% Push messages to Log Window:</span>
2477     <span class="comment">% ----------------------------</span>
2478     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2479     statusLogging(handles.LogWindow, log_text)
2480     
2481         
2482     <span class="comment">% Preprocess the data:</span>
2483     <span class="comment">% --------------------</span>
2484     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2485     
2486     <span class="comment">% Process the transects:</span>
2487     <span class="comment">% ----------------------</span>
2488     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2489     A(1).vgns = guiparams.vertical_grid_node_spacing;
2490     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2491     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2492         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2493     
2494     <span class="comment">% Compute the smoothed variables</span>
2495     <span class="comment">% ------------------------------</span>
2496     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2497     <span class="comment">% runtime.</span>
2498     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2499         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2500         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2501         guiparams.vertical_smoothing_window);
2502     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2503     
2504     <span class="comment">% Push messages to Log Window:</span>
2505     <span class="comment">% ----------------------------</span>
2506     statusLogging(handles.LogWindow, processing_log_text)
2507     
2508     <span class="comment">% Plot the cross section:</span>
2509     <span class="comment">% -----------------------</span>
2510     log_text = {<span class="keyword">...</span>
2511         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2512         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2513         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2514         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2515         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2516         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2517         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2518         };
2519     statusLogging(handles.LogWindow, log_text)
2520     
2521     <span class="comment">% Plot the data:</span>
2522     <span class="comment">% --------------</span>
2523     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2524     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2525     
2526     
2527     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2528         depth_range, <span class="keyword">...</span>
2529         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2530         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2531         guiparams.smoothing_window_size, <span class="keyword">...</span>
2532         guiparams.display_shoreline, <span class="keyword">...</span>
2533         guiparams.english_units, <span class="keyword">...</span>
2534         guiparams.mat_file, <span class="keyword">...</span>
2535         guiparams.mat_path, <span class="keyword">...</span>
2536         guiparams.plotref); <span class="comment">% PLOT2</span>
2537     statusLogging(handles.LogWindow, log_text)
2538     
2539     <span class="comment">% Plot User Set Endpoints</span>
2540     <span class="comment">% -----------------------</span>
2541     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2542         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2543         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2544         x = data(:,1);
2545         y = data(:,2);
2546         
2547         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2548         figure(fh); hold on
2549         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2550         hold off
2551     <span class="keyword">end</span>
2552     
2553     <span class="comment">% Plot a Shoreline Map:</span>
2554     <span class="comment">% ---------------------</span>
2555     <span class="keyword">if</span> guiparams.display_shoreline
2556         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2557             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2558             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2559             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2560         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2561             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2562             Map.UTMe   = mapdata(:,1);
2563             Map.UTMn   = mapdata(:,2);
2564             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2565             <span class="comment">%Map.UTMzone = zone;</span>
2566         <span class="keyword">else</span>
2567             Map = [];
2568         <span class="keyword">end</span>
2569         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2570         log_text = {<span class="keyword">...</span>
2571             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2572             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2573             };
2574         statusLogging(handles.LogWindow, log_text)
2575     <span class="keyword">else</span>
2576         Map = [];
2577     <span class="keyword">end</span>
2578     
2579 <span class="keyword">end</span>
2580 
2581 <span class="keyword">if</span> guiparams.add_background
2582     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2583     statusLogging(handles.LogWindow, log_text)
2584 <span class="keyword">end</span>
2585 
2586 <span class="comment">% Update guiparams</span>
2587 <span class="comment">% ----------------</span>
2588 guiparams.z   = z;
2589 guiparams.A   = A;
2590 guiparams.V   = V;
2591 guiparams.Map = Map;
2592 guiparams.iric_anv_planview_data = PVdata;
2593 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2594 
2595 <span class="comment">% Update preferences</span>
2596 <span class="comment">% ------------------</span>
2597 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2598 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2599 <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2600 
2601 <span class="comment">% Force plot to be formated properly</span>
2602 <span class="comment">% ----------------------------------</span>
2603 <span class="keyword">if</span> guiparams.presentation
2604     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2605 <span class="keyword">else</span>
2606     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2607 <span class="keyword">end</span>
2608 <span class="keyword">switch</span> guiparams.renderer
2609     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2610         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2611     <span class="keyword">case</span> <span class="string">'painters'</span>
2612         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2613     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2614         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2615 <span class="keyword">end</span>
2616 
2617 <span class="comment">% Focus the figure</span>
2618 <span class="comment">% ----------------</span>
2619 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2620 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2621     figure(hff)
2622 <span class="keyword">end</span>
2623 
2624 <span class="comment">% Start the Graphics Control Gui</span>
2625 <span class="comment">% ------------------------------</span>
2626 VMT_GraphicsControl
2627 
2628 <span class="comment">% [EOF] planviewPlotCallback</span>
2629 
2630 
2631 <span class="comment">% --------------------------------------------------------------------</span>
2632 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2633 <span class="comment">% Plot 3</span>
2634 
2635 <span class="comment">% Get the Application data:</span>
2636 <span class="comment">% -------------------------</span>
2637 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2638 z = guiparams.z;
2639 A = guiparams.A;
2640 <span class="comment">% V = guiparams.V;</span>
2641 <span class="comment">% Map = guiparams.Map;</span>
2642 
2643 <span class="comment">% Preprocess the data:</span>
2644 <span class="comment">% --------------------</span>
2645 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2646 
2647 <span class="comment">% Push messages to Log Window:</span>
2648 <span class="comment">% ----------------------------</span>
2649 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2650 statusLogging(handles.LogWindow, log_text)
2651 
2652 <span class="comment">% Process the transects:</span>
2653 <span class="comment">% ----------------------</span>
2654 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2655 A(1).vgns = guiparams.vertical_grid_node_spacing;
2656 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2657 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2658     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2659 
2660 <span class="comment">% Push messages to Log Window:</span>
2661 <span class="comment">% ----------------------------</span>
2662 statusLogging(handles.LogWindow, processing_log_text)
2663 
2664 <span class="comment">% Plot the cross section:</span>
2665 <span class="comment">% -----------------------</span>
2666 log_text = {<span class="keyword">...</span>
2667     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2668     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2669     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2670     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2671     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2672     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2673     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2674     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2675     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2676     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2677     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2678     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2679     
2680     };
2681 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2682     log_text = vertcat(log_text, {<span class="keyword">...</span>
2683         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2684         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2685         });
2686 <span class="keyword">end</span>
2687 <span class="comment">% Push messages to Log Window:</span>
2688 <span class="comment">% ----------------------------</span>
2689 statusLogging(handles.LogWindow, log_text)
2690 
2691 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2692     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2693 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2694 <span class="comment">%         ...guiparams.contour, ...</span>
2695 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2696 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2697     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2698         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2699         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2700         guiparams.vertical_smoothing_window);
2701     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2702     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2703         guiparams.contour, <span class="keyword">...</span>
2704         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2705         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2706         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2707         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2708         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2709         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2710         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2711     
2712 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2713     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2714         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2715         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2716         guiparams.vertical_smoothing_window);
2717     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2718     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2719         guiparams.contour, <span class="keyword">...</span>
2720         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2721         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2722     
2723     guiparams.zmin = zmin;
2724     guiparams.zmax = zmax;
2725     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2726 <span class="keyword">end</span>
2727 
2728 <span class="comment">% Force plot to be formated properly</span>
2729 <span class="comment">% ----------------------------------</span>
2730 <span class="keyword">if</span> guiparams.presentation
2731     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2732 <span class="keyword">else</span>
2733     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2734 <span class="keyword">end</span>
2735 <span class="keyword">switch</span> guiparams.renderer
2736     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2737         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2738     <span class="keyword">case</span> <span class="string">'painters'</span>
2739         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2740     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2741         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2742 <span class="keyword">end</span>
2743 
2744 <span class="comment">% Focus the figure</span>
2745 <span class="comment">% ----------------</span>
2746 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2747 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2748     figure(hff)
2749 <span class="keyword">end</span>
2750 
2751 <span class="comment">% Re-store the Application data:</span>
2752 <span class="comment">% ------------------------------</span>
2753 guiparams.V = V;
2754 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2755 
2756 <span class="comment">% Start the Graphics Control Gui</span>
2757 <span class="comment">% ------------------------------</span>
2758 VMT_GraphicsControl
2759 
2760 <span class="comment">% Push messages to Log Window:</span>
2761 <span class="comment">% ----------------------------</span>
2762 statusLogging(handles.LogWindow, plot_cont_log_text)
2763 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2764 
2765 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2766 
2767 
2768 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2769 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2770 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2771 
2772 <span class="comment">% --------------------------------------------------------------------</span>
2773 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2774 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2775 
2776 <span class="comment">% Get the Application data:</span>
2777 <span class="comment">% -------------------------</span>
2778 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2779 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2780 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2781 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2782 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2783 
2784 [the_file,the_path] = <span class="keyword">...</span>
2785     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2786     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2787     fullfile(guiparams.mat_path,guiparams.savefile));
2788 
2789 <span class="comment">% Save the processed data to a MAT file:</span>
2790 <span class="comment">% --------------------------------------</span>
2791 <span class="keyword">if</span> ischar(the_file)
2792     guiparams.mat_path = the_path;
2793     guiparams.mat_file = the_file;
2794     guiparams.savefile = the_file;
2795     
2796     <span class="comment">% Re-store the Application data:</span>
2797     <span class="comment">% ------------------------------</span>
2798     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2799     
2800     <span class="comment">% Update the preferences:</span>
2801     <span class="comment">% -----------------------</span>
2802     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2803     guiprefs.mat_path = the_path;
2804     guiprefs.mat_file = the_file;
2805     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2806     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2807     
2808     [~,filename,extension] = fileparts(guiparams.savefile);
2809     savefile = [filename extension];
2810     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2811         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2812     disp(<span class="string">'Saving Processed Data File...'</span>)
2813     disp(savefile)
2814     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2815 <span class="keyword">end</span>
2816 
2817 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2818 
2819 
2820 <span class="comment">% --------------------------------------------------------------------</span>
2821 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2822 
2823 <span class="comment">% Get the Application data:</span>
2824 <span class="comment">% -------------------------</span>
2825 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2826 <span class="comment">% z   = guiparams.z;</span>
2827 <span class="comment">% A   = guiparams.A;</span>
2828 V   = guiparams.V;
2829 <span class="comment">% Map = guiparams.Map;</span>
2830 
2831 [the_file,the_path] = <span class="keyword">...</span>
2832     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2833     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2834     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2835 
2836 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2837 <span class="comment">% ------------------------------------------</span>
2838 <span class="keyword">if</span> ischar(the_file)
2839     guiparams.tecplot_path = the_path;
2840     guiparams.tecplot_file = the_file;
2841     
2842     <span class="comment">% Re-store the Application data:</span>
2843     <span class="comment">% ------------------------------</span>
2844     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2845     
2846     <span class="comment">% Update the preferences:</span>
2847     <span class="comment">% -----------------------</span>
2848     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2849     guiprefs.tecplot_path = the_path;
2850     guiprefs.tecplot_file = the_file;
2851     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2852     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2853     
2854     <span class="comment">% Push to log window</span>
2855     <span class="comment">% ------------------</span>
2856     log_text = {<span class="keyword">...</span>
2857         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2858         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2859         the_path;<span class="keyword">...</span>
2860         [<span class="string">'Filename: '</span> the_file]};
2861     statusLogging(handles.LogWindow,log_text)
2862         
2863     <span class="keyword">if</span> isempty(V)
2864         A = guiparams.A;
2865         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2866         A(1).vgns = guiparams.vertical_grid_node_spacing;
2867         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2868         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2869             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2870             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2871             guiparams.bed_elevation);
2872     <span class="keyword">end</span>
2873     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2874     
2875     <span class="comment">% Push to log window</span>
2876     <span class="comment">% ------------------</span>
2877     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2878     statusLogging(handles.LogWindow,log_text)
2879     
2880     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2881     
2882     <span class="comment">% Push to log window</span>
2883     <span class="comment">% ------------------</span>
2884     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2885     statusLogging(handles.LogWindow,log_text)
2886    
2887 <span class="keyword">end</span>
2888 
2889 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2890 
2891 
2892 <span class="comment">% --------------------------------------------------------------------</span>
2893 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2894 
2895 <span class="comment">% Get the Application data:</span>
2896 <span class="comment">% -------------------------</span>
2897 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2898 <span class="comment">% z   = guiparams.z;</span>
2899 A   = guiparams.A;
2900 V   = guiparams.V;
2901 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2902 
2903 [the_file,the_path] = <span class="keyword">...</span>
2904     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2905     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2906     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2907 
2908 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2909 <span class="comment">% -----------------------------------------------------</span>
2910 <span class="keyword">if</span> ischar(the_file)
2911     guiparams.kmz_path = the_path;
2912     guiparams.kmz_file = the_file;
2913     
2914     <span class="comment">% Re-store the Application data:</span>
2915     <span class="comment">% ------------------------------</span>
2916     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2917     
2918     <span class="comment">% Update the preferences:</span>
2919     <span class="comment">% -----------------------</span>
2920     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2921     guiprefs.kmz_path = the_path;
2922     guiprefs.kmz_file = the_file;
2923     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2924     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2925     
2926     <span class="comment">%     if guiparams.display_shoreline</span>
2927     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2928     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2929     <span class="comment">%                             guiparams.vertical_offset);</span>
2930     <span class="comment">%     end</span>
2931     <span class="keyword">if</span> isempty(V)
2932         A = guiparams.A;
2933         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2934         A(1).vgns = guiparams.vertical_grid_node_spacing;
2935         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2936         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2937             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2938             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2939             guiparams.bed_elevation);
2940     <span class="keyword">end</span>
2941     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2942         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2943         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2944         guiparams.KMZ_vertical_offset);
2945 <span class="keyword">end</span>
2946 
2947 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2948 
2949 
2950 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2951 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2952 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2953 
2954 <span class="comment">% --------------------------------------------------------------------</span>
2955 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2956 
2957 <span class="comment">% Get the Application data:</span>
2958 <span class="comment">% -------------------------</span>
2959 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2960 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2961 z = guiparams.z;
2962 A = guiparams.A;
2963 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2964 <span class="comment">% Map = guiparams.Map;</span>
2965 setends = guiparams.set_cross_section_endpoints;
2966 
2967 [the_file,the_path] = <span class="keyword">...</span>
2968     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2969     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2970     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2971     guiprefs.multibeambathymetry_file));
2972 
2973 <span class="keyword">if</span> ischar(the_file)
2974     guiparams.multibeambathymetry_path = the_path;
2975     guiparams.multibeambathymetry_file = the_file;
2976     
2977     <span class="comment">% Re-store the Application data:</span>
2978     <span class="comment">% ------------------------------</span>
2979     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2980     
2981     <span class="comment">% Update the preferences:</span>
2982     <span class="comment">% -----------------------</span>
2983     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2984     guiprefs.multibeambathymetry_path = the_path;
2985     guiprefs.multibeambathymetry_file = the_file;
2986     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2987     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2988     
2989     <span class="keyword">if</span> guiparams.output_auxiliary_data
2990     <span class="keyword">end</span>
2991     
2992     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2993     
2994     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2995         guiparams.multibeambathymetry_file);
2996     
2997     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2998         [<span class="string">'   '</span> savefile]};
2999     statusLogging(handles.LogWindow,log_text)
3000     
3001     <span class="comment">% Process the transects:</span>
3002     <span class="comment">% ----------------------</span>
3003     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3004     A(1).vgns = guiparams.vertical_grid_node_spacing;
3005     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3006     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3007         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
3008     
3009     <span class="comment">% Compute the smoothed variables</span>
3010     <span class="comment">% ------------------------------</span>
3011     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3012     <span class="comment">% runtime.</span>
3013     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3014         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3015         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3016         guiparams.vertical_smoothing_window);
3017     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3018     <span class="comment">% Push messages to Log Window:</span>
3019     <span class="comment">% ----------------------------</span>
3020     statusLogging(handles.LogWindow, processing_log_text)
3021 
3022     
3023     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3024         guiparams.A, <span class="keyword">...</span>
3025         savefile, <span class="keyword">...</span>
3026         guiparams.beam_angle, <span class="keyword">...</span>
3027         guiparams.magnetic_variation, <span class="keyword">...</span>
3028         guiparams.water_surface_elevation, <span class="keyword">...</span>
3029         guiparams.output_auxiliary_data);
3030     
3031     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3032     
3033 <span class="keyword">end</span>
3034 
3035 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3036 
3037 
3038 <span class="comment">% --------------------------------------------------------------------</span>
3039 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3040 <span class="comment">% Get the beam angle</span>
3041 
3042 <span class="comment">% Get the Application data:</span>
3043 <span class="comment">% -------------------------</span>
3044 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3045 
3046 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3047 <span class="comment">% ----------------------------------------------------------------</span>
3048 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3049 is_a_number = ~isnan(new_beam_angle);
3050 is_positive = new_beam_angle&gt;=0;
3051 
3052 <span class="comment">% Modify the Application data:</span>
3053 <span class="comment">% ----------------------------</span>
3054 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3055     guiparams.beam_angle = new_beam_angle;
3056     
3057     <span class="comment">% Re-store the Application data:</span>
3058     <span class="comment">% ------------------------------</span>
3059     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3060     
3061 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3062     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3063 <span class="keyword">end</span>
3064 
3065 <span class="comment">% [EOF] BeamAngle_Callback</span>
3066 
3067 
3068 <span class="comment">% --------------------------------------------------------------------</span>
3069 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3070 <span class="comment">% Get the Magnetic Variation</span>
3071 
3072 <span class="comment">% Get the Application data:</span>
3073 <span class="comment">% -------------------------</span>
3074 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3075 
3076 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3077 <span class="comment">% ----------------------------------------------------------------</span>
3078 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3079 is_a_number = ~isnan(new_magnetic_variation);
3080 is_positive = new_magnetic_variation&gt;=0;
3081 
3082 <span class="comment">% Modify the Application data:</span>
3083 <span class="comment">% ----------------------------</span>
3084 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3085     guiparams.magnetic_variation = new_magnetic_variation;
3086     
3087     <span class="comment">% Re-store the Application data:</span>
3088     <span class="comment">% ------------------------------</span>
3089     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3090     
3091 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3092     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3093 <span class="keyword">end</span>
3094 
3095 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3096 
3097 
3098 <span class="comment">% % --------------------------------------------------------------------</span>
3099 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3100 <span class="comment">%</span>
3101 <span class="comment">% % Get the Application data:</span>
3102 <span class="comment">% % -------------------------</span>
3103 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3104 <span class="comment">%</span>
3105 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3106 <span class="comment">% % ----------------------------------------------------------------</span>
3107 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3108 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3109 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3110 <span class="comment">%</span>
3111 <span class="comment">% % Modify the Application data:</span>
3112 <span class="comment">% % ----------------------------</span>
3113 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3114 <span class="comment">%     guiparams.wse = new_wse;</span>
3115 <span class="comment">%</span>
3116 <span class="comment">%     % Re-store the Application data:</span>
3117 <span class="comment">%     % ------------------------------</span>
3118 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3119 <span class="comment">%</span>
3120 <span class="comment">% else % Reject the (incorrect) input</span>
3121 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3122 <span class="comment">% end</span>
3123 <span class="comment">%</span>
3124 <span class="comment">% % [EOF] WSE_Callback</span>
3125 
3126 
3127 <span class="comment">% --------------------------------------------------------------------</span>
3128 <a name="_sub68" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3129 <span class="comment">% Bathymetry Auxiliary Data</span>
3130 
3131 <span class="comment">% Get the Application data:</span>
3132 <span class="comment">% -------------------------</span>
3133 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3134 
3135 <span class="comment">% Modify the Application data:</span>
3136 <span class="comment">% ----------------------------</span>
3137 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3138 
3139 <span class="comment">% Re-store the Application data:</span>
3140 <span class="comment">% ------------------------------</span>
3141 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3142 
3143 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3144 
3145 
3146 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3147 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3148 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3149 
3150 <span class="comment">% --------------------------------------------------------------------</span>
3151 <a name="_sub69" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3152 
3153 <span class="comment">% Get the Application data:</span>
3154 <span class="comment">% -------------------------</span>
3155 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3156 
3157 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3158 <span class="comment">% ----------------------------------------------------------------</span>
3159 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3160 is_a_number = ~isnan(new_depth_range_min);
3161 is_positive = new_depth_range_min&gt;=0;
3162 
3163 <span class="comment">% Modify the Application data:</span>
3164 <span class="comment">% ----------------------------</span>
3165 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3166     guiparams.depth_range_min = new_depth_range_min;
3167     
3168     <span class="comment">% Re-store the Application data:</span>
3169     <span class="comment">% ------------------------------</span>
3170     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3171     
3172 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3173     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3174 <span class="keyword">end</span>
3175 
3176 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3177 
3178 
3179 <span class="comment">% --------------------------------------------------------------------</span>
3180 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3181 
3182 <span class="comment">% Get the Application data:</span>
3183 <span class="comment">% -------------------------</span>
3184 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3185 
3186 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3187 <span class="comment">% ----------------------------------------------------------------</span>
3188 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3189 is_a_number = ~isnan(new_depth_range_max);
3190 is_positive = new_depth_range_max&gt;=0;
3191 
3192 <span class="comment">% Modify the Application data:</span>
3193 <span class="comment">% ----------------------------</span>
3194 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3195     guiparams.depth_range_max = new_depth_range_max;
3196     
3197     <span class="comment">% Re-store the Application data:</span>
3198     <span class="comment">% ------------------------------</span>
3199     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3200     
3201 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3202     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3203 <span class="keyword">end</span>
3204 
3205 <span class="comment">% [EOF] DepthMax_Callback</span>
3206 
3207 
3208 <span class="comment">% --------------------------------------------------------------------</span>
3209 <a name="_sub71" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3210 <span class="comment">% Set quiver scale (contour)</span>
3211 
3212 <span class="comment">% Get the Application data:</span>
3213 <span class="comment">% -------------------------</span>
3214 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3215 
3216 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3217 <span class="comment">% ----------------------------------------------------------------</span>
3218 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3219 is_a_number = ~isnan(new_vector_scale_plan_view);
3220 is_positive = new_vector_scale_plan_view&gt;=0;
3221 
3222 <span class="comment">% Modify the Application data:</span>
3223 <span class="comment">% ----------------------------</span>
3224 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3225     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3226     
3227     <span class="comment">% Re-store the Application data:</span>
3228     <span class="comment">% ------------------------------</span>
3229     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3230     
3231 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3232     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3233 <span class="keyword">end</span>
3234 
3235 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3236 
3237 
3238 <span class="comment">% --------------------------------------------------------------------</span>
3239 <a name="_sub72" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3240 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3241 
3242 <span class="comment">% Get the Application data:</span>
3243 <span class="comment">% -------------------------</span>
3244 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3245 
3246 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3247 <span class="comment">% ----------------------------------------------------------------</span>
3248 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3249 is_a_number = ~isnan(new_vector_spacing_plan_view);
3250 is_positive = new_vector_spacing_plan_view&gt;=0;
3251 
3252 <span class="comment">% Modify the Application data:</span>
3253 <span class="comment">% ----------------------------</span>
3254 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3255     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3256     
3257     <span class="comment">% Re-store the Application data:</span>
3258     <span class="comment">% ------------------------------</span>
3259     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3260     
3261 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3262     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3263 <span class="keyword">end</span>
3264 
3265 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3266 
3267 
3268 <span class="comment">% --------------------------------------------------------------------</span>
3269 <a name="_sub73" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3270 <span class="comment">% Plan View smoothing window size</span>
3271 
3272 <span class="comment">% Get the Application data:</span>
3273 <span class="comment">% -------------------------</span>
3274 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3275 
3276 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3277 <span class="comment">% ----------------------------------------------------------------</span>
3278 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3279 is_a_number = ~isnan(new_smoothing_window_size);
3280 is_positive = new_smoothing_window_size&gt;=0;
3281 
3282 <span class="comment">% Modify the Application data:</span>
3283 <span class="comment">% ----------------------------</span>
3284 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3285     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3286     
3287     <span class="comment">% Re-store the Application data:</span>
3288     <span class="comment">% ------------------------------</span>
3289     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3290     
3291 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3292     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3293 <span class="keyword">end</span>
3294 
3295 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3296 
3297 
3298 <span class="comment">% --------------------------------------------------------------------</span>
3299 <a name="_sub74" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3300 
3301 <span class="comment">% Get the Application data:</span>
3302 <span class="comment">% -------------------------</span>
3303 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3304 
3305 <span class="comment">% Modify the Application data:</span>
3306 <span class="comment">% ----------------------------</span>
3307 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3308 
3309 <span class="comment">% Re-store the Application data:</span>
3310 <span class="comment">% ------------------------------</span>
3311 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3312 
3313 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3314 
3315 
3316 <span class="comment">% --------------------------------------------------------------------</span>
3317 <a name="_sub75" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3318 
3319 <span class="comment">% Get the Application data:</span>
3320 <span class="comment">% -------------------------</span>
3321 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3322 
3323 <span class="comment">% Modify the Application data:</span>
3324 <span class="comment">% ----------------------------</span>
3325 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3326 
3327 <span class="comment">% Re-store the Application data:</span>
3328 <span class="comment">% ------------------------------</span>
3329 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3330 
3331 <span class="comment">% [EOF] AddBackground_Callback</span>
3332 
3333 
3334 <span class="comment">% --------------------------------------------------------------------</span>
3335 <a name="_sub76" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3336 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3337 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3338 
3339 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3340 <span class="comment">% OFFSETS PANEL CALLBACKS %</span>
3341 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3342 
3343 
3344 <a name="_sub77" href="#_subfunctions" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a>
3345 <span class="comment">% Water Surface Elevation</span>
3346 
3347 <span class="comment">% Get the Application data:</span>
3348 <span class="comment">% -------------------------</span>
3349 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3350 
3351 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3352 <span class="comment">% ----------------------------------------------------------------</span>
3353 string = get(hObject,<span class="string">'String'</span>);
3354 new_water_surface_elevation = str2double(string);
3355 is_a_number = ~isnan(new_water_surface_elevation);
3356 is_positive = new_water_surface_elevation&gt;=0;
3357 is_tide     = strcmpi(<span class="string">'tide'</span>,string);
3358 
3359 <span class="comment">% Modify the Application data:</span>
3360 <span class="comment">% ----------------------------</span>
3361 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3362     guiparams.water_surface_elevation = (new_water_surface_elevation);
3363     guiparams.load_wse_tide_file      = false;
3364     <span class="comment">% Re-store the Application data:</span>
3365     <span class="comment">% ------------------------------</span>
3366     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3367     
3368 <span class="keyword">elseif</span> is_tide
3369     guiparams.water_surface_elevation = <span class="string">'tide'</span>;
3370     guiparams.load_wse_tide_file      = true;
3371     
3372     <span class="comment">% Re-store the Application data:</span>
3373     <span class="comment">% ------------------------------</span>
3374     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3375 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3376     set(hObject,<span class="string">'String'</span>,guiparams.water_surface_elevation)
3377 <span class="keyword">end</span>
3378 
3379 <span class="comment">% [EOF] WaterSurfaceElevation_Callback</span>
3380 
3381 
3382 <a name="_sub78" href="#_subfunctions" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a>
3383 <span class="comment">% Bed Elevation</span>
3384 <span class="comment">% This is a constant that is added to the V.mcsBedElev variable if the</span>
3385 <span class="comment">% 'Height above the bed' [hab] reference is selected. Note, in cases where</span>
3386 <span class="comment">% the bed is flat, this represents the actual bed elevation. Otherwise this</span>
3387 <span class="comment">% is a simple datum shift applied to the bed.</span>
3388 
3389 <span class="comment">% Get the Application data:</span>
3390 <span class="comment">% -------------------------</span>
3391 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3392 
3393 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3394 <span class="comment">% ----------------------------------------------------------------</span>
3395 string = get(hObject,<span class="string">'String'</span>);
3396 new_bed_elevation = str2double(string);
3397 is_a_number = ~isnan(new_bed_elevation);
3398 
3399 <span class="comment">% Modify the Application data:</span>
3400 <span class="comment">% ----------------------------</span>
3401 <span class="keyword">if</span> is_a_number
3402     guiparams.bed_elevation = (new_bed_elevation);
3403     
3404     <span class="comment">% Re-store the Application data:</span>
3405     <span class="comment">% ------------------------------</span>
3406     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3407     
3408 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3409     set(hObject,<span class="string">'String'</span>,guiparams.bed_elevation)
3410 <span class="keyword">end</span>
3411 
3412 <span class="comment">% [EOF] BedElevation_Callback</span>
3413 
3414 <a name="_sub79" href="#_subfunctions" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
3415 <span class="comment">% KMZ Vertical Offset</span>
3416 <span class="comment">% This is the elevation (in meters) that the cross section should be offset</span>
3417 <span class="comment">% to in Google Earth to ensure it plots above the land surface for</span>
3418 <span class="comment">% visualization.</span>
3419 
3420 <span class="comment">% Get the Application data:</span>
3421 <span class="comment">% -------------------------</span>
3422 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3423 
3424 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3425 <span class="comment">% ----------------------------------------------------------------</span>
3426 string = get(hObject,<span class="string">'String'</span>);
3427 new_KMZ_vertical_offset = str2double(string);
3428 is_a_number = ~isnan(new_KMZ_vertical_offset);
3429 is_positive = new_KMZ_vertical_offset&gt;=0;
3430 
3431 <span class="comment">% Modify the Application data:</span>
3432 <span class="comment">% ----------------------------</span>
3433 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3434     guiparams.KMZ_vertical_offset = (new_KMZ_vertical_offset);
3435     
3436     <span class="comment">% Re-store the Application data:</span>
3437     <span class="comment">% ------------------------------</span>
3438     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3439     
3440 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3441     set(hObject,<span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
3442 <span class="keyword">end</span>
3443 
3444 <span class="comment">% [EOF] KMZVerticalOffset_Callback</span>
3445 
3446 
3447 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3448 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3449 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3450 
3451 <span class="comment">% --------------------------------------------------------------------</span>
3452 <a name="_sub80" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3453 <span class="comment">% Set the horizontal grid node spacing</span>
3454 
3455 <span class="comment">% Get the Application data:</span>
3456 <span class="comment">% -------------------------</span>
3457 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3458 
3459 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3460 <span class="comment">% ----------------------------------------------------------------</span>
3461 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3462 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3463 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3464 
3465 <span class="comment">% Modify the Application data:</span>
3466 <span class="comment">% ----------------------------</span>
3467 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3468     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3469     
3470     <span class="comment">% Re-store the Application data:</span>
3471     <span class="comment">% ------------------------------</span>
3472     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3473     
3474 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3475     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3476 <span class="keyword">end</span>
3477 
3478 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3479 
3480 <span class="comment">% --------------------------------------------------------------------</span>
3481 <a name="_sub81" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3482 <span class="comment">% Set the horizontal grid node spacing</span>
3483 
3484 <span class="comment">% Get the Application data:</span>
3485 <span class="comment">% -------------------------</span>
3486 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3487 
3488 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3489 <span class="comment">% ----------------------------------------------------------------</span>
3490 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3491 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3492 is_positive = new_vertical_grid_node_spacing&gt;=0;
3493 
3494 <span class="comment">% Modify the Application data:</span>
3495 <span class="comment">% ----------------------------</span>
3496 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3497     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3498     
3499     <span class="comment">% Re-store the Application data:</span>
3500     <span class="comment">% ------------------------------</span>
3501     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3502     
3503 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3504     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3505 <span class="keyword">end</span>
3506 
3507 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3508 
3509 <span class="comment">% --------------------------------------------------------------------</span>
3510 <a name="_sub82" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3511 <span class="comment">% Set the cross section endpoints manually</span>
3512 
3513 <span class="comment">% Get the Application data:</span>
3514 <span class="comment">% -------------------------</span>
3515 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3516 
3517 <span class="comment">% Modify the Application data:</span>
3518 <span class="comment">% ----------------------------</span>
3519 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3520 
3521 <span class="comment">% Re-store the Application data:</span>
3522 <span class="comment">% ------------------------------</span>
3523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3524 
3525 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3526 
3527 
3528 <span class="comment">% --------------------------------------------------------------------</span>
3529 <a name="_sub83" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3530 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3531 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3532 
3533 
3534 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3535 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3536 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3537 
3538 <span class="comment">% --------------------------------------------------------------------</span>
3539 <a name="_sub84" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3540 
3541 <span class="comment">% Get the Application data:</span>
3542 <span class="comment">% -------------------------</span>
3543 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3544 
3545 <span class="comment">% Modify the Application data:</span>
3546 <span class="comment">% ----------------------------</span>
3547 idx_variable = get(hObject,<span class="string">'Value'</span>);
3548 guiparams.idx_contour = idx_variable;
3549 guiparams.contour = guiparams.contours(idx_variable).variable;
3550 
3551 <span class="comment">% Re-store the Application data:</span>
3552 <span class="comment">% ------------------------------</span>
3553 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3554 
3555 <span class="comment">% [EOF] Contour_Callback</span>
3556 
3557 
3558 <span class="comment">% --------------------------------------------------------------------</span>
3559 <a name="_sub85" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3560 <span class="comment">% Set vertical exaggeration</span>
3561 
3562 <span class="comment">% Get the Application data:</span>
3563 <span class="comment">% -------------------------</span>
3564 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3565 
3566 <span class="comment">% Modify the Application data:</span>
3567 <span class="comment">% ----------------------------</span>
3568 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3569 
3570 <span class="comment">% Re-store the Application data:</span>
3571 <span class="comment">% ------------------------------</span>
3572 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3573 
3574 <span class="comment">% Update the GUI:</span>
3575 <span class="comment">% ---------------</span>
3576 <span class="comment">% updateGUI(handles,guiparams)</span>
3577 
3578 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3579 
3580 
3581 <span class="comment">% --------------------------------------------------------------------</span>
3582 <a name="_sub86" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3583 
3584 <span class="comment">% Get the Application data:</span>
3585 <span class="comment">% -------------------------</span>
3586 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3587 
3588 <span class="comment">% Modify the Application data:</span>
3589 <span class="comment">% ----------------------------</span>
3590 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3591 
3592 <span class="comment">% Re-store the Application data:</span>
3593 <span class="comment">% ------------------------------</span>
3594 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3595 
3596 <span class="comment">% Update the GUI:</span>
3597 <span class="comment">% ---------------</span>
3598 <span class="comment">% updateGUI(handles,guiparams)</span>
3599 
3600 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3601 
3602 
3603 <span class="comment">% --------------------------------------------------------------------</span>
3604 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3605 
3606 <span class="comment">% Get the Application data:</span>
3607 <span class="comment">% -------------------------</span>
3608 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3609 
3610 <span class="comment">% Modify the Application data:</span>
3611 <span class="comment">% ----------------------------</span>
3612 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3613 
3614 <span class="comment">% Re-store the Application data:</span>
3615 <span class="comment">% ------------------------------</span>
3616 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3617 
3618 <span class="comment">% Update the GUI:</span>
3619 <span class="comment">% ---------------</span>
3620 <span class="comment">% updateGUI(handles,guiparams)</span>
3621 
3622 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3623 
3624 
3625 <span class="comment">% --------------------------------------------------------------------</span>
3626 <a name="_sub88" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3627 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3628 
3629 <span class="comment">% Get the Application data:</span>
3630 <span class="comment">% -------------------------</span>
3631 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3632 
3633 <span class="comment">% Modify the Application data:</span>
3634 <span class="comment">% ----------------------------</span>
3635 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3636 
3637 <span class="comment">% Re-store the Application data:</span>
3638 <span class="comment">% ------------------------------</span>
3639 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3640 
3641 <span class="comment">% Update the GUI:</span>
3642 <span class="comment">% ---------------</span>
3643 <span class="comment">% updateGUI(handles,guiparams)</span>
3644 
3645 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3646 
3647 
3648 <span class="comment">% --------------------------------------------------------------------</span>
3649 <a name="_sub89" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3650 <span class="comment">% Horizontal Smoothing</span>
3651 
3652 <span class="comment">% Get the Application data:</span>
3653 <span class="comment">% -------------------------</span>
3654 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3655 
3656 <span class="comment">% Modify the Application data:</span>
3657 <span class="comment">% ----------------------------</span>
3658 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3659 
3660 <span class="comment">% Re-store the Application data:</span>
3661 <span class="comment">% ------------------------------</span>
3662 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3663 
3664 <span class="comment">% Update the GUI:</span>
3665 <span class="comment">% ---------------</span>
3666 <span class="comment">% updateGUI(handles,guiparams)</span>
3667 
3668 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3669 
3670 
3671 <span class="comment">% --------------------------------------------------------------------</span>
3672 <a name="_sub90" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3673 <span class="comment">% Vertical Smoothing</span>
3674 
3675 <span class="comment">% Get the Application data:</span>
3676 <span class="comment">% -------------------------</span>
3677 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3678 
3679 <span class="comment">% Modify the Application data:</span>
3680 <span class="comment">% ----------------------------</span>
3681 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3682 
3683 <span class="comment">% Re-store the Application data:</span>
3684 <span class="comment">% ------------------------------</span>
3685 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3686 
3687 <span class="comment">% Update the GUI:</span>
3688 <span class="comment">% ---------------</span>
3689 <span class="comment">% updateGUI(handles,guiparams)</span>
3690 
3691 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3692 
3693 
3694 <span class="comment">% --------------------------------------------------------------------</span>
3695 <a name="_sub91" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3696 
3697 <span class="comment">% Get the Application data:</span>
3698 <span class="comment">% -------------------------</span>
3699 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3700 
3701 <span class="comment">% Modify the Application data:</span>
3702 <span class="comment">% ----------------------------</span>
3703 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3704 
3705 <span class="comment">% Re-store the Application data:</span>
3706 <span class="comment">% ------------------------------</span>
3707 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3708 
3709 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3710 
3711 
3712 <span class="comment">% --------------------------------------------------------------------</span>
3713 <a name="_sub92" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3714 
3715 <span class="comment">% Get the Application data:</span>
3716 <span class="comment">% -------------------------</span>
3717 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3718 
3719 <span class="comment">% Modify the Application data:</span>
3720 <span class="comment">% ----------------------------</span>
3721 idx_variable = get(hObject,<span class="string">'Value'</span>);
3722 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3723 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3724 
3725 <span class="comment">% Re-store the Application data:</span>
3726 <span class="comment">% ------------------------------</span>
3727 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3728 
3729 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3730 
3731 
3732 <span class="comment">% --------------------------------------------------------------------</span>
3733 <a name="_sub93" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3734 
3735 <span class="comment">% Get the Application data:</span>
3736 <span class="comment">% -------------------------</span>
3737 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3738 
3739 <span class="comment">% Modify the Application data:</span>
3740 <span class="comment">% ----------------------------</span>
3741 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3742 
3743 <span class="comment">% Re-store the Application data:</span>
3744 <span class="comment">% ------------------------------</span>
3745 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3746 
3747 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3748 
3749 
3750 <span class="comment">% --------------------------------------------------------------------</span>
3751 <a name="_sub94" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3752 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3753 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3754 
3755 
3756 <span class="comment">% --------------------------------------------------------------------</span>
3757 <a name="_sub95" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3758 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3759 <span class="comment">% [EOF] ClearLog_Callback</span>
3760 
3761 <span class="comment">% --------------------------------------------------------------------</span>
3762 <a name="_sub96" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3763 
3764 <span class="comment">% Get the Application data:</span>
3765 <span class="comment">% -------------------------</span>
3766 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3767 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3768 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3769 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3770 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3771 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3772 
3773 [the_file,the_path] = <span class="keyword">...</span>
3774     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3775     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3776     fullfile(guiprefs.log_path,guiprefs.log_file));
3777 
3778 <span class="comment">% Save the log to a TXT file:</span>
3779 <span class="comment">% ---------------------------</span>
3780 <span class="keyword">if</span> ischar(the_file)
3781     guiparams.log_path = the_path;
3782     guiparams.log_file = the_file;
3783     <span class="comment">%guiparams.savefile = the_file;</span>
3784     
3785     <span class="comment">% Re-store the Application data:</span>
3786     <span class="comment">% ------------------------------</span>
3787     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3788     
3789     <span class="comment">% Update the preferences:</span>
3790     <span class="comment">% -----------------------</span>
3791     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3792     guiprefs.log_path = the_path;
3793     guiprefs.log_file = the_file;
3794     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3795     <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3796     
3797     [~,filename,extension] = fileparts(the_file);
3798     savefile = [the_path filename extension];
3799     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3800         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3801     
3802     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3803     [nrows,~]= size(logfile);
3804     fid = fopen(savefile, <span class="string">'w'</span>);
3805     <span class="keyword">for</span> row=1:nrows
3806         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3807     <span class="keyword">end</span>
3808     fclose(fid);
3809 <span class="keyword">end</span>
3810 <span class="comment">% [EOF] SaveLog_Callback</span>
3811 
3812 <span class="comment">%%%%%%%%%%%%%%%%</span>
3813 <span class="comment">% SUBFUNCTIONS %</span>
3814 <span class="comment">%%%%%%%%%%%%%%%%</span>
3815 
3816 <span class="comment">% --------------------------------------------------------------------</span>
3817 <a name="_sub97" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3818 
3819 icons = <a href="#_sub113" class="code" title="subfunction icons = getIcons">getIcons</a>;
3820 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3821 
3822 <span class="comment">% Load data</span>
3823 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3824 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3825 <span class="comment">% icon(icon==0) = NaN;</span>
3826 handles.toolbarLoadData = <span class="keyword">...</span>
3827     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3828     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3829     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3830 
3831 <span class="comment">% Save data</span>
3832 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3833 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3834 <span class="comment">% icon(icon==0) = NaN;</span>
3835 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3836     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3837     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3838     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3839     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3840 
3841 
3842 <span class="comment">% Save bathymetry</span>
3843 <span class="comment">%icon = ones(16,16,3);</span>
3844 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3845     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3846     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3847     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3848 
3849 <span class="comment">% Save figures</span>
3850 <span class="comment">% icon = ones(16,16,3);</span>
3851 handles.toolbarSaveFigures = <span class="keyword">...</span>
3852     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3853     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3854     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3855 
3856 <span class="comment">% Save Excel File</span>
3857 <span class="comment">% icon = ones(16,16,3);</span>
3858 handles.toolbarSaveExcel = <span class="keyword">...</span>
3859     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3860     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3861     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3862 
3863 
3864 <span class="comment">% Plotting parameters</span>
3865 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3866 <span class="comment">% icon = ind2rgb(icon,map);</span>
3867 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3868     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3869     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3870     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3871     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3872 
3873 <span class="comment">% Processing parameters</span>
3874 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3875 <span class="comment">% icon = ind2rgb(icon,map);</span>
3876 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3877     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3878     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3879     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3880 
3881 <span class="comment">% Zoom In</span>
3882 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3883 <span class="comment">% icon = ind2rgb(icon,map);</span>
3884 <span class="comment">% handles.toolbarZoomIn = ...</span>
3885 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3886 <span class="comment">%     'CData',        icons(8).data, ...</span>
3887 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3888 <span class="comment">%     'Separator',     'on');</span>
3889 
3890 <span class="comment">% Zoom Out</span>
3891 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3892 <span class="comment">% icon = ind2rgb(icon,map);</span>
3893 <span class="comment">% handles.toolbarZoomOut = ...</span>
3894 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3895 <span class="comment">%     'CData',        icons(9).data, ...</span>
3896 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3897 
3898 <span class="comment">% Pan</span>
3899 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3900 <span class="comment">% icon = ind2rgb(icon,map);</span>
3901 <span class="comment">% handles.toolbarPan = ...</span>
3902 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3903 <span class="comment">%     'CData',        icons(10).data, ...</span>
3904 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3905 
3906 
3907 
3908 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3909 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3910 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3911 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3912 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3913 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3914 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3915 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3916 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3917 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3918 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3919 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3920 
3921 <span class="comment">% [EOF] buildtoolbar</span>
3922 
3923 
3924 <span class="comment">% --------------------------------------------------------------------</span>
3925 <a name="_sub98" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3926 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3927 <span class="comment">% already exist.</span>
3928 
3929 <span class="comment">% Preferences:</span>
3930 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3931 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3932 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3933 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3934 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3935 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3936 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3937 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3938 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3939 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3940 <span class="comment">% 'renderer'             Default graphics renderer</span>
3941 <span class="comment">% 'units'                Default plotting units</span>
3942 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3943 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3944 <span class="comment">%                        started</span>
3945 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3946 
3947 <span class="comment">% Originals</span>
3948 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3949 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3950 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3951 
3952 <span class="comment">% ASCII</span>
3953 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3954     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3955     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3956         guiprefs.ascii_path = ascii.path;
3957     <span class="keyword">else</span>
3958         guiprefs.ascii_path = pwd;
3959     <span class="keyword">end</span>
3960     does_exist = false(1,length(ascii.file));
3961     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3962         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3963     <span class="keyword">end</span>
3964     <span class="keyword">if</span> any(does_exist)
3965         guiprefs.ascii_file = ascii.file(does_exist);
3966     <span class="keyword">else</span>
3967         guiprefs.ascii_file = {<span class="string">''</span>};
3968     <span class="keyword">end</span>
3969 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3970     guiprefs.ascii_path = pwd;
3971     guiprefs.ascii_file = {<span class="string">''</span>};
3972     
3973     ascii.path = pwd;
3974     ascii.file = {<span class="string">''</span>};
3975     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3976 <span class="keyword">end</span>
3977 
3978 <span class="comment">% MAT</span>
3979 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3980     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3981     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3982         guiprefs.mat_path = mat.path;
3983     <span class="keyword">else</span>
3984         guiprefs.mat_path = pwd;
3985     <span class="keyword">end</span>
3986     
3987     <span class="keyword">if</span> iscell(mat.file)
3988         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3989             guiprefs.mat_file = mat.file;
3990         <span class="keyword">else</span>
3991             guiprefs.mat_file = <span class="string">''</span>;
3992         <span class="keyword">end</span>
3993     <span class="keyword">else</span>
3994         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3995             guiprefs.mat_file = mat.file;
3996         <span class="keyword">else</span>
3997             guiprefs.mat_file = <span class="string">''</span>;
3998         <span class="keyword">end</span>
3999     <span class="keyword">end</span>
4000 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
4001     guiprefs.mat_path = pwd;
4002     guiprefs.mat_file = <span class="string">''</span>;
4003     
4004     mat.path = pwd;
4005     mat.file = <span class="string">''</span>;
4006     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4007 <span class="keyword">end</span>
4008 
4009 <span class="comment">% TECPLOT</span>
4010 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
4011     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
4012     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
4013         guiprefs.tecplot_path = tecplot.path;
4014     <span class="keyword">else</span>
4015         guiprefs.tecplot_path = pwd;
4016     <span class="keyword">end</span>
4017     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
4018         guiprefs.tecplot_file = tecplot.file;
4019     <span class="keyword">else</span>
4020         guiprefs.tecplot_file = <span class="string">''</span>;
4021     <span class="keyword">end</span>
4022 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4023     guiprefs.tecplot_path = pwd;
4024     guiprefs.tecplot_file = <span class="string">''</span>;
4025     
4026     tecplot.path = pwd;
4027     tecplot.file = <span class="string">''</span>;
4028     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4029 <span class="keyword">end</span>
4030 
4031 <span class="comment">% KMZ</span>
4032 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
4033     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
4034     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
4035         guiprefs.kmz_path = kmz.path;
4036     <span class="keyword">else</span>
4037         guiprefs.kmz_path = pwd;
4038     <span class="keyword">end</span>
4039     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
4040         guiprefs.kmz_file = kmz.file;
4041     <span class="keyword">else</span>
4042         guiprefs.kmz_file = <span class="string">''</span>;
4043     <span class="keyword">end</span>
4044 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
4045     guiprefs.kmz_path = pwd;
4046     guiprefs.kmz_file = <span class="string">''</span>;
4047     
4048     kmz.path = pwd;
4049     kmz.file = <span class="string">''</span>;
4050     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4051 <span class="keyword">end</span>
4052 
4053 <span class="comment">% MULTIBEAM BATHYMETRY</span>
4054 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
4055     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
4056     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
4057         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
4058     <span class="keyword">else</span>
4059         guiprefs.multibeambathymetry_path = pwd;
4060     <span class="keyword">end</span>
4061     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
4062         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
4063     <span class="keyword">else</span>
4064         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4065     <span class="keyword">end</span>
4066 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
4067     guiprefs.multibeambathymetry_path = pwd;
4068     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4069     
4070     multibeambathymetry.path = pwd;
4071     multibeambathymetry.file = <span class="string">''</span>;
4072     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4073 <span class="keyword">end</span>
4074 
4075 <span class="comment">% Log</span>
4076 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
4077     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
4078     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
4079         guiprefs.log_path = log.path;
4080     <span class="keyword">else</span>
4081         guiprefs.log_path = pwd;
4082     <span class="keyword">end</span>
4083     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
4084         guiprefs.log_file = log.file;
4085     <span class="keyword">else</span>
4086         guiprefs.log_file = <span class="string">''</span>;
4087     <span class="keyword">end</span>
4088 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4089     guiprefs.log_path = pwd;
4090     guiprefs.log_file = <span class="string">''</span>;
4091     
4092     log.path = pwd;
4093     log.file = <span class="string">''</span>;
4094     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4095 <span class="keyword">end</span>
4096 
4097 <span class="comment">% iRic</span>
4098 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
4099     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
4100     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
4101         guiprefs.iric_path = iric.path;
4102     <span class="keyword">else</span>
4103         guiprefs.iric_path = pwd;
4104     <span class="keyword">end</span>
4105     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
4106         guiprefs.iric_file = iric.file;
4107     <span class="keyword">else</span>
4108         guiprefs.iric_file = <span class="string">''</span>;
4109     <span class="keyword">end</span>
4110 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4111     guiprefs.iric_path = pwd;
4112     guiprefs.iric_file = <span class="string">''</span>;
4113     
4114     iric.path = pwd;
4115     iric.file = <span class="string">''</span>;
4116     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4117 <span class="keyword">end</span>
4118 
4119 <span class="comment">% excel</span>
4120 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
4121     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
4122     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
4123         guiprefs.excel_path = excel.path;
4124     <span class="keyword">else</span>
4125         guiprefs.excel_path = pwd;
4126     <span class="keyword">end</span>
4127     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4128         guiprefs.excel_file = excel.file;
4129     <span class="keyword">else</span>
4130         guiprefs.excel_file = <span class="string">''</span>;
4131     <span class="keyword">end</span>
4132 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4133     guiprefs.excel_path = pwd;
4134     guiprefs.excel_file = <span class="string">''</span>;
4135     
4136     excel.path = pwd;
4137     excel.file = <span class="string">''</span>;
4138     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4139 <span class="keyword">end</span>
4140 
4141 <span class="comment">% aerial</span>
4142 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4143     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4144     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4145         guiprefs.aerial_path = aerial.path;
4146     <span class="keyword">else</span>
4147         guiprefs.aerial_path = pwd;
4148     <span class="keyword">end</span>
4149     does_exist = false(1,length(aerial.file));
4150     <span class="keyword">if</span> iscell(aerial.file)
4151     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4152         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4153     <span class="keyword">end</span>
4154     <span class="keyword">else</span>
4155         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4156     <span class="keyword">end</span>
4157     <span class="keyword">if</span> any(does_exist)
4158         guiprefs.aerial_file = aerial.file;
4159     <span class="keyword">else</span>
4160         guiprefs.aerial_file = {<span class="string">''</span>};
4161     <span class="keyword">end</span>
4162 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4163     guiprefs.aerial_path = pwd;
4164     guiprefs.aerial_file = {<span class="string">''</span>};
4165     
4166     aerial.path = pwd;
4167     aerial.file = {<span class="string">''</span>};
4168     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4169 <span class="keyword">end</span>
4170 
4171 <span class="comment">% shoreline</span>
4172 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4173     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4174     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4175         guiprefs.shoreline_path = shoreline.path;
4176     <span class="keyword">else</span>
4177         guiprefs.shoreline_path = pwd;
4178     <span class="keyword">end</span>
4179     
4180     <span class="keyword">if</span> iscell(shoreline.file)
4181         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4182             guiprefs.shoreline_file = shoreline.file;
4183         <span class="keyword">else</span>
4184             guiprefs.shoreline_file = <span class="string">''</span>;
4185         <span class="keyword">end</span>
4186     <span class="keyword">else</span>
4187         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4188             guiprefs.shoreline_file = shoreline.file;
4189         <span class="keyword">else</span>
4190             guiprefs.shoreline_file = <span class="string">''</span>;
4191         <span class="keyword">end</span>
4192     <span class="keyword">end</span>
4193 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4194     guiprefs.shoreline_path = pwd;
4195     guiprefs.shoreline_file = <span class="string">''</span>;
4196     
4197     shoreline.path = pwd;
4198     shoreline.file = <span class="string">''</span>;
4199     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4200 <span class="keyword">end</span>
4201 <span class="comment">% guiprefs.presentation = true;</span>
4202 <span class="comment">% guiprefs.print        = false;</span>
4203 
4204 <span class="comment">% for k = 1:length(prefs)</span>
4205 <span class="comment">%     newpref = '';</span>
4206 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4207 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4208 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4209 <span class="comment">%             newpref = stored_newpref;</span>
4210 <span class="comment">%         else</span>
4211 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4212 <span class="comment">%         end</span>
4213 <span class="comment">%     end</span>
4214 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4215 <span class="comment">% end</span>
4216 
4217 <span class="comment">% RENDERER</span>
4218 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4219     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4220     guiprefs.renderer = renderer;
4221 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4222     renderer           = <span class="string">'OpenGL'</span>;
4223     guiprefs.renderer  = renderer;
4224     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4225 <span class="keyword">end</span>
4226 
4227 <span class="comment">% UNITS</span>
4228 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4229     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4230     guiprefs.units = units;
4231 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4232     units           = <span class="string">'metric'</span>;
4233     guiprefs.units  = units;
4234     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4235 <span class="keyword">end</span>
4236 
4237 <span class="comment">% PLOTREF</span>
4238 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4239     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4240     guiprefs.plotref = plotref;
4241 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4242     plotref           = <span class="string">'dfs'</span>;
4243     guiprefs.plotref  = plotref;
4244     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4245 <span class="keyword">end</span>
4246 
4247 <span class="comment">% RUNCOUNTER</span>
4248 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4249     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4250     guiprefs.runcounter = runcounter;
4251 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4252     runcounter           = 1;
4253     guiprefs.runcounter  = runcounter;
4254     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4255 <span class="keyword">end</span>
4256 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4257 
4258 <span class="comment">% SETENDPOINTS</span>
4259 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4260     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4261     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4262         guiprefs.setendpoints_path = setendpoints.path;
4263     <span class="keyword">else</span>
4264         guiprefs.setendpoints_path = pwd;
4265     <span class="keyword">end</span>
4266     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4267         guiprefs.setendpoints_file = setendpoints.file;
4268     <span class="keyword">else</span>
4269         guiprefs.setendpoints_file = <span class="string">''</span>;
4270     <span class="keyword">end</span>
4271 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4272     guiprefs.setendpoints_path = pwd;
4273     guiprefs.setendpoints_file = <span class="string">''</span>;
4274     
4275     setendpoints.path = pwd;
4276     setendpoints.file = <span class="string">''</span>;
4277     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4278 <span class="keyword">end</span>
4279 
4280 <span class="comment">% [EOF] load_prefs</span>
4281 
4282 
4283 <span class="comment">% --------------------------------------------------------------------</span>
4284 <a name="_sub99" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4285 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4286 <span class="comment">% preferences data.</span>
4287 
4288 <span class="comment">% Preferences:</span>
4289 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4290 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4291 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4292 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4293 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4294 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4295 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4296 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4297 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4298 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4299 <span class="comment">% 'renderer'             Default graphics renderer</span>
4300 <span class="comment">% 'units'                Default plotting units</span>
4301 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4302 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4303 <span class="comment">%                        started</span>
4304 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4305 
4306 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4307 
4308 <span class="keyword">switch</span> pref
4309     <span class="keyword">case</span> <span class="string">'ascii'</span>
4310         ascii.path = guiprefs.ascii_path;
4311         ascii.file = guiprefs.ascii_file;
4312         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4313     <span class="keyword">case</span> <span class="string">'mat'</span>
4314         mat.path = guiprefs.mat_path;
4315         mat.file = guiprefs.mat_file;
4316         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4317     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4318         tecplot.path = guiprefs.tecplot_path;
4319         tecplot.file = guiprefs.tecplot_file;
4320         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4321     <span class="keyword">case</span> <span class="string">'kmz'</span>
4322         kmz.path = guiprefs.kmz_path;
4323         kmz.file = guiprefs.kmz_file;
4324         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4325     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4326         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4327         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4328         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4329     <span class="keyword">case</span> <span class="string">'log'</span>
4330         log.path = guiprefs.log_path;
4331         log.file = guiprefs.log_file;
4332         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4333     <span class="keyword">case</span> <span class="string">'iric'</span>
4334         iric.path = guiprefs.iric_path;
4335         iric.file = guiprefs.iric_file;
4336         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4337     <span class="keyword">case</span> <span class="string">'excel'</span>
4338         excel.path = guiprefs.excel_path;
4339         excel.file = guiprefs.excel_file;
4340         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4341     <span class="keyword">case</span> <span class="string">'aerial'</span>
4342         aerial.path = guiprefs.aerial_path;
4343         aerial.file = guiprefs.aerial_file;
4344         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4345     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4346         shoreline.path = guiprefs.shoreline_path;
4347         shoreline.file = guiprefs.shoreline_file;
4348         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4349     <span class="keyword">case</span> <span class="string">'renderer'</span>
4350         renderer = guiprefs.renderer;
4351         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4352     <span class="keyword">case</span> <span class="string">'units'</span>
4353         units = guiprefs.units;
4354         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4355     <span class="keyword">case</span> <span class="string">'plotref'</span>
4356         plotref = guiprefs.plotref;
4357         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4358     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4359         runcounter = guiprefs.runcounter;
4360         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4361     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4362         setendpoints.path = guiprefs.setendpoints_path;
4363         setendpoints.file = guiprefs.setendpoints_file;
4364         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4365     <span class="keyword">otherwise</span>
4366 <span class="keyword">end</span>
4367 
4368 <span class="comment">% if ismember(pref,prefs)</span>
4369 <span class="comment">%     setpref('VMT',pref,value)</span>
4370 <span class="comment">%</span>
4371 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4372 <span class="comment">%     guiprefs.(pref) = value;</span>
4373 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4374 <span class="comment">% end</span>
4375 
4376 <span class="comment">% [EOF] store_prefs</span>
4377 
4378 
4379 <span class="comment">% --------------------------------------------------------------------</span>
4380 <a name="_sub100" href="#_subfunctions" class="code">function initGUI(handles)</a>
4381 <span class="comment">% Initialize the UI controls in the GUI.</span>
4382 
4383 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4384 
4385 <span class="comment">% Set the name and version</span>
4386 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4387     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4388 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4389 
4390 <span class="comment">% Set the PLOT 1 axis labels</span>
4391 axes(handles.Plot1Shiptracks);
4392 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4393 xlabel(<span class="string">'UTM Easting (m)'</span>)
4394 ylabel(<span class="string">'UTM Northing (m)'</span>)
4395 box on
4396 grid on
4397 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4398 
4399 <span class="comment">%%%%%%%%%%%%</span>
4400 <span class="comment">% MENU BAR %</span>
4401 <span class="comment">%%%%%%%%%%%%</span>
4402 <span class="keyword">if</span> guiparams.english_units
4403     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4404     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4405 <span class="keyword">else</span>
4406     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4407     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4408 <span class="keyword">end</span>
4409 
4410 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4411     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4412     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4413 <span class="keyword">else</span>
4414     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4415     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4416 <span class="keyword">end</span>
4417 
4418 
4419 <span class="keyword">if</span> guiparams.print
4420     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4421     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4422     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4423     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4424 <span class="keyword">elseif</span> guiparams.presentation
4425     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4426     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4427     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4428     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4429 <span class="keyword">else</span>
4430 <span class="keyword">end</span>
4431 
4432 <span class="keyword">switch</span> guiparams.renderer
4433     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4434         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4435         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4436         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4437     <span class="keyword">case</span> <span class="string">'painters'</span>
4438         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4439         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4440         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4441     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4442         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4443         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4444         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4445 <span class="keyword">end</span>
4446 
4447 
4448 <span class="comment">%%%%%%%%%%%%%%%</span>
4449 <span class="comment">% DATA EXPORT %</span>
4450 <span class="comment">%%%%%%%%%%%%%%%</span>
4451 <span class="comment">% BathymetryPanel</span>
4452 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4453 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4454 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4455 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4456 
4457 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4458 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4459 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4460 <span class="comment">% PlanViewPanel</span>
4461 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4462 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4463 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4464 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4465 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4466 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4467 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4468 
4469 <span class="comment">%%%%%%%%%%%</span>
4470 <span class="comment">% OFFSETS %</span>
4471 <span class="comment">%%%%%%%%%%%</span>
4472 <span class="comment">% OffsetsPanel</span>
4473 set(handles.WaterSurfaceElevation,       <span class="string">'String'</span>,guiparams.water_surface_elevation)
4474 set(handles.BedElevation,                <span class="string">'String'</span>,guiparams.bed_elevation)
4475 set(handles.KMZVerticalOffset,           <span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
4476 
4477 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4478 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4479 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4480 <span class="comment">% ShiptracksPanel</span>
4481 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4482 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4483 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4484 
4485 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4486 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4487 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4488 <span class="comment">% CrossSectionsPanel</span>
4489 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4490     <span class="string">'Value'</span>, guiparams.idx_contour)
4491 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4492 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4493 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4494 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4495 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4496 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4497 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4498 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4499     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4500 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4501 
4502 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4503 
4504 <span class="comment">% [EOF] initGUI</span>
4505 
4506 
4507 <span class="comment">% --------------------------------------------------------------------</span>
4508 <a name="_sub101" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4509 
4510 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4511 
4512 <span class="keyword">switch</span> enable_state
4513     <span class="keyword">case</span> <span class="string">'init'</span>
4514         guiparams.gui_state = <span class="string">'init'</span>;
4515         set([handles.menuFile
4516             handles.menuOpen
4517             handles.menuOpenASCII
4518             handles.menuOpenMAT
4519             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4520         
4521         set([handles.toolbarLoadData
4522             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4523         set([handles.toolbarSaveMatFile
4524             handles.toolbarSaveBathymetry
4525             handles.toolbarSaveFigures
4526             handles.toolbarSaveExcel
4527             handles.toolbarPlottingParameters
4528             handles.toolbarProcessingParameters
4529             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4530         
4531         set([handles.DepthRangeMin
4532             handles.DepthRangeMax
4533             handles.VectorScalePlanView
4534             handles.VectorSpacingPlanview
4535             handles.SmoothingWindowSize
4536             handles.DisplayShoreline
4537             handles.AddBackground
4538             handles.PlotPlanView
4539             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4540         
4541         set([handles.WaterSurfaceElevation
4542             handles.BedElevation
4543             handles.KMZVerticalOffset
4544             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4545         
4546         set([handles.HorizontalGridNodeSpacing
4547             handles.VerticalGridNodeSpacing
4548             handles.PlotShiptracks
4549             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4550         
4551         set([handles.Contour
4552             handles.VerticalExaggeration
4553             handles.VectorScaleCrossSection
4554             handles.HorizontalVectorSpacing
4555             handles.VerticalVectorSpacing
4556             handles.HorizontalSmoothingWindow
4557             handles.VerticalSmoothingWindow
4558             handles.PlotSecondaryFlowVectors
4559             handles.SecondaryFlowVectorVariable
4560             handles.IncludeVerticalVelocity
4561             handles.PlotCrossSection
4562             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4563         
4564     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4565         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4566         set([handles.menuFile
4567             handles.menuOpen
4568             handles.menuOpenASCII
4569             handles.menuOpenMAT
4570             handles.menuSaveMAT
4571             handles.menuSaveTecplot
4572             handles.menuSaveKMZFile
4573             handles.menuParameters
4574             handles.menuPlottingParameters
4575             handles.menuMetric
4576             handles.menuEnglish
4577             handles.menuBathymetryExportSettings
4578             handles.menuExportMultibeamBathymetry
4579             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4580             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4581         
4582         set([handles.toolbarLoadData
4583             handles.toolbarSaveMatFile
4584             handles.toolbarSaveBathymetry
4585             handles.toolbarSaveExcel
4586             handles.toolbarSaveFigures
4587             handles.toolbarPlottingParameters
4588             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4589         set([handles.toolbarProcessingParameters
4590             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4591         
4592            
4593         set([handles.DepthRangeMin
4594             handles.DepthRangeMax
4595             handles.VectorScalePlanView
4596             handles.VectorSpacingPlanview
4597             handles.SmoothingWindowSize
4598             handles.DisplayShoreline
4599             handles.PlotPlanView
4600             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4601         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4602             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4603         <span class="keyword">else</span>
4604             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4605         <span class="keyword">end</span>
4606         
4607         set([handles.WaterSurfaceElevation
4608             handles.BedElevation
4609             handles.KMZVerticalOffset
4610             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4611         
4612         set([handles.HorizontalGridNodeSpacing
4613             handles.VerticalGridNodeSpacing
4614             handles.PlotShiptracks
4615             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4616         
4617         set([handles.Contour
4618             handles.VerticalExaggeration
4619             handles.VectorScaleCrossSection
4620             handles.HorizontalVectorSpacing
4621             handles.VerticalVectorSpacing
4622             handles.HorizontalSmoothingWindow
4623             handles.VerticalSmoothingWindow
4624             handles.PlotSecondaryFlowVectors
4625             handles.SecondaryFlowVectorVariable
4626             handles.IncludeVerticalVelocity
4627             handles.PlotCrossSection
4628             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4629     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4630         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4631         set([handles.menuFile
4632             handles.menuOpen
4633             handles.menuOpenASCII
4634             handles.menuOpenMAT
4635             handles.menuParameters
4636             handles.menuPlottingParameters
4637             handles.menuMetric
4638             handles.menuEnglish
4639             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4640         set([handles.menuSaveMAT
4641             handles.menuBathymetryExportSettings
4642             handles.menuExportMultibeamBathymetry
4643             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4644             handles.menuSaveKMZFile
4645             handles.menuSaveTecplot
4646             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4647         
4648         set([handles.toolbarLoadData
4649             handles.toolbarSaveFigures
4650             handles.toolbarPlottingParameters
4651             handles.toolbarSaveExcel
4652             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4653         set([handles.toolbarProcessingParameters
4654             handles.toolbarSaveMatFile
4655             handles.toolbarSaveBathymetry
4656             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4657         
4658         set([handles.DepthRangeMin
4659             handles.DepthRangeMax
4660             handles.VectorScalePlanView
4661             handles.VectorSpacingPlanview
4662             handles.SmoothingWindowSize
4663             handles.DisplayShoreline
4664             handles.PlotPlanView
4665             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4666         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4667             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4668         <span class="keyword">else</span>
4669             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4670         <span class="keyword">end</span>
4671         
4672         set([handles.HorizontalGridNodeSpacing
4673             handles.VerticalGridNodeSpacing
4674             handles.PlotShiptracks
4675             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4676         
4677         set([handles.Contour
4678             handles.VerticalExaggeration
4679             handles.VectorScaleCrossSection
4680             handles.HorizontalVectorSpacing
4681             handles.VerticalVectorSpacing
4682             handles.HorizontalSmoothingWindow
4683             handles.VerticalSmoothingWindow
4684             handles.PlotSecondaryFlowVectors
4685             handles.SecondaryFlowVectorVariable
4686             handles.IncludeVerticalVelocity
4687             handles.PlotCrossSection
4688             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4689     <span class="keyword">otherwise</span>
4690 <span class="keyword">end</span>
4691 
4692 <span class="comment">% Save Application Data</span>
4693 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4694 
4695 <span class="comment">% [EOF] set_enable</span>
4696 
4697 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4698 
4699 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4700 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4701 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4702 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4703 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4704 
4705 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4706 
4707 
4708 <span class="comment">% --------------------------------------------------------------------</span>
4709 <a name="_sub102" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4710     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4711 
4712 w = 500;
4713 h = 110;
4714 dx = 10;
4715 dy = 35;
4716 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4717 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4718     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4719     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4720     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4721     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4722     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4723     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4724     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4725     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4726     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4727     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4728 dialog_params.english_units               = english_units;
4729 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4730 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4731 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4732 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4733 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4734 
4735 <span class="comment">% Build the graphics:</span>
4736 <span class="comment">% -------------------</span>
4737 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4738     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4739     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4740     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4741 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4742     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4743     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4744     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4745     <span class="string">'Position'</span>,[15 35 100 22]);
4746 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4747     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4748     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4749     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4750     <span class="string">'Position'</span>,[15 10 100 22]);
4751 
4752 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4753     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4754     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4755     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4756 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4757     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4758     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4759     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4760     <span class="string">'Position'</span>,[15 35 100 22]);
4761 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4762     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4763     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4764     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4765     <span class="string">'Position'</span>,[15 10 100 22]);
4766 
4767 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4768     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4769     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4770     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4771 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4772     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4773     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4774     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4775     <span class="string">'Position'</span>,[15 35 100 22]);
4776 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4777     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4778     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4779     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4780     <span class="string">'Position'</span>,[15 10 100 22]);
4781 
4782 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4783     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4784     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4785     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4786     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4787 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4788     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4789     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4790     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4791     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4792 
4793 <span class="comment">% Update the UI controls:</span>
4794 <span class="comment">% -----------------------</span>
4795 <span class="keyword">if</span> dialog_params.english_units
4796     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4797     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4798 <span class="keyword">else</span>
4799     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4800     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4801 <span class="keyword">end</span>
4802 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4803     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4804     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4805 <span class="keyword">else</span>
4806     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4807     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4808 <span class="keyword">end</span>
4809 <span class="keyword">if</span> dialog_params.presentation
4810     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4811     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4812 <span class="keyword">else</span>
4813     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4814     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4815 <span class="keyword">end</span>
4816 
4817 <span class="comment">% Set the callbacks:</span>
4818 <span class="comment">% ------------------</span>
4819 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub108" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4820 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4821 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4822 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4823 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4824 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4825 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4826 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4827 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4828 
4829 <span class="comment">% Position the dialog and make it visible:</span>
4830 <span class="comment">% ----------------------------------------</span>
4831 fpos = get(hf,<span class="string">'Position'</span>);
4832 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4833 movegui(handles.Figure,dpos)
4834 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4835 
4836 <span class="comment">% Hold the dialog open:</span>
4837 <span class="comment">% ---------------------</span>
4838 waitfor(handles.OK)
4839 
4840 <span class="comment">% Return the outputs and close the dialog:</span>
4841 <span class="comment">% ----------------------------------------</span>
4842 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4843 english_units = dialog_params.english_units;
4844 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4845 plot_presentation_style =  dialog_params.presentation;
4846 plot_print_style =  dialog_params.print;
4847 
4848 delete(handles.Figure)
4849 
4850 <span class="comment">% [EOF] plotParametersDialog</span>
4851 
4852 
4853 <span class="comment">% --------------------------------------------------------------------</span>
4854 <a name="_sub103" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4855 
4856 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4857 <span class="keyword">switch</span> the_units
4858     <span class="keyword">case</span> <span class="string">'metric'</span>
4859         dialog_params.english_units = false;
4860         
4861         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4862         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4863     <span class="keyword">case</span> <span class="string">'english'</span>
4864         dialog_params.english_units = true;
4865         
4866         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4867         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4868     <span class="keyword">otherwise</span>
4869 <span class="keyword">end</span>
4870 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4871 
4872 <span class="comment">% [EOF] dialogUnits</span>
4873 
4874 <span class="comment">% --------------------------------------------------------------------</span>
4875 <a name="_sub104" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4876 
4877 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4878 <span class="keyword">switch</span> the_endpoints
4879     <span class="keyword">case</span> <span class="string">'auto'</span>
4880         dialog_params.set_cross_section_endpoints = false;
4881         
4882         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4883         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4884     <span class="keyword">case</span> <span class="string">'manual'</span>
4885         dialog_params.set_cross_section_endpoints = true;
4886         
4887         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4888         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4889     <span class="keyword">otherwise</span>
4890 <span class="keyword">end</span>
4891 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4892 
4893 <span class="comment">% [EOF] dialogEnpoints</span>
4894 
4895 <a name="_sub105" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4896 
4897 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4898 <span class="keyword">switch</span> the_style
4899     <span class="keyword">case</span> <span class="string">'presentation'</span>
4900         dialog_params.presentation  = true;
4901         dialog_params.print         = false;
4902         
4903         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4904         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4905     <span class="keyword">case</span> <span class="string">'print'</span>
4906         dialog_params.presentation  = false;
4907         dialog_params.print         = true;
4908         
4909         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4910         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4911     <span class="keyword">otherwise</span>
4912 <span class="keyword">end</span>
4913 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4914 
4915 <span class="comment">% [EOF] dialogEnpoints</span>
4916 
4917 <span class="comment">% --------------------------------------------------------------------</span>
4918 <a name="_sub106" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4919 
4920 delete(h_OK)
4921 
4922 <span class="comment">% [EOF] dialogOK</span>
4923 
4924 <span class="comment">% --------------------------------------------------------------------</span>
4925 <a name="_sub107" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4926 <span class="comment">% Return the original inputs</span>
4927 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4928 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4929 delete(handles.OK)
4930 
4931 <span class="comment">% [EOF] dialogCancel</span>
4932 
4933 <span class="comment">% --------------------------------------------------------------------</span>
4934 <a name="_sub108" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4935 
4936 delete(h_OK)
4937 
4938 <span class="comment">% [EOF] dialogCloseReq</span>
4939 
4940 <a name="_sub109" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4941     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4942 w = 230;
4943 h = 245;
4944 dx = 10;
4945 dy = 35;
4946 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4947 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4948     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4949     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4950     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4951     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4952     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4953     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4954     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4955     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4956     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4957     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4958 dialog_params.beam_angle             = beam_angle;
4959 dialog_params.magnetic_variation     = magnetic_variation;
4960 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4961     dialog_params.wse                = <span class="string">'tide'</span>;
4962     wse_string                       = <span class="string">'tide'</span>;
4963 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4964     dialog_params.wse                = <span class="string">'tide'</span>;
4965     wse_string                       = <span class="string">'tide'</span>;
4966 <span class="keyword">else</span>
4967     dialog_params.wse                = wse;
4968     wse_string                       = num2str(wse);
4969 <span class="keyword">end</span>
4970 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4971 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4972 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4973 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4974 
4975 <span class="comment">% Build the graphics:</span>
4976 <span class="comment">% -------------------</span>
4977 ph = 150;
4978 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4979     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4980     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4981     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4982 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4983     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4984     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4985     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4986     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4987     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4988     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4989 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4990     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4991     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4992     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4993     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4994     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4995     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4996 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4997     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4998     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4999     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5000     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5001     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5002     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
5003 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5004     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5005     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5006     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
5007     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5008     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5009     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
5010 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5011     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5012     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
5013     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5014     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5015     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5016     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
5017 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5018     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5019     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5020     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
5021     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5022     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5023     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
5024 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5025     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5026     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5027     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
5028     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
5029 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5030     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5031     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
5032     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5033     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
5034 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5035     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5036     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5037     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5038     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5039 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5040     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5041     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5042     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5043     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5044 
5045 <span class="comment">% Update the UI controls:</span>
5046 <span class="comment">% -----------------------</span>
5047 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
5048 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
5049 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
5050 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
5051 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
5052 
5053 <span class="comment">% Set the callbacks:</span>
5054 <span class="comment">% ------------------</span>
5055 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub108" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5056 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5057 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5058 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5059 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5060 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5061 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
5062 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
5063 
5064 <span class="comment">% Position the dialog and make it visible:</span>
5065 <span class="comment">% ----------------------------------------</span>
5066 fpos = get(hf,<span class="string">'Position'</span>);
5067 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5068 movegui(handles.Figure,dpos)
5069 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5070 
5071 <span class="comment">% Hold the dialog open:</span>
5072 <span class="comment">% ---------------------</span>
5073 waitfor(handles.OK)
5074 
5075 <span class="comment">% Return the outputs and close the dialog:</span>
5076 <span class="comment">% ----------------------------------------</span>
5077 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5078 beam_angle              = dialog_params.beam_angle;
5079 magnetic_variation      = dialog_params.magnetic_variation;
5080 wse                     = dialog_params.wse;
5081 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
5082 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
5083 
5084 delete(handles.Figure)
5085 
5086 <span class="comment">% [EOF] exportSettingsDialog</span>
5087 
5088 <span class="comment">% --------------------------------------------------------------------</span>
5089 <a name="_sub110" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
5090 
5091 <span class="comment">% Grab the current data</span>
5092 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5093 
5094 <span class="comment">% Set it according to the dialog box values</span>
5095 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
5096 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
5097 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
5098 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
5099 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
5100 
5101 <span class="comment">% Re-store the application data</span>
5102 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5103 
5104 <span class="comment">% [EOF] dialogExportSettings</span>
5105 
5106 <a name="_sub111" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
5107 
5108 w = 230;
5109 h = 200;
5110 dx = 10;
5111 dy = 35;
5112 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
5113 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
5114     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
5115     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5116     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
5117     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
5118     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5119     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5120     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5121     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
5122     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5123     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
5124 dialog_params.figure_names               = figure_names;
5125 dialog_params.selected_figures           = <span class="string">''</span>;
5126 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5127 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5128 
5129 <span class="comment">% Build the graphics:</span>
5130 <span class="comment">% -------------------</span>
5131 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5132     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
5133     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5134     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5135 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
5136     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
5137     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
5138     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
5139     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
5140     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
5141     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5142     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5143 
5144 
5145 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5146     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5147     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5148     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5149     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5150 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5151     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5152     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5153     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5154     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5155 
5156 <span class="comment">% Update the UI controls:</span>
5157 <span class="comment">% -----------------------</span>
5158 
5159 
5160 <span class="comment">% Set the callbacks:</span>
5161 <span class="comment">% ------------------</span>
5162 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub108" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5163 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub112" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5164 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5165 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5166 
5167 <span class="comment">% Position the dialog and make it visible:</span>
5168 <span class="comment">% ----------------------------------------</span>
5169 fpos = get(hf,<span class="string">'Position'</span>);
5170 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5171 movegui(handles.Figure,dpos)
5172 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5173 
5174 <span class="comment">% Hold the dialog open:</span>
5175 <span class="comment">% ---------------------</span>
5176 waitfor(handles.OK)
5177 
5178 <span class="comment">% Return the outputs and close the dialog:</span>
5179 <span class="comment">% ----------------------------------------</span>
5180 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5181 selected_figures = dialog_params.selected_figures;
5182 
5183 delete(handles.Figure)
5184 
5185 <span class="comment">% [EOF] openFiguresDialog</span>
5186 
5187 <span class="comment">% --------------------------------------------------------------------</span>
5188 <a name="_sub112" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5189 
5190 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5191 
5192 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5193 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5194 selected     = fig_names(idx_selected);
5195 dialog_params.selected_figures = selected;
5196 
5197 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5198 
5199 
5200 
5201 <span class="comment">% --------------------------------------------------------------------</span>
5202 <a name="_sub113" href="#_subfunctions" class="code">function icons = getIcons</a>
5203 
5204 <span class="comment">% Load data</span>
5205 idx = 1;
5206 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5207     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5208     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5209     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5210     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5211     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5212     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5213     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5214     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5215     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5216     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5217     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5218     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5219     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5220     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5221     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5222     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5223 
5224 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5225     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5226     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5227     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5228     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5229     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5230     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5231     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5232     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5233     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5234     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5235     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5236     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5237     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5238     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5239     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5240     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5241 
5242 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5243     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5244     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5245     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5246     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5247     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5248     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5249     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5250     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5251     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5252     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5253     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5254     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5255     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5256     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5257     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5258     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5259 
5260 <span class="comment">% Save data</span>
5261 idx = idx+1;
5262 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5263     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5264     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5265     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5266     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5267     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5268     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5269     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5270     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5271     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5272     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5273     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5274     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5275     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5276     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5277     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5278     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5279 
5280 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5281     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5282     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5283     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5284     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5285     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5286     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5287     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5288     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5289     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5290     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5291     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5292     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5293     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5294     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5295     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5296     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5297 
5298 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5299     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5300     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5301     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5302     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5303     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5304     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5305     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5306     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5307     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5308     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5309     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5310     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5311     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5312     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5313     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5314     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5315 
5316 <span class="comment">% Plotting parameters</span>
5317 idx = idx+1;
5318 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5319     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5320     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5321     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5322     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5323     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5324     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5325     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5326     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5327     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5328     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5329     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5330     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5331     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5332     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5333     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5334     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5335 
5336 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5337     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5338     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5339     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5340     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5341     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5342     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5343     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5344     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5345     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5346     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5347     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5348     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5349     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5350     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5351     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5352     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5353 
5354 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5355     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5356     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5357     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5358     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5359     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5360     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5361     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5362     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5363     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5364     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5365     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5366     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5367     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5368     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5369     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5370     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5371 
5372 <span class="comment">% Processing parameters</span>
5373 idx = idx+1;
5374 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5375     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5376     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5377     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5378     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5379     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5380     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5381     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5382     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5383     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5384     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5385     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5386     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5387     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5388     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5389     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5390     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5391 
5392 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5393     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5394     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5395     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5396     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5397     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5398     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5399     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5400     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5401     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5402     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5403     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5404     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5405     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5406     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5407     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5408     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5409 
5410 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5411     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5412     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5413     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5414     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5415     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5416     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5417     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5418     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5419     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5420     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5421     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5422     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5423     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5424     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5425     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5426     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5427 
5428 <span class="comment">% Export bathymetry dialog</span>
5429 idx = idx+1;
5430 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5431     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5432     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5433     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5434     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5435     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5436     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5437     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5438     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5439     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5440     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5441     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5442     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5443     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5444     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5445     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5446     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5447     ]/255;
5448 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5449     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5450     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5451     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5452     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5453     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5454     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5455     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5456     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5457     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5458     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5459     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5460     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5461     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5462     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5463     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5464     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5465     ]/255;
5466 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5467     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5468     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5469     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5470     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5471     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5472     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5473     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5474     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5475     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5476     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5477     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5478     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5479     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5480     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5481     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5482     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5483     ]/255;
5484 
5485 <span class="comment">% Export Figures Dialog</span>
5486 idx = idx + 1;
5487 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5488     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5489     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5490     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5491     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5492     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5493     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5494     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5495     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5496     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5497     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5498     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5499     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5500     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5501     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5502     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5503 
5504 
5505 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5506     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5507     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5508     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5509     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5510     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5511     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5512     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5513     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5514     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5515     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5516     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5517     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5518     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5519     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5520     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5521 
5522 
5523 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5524     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5525     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5526     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5527     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5528     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5529     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5530     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5531     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5532     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5533     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5534     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5535     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5536     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5537     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5538     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5539 
5540 <span class="comment">% Export Excel File</span>
5541 idx = idx + 1;
5542 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5543     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5544    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5545    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5546    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5547    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5548    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5549    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5550    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5551    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5552    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5553    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5554    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5555    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5556    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5557    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5558     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5559 
5560 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5561     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5562    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5563    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5564    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5565    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5566    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5567    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5568    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5569    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5570    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5571    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5572    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5573    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5574    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5575    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5576     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5577 
5578 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5579     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5580    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5581    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5582    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5583    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5584    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5585    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5586    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5587    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5588    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5589    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5590    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5591    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5592    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5593    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5594     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5595 
5596 <span class="comment">% Zoom In</span>
5597 idx = idx + 1;
5598 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5599     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5600 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5601     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5602 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5603     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5604 
5605 <span class="comment">% Zoom Out</span>
5606 idx = idx + 1;
5607 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5608     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5609 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5610     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5611 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5612     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5613 
5614 <span class="comment">% Pan</span>
5615 idx = idx + 1;
5616 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5617     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5618 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5619     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5620 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5621     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5622 <span class="comment">% [EOF] getIcons</span>
5623 
5624 <a name="_sub114" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5625 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5626 
5627 <span class="comment">% Check for any stored prefs</span>
5628 <span class="comment">% --------------------------</span>
5629 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5630 guiprefs = getpref(<span class="string">'VMT'</span>);
5631 
5632 <span class="comment">% Organized by GUI panels</span>
5633 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5634 <span class="comment">% SHIPTRACKS PLOT %</span>
5635 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5636 guiparams.horizontal_grid_node_spacing       = 1.0;
5637 guiparams.vertical_grid_node_spacing         = 0.4;
5638 
5639 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5640 <span class="comment">% CROSS SECTION PLOT %</span>
5641 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5642 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5643 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5644 guiparams.idx_contour                        = 1;
5645 guiparams.vertical_exaggeration              = 10;
5646 guiparams.vector_scale_cross_section         = 0.2;
5647 guiparams.horizontal_vector_spacing          = 1;
5648 guiparams.vertical_vector_spacing            = 1;
5649 guiparams.horizontal_smoothing_window        = 1;
5650 guiparams.vertical_smoothing_window          = 1;
5651 guiparams.plot_secondary_flow_vectors        = true;
5652 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5653 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5654 guiparams.idx_secondary_flow_vector_variable = 1;
5655 guiparams.include_vertical_velocity          = true;
5656 
5657 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5658 <span class="comment">% PLAN VIEW PLOT %</span>
5659 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5660 guiparams.depth_range_min                    = 0;
5661 guiparams.depth_range_max                    = inf;
5662 guiparams.vector_scale_plan_view             = 1;
5663 guiparams.vector_spacing_plan_view           = 1;
5664 guiparams.smoothing_window_size              = 1;
5665 guiparams.display_shoreline                  = false;
5666 guiparams.add_background                     = false;
5667 
5668 <span class="comment">%%%%%%%%%%%</span>
5669 <span class="comment">% OFFSETS %</span>
5670 <span class="comment">%%%%%%%%%%%</span>
5671 guiparams.water_surface_elevation            = 0.0;
5672 guiparams.bed_elevation                      = 0.0;
5673 guiparams.KMZ_vertical_offset                = 0.0;
5674 
5675 <span class="comment">%%%%%%%%%%%%%%%</span>
5676 <span class="comment">% DATA EXPORT %</span>
5677 <span class="comment">%%%%%%%%%%%%%%%</span>
5678 guiparams.beam_angle                         = 20.0;
5679 guiparams.magnetic_variation                 = 0.0;
5680 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5681 guiparams.load_wse_tide_file                 = false;
5682 guiparams.output_auxiliary_data              = false;
5683 
5684 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5685 <span class="comment">% Contour variables %</span>
5686 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5687 idx = 1;
5688 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5689 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5690 idx = idx + 1;
5691 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5692 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5693 idx = idx + 1;
5694 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5695 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5696 idx = idx + 1;
5697 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5698 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5699 idx = idx + 1;
5700 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5701 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5702 idx = idx + 1;
5703 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5704 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5705 idx = idx + 1;
5706 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5707 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5708 idx = idx + 1;
5709 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5710 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5711 idx = idx + 1;
5712 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5713 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5714 idx = idx + 1;
5715 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5716 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5717 idx = idx + 1;
5718 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5719 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5720 idx = idx + 1;
5721 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5722 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5723 idx = idx + 1;
5724 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5725 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5726 idx = idx + 1;
5727 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5728 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5729 idx = idx + 1;
5730 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5731 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5732 idx = idx + 1;
5733 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5734 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5735 idx = idx + 1;
5736 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5737 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5738 idx = idx + 1;
5739 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5740 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5741 idx = idx + 1;
5742 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5743 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5744 idx = idx + 1;
5745 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5746 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5747 
5748 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5749 
5750 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5751 <span class="comment">% Secondary Flow Vector Variables %</span>
5752 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5753 idx = 1;
5754 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5755 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5756 idx = idx + 1;
5757 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5758 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5759 idx = idx + 1;
5760 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5761 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5762 idx = idx + 1;
5763 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5764 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5765 idx = idx + 1;
5766 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5767 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5768 
5769 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5770     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5771 
5772 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5773 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5774 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5775 <span class="comment">% Menu bar options</span>
5776 guiparams.presentation                       = true;
5777 guiparams.print                              = false;
5778 guiparams.set_cross_section_endpoints        = false;
5779 guiparams.unit_discharge_correction          = false;
5780 
5781 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5782     <span class="keyword">switch</span> guiprefs.units
5783         <span class="keyword">case</span> <span class="string">'metric'</span>
5784             guiparams.english_units          = false;
5785         <span class="keyword">case</span> <span class="string">'english'</span>
5786             guiparams.english_units          = true;
5787     <span class="keyword">end</span>
5788 <span class="keyword">else</span>
5789     guiparams.english_units                  = false;
5790 <span class="keyword">end</span>
5791 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5792     <span class="keyword">switch</span> guiprefs.plotref
5793         <span class="keyword">case</span> <span class="string">'dfs'</span>
5794             guiparams.plotref                 = <span class="string">'dfs'</span>;
5795         <span class="keyword">case</span> <span class="string">'hab'</span>
5796             guiparams.plotref                 = <span class="string">'hab'</span>;
5797     <span class="keyword">end</span>
5798 <span class="keyword">else</span>
5799     guiparams.plotref                         = <span class="string">'dfs'</span>;
5800 <span class="keyword">end</span>
5801 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5802 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5803 
5804 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5805     guiparams.renderer                       = guiprefs.renderer;
5806 <span class="keyword">else</span>
5807     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5808 <span class="keyword">end</span>
5809 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5810 <span class="comment">% guiparams.plot_planview                      = false;</span>
5811 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5812 
5813 <span class="comment">% File location defaults</span>
5814 guiparams.ascii_path                        = pwd;
5815 guiparams.ascii_file                        = <span class="string">''</span>;
5816 guiparams.mat_path                          = pwd;
5817 guiparams.mat_file                          = <span class="string">''</span>;
5818 guiparams.tecplot_path                      = pwd;
5819 guiparams.tecplot_file                      = <span class="string">''</span>;
5820 guiparams.kmz_path                          = pwd;
5821 guiparams.kmz_file                          = <span class="string">''</span>;
5822 guiparams.multibeambathymetry_path          = pwd;
5823 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5824 guiparams.log_path                          = pwd;
5825 guiparams.log_file                          = <span class="string">''</span>;
5826 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5827 <span class="comment">% application</span>
5828 <span class="keyword">if</span> isdeployed 
5829     guiparams.has_mapping_toolbox           = true;
5830 <span class="keyword">else</span>
5831     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5832         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5833 <span class="keyword">end</span>
5834 
5835 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5836 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5837 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5838 guiparams.z                      = [];
5839 guiparams.A                      = [];
5840 guiparams.V                      = [];
5841 guiparams.Map                    = [];
5842 guiparams.savefile               = [];
5843 guiparams.iric_anv_planview_data = [];
5844 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5845 <span class="comment">% guiparams.zmax = [];</span>
5846 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5847 guiparams.data_folder = <span class="string">''</span>;
5848 guiparams.data_files  = {<span class="string">''</span>};
5849 guiparams.gui_state   = <span class="string">'init'</span>;
5850 
5851 <span class="comment">% [EOF] createGUIparams</span>
5852 
5853 <a name="_sub115" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5854 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5855 
5856 <a name="_sub116" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5857 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5858 
5859 <span class="comment">% [EOF] VMT</span>
5860 
5861 
5862 
5863 
5864 
5865 <span class="comment">% --- Hidden keyboard commands</span>
5866 <a name="_sub117" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5867 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5868 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5869 <span class="comment">%</span>
5870 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5871 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5872 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5873 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5874 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5875 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5876 
5877 in1 = eventdata.Modifier; 
5878 in2 = eventdata.Key;
5879 
5880 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5881     input = [in1{:} in2];
5882 <span class="keyword">else</span>
5883     input = in2;
5884 <span class="keyword">end</span>
5885 
5886 <span class="keyword">switch</span> input
5887     <span class="comment">% Hidden SonTek M9 support</span>
5888     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5889         msgtxt = {<span class="keyword">...</span>
5890             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5891             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5892             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5893             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5894             <span class="string">''</span>;<span class="keyword">...</span>
5895             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5896             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5897             <span class="string">'PROVISIONAL at best.'</span>};
5898         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5899         
5900         <span class="comment">% Get the Application data:</span>
5901         <span class="comment">% -------------------------</span>
5902         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5903         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5904         
5905         <span class="comment">% Ask the user to select files:</span>
5906         <span class="comment">% -----------------------------</span>
5907         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5908         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5909         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5910             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5911         <span class="keyword">else</span>
5912             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5913         <span class="keyword">end</span>
5914         [filename,pathname] = <span class="keyword">...</span>
5915             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5916             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5917             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5918         
5919         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5920             guiparams.data_folder = pathname;
5921             <span class="keyword">if</span> ischar(filename)
5922                 filename = {filename};
5923             <span class="keyword">end</span>
5924             guiparams.data_files = filename;
5925             guiparams.mat_file = <span class="string">''</span>;
5926             
5927             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5928             
5929             
5930             
5931             <span class="comment">% Update the preferences:</span>
5932             <span class="comment">% -----------------------</span>
5933             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5934             guiprefs.ascii_path = pathname;
5935             guiprefs.ascii_file = filename;
5936             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5937             <a href="#_sub99" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5938             
5939             <span class="comment">% Push messages to Log Window:</span>
5940             <span class="comment">% ----------------------------</span>
5941             log_text = {<span class="keyword">...</span>
5942                 <span class="string">''</span>;<span class="keyword">...</span>
5943                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5944                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5945                 guiparams.data_folder;
5946                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5947                 char(filename)};
5948             statusLogging(handles.LogWindow, log_text)
5949             
5950             <span class="comment">% Read the file(s)</span>
5951             <span class="comment">% ----------------</span>
5952             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5953             
5954             [~,~,savefile,A,z] = <span class="keyword">...</span>
5955                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5956             guiparams.savefile = savefile;
5957             guiparams.A        = A;
5958             guiparams.z        = z;
5959             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5960             
5961             
5962             <span class="comment">% Update the GUI:</span>
5963             <span class="comment">% ---------------</span>
5964             <a href="#_sub101" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5965         <span class="keyword">end</span>  
5966     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5967         SontekMAT2KML;
5968     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5969         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5970         
5971     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5972         VMT_BuildCustomFlatFile;
5973     <span class="keyword">otherwise</span>
5974         <span class="comment">%disp(input)</span>
5975 <span class="keyword">end</span>
5976 
5977 
5978 
5979 
5980 
5981 
5982</pre></div>
<hr><address>Generated on Thu 10-Dec-2015 11:32:17 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>