<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function WSE_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub97" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub98" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub99" class="code">function initGUI(handles)</a></li><li><a href="#_sub100" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub101" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub102" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub103" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub104" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub105" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub106" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub108" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub109" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub110" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub111" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub112" class="code">function icons = getIcons</a></li><li><a href="#_sub113" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub114" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub116" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub96" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub97" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub113" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.07'</span>; <span class="string">'r20150608'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub53" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub99" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub55" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub56" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub64" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub65" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub110" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.wse;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.wse = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.wse = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">end</span>
0651 <span class="comment">%  [EOF] loadTideFile</span>
0652 
0653 <span class="comment">% --------------------------------------------------------------------</span>
0654 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0655 <a href="#_sub66" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0656 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0657 
0658 
0659 <span class="comment">% --------------------------------------------------------------------</span>
0660 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0661 
0662 <span class="comment">% Get the Application Data:</span>
0663 <span class="comment">% -------------------------</span>
0664 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0665 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0666 PVdata    = guiparams.iric_anv_planview_data;
0667 iric_path = guiprefs.iric_path;
0668 iric_file = guiprefs.iric_file;
0669 
0670 <span class="comment">% Is there any planview data?</span>
0671 <span class="keyword">if</span> isempty(PVdata)
0672     <span class="comment">% Nothing to do, warn user</span>
0673     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0674     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0675 <span class="keyword">else</span>
0676     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0677     <span class="comment">% and smoothing (for iRiC)</span>
0678     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0679     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0680         fullfile(iric_path,iric_file));
0681     
0682     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0683         outfile = fullfile(iric_path,iric_file);
0684         log_text = vertcat(log_text,{outfile});
0685         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0686         outcount = fprintf(ofid,<span class="keyword">...</span>
0687             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0688         fclose(ofid);
0689     <span class="keyword">else</span>
0690         <span class="comment">% Return default iric_path and iric_file</span>
0691         iric_path = guiprefs.iric_path;
0692         iric_file = guiprefs.iric_file;
0693     <span class="keyword">end</span>
0694 <span class="keyword">end</span>
0695 
0696 <span class="comment">% Push messages to Log Window:</span>
0697 <span class="comment">% ----------------------------</span>
0698 statusLogging(handles.LogWindow, log_text)
0699 
0700 <span class="comment">% Store the persistent preferences:</span>
0701 <span class="comment">% ---------------------------------</span>
0702 guiprefs.iric_file = iric_file;
0703 guiprefs.iric_path = iric_path;
0704 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0705 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0706 
0707 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0708 
0709 <span class="comment">% --------------------------------------------------------------------</span>
0710 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0711 <span class="comment">% Get the Application Data:</span>
0712 <span class="comment">% -------------------------</span>
0713 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0714 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0715 excel_path  = guiprefs.excel_path;
0716 excel_file  = guiprefs.excel_file;
0717 
0718 <span class="comment">% Push messages to Log Window:</span>
0719 <span class="comment">% ----------------------------</span>
0720 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0721 statusLogging(handles.LogWindow, log_text)
0722 
0723 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0724 <span class="comment">% data.</span>
0725 <span class="keyword">if</span> iscell(guiparams.mat_file)
0726     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0727     <a href="#_sub61" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0728     <span class="comment">% Refresh the Application Data:</span>
0729     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0730     z           = guiparams.z;
0731     A           = guiparams.A;
0732     V           = guiparams.V;
0733     Map         = guiparams.Map;
0734     wse         = guiparams.wse;
0735     PVdata      = guiparams.iric_anv_planview_data;
0736     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0737         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0738     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0739         fullfile(excel_path,excel_file));
0740     
0741     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0742         outfile = fullfile(excel_path,excel_file);
0743         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0744         
0745     <span class="keyword">else</span>
0746         <span class="comment">% Return default excel_path and excel_file</span>
0747         excel_path = guiprefs.excel_path;
0748         excel_file = guiprefs.excel_file;
0749         outfile = fullfile(excel_path,excel_file);
0750         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0751     <span class="keyword">end</span>
0752     
0753     <span class="comment">% Delete the old file if it exists</span>
0754     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0755         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0756             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0757             <span class="string">'already exists. Overwriting file...'</span>});
0758         delete(outfile)
0759     <span class="keyword">end</span>
0760     
0761     <span class="comment">% Save DAV data to an Excel File</span>
0762     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0763     vmin = num2str(guiparams.depth_range_min);
0764     vmax = num2str(guiparams.depth_range_max);
0765     pvheaders = {<span class="keyword">...</span>
0766         <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0767         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0768         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0769         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0770     
0771 
0772     <span class="comment">% Initialize Variables</span>
0773     pvdata = []; Dist = [];
0774     X = []; Y = []; E = [];
0775     Ve = []; Vn =[]; Vm = []; Vd = [];
0776     
0777     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0778     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0779         <span class="comment">% Load current MAT-file</span>
0780         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0781         
0782         <span class="comment">% Location and Bathy</span>
0783         X = [X V.mcsX(1,:)];
0784         Y = [Y V.mcsY(1,:)];
0785         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0786         E = [E V.mcsBedElev];
0787         
0788         <span class="comment">% Build layer-averaged velocities</span>
0789         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0790         V.mcsX(indx,:) = nan;
0791         V.mcsY(indx,:) = nan;
0792         V.mcsEast(indx,:) = nan;
0793         V.mcsNorth(indx,:) = nan;
0794         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0795         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0796         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0797         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0798         
0799         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0800     <span class="keyword">end</span>
0801     
0802     <span class="comment">% Put output into 1 matrix</span>
0803     pvdata = [<span class="keyword">...</span>
0804         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0805         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0806         ];
0807     pvdata(isnan(pvdata)) = -9999;
0808     
0809     <span class="comment">% Create table and write to Excel</span>
0810     pvout = num2cell(pvdata');
0811     pvout = vertcat(pvheaders,pvout);
0812     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0813     
0814     <span class="comment">% Close out waitbar</span>
0815     waitbar(1,hwait)
0816     delete(hwait)
0817     
0818     <span class="comment">% Push messages to Log Window:</span>
0819     <span class="comment">% ----------------------------</span>
0820     statusLogging(handles.LogWindow, log_text)
0821 <span class="keyword">else</span>
0822     
0823     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0824     <a href="#_sub61" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0825     <a href="#_sub62" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0826     <span class="comment">% Refresh the Application Data:</span>
0827     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0828     z           = guiparams.z;
0829     A           = guiparams.A;
0830     V           = guiparams.V;
0831     Map         = guiparams.Map;
0832     wse         = guiparams.wse;
0833     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0834                                                     <span class="comment">% Planview Plot exactly</span>
0835         
0836     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0837     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0838         fullfile(excel_path,excel_file));
0839     
0840     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0841         outfile = fullfile(excel_path,excel_file);
0842         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0843         
0844         <span class="comment">% Delete the old file if it exists</span>
0845         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0846             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0847                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0848                 <span class="string">'already exists. Overwriting file...'</span>});
0849             delete(outfile)
0850         <span class="keyword">end</span>
0851         
0852         <span class="comment">% Push messages to Log Window:</span>
0853         <span class="comment">% ----------------------------</span>
0854         statusLogging(handles.LogWindow, log_text)
0855         
0856         <span class="comment">% Save MCS Summary to an Excel File</span>
0857         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0858         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0859         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0860         waitbar(1/5,hwait)
0861         <span class="keyword">if</span> isempty(guiparams.data_files(:)) <span class="comment">% Loaded MAT file</span>
0862             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0863             sout = {guiparams.mat_file};
0864         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0865             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0866             sout = guiparams.data_files';
0867         <span class="keyword">end</span>
0868         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0869         waitbar(2/7,hwait)
0870         sout = {<span class="keyword">...</span>
0871             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0872             <span class="string">'VMT '</span> guiparams.vmt_version <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0873             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0875             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0877             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0878             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0879             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0880             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0881             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0882             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0883             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0884             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0885             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0886             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0887             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0888             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0889             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0890             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0891             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0892             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0893             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0894             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0895             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0896             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0897             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0898             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0899             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0900             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0901             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0902             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0903             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0904             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0905             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0906             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0907             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0908             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0909             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0910             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0911             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0912             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0913             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0914             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0915             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0916             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0917             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0918             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0919             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0920             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0921             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0922             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0923             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0924             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0925             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0926             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0927             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0928             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0929             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0930             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>
0931             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0932             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0933             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0934             };
0935         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
0936         waitbar(3/7,hwait)
0937         
0938         <span class="comment">% Save DAV data to an Excel File</span>
0939         vmin = num2str(guiparams.depth_range_min);
0940         vmax = num2str(guiparams.depth_range_max);
0941         pvheaders = {<span class="keyword">...</span>
0942             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0943             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0944             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0945             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0946         
0947         <span class="comment">% Create block style matrix of all processed data</span>
0948         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0949         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
0950         <span class="comment">% layer-averaging applied</span>
0951         pvdata = [];
0952         
0953         <span class="comment">% Stationing from LEFT bank</span>
0954         Dist = V.mcsDist;
0955         
0956         <span class="comment">% Build bathy data matrix</span>
0957         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
0958         
0959         <span class="comment">% Build layer-averaged velocities</span>
0960         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0961         V.mcsX(indx,:) = nan;
0962         V.mcsY(indx,:) = nan;
0963         V.mcsEast(indx,:) = nan;
0964         V.mcsNorth(indx,:) = nan;
0965         pvdata = [<span class="keyword">...</span>
0966             pvdata;<span class="keyword">...</span>
0967             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
0968             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
0969             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
0970             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0971         pvdata(isnan(pvdata)) = -9999;
0972         pvout = num2cell(pvdata');
0973         pvout = vertcat(pvheaders,pvout);
0974         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0975         waitbar(4/7,hwait)
0976         
0977         <span class="comment">% Save MCS data to an Excel File</span>
0978         <span class="comment">% This does not include the smoothed data results from the plots.</span>
0979         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
0980         MCSheaders = {<span class="keyword">...</span>
0981             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
0982             <span class="string">'UTM_North'</span><span class="keyword">...</span>
0983             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
0984             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
0985             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
0986             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
0987             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
0988             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
0989             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
0990             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
0991             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
0992             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
0993             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0994             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
0995             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
0996             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
0997         
0998         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
0999         MCSdata = [<span class="keyword">...</span>
1000             V.mcsX(:)<span class="keyword">...</span>
1001             V.mcsY(:)<span class="keyword">...</span>
1002             V.mcsDist(:)<span class="keyword">...</span>
1003             vectorized_bed(:)<span class="keyword">...</span>
1004             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1005             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1006             V.mcsEast(:)<span class="keyword">...</span>
1007             V.mcsNorth(:)<span class="keyword">...</span>
1008             V.mcsVert(:)<span class="keyword">...</span>
1009             V.mcsMag(:)<span class="keyword">...</span>
1010             V.mcsDir(:)<span class="keyword">...</span>
1011             V.u(:)<span class="keyword">...</span>
1012             V.v(:)<span class="keyword">...</span>
1013             V.vp(:)<span class="keyword">...</span>
1014             V.vs(:)<span class="keyword">...</span>
1015             V.Roz.up(:)<span class="keyword">...</span>
1016             V.Roz.us(:)];
1017         MCSdata(isnan(MCSdata)) = -9999;
1018         
1019         MCSout = vertcat(MCSheaders,num2cell(MCSdata));
1020         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1021         waitbar(5/7,hwait)
1022                 
1023         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1024         <span class="comment">% results</span>
1025         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1026         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1027         PVheaders = {<span class="keyword">...</span>
1028             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
1029             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1030             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1031             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1032         PVtable = [<span class="keyword">...</span>
1033             PVdata.outmat(1,:);<span class="keyword">...</span>
1034             PVdata.outmat(2,:);<span class="keyword">...</span>
1035             PVDist;<span class="keyword">...</span>
1036             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1037             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1038             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1039             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1040         PVtable = (sortrows(PVtable',3))';
1041         PVtable(isnan(PVtable)) = -9999;
1042         PVout = num2cell(PVtable');
1043         PVout = vertcat(PVheaders,PVout);
1044         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1045         waitbar(6/7,hwait)
1046         
1047         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1048         <span class="comment">% results</span>
1049         <span class="comment">% Distance is from the LEFT bank</span>
1050         <span class="comment">% Doesn't include the reference vector</span>
1051         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1052         dist    = guiparams.mcsQuivers(1:end-1,1);
1053         depth   = guiparams.mcsQuivers(1:end-1,2);
1054         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1055         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1056         
1057         <span class="comment">% Compute an UTM coordinate for the vector</span>
1058         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1059         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1060         
1061         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1062         <span class="keyword">switch</span> guiparams.contour
1063             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1064                 wtp=[<span class="string">'V.uSmooth'</span>];
1065             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1066                 wtp=[<span class="string">'V.vSmooth'</span>];
1067             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1068                 wtp=[<span class="string">'V.wSmooth'</span>];
1069             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1070                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1071             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1072                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1073             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1074                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1075             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1076                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1077             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1078                 wtp=[<span class="string">'V.vpSmooth'</span>];
1079             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1080                 wtp=[<span class="string">'V.vsSmooth'</span>];
1081             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1082                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1083             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1084                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1085             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1086                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1087             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1088                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1089             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1090                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1091             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1092                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1093             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1094                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1095             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1096                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1097             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1098                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1099             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1100                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1101             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1102                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1103         <span class="keyword">end</span>
1104         Ucomp = eval(wtp);
1105         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1106         
1107         <span class="comment">% Save MCS data to an Excel File</span>
1108         <span class="comment">% This includes the smoothed data results from the plots.</span>
1109         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1110         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1111         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1112         mcsheaders = {<span class="keyword">...</span>
1113             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1114             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1115             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1116             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1117             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1118             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1119             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1120             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1121             };
1122         mcsdata = [<span class="keyword">...</span>
1123             pUTMx(:)<span class="keyword">...</span>
1124             pUTMy(:)<span class="keyword">...</span>
1125             dist(:)<span class="keyword">...</span>
1126             depth(:)<span class="keyword">...</span>
1127             ucomp(:)<span class="keyword">...</span>
1128             vcomp(:)<span class="keyword">...</span>
1129             wcomp(:)];
1130         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1131         ridx = ~isnan(ucomp);
1132         mcsdata = mcsdata(ridx,:);
1133         mcsdata(isnan(mcsdata)) = -9999;
1134         
1135         mcsout = vertcat(mcsheaders,num2cell(mcsdata));
1136         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1137         waitbar(7/7,hwait)
1138     <span class="keyword">else</span>
1139         <span class="comment">% Return default excel_path and excel_file</span>
1140         excel_path = guiprefs.excel_path;
1141         excel_file = guiprefs.excel_file;
1142         outfile = fullfile(excel_path,excel_file);
1143         log_text = {<span class="string">'User aborted Excel export...'</span>};
1144     <span class="keyword">end</span>
1145     
1146     
1147 waitbar(1,hwait)    
1148 <span class="keyword">end</span>
1149 
1150 <span class="comment">% Push messages to Log Window:</span>
1151 <span class="comment">% ----------------------------</span>
1152 statusLogging(handles.LogWindow, log_text)
1153 
1154 <span class="comment">% Store the persistent preferences:</span>
1155 <span class="comment">% ---------------------------------</span>
1156 guiprefs.excel_file = excel_file;
1157 guiprefs.excel_path = excel_path;
1158 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1159 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1160 delete(hwait)
1161 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1162 
1163 
1164 <span class="comment">% --------------------------------------------------------------------</span>
1165 <a name="_sub27" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1166 <span class="comment">% Call separate GUI</span>
1167 VMT_BuildCustomFlatFile;
1168 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1169 
1170 <span class="comment">% --------------------------------------------------------------------</span>
1171 <a name="_sub28" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1172 <span class="comment">% Empty</span>
1173 
1174 <span class="comment">% --------------------------------------------------------------------</span>
1175 <a name="_sub29" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1176 <span class="comment">% Empty</span>
1177 
1178 <span class="comment">% --------------------------------------------------------------------</span>
1179 <a name="_sub30" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1180 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1181 
1182 <span class="comment">% Get the Application Data:</span>
1183 <span class="comment">% -------------------------</span>
1184 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1185 
1186 <span class="comment">% Update the GUI &amp; Application Data:</span>
1187 <span class="comment">% ----------------------------------</span>
1188 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1189 <span class="keyword">switch</span> status
1190     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1191         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1192         guiparams.unit_discharge_correction = false;
1193     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1194         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1195         guiparams.unit_discharge_correction = true;
1196 <span class="keyword">end</span>
1197 
1198 <span class="comment">% Re-store the Application data:</span>
1199 <span class="comment">% ------------------------------</span>
1200 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1201 
1202 
1203 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1204 
1205 <span class="comment">% --------------------------------------------------------------------</span>
1206 <a name="_sub31" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1207 <span class="comment">% Empty</span>
1208 
1209 <span class="comment">% --------------------------------------------------------------------</span>
1210 <a name="_sub32" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1211 <span class="comment">% Empty</span>
1212 
1213 <span class="comment">% --------------------------------------------------------------------</span>
1214 <a name="_sub33" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1215 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1216 
1217 <span class="comment">% Get the Application Data:</span>
1218 <span class="comment">% -------------------------</span>
1219 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1220 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1221 
1222 <span class="comment">% Update the Application Data:</span>
1223 <span class="comment">% ----------------------------</span>
1224 guiparams.english_units = false;
1225 guiprefs.units = <span class="string">'metric'</span>;
1226 
1227 <span class="comment">% Re-store the Application data:</span>
1228 <span class="comment">% ------------------------------</span>
1229 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1230 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1231 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1232 
1233 <span class="comment">% Update the GUI:</span>
1234 <span class="comment">% ---------------</span>
1235 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1236 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1237 
1238 <span class="comment">% [EOF] menuMetric_Callback</span>
1239 
1240 
1241 <span class="comment">% --------------------------------------------------------------------</span>
1242 <a name="_sub34" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1243 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1244 
1245 <span class="comment">% Get the Application Data:</span>
1246 <span class="comment">% -------------------------</span>
1247 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1248 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1249 
1250 <span class="comment">% Update the Application Data:</span>
1251 <span class="comment">% ----------------------------</span>
1252 guiparams.english_units = true;
1253 guiprefs.units = <span class="string">'english'</span>;
1254 
1255 <span class="comment">% Re-store the Application data:</span>
1256 <span class="comment">% ------------------------------</span>
1257 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1258 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1259 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1260 
1261 <span class="comment">% Update the GUI:</span>
1262 <span class="comment">% ---------------</span>
1263 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1264 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1265 
1266 <span class="comment">% [EOF] menuEnglish_Callback</span>
1267 
1268 <span class="comment">% --------------------------------------------------------------------</span>
1269 <a name="_sub35" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1270 <span class="comment">% Empty</span>
1271 
1272 <span class="comment">% --------------------------------------------------------------------</span>
1273 <a name="_sub36" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1274 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1275 <span class="comment">% surface)</span>
1276 
1277 <span class="comment">% Get the Application Data:</span>
1278 <span class="comment">% -------------------------</span>
1279 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1280 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1281 
1282 <span class="comment">% Update the Application Data:</span>
1283 <span class="comment">% ----------------------------</span>
1284 guiparams.plotref = <span class="string">'dfs'</span>;
1285 guiprefs.plotref  = <span class="string">'dfs'</span>;
1286 
1287 <span class="comment">% Re-store the Application data:</span>
1288 <span class="comment">% ------------------------------</span>
1289 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1290 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1291 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1292 
1293 <span class="comment">% Update the GUI:</span>
1294 <span class="comment">% ---------------</span>
1295 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1296 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1297 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1298 
1299 <span class="comment">% --------------------------------------------------------------------</span>
1300 <a name="_sub37" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1301 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1302 
1303 <span class="comment">% Get the Application Data:</span>
1304 <span class="comment">% -------------------------</span>
1305 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1306 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1307 
1308 <span class="comment">% Update the Application Data:</span>
1309 <span class="comment">% ----------------------------</span>
1310 guiparams.plotref = <span class="string">'hab'</span>;
1311 guiprefs.plotref  = <span class="string">'hab'</span>;
1312 
1313 <span class="comment">% Prompt and set eta</span>
1314 <span class="comment">% ------------------</span>
1315 prompt = <span class="string">'Enter elevation of the bottom (eta), in meters:'</span>;
1316 dlg_title = <span class="string">'Set bottom elevation for height above bottom reference'</span>;
1317 num_lines = 1;
1318 def = {num2str(guiparams.eta)};
1319 guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));
1320 
1321 
1322 <span class="comment">% Re-store the Application data:</span>
1323 <span class="comment">% ------------------------------</span>
1324 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1325 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1326 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1327 
1328 <span class="comment">% Update the GUI:</span>
1329 <span class="comment">% ---------------</span>
1330 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1331 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1332 
1333 
1334 
1335 
1336 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1337 
1338 <span class="comment">% --------------------------------------------------------------------</span>
1339 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1340 <span class="comment">% Empty</span>
1341 
1342 <span class="comment">% --------------------------------------------------------------------</span>
1343 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1344 <span class="comment">% Set cross-section endpoints automatically</span>
1345 
1346 <span class="comment">% Get the Application Data:</span>
1347 <span class="comment">% -------------------------</span>
1348 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1349 
1350 <span class="comment">% Update the Application Data:</span>
1351 <span class="comment">% ----------------------------</span>
1352 guiparams.set_cross_section_endpoints = false;
1353 
1354 <span class="comment">% Re-store the Application data:</span>
1355 <span class="comment">% ------------------------------</span>
1356 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1357 
1358 <span class="comment">% Update the GUI:</span>
1359 <span class="comment">% ---------------</span>
1360 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1361 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1362 
1363 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1364 
1365 
1366 <span class="comment">% --------------------------------------------------------------------</span>
1367 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1368 <span class="comment">% Set cross-section endpoints manually</span>
1369 
1370 <span class="comment">% Get the Application Data:</span>
1371 <span class="comment">% -------------------------</span>
1372 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1373 
1374 <span class="comment">% Update the Application Data:</span>
1375 <span class="comment">% ----------------------------</span>
1376 guiparams.set_cross_section_endpoints = true;
1377 
1378 <span class="comment">% Re-store the Application data:</span>
1379 <span class="comment">% ------------------------------</span>
1380 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1381 
1382 <span class="comment">% Update the GUI:</span>
1383 <span class="comment">% ---------------</span>
1384 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1385 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1386 
1387 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1388 
1389 
1390 
1391 
1392 <span class="comment">% --------------------------------------------------------------------</span>
1393 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1394 <span class="comment">% Empty</span>
1395 
1396 <span class="comment">% --------------------------------------------------------------------</span>
1397 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1398 
1399 <span class="comment">% Get the Application Data:</span>
1400 <span class="comment">% -------------------------</span>
1401 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1402 
1403 <span class="comment">% Update the Application Data:</span>
1404 <span class="comment">% ----------------------------</span>
1405 guiparams.print        = true;
1406 guiparams.presentation = false;
1407 
1408 <span class="comment">% Re-store the Application data:</span>
1409 <span class="comment">% ------------------------------</span>
1410 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1411 
1412 <span class="comment">% Update the GUI:</span>
1413 <span class="comment">% ---------------</span>
1414 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1415 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1416 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1417 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1418 
1419 <span class="comment">% Modify the existing figures</span>
1420 <span class="comment">% ---------------------------</span>
1421 <span class="comment">% Find what plots exist already</span>
1422 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1423 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1424 
1425 <span class="comment">% Defaults for Print Stlye Figure</span>
1426 BkgdColor   = <span class="string">'white'</span>;
1427 AxColor     = <span class="string">'black'</span>;
1428 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1429 FntSize     = 14;
1430 
1431 <span class="comment">% Loop through valid figures and adjust</span>
1432 <span class="comment">% -------------------------------------</span>
1433 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1434     
1435     <span class="keyword">for</span> i = 1:length(valid_names)
1436         <span class="keyword">switch</span> valid_names{i}
1437             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1438                 <span class="comment">% Focus the figure</span>
1439                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1440                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1441                     figure(hff)
1442                     
1443                     <span class="comment">% Make the changes to figure</span>
1444                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1445                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1446                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1447                     set(gca,<span class="string">'Color'</span>,FigColor)
1448                     set(gca,<span class="string">'XColor'</span>,AxColor)
1449                     set(gca,<span class="string">'YColor'</span>,AxColor)
1450                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1451                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1452                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1453                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1454                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1455                     
1456                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1457                     <span class="comment">% the file(s) and path for the data</span>
1458                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1459                     <span class="keyword">if</span> ~ismultiplot
1460                         filestr = guiparams.savefile;
1461                         wd = length(filestr);
1462                         hd = 1;
1463                     <span class="keyword">else</span>
1464                         <span class="comment">% Construct a filename</span>
1465                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1466                         wd        = max(cellfun(@length,filestr));
1467                         hd        = numel(filestr);
1468                             
1469                     <span class="keyword">end</span>
1470                     
1471                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1472                     disableMenuBar(hff)
1473                     set(fileinfotxt,<span class="keyword">...</span>
1474                         <span class="string">'string'</span>,filestr)
1475                     set(fileinfotxt,<span class="keyword">...</span>
1476                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1477                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1478                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1479                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1480                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1481                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1482                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1483                     
1484                 <span class="keyword">end</span>
1485             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1486                 <span class="comment">% Focus the figure</span>
1487                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1488                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1489                     figure(hff)
1490                     
1491                     <span class="comment">% Make the changes to figure</span>
1492                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1493                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1494                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1495                     set(gca,<span class="string">'Color'</span>,FigColor)
1496                     set(gca,<span class="string">'XColor'</span>,AxColor)
1497                     set(gca,<span class="string">'YColor'</span>,AxColor)
1498                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1499                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1500                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1501                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1502                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1503                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1504                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1505                     
1506                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1507                     <span class="comment">% the file(s) and path for the data</span>
1508                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1509                     <span class="keyword">if</span> ~ismultiplot
1510                         filestr = guiparams.savefile;
1511                         wd = length(filestr);
1512                         hd = 1;
1513                     <span class="keyword">else</span>
1514                         <span class="comment">% Construct a filename</span>
1515                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1516                         wd        = max(cellfun(@length,filestr));
1517                         hd        = numel(filestr);
1518                             
1519                     <span class="keyword">end</span>
1520                     
1521                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1522                     disableMenuBar(hff)
1523                     set(fileinfotxt,<span class="keyword">...</span>
1524                         <span class="string">'string'</span>,filestr)
1525                     set(fileinfotxt,<span class="keyword">...</span>
1526                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1527                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1528                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1529                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1530                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1531                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1532                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1533                 <span class="keyword">end</span>
1534             <span class="keyword">otherwise</span>
1535         <span class="keyword">end</span>
1536     <span class="keyword">end</span>
1537     
1538     
1539 <span class="keyword">end</span>
1540 
1541 
1542 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1543 
1544 
1545 <span class="comment">% --------------------------------------------------------------------</span>
1546 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1547 <span class="comment">% Get the Application Data:</span>
1548 <span class="comment">% -------------------------</span>
1549 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1550 
1551 <span class="comment">% Update the Application Data:</span>
1552 <span class="comment">% ----------------------------</span>
1553 guiparams.print        = false;
1554 guiparams.presentation = true;
1555 
1556 <span class="comment">% Re-store the Application data:</span>
1557 <span class="comment">% ------------------------------</span>
1558 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1559 
1560 <span class="comment">% Update the GUI:</span>
1561 <span class="comment">% ---------------</span>
1562 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1563 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1564 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1565 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1566 
1567 <span class="comment">% Modify the existing figures</span>
1568 <span class="comment">% ---------------------------</span>
1569 <span class="comment">% Find what plots exist already</span>
1570 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1571 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1572 
1573 <span class="comment">% Defaults for Presentation Stlye Figure</span>
1574 <span class="comment">% --------------------------------------</span>
1575 BkgdColor   = <span class="string">'black'</span>;
1576 AxColor     = <span class="string">'white'</span>;
1577 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1578 FntSize     = 14;
1579 
1580 <span class="comment">% Loop through valid figures and adjust</span>
1581 <span class="comment">% -------------------------------------</span>
1582 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1583     
1584     <span class="keyword">for</span> i = 1:length(valid_names)
1585         <span class="keyword">switch</span> valid_names{i}
1586             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1587                 <span class="comment">% Focus the figure</span>
1588                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1589                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1590                     figure(hff)
1591                     
1592                     <span class="comment">% Make the changes to figure</span>
1593                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1594                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1595                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1596                     set(gca,<span class="string">'Color'</span>,FigColor)
1597                     set(gca,<span class="string">'XColor'</span>,AxColor)
1598                     set(gca,<span class="string">'YColor'</span>,AxColor)
1599                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1600                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1601                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1602                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1603                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1604                     
1605                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1606                     <span class="comment">% the file(s) and path for the data</span>
1607                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1608                     <span class="keyword">if</span> ~ismultiplot
1609                         filestr = guiparams.savefile;
1610                         wd = length(filestr);
1611                         hd = 1;
1612                     <span class="keyword">else</span>
1613                         <span class="comment">% Construct a filename</span>
1614                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1615                         wd        = max(cellfun(@length,filestr));
1616                         hd        = numel(filestr);
1617                             
1618                     <span class="keyword">end</span>
1619                     
1620                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1621                     disableMenuBar(hff)
1622                     set(fileinfotxt,<span class="keyword">...</span>
1623                         <span class="string">'string'</span>,filestr)
1624                     set(fileinfotxt,<span class="keyword">...</span>
1625                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1626                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1627                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1628                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1629                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1630                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1631                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1632                     
1633                 <span class="keyword">end</span>
1634             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1635                 <span class="comment">% Focus the figure</span>
1636                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1637                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1638                     figure(hff)
1639                     
1640                     <span class="comment">% Make the changes to figure</span>
1641                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1642                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1643                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1644                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1645                     set(gca,<span class="string">'XColor'</span>,AxColor)
1646                     set(gca,<span class="string">'YColor'</span>,AxColor)
1647                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1648                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'XColor'</span>,AxColor,<span class="string">'YColor'</span>,AxColor);
1649                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1650                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1651                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1652                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1653                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1654                     
1655                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1656                     <span class="comment">% the file(s) and path for the data</span>
1657                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1658                     <span class="keyword">if</span> ~ismultiplot
1659                         filestr = guiparams.savefile;
1660                         wd = length(filestr);
1661                         hd = 1;
1662                     <span class="keyword">else</span>
1663                         <span class="comment">% Construct a filename</span>
1664                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1665                         wd        = max(cellfun(@length,filestr));
1666                         hd        = numel(filestr);
1667                             
1668                     <span class="keyword">end</span>
1669                     
1670                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1671                     disableMenuBar(hff)
1672                     set(fileinfotxt,<span class="keyword">...</span>
1673                         <span class="string">'string'</span>,filestr)
1674                     set(fileinfotxt,<span class="keyword">...</span>
1675                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1676                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1677                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1678                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1679                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1680                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1681                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1682                 <span class="keyword">end</span>
1683             <span class="keyword">otherwise</span>
1684         <span class="keyword">end</span>
1685     <span class="keyword">end</span>
1686     
1687     
1688 <span class="keyword">end</span>
1689 
1690 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1691 
1692 <span class="comment">% --------------------------------------------------------------------</span>
1693 <a name="_sub44" href="#_subfunctions" class="code">function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
1694 
1695 <span class="comment">% Get the Application data:</span>
1696 <span class="comment">% -------------------------</span>
1697 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1698 
1699 <span class="comment">% Initialize the answer:</span>
1700 <span class="comment">% ----------------------</span>
1701 numstr = {num2str(guiparams.vertical_offset)};
1702 answer = NaN;
1703 <span class="keyword">while</span> isnan(answer)
1704     answer = inputdlg(<span class="string">'Vertical Offset (m)'</span>,<span class="string">'KMZ Export'</span>,1,numstr);
1705     
1706     <span class="keyword">if</span> isempty(answer) <span class="comment">% User hits &quot;Cancel&quot;</span>
1707         <span class="keyword">return</span>
1708     <span class="keyword">end</span>
1709     
1710     answer = str2double(answer); <span class="comment">% A non-numeric char will be NaN</span>
1711     <span class="comment">% A numeric char will be a double</span>
1712 <span class="keyword">end</span>
1713 
1714 <span class="comment">% Re-store the Application data:</span>
1715 <span class="comment">% ------------------------------</span>
1716 guiparams.vertical_offset = answer;
1717 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1718 
1719 <span class="comment">% [EOF] menuKMZExport_Callback</span>
1720 
1721 <span class="comment">% --------------------------------------------------------------------</span>
1722 <a name="_sub45" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1723 <span class="comment">% Not implemented</span>
1724 
1725 <span class="comment">% --------------------------------------------------------------------</span>
1726 <a name="_sub46" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1727 <span class="comment">% Empty</span>
1728 
1729 <span class="comment">% --------------------------------------------------------------------</span>
1730 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1731 ASCII2GIS_GUI
1732 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1733 
1734 <span class="comment">% --------------------------------------------------------------------</span>
1735 <a name="_sub48" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1736 
1737 <span class="comment">% Get the Application preferences:</span>
1738 <span class="comment">% --------------------------------</span>
1739 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1740 
1741 inpath = guiprefs.kmz_path;
1742 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1743     infile = guiprefs.kmz_file{1};
1744 <span class="keyword">else</span>
1745     infile = guiprefs.kmz_file;
1746 <span class="keyword">end</span>
1747 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1748 
1749 guiprefs.kmz_path = outpath;
1750 guiprefs.kmz_file = outfile;
1751 
1752 <span class="comment">% Update persistent preferences</span>
1753 <span class="comment">% -----------------------------</span>
1754 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1755 
1756 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1757 
1758 <span class="comment">% --------------------------------------------------------------------</span>
1759 <a name="_sub49" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1760 <span class="comment">% Get the Application preferences:</span>
1761 <span class="comment">% --------------------------------</span>
1762 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1763 
1764 VMT_BatchMode;
1765 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1766 
1767 <span class="comment">% --------------------------------------------------------------------</span>
1768 <a name="_sub50" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1769 <span class="comment">% Empty</span>
1770 
1771 <span class="comment">% --------------------------------------------------------------------</span>
1772 <a name="_sub51" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1773 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1774 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1775     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1776     
1777 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1778     
1779     <span class="keyword">if</span> isdeployed
1780         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1781             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1782         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1783             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1784             errLogFileName},<span class="keyword">...</span>
1785             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1786             <span class="string">'error'</span>);
1787         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1788         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1789         fclose(fid);
1790         rethrow(err)
1791     <span class="keyword">else</span>
1792         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1793             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1794             <span class="string">'error'</span>);
1795         rethrow(err);
1796     <span class="keyword">end</span>
1797 <span class="keyword">end</span>
1798 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1799 
1800 <span class="comment">% --------------------------------------------------------------------</span>
1801 <a name="_sub52" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1802 <span class="comment">% Get the Application data:</span>
1803 <span class="comment">% -------------------------</span>
1804 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1805 
1806 <span class="keyword">try</span>
1807     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1808 
1809 
1810 <span class="comment">% This catch is probably not necessary.</span>
1811 <span class="keyword">catch</span> err 
1812     <span class="keyword">if</span> isdeployed
1813         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1814             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1815         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1816             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1817             errLogFileName},<span class="keyword">...</span>
1818             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1819             <span class="string">'error'</span>);
1820         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1821         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1822         fclose(fid);
1823         rethrow(err)
1824     <span class="keyword">else</span>
1825         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1826             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1827             <span class="string">'error'</span>);
1828         rethrow(err);
1829     <span class="keyword">end</span>
1830 <span class="keyword">end</span>
1831 
1832 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1833 
1834 <span class="comment">% --------------------------------------------------------------------</span>
1835 <a name="_sub53" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1836 
1837 <span class="comment">% Get the Application data:</span>
1838 <span class="comment">% -------------------------</span>
1839 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1840 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1841 
1842 <span class="comment">% Check version tag against the web, and display a message</span>
1843 <span class="keyword">try</span>
1844     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1845     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1846     <span class="keyword">if</span> length(webdata) &gt; 5
1847         current_vmt_version{1} = webdata(1:5);
1848         current_vmt_version{2} = webdata(8:16);
1849     <span class="keyword">else</span>
1850         current_vmt_version = webdata;
1851     <span class="keyword">end</span>
1852     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1853 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1854     <span class="keyword">if</span> isdeployed
1855         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1856             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1857         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1858             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1859             errLogFileName},<span class="keyword">...</span>
1860             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1861             <span class="string">'error'</span>);
1862         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1863         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1864         fclose(fid);
1865         rethrow(err)
1866     <span class="keyword">else</span>
1867         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1868             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1869             <span class="string">'error'</span>);
1870         rethrow(err);
1871     <span class="keyword">end</span>
1872 <span class="keyword">end</span>
1873 
1874 <span class="keyword">if</span> ischar(current_vmt_version)
1875     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1876         h = msgbox(<span class="keyword">...</span>
1877             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1878             <span class="string">''</span>;<span class="keyword">...</span>
1879             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1880             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1881     <span class="keyword">else</span>
1882         h = msgbox(<span class="keyword">...</span>
1883             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1884             <span class="string">''</span>;<span class="keyword">...</span>
1885             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1886             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1887     <span class="keyword">end</span>
1888 <span class="keyword">elseif</span> iscell(current_vmt_version)
1889     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1890         h = msgbox(<span class="keyword">...</span>
1891             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1892             <span class="string">''</span>;<span class="keyword">...</span>
1893             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1894             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1895     <span class="keyword">else</span>
1896         h = msgbox(<span class="keyword">...</span>
1897             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1898             <span class="string">''</span>;<span class="keyword">...</span>
1899             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1900             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1901     <span class="keyword">end</span>
1902 <span class="keyword">end</span>
1903 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1904 
1905 <span class="comment">% --------------------------------------------------------------------</span>
1906 <a name="_sub54" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1907 
1908 <span class="comment">% Get the Application data:</span>
1909 <span class="comment">% -------------------------</span>
1910 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1911 messagestr = <span class="keyword">...</span>
1912     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1913     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1914     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1915     <span class="string">''</span>;<span class="keyword">...</span>
1916     <span class="string">''</span>;<span class="keyword">...</span>
1917     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1918     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1919     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1920     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1921     <span class="string">''</span>;<span class="keyword">...</span>
1922     <span class="string">''</span>;<span class="keyword">...</span>
1923     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1924     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1925     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1926     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1927     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1928     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1929     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1930 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1931 <span class="comment">% [EOF] menuAbout_Callback</span>
1932 
1933 
1934 
1935 
1936 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1937 <span class="comment">% TOOLBAR CALLBACKS %</span>
1938 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1939 
1940 <span class="comment">% --------------------------------------------------------------------</span>
1941 <a name="_sub55" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1942 <span class="comment">% Read Files into Data Structure using tfile.</span>
1943 
1944 <span class="comment">% Get the Application data:</span>
1945 <span class="comment">% -------------------------</span>
1946 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1947 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1948 
1949 <span class="comment">% Ask the user to select files:</span>
1950 <span class="comment">% -----------------------------</span>
1951 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1952 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1953     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1954     current_file, <span class="keyword">...</span>
1955     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1956 
1957 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1958     guiparams.data_folder = pathname;
1959     <span class="keyword">if</span> ischar(filename)
1960         filename = {filename};
1961     <span class="keyword">end</span>
1962     guiparams.data_files = filename;
1963     guiparams.mat_file = <span class="string">''</span>;
1964     
1965     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1966     
1967    
1968     
1969     <span class="comment">% Update the preferences:</span>
1970     <span class="comment">% -----------------------</span>
1971     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1972     guiprefs.ascii_path = pathname;
1973     guiprefs.ascii_file = filename;
1974     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1975     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1976     
1977     <span class="comment">% Push messages to Log Window:</span>
1978     <span class="comment">% ----------------------------</span>
1979     log_text = {<span class="keyword">...</span>
1980         <span class="string">''</span>;<span class="keyword">...</span>
1981         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1982         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1983         guiparams.data_folder;
1984         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1985         char(filename)};
1986     statusLogging(handles.LogWindow, log_text)
1987     
1988     <span class="comment">% Read the file(s)</span>
1989     <span class="comment">% ----------------</span>
1990     [~,~,savefile,A,z] = <span class="keyword">...</span>
1991         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1992     guiparams.savefile = savefile;
1993     guiparams.A        = A;
1994     guiparams.z        = z;
1995     
1996     
1997     <span class="comment">% Set the vertical grid node spacing</span>
1998     <span class="comment">% ----------------------------------</span>
1999     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2000     <span class="comment">% Backwards compatible</span>
2001     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2002         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2003         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2004     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2005         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2006         guiparams.vertical_grid_node_spacing = 0.4;
2007     <span class="keyword">end</span>
2008     
2009     
2010     <span class="comment">% Save application data</span>
2011     <span class="comment">% ---------------------</span>
2012     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2013        
2014 <span class="comment">%</span>
2015 <span class="comment">%     % Preprocess the data:</span>
2016 <span class="comment">%     % --------------------</span>
2017 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2018 <span class="comment">%</span>
2019 <span class="comment">%     % Push messages to Log Window:</span>
2020 <span class="comment">%     % ----------------------------</span>
2021 <span class="comment">%     log_text = {...</span>
2022 <span class="comment">%         '   Preprocessing complete.';...</span>
2023 <span class="comment">%         '   Begin Data Processing...'};</span>
2024 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2025 <span class="comment">%</span>
2026 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2027 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2028 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2029 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2030 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2031 <span class="comment">%</span>
2032 <span class="comment">%     % Push messages to Log Window:</span>
2033 <span class="comment">%     % ----------------------------</span>
2034 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2035 <span class="comment">%</span>
2036 <span class="comment">%     % Store the data:</span>
2037 <span class="comment">%     % ---------------</span>
2038 <span class="comment">%     guiparams.z = z;</span>
2039 <span class="comment">%     guiparams.A = A;</span>
2040 <span class="comment">%     guiparams.V = V;</span>
2041 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2042     
2043           
2044     <span class="comment">% Update the GUI:</span>
2045     <span class="comment">% ---------------</span>
2046     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2047     
2048     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2049     
2050 <span class="keyword">end</span>
2051 <span class="comment">% [EOF] loadDataCallback</span>
2052 
2053 
2054 
2055 <span class="comment">% --------------------------------------------------------------------</span>
2056 <a name="_sub56" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2057 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2058 
2059 <span class="comment">% Get the Application data:</span>
2060 <span class="comment">% -------------------------</span>
2061 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2062 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2063 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2064 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2065 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2066 
2067 [the_file,the_path] = <span class="keyword">...</span>
2068     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2069     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2070     fullfile(guiparams.mat_path,guiparams.savefile));
2071 
2072 <span class="comment">% Save the processed data to a MAT file:</span>
2073 <span class="comment">% --------------------------------------</span>
2074 <span class="keyword">if</span> ischar(the_file)
2075     guiparams.mat_path = the_path;
2076     guiparams.mat_file = the_file;
2077     guiparams.savefile = the_file;
2078     
2079     <span class="comment">% Re-store the Application data:</span>
2080     <span class="comment">% ------------------------------</span>
2081     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2082     
2083     <span class="comment">% Update the preferences:</span>
2084     <span class="comment">% -----------------------</span>
2085     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2086     guiprefs.mat_path = the_path;
2087     guiprefs.mat_file = the_file;
2088     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2089     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2090     
2091     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2092     savefile = fullfile(pathstr,[filename extension]);
2093     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2094     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2095     log_text = {<span class="keyword">...</span>
2096         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2097         savefile};
2098     statusLogging(handles.LogWindow,log_text)
2099     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2100 <span class="keyword">end</span>
2101 
2102 <span class="comment">% [EOF] saveDataCallback</span>
2103 
2104 
2105 <span class="comment">% --------------------------------------------------------------------</span>
2106 <a name="_sub57" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2107 
2108 <span class="comment">% Get the Application data:</span>
2109 <span class="comment">% -------------------------</span>
2110 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2111 z   = guiparams.z;
2112 A   = guiparams.A;
2113 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2114 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2115 
2116 <span class="comment">% Compute multibeam bathymetry:</span>
2117 <span class="comment">% -----------------------------</span>
2118 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2119 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2120 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2121     guiparams.beam_angle, <span class="keyword">...</span>
2122     guiparams.magnetic_variation, <span class="keyword">...</span>
2123     guiparams.wse, <span class="keyword">...</span>
2124     guiparams.output_auxiliary_data);
2125 
2126 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2127 
2128 <span class="comment">% [EOF] saveBathymetryCallback</span>
2129 
2130 <span class="comment">% --------------------------------------------------------------------</span>
2131 <a name="_sub58" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2132 
2133 <span class="comment">% Get the Application data:</span>
2134 <span class="comment">% -------------------------</span>
2135 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2136 
2137 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2138     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2139     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2140     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2141     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2142     handles.figure1);
2143 
2144 <span class="comment">% Update the GUI:</span>
2145 <span class="comment">% ---------------</span>
2146 <span class="keyword">if</span> guiparams.english_units
2147     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2148     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2149 <span class="keyword">else</span>
2150     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2151     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2152 <span class="keyword">end</span>
2153 
2154 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2155     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2156     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2157 <span class="keyword">else</span>
2158     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2159     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2160 <span class="keyword">end</span>
2161 
2162 <span class="keyword">if</span> guiparams.presentation
2163     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2164 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2165 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2166 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2167 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2168 <span class="keyword">else</span>
2169     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2170 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2171 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2172 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2173 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2174 <span class="keyword">end</span>
2175 
2176 <span class="comment">% Re-store the Application data:</span>
2177 <span class="comment">% ------------------------------</span>
2178 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2179 
2180 <span class="comment">% [EOF] plottingParametersCallback</span>
2181 
2182 
2183 <span class="comment">% --------------------------------------------------------------------</span>
2184 <a name="_sub59" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2185 
2186 <span class="comment">% Get the Application data:</span>
2187 <span class="comment">% -------------------------</span>
2188 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2189 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2190 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2191 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2192 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2193 
2194 <span class="comment">% [EOF] processingParametersCallback</span>
2195 
2196 
2197 <span class="comment">% --------------------------------------------------------------------</span>
2198 <a name="_sub60" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2199 <span class="comment">% Plot 1</span>
2200 
2201 <span class="comment">% Get the Application data:</span>
2202 <span class="comment">% -------------------------</span>
2203 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2204 z = guiparams.z;
2205 A = guiparams.A;
2206 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2207 <span class="comment">% Map = guiparams.Map;</span>
2208 
2209 
2210 <span class="comment">% Preprocess the data:</span>
2211 <span class="comment">% --------------------</span>
2212 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2213 
2214 <span class="comment">% Push messages to Log Window:</span>
2215 <span class="comment">% ----------------------------</span>
2216 log_text = {<span class="keyword">...</span>
2217     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2218     <span class="string">'   Begin Data Processing...'</span>};
2219 statusLogging(handles.LogWindow, log_text)
2220 
2221 <span class="comment">% Process the transects:</span>
2222 <span class="comment">% ----------------------</span>
2223 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2224 A(1).vgns = guiparams.vertical_grid_node_spacing;
2225 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2226 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2227     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2228 
2229 <span class="comment">% Compute the smoothed variables</span>
2230 <span class="comment">% ------------------------------</span>
2231 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2232 <span class="comment">% runtime.</span>
2233 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2234     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2235     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2236     guiparams.vertical_smoothing_window);
2237 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2238 
2239 <span class="comment">% Push messages to Log Window:</span>
2240 <span class="comment">% ----------------------------</span>
2241 statusLogging(handles.LogWindow, processing_log_text)
2242 
2243 <span class="comment">% Store the data:</span>
2244 <span class="comment">% ---------------</span>
2245 guiparams.z = z;
2246 guiparams.A = A;
2247 guiparams.V = V;
2248 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2249 
2250 <span class="comment">% Push messages to Log Window:</span>
2251 <span class="comment">% ----------------------------</span>
2252 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2253 statusLogging(handles.LogWindow, log_text)
2254 
2255 <span class="comment">% Create or replot the Shiptracks</span>
2256 <span class="comment">% -------------------------------</span>
2257 <span class="comment">% Grab the axes to the plot</span>
2258 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2259 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2260 
2261 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2262 <span class="comment">% New plot display window</span>
2263 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2264 <span class="comment">% h = figure(1); clf</span>
2265 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2266 
2267 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2268 
2269 
2270 <span class="comment">% --------------------------------------------------------------------</span>
2271 <a name="_sub61" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2272 <span class="comment">% Plot 2</span>
2273 
2274 <span class="comment">% Get the Application data:</span>
2275 <span class="comment">% -------------------------</span>
2276 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2277 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2278 
2279 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2280     <span class="comment">% Push messages to Log Window:</span>
2281     <span class="comment">% ----------------------------</span>
2282     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2283     statusLogging(handles.LogWindow, log_text)
2284     
2285        
2286     <span class="comment">% Push plotting parameters to log window:</span>
2287     <span class="comment">% ---------------------------------------</span>
2288     log_text = {<span class="keyword">...</span>
2289         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2290         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2291         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2292         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2293         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2294         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2295         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2296         };
2297     statusLogging(handles.LogWindow, log_text)
2298     
2299     <span class="comment">% Plot the data:</span>
2300     <span class="comment">% --------------</span>
2301     z = [];
2302     A = [];
2303     V = [];
2304     Map = [];
2305     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2306     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2307         depth_range, <span class="keyword">...</span>
2308         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2309         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2310         guiparams.smoothing_window_size, <span class="keyword">...</span>
2311         guiparams.display_shoreline, <span class="keyword">...</span>
2312         guiparams.english_units, <span class="keyword">...</span>
2313         guiparams.mat_file, <span class="keyword">...</span>
2314         guiparams.mat_path); <span class="comment">% PLOT2</span>
2315     statusLogging(handles.LogWindow, log_text)
2316     
2317     <span class="comment">% Plot a Shoreline Map:</span>
2318     <span class="comment">% ---------------------</span>
2319     <span class="keyword">if</span> guiparams.display_shoreline
2320         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2321             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2322             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2323             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2324         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2325             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2326             Map.UTMe   = mapdata(:,1);
2327             Map.UTMn   = mapdata(:,2);
2328             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2329             <span class="comment">%Map.UTMzone = zone;</span>
2330         <span class="keyword">else</span>
2331             Map = [];
2332         <span class="keyword">end</span>
2333         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2334         log_text = {<span class="keyword">...</span>
2335             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2336             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2337             };
2338         statusLogging(handles.LogWindow, log_text)
2339     <span class="keyword">else</span>
2340         Map = [];
2341     <span class="keyword">end</span>
2342     
2343 <span class="keyword">else</span>
2344     z = guiparams.z;
2345     A = guiparams.A;
2346     <span class="comment">% V = guiparams.V;</span>
2347     Map = guiparams.Map;
2348     
2349     <span class="comment">% Push messages to Log Window:</span>
2350     <span class="comment">% ----------------------------</span>
2351     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2352     statusLogging(handles.LogWindow, log_text)
2353     
2354         
2355     <span class="comment">% Preprocess the data:</span>
2356     <span class="comment">% --------------------</span>
2357     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2358     
2359     <span class="comment">% Process the transects:</span>
2360     <span class="comment">% ----------------------</span>
2361     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2362     A(1).vgns = guiparams.vertical_grid_node_spacing;
2363     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2364     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2365         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2366     
2367     <span class="comment">% Compute the smoothed variables</span>
2368     <span class="comment">% ------------------------------</span>
2369     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2370     <span class="comment">% runtime.</span>
2371     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2372         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2373         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2374         guiparams.vertical_smoothing_window);
2375     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2376     
2377     <span class="comment">% Push messages to Log Window:</span>
2378     <span class="comment">% ----------------------------</span>
2379     statusLogging(handles.LogWindow, processing_log_text)
2380     
2381     <span class="comment">% Plot the cross section:</span>
2382     <span class="comment">% -----------------------</span>
2383     log_text = {<span class="keyword">...</span>
2384         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2385         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2386         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2387         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2388         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2389         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2390         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2391         };
2392     statusLogging(handles.LogWindow, log_text)
2393     
2394     <span class="comment">% Plot the data:</span>
2395     <span class="comment">% --------------</span>
2396     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2397     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2398     
2399     
2400     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2401         depth_range, <span class="keyword">...</span>
2402         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2403         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2404         guiparams.smoothing_window_size, <span class="keyword">...</span>
2405         guiparams.display_shoreline, <span class="keyword">...</span>
2406         guiparams.english_units, <span class="keyword">...</span>
2407         guiparams.mat_file, <span class="keyword">...</span>
2408         guiparams.mat_path); <span class="comment">% PLOT2</span>
2409     statusLogging(handles.LogWindow, log_text)
2410     
2411     <span class="comment">% Plot User Set Endpoints</span>
2412     <span class="comment">% -----------------------</span>
2413     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2414         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2415         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2416         x = data(:,1);
2417         y = data(:,2);
2418         
2419         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2420         figure(fh); hold on
2421         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2422         hold off
2423     <span class="keyword">end</span>
2424     
2425     <span class="comment">% Plot a Shoreline Map:</span>
2426     <span class="comment">% ---------------------</span>
2427     <span class="keyword">if</span> guiparams.display_shoreline
2428         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2429             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2430             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2431             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2432         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2433             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2434             Map.UTMe   = mapdata(:,1);
2435             Map.UTMn   = mapdata(:,2);
2436             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2437             <span class="comment">%Map.UTMzone = zone;</span>
2438         <span class="keyword">else</span>
2439             Map = [];
2440         <span class="keyword">end</span>
2441         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2442         log_text = {<span class="keyword">...</span>
2443             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2444             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2445             };
2446         statusLogging(handles.LogWindow, log_text)
2447     <span class="keyword">else</span>
2448         Map = [];
2449     <span class="keyword">end</span>
2450     
2451 <span class="keyword">end</span>
2452 
2453 <span class="keyword">if</span> guiparams.add_background
2454     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2455     statusLogging(handles.LogWindow, log_text)
2456 <span class="keyword">end</span>
2457 
2458 <span class="comment">% Update guiparams</span>
2459 <span class="comment">% ----------------</span>
2460 guiparams.z   = z;
2461 guiparams.A   = A;
2462 guiparams.V   = V;
2463 guiparams.Map = Map;
2464 guiparams.iric_anv_planview_data = PVdata;
2465 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2466 
2467 <span class="comment">% Update preferences</span>
2468 <span class="comment">% ------------------</span>
2469 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2470 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2471 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2472 
2473 <span class="comment">% Force plot to be formated properly</span>
2474 <span class="comment">% ----------------------------------</span>
2475 <span class="keyword">if</span> guiparams.presentation
2476     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2477 <span class="keyword">else</span>
2478     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2479 <span class="keyword">end</span>
2480 <span class="keyword">switch</span> guiparams.renderer
2481     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2482         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2483     <span class="keyword">case</span> <span class="string">'painters'</span>
2484         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2485     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2486         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2487 <span class="keyword">end</span>
2488 
2489 <span class="comment">% Focus the figure</span>
2490 <span class="comment">% ----------------</span>
2491 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2492 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2493     figure(hff)
2494 <span class="keyword">end</span>
2495 
2496 <span class="comment">% Start the Graphics Control Gui</span>
2497 <span class="comment">% ------------------------------</span>
2498 VMT_GraphicsControl
2499 
2500 <span class="comment">% [EOF] planviewPlotCallback</span>
2501 
2502 
2503 <span class="comment">% --------------------------------------------------------------------</span>
2504 <a name="_sub62" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2505 <span class="comment">% Plot 3</span>
2506 
2507 <span class="comment">% Get the Application data:</span>
2508 <span class="comment">% -------------------------</span>
2509 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2510 z = guiparams.z;
2511 A = guiparams.A;
2512 <span class="comment">% V = guiparams.V;</span>
2513 <span class="comment">% Map = guiparams.Map;</span>
2514 
2515 <span class="comment">% Preprocess the data:</span>
2516 <span class="comment">% --------------------</span>
2517 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2518 
2519 <span class="comment">% Push messages to Log Window:</span>
2520 <span class="comment">% ----------------------------</span>
2521 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2522 statusLogging(handles.LogWindow, log_text)
2523 
2524 <span class="comment">% Process the transects:</span>
2525 <span class="comment">% ----------------------</span>
2526 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2527 A(1).vgns = guiparams.vertical_grid_node_spacing;
2528 A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2529 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2530     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2531 
2532 <span class="comment">% Push messages to Log Window:</span>
2533 <span class="comment">% ----------------------------</span>
2534 statusLogging(handles.LogWindow, processing_log_text)
2535 
2536 <span class="comment">% Plot the cross section:</span>
2537 <span class="comment">% -----------------------</span>
2538 log_text = {<span class="keyword">...</span>
2539     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2540     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2541     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2542     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2543     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2544     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2545     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2546     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2547     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2548     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2549     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2550     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2551     
2552     };
2553 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2554     log_text = vertcat(log_text, {<span class="keyword">...</span>
2555         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2556         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2557         });
2558 <span class="keyword">end</span>
2559 <span class="comment">% Push messages to Log Window:</span>
2560 <span class="comment">% ----------------------------</span>
2561 statusLogging(handles.LogWindow, log_text)
2562 
2563 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2564     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2565 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2566 <span class="comment">%         ...guiparams.contour, ...</span>
2567 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2568 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2569     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2570         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2571         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2572         guiparams.vertical_smoothing_window);
2573     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2574     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2575         guiparams.contour, <span class="keyword">...</span>
2576         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2577         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2578         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2579         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2580         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2581         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2582         guiparams.english_units); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2583     
2584 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2585     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2586         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2587         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2588         guiparams.vertical_smoothing_window);
2589     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2590     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2591         guiparams.contour, <span class="keyword">...</span>
2592         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2593         guiparams.english_units);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2594     
2595     guiparams.zmin = zmin;
2596     guiparams.zmax = zmax;
2597     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2598 <span class="keyword">end</span>
2599 
2600 <span class="comment">% Force plot to be formated properly</span>
2601 <span class="comment">% ----------------------------------</span>
2602 <span class="keyword">if</span> guiparams.presentation
2603     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2604 <span class="keyword">else</span>
2605     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2606 <span class="keyword">end</span>
2607 <span class="keyword">switch</span> guiparams.renderer
2608     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2609         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2610     <span class="keyword">case</span> <span class="string">'painters'</span>
2611         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2612     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2613         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2614 <span class="keyword">end</span>
2615 
2616 <span class="comment">% Focus the figure</span>
2617 <span class="comment">% ----------------</span>
2618 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2619 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2620     figure(hff)
2621 <span class="keyword">end</span>
2622 
2623 <span class="comment">% Re-store the Application data:</span>
2624 <span class="comment">% ------------------------------</span>
2625 guiparams.V = V;
2626 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2627 
2628 <span class="comment">% Start the Graphics Control Gui</span>
2629 <span class="comment">% ------------------------------</span>
2630 VMT_GraphicsControl
2631 
2632 <span class="comment">% Push messages to Log Window:</span>
2633 <span class="comment">% ----------------------------</span>
2634 statusLogging(handles.LogWindow, plot_cont_log_text)
2635 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2636 
2637 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2638 
2639 
2640 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2641 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2642 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2643 
2644 <span class="comment">% --------------------------------------------------------------------</span>
2645 <a name="_sub63" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2646 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2647 
2648 <span class="comment">% Get the Application data:</span>
2649 <span class="comment">% -------------------------</span>
2650 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2651 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2652 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2653 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2654 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2655 
2656 [the_file,the_path] = <span class="keyword">...</span>
2657     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2658     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2659     fullfile(guiparams.mat_path,guiparams.savefile));
2660 
2661 <span class="comment">% Save the processed data to a MAT file:</span>
2662 <span class="comment">% --------------------------------------</span>
2663 <span class="keyword">if</span> ischar(the_file)
2664     guiparams.mat_path = the_path;
2665     guiparams.mat_file = the_file;
2666     guiparams.savefile = the_file;
2667     
2668     <span class="comment">% Re-store the Application data:</span>
2669     <span class="comment">% ------------------------------</span>
2670     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2671     
2672     <span class="comment">% Update the preferences:</span>
2673     <span class="comment">% -----------------------</span>
2674     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2675     guiprefs.mat_path = the_path;
2676     guiprefs.mat_file = the_file;
2677     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2678     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2679     
2680     [~,filename,extension] = fileparts(guiparams.savefile);
2681     savefile = [filename extension];
2682     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2683         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2684     disp(<span class="string">'Saving Processed Data File...'</span>)
2685     disp(savefile)
2686     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2687 <span class="keyword">end</span>
2688 
2689 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2690 
2691 
2692 <span class="comment">% --------------------------------------------------------------------</span>
2693 <a name="_sub64" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2694 
2695 <span class="comment">% Get the Application data:</span>
2696 <span class="comment">% -------------------------</span>
2697 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2698 <span class="comment">% z   = guiparams.z;</span>
2699 <span class="comment">% A   = guiparams.A;</span>
2700 V   = guiparams.V;
2701 <span class="comment">% Map = guiparams.Map;</span>
2702 
2703 [the_file,the_path] = <span class="keyword">...</span>
2704     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2705     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2706     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2707 
2708 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2709 <span class="comment">% ------------------------------------------</span>
2710 <span class="keyword">if</span> ischar(the_file)
2711     guiparams.tecplot_path = the_path;
2712     guiparams.tecplot_file = the_file;
2713     
2714     <span class="comment">% Re-store the Application data:</span>
2715     <span class="comment">% ------------------------------</span>
2716     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2717     
2718     <span class="comment">% Update the preferences:</span>
2719     <span class="comment">% -----------------------</span>
2720     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2721     guiprefs.tecplot_path = the_path;
2722     guiprefs.tecplot_file = the_file;
2723     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2724     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2725     
2726     <span class="comment">% Push to log window</span>
2727     <span class="comment">% ------------------</span>
2728     log_text = {<span class="keyword">...</span>
2729         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2730         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2731         the_path;<span class="keyword">...</span>
2732         [<span class="string">'Filename: '</span> the_file]};
2733     statusLogging(handles.LogWindow,log_text)
2734         
2735     <span class="keyword">if</span> isempty(V)
2736         A = guiparams.A;
2737         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2738         A(1).vgns = guiparams.vertical_grid_node_spacing;
2739         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2740         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2741             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2742             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2743             guiparams.eta);
2744     <span class="keyword">end</span>
2745     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2746     
2747     <span class="comment">% Push to log window</span>
2748     <span class="comment">% ------------------</span>
2749     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2750     statusLogging(handles.LogWindow,log_text)
2751     
2752     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2753     
2754     <span class="comment">% Push to log window</span>
2755     <span class="comment">% ------------------</span>
2756     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2757     statusLogging(handles.LogWindow,log_text)
2758    
2759 <span class="keyword">end</span>
2760 
2761 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2762 
2763 
2764 <span class="comment">% --------------------------------------------------------------------</span>
2765 <a name="_sub65" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2766 
2767 <span class="comment">% Get the Application data:</span>
2768 <span class="comment">% -------------------------</span>
2769 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2770 <span class="comment">% z   = guiparams.z;</span>
2771 A   = guiparams.A;
2772 V   = guiparams.V;
2773 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2774 
2775 [the_file,the_path] = <span class="keyword">...</span>
2776     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2777     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2778     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2779 
2780 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2781 <span class="comment">% -----------------------------------------------------</span>
2782 <span class="keyword">if</span> ischar(the_file)
2783     guiparams.kmz_path = the_path;
2784     guiparams.kmz_file = the_file;
2785     
2786     <span class="comment">% Re-store the Application data:</span>
2787     <span class="comment">% ------------------------------</span>
2788     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2789     
2790     <span class="comment">% Update the preferences:</span>
2791     <span class="comment">% -----------------------</span>
2792     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2793     guiprefs.kmz_path = the_path;
2794     guiprefs.kmz_file = the_file;
2795     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2796     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2797     
2798     <span class="comment">%     if guiparams.display_shoreline</span>
2799     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2800     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2801     <span class="comment">%                             guiparams.vertical_offset);</span>
2802     <span class="comment">%     end</span>
2803     <span class="keyword">if</span> isempty(V)
2804         A = guiparams.A;
2805         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2806         A(1).vgns = guiparams.vertical_grid_node_spacing;
2807         A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2808         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2809             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2810             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2811             guiparams.eta);
2812     <span class="keyword">end</span>
2813     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2814         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2815         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2816         guiparams.vertical_offset);
2817 <span class="keyword">end</span>
2818 
2819 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2820 
2821 
2822 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2823 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2824 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2825 
2826 <span class="comment">% --------------------------------------------------------------------</span>
2827 <a name="_sub66" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2828 
2829 <span class="comment">% Get the Application data:</span>
2830 <span class="comment">% -------------------------</span>
2831 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2832 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2833 z = guiparams.z;
2834 A = guiparams.A;
2835 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2836 <span class="comment">% Map = guiparams.Map;</span>
2837 setends = guiparams.set_cross_section_endpoints;
2838 
2839 [the_file,the_path] = <span class="keyword">...</span>
2840     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2841     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2842     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2843     guiprefs.multibeambathymetry_file));
2844 
2845 <span class="keyword">if</span> ischar(the_file)
2846     guiparams.multibeambathymetry_path = the_path;
2847     guiparams.multibeambathymetry_file = the_file;
2848     
2849     <span class="comment">% Re-store the Application data:</span>
2850     <span class="comment">% ------------------------------</span>
2851     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2852     
2853     <span class="comment">% Update the preferences:</span>
2854     <span class="comment">% -----------------------</span>
2855     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2856     guiprefs.multibeambathymetry_path = the_path;
2857     guiprefs.multibeambathymetry_file = the_file;
2858     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2859     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2860     
2861     <span class="keyword">if</span> guiparams.output_auxiliary_data
2862     <span class="keyword">end</span>
2863     
2864     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2865     
2866     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2867         guiparams.multibeambathymetry_file);
2868     
2869     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2870         [<span class="string">'   '</span> savefile]};
2871     statusLogging(handles.LogWindow,log_text)
2872     
2873     <span class="comment">% Process the transects:</span>
2874     <span class="comment">% ----------------------</span>
2875     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2876     A(1).vgns = guiparams.vertical_grid_node_spacing;
2877     A(1).wse  = guiparams.wse;  <span class="comment">%Set the WSE to entered value</span>
2878     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2879         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.eta);
2880     
2881     <span class="comment">% Compute the smoothed variables</span>
2882     <span class="comment">% ------------------------------</span>
2883     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2884     <span class="comment">% runtime.</span>
2885     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2886         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2887         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2888         guiparams.vertical_smoothing_window);
2889     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2890     <span class="comment">% Push messages to Log Window:</span>
2891     <span class="comment">% ----------------------------</span>
2892     statusLogging(handles.LogWindow, processing_log_text)
2893 
2894     
2895     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2896         guiparams.A, <span class="keyword">...</span>
2897         savefile, <span class="keyword">...</span>
2898         guiparams.beam_angle, <span class="keyword">...</span>
2899         guiparams.magnetic_variation, <span class="keyword">...</span>
2900         guiparams.wse, <span class="keyword">...</span>
2901         guiparams.output_auxiliary_data);
2902     
2903     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2904     
2905 <span class="keyword">end</span>
2906 
2907 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2908 
2909 
2910 <span class="comment">% --------------------------------------------------------------------</span>
2911 <a name="_sub67" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2912 <span class="comment">% Get the beam angle</span>
2913 
2914 <span class="comment">% Get the Application data:</span>
2915 <span class="comment">% -------------------------</span>
2916 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2917 
2918 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2919 <span class="comment">% ----------------------------------------------------------------</span>
2920 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2921 is_a_number = ~isnan(new_beam_angle);
2922 is_positive = new_beam_angle&gt;=0;
2923 
2924 <span class="comment">% Modify the Application data:</span>
2925 <span class="comment">% ----------------------------</span>
2926 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2927     guiparams.beam_angle = new_beam_angle;
2928     
2929     <span class="comment">% Re-store the Application data:</span>
2930     <span class="comment">% ------------------------------</span>
2931     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2932     
2933 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2934     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2935 <span class="keyword">end</span>
2936 
2937 <span class="comment">% [EOF] BeamAngle_Callback</span>
2938 
2939 
2940 <span class="comment">% --------------------------------------------------------------------</span>
2941 <a name="_sub68" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2942 <span class="comment">% Get the Magnetic Variation</span>
2943 
2944 <span class="comment">% Get the Application data:</span>
2945 <span class="comment">% -------------------------</span>
2946 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2947 
2948 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2949 <span class="comment">% ----------------------------------------------------------------</span>
2950 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2951 is_a_number = ~isnan(new_magnetic_variation);
2952 is_positive = new_magnetic_variation&gt;=0;
2953 
2954 <span class="comment">% Modify the Application data:</span>
2955 <span class="comment">% ----------------------------</span>
2956 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2957     guiparams.magnetic_variation = new_magnetic_variation;
2958     
2959     <span class="comment">% Re-store the Application data:</span>
2960     <span class="comment">% ------------------------------</span>
2961     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2962     
2963 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2964     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2965 <span class="keyword">end</span>
2966 
2967 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2968 
2969 
2970 <span class="comment">% --------------------------------------------------------------------</span>
2971 <a name="_sub69" href="#_subfunctions" class="code">function WSE_Callback(hObject, eventdata, handles)</a>
2972 
2973 <span class="comment">% Get the Application data:</span>
2974 <span class="comment">% -------------------------</span>
2975 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2976 
2977 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2978 <span class="comment">% ----------------------------------------------------------------</span>
2979 new_wse = str2double(get(hObject,<span class="string">'String'</span>));
2980 is_a_number = ~isnan(new_wse);
2981 is_positive = new_wse&gt;=0;
2982 
2983 <span class="comment">% Modify the Application data:</span>
2984 <span class="comment">% ----------------------------</span>
2985 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2986     guiparams.wse = new_wse;
2987     
2988     <span class="comment">% Re-store the Application data:</span>
2989     <span class="comment">% ------------------------------</span>
2990     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2991     
2992 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2993     set(hObject,<span class="string">'String'</span>,guiparams.wse)
2994 <span class="keyword">end</span>
2995 
2996 <span class="comment">% [EOF] WSE_Callback</span>
2997 
2998 
2999 <span class="comment">% --------------------------------------------------------------------</span>
3000 <a name="_sub70" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3001 <span class="comment">% Bathymetry Auxiliary Data</span>
3002 
3003 <span class="comment">% Get the Application data:</span>
3004 <span class="comment">% -------------------------</span>
3005 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3006 
3007 <span class="comment">% Modify the Application data:</span>
3008 <span class="comment">% ----------------------------</span>
3009 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3010 
3011 <span class="comment">% Re-store the Application data:</span>
3012 <span class="comment">% ------------------------------</span>
3013 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3014 
3015 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3016 
3017 
3018 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3019 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3020 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3021 
3022 <span class="comment">% --------------------------------------------------------------------</span>
3023 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3024 
3025 <span class="comment">% Get the Application data:</span>
3026 <span class="comment">% -------------------------</span>
3027 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3028 
3029 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3030 <span class="comment">% ----------------------------------------------------------------</span>
3031 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3032 is_a_number = ~isnan(new_depth_range_min);
3033 is_positive = new_depth_range_min&gt;=0;
3034 
3035 <span class="comment">% Modify the Application data:</span>
3036 <span class="comment">% ----------------------------</span>
3037 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3038     guiparams.depth_range_min = new_depth_range_min;
3039     
3040     <span class="comment">% Re-store the Application data:</span>
3041     <span class="comment">% ------------------------------</span>
3042     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3043     
3044 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3045     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3046 <span class="keyword">end</span>
3047 
3048 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3049 
3050 
3051 <span class="comment">% --------------------------------------------------------------------</span>
3052 <a name="_sub72" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3053 
3054 <span class="comment">% Get the Application data:</span>
3055 <span class="comment">% -------------------------</span>
3056 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3057 
3058 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3059 <span class="comment">% ----------------------------------------------------------------</span>
3060 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3061 is_a_number = ~isnan(new_depth_range_max);
3062 is_positive = new_depth_range_max&gt;=0;
3063 
3064 <span class="comment">% Modify the Application data:</span>
3065 <span class="comment">% ----------------------------</span>
3066 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3067     guiparams.depth_range_max = new_depth_range_max;
3068     
3069     <span class="comment">% Re-store the Application data:</span>
3070     <span class="comment">% ------------------------------</span>
3071     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3072     
3073 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3074     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3075 <span class="keyword">end</span>
3076 
3077 <span class="comment">% [EOF] DepthMax_Callback</span>
3078 
3079 
3080 <span class="comment">% --------------------------------------------------------------------</span>
3081 <a name="_sub73" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3082 <span class="comment">% Set quiver scale (contour)</span>
3083 
3084 <span class="comment">% Get the Application data:</span>
3085 <span class="comment">% -------------------------</span>
3086 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3087 
3088 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3089 <span class="comment">% ----------------------------------------------------------------</span>
3090 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3091 is_a_number = ~isnan(new_vector_scale_plan_view);
3092 is_positive = new_vector_scale_plan_view&gt;=0;
3093 
3094 <span class="comment">% Modify the Application data:</span>
3095 <span class="comment">% ----------------------------</span>
3096 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3097     guiparams.vector_scale_plan_view = round(new_vector_scale_plan_view);
3098     
3099     <span class="comment">% Re-store the Application data:</span>
3100     <span class="comment">% ------------------------------</span>
3101     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3102     
3103 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3104     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3105 <span class="keyword">end</span>
3106 
3107 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3108 
3109 
3110 <span class="comment">% --------------------------------------------------------------------</span>
3111 <a name="_sub74" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3112 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3113 
3114 <span class="comment">% Get the Application data:</span>
3115 <span class="comment">% -------------------------</span>
3116 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3117 
3118 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3119 <span class="comment">% ----------------------------------------------------------------</span>
3120 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3121 is_a_number = ~isnan(new_vector_spacing_plan_view);
3122 is_positive = new_vector_spacing_plan_view&gt;=0;
3123 
3124 <span class="comment">% Modify the Application data:</span>
3125 <span class="comment">% ----------------------------</span>
3126 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3127     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3128     
3129     <span class="comment">% Re-store the Application data:</span>
3130     <span class="comment">% ------------------------------</span>
3131     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3132     
3133 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3134     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3135 <span class="keyword">end</span>
3136 
3137 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3138 
3139 
3140 <span class="comment">% --------------------------------------------------------------------</span>
3141 <a name="_sub75" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3142 <span class="comment">% Plan View smoothing window size</span>
3143 
3144 <span class="comment">% Get the Application data:</span>
3145 <span class="comment">% -------------------------</span>
3146 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3147 
3148 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3149 <span class="comment">% ----------------------------------------------------------------</span>
3150 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3151 is_a_number = ~isnan(new_smoothing_window_size);
3152 is_positive = new_smoothing_window_size&gt;=0;
3153 
3154 <span class="comment">% Modify the Application data:</span>
3155 <span class="comment">% ----------------------------</span>
3156 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3157     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3158     
3159     <span class="comment">% Re-store the Application data:</span>
3160     <span class="comment">% ------------------------------</span>
3161     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3162     
3163 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3164     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3165 <span class="keyword">end</span>
3166 
3167 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3168 
3169 
3170 <span class="comment">% --------------------------------------------------------------------</span>
3171 <a name="_sub76" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3172 
3173 <span class="comment">% Get the Application data:</span>
3174 <span class="comment">% -------------------------</span>
3175 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3176 
3177 <span class="comment">% Modify the Application data:</span>
3178 <span class="comment">% ----------------------------</span>
3179 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3180 
3181 <span class="comment">% Re-store the Application data:</span>
3182 <span class="comment">% ------------------------------</span>
3183 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3184 
3185 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3186 
3187 
3188 <span class="comment">% --------------------------------------------------------------------</span>
3189 <a name="_sub77" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3190 
3191 <span class="comment">% Get the Application data:</span>
3192 <span class="comment">% -------------------------</span>
3193 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3194 
3195 <span class="comment">% Modify the Application data:</span>
3196 <span class="comment">% ----------------------------</span>
3197 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3198 
3199 <span class="comment">% Re-store the Application data:</span>
3200 <span class="comment">% ------------------------------</span>
3201 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3202 
3203 <span class="comment">% [EOF] AddBackground_Callback</span>
3204 
3205 
3206 <span class="comment">% --------------------------------------------------------------------</span>
3207 <a name="_sub78" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3208 <a href="#_sub61" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3209 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3210 
3211 
3212 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3213 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3215 
3216 <span class="comment">% --------------------------------------------------------------------</span>
3217 <a name="_sub79" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3218 <span class="comment">% Set the horizontal grid node spacing</span>
3219 
3220 <span class="comment">% Get the Application data:</span>
3221 <span class="comment">% -------------------------</span>
3222 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3223 
3224 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3225 <span class="comment">% ----------------------------------------------------------------</span>
3226 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3227 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3228 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3229 
3230 <span class="comment">% Modify the Application data:</span>
3231 <span class="comment">% ----------------------------</span>
3232 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3233     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3234     
3235     <span class="comment">% Re-store the Application data:</span>
3236     <span class="comment">% ------------------------------</span>
3237     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3238     
3239 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3240     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3241 <span class="keyword">end</span>
3242 
3243 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3244 
3245 <span class="comment">% --------------------------------------------------------------------</span>
3246 <a name="_sub80" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3247 <span class="comment">% Set the horizontal grid node spacing</span>
3248 
3249 <span class="comment">% Get the Application data:</span>
3250 <span class="comment">% -------------------------</span>
3251 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3252 
3253 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3254 <span class="comment">% ----------------------------------------------------------------</span>
3255 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3256 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3257 is_positive = new_vertical_grid_node_spacing&gt;=0;
3258 
3259 <span class="comment">% Modify the Application data:</span>
3260 <span class="comment">% ----------------------------</span>
3261 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3262     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3263     
3264     <span class="comment">% Re-store the Application data:</span>
3265     <span class="comment">% ------------------------------</span>
3266     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3267     
3268 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3269     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3270 <span class="keyword">end</span>
3271 
3272 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3273 
3274 <span class="comment">% --------------------------------------------------------------------</span>
3275 <a name="_sub81" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3276 <span class="comment">% Set the cross section endpoints manually</span>
3277 
3278 <span class="comment">% Get the Application data:</span>
3279 <span class="comment">% -------------------------</span>
3280 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3281 
3282 <span class="comment">% Modify the Application data:</span>
3283 <span class="comment">% ----------------------------</span>
3284 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3285 
3286 <span class="comment">% Re-store the Application data:</span>
3287 <span class="comment">% ------------------------------</span>
3288 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3289 
3290 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3291 
3292 
3293 <span class="comment">% --------------------------------------------------------------------</span>
3294 <a name="_sub82" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3295 <a href="#_sub60" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3296 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3297 
3298 
3299 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3300 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3301 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3302 
3303 <span class="comment">% --------------------------------------------------------------------</span>
3304 <a name="_sub83" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3305 
3306 <span class="comment">% Get the Application data:</span>
3307 <span class="comment">% -------------------------</span>
3308 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3309 
3310 <span class="comment">% Modify the Application data:</span>
3311 <span class="comment">% ----------------------------</span>
3312 idx_variable = get(hObject,<span class="string">'Value'</span>);
3313 guiparams.idx_contour = idx_variable;
3314 guiparams.contour = guiparams.contours(idx_variable).variable;
3315 
3316 <span class="comment">% Re-store the Application data:</span>
3317 <span class="comment">% ------------------------------</span>
3318 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3319 
3320 <span class="comment">% [EOF] Contour_Callback</span>
3321 
3322 
3323 <span class="comment">% --------------------------------------------------------------------</span>
3324 <a name="_sub84" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3325 <span class="comment">% Set vertical exaggeration</span>
3326 
3327 <span class="comment">% Get the Application data:</span>
3328 <span class="comment">% -------------------------</span>
3329 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3330 
3331 <span class="comment">% Modify the Application data:</span>
3332 <span class="comment">% ----------------------------</span>
3333 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3334 
3335 <span class="comment">% Re-store the Application data:</span>
3336 <span class="comment">% ------------------------------</span>
3337 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3338 
3339 <span class="comment">% Update the GUI:</span>
3340 <span class="comment">% ---------------</span>
3341 <span class="comment">% updateGUI(handles,guiparams)</span>
3342 
3343 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3344 
3345 
3346 <span class="comment">% --------------------------------------------------------------------</span>
3347 <a name="_sub85" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3348 
3349 <span class="comment">% Get the Application data:</span>
3350 <span class="comment">% -------------------------</span>
3351 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3352 
3353 <span class="comment">% Modify the Application data:</span>
3354 <span class="comment">% ----------------------------</span>
3355 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3356 
3357 <span class="comment">% Re-store the Application data:</span>
3358 <span class="comment">% ------------------------------</span>
3359 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3360 
3361 <span class="comment">% Update the GUI:</span>
3362 <span class="comment">% ---------------</span>
3363 <span class="comment">% updateGUI(handles,guiparams)</span>
3364 
3365 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3366 
3367 
3368 <span class="comment">% --------------------------------------------------------------------</span>
3369 <a name="_sub86" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3370 
3371 <span class="comment">% Get the Application data:</span>
3372 <span class="comment">% -------------------------</span>
3373 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3374 
3375 <span class="comment">% Modify the Application data:</span>
3376 <span class="comment">% ----------------------------</span>
3377 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3378 
3379 <span class="comment">% Re-store the Application data:</span>
3380 <span class="comment">% ------------------------------</span>
3381 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3382 
3383 <span class="comment">% Update the GUI:</span>
3384 <span class="comment">% ---------------</span>
3385 <span class="comment">% updateGUI(handles,guiparams)</span>
3386 
3387 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3388 
3389 
3390 <span class="comment">% --------------------------------------------------------------------</span>
3391 <a name="_sub87" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3392 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3393 
3394 <span class="comment">% Get the Application data:</span>
3395 <span class="comment">% -------------------------</span>
3396 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3397 
3398 <span class="comment">% Modify the Application data:</span>
3399 <span class="comment">% ----------------------------</span>
3400 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3401 
3402 <span class="comment">% Re-store the Application data:</span>
3403 <span class="comment">% ------------------------------</span>
3404 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3405 
3406 <span class="comment">% Update the GUI:</span>
3407 <span class="comment">% ---------------</span>
3408 <span class="comment">% updateGUI(handles,guiparams)</span>
3409 
3410 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3411 
3412 
3413 <span class="comment">% --------------------------------------------------------------------</span>
3414 <a name="_sub88" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3415 <span class="comment">% Horizontal Smoothing</span>
3416 
3417 <span class="comment">% Get the Application data:</span>
3418 <span class="comment">% -------------------------</span>
3419 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3420 
3421 <span class="comment">% Modify the Application data:</span>
3422 <span class="comment">% ----------------------------</span>
3423 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3424 
3425 <span class="comment">% Re-store the Application data:</span>
3426 <span class="comment">% ------------------------------</span>
3427 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3428 
3429 <span class="comment">% Update the GUI:</span>
3430 <span class="comment">% ---------------</span>
3431 <span class="comment">% updateGUI(handles,guiparams)</span>
3432 
3433 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3434 
3435 
3436 <span class="comment">% --------------------------------------------------------------------</span>
3437 <a name="_sub89" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3438 <span class="comment">% Vertical Smoothing</span>
3439 
3440 <span class="comment">% Get the Application data:</span>
3441 <span class="comment">% -------------------------</span>
3442 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3443 
3444 <span class="comment">% Modify the Application data:</span>
3445 <span class="comment">% ----------------------------</span>
3446 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3447 
3448 <span class="comment">% Re-store the Application data:</span>
3449 <span class="comment">% ------------------------------</span>
3450 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3451 
3452 <span class="comment">% Update the GUI:</span>
3453 <span class="comment">% ---------------</span>
3454 <span class="comment">% updateGUI(handles,guiparams)</span>
3455 
3456 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3457 
3458 
3459 <span class="comment">% --------------------------------------------------------------------</span>
3460 <a name="_sub90" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3461 
3462 <span class="comment">% Get the Application data:</span>
3463 <span class="comment">% -------------------------</span>
3464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3465 
3466 <span class="comment">% Modify the Application data:</span>
3467 <span class="comment">% ----------------------------</span>
3468 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3469 
3470 <span class="comment">% Re-store the Application data:</span>
3471 <span class="comment">% ------------------------------</span>
3472 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3473 
3474 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3475 
3476 
3477 <span class="comment">% --------------------------------------------------------------------</span>
3478 <a name="_sub91" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3479 
3480 <span class="comment">% Get the Application data:</span>
3481 <span class="comment">% -------------------------</span>
3482 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3483 
3484 <span class="comment">% Modify the Application data:</span>
3485 <span class="comment">% ----------------------------</span>
3486 idx_variable = get(hObject,<span class="string">'Value'</span>);
3487 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3488 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3489 
3490 <span class="comment">% Re-store the Application data:</span>
3491 <span class="comment">% ------------------------------</span>
3492 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3493 
3494 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3495 
3496 
3497 <span class="comment">% --------------------------------------------------------------------</span>
3498 <a name="_sub92" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3499 
3500 <span class="comment">% Get the Application data:</span>
3501 <span class="comment">% -------------------------</span>
3502 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3503 
3504 <span class="comment">% Modify the Application data:</span>
3505 <span class="comment">% ----------------------------</span>
3506 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3507 
3508 <span class="comment">% Re-store the Application data:</span>
3509 <span class="comment">% ------------------------------</span>
3510 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3511 
3512 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3513 
3514 
3515 <span class="comment">% --------------------------------------------------------------------</span>
3516 <a name="_sub93" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3517 <a href="#_sub62" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3518 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3519 
3520 
3521 <span class="comment">% --------------------------------------------------------------------</span>
3522 <a name="_sub94" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3523 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3524 <span class="comment">% [EOF] ClearLog_Callback</span>
3525 
3526 <span class="comment">% --------------------------------------------------------------------</span>
3527 <a name="_sub95" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3528 
3529 <span class="comment">% Get the Application data:</span>
3530 <span class="comment">% -------------------------</span>
3531 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3532 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3533 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3534 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3535 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3536 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3537 
3538 [the_file,the_path] = <span class="keyword">...</span>
3539     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3540     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3541     fullfile(guiprefs.log_path,guiprefs.log_file));
3542 
3543 <span class="comment">% Save the log to a TXT file:</span>
3544 <span class="comment">% ---------------------------</span>
3545 <span class="keyword">if</span> ischar(the_file)
3546     guiparams.log_path = the_path;
3547     guiparams.log_file = the_file;
3548     <span class="comment">%guiparams.savefile = the_file;</span>
3549     
3550     <span class="comment">% Re-store the Application data:</span>
3551     <span class="comment">% ------------------------------</span>
3552     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3553     
3554     <span class="comment">% Update the preferences:</span>
3555     <span class="comment">% -----------------------</span>
3556     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3557     guiprefs.log_path = the_path;
3558     guiprefs.log_file = the_file;
3559     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3560     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3561     
3562     [~,filename,extension] = fileparts(the_file);
3563     savefile = [the_path filename extension];
3564     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3565         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3566     
3567     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3568     [nrows,~]= size(logfile);
3569     fid = fopen(savefile, <span class="string">'w'</span>);
3570     <span class="keyword">for</span> row=1:nrows
3571         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3572     <span class="keyword">end</span>
3573     fclose(fid);
3574 <span class="keyword">end</span>
3575 <span class="comment">% [EOF] SaveLog_Callback</span>
3576 
3577 <span class="comment">%%%%%%%%%%%%%%%%</span>
3578 <span class="comment">% SUBFUNCTIONS %</span>
3579 <span class="comment">%%%%%%%%%%%%%%%%</span>
3580 
3581 <span class="comment">% --------------------------------------------------------------------</span>
3582 <a name="_sub96" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3583 
3584 icons = <a href="#_sub112" class="code" title="subfunction icons = getIcons">getIcons</a>;
3585 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3586 
3587 <span class="comment">% Load data</span>
3588 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3589 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3590 <span class="comment">% icon(icon==0) = NaN;</span>
3591 handles.toolbarLoadData = <span class="keyword">...</span>
3592     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3593     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3594     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3595 
3596 <span class="comment">% Save data</span>
3597 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3598 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3599 <span class="comment">% icon(icon==0) = NaN;</span>
3600 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3601     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3602     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3603     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3604     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3605 
3606 
3607 <span class="comment">% Save bathymetry</span>
3608 <span class="comment">%icon = ones(16,16,3);</span>
3609 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3610     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3611     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3612     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3613 
3614 <span class="comment">% Save figures</span>
3615 <span class="comment">% icon = ones(16,16,3);</span>
3616 handles.toolbarSaveFigures = <span class="keyword">...</span>
3617     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3618     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3619     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3620 
3621 <span class="comment">% Save Excel File</span>
3622 <span class="comment">% icon = ones(16,16,3);</span>
3623 handles.toolbarSaveExcel = <span class="keyword">...</span>
3624     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3625     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3626     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3627 
3628 
3629 <span class="comment">% Plotting parameters</span>
3630 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3631 <span class="comment">% icon = ind2rgb(icon,map);</span>
3632 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3633     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3634     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3635     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3636     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3637 
3638 <span class="comment">% Processing parameters</span>
3639 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3640 <span class="comment">% icon = ind2rgb(icon,map);</span>
3641 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3642     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3643     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3644     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3645 
3646 <span class="comment">% Zoom In</span>
3647 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3648 <span class="comment">% icon = ind2rgb(icon,map);</span>
3649 <span class="comment">% handles.toolbarZoomIn = ...</span>
3650 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3651 <span class="comment">%     'CData',        icons(8).data, ...</span>
3652 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3653 <span class="comment">%     'Separator',     'on');</span>
3654 
3655 <span class="comment">% Zoom Out</span>
3656 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3657 <span class="comment">% icon = ind2rgb(icon,map);</span>
3658 <span class="comment">% handles.toolbarZoomOut = ...</span>
3659 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3660 <span class="comment">%     'CData',        icons(9).data, ...</span>
3661 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3662 
3663 <span class="comment">% Pan</span>
3664 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3665 <span class="comment">% icon = ind2rgb(icon,map);</span>
3666 <span class="comment">% handles.toolbarPan = ...</span>
3667 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3668 <span class="comment">%     'CData',        icons(10).data, ...</span>
3669 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3670 
3671 
3672 
3673 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3674 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3675 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub66" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3676 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3677 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3678 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3679 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub59" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3680 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3681 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3682 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3683 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3684 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3685 
3686 <span class="comment">% [EOF] buildtoolbar</span>
3687 
3688 
3689 <span class="comment">% --------------------------------------------------------------------</span>
3690 <a name="_sub97" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3691 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3692 <span class="comment">% already exist.</span>
3693 
3694 <span class="comment">% Preferences:</span>
3695 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3696 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3697 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3698 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3699 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3700 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3701 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3702 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3703 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3704 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3705 <span class="comment">% 'renderer'             Default graphics renderer</span>
3706 <span class="comment">% 'units'                Default plotting units</span>
3707 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3708 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3709 <span class="comment">%                        started</span>
3710 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3711 
3712 <span class="comment">% Originals</span>
3713 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3714 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3715 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3716 
3717 <span class="comment">% ASCII</span>
3718 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3719     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3720     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3721         guiprefs.ascii_path = ascii.path;
3722     <span class="keyword">else</span>
3723         guiprefs.ascii_path = pwd;
3724     <span class="keyword">end</span>
3725     does_exist = false(1,length(ascii.file));
3726     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3727         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3728     <span class="keyword">end</span>
3729     <span class="keyword">if</span> any(does_exist)
3730         guiprefs.ascii_file = ascii.file(does_exist);
3731     <span class="keyword">else</span>
3732         guiprefs.ascii_file = {<span class="string">''</span>};
3733     <span class="keyword">end</span>
3734 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3735     guiprefs.ascii_path = pwd;
3736     guiprefs.ascii_file = {<span class="string">''</span>};
3737     
3738     ascii.path = pwd;
3739     ascii.file = {<span class="string">''</span>};
3740     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3741 <span class="keyword">end</span>
3742 
3743 <span class="comment">% MAT</span>
3744 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3745     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3746     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3747         guiprefs.mat_path = mat.path;
3748     <span class="keyword">else</span>
3749         guiprefs.mat_path = pwd;
3750     <span class="keyword">end</span>
3751     
3752     <span class="keyword">if</span> iscell(mat.file)
3753         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3754             guiprefs.mat_file = mat.file;
3755         <span class="keyword">else</span>
3756             guiprefs.mat_file = <span class="string">''</span>;
3757         <span class="keyword">end</span>
3758     <span class="keyword">else</span>
3759         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3760             guiprefs.mat_file = mat.file;
3761         <span class="keyword">else</span>
3762             guiprefs.mat_file = <span class="string">''</span>;
3763         <span class="keyword">end</span>
3764     <span class="keyword">end</span>
3765 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3766     guiprefs.mat_path = pwd;
3767     guiprefs.mat_file = <span class="string">''</span>;
3768     
3769     mat.path = pwd;
3770     mat.file = <span class="string">''</span>;
3771     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3772 <span class="keyword">end</span>
3773 
3774 <span class="comment">% TECPLOT</span>
3775 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3776     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3777     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3778         guiprefs.tecplot_path = tecplot.path;
3779     <span class="keyword">else</span>
3780         guiprefs.tecplot_path = pwd;
3781     <span class="keyword">end</span>
3782     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3783         guiprefs.tecplot_file = tecplot.file;
3784     <span class="keyword">else</span>
3785         guiprefs.tecplot_file = <span class="string">''</span>;
3786     <span class="keyword">end</span>
3787 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3788     guiprefs.tecplot_path = pwd;
3789     guiprefs.tecplot_file = <span class="string">''</span>;
3790     
3791     tecplot.path = pwd;
3792     tecplot.file = <span class="string">''</span>;
3793     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3794 <span class="keyword">end</span>
3795 
3796 <span class="comment">% KMZ</span>
3797 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3798     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3799     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3800         guiprefs.kmz_path = kmz.path;
3801     <span class="keyword">else</span>
3802         guiprefs.kmz_path = pwd;
3803     <span class="keyword">end</span>
3804     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3805         guiprefs.kmz_file = kmz.file;
3806     <span class="keyword">else</span>
3807         guiprefs.kmz_file = <span class="string">''</span>;
3808     <span class="keyword">end</span>
3809 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3810     guiprefs.kmz_path = pwd;
3811     guiprefs.kmz_file = <span class="string">''</span>;
3812     
3813     kmz.path = pwd;
3814     kmz.file = <span class="string">''</span>;
3815     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3816 <span class="keyword">end</span>
3817 
3818 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3819 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3820     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3821     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3822         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3823     <span class="keyword">else</span>
3824         guiprefs.multibeambathymetry_path = pwd;
3825     <span class="keyword">end</span>
3826     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3827         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3828     <span class="keyword">else</span>
3829         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3830     <span class="keyword">end</span>
3831 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3832     guiprefs.multibeambathymetry_path = pwd;
3833     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3834     
3835     multibeambathymetry.path = pwd;
3836     multibeambathymetry.file = <span class="string">''</span>;
3837     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3838 <span class="keyword">end</span>
3839 
3840 <span class="comment">% Log</span>
3841 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3842     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3843     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3844         guiprefs.log_path = log.path;
3845     <span class="keyword">else</span>
3846         guiprefs.log_path = pwd;
3847     <span class="keyword">end</span>
3848     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3849         guiprefs.log_file = log.file;
3850     <span class="keyword">else</span>
3851         guiprefs.log_file = <span class="string">''</span>;
3852     <span class="keyword">end</span>
3853 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3854     guiprefs.log_path = pwd;
3855     guiprefs.log_file = <span class="string">''</span>;
3856     
3857     log.path = pwd;
3858     log.file = <span class="string">''</span>;
3859     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3860 <span class="keyword">end</span>
3861 
3862 <span class="comment">% iRic</span>
3863 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3864     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3865     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3866         guiprefs.iric_path = iric.path;
3867     <span class="keyword">else</span>
3868         guiprefs.iric_path = pwd;
3869     <span class="keyword">end</span>
3870     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3871         guiprefs.iric_file = iric.file;
3872     <span class="keyword">else</span>
3873         guiprefs.iric_file = <span class="string">''</span>;
3874     <span class="keyword">end</span>
3875 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3876     guiprefs.iric_path = pwd;
3877     guiprefs.iric_file = <span class="string">''</span>;
3878     
3879     iric.path = pwd;
3880     iric.file = <span class="string">''</span>;
3881     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3882 <span class="keyword">end</span>
3883 
3884 <span class="comment">% excel</span>
3885 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3886     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3887     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3888         guiprefs.excel_path = excel.path;
3889     <span class="keyword">else</span>
3890         guiprefs.excel_path = pwd;
3891     <span class="keyword">end</span>
3892     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3893         guiprefs.excel_file = excel.file;
3894     <span class="keyword">else</span>
3895         guiprefs.excel_file = <span class="string">''</span>;
3896     <span class="keyword">end</span>
3897 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3898     guiprefs.excel_path = pwd;
3899     guiprefs.excel_file = <span class="string">''</span>;
3900     
3901     excel.path = pwd;
3902     excel.file = <span class="string">''</span>;
3903     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3904 <span class="keyword">end</span>
3905 
3906 <span class="comment">% aerial</span>
3907 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3908     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3909     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3910         guiprefs.aerial_path = aerial.path;
3911     <span class="keyword">else</span>
3912         guiprefs.aerial_path = pwd;
3913     <span class="keyword">end</span>
3914     does_exist = false(1,length(aerial.file));
3915     <span class="keyword">if</span> iscell(aerial.file)
3916     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3917         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3918     <span class="keyword">end</span>
3919     <span class="keyword">else</span>
3920         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3921     <span class="keyword">end</span>
3922     <span class="keyword">if</span> any(does_exist)
3923         guiprefs.aerial_file = aerial.file;
3924     <span class="keyword">else</span>
3925         guiprefs.aerial_file = {<span class="string">''</span>};
3926     <span class="keyword">end</span>
3927 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3928     guiprefs.aerial_path = pwd;
3929     guiprefs.aerial_file = {<span class="string">''</span>};
3930     
3931     aerial.path = pwd;
3932     aerial.file = {<span class="string">''</span>};
3933     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3934 <span class="keyword">end</span>
3935 
3936 <span class="comment">% shoreline</span>
3937 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3938     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3939     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3940         guiprefs.shoreline_path = shoreline.path;
3941     <span class="keyword">else</span>
3942         guiprefs.shoreline_path = pwd;
3943     <span class="keyword">end</span>
3944     
3945     <span class="keyword">if</span> iscell(shoreline.file)
3946         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3947             guiprefs.shoreline_file = shoreline.file;
3948         <span class="keyword">else</span>
3949             guiprefs.shoreline_file = <span class="string">''</span>;
3950         <span class="keyword">end</span>
3951     <span class="keyword">else</span>
3952         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3953             guiprefs.shoreline_file = shoreline.file;
3954         <span class="keyword">else</span>
3955             guiprefs.shoreline_file = <span class="string">''</span>;
3956         <span class="keyword">end</span>
3957     <span class="keyword">end</span>
3958 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3959     guiprefs.shoreline_path = pwd;
3960     guiprefs.shoreline_file = <span class="string">''</span>;
3961     
3962     shoreline.path = pwd;
3963     shoreline.file = <span class="string">''</span>;
3964     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3965 <span class="keyword">end</span>
3966 <span class="comment">% guiprefs.presentation = true;</span>
3967 <span class="comment">% guiprefs.print        = false;</span>
3968 
3969 <span class="comment">% for k = 1:length(prefs)</span>
3970 <span class="comment">%     newpref = '';</span>
3971 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3972 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3973 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3974 <span class="comment">%             newpref = stored_newpref;</span>
3975 <span class="comment">%         else</span>
3976 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3977 <span class="comment">%         end</span>
3978 <span class="comment">%     end</span>
3979 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3980 <span class="comment">% end</span>
3981 
3982 <span class="comment">% RENDERER</span>
3983 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3984     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3985     guiprefs.renderer = renderer;
3986 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3987     renderer           = <span class="string">'OpenGL'</span>;
3988     guiprefs.renderer  = renderer;
3989     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3990 <span class="keyword">end</span>
3991 
3992 <span class="comment">% UNITS</span>
3993 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3994     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3995     guiprefs.units = units;
3996 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
3997     units           = <span class="string">'metric'</span>;
3998     guiprefs.units  = units;
3999     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4000 <span class="keyword">end</span>
4001 
4002 <span class="comment">% PLOTREF</span>
4003 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4004     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4005     guiprefs.plotref = plotref;
4006 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4007     plotref           = <span class="string">'dfs'</span>;
4008     guiprefs.plotref  = plotref;
4009     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4010 <span class="keyword">end</span>
4011 
4012 <span class="comment">% RUNCOUNTER</span>
4013 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4014     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4015     guiprefs.runcounter = runcounter;
4016 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4017     runcounter           = 1;
4018     guiprefs.runcounter  = runcounter;
4019     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4020 <span class="keyword">end</span>
4021 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4022 
4023 <span class="comment">% SETENDPOINTS</span>
4024 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4025     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4026     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4027         guiprefs.setendpoints_path = setendpoints.path;
4028     <span class="keyword">else</span>
4029         guiprefs.setendpoints_path = pwd;
4030     <span class="keyword">end</span>
4031     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4032         guiprefs.setendpoints_file = setendpoints.file;
4033     <span class="keyword">else</span>
4034         guiprefs.setendpoints_file = <span class="string">''</span>;
4035     <span class="keyword">end</span>
4036 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4037     guiprefs.setendpoints_path = pwd;
4038     guiprefs.setendpoints_file = <span class="string">''</span>;
4039     
4040     setendpoints.path = pwd;
4041     setendpoints.file = <span class="string">''</span>;
4042     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4043 <span class="keyword">end</span>
4044 
4045 <span class="comment">% [EOF] load_prefs</span>
4046 
4047 
4048 <span class="comment">% --------------------------------------------------------------------</span>
4049 <a name="_sub98" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4050 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4051 <span class="comment">% preferences data.</span>
4052 
4053 <span class="comment">% Preferences:</span>
4054 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4055 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4056 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4057 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4058 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4059 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4060 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4061 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4062 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4063 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4064 <span class="comment">% 'renderer'             Default graphics renderer</span>
4065 <span class="comment">% 'units'                Default plotting units</span>
4066 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4067 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4068 <span class="comment">%                        started</span>
4069 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4070 
4071 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4072 
4073 <span class="keyword">switch</span> pref
4074     <span class="keyword">case</span> <span class="string">'ascii'</span>
4075         ascii.path = guiprefs.ascii_path;
4076         ascii.file = guiprefs.ascii_file;
4077         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4078     <span class="keyword">case</span> <span class="string">'mat'</span>
4079         mat.path = guiprefs.mat_path;
4080         mat.file = guiprefs.mat_file;
4081         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4082     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4083         tecplot.path = guiprefs.tecplot_path;
4084         tecplot.file = guiprefs.tecplot_file;
4085         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4086     <span class="keyword">case</span> <span class="string">'kmz'</span>
4087         kmz.path = guiprefs.kmz_path;
4088         kmz.file = guiprefs.kmz_file;
4089         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4090     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4091         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4092         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4093         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4094     <span class="keyword">case</span> <span class="string">'log'</span>
4095         log.path = guiprefs.log_path;
4096         log.file = guiprefs.log_file;
4097         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4098     <span class="keyword">case</span> <span class="string">'iric'</span>
4099         iric.path = guiprefs.iric_path;
4100         iric.file = guiprefs.iric_file;
4101         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4102     <span class="keyword">case</span> <span class="string">'excel'</span>
4103         excel.path = guiprefs.excel_path;
4104         excel.file = guiprefs.excel_file;
4105         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4106     <span class="keyword">case</span> <span class="string">'aerial'</span>
4107         aerial.path = guiprefs.aerial_path;
4108         aerial.file = guiprefs.aerial_file;
4109         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4110     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4111         shoreline.path = guiprefs.shoreline_path;
4112         shoreline.file = guiprefs.shoreline_file;
4113         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4114     <span class="keyword">case</span> <span class="string">'renderer'</span>
4115         renderer = guiprefs.renderer;
4116         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4117     <span class="keyword">case</span> <span class="string">'units'</span>
4118         units = guiprefs.units;
4119         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4120     <span class="keyword">case</span> <span class="string">'plotref'</span>
4121         plotref = guiprefs.plotref;
4122         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4123     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4124         runcounter = guiprefs.runcounter;
4125         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4126     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4127         setendpoints.path = guiprefs.setendpoints_path;
4128         setendpoints.file = guiprefs.setendpoints_file;
4129         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4130     <span class="keyword">otherwise</span>
4131 <span class="keyword">end</span>
4132 
4133 <span class="comment">% if ismember(pref,prefs)</span>
4134 <span class="comment">%     setpref('VMT',pref,value)</span>
4135 <span class="comment">%</span>
4136 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4137 <span class="comment">%     guiprefs.(pref) = value;</span>
4138 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4139 <span class="comment">% end</span>
4140 
4141 <span class="comment">% [EOF] store_prefs</span>
4142 
4143 
4144 <span class="comment">% --------------------------------------------------------------------</span>
4145 <a name="_sub99" href="#_subfunctions" class="code">function initGUI(handles)</a>
4146 <span class="comment">% Initialize the UI controls in the GUI.</span>
4147 
4148 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4149 
4150 <span class="comment">% Set the name and version</span>
4151 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4152     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4153 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4154 
4155 <span class="comment">% Set the PLOT 1 axis labels</span>
4156 axes(handles.Plot1Shiptracks);
4157 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4158 xlabel(<span class="string">'UTM Easting (m)'</span>)
4159 ylabel(<span class="string">'UTM Northing (m)'</span>)
4160 box on
4161 grid on
4162 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4163 
4164 <span class="comment">%%%%%%%%%%%%</span>
4165 <span class="comment">% MENU BAR %</span>
4166 <span class="comment">%%%%%%%%%%%%</span>
4167 <span class="keyword">if</span> guiparams.english_units
4168     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4169     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4170 <span class="keyword">else</span>
4171     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4172     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4173 <span class="keyword">end</span>
4174 
4175 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4176     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4177     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4178 <span class="keyword">else</span>
4179     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4180     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4181 <span class="keyword">end</span>
4182 
4183 
4184 <span class="keyword">if</span> guiparams.print
4185     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4186     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4187     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4188     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4189 <span class="keyword">elseif</span> guiparams.presentation
4190     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4191     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4192     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4193     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4194 <span class="keyword">else</span>
4195 <span class="keyword">end</span>
4196 
4197 <span class="keyword">switch</span> guiparams.renderer
4198     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4199         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4200         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4201         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4202     <span class="keyword">case</span> <span class="string">'painters'</span>
4203         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4204         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4205         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4206     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4207         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4208         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4209         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4210 <span class="keyword">end</span>
4211 
4212 
4213 <span class="comment">%%%%%%%%%%%%%%%</span>
4214 <span class="comment">% DATA EXPORT %</span>
4215 <span class="comment">%%%%%%%%%%%%%%%</span>
4216 <span class="comment">% BathymetryPanel</span>
4217 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4218 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4219 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4220 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4221 
4222 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4223 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4224 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4225 <span class="comment">% PlanViewPanel</span>
4226 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4227 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4228 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4229 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4230 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4231 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4232 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4233 
4234 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4235 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4236 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4237 <span class="comment">% ShiptracksPanel</span>
4238 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4239 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4240 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4241 
4242 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4243 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4244 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4245 <span class="comment">% CrossSectionsPanel</span>
4246 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4247     <span class="string">'Value'</span>, guiparams.idx_contour)
4248 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4249 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4250 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4251 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4252 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4253 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4254 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4255 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4256     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4257 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4258 
4259 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4260 
4261 <span class="comment">% [EOF] initGUI</span>
4262 
4263 
4264 <span class="comment">% --------------------------------------------------------------------</span>
4265 <a name="_sub100" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4266 
4267 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4268 
4269 <span class="keyword">switch</span> enable_state
4270     <span class="keyword">case</span> <span class="string">'init'</span>
4271         guiparams.gui_state = <span class="string">'init'</span>;
4272         set([handles.menuFile
4273             handles.menuOpen
4274             handles.menuOpenASCII
4275             handles.menuOpenMAT
4276             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4277         
4278         set([handles.toolbarLoadData
4279             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4280         set([handles.toolbarSaveMatFile
4281             handles.toolbarSaveBathymetry
4282             handles.toolbarSaveFigures
4283             handles.toolbarSaveExcel
4284             handles.toolbarPlottingParameters
4285             handles.toolbarProcessingParameters
4286             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4287         
4288         set([handles.DepthRangeMin
4289             handles.DepthRangeMax
4290             handles.VectorScalePlanView
4291             handles.VectorSpacingPlanview
4292             handles.SmoothingWindowSize
4293             handles.DisplayShoreline
4294             handles.AddBackground
4295             handles.PlotPlanView
4296             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4297         
4298         set([handles.HorizontalGridNodeSpacing
4299             handles.VerticalGridNodeSpacing
4300             handles.PlotShiptracks
4301             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4302         
4303         set([handles.Contour
4304             handles.VerticalExaggeration
4305             handles.VectorScaleCrossSection
4306             handles.HorizontalVectorSpacing
4307             handles.VerticalVectorSpacing
4308             handles.HorizontalSmoothingWindow
4309             handles.VerticalSmoothingWindow
4310             handles.PlotSecondaryFlowVectors
4311             handles.SecondaryFlowVectorVariable
4312             handles.IncludeVerticalVelocity
4313             handles.PlotCrossSection
4314             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4315         
4316     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4317         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4318         set([handles.menuFile
4319             handles.menuOpen
4320             handles.menuOpenASCII
4321             handles.menuOpenMAT
4322             handles.menuSaveMAT
4323             handles.menuSaveTecplot
4324             handles.menuSaveKMZFile
4325             handles.menuParameters
4326             handles.menuPlottingParameters
4327             handles.menuMetric
4328             handles.menuEnglish
4329             handles.menuBathymetryExportSettings
4330             handles.menuExportMultibeamBathymetry
4331             handles.menuKMZVerticalOffset
4332             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4333         
4334         set([handles.toolbarLoadData
4335             handles.toolbarSaveMatFile
4336             handles.toolbarSaveBathymetry
4337             handles.toolbarSaveExcel
4338             handles.toolbarSaveFigures
4339             handles.toolbarPlottingParameters
4340             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4341         set([handles.toolbarProcessingParameters
4342             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4343         
4344            
4345         set([handles.DepthRangeMin
4346             handles.DepthRangeMax
4347             handles.VectorScalePlanView
4348             handles.VectorSpacingPlanview
4349             handles.SmoothingWindowSize
4350             handles.DisplayShoreline
4351             handles.PlotPlanView
4352             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4353         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4354             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4355         <span class="keyword">else</span>
4356             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4357         <span class="keyword">end</span>
4358         
4359         set([handles.HorizontalGridNodeSpacing
4360             handles.VerticalGridNodeSpacing
4361             handles.PlotShiptracks
4362             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4363         
4364         set([handles.Contour
4365             handles.VerticalExaggeration
4366             handles.VectorScaleCrossSection
4367             handles.HorizontalVectorSpacing
4368             handles.VerticalVectorSpacing
4369             handles.HorizontalSmoothingWindow
4370             handles.VerticalSmoothingWindow
4371             handles.PlotSecondaryFlowVectors
4372             handles.SecondaryFlowVectorVariable
4373             handles.IncludeVerticalVelocity
4374             handles.PlotCrossSection
4375             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4376     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4377         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4378         set([handles.menuFile
4379             handles.menuOpen
4380             handles.menuOpenASCII
4381             handles.menuOpenMAT
4382             handles.menuParameters
4383             handles.menuPlottingParameters
4384             handles.menuMetric
4385             handles.menuEnglish
4386             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4387         set([handles.menuSaveMAT
4388             handles.menuBathymetryExportSettings
4389             handles.menuExportMultibeamBathymetry
4390             handles.menuKMZVerticalOffset
4391             handles.menuSaveKMZFile
4392             handles.menuSaveTecplot
4393             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4394         
4395         set([handles.toolbarLoadData
4396             handles.toolbarSaveFigures
4397             handles.toolbarPlottingParameters
4398             handles.toolbarSaveExcel
4399             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4400         set([handles.toolbarProcessingParameters
4401             handles.toolbarSaveMatFile
4402             handles.toolbarSaveBathymetry
4403             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4404         
4405         set([handles.DepthRangeMin
4406             handles.DepthRangeMax
4407             handles.VectorScalePlanView
4408             handles.VectorSpacingPlanview
4409             handles.SmoothingWindowSize
4410             handles.DisplayShoreline
4411             handles.PlotPlanView
4412             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4413         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4414             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4415         <span class="keyword">else</span>
4416             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4417         <span class="keyword">end</span>
4418         
4419         set([handles.HorizontalGridNodeSpacing
4420             handles.VerticalGridNodeSpacing
4421             handles.PlotShiptracks
4422             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4423         
4424         set([handles.Contour
4425             handles.VerticalExaggeration
4426             handles.VectorScaleCrossSection
4427             handles.HorizontalVectorSpacing
4428             handles.VerticalVectorSpacing
4429             handles.HorizontalSmoothingWindow
4430             handles.VerticalSmoothingWindow
4431             handles.PlotSecondaryFlowVectors
4432             handles.SecondaryFlowVectorVariable
4433             handles.IncludeVerticalVelocity
4434             handles.PlotCrossSection
4435             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4436     <span class="keyword">otherwise</span>
4437 <span class="keyword">end</span>
4438 
4439 <span class="comment">% Save Application Data</span>
4440 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4441 
4442 <span class="comment">% [EOF] set_enable</span>
4443 
4444 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4445 
4446 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4447 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4448 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4449 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4450 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4451 
4452 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4453 
4454 
4455 <span class="comment">% --------------------------------------------------------------------</span>
4456 <a name="_sub101" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4457     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4458 
4459 w = 500;
4460 h = 110;
4461 dx = 10;
4462 dy = 35;
4463 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4464 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4465     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4466     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4467     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4468     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4469     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4470     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4471     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4472     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4473     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4474     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4475 dialog_params.english_units               = english_units;
4476 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4477 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4478 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4479 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4480 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4481 
4482 <span class="comment">% Build the graphics:</span>
4483 <span class="comment">% -------------------</span>
4484 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4485     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4486     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4487     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4488 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4489     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4490     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4491     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4492     <span class="string">'Position'</span>,[15 35 100 22]);
4493 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4494     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4495     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4496     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4497     <span class="string">'Position'</span>,[15 10 100 22]);
4498 
4499 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4500     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4501     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4502     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4503 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4504     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4505     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4506     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4507     <span class="string">'Position'</span>,[15 35 100 22]);
4508 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4509     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4510     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4511     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4512     <span class="string">'Position'</span>,[15 10 100 22]);
4513 
4514 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4515     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4516     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4517     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4518 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4519     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4520     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4521     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4522     <span class="string">'Position'</span>,[15 35 100 22]);
4523 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4524     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4525     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4526     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4527     <span class="string">'Position'</span>,[15 10 100 22]);
4528 
4529 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4530     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4531     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4532     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4533     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4534 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4535     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4536     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4537     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4538     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4539 
4540 <span class="comment">% Update the UI controls:</span>
4541 <span class="comment">% -----------------------</span>
4542 <span class="keyword">if</span> dialog_params.english_units
4543     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4544     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4545 <span class="keyword">else</span>
4546     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4547     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4548 <span class="keyword">end</span>
4549 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4550     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4551     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4552 <span class="keyword">else</span>
4553     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4554     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4555 <span class="keyword">end</span>
4556 <span class="keyword">if</span> dialog_params.presentation
4557     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4558     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4559 <span class="keyword">else</span>
4560     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4561     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4562 <span class="keyword">end</span>
4563 
4564 <span class="comment">% Set the callbacks:</span>
4565 <span class="comment">% ------------------</span>
4566 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4567 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4568 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4569 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4570 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4571 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4572 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4573 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4574 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4575 
4576 <span class="comment">% Position the dialog and make it visible:</span>
4577 <span class="comment">% ----------------------------------------</span>
4578 fpos = get(hf,<span class="string">'Position'</span>);
4579 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4580 movegui(handles.Figure,dpos)
4581 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4582 
4583 <span class="comment">% Hold the dialog open:</span>
4584 <span class="comment">% ---------------------</span>
4585 waitfor(handles.OK)
4586 
4587 <span class="comment">% Return the outputs and close the dialog:</span>
4588 <span class="comment">% ----------------------------------------</span>
4589 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4590 english_units = dialog_params.english_units;
4591 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4592 plot_presentation_style =  dialog_params.presentation;
4593 plot_print_style =  dialog_params.print;
4594 
4595 delete(handles.Figure)
4596 
4597 <span class="comment">% [EOF] plotParametersDialog</span>
4598 
4599 
4600 <span class="comment">% --------------------------------------------------------------------</span>
4601 <a name="_sub102" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4602 
4603 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4604 <span class="keyword">switch</span> the_units
4605     <span class="keyword">case</span> <span class="string">'metric'</span>
4606         dialog_params.english_units = false;
4607         
4608         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4609         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4610     <span class="keyword">case</span> <span class="string">'english'</span>
4611         dialog_params.english_units = true;
4612         
4613         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4614         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4615     <span class="keyword">otherwise</span>
4616 <span class="keyword">end</span>
4617 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4618 
4619 <span class="comment">% [EOF] dialogUnits</span>
4620 
4621 <span class="comment">% --------------------------------------------------------------------</span>
4622 <a name="_sub103" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4623 
4624 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4625 <span class="keyword">switch</span> the_endpoints
4626     <span class="keyword">case</span> <span class="string">'auto'</span>
4627         dialog_params.set_cross_section_endpoints = false;
4628         
4629         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4630         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4631     <span class="keyword">case</span> <span class="string">'manual'</span>
4632         dialog_params.set_cross_section_endpoints = true;
4633         
4634         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4635         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4636     <span class="keyword">otherwise</span>
4637 <span class="keyword">end</span>
4638 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4639 
4640 <span class="comment">% [EOF] dialogEnpoints</span>
4641 
4642 <a name="_sub104" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4643 
4644 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4645 <span class="keyword">switch</span> the_style
4646     <span class="keyword">case</span> <span class="string">'presentation'</span>
4647         dialog_params.presentation  = true;
4648         dialog_params.print         = false;
4649         
4650         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4651         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4652     <span class="keyword">case</span> <span class="string">'print'</span>
4653         dialog_params.presentation  = false;
4654         dialog_params.print         = true;
4655         
4656         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4657         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4658     <span class="keyword">otherwise</span>
4659 <span class="keyword">end</span>
4660 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4661 
4662 <span class="comment">% [EOF] dialogEnpoints</span>
4663 
4664 <span class="comment">% --------------------------------------------------------------------</span>
4665 <a name="_sub105" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4666 
4667 delete(h_OK)
4668 
4669 <span class="comment">% [EOF] dialogOK</span>
4670 
4671 <span class="comment">% --------------------------------------------------------------------</span>
4672 <a name="_sub106" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4673 <span class="comment">% Return the original inputs</span>
4674 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4675 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4676 delete(handles.OK)
4677 
4678 <span class="comment">% [EOF] dialogCancel</span>
4679 
4680 <span class="comment">% --------------------------------------------------------------------</span>
4681 <a name="_sub107" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4682 
4683 delete(h_OK)
4684 
4685 <span class="comment">% [EOF] dialogCloseReq</span>
4686 
4687 <a name="_sub108" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4688     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4689 w = 230;
4690 h = 245;
4691 dx = 10;
4692 dy = 35;
4693 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4694 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4695     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4696     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4697     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4698     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4699     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4700     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4701     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4702     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4703     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4704     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4705 dialog_params.beam_angle             = beam_angle;
4706 dialog_params.magnetic_variation     = magnetic_variation;
4707 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded</span>
4708     dialog_params.wse                = <span class="string">'tide'</span>;
4709     wse_string                       = <span class="string">'tide'</span>;
4710 <span class="keyword">else</span>
4711     dialog_params.wse                = wse;
4712     wse_string                       = num2str(wse);
4713 <span class="keyword">end</span>
4714 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4715 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4716 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4717 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4718 
4719 <span class="comment">% Build the graphics:</span>
4720 <span class="comment">% -------------------</span>
4721 ph = 150;
4722 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4723     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4724     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4725     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4726 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4727     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4728     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4729     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4730     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4731     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4732     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4733 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4734     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4735     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4736     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4737     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4738     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4739     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4740 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4741     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4742     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4743     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4744     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4745     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4746     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4747 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4748     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4749     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4750     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4751     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4752     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4753     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4754 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4755     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4756     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4757     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4758     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4759     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4760     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4761 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4762     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4763     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4764     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4765     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4766     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4767     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4768 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4769     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4770     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4771     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4772     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4773 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4774     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4775     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4776     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4777     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4778 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4779     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4780     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4781     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4782     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4783 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4784     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4785     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4786     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4787     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4788 
4789 <span class="comment">% Update the UI controls:</span>
4790 <span class="comment">% -----------------------</span>
4791 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4792 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4793 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4794 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4795 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4796 
4797 <span class="comment">% Set the callbacks:</span>
4798 <span class="comment">% ------------------</span>
4799 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4800 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4801 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4802 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4803 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4804 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4805 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4806 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4807 
4808 <span class="comment">% Position the dialog and make it visible:</span>
4809 <span class="comment">% ----------------------------------------</span>
4810 fpos = get(hf,<span class="string">'Position'</span>);
4811 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4812 movegui(handles.Figure,dpos)
4813 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4814 
4815 <span class="comment">% Hold the dialog open:</span>
4816 <span class="comment">% ---------------------</span>
4817 waitfor(handles.OK)
4818 
4819 <span class="comment">% Return the outputs and close the dialog:</span>
4820 <span class="comment">% ----------------------------------------</span>
4821 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4822 beam_angle              = dialog_params.beam_angle;
4823 magnetic_variation      = dialog_params.magnetic_variation;
4824 wse                     = str2num(dialog_params.wse);
4825 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4826 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4827 
4828 delete(handles.Figure)
4829 
4830 <span class="comment">% [EOF] exportSettingsDialog</span>
4831 
4832 <span class="comment">% --------------------------------------------------------------------</span>
4833 <a name="_sub109" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4834 
4835 <span class="comment">% Grab the current data</span>
4836 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4837 
4838 <span class="comment">% Set it according to the dialog box values</span>
4839 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4840 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4841 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4842 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4843 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4844 
4845 <span class="comment">% Re-store the application data</span>
4846 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4847 
4848 <span class="comment">% [EOF] dialogExportSettings</span>
4849 
4850 <a name="_sub110" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4851 
4852 w = 230;
4853 h = 200;
4854 dx = 10;
4855 dy = 35;
4856 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4857 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4858     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4859     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4860     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4861     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4862     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4863     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4864     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4865     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4866     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4867     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4868 dialog_params.figure_names               = figure_names;
4869 dialog_params.selected_figures           = <span class="string">''</span>;
4870 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4871 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4872 
4873 <span class="comment">% Build the graphics:</span>
4874 <span class="comment">% -------------------</span>
4875 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4876     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4877     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4878     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4879 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4880     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4881     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4882     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4883     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4884     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4885     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4886     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4887 
4888 
4889 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4890     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4891     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4892     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4893     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4894 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4895     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4896     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4897     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4898     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4899 
4900 <span class="comment">% Update the UI controls:</span>
4901 <span class="comment">% -----------------------</span>
4902 
4903 
4904 <span class="comment">% Set the callbacks:</span>
4905 <span class="comment">% ------------------</span>
4906 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4907 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4908 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4909 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4910 
4911 <span class="comment">% Position the dialog and make it visible:</span>
4912 <span class="comment">% ----------------------------------------</span>
4913 fpos = get(hf,<span class="string">'Position'</span>);
4914 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4915 movegui(handles.Figure,dpos)
4916 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4917 
4918 <span class="comment">% Hold the dialog open:</span>
4919 <span class="comment">% ---------------------</span>
4920 waitfor(handles.OK)
4921 
4922 <span class="comment">% Return the outputs and close the dialog:</span>
4923 <span class="comment">% ----------------------------------------</span>
4924 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4925 selected_figures = dialog_params.selected_figures;
4926 
4927 delete(handles.Figure)
4928 
4929 <span class="comment">% [EOF] openFiguresDialog</span>
4930 
4931 <span class="comment">% --------------------------------------------------------------------</span>
4932 <a name="_sub111" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4933 
4934 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4935 
4936 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4937 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4938 selected     = fig_names(idx_selected);
4939 dialog_params.selected_figures = selected;
4940 
4941 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4942 
4943 
4944 
4945 <span class="comment">% --------------------------------------------------------------------</span>
4946 <a name="_sub112" href="#_subfunctions" class="code">function icons = getIcons</a>
4947 
4948 <span class="comment">% Load data</span>
4949 idx = 1;
4950 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4951     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4952     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4953     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4954     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4955     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4956     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4957     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4958     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4959     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4960     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4961     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4962     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4963     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4964     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4965     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4966     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4967 
4968 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4969     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4970     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4971     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4972     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4973     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4974     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4975     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4976     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4977     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4978     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4979     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4980     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4981     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4982     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4983     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4984     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4985 
4986 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4987     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4988     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4989     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4990     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4991     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4992     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4993     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4994     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4995     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4996     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4997     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4998     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4999     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5000     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5001     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5002     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5003 
5004 <span class="comment">% Save data</span>
5005 idx = idx+1;
5006 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5007     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5008     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5009     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5010     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5011     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5012     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5013     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5014     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5015     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5016     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5017     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5018     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5019     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5020     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5021     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5022     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5023 
5024 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5025     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5026     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5027     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5028     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5029     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5030     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5031     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5032     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5033     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5034     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5035     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5036     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5037     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5038     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5039     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5040     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5041 
5042 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5043     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5044     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5045     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5046     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5047     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5048     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5049     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5050     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5051     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5052     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5053     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5054     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5055     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5056     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5057     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5058     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5059 
5060 <span class="comment">% Plotting parameters</span>
5061 idx = idx+1;
5062 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5063     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5064     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5065     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5066     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5067     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5068     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5069     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5070     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5071     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5072     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5073     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5074     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5075     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5076     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5077     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5078     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5079 
5080 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5081     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5082     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5083     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5084     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5085     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5086     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5087     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5088     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5089     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5090     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5091     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5092     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5093     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5094     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5095     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5096     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5097 
5098 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5099     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5100     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5101     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5102     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5103     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5104     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5105     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5106     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5107     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5108     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5109     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5110     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5111     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5112     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5113     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5114     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5115 
5116 <span class="comment">% Processing parameters</span>
5117 idx = idx+1;
5118 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5119     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5120     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5121     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5122     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5123     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5124     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5125     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5126     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5127     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5128     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5129     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5130     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5131     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5132     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5133     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5134     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5135 
5136 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5137     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5138     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5139     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5140     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5141     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5142     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5143     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5144     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5145     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5146     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5147     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5148     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5149     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5150     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5151     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5152     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5153 
5154 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5155     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5156     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5157     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5158     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5159     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5160     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5161     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5162     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5163     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5164     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5165     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5166     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5167     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5168     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5169     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5170     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5171 
5172 <span class="comment">% Export bathymetry dialog</span>
5173 idx = idx+1;
5174 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5175     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5176     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5177     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5178     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5179     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5180     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5181     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5182     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5183     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5184     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5185     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5186     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5187     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5188     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5189     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5190     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5191     ]/255;
5192 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5193     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5194     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5195     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5196     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5197     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5198     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5199     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5200     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5201     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5202     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5203     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5204     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5205     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5206     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5207     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5208     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5209     ]/255;
5210 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5211     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5212     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5213     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5214     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5215     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5216     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5217     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5218     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5219     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5220     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5221     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5222     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5223     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5224     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5225     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5226     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5227     ]/255;
5228 
5229 <span class="comment">% Export Figures Dialog</span>
5230 idx = idx + 1;
5231 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5232     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5233     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5234     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5235     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5236     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5237     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5238     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5239     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5240     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5241     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5242     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5243     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5244     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5245     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5246     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5247 
5248 
5249 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5250     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5251     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5252     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5253     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5254     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5255     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5256     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5257     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5258     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5259     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5260     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5261     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5262     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5263     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5264     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5265 
5266 
5267 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5268     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5269     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5270     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5271     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5272     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5273     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5274     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5275     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5276     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5277     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5278     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5279     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5280     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5281     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5282     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5283 
5284 <span class="comment">% Export Excel File</span>
5285 idx = idx + 1;
5286 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5287     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5288    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5289    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5290    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5291    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5292    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5293    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5294    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5295    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5296    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5297    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5298    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5299    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5300    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5301    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5302     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5303 
5304 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5305     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5306    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5307    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5308    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5309    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5310    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5311    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5312    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5313    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5314    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5315    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5316    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5317    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5318    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5319    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5320     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5321 
5322 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5323     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5324    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5325    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5326    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5327    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5328    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5329    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5330    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5331    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5332    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5333    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5334    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5335    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5336    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5337    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5338     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5339 
5340 <span class="comment">% Zoom In</span>
5341 idx = idx + 1;
5342 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5343     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5344 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5345     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5346 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5347     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5348 
5349 <span class="comment">% Zoom Out</span>
5350 idx = idx + 1;
5351 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5352     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5353 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5354     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5355 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5356     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5357 
5358 <span class="comment">% Pan</span>
5359 idx = idx + 1;
5360 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5361     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5362 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5363     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5364 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5365     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5366 <span class="comment">% [EOF] getIcons</span>
5367 
5368 <a name="_sub113" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5369 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5370 
5371 <span class="comment">% Check for any stored prefs</span>
5372 <span class="comment">% --------------------------</span>
5373 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5374 guiprefs = getpref(<span class="string">'VMT'</span>);
5375 
5376 <span class="comment">% Organized by GUI panels</span>
5377 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5378 <span class="comment">% SHIPTRACKS PLOT %</span>
5379 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5380 guiparams.horizontal_grid_node_spacing       = 1.0;
5381 guiparams.vertical_grid_node_spacing         = 0.4;
5382 
5383 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5384 <span class="comment">% CROSS SECTION PLOT %</span>
5385 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5386 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5387 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5388 guiparams.idx_contour                        = 1;
5389 guiparams.vertical_exaggeration              = 10;
5390 guiparams.vector_scale_cross_section         = 0.2;
5391 guiparams.horizontal_vector_spacing          = 1;
5392 guiparams.vertical_vector_spacing            = 1;
5393 guiparams.horizontal_smoothing_window        = 1;
5394 guiparams.vertical_smoothing_window          = 1;
5395 guiparams.plot_secondary_flow_vectors        = true;
5396 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5397 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5398 guiparams.idx_secondary_flow_vector_variable = 1;
5399 guiparams.include_vertical_velocity          = true;
5400 
5401 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5402 <span class="comment">% PLAN VIEW PLOT %</span>
5403 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5404 guiparams.depth_range_min                    = 0;
5405 guiparams.depth_range_max                    = inf;
5406 guiparams.vector_scale_plan_view             = 1;
5407 guiparams.vector_spacing_plan_view           = 1;
5408 guiparams.smoothing_window_size              = 1;
5409 guiparams.display_shoreline                  = false;
5410 guiparams.add_background                     = false;
5411 
5412 <span class="comment">%%%%%%%%%%%%%%%</span>
5413 <span class="comment">% DATA EXPORT %</span>
5414 <span class="comment">%%%%%%%%%%%%%%%</span>
5415 guiparams.beam_angle                         = 20.0;
5416 guiparams.magnetic_variation                 = 0.0;
5417 guiparams.wse                                = 0.0;
5418 guiparams.load_wse_tide_file                 = false;
5419 guiparams.output_auxiliary_data              = false;
5420 
5421 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5422 <span class="comment">% Contour variables %</span>
5423 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5424 idx = 1;
5425 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5426 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5427 idx = idx + 1;
5428 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5429 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5430 idx = idx + 1;
5431 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5432 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5433 idx = idx + 1;
5434 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5435 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5436 idx = idx + 1;
5437 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5438 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5439 idx = idx + 1;
5440 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5441 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5442 idx = idx + 1;
5443 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5444 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5445 idx = idx + 1;
5446 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5447 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5448 idx = idx + 1;
5449 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5450 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5451 idx = idx + 1;
5452 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5453 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5454 idx = idx + 1;
5455 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5456 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5457 idx = idx + 1;
5458 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5459 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5460 idx = idx + 1;
5461 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5462 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5463 idx = idx + 1;
5464 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5465 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5466 idx = idx + 1;
5467 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5468 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5469 idx = idx + 1;
5470 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5471 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5472 idx = idx + 1;
5473 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5474 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5475 idx = idx + 1;
5476 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5477 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5478 idx = idx + 1;
5479 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5480 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5481 idx = idx + 1;
5482 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5483 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5484 
5485 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5486 
5487 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5488 <span class="comment">% Secondary Flow Vector Variables %</span>
5489 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5490 idx = 1;
5491 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5492 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5493 idx = idx + 1;
5494 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5495 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5496 idx = idx + 1;
5497 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5498 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5499 idx = idx + 1;
5500 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5501 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5502 idx = idx + 1;
5503 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5504 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5505 
5506 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5507     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5508 
5509 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5510 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5511 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5512 <span class="comment">% Menu bar options</span>
5513 guiparams.presentation                       = true;
5514 guiparams.print                              = false;
5515 guiparams.set_cross_section_endpoints        = false;
5516 guiparams.unit_discharge_correction          = false;
5517 
5518 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5519     <span class="keyword">switch</span> guiprefs.units
5520         <span class="keyword">case</span> <span class="string">'metric'</span>
5521             guiparams.english_units          = false;
5522         <span class="keyword">case</span> <span class="string">'english'</span>
5523             guiparams.english_units          = true;
5524     <span class="keyword">end</span>
5525 <span class="keyword">else</span>
5526     guiparams.english_units                  = false;
5527 <span class="keyword">end</span>
5528 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5529     <span class="keyword">switch</span> guiprefs.plotref
5530         <span class="keyword">case</span> <span class="string">'dfs'</span>
5531             guiparams.plotref                 = <span class="string">'dfs'</span>;
5532         <span class="keyword">case</span> <span class="string">'hab'</span>
5533             guiparams.plotref                 = <span class="string">'hab'</span>;
5534     <span class="keyword">end</span>
5535 <span class="keyword">else</span>
5536     guiparams.plotref                         = <span class="string">'dfs'</span>;
5537 <span class="keyword">end</span>
5538 guiparams.eta                                 = 100; <span class="comment">% Used in HAB reference</span>
5539 guiparams.vertical_offset                     = 0;
5540 
5541 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5542     guiparams.renderer                       = guiprefs.renderer;
5543 <span class="keyword">else</span>
5544     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5545 <span class="keyword">end</span>
5546 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5547 <span class="comment">% guiparams.plot_planview                      = false;</span>
5548 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5549 
5550 <span class="comment">% File location defaults</span>
5551 guiparams.ascii_path                        = pwd;
5552 guiparams.ascii_file                        = <span class="string">''</span>;
5553 guiparams.mat_path                          = pwd;
5554 guiparams.mat_file                          = <span class="string">''</span>;
5555 guiparams.tecplot_path                      = pwd;
5556 guiparams.tecplot_file                      = <span class="string">''</span>;
5557 guiparams.kmz_path                          = pwd;
5558 guiparams.kmz_file                          = <span class="string">''</span>;
5559 guiparams.multibeambathymetry_path          = pwd;
5560 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5561 guiparams.log_path                          = pwd;
5562 guiparams.log_file                          = <span class="string">''</span>;
5563 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5564 <span class="comment">% application</span>
5565 <span class="keyword">if</span> isdeployed 
5566     guiparams.has_mapping_toolbox           = true;
5567 <span class="keyword">else</span>
5568     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5569         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5570 <span class="keyword">end</span>
5571 
5572 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5573 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5574 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5575 guiparams.z                      = [];
5576 guiparams.A                      = [];
5577 guiparams.V                      = [];
5578 guiparams.Map                    = [];
5579 guiparams.savefile               = [];
5580 guiparams.iric_anv_planview_data = [];
5581 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5582 <span class="comment">% guiparams.zmax = [];</span>
5583 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5584 guiparams.data_folder = <span class="string">''</span>;
5585 guiparams.data_files  = {<span class="string">''</span>};
5586 guiparams.gui_state   = <span class="string">'init'</span>;
5587 
5588 <span class="comment">% [EOF] createGUIparams</span>
5589 
5590 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5591 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5592 
5593 <a name="_sub115" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5594 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5595 
5596 <span class="comment">% [EOF] VMT</span>
5597 
5598 
5599 
5600 
5601 
5602 <span class="comment">% --- Hidden keyboard commands</span>
5603 <a name="_sub116" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5604 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5605 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5606 <span class="comment">%</span>
5607 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5608 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5609 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5610 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5611 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5612 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5613 
5614 in1 = eventdata.Modifier; 
5615 in2 = eventdata.Key;
5616 
5617 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5618     input = [in1{:} in2];
5619 <span class="keyword">else</span>
5620     input = in2;
5621 <span class="keyword">end</span>
5622 
5623 <span class="keyword">switch</span> input
5624     <span class="comment">% Hidden SonTek M9 support</span>
5625     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5626         msgtxt = {<span class="keyword">...</span>
5627             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5628             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5629             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5630             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5631             <span class="string">''</span>;<span class="keyword">...</span>
5632             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5633             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5634             <span class="string">'PROVISIONAL at best.'</span>};
5635         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5636         
5637         <span class="comment">% Get the Application data:</span>
5638         <span class="comment">% -------------------------</span>
5639         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5640         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5641         
5642         <span class="comment">% Ask the user to select files:</span>
5643         <span class="comment">% -----------------------------</span>
5644         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5645         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5646         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5647             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5648         <span class="keyword">else</span>
5649             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5650         <span class="keyword">end</span>
5651         [filename,pathname] = <span class="keyword">...</span>
5652             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5653             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5654             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5655         
5656         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5657             guiparams.data_folder = pathname;
5658             <span class="keyword">if</span> ischar(filename)
5659                 filename = {filename};
5660             <span class="keyword">end</span>
5661             guiparams.data_files = filename;
5662             guiparams.mat_file = <span class="string">''</span>;
5663             
5664             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5665             
5666             
5667             
5668             <span class="comment">% Update the preferences:</span>
5669             <span class="comment">% -----------------------</span>
5670             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5671             guiprefs.ascii_path = pathname;
5672             guiprefs.ascii_file = filename;
5673             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5674             <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5675             
5676             <span class="comment">% Push messages to Log Window:</span>
5677             <span class="comment">% ----------------------------</span>
5678             log_text = {<span class="keyword">...</span>
5679                 <span class="string">''</span>;<span class="keyword">...</span>
5680                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5681                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5682                 guiparams.data_folder;
5683                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5684                 char(filename)};
5685             statusLogging(handles.LogWindow, log_text)
5686             
5687             <span class="comment">% Read the file(s)</span>
5688             <span class="comment">% ----------------</span>
5689             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5690             
5691             [~,~,savefile,A,z] = <span class="keyword">...</span>
5692                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5693             guiparams.savefile = savefile;
5694             guiparams.A        = A;
5695             guiparams.z        = z;
5696             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5697             
5698             
5699             <span class="comment">% Update the GUI:</span>
5700             <span class="comment">% ---------------</span>
5701             <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5702         <span class="keyword">end</span>  
5703     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5704         SontekMAT2KML;
5705     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5706         <a href="#_sub51" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5707         
5708     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5709         VMT_BuildCustomFlatFile;
5710     <span class="keyword">otherwise</span>
5711         <span class="comment">%disp(input)</span>
5712 <span class="keyword">end</span>
5713 
5714 
5715 
5716</pre></div>
<hr><address>Generated on Mon 08-Jun-2015 10:37:11 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>