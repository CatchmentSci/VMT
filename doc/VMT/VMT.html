<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveExcelOutput.html" class="code" title="function [log_text] = VMT_SaveExcelOutput(excel_path,excel_file,outputType,dataPath,dataFiles,V,A,z,Map,wse,PVdata)">VMT_SaveExcelOutput</a>	Function to save Excel spreadsheet of the VMT output information</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function closeOpenFigures(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub26" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuGISExportTool_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub97" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub98" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub99" class="code">function initGUI(handles)</a></li><li><a href="#_sub100" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub101" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub102" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub103" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub104" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub105" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub106" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub108" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub109" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub110" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub111" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub112" class="code">function icons = getIcons</a></li><li><a href="#_sub113" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub114" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub116" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 <span class="comment">% Adress 2015b java bug #1293244</span>
0034 javax.swing.UIManager.setLookAndFeel(<span class="string">'com.sun.java.swing.plaf.windows.WindowsLookAndFeel'</span>)
0035 gui_Singleton = 1;
0036 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0037     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0038     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0039     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0040     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0041     <span class="string">'gui_Callback'</span>,   []);
0042 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0043     gui_State.gui_Callback = str2func(varargin{1});
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0047 <span class="keyword">try</span>
0048 <span class="keyword">if</span> nargout
0049     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">else</span>
0051     gui_mainfcn(gui_State, varargin{:});
0052 <span class="keyword">end</span>
0053 
0054 <span class="keyword">catch</span> err
0055     errdir = getenv(<span class="string">'USERPROFILE'</span>);
0056     errLogFileName = fullfile(errdir,<span class="keyword">...</span>
0057         [<span class="string">'VMTerrorLog.txt'</span>]);
0058     errWorkspace = fullfile(errdir,<span class="keyword">...</span>
0059         [<span class="string">'VMTerrorWorkspace.mat'</span>]);
0060     msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0061         <span class="string">''</span>;<span class="keyword">...</span>
0062         <span class="string">'Error details are being written to the following file: '</span>;<span class="keyword">...</span>
0063         errLogFileName;<span class="keyword">...</span>
0064         <span class="string">''</span>;<span class="keyword">...</span>
0065         <span class="string">'Attempting to save current workspace to:'</span>;<span class="keyword">...</span>
0066         errWorkspace},<span class="keyword">...</span>
0067         <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068         <span class="string">'error'</span>);
0069     handles = varargin{end};
0070     guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0071     guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0072     
0073     i=1;
0074     texterr{i} = <span class="string">'VMT version:'</span>;
0075     i=i+1;
0076     texterr{i} = guiparams.vmt_version{1};
0077     i=i+1;
0078     texterr{i} = guiparams.vmt_version{2};
0079     i=i+1;
0080     texterr{i} = [<span class="string">'Date and time of error: '</span> datestr(now)];
0081     i=i+1;
0082     texterr{i} = <span class="string">''</span>;
0083     i=i+1;
0084     texterr{i} = <span class="string">'Attempting to save current workspace to:'</span>;
0085     i=i+1;
0086     texterr{i} = [<span class="string">'    '</span> errWorkspace];
0087     i=i+1;
0088     texterr{i} = <span class="string">''</span>;
0089     i=i+1;
0090     texterr{i} = <span class="string">'Error messages:'</span>;
0091     i=i+1;
0092     texterr{i} = err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>);
0093     
0094     fid = fopen(errLogFileName,<span class="string">'W'</span>);
0095     fprintf(fid,<span class="string">'%s\r\n'</span>,texterr{:});
0096     fclose(fid);
0097     
0098     <span class="comment">% Try to save a matfile with guiparams and guiprefs</span>
0099     <span class="keyword">try</span>
0100         save(errWorkspace,<span class="string">'guiparams'</span>,<span class="string">'guiprefs'</span>,<span class="string">'-mat'</span>)
0101     <span class="keyword">catch</span> err
0102     <span class="keyword">end</span>
0103     rethrow(err)
0104 <span class="keyword">end</span>
0105 <span class="comment">% End initialization code - DO NOT EDIT</span>
0106 
0107 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0108 
0109 <span class="comment">% --- Executes just before VMT is made visible.</span>
0110 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0111 <span class="comment">% This function has no output args, see OutputFcn.</span>
0112 <span class="comment">% hObject    handle to figure</span>
0113 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0114 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0115 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0116 
0117 <span class="comment">% Choose default command line output for VMT</span>
0118 handles.output = hObject;
0119 
0120 <span class="comment">% Build the GUI toolbar:</span>
0121 <span class="comment">% ----------------------</span>
0122 handles = <a href="#_sub96" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0123 
0124 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0125 <span class="comment">% ----------------------------------------</span>
0126 <span class="keyword">if</span> ~isdeployed
0127     utilspath = [pwd filesep <span class="string">'utils'</span>];
0128     docspath  = [pwd filesep <span class="string">'doc'</span>];
0129     toolspath = [pwd filesep <span class="string">'tools'</span>];
0130     addpath(utilspath,docspath,toolspath)
0131 <span class="keyword">end</span>
0132 
0133 <span class="comment">% Update handles structure</span>
0134 <span class="comment">% ------------------------</span>
0135 guidata(hObject, handles);
0136 
0137 <span class="comment">% Load the GUI preferences:</span>
0138 <span class="comment">% -------------------------</span>
0139 <a href="#_sub97" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0140 
0141 <span class="comment">% Initialize the GUI parameters:</span>
0142 <span class="comment">% ------------------------------</span>
0143 guiparams = <a href="#_sub113" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0144 guiparams.vmt_version = {<span class="string">'v4.09'</span>; <span class="string">'r20171207'</span>};
0145 
0146 <span class="comment">% Draw the VMT Background</span>
0147 <span class="comment">% -----------------</span>
0148 pos = get(handles.figure1,<span class="string">'position'</span>);
0149 axes(handles.VMTBackground);
0150 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0151     X = imread(<span class="string">'VMT_Background.png'</span>);
0152     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0153 <span class="comment">% else</span>
0154 <span class="comment">%     X = imread('VMT_Background.png');</span>
0155 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0156 <span class="comment">%     X = uint8(X);</span>
0157 <span class="comment">%     imshow(X,'Border','tight')</span>
0158 <span class="comment">% end</span>
0159 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0160 
0161 <span class="comment">% Store the application data:</span>
0162 <span class="comment">% ---------------------------</span>
0163 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0164 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0165 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0166 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0167 
0168 <span class="comment">% Auto-check for updates</span>
0169 <span class="comment">% ----------------------</span>
0170 thres = 20; 
0171 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0172 time_to_check = (mod(runcounter,thres)==0);
0173 <span class="keyword">if</span> time_to_check
0174     <a href="#_sub55" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0175 <span class="keyword">end</span>
0176 
0177 <span class="comment">% Initialize the GUI:</span>
0178 <span class="comment">% -------------------</span>
0179 <a href="#_sub99" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0180 <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0181 
0182 <span class="comment">% Allow VMT GUI to be resized depending on the screen resolution</span>
0183 <span class="comment">% set(0,'units','pixels')</span>
0184 <span class="comment">% Pix_SS = get(0,'screensize');</span>
0185 <span class="comment">% movegui(handles.figure1,'center')</span>
0186 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0187 
0188 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0189 <span class="comment">% the root</span>
0190 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0191 
0192 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0193 <span class="comment">% uiwait(handles.figure1);</span>
0194 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0195 
0196 
0197 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0198 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0199 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0200 <span class="comment">% hObject    handle to figure</span>
0201 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0202 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0203 
0204 <span class="comment">% Get default command line output from handles structure</span>
0205 varargout{1} = handles.output;
0206 <span class="comment">% [EOF] VMT_OutputFcn</span>
0207 
0208 <span class="comment">% --- Executes when figure1 is resized.</span>
0209 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0210 
0211 <span class="comment">% Draw the VMT Background</span>
0212 <span class="comment">% -----------------</span>
0213 pos = get(handles.figure1,<span class="string">'position'</span>);
0214 axes(handles.VMTBackground);
0215 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0216     X = imread(<span class="string">'VMT_Background.png'</span>);
0217     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0218 <span class="comment">% else</span>
0219 <span class="comment">%     X = imread('VMT_Background.png');</span>
0220 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0221 <span class="comment">%     X = uint8(X);</span>
0222 <span class="comment">%     imshow(X,'Border','tight')</span>
0223 <span class="comment">% end</span>
0224 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0225 
0226 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0227 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0228 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0229 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0230 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0231 
0232 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0233 who_called = get(hObject,<span class="string">'tag'</span>);
0234 close_button = questdlg(<span class="keyword">...</span>
0235     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0236     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0237 <span class="keyword">switch</span> close_button
0238     <span class="keyword">case</span> <span class="string">'Yes'</span>
0239         closereq
0240         close all hidden
0241     <span class="keyword">otherwise</span>
0242         <span class="keyword">return</span>
0243 <span class="keyword">end</span>
0244 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0245 
0246 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0247 <span class="comment">% MENU BAR CALLBACKS %</span>
0248 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0249 
0250 <span class="comment">% --------------------------------------------------------------------</span>
0251 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0252 <span class="comment">% Empty</span>
0253 
0254 <span class="comment">% --------------------------------------------------------------------</span>
0255 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0256 <span class="comment">% Empty</span>
0257 
0258 <span class="comment">% --------------------------------------------------------------------</span>
0259 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0260 <a href="#_sub57" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0261 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0262 
0263 <span class="comment">% --------------------------------------------------------------------</span>
0264 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a>
0265 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla
0266 <a href="#_sub10" class="code" title="subfunction closeOpenFigures(hObject, eventdata, handles)">closeOpenFigures</a>(hObject, eventdata, handles)
0267 <span class="comment">% Get the Application data:</span>
0268 <span class="comment">% -------------------------</span>
0269 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0270 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271 
0272 <span class="comment">% Ask the user to select files:</span>
0273 <span class="comment">% -----------------------------</span>
0274 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0275 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0276 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0277     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0278 <span class="keyword">else</span>
0279     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0280 <span class="keyword">end</span>
0281 [filename,pathname] = <span class="keyword">...</span>
0282     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0283     <span class="string">'Select SonTek RiverSurveyor Live v3.60+ MAT File'</span>, <span class="keyword">...</span>
0284     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0285 
0286 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0287     guiparams.data_folder = pathname;
0288     <span class="keyword">if</span> ischar(filename)
0289         filename = {filename};
0290     <span class="keyword">end</span>
0291     guiparams.data_files = filename;
0292     guiparams.mat_file = <span class="string">''</span>;
0293     
0294     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0295     
0296     
0297     
0298     <span class="comment">% Update the preferences:</span>
0299     <span class="comment">% -----------------------</span>
0300     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0301     guiprefs.ascii_path = pathname;
0302     guiprefs.ascii_file = filename;
0303     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0304     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
0305     
0306     <span class="comment">% Push messages to Log Window:</span>
0307     <span class="comment">% ----------------------------</span>
0308     log_text = {<span class="keyword">...</span>
0309         <span class="string">''</span>;<span class="keyword">...</span>
0310         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
0311         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
0312         guiparams.data_folder;
0313         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
0314         char(filename)};
0315     statusLogging(handles.LogWindow, log_text)
0316     
0317     <span class="comment">% Read the file(s)</span>
0318     <span class="comment">% ----------------</span>
0319     <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
0320     
0321     [~,~,savefile,A,z] = <span class="keyword">...</span>
0322         <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
0323     guiparams.savefile = savefile;
0324     guiparams.A        = A;
0325     guiparams.z        = z;
0326     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0327     
0328     <span class="comment">% Process and display ShipTracks</span>
0329     <span class="comment">% ------------------------------</span>
0330     <a href="#_sub62" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
0331     
0332     <span class="comment">% Update the GUI:</span>
0333     <span class="comment">% ---------------</span>
0334     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0335 <span class="keyword">end</span>
0336 <span class="comment">% [EOF] menuOpenSonTekMAT_Callback</span>
0337 
0338 <span class="comment">% --------------------------------------------------------------------</span>
0339 <a name="_sub9" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0340 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla
0341 <a href="#_sub10" class="code" title="subfunction closeOpenFigures(hObject, eventdata, handles)">closeOpenFigures</a>(hObject, eventdata, handles)
0342 <span class="comment">% Get the Application data:</span>
0343 <span class="comment">% -------------------------</span>
0344 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0345 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0346 
0347 <span class="comment">% Ask the user to select files:</span>
0348 <span class="comment">% -----------------------------</span>
0349 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0350 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0351 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0352     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0353 <span class="keyword">else</span>
0354     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0355 <span class="keyword">end</span>
0356 [filename,pathname] = <span class="keyword">...</span>
0357     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0358     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0359     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0360 
0361 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0362     temp_filename = filename;
0363 <span class="keyword">elseif</span> iscell(filename)
0364     temp_filename = filename{1};
0365 <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0366     errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0367         <span class="string">'Invalid File...'</span>)
0368 <span class="keyword">end</span>
0369     
0370 <span class="comment">% Load the data:</span>
0371 <span class="comment">% --------------</span>
0372 vars = load(fullfile(pathname,temp_filename)); <span class="comment">%Use first file to get the HGNS and VGNS</span>
0373 
0374 <span class="comment">% Make sure the selected file is a valid file:</span>
0375 <span class="comment">% --------------------------------------------</span>
0376 varnames = fieldnames(vars);
0377 <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0378     guiparams.mat_path = pathname;
0379     guiparams.mat_file = temp_filename;
0380     guiparams.z = vars.z;
0381     guiparams.A = vars.A;
0382     guiparams.V = vars.V;
0383 
0384     <span class="comment">% Update the preferences:</span>
0385     <span class="comment">% -----------------------</span>
0386     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0387     guiprefs.mat_path = pathname;
0388     guiprefs.mat_file = temp_filename;
0389     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0390     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0391 
0392     <span class="comment">% Re-store the Application Data:</span>
0393     <span class="comment">% ------------------------------</span>
0394     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0395 
0396     <span class="comment">% Update the GUI:</span>
0397     <span class="comment">% ---------------</span>
0398     set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0399     guiparams.horizontal_grid_node_spacing = vars.A(1).hgns;
0400     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0401 <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0402     errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0403         <span class="string">'Invalid File...'</span>)
0404 <span class="keyword">end</span>
0405 
0406 <span class="comment">% Set the vertical grid node spacing</span>
0407 <span class="comment">% ----------------------------------</span>
0408 <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0409 <span class="comment">% Backwards compatible</span>
0410 <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0411     set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0412     guiparams.vertical_grid_node_spacing = double(vars.A(1).Sup.binSize_cm(1))/100;
0413 <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0414     set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0415     guiparams.vertical_grid_node_spacing = 0.4;
0416 <span class="keyword">end</span>
0417 
0418 <span class="comment">% Update the Application Data:</span>
0419 <span class="comment">% ------------------------------</span>
0420 <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0421 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0422     
0423 <span class="keyword">if</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0424     <span class="comment">% Set the filenames</span>
0425     <span class="comment">% -----------------</span>
0426     guiparams.mat_path = pathname;
0427     guiparams.mat_file = filename;
0428     
0429     <span class="comment">% Push status to log window</span>
0430     <span class="comment">% -------------------------</span>
0431     log_text = {<span class="keyword">...</span>
0432         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0433         <span class="string">'Directory:'</span>};
0434     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0435     statusLogging(handles.LogWindow,log_text)
0436     
0437     <span class="comment">% Update V structure to include current plotting settings</span>
0438     guiparams.V.version = guiparams.vmt_version{1}; V.release = guiparams.vmt_version{2};
0439     guiparams.V.plotSettings.shiptracks.horizontal_grid_node_spacing = guiparams.horizontal_grid_node_spacing;
0440     guiparams.V.plotSettings.shiptracks.vertical_grid_node_spacing = guiparams.vertical_grid_node_spacing;
0441     guiparams.V.plotSettings.planview.depth_range_min = guiparams.depth_range_min;
0442     guiparams.V.plotSettings.planview.depth_range_max = guiparams.depth_range_max;
0443     guiparams.V.plotSettings.planview.vector_scale_plan_view = guiparams.vector_scale_plan_view;
0444     guiparams.V.plotSettings.planview.vector_spacing_plan_view = guiparams.vector_spacing_plan_view;
0445     guiparams.V.plotSettings.planview.smoothing_window_size = guiparams.smoothing_window_size;
0446     guiparams.V.plotSettings.planview.plotref = guiparams.plotref;
0447     guiparams.V.plotSettings.mcs.contour = guiparams.contour;
0448     guiparams.V.plotSettings.mcs.vertical_exaggeration = guiparams.vertical_exaggeration;
0449     guiparams.V.plotSettings.mcs.vector_scale_cross_section = guiparams.vector_scale_cross_section;
0450     guiparams.V.plotSettings.mcs.horizontal_vector_spacing = guiparams.horizontal_vector_spacing;
0451     guiparams.V.plotSettings.mcs.vertical_vector_spacing = guiparams.vertical_vector_spacing;
0452     guiparams.V.plotSettings.mcs.horizontal_smoothing_window = guiparams.horizontal_smoothing_window;
0453     guiparams.V.plotSettings.mcs.vertical_smoothing_window = guiparams.vertical_smoothing_window;
0454     guiparams.V.plotSettings.mcs.plot_secondary_flow_vectors = guiparams.plot_secondary_flow_vectors;
0455     guiparams.V.plotSettings.mcs.secondary_flow_vector_variable = guiparams.secondary_flow_vector_variable;
0456     guiparams.V.plotSettings.mcs.include_vertical_velocity = guiparams.include_vertical_velocity;
0457     
0458     <span class="comment">% Update the Application Data:</span>
0459     <span class="comment">% ------------------------------</span>
0460     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0461     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0462     
0463     <span class="comment">% Update the persistent preferences:</span>
0464     <span class="comment">% ----------------------------------</span>
0465     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466     guiprefs.mat_path = pathname;
0467     guiprefs.mat_file = filename;
0468     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0469     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0470 <span class="keyword">end</span>
0471 
0472 
0473 <span class="comment">% Process and display ShipTracks if single cross-section loaded</span>
0474 <span class="comment">% ------------------------------</span>
0475 <span class="keyword">if</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0476     ax = findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>);
0477     axes(ax)
0478     pos = [xlim; ylim]/2; pos = pos(:,2)';
0479     TextH = text(pos(1),pos(2), <span class="string">'Multiple Mat-Files Loaded'</span>, <span class="keyword">...</span>
0480         <span class="string">'HorizontalAlignment'</span>, <span class="string">'center'</span>, <span class="keyword">...</span>
0481         <span class="string">'VerticalAlignment'</span>, <span class="string">'middle'</span>,<span class="keyword">...</span>
0482         <span class="string">'FontSize'</span>,14,<span class="keyword">...</span>
0483         <span class="string">'FontWeight'</span>,<span class="string">'bold'</span>,<span class="keyword">...</span>
0484         <span class="string">'EdgeColor'</span>,[0 0 0],<span class="keyword">...</span>
0485         <span class="string">'LineWidth'</span>,1.5);
0486 <span class="keyword">else</span>
0487     <a href="#_sub62" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
0488 <span class="keyword">end</span>
0489 
0490 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0491 
0492 <span class="comment">% --------------------------------------------------------------------</span>
0493 <a name="_sub10" href="#_subfunctions" class="code">function closeOpenFigures(hObject, eventdata, handles)</a>
0494 fig_planview_handle = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0495 <span class="keyword">if</span> ~isempty(fig_planview_handle) &amp;&amp;  ishandle(fig_planview_handle)
0496     delete(fig_planview_handle)
0497 <span class="keyword">end</span>
0498 fig_contour_handle = findobj(0,<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0499 <span class="keyword">if</span> ~isempty(fig_contour_handle) &amp;&amp;  ishandle(fig_contour_handle)
0500     delete(fig_contour_handle);
0501 <span class="keyword">end</span>
0502 <span class="comment">% [EOF] closeOpenFigures</span>
0503 
0504 <span class="comment">% --------------------------------------------------------------------</span>
0505 <a name="_sub11" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0506 <span class="comment">% Empty</span>
0507 
0508 <span class="comment">% --------------------------------------------------------------------</span>
0509 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0510 <a href="#_sub58" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0511 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0512 
0513 <span class="comment">% --------------------------------------------------------------------</span>
0514 <a name="_sub13" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0515 <a href="#_sub66" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0516 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0517 
0518 <span class="comment">% --------------------------------------------------------------------</span>
0519 <a name="_sub14" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0520 <a href="#_sub67" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0521 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0522 
0523 <span class="comment">% --------------------------------------------------------------------</span>
0524 <a name="_sub15" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0525 <span class="comment">% Empty</span>
0526 
0527 <span class="comment">% --------------------------------------------------------------------</span>
0528 <a name="_sub16" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0529 <span class="comment">% Empty</span>
0530 
0531 <span class="comment">% --------------------------------------------------------------------</span>
0532 <a name="_sub17" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0533 
0534 <span class="comment">% Get the Application Data:</span>
0535 <span class="comment">% -------------------------</span>
0536 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0537 
0538 <span class="comment">% Update the Application Data:</span>
0539 <span class="comment">% ----------------------------</span>
0540 guiparams.print        = true;
0541 guiparams.presentation = false;
0542 
0543 <span class="comment">% Re-store the Application data:</span>
0544 <span class="comment">% ------------------------------</span>
0545 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0546 
0547 <span class="comment">% Update the GUI:</span>
0548 <span class="comment">% ---------------</span>
0549 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0550 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0551 
0552 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0553 
0554 
0555 <span class="comment">% --------------------------------------------------------------------</span>
0556 <a name="_sub18" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0557 
0558 <span class="comment">% Get the Application Data:</span>
0559 <span class="comment">% -------------------------</span>
0560 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0561 
0562 <span class="comment">% Update the Application Data:</span>
0563 <span class="comment">% ----------------------------</span>
0564 guiparams.print        = false;
0565 guiparams.presentation = true;
0566 
0567 <span class="comment">% Re-store the Application data:</span>
0568 <span class="comment">% ------------------------------</span>
0569 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0570 
0571 <span class="comment">% Update the GUI:</span>
0572 <span class="comment">% ---------------</span>
0573 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0574 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0575 
0576 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0577 
0578 <span class="comment">% --------------------------------------------------------------------</span>
0579 <a name="_sub19" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0580 <span class="comment">%  --- Empty ---</span>
0581 
0582 <span class="comment">% --------------------------------------------------------------------</span>
0583 <a name="_sub20" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0584 <span class="comment">% Get the Application Data:</span>
0585 <span class="comment">% -------------------------</span>
0586 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0587 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0588 
0589 <span class="comment">% Update the Application Data:</span>
0590 <span class="comment">% ----------------------------</span>
0591 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0592 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0593 
0594 <span class="comment">% Re-store the Application data:</span>
0595 <span class="comment">% ------------------------------</span>
0596 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0597 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0598 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0599 
0600 <span class="comment">% Update the GUI:</span>
0601 <span class="comment">% ---------------</span>
0602 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0603 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0604 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0605 
0606 <span class="comment">% Modify the existing figures</span>
0607 <span class="comment">% ---------------------------</span>
0608 <span class="comment">% Find what plots exist already</span>
0609 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0610 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0611 
0612 <span class="comment">% Loop through valid figures and adjust</span>
0613 <span class="comment">% -------------------------------------</span>
0614 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0615     <span class="keyword">for</span> i = 1:length(valid_names)
0616         <span class="comment">% Focus the figure</span>
0617         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0618         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0619             figure(hff)
0620             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0621         <span class="keyword">end</span>
0622         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0623         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0624             figure(hff)
0625             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0626         <span class="keyword">end</span>
0627     <span class="keyword">end</span>
0628 <span class="keyword">end</span>
0629 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0630 
0631 
0632 <span class="comment">% --------------------------------------------------------------------</span>
0633 <a name="_sub21" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0634 <span class="comment">% Get the Application Data:</span>
0635 <span class="comment">% -------------------------</span>
0636 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0637 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0638 
0639 <span class="comment">% Update the Application Data:</span>
0640 <span class="comment">% ----------------------------</span>
0641 guiparams.renderer  = <span class="string">'painters'</span>;
0642 guiprefs.renderer   = <span class="string">'painters'</span>;
0643 
0644 <span class="comment">% Re-store the Application data:</span>
0645 <span class="comment">% ------------------------------</span>
0646 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0647 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0648 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0649 
0650 <span class="comment">% Update the GUI:</span>
0651 <span class="comment">% ---------------</span>
0652 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0653 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0654 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0655 
0656 <span class="comment">% Modify the existing figures</span>
0657 <span class="comment">% ---------------------------</span>
0658 <span class="comment">% Find what plots exist already</span>
0659 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0660 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0661 
0662 <span class="comment">% Loop through valid figures and adjust</span>
0663 <span class="comment">% -------------------------------------</span>
0664 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0665     <span class="keyword">for</span> i = 1:length(valid_names)
0666         <span class="comment">% Focus the figure</span>
0667         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0668         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0669             figure(hff)
0670             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0671         <span class="keyword">end</span>
0672         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0673         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0674             figure(hff)
0675             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0676         <span class="keyword">end</span>
0677     <span class="keyword">end</span>
0678 <span class="keyword">end</span>
0679 <span class="comment">% [EOF] menuPainters_Callback</span>
0680 
0681 <span class="comment">% --------------------------------------------------------------------</span>
0682 <a name="_sub22" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0683 <span class="comment">% Get the Application Data:</span>
0684 <span class="comment">% -------------------------</span>
0685 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0686 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0687 
0688 <span class="comment">% Update the Application Data:</span>
0689 <span class="comment">% ----------------------------</span>
0690 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0691 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0692 
0693 <span class="comment">% Re-store the Application data:</span>
0694 <span class="comment">% ------------------------------</span>
0695 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0696 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0697 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0698 
0699 <span class="comment">% Update the GUI:</span>
0700 <span class="comment">% ---------------</span>
0701 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0702 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0703 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0704 
0705 <span class="comment">% Modify the existing figures</span>
0706 <span class="comment">% ---------------------------</span>
0707 <span class="comment">% Find what plots exist already</span>
0708 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0709 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0710 
0711 <span class="comment">% Loop through valid figures and adjust</span>
0712 <span class="comment">% -------------------------------------</span>
0713 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0714     <span class="keyword">for</span> i = 1:length(valid_names)
0715         <span class="comment">% Focus the figure</span>
0716         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0717         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0718             figure(hff)
0719             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0720         <span class="keyword">end</span>
0721         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0722         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0723             figure(hff)
0724             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0725         <span class="keyword">end</span>
0726     <span class="keyword">end</span>
0727 <span class="keyword">end</span>
0728 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0729 
0730 <span class="comment">% --------------------------------------------------------------------</span>
0731 <a name="_sub23" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0732 <span class="comment">% Get the Application data:</span>
0733 <span class="comment">% -------------------------</span>
0734 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0735 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0736 
0737 <span class="comment">% Find what plots exist already</span>
0738 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0739 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0740 
0741 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0742 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0743 <span class="keyword">if</span> ~isempty(idx)
0744     fig_names(idx) = [];
0745 <span class="keyword">end</span>
0746 
0747 <span class="keyword">if</span> guiparams.presentation
0748     figure_style = <span class="string">'presentation'</span>;
0749 <span class="keyword">else</span>
0750     figure_style = <span class="string">'print'</span>;
0751 <span class="keyword">end</span>
0752 
0753 [selected_figures] = <a href="#_sub110" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0754 
0755 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0756     <span class="keyword">return</span>
0757 <span class="keyword">else</span>
0758     <span class="keyword">for</span> i = 1:length(selected_figures)
0759         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0760     <span class="keyword">end</span>
0761 <span class="keyword">end</span>
0762 
0763 
0764 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0765 
0766 <span class="comment">% --------------------------------------------------------------------</span>
0767 <a name="_sub24" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0768 <span class="comment">% Get the Application data:</span>
0769 <span class="comment">% -------------------------</span>
0770 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0771 beam_angle             = guiparams.beam_angle; 
0772 magnetic_variation     = guiparams.magnetic_variation; 
0773 wse                    = guiparams.water_surface_elevation;
0774 output_auxiliary_data  = guiparams.output_auxiliary_data;
0775 load_wse_tide_file     = guiparams.load_wse_tide_file;
0776 
0777 <span class="comment">% Open dialog and allow user to select settings</span>
0778 <span class="comment">% ---------------------------------------------</span>
0779 [beam_angle,<span class="keyword">...</span>
0780     magnetic_variation,<span class="keyword">...</span>
0781     wse,<span class="keyword">...</span>
0782     output_auxiliary_data,<span class="keyword">...</span>
0783     load_wse_tide_file] = <span class="keyword">...</span>
0784     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0785 
0786 <span class="comment">% Re-store the Application data:</span>
0787 <span class="comment">% ------------------------------</span>
0788 guiparams.beam_angle            = beam_angle;
0789 guiparams.magnetic_variation    = magnetic_variation; 
0790 guiparams.load_wse_tide_file    = load_wse_tide_file;
0791 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0792       infile = fullfile(<span class="keyword">...</span>
0793         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0794         guiparams.multibeambathymetry_file);
0795     [wsedata] = <a href="#_sub25" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0796     guiparams.water_surface_elevation = wsedata;
0797 <span class="keyword">else</span>
0798       guiparams.water_surface_elevation = wse;
0799 <span class="keyword">end</span>
0800 guiparams.output_auxiliary_data = output_auxiliary_data;
0801 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0802 
0803 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0804 
0805 <span class="comment">% --------------------------------------------------------------------</span>
0806 <a name="_sub25" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0807 <span class="comment">% wsedata.obstime</span>
0808 <span class="comment">% wsedata.elev</span>
0809 
0810 <span class="comment">% Determine Files to Process</span>
0811 <span class="comment">% Ask the user to select files:</span>
0812 <span class="comment">% -----------------------------</span>
0813 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0814     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0815     infile, <span class="keyword">...</span>
0816     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0817 
0818 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0819     data = csvread(fullfile(zPathName,zFileName));
0820     wsedata.obstime = datenum(data(:,1:6));
0821     wsedata.elev    = data(:,7);
0822 <span class="keyword">else</span>
0823     wsedata.obstime = [];
0824     wsedata.elev    = [];
0825     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0826 <span class="keyword">end</span>
0827 <span class="comment">%  [EOF] loadTideFile</span>
0828 
0829 <span class="comment">% --------------------------------------------------------------------</span>
0830 <a name="_sub26" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0831 <a href="#_sub68" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0832 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0833 
0834 
0835 <span class="comment">% --------------------------------------------------------------------</span>
0836 <a name="_sub27" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0837 
0838 <span class="comment">% Get the Application Data:</span>
0839 <span class="comment">% -------------------------</span>
0840 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0841 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0842 PVdata    = guiparams.iric_anv_planview_data;
0843 iric_path = guiprefs.iric_path;
0844 iric_file = guiprefs.iric_file;
0845 
0846 <span class="comment">% Is there any planview data?</span>
0847 <span class="keyword">if</span> isempty(PVdata)
0848     <span class="comment">% Nothing to do, warn user</span>
0849     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0850     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0851 <span class="keyword">else</span>
0852     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0853     <span class="comment">% and smoothing (for iRiC)</span>
0854     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0855     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0856         fullfile(iric_path,iric_file));
0857     
0858     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0859         outfile = fullfile(iric_path,iric_file);
0860         log_text = vertcat(log_text,{outfile});
0861         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0862         outcount = fprintf(ofid,<span class="keyword">...</span>
0863             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0864         fclose(ofid);
0865     <span class="keyword">else</span>
0866         <span class="comment">% Return default iric_path and iric_file</span>
0867         iric_path = guiprefs.iric_path;
0868         iric_file = guiprefs.iric_file;
0869     <span class="keyword">end</span>
0870 <span class="keyword">end</span>
0871 
0872 <span class="comment">% Push messages to Log Window:</span>
0873 <span class="comment">% ----------------------------</span>
0874 statusLogging(handles.LogWindow, log_text)
0875 
0876 <span class="comment">% Store the persistent preferences:</span>
0877 <span class="comment">% ---------------------------------</span>
0878 guiprefs.iric_file = iric_file;
0879 guiprefs.iric_path = iric_path;
0880 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0881 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0882 
0883 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0884 
0885 <span class="comment">% --------------------------------------------------------------------</span>
0886 <a name="_sub28" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0887 <span class="comment">% Get the Application Data:</span>
0888 <span class="comment">% -------------------------</span>
0889 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0890 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0891 excel_path  = guiprefs.excel_path;
0892 excel_file  = guiprefs.excel_file;
0893 
0894 <span class="comment">% Push messages to Log Window:</span>
0895 <span class="comment">% ----------------------------</span>
0896 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0897 statusLogging(handles.LogWindow, log_text)
0898 
0899 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0900 <span class="comment">% data.</span>
0901 <span class="keyword">if</span> iscell(guiparams.mat_file)
0902     outputType = <span class="string">'Multiple'</span>;
0903     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0904     <a href="#_sub63" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0905     <span class="comment">% Refresh the Application Data:</span>
0906     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0907     z           = guiparams.z;
0908     A           = guiparams.A;
0909     V           = guiparams.V;
0910     Map         = guiparams.Map;
0911     wse         = guiparams.water_surface_elevation;
0912     PVdata      = guiparams.iric_anv_planview_data;
0913     dataFiles = guiparams.mat_file;
0914     dataPath  = guiparams.mat_path;
0915     [log_text] = <a href="VMT_SaveExcelOutput.html" class="code" title="function [log_text] = VMT_SaveExcelOutput(excel_path,excel_file,outputType,dataPath,dataFiles,V,A,z,Map,wse,PVdata)">VMT_SaveExcelOutput</a>(excel_path,excel_file,outputType,dataPath,dataFiles,V,A,z,Map,wse,PVdata);
0916     
0917 <span class="comment">%     if ischar(excel_path) % The user did not hit &quot;Cancel&quot;</span>
0918 <span class="comment">%         full_excelfile = fullfile(excel_path,excel_file);</span>
0919 <span class="comment">%         %log_text = vertcat(log_text,{outfile});</span>
0920 <span class="comment">%</span>
0921 <span class="comment">%     else</span>
0922 <span class="comment">%         % Return default excel_path and excel_file</span>
0923 <span class="comment">%         excel_path = guiprefs.excel_path;</span>
0924 <span class="comment">%         excel_file = guiprefs.excel_file;</span>
0925 <span class="comment">%         full_excelfile = fullfile(excel_path,excel_file);</span>
0926 <span class="comment">%         %log_text = vertcat(log_text,{outfile});</span>
0927 <span class="comment">%     end</span>
0928     
0929     
0930 <span class="keyword">else</span>
0931     outputType = <span class="string">'Single'</span>;
0932     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0933     <a href="#_sub63" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0934     <a href="#_sub64" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0935     <span class="comment">% Refresh the Application Data:</span>
0936     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0937     z           = guiparams.z;
0938     A           = guiparams.A;
0939     V           = guiparams.V;
0940     Map         = guiparams.Map;
0941     wse         = guiparams.water_surface_elevation;
0942     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0943                                                     <span class="comment">% Planview Plot exactly</span>
0944   
0945     <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
0946         dataFiles = {guiparams.mat_file};
0947         dataPath  = {guiparams.mat_path};
0948     <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0949         dataFiles = guiparams.data_files';
0950         dataPath  = {guiparams.ascii_path};
0951     <span class="keyword">end</span>
0952     [log_text] = <a href="VMT_SaveExcelOutput.html" class="code" title="function [log_text] = VMT_SaveExcelOutput(excel_path,excel_file,outputType,dataPath,dataFiles,V,A,z,Map,wse,PVdata)">VMT_SaveExcelOutput</a>(excel_path,excel_file,outputType,dataPath,dataFiles,V,A,z,Map,wse,PVdata);
0953 <span class="keyword">end</span>
0954 
0955 <span class="comment">% Push messages to Log Window:</span>
0956 <span class="comment">% ----------------------------</span>
0957 statusLogging(handles.LogWindow, log_text)
0958 
0959 <span class="comment">% Store the persistent preferences:</span>
0960 <span class="comment">% ---------------------------------</span>
0961 guiprefs.excel_file = excel_file;
0962 guiprefs.excel_path = excel_path;
0963 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0964 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
0965 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
0966 
0967 
0968 <span class="comment">% --------------------------------------------------------------------</span>
0969 <a name="_sub29" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
0970 <span class="comment">% Call separate GUI</span>
0971 VMT_BuildCustomFlatFile;
0972 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
0973 
0974 <span class="comment">% --------------------------------------------------------------------</span>
0975 <a name="_sub30" href="#_subfunctions" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a>
0976 <span class="comment">% Empty</span>
0977 
0978 <span class="comment">% --------------------------------------------------------------------</span>
0979 <a name="_sub31" href="#_subfunctions" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a>
0980 <span class="comment">% Empty</span>
0981 
0982 <span class="comment">% --------------------------------------------------------------------</span>
0983 <a name="_sub32" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
0984 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
0985 
0986 <span class="comment">% Get the Application Data:</span>
0987 <span class="comment">% -------------------------</span>
0988 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0989 
0990 <span class="comment">% Update the GUI &amp; Application Data:</span>
0991 <span class="comment">% ----------------------------------</span>
0992 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
0993 <span class="keyword">switch</span> status
0994     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
0995         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0996         guiparams.unit_discharge_correction = false;
0997     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
0998         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0999         guiparams.unit_discharge_correction = true;
1000 <span class="keyword">end</span>
1001 
1002 <span class="comment">% Re-store the Application data:</span>
1003 <span class="comment">% ------------------------------</span>
1004 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1005 
1006 
1007 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1008 
1009 <span class="comment">% --------------------------------------------------------------------</span>
1010 <a name="_sub33" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1011 <span class="comment">% Empty</span>
1012 
1013 <span class="comment">% --------------------------------------------------------------------</span>
1014 <a name="_sub34" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1015 <span class="comment">% Empty</span>
1016 
1017 <span class="comment">% --------------------------------------------------------------------</span>
1018 <a name="_sub35" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1019 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1020 
1021 <span class="comment">% Get the Application Data:</span>
1022 <span class="comment">% -------------------------</span>
1023 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1024 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1025 
1026 <span class="comment">% Update the Application Data:</span>
1027 <span class="comment">% ----------------------------</span>
1028 guiparams.english_units = false;
1029 guiprefs.units = <span class="string">'metric'</span>;
1030 
1031 <span class="comment">% Re-store the Application data:</span>
1032 <span class="comment">% ------------------------------</span>
1033 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1034 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1035 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1036 
1037 <span class="comment">% Update the GUI:</span>
1038 <span class="comment">% ---------------</span>
1039 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1040 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1041 
1042 <span class="comment">% [EOF] menuMetric_Callback</span>
1043 
1044 
1045 <span class="comment">% --------------------------------------------------------------------</span>
1046 <a name="_sub36" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1047 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1048 
1049 <span class="comment">% Get the Application Data:</span>
1050 <span class="comment">% -------------------------</span>
1051 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1052 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1053 
1054 <span class="comment">% Update the Application Data:</span>
1055 <span class="comment">% ----------------------------</span>
1056 guiparams.english_units = true;
1057 guiprefs.units = <span class="string">'english'</span>;
1058 
1059 <span class="comment">% Re-store the Application data:</span>
1060 <span class="comment">% ------------------------------</span>
1061 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1062 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1063 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1064 
1065 <span class="comment">% Update the GUI:</span>
1066 <span class="comment">% ---------------</span>
1067 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1068 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1069 
1070 <span class="comment">% [EOF] menuEnglish_Callback</span>
1071 
1072 <span class="comment">% --------------------------------------------------------------------</span>
1073 <a name="_sub37" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1074 <span class="comment">% Empty</span>
1075 
1076 <span class="comment">% --------------------------------------------------------------------</span>
1077 <a name="_sub38" href="#_subfunctions" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a>
1078 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1079 <span class="comment">% surface)</span>
1080 
1081 <span class="comment">% Get the Application Data:</span>
1082 <span class="comment">% -------------------------</span>
1083 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1084 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1085 
1086 <span class="keyword">switch</span> guiparams.plotref
1087     <span class="keyword">case</span> <span class="string">'dfs'</span>  <span class="comment">% Depth from surface</span>
1088         <span class="comment">% Update the Application Data:</span>
1089         <span class="comment">% ----------------------------</span>
1090         guiparams.plotref = <span class="string">'dfs'</span>;
1091         guiprefs.plotref  = <span class="string">'dfs'</span>;
1092         
1093         <span class="comment">% Re-store the Application data:</span>
1094         <span class="comment">% ------------------------------</span>
1095         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1096         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1097         <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1098         
1099         <span class="comment">% Update the GUI:</span>
1100         <span class="comment">% ---------------</span>
1101         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1102     <span class="keyword">case</span> <span class="string">'hab'</span> <span class="comment">% Height above bed</span>
1103         <span class="comment">% Update the Application Data:</span>
1104         <span class="comment">% ----------------------------</span>
1105         guiparams.plotref = <span class="string">'hab'</span>;
1106         guiprefs.plotref  = <span class="string">'hab'</span>;
1107         
1108         <span class="comment">% Re-store the Application data:</span>
1109         <span class="comment">% ------------------------------</span>
1110         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1111         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1112         <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1113         
1114         <span class="comment">% Update the GUI:</span>
1115         <span class="comment">% ---------------</span>
1116         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1117 <span class="keyword">end</span>
1118 <span class="comment">% [EOF] VerticalReference_Callback</span>
1119 
1120 
1121 <span class="comment">% --------------------------------------------------------------------</span>
1122 <a name="_sub39" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1123 <span class="comment">% Empty</span>
1124 
1125 <span class="comment">% --------------------------------------------------------------------</span>
1126 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1127 <span class="comment">% Set cross-section endpoints automatically</span>
1128 
1129 <span class="comment">% Get the Application Data:</span>
1130 <span class="comment">% -------------------------</span>
1131 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1132 
1133 <span class="comment">% Update the Application Data:</span>
1134 <span class="comment">% ----------------------------</span>
1135 guiparams.set_cross_section_endpoints = false;
1136 
1137 <span class="comment">% Re-store the Application data:</span>
1138 <span class="comment">% ------------------------------</span>
1139 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1140 
1141 <span class="comment">% Update the GUI:</span>
1142 <span class="comment">% ---------------</span>
1143 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1144 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1145 
1146 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1147 
1148 
1149 <span class="comment">% --------------------------------------------------------------------</span>
1150 <a name="_sub41" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1151 <span class="comment">% Set cross-section endpoints manually</span>
1152 
1153 <span class="comment">% Get the Application Data:</span>
1154 <span class="comment">% -------------------------</span>
1155 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1156 
1157 <span class="comment">% Update the Application Data:</span>
1158 <span class="comment">% ----------------------------</span>
1159 guiparams.set_cross_section_endpoints = true;
1160 
1161 <span class="comment">% Re-store the Application data:</span>
1162 <span class="comment">% ------------------------------</span>
1163 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1164 
1165 <span class="comment">% Update the GUI:</span>
1166 <span class="comment">% ---------------</span>
1167 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1168 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1169 
1170 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1171 
1172 
1173 
1174 
1175 <span class="comment">% --------------------------------------------------------------------</span>
1176 <a name="_sub42" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1177 <span class="comment">% Empty</span>
1178 
1179 <span class="comment">% --------------------------------------------------------------------</span>
1180 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1181 
1182 <span class="comment">% Get the Application Data:</span>
1183 <span class="comment">% -------------------------</span>
1184 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1185 
1186 <span class="comment">% Update the Application Data:</span>
1187 <span class="comment">% ----------------------------</span>
1188 guiparams.print        = true;
1189 guiparams.presentation = false;
1190 
1191 <span class="comment">% Re-store the Application data:</span>
1192 <span class="comment">% ------------------------------</span>
1193 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1194 
1195 <span class="comment">% Update the GUI:</span>
1196 <span class="comment">% ---------------</span>
1197 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1198 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1199 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1200 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1201 
1202 <span class="comment">% Modify the existing figures</span>
1203 <span class="comment">% ---------------------------</span>
1204 <span class="comment">% Find what plots exist already</span>
1205 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1206 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1207 
1208 <span class="comment">% Defaults for Print Stlye Figure</span>
1209 BkgdColor   = <span class="string">'white'</span>;
1210 AxColor     = <span class="string">'black'</span>;
1211 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1212 FntSize     = 14;
1213 
1214 <span class="comment">% Loop through valid figures and adjust</span>
1215 <span class="comment">% -------------------------------------</span>
1216 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1217     
1218     <span class="keyword">for</span> i = 1:length(valid_names)
1219         <span class="keyword">switch</span> valid_names{i}
1220             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1221                 <span class="comment">% Focus the figure</span>
1222                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1223                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1224                     figure(hff)
1225                     
1226                     <span class="comment">% Make the changes to figure</span>
1227                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1228                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1229                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1230                     set(gca,<span class="string">'Color'</span>,FigColor)
1231                     set(gca,<span class="string">'XColor'</span>,AxColor)
1232                     set(gca,<span class="string">'YColor'</span>,AxColor)
1233                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1234                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1235                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1236                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1237                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1238                         <span class="string">'YColor'</span>,AxColor);
1239                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1240                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1241                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1242                     
1243                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1244                     <span class="comment">% the file(s) and path for the data</span>
1245                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1246                     <span class="keyword">if</span> ~ismultiplot
1247                         filestr = guiparams.savefile;
1248                         wd = length(filestr);
1249                         hd = 1;
1250                     <span class="keyword">else</span>
1251                         <span class="comment">% Construct a filename</span>
1252                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1253                         wd        = max(cellfun(@length,filestr));
1254                         hd        = numel(filestr);
1255                             
1256                     <span class="keyword">end</span>
1257                     
1258                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1259                     disableMenuBar(hff)
1260                     set(fileinfotxt,<span class="keyword">...</span>
1261                         <span class="string">'string'</span>,filestr)
1262                     set(fileinfotxt,<span class="keyword">...</span>
1263                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1264                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1265                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1266                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1267                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1268                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1269                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1270                     
1271                 <span class="keyword">end</span>
1272             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1273                 <span class="comment">% Focus the figure</span>
1274                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1275                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1276                     figure(hff)
1277                     
1278                     <span class="comment">% Make the changes to figure</span>
1279                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1280                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1281                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1282                     set(gca,<span class="string">'Color'</span>,FigColor)
1283                     set(gca,<span class="string">'XColor'</span>,AxColor)
1284                     set(gca,<span class="string">'YColor'</span>,AxColor)
1285                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1286                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1287                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1288                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1289                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1290                         <span class="string">'YColor'</span>,AxColor);
1291                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1292                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1293                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1294                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1295                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1296                     
1297                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1298                     <span class="comment">% the file(s) and path for the data</span>
1299                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1300                     <span class="keyword">if</span> ~ismultiplot
1301                         filestr = guiparams.savefile;
1302                         wd = length(filestr);
1303                         hd = 1;
1304                     <span class="keyword">else</span>
1305                         <span class="comment">% Construct a filename</span>
1306                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1307                         wd        = max(cellfun(@length,filestr));
1308                         hd        = numel(filestr);
1309                             
1310                     <span class="keyword">end</span>
1311                     
1312                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1313                     disableMenuBar(hff)
1314                     set(fileinfotxt,<span class="keyword">...</span>
1315                         <span class="string">'string'</span>,filestr)
1316                     set(fileinfotxt,<span class="keyword">...</span>
1317                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1318                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1319                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1320                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1321                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1322                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1323                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1324                 <span class="keyword">end</span>
1325             <span class="keyword">otherwise</span>
1326         <span class="keyword">end</span>
1327     <span class="keyword">end</span>
1328     
1329     
1330 <span class="keyword">end</span>
1331 
1332 
1333 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1334 
1335 
1336 <span class="comment">% --------------------------------------------------------------------</span>
1337 <a name="_sub44" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1338 <span class="comment">% Get the Application Data:</span>
1339 <span class="comment">% -------------------------</span>
1340 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1341 
1342 <span class="comment">% Update the Application Data:</span>
1343 <span class="comment">% ----------------------------</span>
1344 guiparams.print        = false;
1345 guiparams.presentation = true;
1346 
1347 <span class="comment">% Re-store the Application data:</span>
1348 <span class="comment">% ------------------------------</span>
1349 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1350 
1351 <span class="comment">% Update the GUI:</span>
1352 <span class="comment">% ---------------</span>
1353 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1354 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1355 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1356 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1357 
1358 <span class="comment">% Modify the existing figures</span>
1359 <span class="comment">% ---------------------------</span>
1360 <span class="comment">% Find what plots exist already</span>
1361 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1362 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1363 
1364 <span class="comment">% Defaults for Presentation Style Figure</span>
1365 <span class="comment">% --------------------------------------</span>
1366 BkgdColor   = <span class="string">'black'</span>;
1367 AxColor     = <span class="string">'white'</span>;
1368 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1369 FntSize     = 14;
1370 
1371 <span class="comment">% Loop through valid figures and adjust</span>
1372 <span class="comment">% -------------------------------------</span>
1373 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1374     
1375     <span class="keyword">for</span> i = 1:length(valid_names)
1376         <span class="keyword">switch</span> valid_names{i}
1377             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1378                 <span class="comment">% Focus the figure</span>
1379                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1380                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1381                     figure(hff)
1382                     
1383                     <span class="comment">% Make the changes to figure</span>
1384                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1385                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1386                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1387                     set(gca,<span class="string">'Color'</span>,FigColor)
1388                     set(gca,<span class="string">'XColor'</span>,AxColor)
1389                     set(gca,<span class="string">'YColor'</span>,AxColor)
1390                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1391                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1392                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1393                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1394                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1395                         <span class="string">'YColor'</span>,AxColor);
1396                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1397                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1398                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1399                     
1400                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1401                     <span class="comment">% the file(s) and path for the data</span>
1402                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1403                     <span class="keyword">if</span> ~ismultiplot
1404                         filestr = guiparams.savefile;
1405                         wd = length(filestr);
1406                         hd = 1;
1407                     <span class="keyword">else</span>
1408                         <span class="comment">% Construct a filename</span>
1409                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1410                         wd        = max(cellfun(@length,filestr));
1411                         hd        = numel(filestr);
1412                             
1413                     <span class="keyword">end</span>
1414                     
1415                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1416                     disableMenuBar(hff)
1417                     set(fileinfotxt,<span class="keyword">...</span>
1418                         <span class="string">'string'</span>,filestr)
1419                     set(fileinfotxt,<span class="keyword">...</span>
1420                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1421                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1422                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1423                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1424                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1425                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1426                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1427                     
1428                 <span class="keyword">end</span>
1429             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1430                 <span class="comment">% Focus the figure</span>
1431                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1432                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1433                     figure(hff)
1434                     
1435                     <span class="comment">% Make the changes to figure</span>
1436                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1437                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1438                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1439                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1440                     set(gca,<span class="string">'XColor'</span>,AxColor)
1441                     set(gca,<span class="string">'YColor'</span>,AxColor)
1442                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1443                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1444                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1445                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1446                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1447                         <span class="string">'YColor'</span>,AxColor);
1448                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1449                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1450                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1451                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1452                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1453                     
1454                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1455                     <span class="comment">% the file(s) and path for the data</span>
1456                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1457                     <span class="keyword">if</span> ~ismultiplot
1458                         filestr = guiparams.savefile;
1459                         wd = length(filestr);
1460                         hd = 1;
1461                     <span class="keyword">else</span>
1462                         <span class="comment">% Construct a filename</span>
1463                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1464                         wd        = max(cellfun(@length,filestr));
1465                         hd        = numel(filestr);
1466                             
1467                     <span class="keyword">end</span>
1468                     
1469                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1470                     disableMenuBar(hff)
1471                     set(fileinfotxt,<span class="keyword">...</span>
1472                         <span class="string">'string'</span>,filestr)
1473                     set(fileinfotxt,<span class="keyword">...</span>
1474                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1475                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1476                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1477                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1478                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1479                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1480                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1481                 <span class="keyword">end</span>
1482             <span class="keyword">otherwise</span>
1483         <span class="keyword">end</span>
1484     <span class="keyword">end</span>
1485     
1486     
1487 <span class="keyword">end</span>
1488 
1489 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1490 
1491 <span class="comment">% --------------------------------------------------------------------</span>
1492 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1493 <span class="comment">%</span>
1494 <span class="comment">% % Get the Application data:</span>
1495 <span class="comment">% % -------------------------</span>
1496 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1497 <span class="comment">%</span>
1498 <span class="comment">% % Initialize the answer:</span>
1499 <span class="comment">% % ----------------------</span>
1500 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1501 <span class="comment">% answer = NaN;</span>
1502 <span class="comment">% while isnan(answer)</span>
1503 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1504 <span class="comment">%</span>
1505 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1506 <span class="comment">%         return</span>
1507 <span class="comment">%     end</span>
1508 <span class="comment">%</span>
1509 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1510 <span class="comment">%     % A numeric char will be a double</span>
1511 <span class="comment">% end</span>
1512 <span class="comment">%</span>
1513 <span class="comment">% % Re-store the Application data:</span>
1514 <span class="comment">% % ------------------------------</span>
1515 <span class="comment">% guiparams.vertical_offset = answer;</span>
1516 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1517 <span class="comment">%</span>
1518 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1519 
1520 <span class="comment">% --------------------------------------------------------------------</span>
1521 <a name="_sub45" href="#_subfunctions" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a>
1522 <span class="comment">% Get the Application Data:</span>
1523 <span class="comment">% -------------------------</span>
1524 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1525 
1526 <span class="comment">% Open the Advanced Settings SubGUI</span>
1527 <span class="comment">%----------------------------------</span>
1528 AdvancedSettings_subgui();
1529 uiwait(findobj(<span class="string">'Name'</span>,<span class="string">'Advanced Settings'</span>));
1530 
1531 <span class="comment">% Get the data back from the Advanced Settings SubGUI</span>
1532 <span class="comment">% and store them back in the VMT memory</span>
1533 <span class="comment">%----------------------------------------------------</span>
1534 guiparams = getpref(<span class="string">'VMTadvancedsettings'</span>,<span class="string">'guiparams'</span>);
1535 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1536 
1537 <span class="comment">% Process Vertical Reference Changes</span>
1538 <a href="#_sub38" class="code" title="subfunction VerticalReference_Callback(hObject, eventdata, handles)">VerticalReference_Callback</a>(hObject, eventdata, handles)
1539 
1540 
1541 
1542 <span class="comment">% --------------------------------------------------------------------</span>
1543 <a name="_sub46" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1544 <span class="comment">% Not implemented</span>
1545 
1546 <span class="comment">% --------------------------------------------------------------------</span>
1547 <a name="_sub47" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1548 <span class="comment">% Empty</span>
1549 
1550 <span class="comment">% --------------------------------------------------------------------</span>
1551 <a name="_sub48" href="#_subfunctions" class="code">function menuGISExportTool_Callback(hObject, eventdata, handles)</a>
1552 <span class="comment">% Formerly ASCII2GIS_GUI Tool</span>
1553 VMT_GISExportTool_GUI
1554 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1555 
1556 <span class="comment">% --------------------------------------------------------------------</span>
1557 <a name="_sub49" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1558 
1559 <span class="comment">% Get the Application preferences:</span>
1560 <span class="comment">% --------------------------------</span>
1561 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1562 
1563 inpath = guiprefs.kmz_path;
1564 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1565     infile = guiprefs.kmz_file{1};
1566 <span class="keyword">else</span>
1567     infile = guiprefs.kmz_file;
1568 <span class="keyword">end</span>
1569 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1570 
1571 guiprefs.kmz_path = outpath;
1572 guiprefs.kmz_file = outfile;
1573 
1574 <span class="comment">% Update persistent preferences</span>
1575 <span class="comment">% -----------------------------</span>
1576 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1577 
1578 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1579 
1580 <span class="comment">% --------------------------------------------------------------------</span>
1581 <a name="_sub50" href="#_subfunctions" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a>
1582 SontekMAT2KML;
1583 <span class="comment">% [EOF] menuSonTekMAT2KML_Callback</span>
1584 
1585 <span class="comment">% --------------------------------------------------------------------</span>
1586 <a name="_sub51" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1587 <span class="comment">% Get the Application preferences:</span>
1588 <span class="comment">% --------------------------------</span>
1589 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1590 
1591 VMT_BatchMode;
1592 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1593 
1594 <span class="comment">% --------------------------------------------------------------------</span>
1595 <a name="_sub52" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1596 <span class="comment">% Empty</span>
1597 
1598 <span class="comment">% --------------------------------------------------------------------</span>
1599 <a name="_sub53" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1600 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1601 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1602     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1603     
1604 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1605     
1606     <span class="keyword">if</span> isdeployed
1607         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1608             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1609         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1610             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1611             errLogFileName},<span class="keyword">...</span>
1612             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1613             <span class="string">'error'</span>);
1614         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1615         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1616         fclose(fid);
1617         rethrow(err)
1618     <span class="keyword">else</span>
1619         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1620             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1621             <span class="string">'error'</span>);
1622         rethrow(err);
1623     <span class="keyword">end</span>
1624 <span class="keyword">end</span>
1625 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1626 
1627 <span class="comment">% --------------------------------------------------------------------</span>
1628 <a name="_sub54" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1629 <span class="comment">% Get the Application data:</span>
1630 <span class="comment">% -------------------------</span>
1631 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1632 
1633 <span class="keyword">try</span>
1634     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1635 
1636 
1637 <span class="comment">% This catch is probably not necessary.</span>
1638 <span class="keyword">catch</span> err 
1639     <span class="keyword">if</span> isdeployed
1640         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1641             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1642         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1643             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1644             errLogFileName},<span class="keyword">...</span>
1645             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1646             <span class="string">'error'</span>);
1647         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1648         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1649         fclose(fid);
1650         rethrow(err)
1651     <span class="keyword">else</span>
1652         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1653             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1654             <span class="string">'error'</span>);
1655         rethrow(err);
1656     <span class="keyword">end</span>
1657 <span class="keyword">end</span>
1658 
1659 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1660 
1661 <span class="comment">% --------------------------------------------------------------------</span>
1662 <a name="_sub55" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1663 
1664 <span class="comment">% Get the Application data:</span>
1665 <span class="comment">% -------------------------</span>
1666 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1667 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1668 
1669 <span class="comment">% Check version tag against the web, and display a message</span>
1670 <span class="keyword">try</span>
1671     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1672     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1673     <span class="keyword">if</span> length(webdata) &gt; 5
1674         current_vmt_version{1} = webdata(1:5);
1675         current_vmt_version{2} = webdata(8:16);
1676     <span class="keyword">else</span>
1677         current_vmt_version = webdata;
1678     <span class="keyword">end</span>
1679     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1680 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1681     <span class="keyword">if</span> isdeployed
1682         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1683             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1684         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1685             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1686             errLogFileName},<span class="keyword">...</span>
1687             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1688             <span class="string">'error'</span>);
1689         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1690         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1691         fclose(fid);
1692         rethrow(err)
1693     <span class="keyword">else</span>
1694         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1695             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1696             <span class="string">'error'</span>);
1697         rethrow(err);
1698     <span class="keyword">end</span>
1699 <span class="keyword">end</span>
1700 
1701 <span class="keyword">if</span> ischar(current_vmt_version)
1702     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
1703         h = msgbox(<span class="keyword">...</span>
1704             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1705             <span class="string">''</span>;<span class="keyword">...</span>
1706             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1707             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1708     <span class="keyword">else</span>
1709         h = msgbox(<span class="keyword">...</span>
1710             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1711             <span class="string">''</span>;<span class="keyword">...</span>
1712             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
1713             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1714     <span class="keyword">end</span>
1715 <span class="keyword">elseif</span> iscell(current_vmt_version)
1716     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
1717         h = msgbox(<span class="keyword">...</span>
1718             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
1719             <span class="string">''</span>;<span class="keyword">...</span>
1720             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1721             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1722     <span class="keyword">else</span>
1723         h = msgbox(<span class="keyword">...</span>
1724             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
1725             <span class="string">''</span>;<span class="keyword">...</span>
1726             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
1727             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1728     <span class="keyword">end</span>
1729 <span class="keyword">end</span>
1730 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
1731 
1732 <span class="comment">% --------------------------------------------------------------------</span>
1733 <a name="_sub56" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
1734 
1735 <span class="comment">% Get the Application data:</span>
1736 <span class="comment">% -------------------------</span>
1737 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1738 messagestr = <span class="keyword">...</span>
1739     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
1740     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
1741     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
1742     <span class="string">''</span>;<span class="keyword">...</span>
1743     <span class="string">''</span>;<span class="keyword">...</span>
1744     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
1745     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
1746     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
1747     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
1748     <span class="string">''</span>;<span class="keyword">...</span>
1749     <span class="string">''</span>;<span class="keyword">...</span>
1750     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
1751     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
1752     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
1753     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
1754     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
1755     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
1756     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
1757 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
1758 <span class="comment">% [EOF] menuAbout_Callback</span>
1759 
1760 
1761 
1762 
1763 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1764 <span class="comment">% TOOLBAR CALLBACKS %</span>
1765 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
1766 
1767 <span class="comment">% --------------------------------------------------------------------</span>
1768 <a name="_sub57" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
1769 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla
1770 <a href="#_sub10" class="code" title="subfunction closeOpenFigures(hObject, eventdata, handles)">closeOpenFigures</a>(hObject, eventdata, handles)
1771 <span class="comment">% Read Files into Data Structure using tfile.</span>
1772 
1773 <span class="comment">% Get the Application data:</span>
1774 <span class="comment">% -------------------------</span>
1775 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1776 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1777 
1778 <span class="comment">% Ask the user to select files:</span>
1779 <span class="comment">% -----------------------------</span>
1780 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
1781 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
1782     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
1783     current_file, <span class="keyword">...</span>
1784     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
1785 
1786 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
1787     guiparams.data_folder = pathname;
1788     <span class="keyword">if</span> ischar(filename)
1789         filename = {filename};
1790     <span class="keyword">end</span>
1791     guiparams.data_files = filename;
1792     guiparams.mat_file = <span class="string">''</span>;
1793     
1794     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1795     
1796    
1797     
1798     <span class="comment">% Update the preferences:</span>
1799     <span class="comment">% -----------------------</span>
1800     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1801     guiprefs.ascii_path = pathname;
1802     guiprefs.ascii_file = filename;
1803     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1804     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
1805     
1806     <span class="comment">% Push messages to Log Window:</span>
1807     <span class="comment">% ----------------------------</span>
1808     log_text = {<span class="keyword">...</span>
1809         <span class="string">''</span>;<span class="keyword">...</span>
1810         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
1811         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
1812         guiparams.data_folder;
1813         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
1814         char(filename)};
1815     statusLogging(handles.LogWindow, log_text)
1816     
1817     <span class="comment">% Read the file(s)</span>
1818     <span class="comment">% ----------------</span>
1819     [~,~,savefile,A,z] = <span class="keyword">...</span>
1820         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
1821     guiparams.savefile = savefile;
1822     guiparams.A        = A;
1823     guiparams.z        = z;
1824     
1825     
1826     <span class="comment">% Set the vertical grid node spacing</span>
1827     <span class="comment">% ----------------------------------</span>
1828     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
1829     <span class="comment">% Backwards compatible</span>
1830     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
1831         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
1832         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
1833     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
1834         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
1835         guiparams.vertical_grid_node_spacing = 0.4;
1836     <span class="keyword">end</span>
1837     
1838     <span class="comment">% Save application data</span>
1839     <span class="comment">% ---------------------</span>
1840     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1841    
1842     <span class="comment">% Process and display ShipTracks</span>
1843     <span class="comment">% ------------------------------</span>
1844     <a href="#_sub62" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
1845     
1846 <span class="comment">%</span>
1847 <span class="comment">%     % Preprocess the data:</span>
1848 <span class="comment">%     % --------------------</span>
1849 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
1850 <span class="comment">%</span>
1851 <span class="comment">%     % Push messages to Log Window:</span>
1852 <span class="comment">%     % ----------------------------</span>
1853 <span class="comment">%     log_text = {...</span>
1854 <span class="comment">%         '   Preprocessing complete.';...</span>
1855 <span class="comment">%         '   Begin Data Processing...'};</span>
1856 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
1857 <span class="comment">%</span>
1858 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
1859 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
1860 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
1861 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
1862 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
1863 <span class="comment">%</span>
1864 <span class="comment">%     % Push messages to Log Window:</span>
1865 <span class="comment">%     % ----------------------------</span>
1866 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
1867 <span class="comment">%</span>
1868 <span class="comment">%     % Store the data:</span>
1869 <span class="comment">%     % ---------------</span>
1870 <span class="comment">%     guiparams.z = z;</span>
1871 <span class="comment">%     guiparams.A = A;</span>
1872 <span class="comment">%     guiparams.V = V;</span>
1873 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
1874     
1875           
1876     <span class="comment">% Update the GUI:</span>
1877     <span class="comment">% ---------------</span>
1878     <a href="#_sub100" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
1879     
1880     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
1881     
1882 <span class="keyword">end</span>
1883 <span class="comment">% [EOF] loadDataCallback</span>
1884 
1885 
1886 
1887 <span class="comment">% --------------------------------------------------------------------</span>
1888 <a name="_sub58" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
1889 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
1890 
1891 <span class="comment">% Get the Application data:</span>
1892 <span class="comment">% -------------------------</span>
1893 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1894 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1895 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1896 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
1897 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
1898 
1899 [the_file,the_path] = <span class="keyword">...</span>
1900     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
1901     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
1902     fullfile(guiparams.mat_path,guiparams.savefile));
1903 
1904 <span class="comment">% Save the processed data to a MAT file:</span>
1905 <span class="comment">% --------------------------------------</span>
1906 <span class="keyword">if</span> ischar(the_file)
1907     guiparams.mat_path = the_path;
1908     guiparams.mat_file = the_file;
1909     guiparams.savefile = the_file;
1910     
1911     <span class="comment">% Re-store the Application data:</span>
1912     <span class="comment">% ------------------------------</span>
1913     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1914     
1915     <span class="comment">% Update the preferences:</span>
1916     <span class="comment">% -----------------------</span>
1917     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1918     guiprefs.mat_path = the_path;
1919     guiprefs.mat_file = the_file;
1920     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1921     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
1922     
1923     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
1924     savefile = fullfile(pathstr,[filename extension]);
1925     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
1926     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
1927     log_text = {<span class="keyword">...</span>
1928         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
1929         savefile};
1930     statusLogging(handles.LogWindow,log_text)
1931     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
1932 <span class="keyword">end</span>
1933 
1934 <span class="comment">% [EOF] saveDataCallback</span>
1935 
1936 
1937 <span class="comment">% --------------------------------------------------------------------</span>
1938 <a name="_sub59" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
1939 
1940 <span class="comment">% Get the Application data:</span>
1941 <span class="comment">% -------------------------</span>
1942 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1943 z   = guiparams.z;
1944 A   = guiparams.A;
1945 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
1946 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
1947 
1948 <span class="comment">% Compute multibeam bathymetry:</span>
1949 <span class="comment">% -----------------------------</span>
1950 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1951 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
1952 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
1953     guiparams.beam_angle, <span class="keyword">...</span>
1954     guiparams.magnetic_variation, <span class="keyword">...</span>
1955     guiparams.water_surface_elevation, <span class="keyword">...</span>
1956     guiparams.output_auxiliary_data);
1957 
1958 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
1959 
1960 <span class="comment">% [EOF] saveBathymetryCallback</span>
1961 
1962 <span class="comment">% --------------------------------------------------------------------</span>
1963 <a name="_sub60" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
1964 
1965 <span class="comment">% Get the Application data:</span>
1966 <span class="comment">% -------------------------</span>
1967 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1968 
1969 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1970     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
1971     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
1972     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
1973     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
1974     handles.figure1);
1975 
1976 <span class="comment">% Update the GUI:</span>
1977 <span class="comment">% ---------------</span>
1978 <span class="keyword">if</span> guiparams.english_units
1979     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1980     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1981 <span class="keyword">else</span>
1982     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1983     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1984 <span class="keyword">end</span>
1985 
1986 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
1987     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1988     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1989 <span class="keyword">else</span>
1990     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1991     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1992 <span class="keyword">end</span>
1993 
1994 <span class="keyword">if</span> guiparams.presentation
1995     <a href="#_sub44" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
1996 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
1997 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
1998 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
1999 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2000 <span class="keyword">else</span>
2001     <a href="#_sub43" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2002 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2003 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2004 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2005 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2006 <span class="keyword">end</span>
2007 
2008 <span class="comment">% Re-store the Application data:</span>
2009 <span class="comment">% ------------------------------</span>
2010 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2011 
2012 <span class="comment">% [EOF] plottingParametersCallback</span>
2013 
2014 
2015 <span class="comment">% --------------------------------------------------------------------</span>
2016 <a name="_sub61" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2017 
2018 <span class="comment">% Get the Application data:</span>
2019 <span class="comment">% -------------------------</span>
2020 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2021 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2022 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2023 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2024 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2025 
2026 <span class="comment">% [EOF] processingParametersCallback</span>
2027 
2028 
2029 <span class="comment">% --------------------------------------------------------------------</span>
2030 <a name="_sub62" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2031 <span class="comment">% Plot 1</span>
2032 
2033 <span class="comment">% Get the Application data:</span>
2034 <span class="comment">% -------------------------</span>
2035 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2036 z = guiparams.z;
2037 A = guiparams.A;
2038 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2039 <span class="comment">% Map = guiparams.Map;</span>
2040 
2041 
2042 <span class="comment">% Preprocess the data:</span>
2043 <span class="comment">% --------------------</span>
2044 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2045 
2046 <span class="comment">% Push messages to Log Window:</span>
2047 <span class="comment">% ----------------------------</span>
2048 log_text = {<span class="keyword">...</span>
2049     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2050     <span class="string">'   Begin Data Processing...'</span>};
2051 statusLogging(handles.LogWindow, log_text)
2052 
2053 <span class="comment">% Process the transects:</span>
2054 <span class="comment">% ----------------------</span>
2055 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2056 A(1).vgns = guiparams.vertical_grid_node_spacing;
2057 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2058 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2059     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2060 
2061 <span class="comment">% Compute the smoothed variables</span>
2062 <span class="comment">% ------------------------------</span>
2063 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2064 <span class="comment">% runtime.</span>
2065 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2066     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2067     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2068     guiparams.vertical_smoothing_window);
2069 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2070 
2071 <span class="comment">% Update V structure to include current plotting settings</span>
2072 V.version = guiparams.vmt_version{1}; V.release = guiparams.vmt_version{2};
2073 V.plotSettings.shiptracks.horizontal_grid_node_spacing = guiparams.horizontal_grid_node_spacing;
2074 V.plotSettings.shiptracks.vertical_grid_node_spacing = guiparams.vertical_grid_node_spacing;
2075 V.plotSettings.planview.depth_range_min = guiparams.depth_range_min;
2076 V.plotSettings.planview.depth_range_max = guiparams.depth_range_max;
2077 V.plotSettings.planview.vector_scale_plan_view = guiparams.vector_scale_plan_view;
2078 V.plotSettings.planview.vector_spacing_plan_view = guiparams.vector_spacing_plan_view;
2079 V.plotSettings.planview.smoothing_window_size = guiparams.smoothing_window_size;
2080 V.plotSettings.planview.plotref = guiparams.plotref;
2081 V.plotSettings.mcs.contour = guiparams.contour;
2082 V.plotSettings.mcs.vertical_exaggeration = guiparams.vertical_exaggeration;
2083 V.plotSettings.mcs.vector_scale_cross_section = guiparams.vector_scale_cross_section;
2084 V.plotSettings.mcs.horizontal_vector_spacing = guiparams.horizontal_vector_spacing;
2085 V.plotSettings.mcs.vertical_vector_spacing = guiparams.vertical_vector_spacing;
2086 V.plotSettings.mcs.horizontal_smoothing_window = guiparams.horizontal_smoothing_window;
2087 V.plotSettings.mcs.vertical_smoothing_window = guiparams.vertical_smoothing_window;
2088 V.plotSettings.mcs.plot_secondary_flow_vectors = guiparams.plot_secondary_flow_vectors;
2089 V.plotSettings.mcs.secondary_flow_vector_variable = guiparams.secondary_flow_vector_variable;
2090 V.plotSettings.mcs.include_vertical_velocity = guiparams.include_vertical_velocity;
2091 
2092 
2093 <span class="comment">% Push messages to Log Window:</span>
2094 <span class="comment">% ----------------------------</span>
2095 statusLogging(handles.LogWindow, processing_log_text)
2096 
2097 <span class="comment">% Store the data:</span>
2098 <span class="comment">% ---------------</span>
2099 guiparams.z = z;
2100 guiparams.A = A;
2101 guiparams.V = V;
2102 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2103 
2104 <span class="comment">% Push messages to Log Window:</span>
2105 <span class="comment">% ----------------------------</span>
2106 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2107 statusLogging(handles.LogWindow, log_text)
2108 
2109 <span class="comment">% Create or replot the Shiptracks</span>
2110 <span class="comment">% -------------------------------</span>
2111 <span class="comment">% Grab the axes to the plot</span>
2112 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2113 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2114 
2115 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2116 <span class="comment">% New plot display window</span>
2117 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2118 <span class="comment">% h = figure(1); clf</span>
2119 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2120 
2121 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2122 
2123 
2124 <span class="comment">% --------------------------------------------------------------------</span>
2125 <a name="_sub63" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2126 <span class="comment">% Plot 2</span>
2127 
2128 <span class="comment">% Get the Application data:</span>
2129 <span class="comment">% -------------------------</span>
2130 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2131 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2132 
2133 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2134     <span class="comment">% Push messages to Log Window:</span>
2135     <span class="comment">% ----------------------------</span>
2136     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2137     statusLogging(handles.LogWindow, log_text)
2138     
2139        
2140     <span class="comment">% Push plotting parameters to log window:</span>
2141     <span class="comment">% ---------------------------------------</span>
2142     log_text = {<span class="keyword">...</span>
2143         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2144         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2145         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2146         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2147         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2148         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2149         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2150         };
2151     statusLogging(handles.LogWindow, log_text)
2152     
2153     <span class="comment">% Plot the data:</span>
2154     <span class="comment">% --------------</span>
2155     z = [];
2156     A = [];
2157     V = [];
2158     Map = [];
2159     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2160     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2161         depth_range, <span class="keyword">...</span>
2162         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2163         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2164         guiparams.smoothing_window_size, <span class="keyword">...</span>
2165         guiparams.display_shoreline, <span class="keyword">...</span>
2166         guiparams.english_units, <span class="keyword">...</span>
2167         guiparams.mat_file, <span class="keyword">...</span>
2168         guiparams.mat_path, <span class="keyword">...</span>
2169         guiparams.plotref); <span class="comment">% PLOT2</span>
2170     statusLogging(handles.LogWindow, log_text)
2171     
2172     <span class="comment">% Plot a Shoreline Map:</span>
2173     <span class="comment">% ---------------------</span>
2174     <span class="keyword">if</span> guiparams.display_shoreline
2175         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2176             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2177             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2178             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2179         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2180             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2181             Map.UTMe   = mapdata(:,1);
2182             Map.UTMn   = mapdata(:,2);
2183             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2184             <span class="comment">%Map.UTMzone = zone;</span>
2185         <span class="keyword">else</span>
2186             Map = [];
2187         <span class="keyword">end</span>
2188         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2189         log_text = {<span class="keyword">...</span>
2190             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2191             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2192             };
2193         statusLogging(handles.LogWindow, log_text)
2194     <span class="keyword">else</span>
2195         Map = [];
2196     <span class="keyword">end</span>
2197     
2198 <span class="keyword">else</span>
2199     z = guiparams.z;
2200     A = guiparams.A;
2201     <span class="comment">% V = guiparams.V;</span>
2202     Map = guiparams.Map;
2203     
2204     <span class="comment">% Push messages to Log Window:</span>
2205     <span class="comment">% ----------------------------</span>
2206     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2207     statusLogging(handles.LogWindow, log_text)
2208     
2209         
2210     <span class="comment">% Preprocess the data:</span>
2211     <span class="comment">% --------------------</span>
2212     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2213     
2214     <span class="comment">% Process the transects:</span>
2215     <span class="comment">% ----------------------</span>
2216     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2217     A(1).vgns = guiparams.vertical_grid_node_spacing;
2218     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2219     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2220     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2221     
2222     <span class="comment">% Compute the smoothed variables</span>
2223     <span class="comment">% ------------------------------</span>
2224     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2225     <span class="comment">% runtime.</span>
2226     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2227         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2228         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2229         guiparams.vertical_smoothing_window);
2230     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2231     
2232     <span class="comment">% Push messages to Log Window:</span>
2233     <span class="comment">% ----------------------------</span>
2234     statusLogging(handles.LogWindow, processing_log_text)
2235     
2236     <span class="comment">% Plot the cross section:</span>
2237     <span class="comment">% -----------------------</span>
2238     log_text = {<span class="keyword">...</span>
2239         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2240         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2241         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2242         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2243         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2244         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2245         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2246         };
2247     statusLogging(handles.LogWindow, log_text)
2248     
2249     <span class="comment">% Plot the data:</span>
2250     <span class="comment">% --------------</span>
2251     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2252     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2253     
2254     
2255     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2256         depth_range, <span class="keyword">...</span>
2257         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2258         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2259         guiparams.smoothing_window_size, <span class="keyword">...</span>
2260         guiparams.display_shoreline, <span class="keyword">...</span>
2261         guiparams.english_units, <span class="keyword">...</span>
2262         guiparams.mat_file, <span class="keyword">...</span>
2263         guiparams.mat_path, <span class="keyword">...</span>
2264         guiparams.plotref); <span class="comment">% PLOT2</span>
2265     statusLogging(handles.LogWindow, log_text)
2266     
2267     <span class="comment">% Plot User Set Endpoints</span>
2268     <span class="comment">% -----------------------</span>
2269     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2270         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2271         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2272         x = data(:,1);
2273         y = data(:,2);
2274         
2275         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2276         figure(fh); hold on
2277         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2278         hold off
2279     <span class="keyword">end</span>
2280     
2281     <span class="comment">% Plot a Shoreline Map:</span>
2282     <span class="comment">% ---------------------</span>
2283     <span class="keyword">if</span> guiparams.display_shoreline
2284         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2285             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2286             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2287             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2288         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2289             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2290             Map.UTMe   = mapdata(:,1);
2291             Map.UTMn   = mapdata(:,2);
2292             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2293             <span class="comment">%Map.UTMzone = zone;</span>
2294         <span class="keyword">else</span>
2295             Map = [];
2296         <span class="keyword">end</span>
2297         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2298         log_text = {<span class="keyword">...</span>
2299             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2300             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2301             };
2302         statusLogging(handles.LogWindow, log_text)
2303     <span class="keyword">else</span>
2304         Map = [];
2305     <span class="keyword">end</span>
2306     
2307 <span class="keyword">end</span>
2308 
2309 <span class="keyword">if</span> guiparams.add_background
2310     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2311     statusLogging(handles.LogWindow, log_text)
2312 <span class="keyword">end</span>
2313 
2314 <span class="comment">% Update V structure to include current plotting settings</span>
2315 V.version = guiparams.vmt_version{1}; V.release = guiparams.vmt_version{2};
2316 V.plotSettings.shiptracks.horizontal_grid_node_spacing = guiparams.horizontal_grid_node_spacing;
2317 V.plotSettings.shiptracks.vertical_grid_node_spacing = guiparams.vertical_grid_node_spacing;
2318 V.plotSettings.planview.depth_range_min = guiparams.depth_range_min;
2319 V.plotSettings.planview.depth_range_max = guiparams.depth_range_max;
2320 V.plotSettings.planview.vector_scale_plan_view = guiparams.vector_scale_plan_view;
2321 V.plotSettings.planview.vector_spacing_plan_view = guiparams.vector_spacing_plan_view;
2322 V.plotSettings.planview.smoothing_window_size = guiparams.smoothing_window_size;
2323 V.plotSettings.planview.plotref = guiparams.plotref;
2324 V.plotSettings.mcs.contour = guiparams.contour;
2325 V.plotSettings.mcs.vertical_exaggeration = guiparams.vertical_exaggeration;
2326 V.plotSettings.mcs.vector_scale_cross_section = guiparams.vector_scale_cross_section;
2327 V.plotSettings.mcs.horizontal_vector_spacing = guiparams.horizontal_vector_spacing;
2328 V.plotSettings.mcs.vertical_vector_spacing = guiparams.vertical_vector_spacing;
2329 V.plotSettings.mcs.horizontal_smoothing_window = guiparams.horizontal_smoothing_window;
2330 V.plotSettings.mcs.vertical_smoothing_window = guiparams.vertical_smoothing_window;
2331 V.plotSettings.mcs.plot_secondary_flow_vectors = guiparams.plot_secondary_flow_vectors;
2332 V.plotSettings.mcs.secondary_flow_vector_variable = guiparams.secondary_flow_vector_variable;
2333 V.plotSettings.mcs.include_vertical_velocity = guiparams.include_vertical_velocity;
2334 
2335 <span class="comment">% Update guiparams</span>
2336 <span class="comment">% ----------------</span>
2337 guiparams.z   = z;
2338 guiparams.A   = A;
2339 guiparams.V   = V;
2340 guiparams.Map = Map;
2341 guiparams.iric_anv_planview_data = PVdata;
2342 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2343 
2344 <span class="comment">% Update preferences</span>
2345 <span class="comment">% ------------------</span>
2346 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2347 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2348 <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2349 
2350 <span class="comment">% Force plot to be formated properly</span>
2351 <span class="comment">% ----------------------------------</span>
2352 <span class="keyword">if</span> guiparams.presentation
2353     <a href="#_sub44" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2354 <span class="keyword">else</span>
2355     <a href="#_sub43" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2356 <span class="keyword">end</span>
2357 <span class="keyword">switch</span> guiparams.renderer
2358     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2359         <a href="#_sub20" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2360     <span class="keyword">case</span> <span class="string">'painters'</span>
2361         <a href="#_sub21" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2362     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2363         <a href="#_sub22" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2364 <span class="keyword">end</span>
2365 
2366 <span class="comment">% Focus the figure</span>
2367 <span class="comment">% ----------------</span>
2368 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2369 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2370     figure(hff)
2371 <span class="keyword">end</span>
2372 
2373 <span class="comment">% Start the Graphics Control Gui</span>
2374 <span class="comment">% ------------------------------</span>
2375 VMT_GraphicsControl
2376 
2377 <span class="comment">% [EOF] planviewPlotCallback</span>
2378 
2379 
2380 <span class="comment">% --------------------------------------------------------------------</span>
2381 <a name="_sub64" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2382 <span class="comment">% Plot 3</span>
2383 
2384 <span class="comment">% Get the Application data:</span>
2385 <span class="comment">% -------------------------</span>
2386 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2387 z = guiparams.z;
2388 A = guiparams.A;
2389 <span class="comment">% V = guiparams.V;</span>
2390 <span class="comment">% Map = guiparams.Map;</span>
2391 
2392 <span class="comment">% Preprocess the data:</span>
2393 <span class="comment">% --------------------</span>
2394 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2395 
2396 <span class="comment">% Push messages to Log Window:</span>
2397 <span class="comment">% ----------------------------</span>
2398 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2399 statusLogging(handles.LogWindow, log_text)
2400 
2401 <span class="comment">% Process the transects:</span>
2402 <span class="comment">% ----------------------</span>
2403 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2404 A(1).vgns = guiparams.vertical_grid_node_spacing;
2405 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2406 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2407     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2408 
2409 <span class="comment">% Push messages to Log Window:</span>
2410 <span class="comment">% ----------------------------</span>
2411 statusLogging(handles.LogWindow, processing_log_text)
2412 
2413 <span class="comment">% Plot the cross section:</span>
2414 <span class="comment">% -----------------------</span>
2415 log_text = {<span class="keyword">...</span>
2416     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2417     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2418     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2419     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2420     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2421     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2422     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2423     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2424     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2425     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2426     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2427     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2428     
2429     };
2430 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2431     log_text = vertcat(log_text, {<span class="keyword">...</span>
2432         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2433         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2434         });
2435 <span class="keyword">end</span>
2436 <span class="comment">% Push messages to Log Window:</span>
2437 <span class="comment">% ----------------------------</span>
2438 statusLogging(handles.LogWindow, log_text)
2439 
2440 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2441     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2442 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2443 <span class="comment">%         ...guiparams.contour, ...</span>
2444 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2445 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2446     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2447         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2448         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2449         guiparams.vertical_smoothing_window);
2450     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2451     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2452         guiparams.contour, <span class="keyword">...</span>
2453         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2454         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2455         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2456         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2457         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2458         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2459         guiparams.english_units,<span class="keyword">...</span>
2460         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2461         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2462     
2463 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2464     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2465         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2466         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2467         guiparams.vertical_smoothing_window);
2468     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2469     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2470         guiparams.contour, <span class="keyword">...</span>
2471         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2472         guiparams.english_units, <span class="keyword">...</span>
2473         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2474         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2475     
2476     guiparams.zmin = zmin;
2477     guiparams.zmax = zmax;
2478     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2479 <span class="keyword">end</span>
2480 
2481 <span class="comment">% Force plot to be formated properly</span>
2482 <span class="comment">% ----------------------------------</span>
2483 <span class="keyword">if</span> guiparams.presentation
2484     <a href="#_sub44" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2485 <span class="keyword">else</span>
2486     <a href="#_sub43" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2487 <span class="keyword">end</span>
2488 <span class="keyword">switch</span> guiparams.renderer
2489     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2490         <a href="#_sub20" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2491     <span class="keyword">case</span> <span class="string">'painters'</span>
2492         <a href="#_sub21" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2493     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2494         <a href="#_sub22" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2495 <span class="keyword">end</span>
2496 
2497 <span class="comment">% Focus the figure</span>
2498 <span class="comment">% ----------------</span>
2499 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2500 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2501     figure(hff)
2502 <span class="keyword">end</span>
2503 <span class="comment">% Update V structure to include current plotting settings</span>
2504 V.version = guiparams.vmt_version{1}; V.release = guiparams.vmt_version{2};
2505 V.plotSettings.shiptracks.horizontal_grid_node_spacing = guiparams.horizontal_grid_node_spacing;
2506 V.plotSettings.shiptracks.vertical_grid_node_spacing = guiparams.vertical_grid_node_spacing;
2507 V.plotSettings.planview.depth_range_min = guiparams.depth_range_min;
2508 V.plotSettings.planview.depth_range_max = guiparams.depth_range_max;
2509 V.plotSettings.planview.vector_scale_plan_view = guiparams.vector_scale_plan_view;
2510 V.plotSettings.planview.vector_spacing_plan_view = guiparams.vector_spacing_plan_view;
2511 V.plotSettings.planview.smoothing_window_size = guiparams.smoothing_window_size;
2512 V.plotSettings.planview.plotref = guiparams.plotref;
2513 V.plotSettings.mcs.contour = guiparams.contour;
2514 V.plotSettings.mcs.vertical_exaggeration = guiparams.vertical_exaggeration;
2515 V.plotSettings.mcs.vector_scale_cross_section = guiparams.vector_scale_cross_section;
2516 V.plotSettings.mcs.horizontal_vector_spacing = guiparams.horizontal_vector_spacing;
2517 V.plotSettings.mcs.vertical_vector_spacing = guiparams.vertical_vector_spacing;
2518 V.plotSettings.mcs.horizontal_smoothing_window = guiparams.horizontal_smoothing_window;
2519 V.plotSettings.mcs.vertical_smoothing_window = guiparams.vertical_smoothing_window;
2520 V.plotSettings.mcs.plot_secondary_flow_vectors = guiparams.plot_secondary_flow_vectors;
2521 V.plotSettings.mcs.secondary_flow_vector_variable = guiparams.secondary_flow_vector_variable;
2522 V.plotSettings.mcs.include_vertical_velocity = guiparams.include_vertical_velocity;
2523 V.plotSettings.mcs.mcsQuivers = guiparams.mcsQuivers;  <span class="comment">% Move this with the newer plotting routine update FLE 4/27/2017</span>
2524 
2525 <span class="comment">% Re-store the Application data:</span>
2526 <span class="comment">% ------------------------------</span>
2527 guiparams.V = V;
2528 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2529 
2530 <span class="comment">% Start the Graphics Control Gui</span>
2531 <span class="comment">% ------------------------------</span>
2532 VMT_GraphicsControl
2533 
2534 <span class="comment">% Push messages to Log Window:</span>
2535 <span class="comment">% ----------------------------</span>
2536 statusLogging(handles.LogWindow, plot_cont_log_text)
2537 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2538 
2539 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2540 
2541 
2542 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2543 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2544 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2545 
2546 <span class="comment">% --------------------------------------------------------------------</span>
2547 <a name="_sub65" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2548 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2549 
2550 <span class="comment">% Get the Application data:</span>
2551 <span class="comment">% -------------------------</span>
2552 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2553 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2554 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2555 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2556 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2557 
2558 [the_file,the_path] = <span class="keyword">...</span>
2559     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2560     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2561     fullfile(guiparams.mat_path,guiparams.savefile));
2562 
2563 <span class="comment">% Save the processed data to a MAT file:</span>
2564 <span class="comment">% --------------------------------------</span>
2565 <span class="keyword">if</span> ischar(the_file)
2566     guiparams.mat_path = the_path;
2567     guiparams.mat_file = the_file;
2568     guiparams.savefile = the_file;
2569     
2570     <span class="comment">% Re-store the Application data:</span>
2571     <span class="comment">% ------------------------------</span>
2572     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2573     
2574     <span class="comment">% Update the preferences:</span>
2575     <span class="comment">% -----------------------</span>
2576     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2577     guiprefs.mat_path = the_path;
2578     guiprefs.mat_file = the_file;
2579     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2580     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2581     
2582     [~,filename,extension] = fileparts(guiparams.savefile);
2583     savefile = [filename extension];
2584     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2585         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2586     disp(<span class="string">'Saving Processed Data File...'</span>)
2587     disp(savefile)
2588     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2589 <span class="keyword">end</span>
2590 
2591 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2592 
2593 
2594 <span class="comment">% --------------------------------------------------------------------</span>
2595 <a name="_sub66" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2596 
2597 <span class="comment">% Get the Application data:</span>
2598 <span class="comment">% -------------------------</span>
2599 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2600 <span class="comment">% z   = guiparams.z;</span>
2601 <span class="comment">% A   = guiparams.A;</span>
2602 V   = guiparams.V;
2603 <span class="comment">% Map = guiparams.Map;</span>
2604 
2605 [the_file,the_path] = <span class="keyword">...</span>
2606     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2607     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2608     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2609 
2610 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2611 <span class="comment">% ------------------------------------------</span>
2612 <span class="keyword">if</span> ischar(the_file)
2613     guiparams.tecplot_path = the_path;
2614     guiparams.tecplot_file = the_file;
2615     
2616     <span class="comment">% Re-store the Application data:</span>
2617     <span class="comment">% ------------------------------</span>
2618     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2619     
2620     <span class="comment">% Update the preferences:</span>
2621     <span class="comment">% -----------------------</span>
2622     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2623     guiprefs.tecplot_path = the_path;
2624     guiprefs.tecplot_file = the_file;
2625     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2626     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2627     
2628     <span class="comment">% Push to log window</span>
2629     <span class="comment">% ------------------</span>
2630     log_text = {<span class="keyword">...</span>
2631         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2632         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2633         the_path;<span class="keyword">...</span>
2634         [<span class="string">'Filename: '</span> the_file]};
2635     statusLogging(handles.LogWindow,log_text)
2636         
2637     <span class="keyword">if</span> isempty(V)
2638         A = guiparams.A;
2639         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2640         A(1).vgns = guiparams.vertical_grid_node_spacing;
2641         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2642         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2643     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2644     <span class="keyword">end</span>
2645     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2646     
2647     <span class="comment">% Push to log window</span>
2648     <span class="comment">% ------------------</span>
2649     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2650     statusLogging(handles.LogWindow,log_text)
2651     
2652     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2653     
2654     <span class="comment">% Push to log window</span>
2655     <span class="comment">% ------------------</span>
2656     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2657     statusLogging(handles.LogWindow,log_text)
2658    
2659 <span class="keyword">end</span>
2660 
2661 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2662 
2663 
2664 <span class="comment">% --------------------------------------------------------------------</span>
2665 <a name="_sub67" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2666 
2667 <span class="comment">% Get the Application data:</span>
2668 <span class="comment">% -------------------------</span>
2669 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2670 <span class="comment">% z   = guiparams.z;</span>
2671 A   = guiparams.A;
2672 V   = guiparams.V;
2673 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2674 
2675 [the_file,the_path] = <span class="keyword">...</span>
2676     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2677     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2678     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2679 
2680 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2681 <span class="comment">% -----------------------------------------------------</span>
2682 <span class="keyword">if</span> ischar(the_file)
2683     guiparams.kmz_path = the_path;
2684     guiparams.kmz_file = the_file;
2685     
2686     <span class="comment">% Re-store the Application data:</span>
2687     <span class="comment">% ------------------------------</span>
2688     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2689     
2690     <span class="comment">% Update the preferences:</span>
2691     <span class="comment">% -----------------------</span>
2692     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2693     guiprefs.kmz_path = the_path;
2694     guiprefs.kmz_file = the_file;
2695     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2696     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2697     
2698     <span class="comment">%     if guiparams.display_shoreline</span>
2699     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2700     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2701     <span class="comment">%                             guiparams.vertical_offset);</span>
2702     <span class="comment">%     end</span>
2703     <span class="keyword">if</span> isempty(V)
2704         A = guiparams.A;
2705         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2706         A(1).vgns = guiparams.vertical_grid_node_spacing;
2707         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2708         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2709     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2710     <span class="keyword">end</span>
2711     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2712         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2713         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2714         guiparams.KMZ_vertical_offset);
2715 <span class="keyword">end</span>
2716 
2717 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2718 
2719 
2720 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2721 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2722 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2723 
2724 <span class="comment">% --------------------------------------------------------------------</span>
2725 <a name="_sub68" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2726 
2727 <span class="comment">% Get the Application data:</span>
2728 <span class="comment">% -------------------------</span>
2729 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2730 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2731 z = guiparams.z;
2732 A = guiparams.A;
2733 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2734 <span class="comment">% Map = guiparams.Map;</span>
2735 setends = guiparams.set_cross_section_endpoints;
2736 
2737 [the_file,the_path] = <span class="keyword">...</span>
2738     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2739     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2740     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2741     guiprefs.multibeambathymetry_file));
2742 
2743 <span class="keyword">if</span> ischar(the_file)
2744     guiparams.multibeambathymetry_path = the_path;
2745     guiparams.multibeambathymetry_file = the_file;
2746     
2747     <span class="comment">% Re-store the Application data:</span>
2748     <span class="comment">% ------------------------------</span>
2749     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2750     
2751     <span class="comment">% Update the preferences:</span>
2752     <span class="comment">% -----------------------</span>
2753     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2754     guiprefs.multibeambathymetry_path = the_path;
2755     guiprefs.multibeambathymetry_file = the_file;
2756     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2757     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2758     
2759     <span class="keyword">if</span> guiparams.output_auxiliary_data
2760     <span class="keyword">end</span>
2761     
2762     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2763     
2764     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2765         guiparams.multibeambathymetry_file);
2766     
2767     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2768         [<span class="string">'   '</span> savefile]};
2769     statusLogging(handles.LogWindow,log_text)
2770     
2771     <span class="comment">% Process the transects:</span>
2772     <span class="comment">% ----------------------</span>
2773     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2774     A(1).vgns = guiparams.vertical_grid_node_spacing;
2775     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2776     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2777     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2778     
2779     <span class="comment">% Compute the smoothed variables</span>
2780     <span class="comment">% ------------------------------</span>
2781     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2782     <span class="comment">% runtime.</span>
2783     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2784         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2785         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2786         guiparams.vertical_smoothing_window);
2787     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2788     <span class="comment">% Push messages to Log Window:</span>
2789     <span class="comment">% ----------------------------</span>
2790     statusLogging(handles.LogWindow, processing_log_text)
2791 
2792     
2793     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
2794         guiparams.A, <span class="keyword">...</span>
2795         savefile, <span class="keyword">...</span>
2796         guiparams.beam_angle, <span class="keyword">...</span>
2797         guiparams.magnetic_variation, <span class="keyword">...</span>
2798         guiparams.water_surface_elevation, <span class="keyword">...</span>
2799         guiparams.output_auxiliary_data);
2800     
2801     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
2802     
2803 <span class="keyword">end</span>
2804 
2805 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
2806 
2807 
2808 <span class="comment">% --------------------------------------------------------------------</span>
2809 <a name="_sub69" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
2810 <span class="comment">% Get the beam angle</span>
2811 
2812 <span class="comment">% Get the Application data:</span>
2813 <span class="comment">% -------------------------</span>
2814 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2815 
2816 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2817 <span class="comment">% ----------------------------------------------------------------</span>
2818 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
2819 is_a_number = ~isnan(new_beam_angle);
2820 is_positive = new_beam_angle&gt;=0;
2821 
2822 <span class="comment">% Modify the Application data:</span>
2823 <span class="comment">% ----------------------------</span>
2824 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2825     guiparams.beam_angle = new_beam_angle;
2826     
2827     <span class="comment">% Re-store the Application data:</span>
2828     <span class="comment">% ------------------------------</span>
2829     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2830     
2831 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2832     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
2833 <span class="keyword">end</span>
2834 
2835 <span class="comment">% [EOF] BeamAngle_Callback</span>
2836 
2837 
2838 <span class="comment">% --------------------------------------------------------------------</span>
2839 <a name="_sub70" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
2840 <span class="comment">% Get the Magnetic Variation</span>
2841 
2842 <span class="comment">% Get the Application data:</span>
2843 <span class="comment">% -------------------------</span>
2844 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2845 
2846 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2847 <span class="comment">% ----------------------------------------------------------------</span>
2848 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
2849 is_a_number = ~isnan(new_magnetic_variation);
2850 is_positive = new_magnetic_variation&gt;=0;
2851 
2852 <span class="comment">% Modify the Application data:</span>
2853 <span class="comment">% ----------------------------</span>
2854 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2855     guiparams.magnetic_variation = new_magnetic_variation;
2856     
2857     <span class="comment">% Re-store the Application data:</span>
2858     <span class="comment">% ------------------------------</span>
2859     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2860     
2861 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2862     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
2863 <span class="keyword">end</span>
2864 
2865 <span class="comment">% [EOF] MagneticVariation_Callback</span>
2866 
2867 
2868 <span class="comment">% % --------------------------------------------------------------------</span>
2869 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
2870 <span class="comment">%</span>
2871 <span class="comment">% % Get the Application data:</span>
2872 <span class="comment">% % -------------------------</span>
2873 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
2874 <span class="comment">%</span>
2875 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
2876 <span class="comment">% % ----------------------------------------------------------------</span>
2877 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
2878 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
2879 <span class="comment">% is_positive = new_wse&gt;=0;</span>
2880 <span class="comment">%</span>
2881 <span class="comment">% % Modify the Application data:</span>
2882 <span class="comment">% % ----------------------------</span>
2883 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
2884 <span class="comment">%     guiparams.wse = new_wse;</span>
2885 <span class="comment">%</span>
2886 <span class="comment">%     % Re-store the Application data:</span>
2887 <span class="comment">%     % ------------------------------</span>
2888 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2889 <span class="comment">%</span>
2890 <span class="comment">% else % Reject the (incorrect) input</span>
2891 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
2892 <span class="comment">% end</span>
2893 <span class="comment">%</span>
2894 <span class="comment">% % [EOF] WSE_Callback</span>
2895 
2896 
2897 <span class="comment">% --------------------------------------------------------------------</span>
2898 <a name="_sub71" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
2899 <span class="comment">% Bathymetry Auxiliary Data</span>
2900 
2901 <span class="comment">% Get the Application data:</span>
2902 <span class="comment">% -------------------------</span>
2903 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2904 
2905 <span class="comment">% Modify the Application data:</span>
2906 <span class="comment">% ----------------------------</span>
2907 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
2908 
2909 <span class="comment">% Re-store the Application data:</span>
2910 <span class="comment">% ------------------------------</span>
2911 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2912 
2913 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
2914 
2915 
2916 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2917 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
2918 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2919 
2920 <span class="comment">% --------------------------------------------------------------------</span>
2921 <a name="_sub72" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
2922 
2923 <span class="comment">% Get the Application data:</span>
2924 <span class="comment">% -------------------------</span>
2925 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2926 
2927 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2928 <span class="comment">% ----------------------------------------------------------------</span>
2929 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
2930 is_a_number = ~isnan(new_depth_range_min);
2931 is_positive = new_depth_range_min&gt;=0;
2932 
2933 <span class="comment">% Modify the Application data:</span>
2934 <span class="comment">% ----------------------------</span>
2935 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2936     guiparams.depth_range_min = new_depth_range_min;
2937     
2938     <span class="comment">% Re-store the Application data:</span>
2939     <span class="comment">% ------------------------------</span>
2940     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2941     
2942 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2943     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
2944 <span class="keyword">end</span>
2945 
2946 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
2947 
2948 
2949 <span class="comment">% --------------------------------------------------------------------</span>
2950 <a name="_sub73" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
2951 
2952 <span class="comment">% Get the Application data:</span>
2953 <span class="comment">% -------------------------</span>
2954 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2955 
2956 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2957 <span class="comment">% ----------------------------------------------------------------</span>
2958 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
2959 is_a_number = ~isnan(new_depth_range_max);
2960 is_positive = new_depth_range_max&gt;=0;
2961 
2962 <span class="comment">% Modify the Application data:</span>
2963 <span class="comment">% ----------------------------</span>
2964 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2965     guiparams.depth_range_max = new_depth_range_max;
2966     
2967     <span class="comment">% Re-store the Application data:</span>
2968     <span class="comment">% ------------------------------</span>
2969     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2970     
2971 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
2972     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
2973 <span class="keyword">end</span>
2974 
2975 <span class="comment">% [EOF] DepthMax_Callback</span>
2976 
2977 
2978 <span class="comment">% --------------------------------------------------------------------</span>
2979 <a name="_sub74" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
2980 <span class="comment">% Set quiver scale (contour)</span>
2981 
2982 <span class="comment">% Get the Application data:</span>
2983 <span class="comment">% -------------------------</span>
2984 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2985 
2986 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
2987 <span class="comment">% ----------------------------------------------------------------</span>
2988 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
2989 is_a_number = ~isnan(new_vector_scale_plan_view);
2990 is_positive = new_vector_scale_plan_view&gt;=0;
2991 
2992 <span class="comment">% Modify the Application data:</span>
2993 <span class="comment">% ----------------------------</span>
2994 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
2995     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
2996     
2997     <span class="comment">% Re-store the Application data:</span>
2998     <span class="comment">% ------------------------------</span>
2999     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3000     
3001 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3002     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3003 <span class="keyword">end</span>
3004 
3005 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3006 
3007 
3008 <span class="comment">% --------------------------------------------------------------------</span>
3009 <a name="_sub75" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3010 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3011 
3012 <span class="comment">% Get the Application data:</span>
3013 <span class="comment">% -------------------------</span>
3014 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3015 
3016 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3017 <span class="comment">% ----------------------------------------------------------------</span>
3018 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3019 is_a_number = ~isnan(new_vector_spacing_plan_view);
3020 is_positive = new_vector_spacing_plan_view&gt;=0;
3021 
3022 <span class="comment">% Modify the Application data:</span>
3023 <span class="comment">% ----------------------------</span>
3024 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3025     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3026     
3027     <span class="comment">% Re-store the Application data:</span>
3028     <span class="comment">% ------------------------------</span>
3029     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3030     
3031 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3032     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3033 <span class="keyword">end</span>
3034 
3035 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3036 
3037 
3038 <span class="comment">% --------------------------------------------------------------------</span>
3039 <a name="_sub76" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3040 <span class="comment">% Plan View smoothing window size</span>
3041 
3042 <span class="comment">% Get the Application data:</span>
3043 <span class="comment">% -------------------------</span>
3044 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3045 
3046 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3047 <span class="comment">% ----------------------------------------------------------------</span>
3048 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3049 is_a_number = ~isnan(new_smoothing_window_size);
3050 is_positive = new_smoothing_window_size&gt;=0;
3051 
3052 <span class="comment">% Modify the Application data:</span>
3053 <span class="comment">% ----------------------------</span>
3054 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3055     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3056     
3057     <span class="comment">% Re-store the Application data:</span>
3058     <span class="comment">% ------------------------------</span>
3059     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3060     
3061 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3062     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3063 <span class="keyword">end</span>
3064 
3065 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3066 
3067 
3068 <span class="comment">% --------------------------------------------------------------------</span>
3069 <a name="_sub77" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3070 
3071 <span class="comment">% Get the Application data:</span>
3072 <span class="comment">% -------------------------</span>
3073 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3074 
3075 <span class="comment">% Modify the Application data:</span>
3076 <span class="comment">% ----------------------------</span>
3077 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3078 
3079 <span class="comment">% Re-store the Application data:</span>
3080 <span class="comment">% ------------------------------</span>
3081 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3082 
3083 <span class="comment">% [EOF] AddBackground_Callback</span>
3084 
3085 
3086 <span class="comment">% --------------------------------------------------------------------</span>
3087 <a name="_sub78" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3088 <a href="#_sub63" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3089 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3090 
3091 
3092 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3093 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3094 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3095 
3096 <span class="comment">% --------------------------------------------------------------------</span>
3097 <a name="_sub79" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3098 <span class="comment">% Set the horizontal grid node spacing</span>
3099 
3100 <span class="comment">% Get the Application data:</span>
3101 <span class="comment">% -------------------------</span>
3102 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3103 
3104 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3105 <span class="comment">% ----------------------------------------------------------------</span>
3106 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3107 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3108 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3109 
3110 <span class="comment">% Modify the Application data:</span>
3111 <span class="comment">% ----------------------------</span>
3112 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3113     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3114     
3115     <span class="comment">% Re-store the Application data:</span>
3116     <span class="comment">% ------------------------------</span>
3117     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3118     
3119 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3120     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3121 <span class="keyword">end</span>
3122 
3123 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3124 
3125 <span class="comment">% --------------------------------------------------------------------</span>
3126 <a name="_sub80" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3127 <span class="comment">% Set the horizontal grid node spacing</span>
3128 
3129 <span class="comment">% Get the Application data:</span>
3130 <span class="comment">% -------------------------</span>
3131 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3132 
3133 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3134 <span class="comment">% ----------------------------------------------------------------</span>
3135 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3136 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3137 is_positive = new_vertical_grid_node_spacing&gt;=0;
3138 
3139 <span class="comment">% Modify the Application data:</span>
3140 <span class="comment">% ----------------------------</span>
3141 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3142     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3143     
3144     <span class="comment">% Re-store the Application data:</span>
3145     <span class="comment">% ------------------------------</span>
3146     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3147     
3148 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3149     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3150 <span class="keyword">end</span>
3151 
3152 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3153 
3154 <span class="comment">% --------------------------------------------------------------------</span>
3155 <a name="_sub81" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3156 <span class="comment">% Set the cross section endpoints manually</span>
3157 
3158 <span class="comment">% Get the Application data:</span>
3159 <span class="comment">% -------------------------</span>
3160 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3161 
3162 <span class="comment">% Modify the Application data:</span>
3163 <span class="comment">% ----------------------------</span>
3164 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3165 
3166 <span class="comment">% Re-store the Application data:</span>
3167 <span class="comment">% ------------------------------</span>
3168 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3169 
3170 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3171 
3172 
3173 <span class="comment">% --------------------------------------------------------------------</span>
3174 <a name="_sub82" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3175 <a href="#_sub62" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3176 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3177 
3178 
3179 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3180 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3181 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3182 
3183 <span class="comment">% --------------------------------------------------------------------</span>
3184 <a name="_sub83" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3185 
3186 <span class="comment">% Get the Application data:</span>
3187 <span class="comment">% -------------------------</span>
3188 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3189 
3190 <span class="comment">% Modify the Application data:</span>
3191 <span class="comment">% ----------------------------</span>
3192 idx_variable = get(hObject,<span class="string">'Value'</span>);
3193 guiparams.idx_contour = idx_variable;
3194 guiparams.contour = guiparams.contours(idx_variable).variable;
3195 
3196 <span class="comment">% Re-store the Application data:</span>
3197 <span class="comment">% ------------------------------</span>
3198 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3199 
3200 <span class="comment">% [EOF] Contour_Callback</span>
3201 
3202 
3203 <span class="comment">% --------------------------------------------------------------------</span>
3204 <a name="_sub84" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3205 <span class="comment">% Set vertical exaggeration</span>
3206 
3207 <span class="comment">% Get the Application data:</span>
3208 <span class="comment">% -------------------------</span>
3209 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3210 
3211 <span class="comment">% Modify the Application data:</span>
3212 <span class="comment">% ----------------------------</span>
3213 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3214 
3215 <span class="comment">% Re-store the Application data:</span>
3216 <span class="comment">% ------------------------------</span>
3217 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3218 
3219 <span class="comment">% Update the GUI:</span>
3220 <span class="comment">% ---------------</span>
3221 <span class="comment">% updateGUI(handles,guiparams)</span>
3222 
3223 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3224 
3225 
3226 <span class="comment">% --------------------------------------------------------------------</span>
3227 <a name="_sub85" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3228 
3229 <span class="comment">% Get the Application data:</span>
3230 <span class="comment">% -------------------------</span>
3231 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3232 
3233 <span class="comment">% Modify the Application data:</span>
3234 <span class="comment">% ----------------------------</span>
3235 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3236 
3237 <span class="comment">% Re-store the Application data:</span>
3238 <span class="comment">% ------------------------------</span>
3239 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3240 
3241 <span class="comment">% Update the GUI:</span>
3242 <span class="comment">% ---------------</span>
3243 <span class="comment">% updateGUI(handles,guiparams)</span>
3244 
3245 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3246 
3247 
3248 <span class="comment">% --------------------------------------------------------------------</span>
3249 <a name="_sub86" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3250 
3251 <span class="comment">% Get the Application data:</span>
3252 <span class="comment">% -------------------------</span>
3253 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3254 
3255 <span class="comment">% Modify the Application data:</span>
3256 <span class="comment">% ----------------------------</span>
3257 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3258 
3259 <span class="comment">% Re-store the Application data:</span>
3260 <span class="comment">% ------------------------------</span>
3261 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3262 
3263 <span class="comment">% Update the GUI:</span>
3264 <span class="comment">% ---------------</span>
3265 <span class="comment">% updateGUI(handles,guiparams)</span>
3266 
3267 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3268 
3269 
3270 <span class="comment">% --------------------------------------------------------------------</span>
3271 <a name="_sub87" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3272 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3273 
3274 <span class="comment">% Get the Application data:</span>
3275 <span class="comment">% -------------------------</span>
3276 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3277 
3278 <span class="comment">% Modify the Application data:</span>
3279 <span class="comment">% ----------------------------</span>
3280 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3281 
3282 <span class="comment">% Re-store the Application data:</span>
3283 <span class="comment">% ------------------------------</span>
3284 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3285 
3286 <span class="comment">% Update the GUI:</span>
3287 <span class="comment">% ---------------</span>
3288 <span class="comment">% updateGUI(handles,guiparams)</span>
3289 
3290 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3291 
3292 
3293 <span class="comment">% --------------------------------------------------------------------</span>
3294 <a name="_sub88" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3295 <span class="comment">% Horizontal Smoothing</span>
3296 
3297 <span class="comment">% Get the Application data:</span>
3298 <span class="comment">% -------------------------</span>
3299 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3300 
3301 <span class="comment">% Modify the Application data:</span>
3302 <span class="comment">% ----------------------------</span>
3303 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3304 
3305 <span class="comment">% Re-store the Application data:</span>
3306 <span class="comment">% ------------------------------</span>
3307 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3308 
3309 <span class="comment">% Update the GUI:</span>
3310 <span class="comment">% ---------------</span>
3311 <span class="comment">% updateGUI(handles,guiparams)</span>
3312 
3313 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3314 
3315 
3316 <span class="comment">% --------------------------------------------------------------------</span>
3317 <a name="_sub89" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3318 <span class="comment">% Vertical Smoothing</span>
3319 
3320 <span class="comment">% Get the Application data:</span>
3321 <span class="comment">% -------------------------</span>
3322 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3323 
3324 <span class="comment">% Modify the Application data:</span>
3325 <span class="comment">% ----------------------------</span>
3326 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3327 
3328 <span class="comment">% Re-store the Application data:</span>
3329 <span class="comment">% ------------------------------</span>
3330 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3331 
3332 <span class="comment">% Update the GUI:</span>
3333 <span class="comment">% ---------------</span>
3334 <span class="comment">% updateGUI(handles,guiparams)</span>
3335 
3336 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3337 
3338 
3339 <span class="comment">% --------------------------------------------------------------------</span>
3340 <a name="_sub90" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3341 
3342 <span class="comment">% Get the Application data:</span>
3343 <span class="comment">% -------------------------</span>
3344 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3345 
3346 <span class="comment">% Modify the Application data:</span>
3347 <span class="comment">% ----------------------------</span>
3348 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3349 
3350 <span class="comment">% Re-store the Application data:</span>
3351 <span class="comment">% ------------------------------</span>
3352 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3353 
3354 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3355 
3356 
3357 <span class="comment">% --------------------------------------------------------------------</span>
3358 <a name="_sub91" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3359 
3360 <span class="comment">% Get the Application data:</span>
3361 <span class="comment">% -------------------------</span>
3362 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3363 
3364 <span class="comment">% Modify the Application data:</span>
3365 <span class="comment">% ----------------------------</span>
3366 idx_variable = get(hObject,<span class="string">'Value'</span>);
3367 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3368 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3369 
3370 <span class="comment">% Re-store the Application data:</span>
3371 <span class="comment">% ------------------------------</span>
3372 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3373 
3374 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3375 
3376 
3377 <span class="comment">% --------------------------------------------------------------------</span>
3378 <a name="_sub92" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3379 
3380 <span class="comment">% Get the Application data:</span>
3381 <span class="comment">% -------------------------</span>
3382 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3383 
3384 <span class="comment">% Modify the Application data:</span>
3385 <span class="comment">% ----------------------------</span>
3386 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3387 
3388 <span class="comment">% Re-store the Application data:</span>
3389 <span class="comment">% ------------------------------</span>
3390 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3391 
3392 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3393 
3394 
3395 <span class="comment">% --------------------------------------------------------------------</span>
3396 <a name="_sub93" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3397 <a href="#_sub64" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3398 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3399 
3400 
3401 <span class="comment">% --------------------------------------------------------------------</span>
3402 <a name="_sub94" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3403 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3404 <span class="comment">% [EOF] ClearLog_Callback</span>
3405 
3406 <span class="comment">% --------------------------------------------------------------------</span>
3407 <a name="_sub95" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3408 
3409 <span class="comment">% Get the Application data:</span>
3410 <span class="comment">% -------------------------</span>
3411 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3412 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3413 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3414 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3415 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3416 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3417 
3418 [the_file,the_path] = <span class="keyword">...</span>
3419     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3420     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3421     fullfile(guiprefs.log_path,guiprefs.log_file));
3422 
3423 <span class="comment">% Save the log to a TXT file:</span>
3424 <span class="comment">% ---------------------------</span>
3425 <span class="keyword">if</span> ischar(the_file)
3426     guiparams.log_path = the_path;
3427     guiparams.log_file = the_file;
3428     <span class="comment">%guiparams.savefile = the_file;</span>
3429     
3430     <span class="comment">% Re-store the Application data:</span>
3431     <span class="comment">% ------------------------------</span>
3432     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3433     
3434     <span class="comment">% Update the preferences:</span>
3435     <span class="comment">% -----------------------</span>
3436     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3437     guiprefs.log_path = the_path;
3438     guiprefs.log_file = the_file;
3439     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3440     <a href="#_sub98" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3441     
3442     [~,filename,extension] = fileparts(the_file);
3443     savefile = [the_path filename extension];
3444     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3445         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3446     
3447     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3448     [nrows,~]= size(logfile);
3449     fid = fopen(savefile, <span class="string">'w'</span>);
3450     <span class="keyword">for</span> row=1:nrows
3451         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3452     <span class="keyword">end</span>
3453     fclose(fid);
3454 <span class="keyword">end</span>
3455 <span class="comment">% [EOF] SaveLog_Callback</span>
3456 
3457 <span class="comment">%%%%%%%%%%%%%%%%</span>
3458 <span class="comment">% SUBFUNCTIONS %</span>
3459 <span class="comment">%%%%%%%%%%%%%%%%</span>
3460 
3461 <span class="comment">% --------------------------------------------------------------------</span>
3462 <a name="_sub96" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3463 
3464 icons = <a href="#_sub112" class="code" title="subfunction icons = getIcons">getIcons</a>;
3465 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3466 
3467 <span class="comment">% Load data</span>
3468 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3469 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3470 <span class="comment">% icon(icon==0) = NaN;</span>
3471 handles.toolbarLoadData = <span class="keyword">...</span>
3472     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3473     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3474     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3475 
3476 <span class="comment">% Save data</span>
3477 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3478 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3479 <span class="comment">% icon(icon==0) = NaN;</span>
3480 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3481     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3482     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3483     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3484     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3485 
3486 
3487 <span class="comment">% Save bathymetry</span>
3488 <span class="comment">%icon = ones(16,16,3);</span>
3489 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3490     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3491     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3492     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3493 
3494 <span class="comment">% Save figures</span>
3495 <span class="comment">% icon = ones(16,16,3);</span>
3496 handles.toolbarSaveFigures = <span class="keyword">...</span>
3497     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3498     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3499     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3500 
3501 <span class="comment">% Save Excel File</span>
3502 <span class="comment">% icon = ones(16,16,3);</span>
3503 handles.toolbarSaveExcel = <span class="keyword">...</span>
3504     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3505     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3506     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3507 
3508 
3509 <span class="comment">% Plotting parameters</span>
3510 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3511 <span class="comment">% icon = ind2rgb(icon,map);</span>
3512 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3513     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3514     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3515     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3516     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3517 
3518 <span class="comment">% Processing parameters</span>
3519 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3520 <span class="comment">% icon = ind2rgb(icon,map);</span>
3521 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3522     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3523     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3524     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3525 
3526 <span class="comment">% Zoom In</span>
3527 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3528 <span class="comment">% icon = ind2rgb(icon,map);</span>
3529 <span class="comment">% handles.toolbarZoomIn = ...</span>
3530 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3531 <span class="comment">%     'CData',        icons(8).data, ...</span>
3532 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3533 <span class="comment">%     'Separator',     'on');</span>
3534 
3535 <span class="comment">% Zoom Out</span>
3536 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3537 <span class="comment">% icon = ind2rgb(icon,map);</span>
3538 <span class="comment">% handles.toolbarZoomOut = ...</span>
3539 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3540 <span class="comment">%     'CData',        icons(9).data, ...</span>
3541 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3542 
3543 <span class="comment">% Pan</span>
3544 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3545 <span class="comment">% icon = ind2rgb(icon,map);</span>
3546 <span class="comment">% handles.toolbarPan = ...</span>
3547 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3548 <span class="comment">%     'CData',        icons(10).data, ...</span>
3549 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3550 
3551 
3552 
3553 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3554 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3555 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub68" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3556 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub23" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3557 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub28" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3558 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub60" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3559 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub61" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3560 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3561 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3562 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3563 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3564 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3565 
3566 <span class="comment">% [EOF] buildtoolbar</span>
3567 
3568 
3569 <span class="comment">% --------------------------------------------------------------------</span>
3570 <a name="_sub97" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3571 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3572 <span class="comment">% already exist.</span>
3573 
3574 <span class="comment">% Preferences:</span>
3575 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3576 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3577 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3578 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3579 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3580 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3581 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3582 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3583 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3584 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3585 <span class="comment">% 'renderer'             Default graphics renderer</span>
3586 <span class="comment">% 'units'                Default plotting units</span>
3587 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3588 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3589 <span class="comment">%                        started</span>
3590 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3591 
3592 <span class="comment">% Originals</span>
3593 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3594 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3595 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3596 
3597 <span class="comment">% ASCII</span>
3598 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3599     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3600     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3601         guiprefs.ascii_path = ascii.path;
3602     <span class="keyword">else</span>
3603         guiprefs.ascii_path = pwd;
3604     <span class="keyword">end</span>
3605     does_exist = false(1,length(ascii.file));
3606     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3607         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3608     <span class="keyword">end</span>
3609     <span class="keyword">if</span> any(does_exist)
3610         guiprefs.ascii_file = ascii.file(does_exist);
3611     <span class="keyword">else</span>
3612         guiprefs.ascii_file = {<span class="string">''</span>};
3613     <span class="keyword">end</span>
3614 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3615     guiprefs.ascii_path = pwd;
3616     guiprefs.ascii_file = {<span class="string">''</span>};
3617     
3618     ascii.path = pwd;
3619     ascii.file = {<span class="string">''</span>};
3620     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3621 <span class="keyword">end</span>
3622 
3623 <span class="comment">% MAT</span>
3624 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3625     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3626     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3627         guiprefs.mat_path = mat.path;
3628     <span class="keyword">else</span>
3629         guiprefs.mat_path = pwd;
3630     <span class="keyword">end</span>
3631     
3632     <span class="keyword">if</span> iscell(mat.file)
3633         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3634             guiprefs.mat_file = mat.file;
3635         <span class="keyword">else</span>
3636             guiprefs.mat_file = <span class="string">''</span>;
3637         <span class="keyword">end</span>
3638     <span class="keyword">else</span>
3639         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3640             guiprefs.mat_file = mat.file;
3641         <span class="keyword">else</span>
3642             guiprefs.mat_file = <span class="string">''</span>;
3643         <span class="keyword">end</span>
3644     <span class="keyword">end</span>
3645 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3646     guiprefs.mat_path = pwd;
3647     guiprefs.mat_file = <span class="string">''</span>;
3648     
3649     mat.path = pwd;
3650     mat.file = <span class="string">''</span>;
3651     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3652 <span class="keyword">end</span>
3653 
3654 <span class="comment">% SONTEK</span>
3655 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'sontek'</span>)
3656     sontek = getpref(<span class="string">'VMT'</span>,<span class="string">'sontek'</span>);
3657     <span class="keyword">if</span> exist(sontek.path,<span class="string">'dir'</span>)
3658         guiprefs.sontek_path = sontek.path;
3659     <span class="keyword">else</span>
3660         guiprefs.sontek_path = pwd;
3661     <span class="keyword">end</span>
3662     does_exist = false(1,length(sontek.file));
3663     <span class="keyword">for</span> k = 1:length(sontek.file) <span class="comment">% Check each file one-by-one</span>
3664         does_exist(k) = exist(fullfile(sontek.path,sontek.file{k}),<span class="string">'file'</span>);
3665     <span class="keyword">end</span>
3666     <span class="keyword">if</span> any(does_exist)
3667         guiprefs.sontek_file = sontek.file(does_exist);
3668     <span class="keyword">else</span>
3669         guiprefs.sontek_file = {<span class="string">''</span>};
3670     <span class="keyword">end</span>
3671 <span class="keyword">else</span> <span class="comment">% Initialize SONTEK</span>
3672     guiprefs.sontek_path = pwd;
3673     guiprefs.sontek_file = {<span class="string">''</span>};
3674     
3675     sontek.path = pwd;
3676     sontek.file = {<span class="string">''</span>};
3677     setpref(<span class="string">'VMT'</span>,<span class="string">'sontek'</span>,sontek)
3678 <span class="keyword">end</span>
3679 
3680 <span class="comment">% TECPLOT</span>
3681 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3682     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3683     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3684         guiprefs.tecplot_path = tecplot.path;
3685     <span class="keyword">else</span>
3686         guiprefs.tecplot_path = pwd;
3687     <span class="keyword">end</span>
3688     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3689         guiprefs.tecplot_file = tecplot.file;
3690     <span class="keyword">else</span>
3691         guiprefs.tecplot_file = <span class="string">''</span>;
3692     <span class="keyword">end</span>
3693 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3694     guiprefs.tecplot_path = pwd;
3695     guiprefs.tecplot_file = <span class="string">''</span>;
3696     
3697     tecplot.path = pwd;
3698     tecplot.file = <span class="string">''</span>;
3699     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3700 <span class="keyword">end</span>
3701 
3702 <span class="comment">% KMZ</span>
3703 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3704     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3705     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3706         guiprefs.kmz_path = kmz.path;
3707     <span class="keyword">else</span>
3708         guiprefs.kmz_path = pwd;
3709     <span class="keyword">end</span>
3710     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3711         guiprefs.kmz_file = kmz.file;
3712     <span class="keyword">else</span>
3713         guiprefs.kmz_file = <span class="string">''</span>;
3714     <span class="keyword">end</span>
3715 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3716     guiprefs.kmz_path = pwd;
3717     guiprefs.kmz_file = <span class="string">''</span>;
3718     
3719     kmz.path = pwd;
3720     kmz.file = <span class="string">''</span>;
3721     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3722 <span class="keyword">end</span>
3723 
3724 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3725 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3726     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3727     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3728         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3729     <span class="keyword">else</span>
3730         guiprefs.multibeambathymetry_path = pwd;
3731     <span class="keyword">end</span>
3732     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3733         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3734     <span class="keyword">else</span>
3735         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3736     <span class="keyword">end</span>
3737 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3738     guiprefs.multibeambathymetry_path = pwd;
3739     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3740     
3741     multibeambathymetry.path = pwd;
3742     multibeambathymetry.file = <span class="string">''</span>;
3743     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3744 <span class="keyword">end</span>
3745 
3746 <span class="comment">% Log</span>
3747 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3748     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3749     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3750         guiprefs.log_path = log.path;
3751     <span class="keyword">else</span>
3752         guiprefs.log_path = pwd;
3753     <span class="keyword">end</span>
3754     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3755         guiprefs.log_file = log.file;
3756     <span class="keyword">else</span>
3757         guiprefs.log_file = <span class="string">''</span>;
3758     <span class="keyword">end</span>
3759 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3760     guiprefs.log_path = pwd;
3761     guiprefs.log_file = <span class="string">''</span>;
3762     
3763     log.path = pwd;
3764     log.file = <span class="string">''</span>;
3765     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3766 <span class="keyword">end</span>
3767 
3768 <span class="comment">% iRic</span>
3769 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3770     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3771     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3772         guiprefs.iric_path = iric.path;
3773     <span class="keyword">else</span>
3774         guiprefs.iric_path = pwd;
3775     <span class="keyword">end</span>
3776     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3777         guiprefs.iric_file = iric.file;
3778     <span class="keyword">else</span>
3779         guiprefs.iric_file = <span class="string">''</span>;
3780     <span class="keyword">end</span>
3781 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3782     guiprefs.iric_path = pwd;
3783     guiprefs.iric_file = <span class="string">''</span>;
3784     
3785     iric.path = pwd;
3786     iric.file = <span class="string">''</span>;
3787     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3788 <span class="keyword">end</span>
3789 
3790 <span class="comment">% excel</span>
3791 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3792     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3793     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3794         guiprefs.excel_path = excel.path;
3795     <span class="keyword">else</span>
3796         guiprefs.excel_path = pwd;
3797     <span class="keyword">end</span>
3798     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
3799         guiprefs.excel_file = excel.file;
3800     <span class="keyword">else</span>
3801         guiprefs.excel_file = <span class="string">''</span>;
3802     <span class="keyword">end</span>
3803 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
3804     guiprefs.excel_path = pwd;
3805     guiprefs.excel_file = <span class="string">''</span>;
3806     
3807     excel.path = pwd;
3808     excel.file = <span class="string">''</span>;
3809     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
3810 <span class="keyword">end</span>
3811 
3812 <span class="comment">% aerial</span>
3813 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
3814     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
3815     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
3816         guiprefs.aerial_path = aerial.path;
3817     <span class="keyword">else</span>
3818         guiprefs.aerial_path = pwd;
3819     <span class="keyword">end</span>
3820     does_exist = false(1,length(aerial.file));
3821     <span class="keyword">if</span> iscell(aerial.file)
3822     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
3823         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
3824     <span class="keyword">end</span>
3825     <span class="keyword">else</span>
3826         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
3827     <span class="keyword">end</span>
3828     <span class="keyword">if</span> any(does_exist)
3829         guiprefs.aerial_file = aerial.file;
3830     <span class="keyword">else</span>
3831         guiprefs.aerial_file = {<span class="string">''</span>};
3832     <span class="keyword">end</span>
3833 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
3834     guiprefs.aerial_path = pwd;
3835     guiprefs.aerial_file = {<span class="string">''</span>};
3836     
3837     aerial.path = pwd;
3838     aerial.file = {<span class="string">''</span>};
3839     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
3840 <span class="keyword">end</span>
3841 
3842 <span class="comment">% shoreline</span>
3843 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
3844     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
3845     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
3846         guiprefs.shoreline_path = shoreline.path;
3847     <span class="keyword">else</span>
3848         guiprefs.shoreline_path = pwd;
3849     <span class="keyword">end</span>
3850     
3851     <span class="keyword">if</span> iscell(shoreline.file)
3852         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
3853             guiprefs.shoreline_file = shoreline.file;
3854         <span class="keyword">else</span>
3855             guiprefs.shoreline_file = <span class="string">''</span>;
3856         <span class="keyword">end</span>
3857     <span class="keyword">else</span>
3858         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
3859             guiprefs.shoreline_file = shoreline.file;
3860         <span class="keyword">else</span>
3861             guiprefs.shoreline_file = <span class="string">''</span>;
3862         <span class="keyword">end</span>
3863     <span class="keyword">end</span>
3864 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
3865     guiprefs.shoreline_path = pwd;
3866     guiprefs.shoreline_file = <span class="string">''</span>;
3867     
3868     shoreline.path = pwd;
3869     shoreline.file = <span class="string">''</span>;
3870     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
3871 <span class="keyword">end</span>
3872 <span class="comment">% guiprefs.presentation = true;</span>
3873 <span class="comment">% guiprefs.print        = false;</span>
3874 
3875 <span class="comment">% for k = 1:length(prefs)</span>
3876 <span class="comment">%     newpref = '';</span>
3877 <span class="comment">%     if ispref('VMT',prefs{k})</span>
3878 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
3879 <span class="comment">%         if exist(stored_newpref,'dir')</span>
3880 <span class="comment">%             newpref = stored_newpref;</span>
3881 <span class="comment">%         else</span>
3882 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
3883 <span class="comment">%         end</span>
3884 <span class="comment">%     end</span>
3885 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
3886 <span class="comment">% end</span>
3887 
3888 <span class="comment">% RENDERER</span>
3889 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
3890     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
3891     guiprefs.renderer = renderer;
3892 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3893     renderer           = <span class="string">'OpenGL'</span>;
3894     guiprefs.renderer  = renderer;
3895     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
3896 <span class="keyword">end</span>
3897 
3898 <span class="comment">% UNITS</span>
3899 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
3900     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
3901     guiprefs.units = units;
3902 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
3903     units           = <span class="string">'metric'</span>;
3904     guiprefs.units  = units;
3905     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
3906 <span class="keyword">end</span>
3907 
3908 <span class="comment">% PLOTREF</span>
3909 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
3910     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
3911     guiprefs.plotref = plotref;
3912 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
3913     plotref           = <span class="string">'dfs'</span>;
3914     guiprefs.plotref  = plotref;
3915     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
3916 <span class="keyword">end</span>
3917 
3918 <span class="comment">% RUNCOUNTER</span>
3919 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
3920     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
3921     guiprefs.runcounter = runcounter;
3922 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
3923     runcounter           = 1;
3924     guiprefs.runcounter  = runcounter;
3925     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
3926 <span class="keyword">end</span>
3927 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
3928 
3929 <span class="comment">% SETENDPOINTS</span>
3930 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
3931     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
3932     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
3933         guiprefs.setendpoints_path = setendpoints.path;
3934     <span class="keyword">else</span>
3935         guiprefs.setendpoints_path = pwd;
3936     <span class="keyword">end</span>
3937     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
3938         guiprefs.setendpoints_file = setendpoints.file;
3939     <span class="keyword">else</span>
3940         guiprefs.setendpoints_file = <span class="string">''</span>;
3941     <span class="keyword">end</span>
3942 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3943     guiprefs.setendpoints_path = pwd;
3944     guiprefs.setendpoints_file = <span class="string">''</span>;
3945     
3946     setendpoints.path = pwd;
3947     setendpoints.file = <span class="string">''</span>;
3948     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
3949 <span class="keyword">end</span>
3950 
3951 <span class="comment">% [EOF] load_prefs</span>
3952 
3953 
3954 <span class="comment">% --------------------------------------------------------------------</span>
3955 <a name="_sub98" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
3956 <span class="comment">% Store preferences in the Application data and in the persistent</span>
3957 <span class="comment">% preferences data.</span>
3958 
3959 <span class="comment">% Preferences:</span>
3960 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3961 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3962 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3963 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3964 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3965 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3966 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3967 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3968 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3969 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3970 <span class="comment">% 'renderer'             Default graphics renderer</span>
3971 <span class="comment">% 'units'                Default plotting units</span>
3972 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3973 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3974 <span class="comment">%                        started</span>
3975 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
3976 
3977 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
3978 
3979 <span class="keyword">switch</span> pref
3980     <span class="keyword">case</span> <span class="string">'ascii'</span>
3981         ascii.path = guiprefs.ascii_path;
3982         ascii.file = guiprefs.ascii_file;
3983         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3984     <span class="keyword">case</span> <span class="string">'mat'</span>
3985         mat.path = guiprefs.mat_path;
3986         mat.file = guiprefs.mat_file;
3987         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3988     <span class="keyword">case</span> <span class="string">'tecplot'</span>
3989         tecplot.path = guiprefs.tecplot_path;
3990         tecplot.file = guiprefs.tecplot_file;
3991         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3992     <span class="keyword">case</span> <span class="string">'kmz'</span>
3993         kmz.path = guiprefs.kmz_path;
3994         kmz.file = guiprefs.kmz_file;
3995         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3996     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
3997         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
3998         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
3999         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4000     <span class="keyword">case</span> <span class="string">'log'</span>
4001         log.path = guiprefs.log_path;
4002         log.file = guiprefs.log_file;
4003         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4004     <span class="keyword">case</span> <span class="string">'iric'</span>
4005         iric.path = guiprefs.iric_path;
4006         iric.file = guiprefs.iric_file;
4007         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4008     <span class="keyword">case</span> <span class="string">'excel'</span>
4009         excel.path = guiprefs.excel_path;
4010         excel.file = guiprefs.excel_file;
4011         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4012     <span class="keyword">case</span> <span class="string">'aerial'</span>
4013         aerial.path = guiprefs.aerial_path;
4014         aerial.file = guiprefs.aerial_file;
4015         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4016     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4017         shoreline.path = guiprefs.shoreline_path;
4018         shoreline.file = guiprefs.shoreline_file;
4019         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4020     <span class="keyword">case</span> <span class="string">'renderer'</span>
4021         renderer = guiprefs.renderer;
4022         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4023     <span class="keyword">case</span> <span class="string">'units'</span>
4024         units = guiprefs.units;
4025         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4026     <span class="keyword">case</span> <span class="string">'plotref'</span>
4027         plotref = guiprefs.plotref;
4028         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4029     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4030         runcounter = guiprefs.runcounter;
4031         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4032     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4033         setendpoints.path = guiprefs.setendpoints_path;
4034         setendpoints.file = guiprefs.setendpoints_file;
4035         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4036     <span class="keyword">otherwise</span>
4037 <span class="keyword">end</span>
4038 
4039 <span class="comment">% if ismember(pref,prefs)</span>
4040 <span class="comment">%     setpref('VMT',pref,value)</span>
4041 <span class="comment">%</span>
4042 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4043 <span class="comment">%     guiprefs.(pref) = value;</span>
4044 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4045 <span class="comment">% end</span>
4046 
4047 <span class="comment">% [EOF] store_prefs</span>
4048 
4049 
4050 <span class="comment">% --------------------------------------------------------------------</span>
4051 <a name="_sub99" href="#_subfunctions" class="code">function initGUI(handles)</a>
4052 <span class="comment">% Initialize the UI controls in the GUI.</span>
4053 
4054 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4055 
4056 <span class="comment">% Set the name and version</span>
4057 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4058     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4059 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4060 
4061 <span class="comment">% Set the PLOT 1 axis labels</span>
4062 axes(handles.Plot1Shiptracks);
4063 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4064 xlabel(<span class="string">'UTM Easting (m)'</span>)
4065 ylabel(<span class="string">'UTM Northing (m)'</span>)
4066 box on
4067 grid on
4068 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4069 
4070 <span class="comment">%%%%%%%%%%%%</span>
4071 <span class="comment">% MENU BAR %</span>
4072 <span class="comment">%%%%%%%%%%%%</span>
4073 <span class="keyword">if</span> guiparams.english_units
4074     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4075     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4076 <span class="keyword">else</span>
4077     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4078     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4079 <span class="keyword">end</span>
4080 
4081 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4082     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4083     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4084 <span class="keyword">else</span>
4085     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4086     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4087 <span class="keyword">end</span>
4088 
4089 
4090 <span class="keyword">if</span> guiparams.print
4091     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4092     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4093     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4094     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4095 <span class="keyword">elseif</span> guiparams.presentation
4096     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4097     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4098     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4099     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4100 <span class="keyword">else</span>
4101 <span class="keyword">end</span>
4102 
4103 <span class="keyword">switch</span> guiparams.renderer
4104     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4105         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4106         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4107         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4108     <span class="keyword">case</span> <span class="string">'painters'</span>
4109         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4110         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4111         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4112     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4113         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4114         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4115         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4116 <span class="keyword">end</span>
4117 
4118 
4119 <span class="comment">%%%%%%%%%%%%%%%</span>
4120 <span class="comment">% DATA EXPORT %</span>
4121 <span class="comment">%%%%%%%%%%%%%%%</span>
4122 <span class="comment">% BathymetryPanel</span>
4123 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4124 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4125 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4126 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4127 
4128 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4129 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4130 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4131 <span class="comment">% PlanViewPanel</span>
4132 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4133 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4134 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4135 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4136 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4137 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4138 
4139 
4140 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4141 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4142 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4143 <span class="comment">% ShiptracksPanel</span>
4144 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4145 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4146 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4147 
4148 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4149 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4150 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4151 <span class="comment">% CrossSectionsPanel</span>
4152 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4153     <span class="string">'Value'</span>, guiparams.idx_contour)
4154 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4155 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4156 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4157 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4158 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4159 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4160 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4161 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4162     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4163 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4164 
4165 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4166 
4167 <span class="comment">% [EOF] initGUI</span>
4168 
4169 
4170 <span class="comment">% --------------------------------------------------------------------</span>
4171 <a name="_sub100" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4172 
4173 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4174 
4175 <span class="keyword">switch</span> enable_state
4176     <span class="keyword">case</span> <span class="string">'init'</span>
4177         guiparams.gui_state = <span class="string">'init'</span>;
4178         set([handles.menuFile
4179             handles.menuOpen
4180             handles.menuOpenASCII
4181             handles.menuOpenMAT
4182             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4183         
4184         set([handles.toolbarLoadData
4185             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4186         set([handles.toolbarSaveMatFile
4187             handles.toolbarSaveBathymetry
4188             handles.toolbarSaveFigures
4189             handles.toolbarSaveExcel
4190             handles.toolbarPlottingParameters
4191             handles.toolbarProcessingParameters
4192             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4193         
4194         set([handles.DepthRangeMin
4195             handles.DepthRangeMax
4196             handles.VectorScalePlanView
4197             handles.VectorSpacingPlanview
4198             handles.SmoothingWindowSize
4199             handles.AddBackground
4200             handles.PlotPlanView
4201             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4202       
4203         set([handles.HorizontalGridNodeSpacing
4204             handles.VerticalGridNodeSpacing
4205             handles.PlotShiptracks
4206             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4207         
4208         set([handles.Contour
4209             handles.VerticalExaggeration
4210             handles.VectorScaleCrossSection
4211             handles.HorizontalVectorSpacing
4212             handles.VerticalVectorSpacing
4213             handles.HorizontalSmoothingWindow
4214             handles.VerticalSmoothingWindow
4215             handles.PlotSecondaryFlowVectors
4216             handles.SecondaryFlowVectorVariable
4217             handles.IncludeVerticalVelocity
4218             handles.IncludeVerticalVelocityText
4219             handles.PlotCrossSection
4220             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4221         
4222     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4223         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4224         set([handles.menuFile
4225             handles.menuOpen
4226             handles.menuOpenASCII
4227             handles.menuOpenMAT
4228             handles.menuSaveMAT
4229             handles.menuSaveTecplot
4230             handles.menuSaveKMZFile
4231             handles.menuSettings
4232             handles.menuPlottingParameters
4233             handles.menuMetric
4234             handles.menuEnglish
4235             handles.menuBathymetryExportSettings
4236             handles.menuExportMultibeamBathymetry
4237             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4238             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4239         
4240         set([handles.toolbarLoadData
4241             handles.toolbarSaveMatFile
4242             handles.toolbarSaveBathymetry
4243             handles.toolbarSaveExcel
4244             handles.toolbarSaveFigures
4245             handles.toolbarPlottingParameters
4246             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4247         set([handles.toolbarProcessingParameters
4248             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4249         
4250            
4251         set([handles.DepthRangeMin
4252             handles.DepthRangeMax
4253             handles.VectorScalePlanView
4254             handles.VectorSpacingPlanview
4255             handles.SmoothingWindowSize
4256             handles.PlotPlanView
4257             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4258         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4259             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4260         <span class="keyword">else</span>
4261             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4262         <span class="keyword">end</span>
4263         
4264         set([handles.HorizontalGridNodeSpacing
4265             handles.VerticalGridNodeSpacing
4266             handles.PlotShiptracks
4267             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4268         
4269         set([handles.Contour
4270             handles.VerticalExaggeration
4271             handles.VectorScaleCrossSection
4272             handles.HorizontalVectorSpacing
4273             handles.VerticalVectorSpacing
4274             handles.HorizontalSmoothingWindow
4275             handles.VerticalSmoothingWindow
4276             handles.PlotSecondaryFlowVectors
4277             handles.SecondaryFlowVectorVariable
4278             handles.IncludeVerticalVelocity
4279             handles.IncludeVerticalVelocityText
4280             handles.PlotCrossSection
4281             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4282     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4283         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4284         set([handles.menuFile
4285             handles.menuOpen
4286             handles.menuOpenASCII
4287             handles.menuOpenMAT
4288             handles.menuSettings
4289             handles.menuPlottingParameters
4290             handles.menuMetric
4291             handles.menuEnglish
4292             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4293         set([handles.menuSaveMAT
4294             handles.menuBathymetryExportSettings
4295             handles.menuExportMultibeamBathymetry
4296             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4297             handles.menuSaveKMZFile
4298             handles.menuSaveTecplot
4299             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4300         
4301         set([handles.toolbarLoadData
4302             handles.toolbarSaveFigures
4303             handles.toolbarPlottingParameters
4304             handles.toolbarSaveExcel
4305             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4306         set([handles.toolbarProcessingParameters
4307             handles.toolbarSaveMatFile
4308             handles.toolbarSaveBathymetry
4309             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4310         
4311         set([handles.DepthRangeMin
4312             handles.DepthRangeMax
4313             handles.VectorScalePlanView
4314             handles.VectorSpacingPlanview
4315             handles.SmoothingWindowSize
4316             handles.PlotPlanView
4317             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4318         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4319             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4320         <span class="keyword">else</span>
4321             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4322         <span class="keyword">end</span>
4323         
4324         set([handles.HorizontalGridNodeSpacing
4325             handles.VerticalGridNodeSpacing
4326             handles.PlotShiptracks
4327             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4328         
4329         set([handles.Contour
4330             handles.VerticalExaggeration
4331             handles.VectorScaleCrossSection
4332             handles.HorizontalVectorSpacing
4333             handles.VerticalVectorSpacing
4334             handles.HorizontalSmoothingWindow
4335             handles.VerticalSmoothingWindow
4336             handles.PlotSecondaryFlowVectors
4337             handles.SecondaryFlowVectorVariable
4338             handles.IncludeVerticalVelocity
4339             handles.IncludeVerticalVelocityText
4340             handles.PlotCrossSection
4341             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4342     <span class="keyword">otherwise</span>
4343 <span class="keyword">end</span>
4344 
4345 <span class="comment">% Save Application Data</span>
4346 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4347 
4348 <span class="comment">% [EOF] set_enable</span>
4349 
4350 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4351 
4352 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4353 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4354 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4355 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4356 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4357 
4358 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4359 
4360 
4361 <span class="comment">% --------------------------------------------------------------------</span>
4362 <a name="_sub101" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4363     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4364 
4365 w = 500;
4366 h = 110;
4367 dx = 10;
4368 dy = 35;
4369 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4370 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4371     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4372     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4373     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4374     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4375     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4376     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4377     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4378     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4379     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4380     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4381 dialog_params.english_units               = english_units;
4382 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4383 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4384 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4385 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4386 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4387 
4388 <span class="comment">% Build the graphics:</span>
4389 <span class="comment">% -------------------</span>
4390 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4391     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4392     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4393     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4394 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4395     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4396     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4397     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4398     <span class="string">'Position'</span>,[15 35 100 22]);
4399 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4400     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4401     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4402     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4403     <span class="string">'Position'</span>,[15 10 100 22]);
4404 
4405 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4406     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4407     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4408     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4409 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4410     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4411     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4412     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4413     <span class="string">'Position'</span>,[15 35 100 22]);
4414 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4415     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4416     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4417     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4418     <span class="string">'Position'</span>,[15 10 100 22]);
4419 
4420 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4421     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4422     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4423     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4424 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4425     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4426     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4427     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4428     <span class="string">'Position'</span>,[15 35 100 22]);
4429 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4430     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4431     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4432     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4433     <span class="string">'Position'</span>,[15 10 100 22]);
4434 
4435 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4436     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4437     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4438     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4439     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4440 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4441     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4442     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4443     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4444     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4445 
4446 <span class="comment">% Update the UI controls:</span>
4447 <span class="comment">% -----------------------</span>
4448 <span class="keyword">if</span> dialog_params.english_units
4449     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4450     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4451 <span class="keyword">else</span>
4452     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4453     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4454 <span class="keyword">end</span>
4455 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4456     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4457     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4458 <span class="keyword">else</span>
4459     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4460     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4461 <span class="keyword">end</span>
4462 <span class="keyword">if</span> dialog_params.presentation
4463     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4464     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4465 <span class="keyword">else</span>
4466     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4467     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4468 <span class="keyword">end</span>
4469 
4470 <span class="comment">% Set the callbacks:</span>
4471 <span class="comment">% ------------------</span>
4472 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4473 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4474 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4475 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4476 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4477 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4478 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4479 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4480 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4481 
4482 <span class="comment">% Position the dialog and make it visible:</span>
4483 <span class="comment">% ----------------------------------------</span>
4484 fpos = get(hf,<span class="string">'Position'</span>);
4485 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4486 movegui(handles.Figure,dpos)
4487 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4488 
4489 <span class="comment">% Hold the dialog open:</span>
4490 <span class="comment">% ---------------------</span>
4491 waitfor(handles.OK)
4492 
4493 <span class="comment">% Return the outputs and close the dialog:</span>
4494 <span class="comment">% ----------------------------------------</span>
4495 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4496 english_units = dialog_params.english_units;
4497 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4498 plot_presentation_style =  dialog_params.presentation;
4499 plot_print_style =  dialog_params.print;
4500 
4501 delete(handles.Figure)
4502 
4503 <span class="comment">% [EOF] plotParametersDialog</span>
4504 
4505 
4506 <span class="comment">% --------------------------------------------------------------------</span>
4507 <a name="_sub102" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4508 
4509 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4510 <span class="keyword">switch</span> the_units
4511     <span class="keyword">case</span> <span class="string">'metric'</span>
4512         dialog_params.english_units = false;
4513         
4514         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4515         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4516     <span class="keyword">case</span> <span class="string">'english'</span>
4517         dialog_params.english_units = true;
4518         
4519         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4520         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4521     <span class="keyword">otherwise</span>
4522 <span class="keyword">end</span>
4523 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4524 
4525 <span class="comment">% [EOF] dialogUnits</span>
4526 
4527 <span class="comment">% --------------------------------------------------------------------</span>
4528 <a name="_sub103" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4529 
4530 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4531 <span class="keyword">switch</span> the_endpoints
4532     <span class="keyword">case</span> <span class="string">'auto'</span>
4533         dialog_params.set_cross_section_endpoints = false;
4534         
4535         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4536         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4537     <span class="keyword">case</span> <span class="string">'manual'</span>
4538         dialog_params.set_cross_section_endpoints = true;
4539         
4540         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4541         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4542     <span class="keyword">otherwise</span>
4543 <span class="keyword">end</span>
4544 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4545 
4546 <span class="comment">% [EOF] dialogEnpoints</span>
4547 
4548 <a name="_sub104" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4549 
4550 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4551 <span class="keyword">switch</span> the_style
4552     <span class="keyword">case</span> <span class="string">'presentation'</span>
4553         dialog_params.presentation  = true;
4554         dialog_params.print         = false;
4555         
4556         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4557         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4558     <span class="keyword">case</span> <span class="string">'print'</span>
4559         dialog_params.presentation  = false;
4560         dialog_params.print         = true;
4561         
4562         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4563         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4564     <span class="keyword">otherwise</span>
4565 <span class="keyword">end</span>
4566 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4567 
4568 <span class="comment">% [EOF] dialogEnpoints</span>
4569 
4570 <span class="comment">% --------------------------------------------------------------------</span>
4571 <a name="_sub105" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4572 
4573 delete(h_OK)
4574 
4575 <span class="comment">% [EOF] dialogOK</span>
4576 
4577 <span class="comment">% --------------------------------------------------------------------</span>
4578 <a name="_sub106" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4579 <span class="comment">% Return the original inputs</span>
4580 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4581 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4582 delete(handles.OK)
4583 
4584 <span class="comment">% [EOF] dialogCancel</span>
4585 
4586 <span class="comment">% --------------------------------------------------------------------</span>
4587 <a name="_sub107" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4588 
4589 delete(h_OK)
4590 
4591 <span class="comment">% [EOF] dialogCloseReq</span>
4592 
4593 <a name="_sub108" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4594     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4595 w = 230;
4596 h = 245;
4597 dx = 10;
4598 dy = 35;
4599 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4600 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4601     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4602     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4603     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4604     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4605     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4606     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4607     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4608     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4609     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4610     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4611 dialog_params.beam_angle             = beam_angle;
4612 dialog_params.magnetic_variation     = magnetic_variation;
4613 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4614     dialog_params.wse                = <span class="string">'tide'</span>;
4615     wse_string                       = <span class="string">'tide'</span>;
4616 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4617     dialog_params.wse                = <span class="string">'tide'</span>;
4618     wse_string                       = <span class="string">'tide'</span>;
4619 <span class="keyword">else</span>
4620     dialog_params.wse                = wse;
4621     wse_string                       = num2str(wse);
4622 <span class="keyword">end</span>
4623 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4624 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4625 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4626 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4627 
4628 <span class="comment">% Build the graphics:</span>
4629 <span class="comment">% -------------------</span>
4630 ph = 150;
4631 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4632     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4633     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4634     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4635 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4636     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4637     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4638     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4639     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4640     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4641     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4642 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4643     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4644     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4645     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4646     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4647     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4648     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4649 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4650     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4651     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4652     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4653     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4654     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4655     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4656 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4657     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4658     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4659     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4660     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4661     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4662     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4663 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4664     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4665     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4666     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4667     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4668     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4669     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4670 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4671     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4672     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4673     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4674     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4675     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4676     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4677 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4678     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4679     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4680     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4681     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4682 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4683     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4684     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4685     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4686     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4687 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4688     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4689     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4690     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4691     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4692 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4693     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4694     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4695     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4696     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4697 
4698 <span class="comment">% Update the UI controls:</span>
4699 <span class="comment">% -----------------------</span>
4700 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4701 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4702 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4703 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4704 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4705 
4706 <span class="comment">% Set the callbacks:</span>
4707 <span class="comment">% ------------------</span>
4708 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4709 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4710 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4711 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4712 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4713 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub109" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4714 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4715 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4716 
4717 <span class="comment">% Position the dialog and make it visible:</span>
4718 <span class="comment">% ----------------------------------------</span>
4719 fpos = get(hf,<span class="string">'Position'</span>);
4720 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4721 movegui(handles.Figure,dpos)
4722 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4723 
4724 <span class="comment">% Hold the dialog open:</span>
4725 <span class="comment">% ---------------------</span>
4726 waitfor(handles.OK)
4727 
4728 <span class="comment">% Return the outputs and close the dialog:</span>
4729 <span class="comment">% ----------------------------------------</span>
4730 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4731 beam_angle              = dialog_params.beam_angle;
4732 magnetic_variation      = dialog_params.magnetic_variation;
4733 wse                     = dialog_params.wse;
4734 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4735 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4736 
4737 delete(handles.Figure)
4738 
4739 <span class="comment">% [EOF] exportSettingsDialog</span>
4740 
4741 <span class="comment">% --------------------------------------------------------------------</span>
4742 <a name="_sub109" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4743 
4744 <span class="comment">% Grab the current data</span>
4745 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4746 
4747 <span class="comment">% Set it according to the dialog box values</span>
4748 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4749 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4750 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4751 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4752 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4753 
4754 <span class="comment">% Re-store the application data</span>
4755 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4756 
4757 <span class="comment">% [EOF] dialogExportSettings</span>
4758 
4759 <a name="_sub110" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4760 
4761 w = 230;
4762 h = 200;
4763 dx = 10;
4764 dy = 35;
4765 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4766 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4767     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4768     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4769     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4770     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4771     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4772     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4773     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4774     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4775     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4776     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4777 dialog_params.figure_names               = figure_names;
4778 dialog_params.selected_figures           = <span class="string">''</span>;
4779 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4780 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4781 
4782 <span class="comment">% Build the graphics:</span>
4783 <span class="comment">% -------------------</span>
4784 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4785     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4786     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4787     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4788 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4789     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4790     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4791     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4792     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4793     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4794     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4795     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
4796 
4797 
4798 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4799     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4800     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4801     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4802     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4803 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4804     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4805     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4806     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4807     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4808 
4809 <span class="comment">% Update the UI controls:</span>
4810 <span class="comment">% -----------------------</span>
4811 
4812 
4813 <span class="comment">% Set the callbacks:</span>
4814 <span class="comment">% ------------------</span>
4815 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub107" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4816 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
4817 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4818 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4819 
4820 <span class="comment">% Position the dialog and make it visible:</span>
4821 <span class="comment">% ----------------------------------------</span>
4822 fpos = get(hf,<span class="string">'Position'</span>);
4823 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4824 movegui(handles.Figure,dpos)
4825 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4826 
4827 <span class="comment">% Hold the dialog open:</span>
4828 <span class="comment">% ---------------------</span>
4829 waitfor(handles.OK)
4830 
4831 <span class="comment">% Return the outputs and close the dialog:</span>
4832 <span class="comment">% ----------------------------------------</span>
4833 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4834 selected_figures = dialog_params.selected_figures;
4835 
4836 delete(handles.Figure)
4837 
4838 <span class="comment">% [EOF] openFiguresDialog</span>
4839 
4840 <span class="comment">% --------------------------------------------------------------------</span>
4841 <a name="_sub111" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
4842 
4843 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4844 
4845 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
4846 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
4847 selected     = fig_names(idx_selected);
4848 dialog_params.selected_figures = selected;
4849 
4850 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4851 
4852 
4853 
4854 <span class="comment">% --------------------------------------------------------------------</span>
4855 <a name="_sub112" href="#_subfunctions" class="code">function icons = getIcons</a>
4856 
4857 <span class="comment">% Load data</span>
4858 idx = 1;
4859 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4860     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4861     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
4862     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
4863     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
4864     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
4865     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
4866     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
4867     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
4868     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
4869     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
4870     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
4871     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
4872     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
4873     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
4874     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
4875     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
4876 
4877 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4878     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4879     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
4880     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
4881     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
4882     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
4883     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
4884     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
4885     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
4886     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
4887     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
4888     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
4889     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
4890     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
4891     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
4892     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
4893     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
4894 
4895 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4896     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
4897     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
4898     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
4899     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
4900     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
4901     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
4902     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
4903     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
4904     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
4905     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
4906     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
4907     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
4908     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
4909     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
4910     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
4911     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
4912 
4913 <span class="comment">% Save data</span>
4914 idx = idx+1;
4915 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4916     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4917     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
4918     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
4919     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
4920     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
4921     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
4922     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
4923     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
4924     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
4925     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
4926     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
4927     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
4928     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
4929     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
4930     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
4931     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
4932 
4933 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4934     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4935     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
4936     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
4937     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
4938     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
4939     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
4940     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
4941     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
4942     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
4943     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
4944     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
4945     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
4946     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
4947     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
4948     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
4949     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
4950 
4951 icons(idx).data(:,:,3) = <span class="keyword">...</span>
4952     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
4953     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
4954     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
4955     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
4956     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
4957     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
4958     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
4959     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
4960     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
4961     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
4962     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
4963     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
4964     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
4965     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
4966     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
4967     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
4968 
4969 <span class="comment">% Plotting parameters</span>
4970 idx = idx+1;
4971 icons(idx).data(:,:,1) = <span class="keyword">...</span>
4972     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
4973     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
4974     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4975     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4976     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4977     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4978     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
4979     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4980     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4981     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
4982     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
4983     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
4984     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
4985     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4986     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
4987     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
4988 
4989 icons(idx).data(:,:,2) = <span class="keyword">...</span>
4990     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
4991     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
4992     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
4993     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
4994     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
4995     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
4996     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
4997     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
4998     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
4999     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5000     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5001     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5002     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5003     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5004     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5005     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5006 
5007 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5008     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5009     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5010     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5011     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5012     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5013     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5014     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5015     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5016     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5017     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5018     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5019     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5020     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5021     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5022     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5023     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5024 
5025 <span class="comment">% Processing parameters</span>
5026 idx = idx+1;
5027 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5028     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5029     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5030     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5031     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5032     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5033     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5034     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5035     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5036     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5037     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5038     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5039     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5040     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5041     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5042     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5043     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5044 
5045 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5046     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5047     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5048     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5049     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5050     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5051     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5052     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5053     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5054     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5055     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5056     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5057     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5058     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5059     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5060     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5061     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5062 
5063 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5064     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5065     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5066     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5067     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5068     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5069     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5070     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5071     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5072     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5073     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5074     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5075     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5076     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5077     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5078     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5079     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5080 
5081 <span class="comment">% Export bathymetry dialog</span>
5082 idx = idx+1;
5083 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5084     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5085     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5086     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5087     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5088     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5089     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5090     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5091     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5092     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5093     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5094     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5095     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5096     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5097     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5098     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5099     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5100     ]/255;
5101 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5102     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5103     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5104     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5105     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5106     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5107     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5108     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5109     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5110     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5111     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5112     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5113     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5114     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5115     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5116     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5117     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5118     ]/255;
5119 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5120     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5121     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5122     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5123     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5124     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5125     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5126     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5127     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5128     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5129     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5130     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5131     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5132     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5133     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5134     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5135     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5136     ]/255;
5137 
5138 <span class="comment">% Export Figures Dialog</span>
5139 idx = idx + 1;
5140 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5141     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5142     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5143     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5144     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5145     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5146     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5147     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5148     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5149     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5150     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5151     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5152     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5153     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5154     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5155     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5156 
5157 
5158 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5159     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5160     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5161     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5162     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5163     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5164     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5165     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5166     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5167     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5168     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5169     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5170     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5171     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5172     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5173     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5174 
5175 
5176 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5177     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5178     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5179     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5180     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5181     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5182     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5183     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5184     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5185     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5186     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5187     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5188     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5189     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5190     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5191     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5192 
5193 <span class="comment">% Export Excel File</span>
5194 idx = idx + 1;
5195 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5196     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5197    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5198    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5199    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5200    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5201    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5202    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5203    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5204    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5205    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5206    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5207    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5208    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5209    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5210    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5211     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5212 
5213 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5214     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5215    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5216    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5217    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5218    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5219    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5220    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5221    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5222    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5223    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5224    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5225    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5226    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5227    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5228    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5229     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5230 
5231 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5232     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5233    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5234    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5235    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5236    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5237    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5238    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5239    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5240    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5241    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5242    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5243    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5244    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5245    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5246    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5247     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5248 
5249 <span class="comment">% Zoom In</span>
5250 idx = idx + 1;
5251 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5252     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5253 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5254     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5255 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5256     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5257 
5258 <span class="comment">% Zoom Out</span>
5259 idx = idx + 1;
5260 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5261     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5262 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5263     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5264 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5265     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5266 
5267 <span class="comment">% Pan</span>
5268 idx = idx + 1;
5269 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5270     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5271 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5272     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5273 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5274     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5275 <span class="comment">% [EOF] getIcons</span>
5276 
5277 <a name="_sub113" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5278 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5279 
5280 <span class="comment">% Check for any stored prefs</span>
5281 <span class="comment">% --------------------------</span>
5282 <span class="comment">% Units and the graphics renderer are stored as persistent prefs</span>
5283 guiprefs = getpref(<span class="string">'VMT'</span>);
5284 
5285 <span class="comment">% Organized by GUI panels</span>
5286 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5287 <span class="comment">% SHIPTRACKS PLOT %</span>
5288 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5289 guiparams.horizontal_grid_node_spacing       = 1.0;
5290 guiparams.vertical_grid_node_spacing         = 0.4;
5291 
5292 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5293 <span class="comment">% CROSS SECTION PLOT %</span>
5294 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5295 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5296 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5297 guiparams.idx_contour                        = 1;
5298 guiparams.vertical_exaggeration              = 10;
5299 guiparams.vector_scale_cross_section         = 0.2;
5300 guiparams.horizontal_vector_spacing          = 1;
5301 guiparams.vertical_vector_spacing            = 1;
5302 guiparams.horizontal_smoothing_window        = 1;
5303 guiparams.vertical_smoothing_window          = 1;
5304 guiparams.plot_secondary_flow_vectors        = true;
5305 guiparams.allow_vmt_flip_flux                = true;
5306 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5307 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5308 guiparams.idx_secondary_flow_vector_variable = 1;
5309 guiparams.include_vertical_velocity          = true;
5310 
5311 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5312 <span class="comment">% PLAN VIEW PLOT %</span>
5313 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5314 guiparams.depth_range_min                    = 0;
5315 guiparams.depth_range_max                    = inf;
5316 guiparams.vector_scale_plan_view             = 1;
5317 guiparams.vector_spacing_plan_view           = 1;
5318 guiparams.smoothing_window_size              = 1;
5319 guiparams.display_shoreline                  = false;
5320 guiparams.add_background                     = false;
5321 
5322 <span class="comment">%%%%%%%%%%%</span>
5323 <span class="comment">% OFFSETS %</span>
5324 <span class="comment">%%%%%%%%%%%</span>
5325 guiparams.water_surface_elevation            = 0.0;
5326 guiparams.bed_elevation                      = 0.0;
5327 guiparams.KMZ_vertical_offset                = 0.0;
5328 
5329 <span class="comment">%%%%%%%%%%%%%%%</span>
5330 <span class="comment">% DATA EXPORT %</span>
5331 <span class="comment">%%%%%%%%%%%%%%%</span>
5332 guiparams.beam_angle                         = 20.0;
5333 guiparams.magnetic_variation                 = 0.0;
5334 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5335 guiparams.load_wse_tide_file                 = false;
5336 guiparams.output_auxiliary_data              = false;
5337 
5338 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5339 <span class="comment">% Contour variables %</span>
5340 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5341 idx = 1;
5342 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5343 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5344 idx = idx + 1;
5345 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5346 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5347 idx = idx + 1;
5348 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5349 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5350 idx = idx + 1;
5351 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5352 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5353 idx = idx + 1;
5354 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5355 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5356 idx = idx + 1;
5357 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5358 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5359 idx = idx + 1;
5360 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5361 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5362 idx = idx + 1;
5363 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5364 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5365 idx = idx + 1;
5366 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5367 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5368 idx = idx + 1;
5369 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5370 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5371 idx = idx + 1;
5372 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5373 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5374 idx = idx + 1;
5375 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5376 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5377 idx = idx + 1;
5378 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5379 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5380 idx = idx + 1;
5381 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5382 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5383 idx = idx + 1;
5384 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5385 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5386 idx = idx + 1;
5387 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5388 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5389 idx = idx + 1;
5390 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5391 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5392 idx = idx + 1;
5393 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5394 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5395 idx = idx + 1;
5396 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5397 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5398 idx = idx + 1;
5399 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5400 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5401 
5402 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5403 
5404 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5405 <span class="comment">% Secondary Flow Vector Variables %</span>
5406 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5407 idx = 1;
5408 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5409 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5410 idx = idx + 1;
5411 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5412 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5413 idx = idx + 1;
5414 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5415 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5416 idx = idx + 1;
5417 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5418 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5419 idx = idx + 1;
5420 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5421 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5422 
5423 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5424     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5425 
5426 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5427 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5428 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5429 <span class="comment">% Menu bar options</span>
5430 guiparams.presentation                       = true;
5431 guiparams.print                              = false;
5432 guiparams.set_cross_section_endpoints        = false;
5433 guiparams.unit_discharge_correction          = false;
5434 guiparams.start_bank                         = <span class="string">'auto'</span>;
5435 
5436 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5437     <span class="keyword">switch</span> guiprefs.units
5438         <span class="keyword">case</span> <span class="string">'metric'</span>
5439             guiparams.english_units          = false;
5440         <span class="keyword">case</span> <span class="string">'english'</span>
5441             guiparams.english_units          = true;
5442     <span class="keyword">end</span>
5443 <span class="keyword">else</span>
5444     guiparams.english_units                  = false;
5445 <span class="keyword">end</span>
5446 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5447     <span class="keyword">switch</span> guiprefs.plotref
5448         <span class="keyword">case</span> <span class="string">'dfs'</span>
5449             guiparams.plotref                 = <span class="string">'dfs'</span>;
5450         <span class="keyword">case</span> <span class="string">'hab'</span>
5451             guiparams.plotref                 = <span class="string">'hab'</span>;
5452     <span class="keyword">end</span>
5453 <span class="keyword">else</span>
5454     guiparams.plotref                         = <span class="string">'dfs'</span>;
5455 <span class="keyword">end</span>
5456 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5457 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5458 
5459 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5460     guiparams.renderer                       = guiprefs.renderer;
5461 <span class="keyword">else</span>
5462     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5463 <span class="keyword">end</span>
5464 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5465 <span class="comment">% guiparams.plot_planview                      = false;</span>
5466 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5467 
5468 <span class="comment">% File location defaults</span>
5469 guiparams.ascii_path                        = pwd;
5470 guiparams.ascii_file                        = <span class="string">''</span>;
5471 guiparams.mat_path                          = pwd;
5472 guiparams.mat_file                          = <span class="string">''</span>;
5473 guiparams.tecplot_path                      = pwd;
5474 guiparams.tecplot_file                      = <span class="string">''</span>;
5475 guiparams.kmz_path                          = pwd;
5476 guiparams.kmz_file                          = <span class="string">''</span>;
5477 guiparams.multibeambathymetry_path          = pwd;
5478 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5479 guiparams.log_path                          = pwd;
5480 guiparams.log_file                          = <span class="string">''</span>;
5481 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5482 <span class="comment">% application</span>
5483 <span class="keyword">if</span> isdeployed 
5484     guiparams.has_mapping_toolbox           = true;
5485 <span class="keyword">else</span>
5486     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5487         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5488 <span class="keyword">end</span>
5489 
5490 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5491 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5492 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5493 guiparams.z                      = [];
5494 guiparams.A                      = [];
5495 guiparams.V                      = [];
5496 guiparams.Map                    = [];
5497 guiparams.savefile               = [];
5498 guiparams.iric_anv_planview_data = [];
5499 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5500 <span class="comment">% guiparams.zmax = [];</span>
5501 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5502 guiparams.data_folder = <span class="string">''</span>;
5503 guiparams.data_files  = {<span class="string">''</span>};
5504 guiparams.gui_state   = <span class="string">'init'</span>;
5505 
5506 <span class="comment">% [EOF] createGUIparams</span>
5507 
5508 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5509 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5510 
5511 <a name="_sub115" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5512 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5513 
5514 <span class="comment">% [EOF] VMT</span>
5515 
5516 
5517 
5518 <span class="comment">% --- Hidden keyboard commands</span>
5519 <a name="_sub116" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5520 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5521 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5522 <span class="comment">%</span>
5523 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5524 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5525 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5526 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5527 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5528 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5529 
5530 in1 = eventdata.Modifier; 
5531 in2 = eventdata.Key;
5532 
5533 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5534     input = [in1{:} in2];
5535 <span class="keyword">else</span>
5536     input = in2;
5537 <span class="keyword">end</span>
5538 
5539 <span class="keyword">switch</span> input
5540     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5541         <a href="#_sub53" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5542         
5543     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5544         VMT_BuildCustomFlatFile;
5545     <span class="keyword">otherwise</span>
5546         <span class="comment">%disp(input)</span>
5547 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Thu 07-Dec-2017 16:43:07 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>