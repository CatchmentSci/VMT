<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function AllowVMTFlipFlux_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub96" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub97" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub98" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub99" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub100" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub101" class="code">function initGUI(handles)</a></li><li><a href="#_sub102" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub103" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub104" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub105" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub106" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub107" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub108" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub110" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub111" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub112" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub113" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub114" class="code">function icons = getIcons</a></li><li><a href="#_sub115" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub116" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub117" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub118" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 gui_Singleton = 1;
0034 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0035     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0036     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0037     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0038     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0039     <span class="string">'gui_Callback'</span>,   []);
0040 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0041     gui_State.gui_Callback = str2func(varargin{1});
0042 <span class="keyword">end</span>
0043 
0044 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0045 <span class="keyword">try</span>
0046 <span class="keyword">if</span> nargout
0047     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0048 <span class="keyword">else</span>
0049     gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">end</span>
0051 
0052 <span class="keyword">catch</span> err
0053     <span class="keyword">if</span> isdeployed
0054         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0055             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0056         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0057             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0058             errLogFileName},<span class="keyword">...</span>
0059             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0060             <span class="string">'error'</span>);
0061         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0062         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0063         fclose(fid);
0064         rethrow(err)
0065     <span class="keyword">else</span>
0066         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0067             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0068             <span class="string">'error'</span>);
0069         rethrow(err);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 <span class="comment">% End initialization code - DO NOT EDIT</span>
0073 
0074 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0075 
0076 <span class="comment">% --- Executes just before VMT is made visible.</span>
0077 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0078 <span class="comment">% This function has no output args, see OutputFcn.</span>
0079 <span class="comment">% hObject    handle to figure</span>
0080 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0081 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0082 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0083 
0084 <span class="comment">% Choose default command line output for VMT</span>
0085 handles.output = hObject;
0086 
0087 <span class="comment">% Build the GUI toolbar:</span>
0088 <span class="comment">% ----------------------</span>
0089 handles = <a href="#_sub98" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0090 
0091 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0092 <span class="comment">% ----------------------------------------</span>
0093 <span class="keyword">if</span> ~isdeployed
0094     utilspath = [pwd filesep <span class="string">'utils'</span>];
0095     docspath  = [pwd filesep <span class="string">'doc'</span>];
0096     toolspath = [pwd filesep <span class="string">'tools'</span>];
0097     addpath(utilspath,docspath,toolspath)
0098 <span class="keyword">end</span>
0099 
0100 <span class="comment">% Update handles structure</span>
0101 <span class="comment">% ------------------------</span>
0102 guidata(hObject, handles);
0103 
0104 <span class="comment">% Load the GUI preferences:</span>
0105 <span class="comment">% -------------------------</span>
0106 <a href="#_sub99" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0107 
0108 <span class="comment">% Initialize the GUI parameters:</span>
0109 <span class="comment">% ------------------------------</span>
0110 guiparams = <a href="#_sub115" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0111 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20151210'</span>};
0112 
0113 <span class="comment">% Draw the VMT Background</span>
0114 <span class="comment">% -----------------</span>
0115 pos = get(handles.figure1,<span class="string">'position'</span>);
0116 axes(handles.VMTBackground);
0117 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0118     X = imread(<span class="string">'VMT_Background.png'</span>);
0119     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0120 <span class="comment">% else</span>
0121 <span class="comment">%     X = imread('VMT_Background.png');</span>
0122 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0123 <span class="comment">%     X = uint8(X);</span>
0124 <span class="comment">%     imshow(X,'Border','tight')</span>
0125 <span class="comment">% end</span>
0126 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0127 
0128 <span class="comment">% Store the application data:</span>
0129 <span class="comment">% ---------------------------</span>
0130 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0131 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0132 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0133 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0134 
0135 <span class="comment">% Auto-check for updates</span>
0136 <span class="comment">% ----------------------</span>
0137 thres = 20; 
0138 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0139 time_to_check = (mod(runcounter,thres)==0);
0140 <span class="keyword">if</span> time_to_check
0141     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">% Initialize the GUI:</span>
0145 <span class="comment">% -------------------</span>
0146 <a href="#_sub101" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0147 <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0148 <span class="comment">% set(handles.GraphicsExportPanel,'Visible','off')</span>
0149 <span class="comment">% set(handles.ProcessingPanel,'Visible','off')</span>
0150 pos = get(handles.figure1,<span class="string">'Position'</span>);
0151 <span class="comment">% pos(3) = 545;</span>
0152 <span class="comment">% set(handles.figure1,'Position',pos)</span>
0153 movegui(handles.figure1,<span class="string">'center'</span>)
0154 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0155 
0156 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0157 <span class="comment">% the root</span>
0158 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0159 
0160 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0161 <span class="comment">% uiwait(handles.figure1);</span>
0162 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0163 
0164 
0165 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0166 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0167 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0168 <span class="comment">% hObject    handle to figure</span>
0169 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0170 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0171 
0172 <span class="comment">% Get default command line output from handles structure</span>
0173 varargout{1} = handles.output;
0174 <span class="comment">% [EOF] VMT_OutputFcn</span>
0175 
0176 <span class="comment">% --- Executes when figure1 is resized.</span>
0177 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0178 
0179 <span class="comment">% Draw the VMT Background</span>
0180 <span class="comment">% -----------------</span>
0181 pos = get(handles.figure1,<span class="string">'position'</span>);
0182 axes(handles.VMTBackground);
0183 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0184     X = imread(<span class="string">'VMT_Background.png'</span>);
0185     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0186 <span class="comment">% else</span>
0187 <span class="comment">%     X = imread('VMT_Background.png');</span>
0188 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0189 <span class="comment">%     X = uint8(X);</span>
0190 <span class="comment">%     imshow(X,'Border','tight')</span>
0191 <span class="comment">% end</span>
0192 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0193 
0194 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0195 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0196 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0197 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0198 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0199 
0200 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0201 who_called = get(hObject,<span class="string">'tag'</span>);
0202 close_button = questdlg(<span class="keyword">...</span>
0203     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0204     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0205 <span class="keyword">switch</span> close_button
0206     <span class="keyword">case</span> <span class="string">'Yes'</span>
0207         closereq
0208         close all hidden
0209     <span class="keyword">otherwise</span>
0210         <span class="keyword">return</span>
0211 <span class="keyword">end</span>
0212 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0213 
0214 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0215 <span class="comment">% MENU BAR CALLBACKS %</span>
0216 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0217 
0218 <span class="comment">% --------------------------------------------------------------------</span>
0219 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0220 <span class="comment">% Empty</span>
0221 
0222 <span class="comment">% --------------------------------------------------------------------</span>
0223 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0224 <span class="comment">% Empty</span>
0225 
0226 <span class="comment">% --------------------------------------------------------------------</span>
0227 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0228 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0229 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0230 
0231 <span class="comment">% --------------------------------------------------------------------</span>
0232 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0233 
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0254     <span class="comment">% Load the data:</span>
0255     <span class="comment">% --------------</span>
0256     vars = load(fullfile(pathname,filename));
0257     
0258     <span class="comment">% Make sure the selected file is a valid file:</span>
0259     <span class="comment">% --------------------------------------------</span>
0260     varnames = fieldnames(vars);
0261     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0262         guiparams.mat_path = pathname;
0263         guiparams.mat_file = filename;
0264         guiparams.z = vars.z;
0265         guiparams.A = vars.A;
0266         guiparams.V = vars.V;
0267         
0268         <span class="comment">% Update the preferences:</span>
0269         <span class="comment">% -----------------------</span>
0270         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0271         guiprefs.mat_path = pathname;
0272         guiprefs.mat_file = filename;
0273         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0274         <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0275                      
0276         <span class="comment">% Re-store the Application Data:</span>
0277         <span class="comment">% ------------------------------</span>
0278         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0279         
0280         <span class="comment">% Update the GUI:</span>
0281         <span class="comment">% ---------------</span>
0282         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0283         <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0284     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0285         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0286             <span class="string">'Invalid File...'</span>)
0287     <span class="keyword">end</span>
0288     
0289     <span class="comment">% Set the vertical grid node spacing</span>
0290     <span class="comment">% ----------------------------------</span>
0291     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0292     <span class="comment">% Backwards compatible</span>
0293     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0294         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0295     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0296         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0297     <span class="keyword">end</span>
0298     
0299 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0300     <span class="comment">% Set the filenames</span>
0301     <span class="comment">% -----------------</span>
0302     guiparams.mat_path = pathname;
0303     guiparams.mat_file = filename;
0304     
0305     <span class="comment">% Push status to log window</span>
0306     <span class="comment">% -------------------------</span>
0307     log_text = {<span class="keyword">...</span>
0308         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0309         <span class="string">'Directory:'</span>};
0310     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0311     statusLogging(handles.LogWindow,log_text)
0312     
0313     <span class="comment">% Update the Application Data:</span>
0314     <span class="comment">% ------------------------------</span>
0315     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0316     
0317     <span class="comment">% Update the persistent preferences:</span>
0318     <span class="comment">% ----------------------------------</span>
0319     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0320     guiprefs.mat_path = pathname;
0321     guiprefs.mat_file = filename;
0322     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0323     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0324         
0325     <span class="comment">% Update the GUI:</span>
0326     <span class="comment">% ---------------</span>
0327     <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0328 <span class="keyword">end</span>
0329 
0330 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0331 
0332 <span class="comment">% --------------------------------------------------------------------</span>
0333 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0334 <span class="comment">% Empty</span>
0335 
0336 <span class="comment">% --------------------------------------------------------------------</span>
0337 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0338 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0339 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0340 
0341 <span class="comment">% --------------------------------------------------------------------</span>
0342 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0343 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0344 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0345 
0346 <span class="comment">% --------------------------------------------------------------------</span>
0347 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0348 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0349 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0350 
0351 <span class="comment">% --------------------------------------------------------------------</span>
0352 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0353 <span class="comment">% Empty</span>
0354 
0355 <span class="comment">% --------------------------------------------------------------------</span>
0356 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0357 <span class="comment">% Empty</span>
0358 
0359 <span class="comment">% --------------------------------------------------------------------</span>
0360 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0361 
0362 <span class="comment">% Get the Application Data:</span>
0363 <span class="comment">% -------------------------</span>
0364 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0365 
0366 <span class="comment">% Update the Application Data:</span>
0367 <span class="comment">% ----------------------------</span>
0368 guiparams.print        = true;
0369 guiparams.presentation = false;
0370 
0371 <span class="comment">% Re-store the Application data:</span>
0372 <span class="comment">% ------------------------------</span>
0373 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0374 
0375 <span class="comment">% Update the GUI:</span>
0376 <span class="comment">% ---------------</span>
0377 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0378 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0379 
0380 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0381 
0382 
0383 <span class="comment">% --------------------------------------------------------------------</span>
0384 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0385 
0386 <span class="comment">% Get the Application Data:</span>
0387 <span class="comment">% -------------------------</span>
0388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0389 
0390 <span class="comment">% Update the Application Data:</span>
0391 <span class="comment">% ----------------------------</span>
0392 guiparams.print        = false;
0393 guiparams.presentation = true;
0394 
0395 <span class="comment">% Re-store the Application data:</span>
0396 <span class="comment">% ------------------------------</span>
0397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0398 
0399 <span class="comment">% Update the GUI:</span>
0400 <span class="comment">% ---------------</span>
0401 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0402 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0403 
0404 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0405 
0406 <span class="comment">% --------------------------------------------------------------------</span>
0407 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0408 <span class="comment">%  --- Empty ---</span>
0409 
0410 <span class="comment">% --------------------------------------------------------------------</span>
0411 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0412 <span class="comment">% Get the Application Data:</span>
0413 <span class="comment">% -------------------------</span>
0414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0416 
0417 <span class="comment">% Update the Application Data:</span>
0418 <span class="comment">% ----------------------------</span>
0419 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0420 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0421 
0422 <span class="comment">% Re-store the Application data:</span>
0423 <span class="comment">% ------------------------------</span>
0424 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0425 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0426 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0427 
0428 <span class="comment">% Update the GUI:</span>
0429 <span class="comment">% ---------------</span>
0430 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0431 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0432 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 
0434 <span class="comment">% Modify the existing figures</span>
0435 <span class="comment">% ---------------------------</span>
0436 <span class="comment">% Find what plots exist already</span>
0437 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0438 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0439 
0440 <span class="comment">% Loop through valid figures and adjust</span>
0441 <span class="comment">% -------------------------------------</span>
0442 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0443     <span class="keyword">for</span> i = 1:length(valid_names)
0444         <span class="comment">% Focus the figure</span>
0445         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0446         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0447             figure(hff)
0448             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0449         <span class="keyword">end</span>
0450         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0451         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0452             figure(hff)
0453             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0454         <span class="keyword">end</span>
0455     <span class="keyword">end</span>
0456 <span class="keyword">end</span>
0457 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0458 
0459 
0460 <span class="comment">% --------------------------------------------------------------------</span>
0461 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0462 <span class="comment">% Get the Application Data:</span>
0463 <span class="comment">% -------------------------</span>
0464 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0465 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0466 
0467 <span class="comment">% Update the Application Data:</span>
0468 <span class="comment">% ----------------------------</span>
0469 guiparams.renderer  = <span class="string">'painters'</span>;
0470 guiprefs.renderer   = <span class="string">'painters'</span>;
0471 
0472 <span class="comment">% Re-store the Application data:</span>
0473 <span class="comment">% ------------------------------</span>
0474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0475 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0476 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0477 
0478 <span class="comment">% Update the GUI:</span>
0479 <span class="comment">% ---------------</span>
0480 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0481 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0482 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0483 
0484 <span class="comment">% Modify the existing figures</span>
0485 <span class="comment">% ---------------------------</span>
0486 <span class="comment">% Find what plots exist already</span>
0487 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0488 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0489 
0490 <span class="comment">% Loop through valid figures and adjust</span>
0491 <span class="comment">% -------------------------------------</span>
0492 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0493     <span class="keyword">for</span> i = 1:length(valid_names)
0494         <span class="comment">% Focus the figure</span>
0495         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0496         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0497             figure(hff)
0498             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0499         <span class="keyword">end</span>
0500         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0501         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0502             figure(hff)
0503             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0504         <span class="keyword">end</span>
0505     <span class="keyword">end</span>
0506 <span class="keyword">end</span>
0507 <span class="comment">% [EOF] menuPainters_Callback</span>
0508 
0509 <span class="comment">% --------------------------------------------------------------------</span>
0510 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0511 <span class="comment">% Get the Application Data:</span>
0512 <span class="comment">% -------------------------</span>
0513 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0514 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0515 
0516 <span class="comment">% Update the Application Data:</span>
0517 <span class="comment">% ----------------------------</span>
0518 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0519 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0520 
0521 <span class="comment">% Re-store the Application data:</span>
0522 <span class="comment">% ------------------------------</span>
0523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0524 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0525 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0526 
0527 <span class="comment">% Update the GUI:</span>
0528 <span class="comment">% ---------------</span>
0529 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0530 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0532 
0533 <span class="comment">% Modify the existing figures</span>
0534 <span class="comment">% ---------------------------</span>
0535 <span class="comment">% Find what plots exist already</span>
0536 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0537 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0538 
0539 <span class="comment">% Loop through valid figures and adjust</span>
0540 <span class="comment">% -------------------------------------</span>
0541 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0542     <span class="keyword">for</span> i = 1:length(valid_names)
0543         <span class="comment">% Focus the figure</span>
0544         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0545         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0546             figure(hff)
0547             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0548         <span class="keyword">end</span>
0549         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0550         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0551             figure(hff)
0552             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0553         <span class="keyword">end</span>
0554     <span class="keyword">end</span>
0555 <span class="keyword">end</span>
0556 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0557 
0558 <span class="comment">% --------------------------------------------------------------------</span>
0559 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0560 <span class="comment">% Get the Application data:</span>
0561 <span class="comment">% -------------------------</span>
0562 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0563 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0564 
0565 <span class="comment">% Find what plots exist already</span>
0566 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0567 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0568 
0569 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0570 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0571 <span class="keyword">if</span> ~isempty(idx)
0572     fig_names(idx) = [];
0573 <span class="keyword">end</span>
0574 
0575 <span class="keyword">if</span> guiparams.presentation
0576     figure_style = <span class="string">'presentation'</span>;
0577 <span class="keyword">else</span>
0578     figure_style = <span class="string">'print'</span>;
0579 <span class="keyword">end</span>
0580 
0581 [selected_figures] = <a href="#_sub112" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0582 
0583 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0584     <span class="keyword">return</span>
0585 <span class="keyword">else</span>
0586     <span class="keyword">for</span> i = 1:length(selected_figures)
0587         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0588     <span class="keyword">end</span>
0589 <span class="keyword">end</span>
0590 
0591 
0592 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0593 
0594 <span class="comment">% --------------------------------------------------------------------</span>
0595 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0596 <span class="comment">% Get the Application data:</span>
0597 <span class="comment">% -------------------------</span>
0598 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0599 beam_angle             = guiparams.beam_angle; 
0600 magnetic_variation     = guiparams.magnetic_variation; 
0601 wse                    = guiparams.water_surface_elevation;
0602 output_auxiliary_data  = guiparams.output_auxiliary_data;
0603 load_wse_tide_file     = guiparams.load_wse_tide_file;
0604 
0605 <span class="comment">% Open dialog and allow user to select settings</span>
0606 <span class="comment">% ---------------------------------------------</span>
0607 [beam_angle,<span class="keyword">...</span>
0608     magnetic_variation,<span class="keyword">...</span>
0609     wse,<span class="keyword">...</span>
0610     output_auxiliary_data,<span class="keyword">...</span>
0611     load_wse_tide_file] = <span class="keyword">...</span>
0612     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0613 
0614 <span class="comment">% Re-store the Application data:</span>
0615 <span class="comment">% ------------------------------</span>
0616 guiparams.beam_angle            = beam_angle;
0617 guiparams.magnetic_variation    = magnetic_variation; 
0618 guiparams.load_wse_tide_file    = load_wse_tide_file;
0619 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0620       infile = fullfile(<span class="keyword">...</span>
0621         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_file);
0623     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0624     guiparams.water_surface_elevation = wsedata;
0625 <span class="keyword">else</span>
0626       guiparams.water_surface_elevation = wse;
0627 <span class="keyword">end</span>
0628 guiparams.output_auxiliary_data = output_auxiliary_data;
0629 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0630 
0631 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0632 
0633 <span class="comment">% --------------------------------------------------------------------</span>
0634 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0635 <span class="comment">% wsedata.obstime</span>
0636 <span class="comment">% wsedata.elev</span>
0637 
0638 <span class="comment">% Determine Files to Process</span>
0639 <span class="comment">% Ask the user to select files:</span>
0640 <span class="comment">% -----------------------------</span>
0641 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0642     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0643     infile, <span class="keyword">...</span>
0644     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0645 
0646 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0647     data = csvread(fullfile(zPathName,zFileName));
0648     wsedata.obstime = datenum(data(:,1:6));
0649     wsedata.elev    = data(:,7);
0650 <span class="keyword">else</span>
0651     wsedata.obstime = [];
0652     wsedata.elev    = [];
0653     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0654 <span class="keyword">end</span>
0655 <span class="comment">%  [EOF] loadTideFile</span>
0656 
0657 <span class="comment">% --------------------------------------------------------------------</span>
0658 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0659 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0660 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0661 
0662 
0663 <span class="comment">% --------------------------------------------------------------------</span>
0664 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0665 
0666 <span class="comment">% Get the Application Data:</span>
0667 <span class="comment">% -------------------------</span>
0668 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0669 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0670 PVdata    = guiparams.iric_anv_planview_data;
0671 iric_path = guiprefs.iric_path;
0672 iric_file = guiprefs.iric_file;
0673 
0674 <span class="comment">% Is there any planview data?</span>
0675 <span class="keyword">if</span> isempty(PVdata)
0676     <span class="comment">% Nothing to do, warn user</span>
0677     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0678     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0679 <span class="keyword">else</span>
0680     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0681     <span class="comment">% and smoothing (for iRiC)</span>
0682     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0683     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0684         fullfile(iric_path,iric_file));
0685     
0686     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0687         outfile = fullfile(iric_path,iric_file);
0688         log_text = vertcat(log_text,{outfile});
0689         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0690         outcount = fprintf(ofid,<span class="keyword">...</span>
0691             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0692         fclose(ofid);
0693     <span class="keyword">else</span>
0694         <span class="comment">% Return default iric_path and iric_file</span>
0695         iric_path = guiprefs.iric_path;
0696         iric_file = guiprefs.iric_file;
0697     <span class="keyword">end</span>
0698 <span class="keyword">end</span>
0699 
0700 <span class="comment">% Push messages to Log Window:</span>
0701 <span class="comment">% ----------------------------</span>
0702 statusLogging(handles.LogWindow, log_text)
0703 
0704 <span class="comment">% Store the persistent preferences:</span>
0705 <span class="comment">% ---------------------------------</span>
0706 guiprefs.iric_file = iric_file;
0707 guiprefs.iric_path = iric_path;
0708 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0709 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0710 
0711 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0712 
0713 <span class="comment">% --------------------------------------------------------------------</span>
0714 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0715 <span class="comment">% Get the Application Data:</span>
0716 <span class="comment">% -------------------------</span>
0717 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0718 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0719 excel_path  = guiprefs.excel_path;
0720 excel_file  = guiprefs.excel_file;
0721 
0722 <span class="comment">% Push messages to Log Window:</span>
0723 <span class="comment">% ----------------------------</span>
0724 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0725 statusLogging(handles.LogWindow, log_text)
0726 
0727 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0728 <span class="comment">% data.</span>
0729 <span class="keyword">if</span> iscell(guiparams.mat_file)
0730     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0731     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0732     <span class="comment">% Refresh the Application Data:</span>
0733     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0734     z           = guiparams.z;
0735     A           = guiparams.A;
0736     V           = guiparams.V;
0737     Map         = guiparams.Map;
0738     wse         = guiparams.water_surface_elevation;
0739     PVdata      = guiparams.iric_anv_planview_data;
0740     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0741         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0742     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0743         fullfile(excel_path,excel_file));
0744     
0745     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0746         outfile = fullfile(excel_path,excel_file);
0747         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0748         
0749     <span class="keyword">else</span>
0750         <span class="comment">% Return default excel_path and excel_file</span>
0751         excel_path = guiprefs.excel_path;
0752         excel_file = guiprefs.excel_file;
0753         outfile = fullfile(excel_path,excel_file);
0754         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0755     <span class="keyword">end</span>
0756     
0757     <span class="comment">% Delete the old file if it exists</span>
0758     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0759         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0760             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0761             <span class="string">'already exists. Overwriting file...'</span>});
0762         delete(outfile)
0763     <span class="keyword">end</span>
0764     
0765     <span class="comment">% Save MCS Summary to an Excel File</span>
0766     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0767     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0768     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0769     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0770         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0771         sout = guiparams.mat_file';
0772     <span class="keyword">end</span>
0773     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0774     sout = {<span class="keyword">...</span>
0775         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0776         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0777         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0778         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0779         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0780         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0781         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0782         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0783         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0784         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0785         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0786         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0787         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0788         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0789         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0790         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0791         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0792         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0793         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0794         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0795         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0796         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0797         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0798         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0799         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0800         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0801         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0802         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0803         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0804         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0805         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0806         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0807         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0808         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0809         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0810         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0811         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0812         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0813         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0814         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0815         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0816         };
0817     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0818     
0819     <span class="comment">% Save DAV data to an Excel File</span>
0820     vmin = num2str(guiparams.depth_range_min);
0821     vmax = num2str(guiparams.depth_range_max);
0822     pvheaders = {<span class="keyword">...</span>
0823         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0824         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0825         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0826         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0827 
0828     <span class="comment">% Initialize Variables</span>
0829     pvdata = []; Dist = []; ID = {};
0830     X = []; Y = []; E = []; T = [];
0831     Ve = []; Vn =[]; Vm = []; Vd = [];
0832     
0833     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0834     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0835         <span class="comment">% Load current MAT-file</span>
0836         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0837         
0838         <span class="comment">% Location, Time and Bathy</span>
0839         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0840         X = [X V.mcsX(1,:)];
0841         Y = [Y V.mcsY(1,:)];
0842         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0843         E = [E V.mcsBedElev];
0844         T = [T V.mcsTime(1,:)];
0845                 
0846         <span class="comment">% Build layer-averaged velocities</span>
0847         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0848         V.mcsX(indx,:) = nan;
0849         V.mcsY(indx,:) = nan;
0850         V.mcsEast(indx,:) = nan;
0851         V.mcsNorth(indx,:) = nan;
0852         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0853         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0854         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0855         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0856         
0857         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0858     <span class="keyword">end</span>
0859     
0860     <span class="comment">% Put output into 1 matrix</span>
0861     pvdata = [<span class="keyword">...</span>
0862         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0863         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0864         ];
0865     pvdata(isnan(pvdata)) = -9999;
0866     
0867     <span class="comment">% Create table and write to Excel</span>
0868     pvout = num2cell(pvdata');
0869     pvout = horzcat(ID,pvout);
0870     timestamp = cellstr(nandatestr(T));
0871     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0872     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0873     
0874     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0875     <span class="comment">% results</span>
0876     PVheaders = {<span class="keyword">...</span>
0877         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0878         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0879         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0880         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0881         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0882     PVtable = [<span class="keyword">...</span>
0883         PVdata.outmat(1,:);<span class="keyword">...</span>
0884         PVdata.outmat(2,:);<span class="keyword">...</span>
0885         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0886         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0887         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0888         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0889         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0890     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0891     PVtable(isnan(PVtable)) = -9999;
0892     PVout = horzcat(<span class="keyword">...</span>
0893         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0894         PVdata.outfile,<span class="keyword">...</span>
0895         num2cell(PVtable'));
0896     PVout = vertcat(PVheaders,PVout);
0897     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0898     
0899     <span class="comment">% Close out waitbar</span>
0900     waitbar(1,hwait)
0901     delete(hwait)
0902     
0903     <span class="comment">% Push messages to Log Window:</span>
0904     <span class="comment">% ----------------------------</span>
0905     statusLogging(handles.LogWindow, log_text)
0906 <span class="keyword">else</span>
0907     
0908     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0909     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0910     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0911     <span class="comment">% Refresh the Application Data:</span>
0912     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0913     z           = guiparams.z;
0914     A           = guiparams.A;
0915     V           = guiparams.V;
0916     Map         = guiparams.Map;
0917     wse         = guiparams.water_surface_elevation;
0918     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0919                                                     <span class="comment">% Planview Plot exactly</span>
0920     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
0921                                  <span class="comment">% planview plot</span>
0922         
0923     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0924     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0925         fullfile(excel_path,excel_file));
0926     
0927     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0928         outfile = fullfile(excel_path,excel_file);
0929         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0930         
0931         <span class="comment">% Delete the old file if it exists</span>
0932         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0933             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0934                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0935                 <span class="string">'already exists. Overwriting file...'</span>});
0936             delete(outfile)
0937         <span class="keyword">end</span>
0938         
0939         <span class="comment">% Push messages to Log Window:</span>
0940         <span class="comment">% ----------------------------</span>
0941         statusLogging(handles.LogWindow, log_text)
0942         
0943         <span class="comment">% Save MCS Summary to an Excel File</span>
0944         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0945         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0946         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0947         waitbar(1/5,hwait)
0948         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
0949             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0950             sout = {guiparams.mat_file};
0951         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0952             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0953             sout = guiparams.data_files';
0954         <span class="keyword">end</span>
0955         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0956         waitbar(2/7,hwait)
0957         sout = {<span class="keyword">...</span>
0958             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0959             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0960             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0961             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0962             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0963             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0964             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0965             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0966             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0967             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0968             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0969             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0970             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0971             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0972             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0973             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0974             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0975             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0976             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0977             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0978             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0979             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0980             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0981             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0982             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0983             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0984             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0985             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0986             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0987             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0988             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0989             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0990             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0991             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0992             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0993             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0994             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0995             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0996             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0997             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0998             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0999             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1000             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1001             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1002             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1003             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1004             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1005             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1006             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1007             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1008             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1009             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1010             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1011             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1012             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1013             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1014             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1015             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1016             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1017             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1018             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1019             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1020             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1021             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1022             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1023             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1024             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1025             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1026             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1027             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1028             };
1029         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1030         waitbar(3/7,hwait)
1031         
1032         <span class="comment">% Save DAV data to an Excel File</span>
1033         vmin = num2str(guiparams.depth_range_min);
1034         vmax = num2str(guiparams.depth_range_max);
1035         pvheaders = {<span class="keyword">...</span>
1036             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1037             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1038             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1039             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1040             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1041             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1042         
1043         <span class="comment">% Create block style matrix of all processed data</span>
1044         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1045         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1046         <span class="comment">% layer-averaging applied</span>
1047         pvdata = [];
1048         
1049         <span class="comment">% Stationing from LEFT bank</span>
1050         Dist = V.mcsDist;
1051         
1052         <span class="comment">% Build bathy data matrix</span>
1053         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1054         
1055         <span class="comment">% Build layer-averaged velocities</span>
1056         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1057         V.mcsX(indx,:) = nan;
1058         V.mcsY(indx,:) = nan;
1059         V.mcsEast(indx,:) = nan;
1060         V.mcsNorth(indx,:) = nan;
1061         pvdata = [<span class="keyword">...</span>
1062             pvdata;<span class="keyword">...</span>
1063             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1064             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1065             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1066             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1067         pvdata(isnan(pvdata)) = -9999;
1068         pvout = num2cell(pvdata');
1069         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1070         timestr = nandatestr(V.mcsTime(1,:));
1071         timestamp = cellstr(timestr);
1072         pvout = horzcat(timestamp,pvout);
1073         pvout = vertcat(pvheaders,pvout);
1074         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1075         waitbar(4/7,hwait)
1076         
1077         <span class="comment">% Save MCS data to an Excel File</span>
1078         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1079         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1080         MCSheaders = {<span class="keyword">...</span>
1081             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1082             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1083             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1084             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1085             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1086             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1087             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1088             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1089             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1090             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1091             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1092             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1093             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1094             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1095             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1096             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1097             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1098         
1099         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1100         MCSdata = [<span class="keyword">...</span>
1101             V.mcsX(:)<span class="keyword">...</span>
1102             V.mcsY(:)<span class="keyword">...</span>
1103             V.mcsDist(:)<span class="keyword">...</span>
1104             vectorized_bed(:)<span class="keyword">...</span>
1105             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1106             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1107             V.mcsEast(:)<span class="keyword">...</span>
1108             V.mcsNorth(:)<span class="keyword">...</span>
1109             V.mcsVert(:)<span class="keyword">...</span>
1110             V.mcsMag(:)<span class="keyword">...</span>
1111             V.mcsDir(:)<span class="keyword">...</span>
1112             V.u(:)<span class="keyword">...</span>
1113             V.v(:)<span class="keyword">...</span>
1114             V.vp(:)<span class="keyword">...</span>
1115             V.vs(:)<span class="keyword">...</span>
1116             V.Roz.up(:)<span class="keyword">...</span>
1117             V.Roz.us(:)];
1118         MCSdata(isnan(MCSdata)) = -9999;
1119         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1120         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1121         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1122         waitbar(5/7,hwait)
1123                 
1124         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1125         <span class="comment">% results</span>
1126         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1127         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1128         PVheaders = {<span class="keyword">...</span>
1129             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1130             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1131             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1132             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1133             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1134             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1135             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1136             <span class="string">'Vel_dir_deg'</span>};
1137         PVtable = [<span class="keyword">...</span>
1138             PVdata.outmat(1,:);<span class="keyword">...</span>
1139             PVdata.outmat(2,:);<span class="keyword">...</span>
1140             PVDist;<span class="keyword">...</span>
1141             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1142             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1143             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1144             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1145         PVtable = (sortrows(PVtable',3))';
1146         PVtable(isnan(PVtable)) = -9999;
1147         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1148         PVout = vertcat(PVheaders,PVout);
1149         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1150         waitbar(6/7,hwait)
1151         
1152         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1153         <span class="comment">% results</span>
1154         <span class="comment">% Distance is from the LEFT bank</span>
1155         <span class="comment">% Doesn't include the reference vector</span>
1156         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1157         dist    = guiparams.mcsQuivers(1:end-1,1);
1158         depth   = guiparams.mcsQuivers(1:end-1,2);
1159         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1160         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1161         
1162         <span class="comment">% Compute an UTM coordinate for the vector</span>
1163         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1164         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1165         
1166         <span class="comment">% Compute a Time for each vector</span>
1167         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1168         
1169         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1170         <span class="keyword">switch</span> guiparams.contour
1171             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1172                 wtp=[<span class="string">'V.uSmooth'</span>];
1173             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1174                 wtp=[<span class="string">'V.vSmooth'</span>];
1175             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1176                 wtp=[<span class="string">'V.wSmooth'</span>];
1177             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1178                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1179             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1180                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1181             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1182                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1183             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1184                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1185             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1186                 wtp=[<span class="string">'V.vpSmooth'</span>];
1187             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1188                 wtp=[<span class="string">'V.vsSmooth'</span>];
1189             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1190                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1191             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1192                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1193             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1194                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1195             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1196                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1197             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1198                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1199             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1200                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1201             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1202                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1203             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1204                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1205             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1206                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1207             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1208                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1209             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1210                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1211         <span class="keyword">end</span>
1212         Ucomp = eval(wtp);
1213         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1214         
1215         <span class="comment">% Save MCS data to an Excel File</span>
1216         <span class="comment">% This includes the smoothed data results from the plots.</span>
1217         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1218         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1219         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1220         mcsheaders = {<span class="keyword">...</span>
1221             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1222             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1223             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1224             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1225             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1226             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1227             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1228             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1229             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1230             };
1231         mcsdata = [<span class="keyword">...</span>
1232             pUTMx(:)<span class="keyword">...</span>
1233             pUTMy(:)<span class="keyword">...</span>
1234             dist(:)<span class="keyword">...</span>
1235             depth(:)<span class="keyword">...</span>
1236             ucomp(:)<span class="keyword">...</span>
1237             vcomp(:)<span class="keyword">...</span>
1238             wcomp(:)];
1239         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1240         ridx = ~isnan(ucomp);
1241         mcsdata = mcsdata(ridx,:);
1242         mcsdata(isnan(mcsdata)) = -9999;
1243         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1244         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1245         waitbar(7/7,hwait)
1246     <span class="keyword">else</span>
1247         <span class="comment">% Return default excel_path and excel_file</span>
1248         excel_path = guiprefs.excel_path;
1249         excel_file = guiprefs.excel_file;
1250         outfile = fullfile(excel_path,excel_file);
1251         log_text = {<span class="string">'User aborted Excel export...'</span>};
1252     <span class="keyword">end</span>
1253     
1254     
1255 waitbar(1,hwait)  
1256 delete(hwait)
1257 <span class="keyword">end</span>
1258 
1259 <span class="comment">% Push messages to Log Window:</span>
1260 <span class="comment">% ----------------------------</span>
1261 statusLogging(handles.LogWindow, log_text)
1262 
1263 <span class="comment">% Store the persistent preferences:</span>
1264 <span class="comment">% ---------------------------------</span>
1265 guiprefs.excel_file = excel_file;
1266 guiprefs.excel_path = excel_path;
1267 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1268 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1269 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1270 
1271 
1272 <span class="comment">% --------------------------------------------------------------------</span>
1273 <a name="_sub27" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1274 <span class="comment">% Call separate GUI</span>
1275 VMT_BuildCustomFlatFile;
1276 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1277 
1278 <span class="comment">% --------------------------------------------------------------------</span>
1279 <a name="_sub28" href="#_subfunctions" class="code">function menuParameters_Callback(hObject, eventdata, handles)</a>
1280 <span class="comment">% Empty</span>
1281 
1282 <span class="comment">% --------------------------------------------------------------------</span>
1283 <a name="_sub29" href="#_subfunctions" class="code">function menuProcessingParameters_Callback(hObject, eventdata, handles)</a>
1284 <span class="comment">% Empty</span>
1285 
1286 <span class="comment">% --------------------------------------------------------------------</span>
1287 <a name="_sub30" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1288 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1289 
1290 <span class="comment">% Get the Application Data:</span>
1291 <span class="comment">% -------------------------</span>
1292 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1293 
1294 <span class="comment">% Update the GUI &amp; Application Data:</span>
1295 <span class="comment">% ----------------------------------</span>
1296 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1297 <span class="keyword">switch</span> status
1298     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1299         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1300         guiparams.unit_discharge_correction = false;
1301     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1302         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1303         guiparams.unit_discharge_correction = true;
1304 <span class="keyword">end</span>
1305 
1306 <span class="comment">% Re-store the Application data:</span>
1307 <span class="comment">% ------------------------------</span>
1308 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1309 
1310 
1311 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1312 
1313 <span class="comment">% --------------------------------------------------------------------</span>
1314 <a name="_sub31" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1315 <span class="comment">% Empty</span>
1316 
1317 <span class="comment">% --------------------------------------------------------------------</span>
1318 <a name="_sub32" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1319 <span class="comment">% Empty</span>
1320 
1321 <span class="comment">% --------------------------------------------------------------------</span>
1322 <a name="_sub33" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1323 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1324 
1325 <span class="comment">% Get the Application Data:</span>
1326 <span class="comment">% -------------------------</span>
1327 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1328 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1329 
1330 <span class="comment">% Update the Application Data:</span>
1331 <span class="comment">% ----------------------------</span>
1332 guiparams.english_units = false;
1333 guiprefs.units = <span class="string">'metric'</span>;
1334 
1335 <span class="comment">% Re-store the Application data:</span>
1336 <span class="comment">% ------------------------------</span>
1337 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1338 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1339 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1340 
1341 <span class="comment">% Update the GUI:</span>
1342 <span class="comment">% ---------------</span>
1343 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1344 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1345 
1346 <span class="comment">% [EOF] menuMetric_Callback</span>
1347 
1348 
1349 <span class="comment">% --------------------------------------------------------------------</span>
1350 <a name="_sub34" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1351 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1352 
1353 <span class="comment">% Get the Application Data:</span>
1354 <span class="comment">% -------------------------</span>
1355 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1356 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1357 
1358 <span class="comment">% Update the Application Data:</span>
1359 <span class="comment">% ----------------------------</span>
1360 guiparams.english_units = true;
1361 guiprefs.units = <span class="string">'english'</span>;
1362 
1363 <span class="comment">% Re-store the Application data:</span>
1364 <span class="comment">% ------------------------------</span>
1365 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1366 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1367 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1368 
1369 <span class="comment">% Update the GUI:</span>
1370 <span class="comment">% ---------------</span>
1371 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1372 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1373 
1374 <span class="comment">% [EOF] menuEnglish_Callback</span>
1375 
1376 <span class="comment">% --------------------------------------------------------------------</span>
1377 <a name="_sub35" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1378 <span class="comment">% Empty</span>
1379 
1380 <span class="comment">% --------------------------------------------------------------------</span>
1381 <a name="_sub36" href="#_subfunctions" class="code">function menuDepthFromSurface_Callback(hObject, eventdata, handles)</a>
1382 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1383 <span class="comment">% surface)</span>
1384 
1385 <span class="comment">% Get the Application Data:</span>
1386 <span class="comment">% -------------------------</span>
1387 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1388 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1389 
1390 <span class="comment">% Update the Application Data:</span>
1391 <span class="comment">% ----------------------------</span>
1392 guiparams.plotref = <span class="string">'dfs'</span>;
1393 guiprefs.plotref  = <span class="string">'dfs'</span>;
1394 
1395 <span class="comment">% Re-store the Application data:</span>
1396 <span class="comment">% ------------------------------</span>
1397 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1398 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1399 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1400 
1401 <span class="comment">% Update the GUI:</span>
1402 <span class="comment">% ---------------</span>
1403 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1404 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1405 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1406 <span class="comment">% [EOF] menuDepthFromSurface_Callback</span>
1407 
1408 <span class="comment">% --------------------------------------------------------------------</span>
1409 <a name="_sub37" href="#_subfunctions" class="code">function menuHeightAboveBottom_Callback(hObject, eventdata, handles)</a>
1410 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;hab&quot; (height above bed)</span>
1411 
1412 <span class="comment">% Get the Application Data:</span>
1413 <span class="comment">% -------------------------</span>
1414 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1415 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1416 
1417 <span class="comment">% Update the Application Data:</span>
1418 <span class="comment">% ----------------------------</span>
1419 guiparams.plotref = <span class="string">'hab'</span>;
1420 guiprefs.plotref  = <span class="string">'hab'</span>;
1421 
1422 <span class="comment">% % Prompt and set eta</span>
1423 <span class="comment">% % ------------------</span>
1424 <span class="comment">% prompt = 'Enter elevation of the bottom (eta), in meters:';</span>
1425 <span class="comment">% dlg_title = 'Set bottom elevation for height above bottom reference';</span>
1426 <span class="comment">% num_lines = 1;</span>
1427 <span class="comment">% def = {num2str(guiparams.eta)};</span>
1428 <span class="comment">% guiparams.eta = str2num(char(inputdlg(prompt,dlg_title,num_lines,def)));</span>
1429 
1430 
1431 <span class="comment">% Re-store the Application data:</span>
1432 <span class="comment">% ------------------------------</span>
1433 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1434 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1435 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1436 
1437 <span class="comment">% Update the GUI:</span>
1438 <span class="comment">% ---------------</span>
1439 set(handles.menuDepthFromSurface, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1440 set(handles.menuHeightAboveBottom,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1441 set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1442 
1443 
1444 
1445 
1446 <span class="comment">% [EOF] menuHeightAboveBottom_Callback</span>
1447 
1448 <span class="comment">% --------------------------------------------------------------------</span>
1449 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1450 <span class="comment">% Empty</span>
1451 
1452 <span class="comment">% --------------------------------------------------------------------</span>
1453 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1454 <span class="comment">% Set cross-section endpoints automatically</span>
1455 
1456 <span class="comment">% Get the Application Data:</span>
1457 <span class="comment">% -------------------------</span>
1458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1459 
1460 <span class="comment">% Update the Application Data:</span>
1461 <span class="comment">% ----------------------------</span>
1462 guiparams.set_cross_section_endpoints = false;
1463 
1464 <span class="comment">% Re-store the Application data:</span>
1465 <span class="comment">% ------------------------------</span>
1466 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1467 
1468 <span class="comment">% Update the GUI:</span>
1469 <span class="comment">% ---------------</span>
1470 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1471 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1472 
1473 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1474 
1475 
1476 <span class="comment">% --------------------------------------------------------------------</span>
1477 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1478 <span class="comment">% Set cross-section endpoints manually</span>
1479 
1480 <span class="comment">% Get the Application Data:</span>
1481 <span class="comment">% -------------------------</span>
1482 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1483 
1484 <span class="comment">% Update the Application Data:</span>
1485 <span class="comment">% ----------------------------</span>
1486 guiparams.set_cross_section_endpoints = true;
1487 
1488 <span class="comment">% Re-store the Application data:</span>
1489 <span class="comment">% ------------------------------</span>
1490 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1491 
1492 <span class="comment">% Update the GUI:</span>
1493 <span class="comment">% ---------------</span>
1494 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1495 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1496 
1497 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1498 
1499 
1500 
1501 
1502 <span class="comment">% --------------------------------------------------------------------</span>
1503 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1504 <span class="comment">% Empty</span>
1505 
1506 <span class="comment">% --------------------------------------------------------------------</span>
1507 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1508 
1509 <span class="comment">% Get the Application Data:</span>
1510 <span class="comment">% -------------------------</span>
1511 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1512 
1513 <span class="comment">% Update the Application Data:</span>
1514 <span class="comment">% ----------------------------</span>
1515 guiparams.print        = true;
1516 guiparams.presentation = false;
1517 
1518 <span class="comment">% Re-store the Application data:</span>
1519 <span class="comment">% ------------------------------</span>
1520 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1521 
1522 <span class="comment">% Update the GUI:</span>
1523 <span class="comment">% ---------------</span>
1524 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1525 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1526 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1527 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1528 
1529 <span class="comment">% Modify the existing figures</span>
1530 <span class="comment">% ---------------------------</span>
1531 <span class="comment">% Find what plots exist already</span>
1532 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1533 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1534 
1535 <span class="comment">% Defaults for Print Stlye Figure</span>
1536 BkgdColor   = <span class="string">'white'</span>;
1537 AxColor     = <span class="string">'black'</span>;
1538 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1539 FntSize     = 14;
1540 
1541 <span class="comment">% Loop through valid figures and adjust</span>
1542 <span class="comment">% -------------------------------------</span>
1543 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1544     
1545     <span class="keyword">for</span> i = 1:length(valid_names)
1546         <span class="keyword">switch</span> valid_names{i}
1547             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1548                 <span class="comment">% Focus the figure</span>
1549                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1550                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1551                     figure(hff)
1552                     
1553                     <span class="comment">% Make the changes to figure</span>
1554                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1555                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1556                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1557                     set(gca,<span class="string">'Color'</span>,FigColor)
1558                     set(gca,<span class="string">'XColor'</span>,AxColor)
1559                     set(gca,<span class="string">'YColor'</span>,AxColor)
1560                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1561                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1562                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1563                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1564                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1565                         <span class="string">'YColor'</span>,AxColor);
1566                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1567                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1568                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1569                     
1570                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1571                     <span class="comment">% the file(s) and path for the data</span>
1572                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1573                     <span class="keyword">if</span> ~ismultiplot
1574                         filestr = guiparams.savefile;
1575                         wd = length(filestr);
1576                         hd = 1;
1577                     <span class="keyword">else</span>
1578                         <span class="comment">% Construct a filename</span>
1579                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1580                         wd        = max(cellfun(@length,filestr));
1581                         hd        = numel(filestr);
1582                             
1583                     <span class="keyword">end</span>
1584                     
1585                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1586                     disableMenuBar(hff)
1587                     set(fileinfotxt,<span class="keyword">...</span>
1588                         <span class="string">'string'</span>,filestr)
1589                     set(fileinfotxt,<span class="keyword">...</span>
1590                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1591                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1592                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1593                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1594                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1595                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1596                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1597                     
1598                 <span class="keyword">end</span>
1599             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1600                 <span class="comment">% Focus the figure</span>
1601                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1602                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1603                     figure(hff)
1604                     
1605                     <span class="comment">% Make the changes to figure</span>
1606                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1607                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1608                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1609                     set(gca,<span class="string">'Color'</span>,FigColor)
1610                     set(gca,<span class="string">'XColor'</span>,AxColor)
1611                     set(gca,<span class="string">'YColor'</span>,AxColor)
1612                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1613                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1614                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1615                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1616                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1617                         <span class="string">'YColor'</span>,AxColor);
1618                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1619                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1620                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1621                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1622                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1623                     
1624                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1625                     <span class="comment">% the file(s) and path for the data</span>
1626                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1627                     <span class="keyword">if</span> ~ismultiplot
1628                         filestr = guiparams.savefile;
1629                         wd = length(filestr);
1630                         hd = 1;
1631                     <span class="keyword">else</span>
1632                         <span class="comment">% Construct a filename</span>
1633                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1634                         wd        = max(cellfun(@length,filestr));
1635                         hd        = numel(filestr);
1636                             
1637                     <span class="keyword">end</span>
1638                     
1639                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1640                     disableMenuBar(hff)
1641                     set(fileinfotxt,<span class="keyword">...</span>
1642                         <span class="string">'string'</span>,filestr)
1643                     set(fileinfotxt,<span class="keyword">...</span>
1644                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1645                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1646                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1647                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1648                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1649                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1650                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1651                 <span class="keyword">end</span>
1652             <span class="keyword">otherwise</span>
1653         <span class="keyword">end</span>
1654     <span class="keyword">end</span>
1655     
1656     
1657 <span class="keyword">end</span>
1658 
1659 
1660 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1661 
1662 
1663 <span class="comment">% --------------------------------------------------------------------</span>
1664 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1665 <span class="comment">% Get the Application Data:</span>
1666 <span class="comment">% -------------------------</span>
1667 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1668 
1669 <span class="comment">% Update the Application Data:</span>
1670 <span class="comment">% ----------------------------</span>
1671 guiparams.print        = false;
1672 guiparams.presentation = true;
1673 
1674 <span class="comment">% Re-store the Application data:</span>
1675 <span class="comment">% ------------------------------</span>
1676 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1677 
1678 <span class="comment">% Update the GUI:</span>
1679 <span class="comment">% ---------------</span>
1680 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1681 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1682 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1683 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1684 
1685 <span class="comment">% Modify the existing figures</span>
1686 <span class="comment">% ---------------------------</span>
1687 <span class="comment">% Find what plots exist already</span>
1688 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1689 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1690 
1691 <span class="comment">% Defaults for Presentation Style Figure</span>
1692 <span class="comment">% --------------------------------------</span>
1693 BkgdColor   = <span class="string">'black'</span>;
1694 AxColor     = <span class="string">'white'</span>;
1695 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1696 FntSize     = 14;
1697 
1698 <span class="comment">% Loop through valid figures and adjust</span>
1699 <span class="comment">% -------------------------------------</span>
1700 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1701     
1702     <span class="keyword">for</span> i = 1:length(valid_names)
1703         <span class="keyword">switch</span> valid_names{i}
1704             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1705                 <span class="comment">% Focus the figure</span>
1706                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1707                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1708                     figure(hff)
1709                     
1710                     <span class="comment">% Make the changes to figure</span>
1711                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1712                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1713                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1714                     set(gca,<span class="string">'Color'</span>,FigColor)
1715                     set(gca,<span class="string">'XColor'</span>,AxColor)
1716                     set(gca,<span class="string">'YColor'</span>,AxColor)
1717                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1718                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1719                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1720                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1721                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1722                         <span class="string">'YColor'</span>,AxColor);
1723                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1724                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1725                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1726                     
1727                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1728                     <span class="comment">% the file(s) and path for the data</span>
1729                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1730                     <span class="keyword">if</span> ~ismultiplot
1731                         filestr = guiparams.savefile;
1732                         wd = length(filestr);
1733                         hd = 1;
1734                     <span class="keyword">else</span>
1735                         <span class="comment">% Construct a filename</span>
1736                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1737                         wd        = max(cellfun(@length,filestr));
1738                         hd        = numel(filestr);
1739                             
1740                     <span class="keyword">end</span>
1741                     
1742                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1743                     disableMenuBar(hff)
1744                     set(fileinfotxt,<span class="keyword">...</span>
1745                         <span class="string">'string'</span>,filestr)
1746                     set(fileinfotxt,<span class="keyword">...</span>
1747                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1748                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1749                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1750                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1751                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1752                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1753                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1754                     
1755                 <span class="keyword">end</span>
1756             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1757                 <span class="comment">% Focus the figure</span>
1758                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1759                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1760                     figure(hff)
1761                     
1762                     <span class="comment">% Make the changes to figure</span>
1763                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1764                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1765                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1766                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1767                     set(gca,<span class="string">'XColor'</span>,AxColor)
1768                     set(gca,<span class="string">'YColor'</span>,AxColor)
1769                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1770                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1771                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1772                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1773                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1774                         <span class="string">'YColor'</span>,AxColor);
1775                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1776                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1777                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1778                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1779                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1780                     
1781                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1782                     <span class="comment">% the file(s) and path for the data</span>
1783                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1784                     <span class="keyword">if</span> ~ismultiplot
1785                         filestr = guiparams.savefile;
1786                         wd = length(filestr);
1787                         hd = 1;
1788                     <span class="keyword">else</span>
1789                         <span class="comment">% Construct a filename</span>
1790                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1791                         wd        = max(cellfun(@length,filestr));
1792                         hd        = numel(filestr);
1793                             
1794                     <span class="keyword">end</span>
1795                     
1796                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1797                     disableMenuBar(hff)
1798                     set(fileinfotxt,<span class="keyword">...</span>
1799                         <span class="string">'string'</span>,filestr)
1800                     set(fileinfotxt,<span class="keyword">...</span>
1801                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1802                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1803                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1804                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1805                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1806                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1807                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1808                 <span class="keyword">end</span>
1809             <span class="keyword">otherwise</span>
1810         <span class="keyword">end</span>
1811     <span class="keyword">end</span>
1812     
1813     
1814 <span class="keyword">end</span>
1815 
1816 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1817 
1818 <span class="comment">% --------------------------------------------------------------------</span>
1819 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1820 <span class="comment">%</span>
1821 <span class="comment">% % Get the Application data:</span>
1822 <span class="comment">% % -------------------------</span>
1823 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1824 <span class="comment">%</span>
1825 <span class="comment">% % Initialize the answer:</span>
1826 <span class="comment">% % ----------------------</span>
1827 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1828 <span class="comment">% answer = NaN;</span>
1829 <span class="comment">% while isnan(answer)</span>
1830 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1831 <span class="comment">%</span>
1832 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1833 <span class="comment">%         return</span>
1834 <span class="comment">%     end</span>
1835 <span class="comment">%</span>
1836 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1837 <span class="comment">%     % A numeric char will be a double</span>
1838 <span class="comment">% end</span>
1839 <span class="comment">%</span>
1840 <span class="comment">% % Re-store the Application data:</span>
1841 <span class="comment">% % ------------------------------</span>
1842 <span class="comment">% guiparams.vertical_offset = answer;</span>
1843 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1844 <span class="comment">%</span>
1845 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1846 
1847 <span class="comment">% --------------------------------------------------------------------</span>
1848 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1849 <span class="comment">% Not implemented</span>
1850 
1851 <span class="comment">% --------------------------------------------------------------------</span>
1852 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1853 <span class="comment">% Empty</span>
1854 
1855 <span class="comment">% --------------------------------------------------------------------</span>
1856 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1857 ASCII2GIS_GUI
1858 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1859 
1860 <span class="comment">% --------------------------------------------------------------------</span>
1861 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1862 
1863 <span class="comment">% Get the Application preferences:</span>
1864 <span class="comment">% --------------------------------</span>
1865 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1866 
1867 inpath = guiprefs.kmz_path;
1868 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1869     infile = guiprefs.kmz_file{1};
1870 <span class="keyword">else</span>
1871     infile = guiprefs.kmz_file;
1872 <span class="keyword">end</span>
1873 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1874 
1875 guiprefs.kmz_path = outpath;
1876 guiprefs.kmz_file = outfile;
1877 
1878 <span class="comment">% Update persistent preferences</span>
1879 <span class="comment">% -----------------------------</span>
1880 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1881 
1882 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1883 
1884 <span class="comment">% --------------------------------------------------------------------</span>
1885 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1886 <span class="comment">% Get the Application preferences:</span>
1887 <span class="comment">% --------------------------------</span>
1888 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1889 
1890 VMT_BatchMode;
1891 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1892 
1893 <span class="comment">% --------------------------------------------------------------------</span>
1894 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1895 <span class="comment">% Empty</span>
1896 
1897 <span class="comment">% --------------------------------------------------------------------</span>
1898 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1900 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1901     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1902     
1903 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1904     
1905     <span class="keyword">if</span> isdeployed
1906         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1907             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1908         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1909             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1910             errLogFileName},<span class="keyword">...</span>
1911             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1912             <span class="string">'error'</span>);
1913         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1914         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1915         fclose(fid);
1916         rethrow(err)
1917     <span class="keyword">else</span>
1918         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1919             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1920             <span class="string">'error'</span>);
1921         rethrow(err);
1922     <span class="keyword">end</span>
1923 <span class="keyword">end</span>
1924 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1925 
1926 <span class="comment">% --------------------------------------------------------------------</span>
1927 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1928 <span class="comment">% Get the Application data:</span>
1929 <span class="comment">% -------------------------</span>
1930 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1931 
1932 <span class="keyword">try</span>
1933     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1934 
1935 
1936 <span class="comment">% This catch is probably not necessary.</span>
1937 <span class="keyword">catch</span> err 
1938     <span class="keyword">if</span> isdeployed
1939         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1940             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1941         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1942             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1943             errLogFileName},<span class="keyword">...</span>
1944             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1945             <span class="string">'error'</span>);
1946         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1947         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1948         fclose(fid);
1949         rethrow(err)
1950     <span class="keyword">else</span>
1951         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1952             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1953             <span class="string">'error'</span>);
1954         rethrow(err);
1955     <span class="keyword">end</span>
1956 <span class="keyword">end</span>
1957 
1958 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1959 
1960 <span class="comment">% --------------------------------------------------------------------</span>
1961 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1962 
1963 <span class="comment">% Get the Application data:</span>
1964 <span class="comment">% -------------------------</span>
1965 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1966 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1967 
1968 <span class="comment">% Check version tag against the web, and display a message</span>
1969 <span class="keyword">try</span>
1970     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1971     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1972     <span class="keyword">if</span> length(webdata) &gt; 5
1973         current_vmt_version{1} = webdata(1:5);
1974         current_vmt_version{2} = webdata(8:16);
1975     <span class="keyword">else</span>
1976         current_vmt_version = webdata;
1977     <span class="keyword">end</span>
1978     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1979 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1980     <span class="keyword">if</span> isdeployed
1981         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1982             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1983         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1984             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1985             errLogFileName},<span class="keyword">...</span>
1986             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1987             <span class="string">'error'</span>);
1988         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1989         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1990         fclose(fid);
1991         rethrow(err)
1992     <span class="keyword">else</span>
1993         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1994             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1995             <span class="string">'error'</span>);
1996         rethrow(err);
1997     <span class="keyword">end</span>
1998 <span class="keyword">end</span>
1999 
2000 <span class="keyword">if</span> ischar(current_vmt_version)
2001     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2002         h = msgbox(<span class="keyword">...</span>
2003             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2004             <span class="string">''</span>;<span class="keyword">...</span>
2005             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2006             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2007     <span class="keyword">else</span>
2008         h = msgbox(<span class="keyword">...</span>
2009             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2010             <span class="string">''</span>;<span class="keyword">...</span>
2011             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2012             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2013     <span class="keyword">end</span>
2014 <span class="keyword">elseif</span> iscell(current_vmt_version)
2015     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2016         h = msgbox(<span class="keyword">...</span>
2017             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2018             <span class="string">''</span>;<span class="keyword">...</span>
2019             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2020             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2021     <span class="keyword">else</span>
2022         h = msgbox(<span class="keyword">...</span>
2023             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2024             <span class="string">''</span>;<span class="keyword">...</span>
2025             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2026             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2027     <span class="keyword">end</span>
2028 <span class="keyword">end</span>
2029 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2030 
2031 <span class="comment">% --------------------------------------------------------------------</span>
2032 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2033 
2034 <span class="comment">% Get the Application data:</span>
2035 <span class="comment">% -------------------------</span>
2036 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2037 messagestr = <span class="keyword">...</span>
2038     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2039     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2040     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2041     <span class="string">''</span>;<span class="keyword">...</span>
2042     <span class="string">''</span>;<span class="keyword">...</span>
2043     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2044     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2045     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2046     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2047     <span class="string">''</span>;<span class="keyword">...</span>
2048     <span class="string">''</span>;<span class="keyword">...</span>
2049     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2050     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2051     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2052     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2053     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2054     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2055     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2056 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2057 <span class="comment">% [EOF] menuAbout_Callback</span>
2058 
2059 
2060 
2061 
2062 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2063 <span class="comment">% TOOLBAR CALLBACKS %</span>
2064 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2065 
2066 <span class="comment">% --------------------------------------------------------------------</span>
2067 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2068 <span class="comment">% Read Files into Data Structure using tfile.</span>
2069 
2070 <span class="comment">% Get the Application data:</span>
2071 <span class="comment">% -------------------------</span>
2072 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2073 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2074 
2075 <span class="comment">% Ask the user to select files:</span>
2076 <span class="comment">% -----------------------------</span>
2077 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2078 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2079     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2080     current_file, <span class="keyword">...</span>
2081     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2082 
2083 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2084     guiparams.data_folder = pathname;
2085     <span class="keyword">if</span> ischar(filename)
2086         filename = {filename};
2087     <span class="keyword">end</span>
2088     guiparams.data_files = filename;
2089     guiparams.mat_file = <span class="string">''</span>;
2090     
2091     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2092     
2093    
2094     
2095     <span class="comment">% Update the preferences:</span>
2096     <span class="comment">% -----------------------</span>
2097     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2098     guiprefs.ascii_path = pathname;
2099     guiprefs.ascii_file = filename;
2100     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2101     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2102     
2103     <span class="comment">% Push messages to Log Window:</span>
2104     <span class="comment">% ----------------------------</span>
2105     log_text = {<span class="keyword">...</span>
2106         <span class="string">''</span>;<span class="keyword">...</span>
2107         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2108         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2109         guiparams.data_folder;
2110         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2111         char(filename)};
2112     statusLogging(handles.LogWindow, log_text)
2113     
2114     <span class="comment">% Read the file(s)</span>
2115     <span class="comment">% ----------------</span>
2116     [~,~,savefile,A,z] = <span class="keyword">...</span>
2117         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2118     guiparams.savefile = savefile;
2119     guiparams.A        = A;
2120     guiparams.z        = z;
2121     
2122     
2123     <span class="comment">% Set the vertical grid node spacing</span>
2124     <span class="comment">% ----------------------------------</span>
2125     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2126     <span class="comment">% Backwards compatible</span>
2127     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2128         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2129         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2130     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2131         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2132         guiparams.vertical_grid_node_spacing = 0.4;
2133     <span class="keyword">end</span>
2134     
2135     
2136     <span class="comment">% Save application data</span>
2137     <span class="comment">% ---------------------</span>
2138     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2139        
2140 <span class="comment">%</span>
2141 <span class="comment">%     % Preprocess the data:</span>
2142 <span class="comment">%     % --------------------</span>
2143 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2144 <span class="comment">%</span>
2145 <span class="comment">%     % Push messages to Log Window:</span>
2146 <span class="comment">%     % ----------------------------</span>
2147 <span class="comment">%     log_text = {...</span>
2148 <span class="comment">%         '   Preprocessing complete.';...</span>
2149 <span class="comment">%         '   Begin Data Processing...'};</span>
2150 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2151 <span class="comment">%</span>
2152 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2153 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2154 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2155 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2156 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2157 <span class="comment">%</span>
2158 <span class="comment">%     % Push messages to Log Window:</span>
2159 <span class="comment">%     % ----------------------------</span>
2160 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2161 <span class="comment">%</span>
2162 <span class="comment">%     % Store the data:</span>
2163 <span class="comment">%     % ---------------</span>
2164 <span class="comment">%     guiparams.z = z;</span>
2165 <span class="comment">%     guiparams.A = A;</span>
2166 <span class="comment">%     guiparams.V = V;</span>
2167 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2168     
2169           
2170     <span class="comment">% Update the GUI:</span>
2171     <span class="comment">% ---------------</span>
2172     <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2173     
2174     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2175     
2176 <span class="keyword">end</span>
2177 <span class="comment">% [EOF] loadDataCallback</span>
2178 
2179 
2180 
2181 <span class="comment">% --------------------------------------------------------------------</span>
2182 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2183 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2184 
2185 <span class="comment">% Get the Application data:</span>
2186 <span class="comment">% -------------------------</span>
2187 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2188 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2189 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2190 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2191 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2192 
2193 [the_file,the_path] = <span class="keyword">...</span>
2194     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2195     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2196     fullfile(guiparams.mat_path,guiparams.savefile));
2197 
2198 <span class="comment">% Save the processed data to a MAT file:</span>
2199 <span class="comment">% --------------------------------------</span>
2200 <span class="keyword">if</span> ischar(the_file)
2201     guiparams.mat_path = the_path;
2202     guiparams.mat_file = the_file;
2203     guiparams.savefile = the_file;
2204     
2205     <span class="comment">% Re-store the Application data:</span>
2206     <span class="comment">% ------------------------------</span>
2207     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2208     
2209     <span class="comment">% Update the preferences:</span>
2210     <span class="comment">% -----------------------</span>
2211     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2212     guiprefs.mat_path = the_path;
2213     guiprefs.mat_file = the_file;
2214     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2215     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2216     
2217     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2218     savefile = fullfile(pathstr,[filename extension]);
2219     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2220     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2221     log_text = {<span class="keyword">...</span>
2222         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2223         savefile};
2224     statusLogging(handles.LogWindow,log_text)
2225     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2226 <span class="keyword">end</span>
2227 
2228 <span class="comment">% [EOF] saveDataCallback</span>
2229 
2230 
2231 <span class="comment">% --------------------------------------------------------------------</span>
2232 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2233 
2234 <span class="comment">% Get the Application data:</span>
2235 <span class="comment">% -------------------------</span>
2236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2237 z   = guiparams.z;
2238 A   = guiparams.A;
2239 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2240 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2241 
2242 <span class="comment">% Compute multibeam bathymetry:</span>
2243 <span class="comment">% -----------------------------</span>
2244 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2245 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2246 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2247     guiparams.beam_angle, <span class="keyword">...</span>
2248     guiparams.magnetic_variation, <span class="keyword">...</span>
2249     guiparams.water_surface_elevation, <span class="keyword">...</span>
2250     guiparams.output_auxiliary_data);
2251 
2252 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2253 
2254 <span class="comment">% [EOF] saveBathymetryCallback</span>
2255 
2256 <span class="comment">% --------------------------------------------------------------------</span>
2257 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2258 
2259 <span class="comment">% Get the Application data:</span>
2260 <span class="comment">% -------------------------</span>
2261 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2262 
2263 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2264     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2265     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2266     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2267     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2268     handles.figure1);
2269 
2270 <span class="comment">% Update the GUI:</span>
2271 <span class="comment">% ---------------</span>
2272 <span class="keyword">if</span> guiparams.english_units
2273     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2274     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2275 <span class="keyword">else</span>
2276     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2277     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2278 <span class="keyword">end</span>
2279 
2280 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2281     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2282     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2283 <span class="keyword">else</span>
2284     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2285     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2286 <span class="keyword">end</span>
2287 
2288 <span class="keyword">if</span> guiparams.presentation
2289     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2290 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2291 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2292 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2293 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2294 <span class="keyword">else</span>
2295     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2296 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2297 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2298 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2299 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2300 <span class="keyword">end</span>
2301 
2302 <span class="comment">% Re-store the Application data:</span>
2303 <span class="comment">% ------------------------------</span>
2304 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2305 
2306 <span class="comment">% [EOF] plottingParametersCallback</span>
2307 
2308 
2309 <span class="comment">% --------------------------------------------------------------------</span>
2310 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2311 
2312 <span class="comment">% Get the Application data:</span>
2313 <span class="comment">% -------------------------</span>
2314 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2315 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2316 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2317 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2318 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2319 
2320 <span class="comment">% [EOF] processingParametersCallback</span>
2321 
2322 
2323 <span class="comment">% --------------------------------------------------------------------</span>
2324 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2325 <span class="comment">% Plot 1</span>
2326 
2327 <span class="comment">% Get the Application data:</span>
2328 <span class="comment">% -------------------------</span>
2329 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2330 z = guiparams.z;
2331 A = guiparams.A;
2332 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2333 <span class="comment">% Map = guiparams.Map;</span>
2334 
2335 
2336 <span class="comment">% Preprocess the data:</span>
2337 <span class="comment">% --------------------</span>
2338 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2339 
2340 <span class="comment">% Push messages to Log Window:</span>
2341 <span class="comment">% ----------------------------</span>
2342 log_text = {<span class="keyword">...</span>
2343     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2344     <span class="string">'   Begin Data Processing...'</span>};
2345 statusLogging(handles.LogWindow, log_text)
2346 
2347 <span class="comment">% Process the transects:</span>
2348 <span class="comment">% ----------------------</span>
2349 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2350 A(1).vgns = guiparams.vertical_grid_node_spacing;
2351 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2352 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2353     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2354 
2355 <span class="comment">% Compute the smoothed variables</span>
2356 <span class="comment">% ------------------------------</span>
2357 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2358 <span class="comment">% runtime.</span>
2359 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2360     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2361     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2362     guiparams.vertical_smoothing_window);
2363 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2364 
2365 <span class="comment">% Push messages to Log Window:</span>
2366 <span class="comment">% ----------------------------</span>
2367 statusLogging(handles.LogWindow, processing_log_text)
2368 
2369 <span class="comment">% Store the data:</span>
2370 <span class="comment">% ---------------</span>
2371 guiparams.z = z;
2372 guiparams.A = A;
2373 guiparams.V = V;
2374 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2375 
2376 <span class="comment">% Push messages to Log Window:</span>
2377 <span class="comment">% ----------------------------</span>
2378 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2379 statusLogging(handles.LogWindow, log_text)
2380 
2381 <span class="comment">% Create or replot the Shiptracks</span>
2382 <span class="comment">% -------------------------------</span>
2383 <span class="comment">% Grab the axes to the plot</span>
2384 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2385 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2386 
2387 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2388 <span class="comment">% New plot display window</span>
2389 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2390 <span class="comment">% h = figure(1); clf</span>
2391 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2392 
2393 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2394 
2395 
2396 <span class="comment">% --------------------------------------------------------------------</span>
2397 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2398 <span class="comment">% Plot 2</span>
2399 
2400 <span class="comment">% Get the Application data:</span>
2401 <span class="comment">% -------------------------</span>
2402 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2403 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2404 
2405 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2406     <span class="comment">% Push messages to Log Window:</span>
2407     <span class="comment">% ----------------------------</span>
2408     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2409     statusLogging(handles.LogWindow, log_text)
2410     
2411        
2412     <span class="comment">% Push plotting parameters to log window:</span>
2413     <span class="comment">% ---------------------------------------</span>
2414     log_text = {<span class="keyword">...</span>
2415         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2416         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2417         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2418         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2419         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2420         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2421         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2422         };
2423     statusLogging(handles.LogWindow, log_text)
2424     
2425     <span class="comment">% Plot the data:</span>
2426     <span class="comment">% --------------</span>
2427     z = [];
2428     A = [];
2429     V = [];
2430     Map = [];
2431     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2432     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2433         depth_range, <span class="keyword">...</span>
2434         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2435         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2436         guiparams.smoothing_window_size, <span class="keyword">...</span>
2437         guiparams.display_shoreline, <span class="keyword">...</span>
2438         guiparams.english_units, <span class="keyword">...</span>
2439         guiparams.mat_file, <span class="keyword">...</span>
2440         guiparams.mat_path, <span class="keyword">...</span>
2441         guiparams.plotref); <span class="comment">% PLOT2</span>
2442     statusLogging(handles.LogWindow, log_text)
2443     
2444     <span class="comment">% Plot a Shoreline Map:</span>
2445     <span class="comment">% ---------------------</span>
2446     <span class="keyword">if</span> guiparams.display_shoreline
2447         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2448             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2449             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2450             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2451         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2452             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2453             Map.UTMe   = mapdata(:,1);
2454             Map.UTMn   = mapdata(:,2);
2455             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2456             <span class="comment">%Map.UTMzone = zone;</span>
2457         <span class="keyword">else</span>
2458             Map = [];
2459         <span class="keyword">end</span>
2460         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2461         log_text = {<span class="keyword">...</span>
2462             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2463             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2464             };
2465         statusLogging(handles.LogWindow, log_text)
2466     <span class="keyword">else</span>
2467         Map = [];
2468     <span class="keyword">end</span>
2469     
2470 <span class="keyword">else</span>
2471     z = guiparams.z;
2472     A = guiparams.A;
2473     <span class="comment">% V = guiparams.V;</span>
2474     Map = guiparams.Map;
2475     
2476     <span class="comment">% Push messages to Log Window:</span>
2477     <span class="comment">% ----------------------------</span>
2478     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2479     statusLogging(handles.LogWindow, log_text)
2480     
2481         
2482     <span class="comment">% Preprocess the data:</span>
2483     <span class="comment">% --------------------</span>
2484     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2485     
2486     <span class="comment">% Process the transects:</span>
2487     <span class="comment">% ----------------------</span>
2488     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2489     A(1).vgns = guiparams.vertical_grid_node_spacing;
2490     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2491     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2492         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2493     
2494     <span class="comment">% Compute the smoothed variables</span>
2495     <span class="comment">% ------------------------------</span>
2496     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2497     <span class="comment">% runtime.</span>
2498     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2499         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2500         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2501         guiparams.vertical_smoothing_window);
2502     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2503     
2504     <span class="comment">% Push messages to Log Window:</span>
2505     <span class="comment">% ----------------------------</span>
2506     statusLogging(handles.LogWindow, processing_log_text)
2507     
2508     <span class="comment">% Plot the cross section:</span>
2509     <span class="comment">% -----------------------</span>
2510     log_text = {<span class="keyword">...</span>
2511         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2512         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2513         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2514         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2515         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2516         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2517         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2518         };
2519     statusLogging(handles.LogWindow, log_text)
2520     
2521     <span class="comment">% Plot the data:</span>
2522     <span class="comment">% --------------</span>
2523     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2524     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2525     
2526     
2527     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2528         depth_range, <span class="keyword">...</span>
2529         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2530         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2531         guiparams.smoothing_window_size, <span class="keyword">...</span>
2532         guiparams.display_shoreline, <span class="keyword">...</span>
2533         guiparams.english_units, <span class="keyword">...</span>
2534         guiparams.mat_file, <span class="keyword">...</span>
2535         guiparams.mat_path, <span class="keyword">...</span>
2536         guiparams.plotref); <span class="comment">% PLOT2</span>
2537     statusLogging(handles.LogWindow, log_text)
2538     
2539     <span class="comment">% Plot User Set Endpoints</span>
2540     <span class="comment">% -----------------------</span>
2541     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2542         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2543         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2544         x = data(:,1);
2545         y = data(:,2);
2546         
2547         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2548         figure(fh); hold on
2549         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2550         hold off
2551     <span class="keyword">end</span>
2552     
2553     <span class="comment">% Plot a Shoreline Map:</span>
2554     <span class="comment">% ---------------------</span>
2555     <span class="keyword">if</span> guiparams.display_shoreline
2556         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2557             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2558             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2559             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2560         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2561             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2562             Map.UTMe   = mapdata(:,1);
2563             Map.UTMn   = mapdata(:,2);
2564             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2565             <span class="comment">%Map.UTMzone = zone;</span>
2566         <span class="keyword">else</span>
2567             Map = [];
2568         <span class="keyword">end</span>
2569         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2570         log_text = {<span class="keyword">...</span>
2571             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2572             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2573             };
2574         statusLogging(handles.LogWindow, log_text)
2575     <span class="keyword">else</span>
2576         Map = [];
2577     <span class="keyword">end</span>
2578     
2579 <span class="keyword">end</span>
2580 
2581 <span class="keyword">if</span> guiparams.add_background
2582     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2583     statusLogging(handles.LogWindow, log_text)
2584 <span class="keyword">end</span>
2585 
2586 <span class="comment">% Update guiparams</span>
2587 <span class="comment">% ----------------</span>
2588 guiparams.z   = z;
2589 guiparams.A   = A;
2590 guiparams.V   = V;
2591 guiparams.Map = Map;
2592 guiparams.iric_anv_planview_data = PVdata;
2593 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2594 
2595 <span class="comment">% Update preferences</span>
2596 <span class="comment">% ------------------</span>
2597 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2598 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2599 <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2600 
2601 <span class="comment">% Force plot to be formated properly</span>
2602 <span class="comment">% ----------------------------------</span>
2603 <span class="keyword">if</span> guiparams.presentation
2604     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2605 <span class="keyword">else</span>
2606     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2607 <span class="keyword">end</span>
2608 <span class="keyword">switch</span> guiparams.renderer
2609     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2610         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2611     <span class="keyword">case</span> <span class="string">'painters'</span>
2612         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2613     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2614         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2615 <span class="keyword">end</span>
2616 
2617 <span class="comment">% Focus the figure</span>
2618 <span class="comment">% ----------------</span>
2619 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2620 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2621     figure(hff)
2622 <span class="keyword">end</span>
2623 
2624 <span class="comment">% Start the Graphics Control Gui</span>
2625 <span class="comment">% ------------------------------</span>
2626 VMT_GraphicsControl
2627 
2628 <span class="comment">% [EOF] planviewPlotCallback</span>
2629 
2630 
2631 <span class="comment">% --------------------------------------------------------------------</span>
2632 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2633 <span class="comment">% Plot 3</span>
2634 
2635 <span class="comment">% Get the Application data:</span>
2636 <span class="comment">% -------------------------</span>
2637 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2638 z = guiparams.z;
2639 A = guiparams.A;
2640 <span class="comment">% V = guiparams.V;</span>
2641 <span class="comment">% Map = guiparams.Map;</span>
2642 
2643 <span class="comment">% Preprocess the data:</span>
2644 <span class="comment">% --------------------</span>
2645 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2646 
2647 <span class="comment">% Push messages to Log Window:</span>
2648 <span class="comment">% ----------------------------</span>
2649 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2650 statusLogging(handles.LogWindow, log_text)
2651 
2652 <span class="comment">% Process the transects:</span>
2653 <span class="comment">% ----------------------</span>
2654 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2655 A(1).vgns = guiparams.vertical_grid_node_spacing;
2656 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2657 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2658     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
2659 
2660 <span class="comment">% Push messages to Log Window:</span>
2661 <span class="comment">% ----------------------------</span>
2662 statusLogging(handles.LogWindow, processing_log_text)
2663 
2664 <span class="comment">% Plot the cross section:</span>
2665 <span class="comment">% -----------------------</span>
2666 log_text = {<span class="keyword">...</span>
2667     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2668     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2669     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2670     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2671     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2672     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2673     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2674     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2675     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2676     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2677     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2678     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2679     
2680     };
2681 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2682     log_text = vertcat(log_text, {<span class="keyword">...</span>
2683         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2684         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2685         });
2686 <span class="keyword">end</span>
2687 <span class="comment">% Push messages to Log Window:</span>
2688 <span class="comment">% ----------------------------</span>
2689 statusLogging(handles.LogWindow, log_text)
2690 
2691 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2692     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2693 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2694 <span class="comment">%         ...guiparams.contour, ...</span>
2695 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2696 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2697     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2698         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2699         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2700         guiparams.vertical_smoothing_window);
2701     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2702     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2703         guiparams.contour, <span class="keyword">...</span>
2704         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2705         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2706         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2707         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2708         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2709         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2710         guiparams.english_units,<span class="keyword">...</span>
2711         guiparams.allow_vmt_flip_flux); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2712     
2713 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2714     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2715         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2716         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2717         guiparams.vertical_smoothing_window);
2718     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2719     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2720         guiparams.contour, <span class="keyword">...</span>
2721         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2722         guiparams.english_units, <span class="keyword">...</span>
2723         guiparams.allow_vmt_flip_flux);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2724     
2725     guiparams.zmin = zmin;
2726     guiparams.zmax = zmax;
2727     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2728 <span class="keyword">end</span>
2729 
2730 <span class="comment">% Force plot to be formated properly</span>
2731 <span class="comment">% ----------------------------------</span>
2732 <span class="keyword">if</span> guiparams.presentation
2733     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2734 <span class="keyword">else</span>
2735     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2736 <span class="keyword">end</span>
2737 <span class="keyword">switch</span> guiparams.renderer
2738     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2739         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2740     <span class="keyword">case</span> <span class="string">'painters'</span>
2741         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2742     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2743         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2744 <span class="keyword">end</span>
2745 
2746 <span class="comment">% Focus the figure</span>
2747 <span class="comment">% ----------------</span>
2748 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2749 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2750     figure(hff)
2751 <span class="keyword">end</span>
2752 
2753 <span class="comment">% Re-store the Application data:</span>
2754 <span class="comment">% ------------------------------</span>
2755 guiparams.V = V;
2756 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2757 
2758 <span class="comment">% Start the Graphics Control Gui</span>
2759 <span class="comment">% ------------------------------</span>
2760 VMT_GraphicsControl
2761 
2762 <span class="comment">% Push messages to Log Window:</span>
2763 <span class="comment">% ----------------------------</span>
2764 statusLogging(handles.LogWindow, plot_cont_log_text)
2765 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2766 
2767 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2768 
2769 
2770 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2771 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2772 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2773 
2774 <span class="comment">% --------------------------------------------------------------------</span>
2775 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2776 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2777 
2778 <span class="comment">% Get the Application data:</span>
2779 <span class="comment">% -------------------------</span>
2780 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2781 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2782 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2783 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2784 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2785 
2786 [the_file,the_path] = <span class="keyword">...</span>
2787     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2788     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2789     fullfile(guiparams.mat_path,guiparams.savefile));
2790 
2791 <span class="comment">% Save the processed data to a MAT file:</span>
2792 <span class="comment">% --------------------------------------</span>
2793 <span class="keyword">if</span> ischar(the_file)
2794     guiparams.mat_path = the_path;
2795     guiparams.mat_file = the_file;
2796     guiparams.savefile = the_file;
2797     
2798     <span class="comment">% Re-store the Application data:</span>
2799     <span class="comment">% ------------------------------</span>
2800     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2801     
2802     <span class="comment">% Update the preferences:</span>
2803     <span class="comment">% -----------------------</span>
2804     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2805     guiprefs.mat_path = the_path;
2806     guiprefs.mat_file = the_file;
2807     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2808     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2809     
2810     [~,filename,extension] = fileparts(guiparams.savefile);
2811     savefile = [filename extension];
2812     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2813         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2814     disp(<span class="string">'Saving Processed Data File...'</span>)
2815     disp(savefile)
2816     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2817 <span class="keyword">end</span>
2818 
2819 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2820 
2821 
2822 <span class="comment">% --------------------------------------------------------------------</span>
2823 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2824 
2825 <span class="comment">% Get the Application data:</span>
2826 <span class="comment">% -------------------------</span>
2827 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2828 <span class="comment">% z   = guiparams.z;</span>
2829 <span class="comment">% A   = guiparams.A;</span>
2830 V   = guiparams.V;
2831 <span class="comment">% Map = guiparams.Map;</span>
2832 
2833 [the_file,the_path] = <span class="keyword">...</span>
2834     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2835     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2836     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2837 
2838 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2839 <span class="comment">% ------------------------------------------</span>
2840 <span class="keyword">if</span> ischar(the_file)
2841     guiparams.tecplot_path = the_path;
2842     guiparams.tecplot_file = the_file;
2843     
2844     <span class="comment">% Re-store the Application data:</span>
2845     <span class="comment">% ------------------------------</span>
2846     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2847     
2848     <span class="comment">% Update the preferences:</span>
2849     <span class="comment">% -----------------------</span>
2850     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2851     guiprefs.tecplot_path = the_path;
2852     guiprefs.tecplot_file = the_file;
2853     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2854     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2855     
2856     <span class="comment">% Push to log window</span>
2857     <span class="comment">% ------------------</span>
2858     log_text = {<span class="keyword">...</span>
2859         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2860         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2861         the_path;<span class="keyword">...</span>
2862         [<span class="string">'Filename: '</span> the_file]};
2863     statusLogging(handles.LogWindow,log_text)
2864         
2865     <span class="keyword">if</span> isempty(V)
2866         A = guiparams.A;
2867         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2868         A(1).vgns = guiparams.vertical_grid_node_spacing;
2869         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2870         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2871             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2872             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2873             guiparams.bed_elevation);
2874     <span class="keyword">end</span>
2875     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2876     
2877     <span class="comment">% Push to log window</span>
2878     <span class="comment">% ------------------</span>
2879     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2880     statusLogging(handles.LogWindow,log_text)
2881     
2882     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2883     
2884     <span class="comment">% Push to log window</span>
2885     <span class="comment">% ------------------</span>
2886     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2887     statusLogging(handles.LogWindow,log_text)
2888    
2889 <span class="keyword">end</span>
2890 
2891 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2892 
2893 
2894 <span class="comment">% --------------------------------------------------------------------</span>
2895 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2896 
2897 <span class="comment">% Get the Application data:</span>
2898 <span class="comment">% -------------------------</span>
2899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2900 <span class="comment">% z   = guiparams.z;</span>
2901 A   = guiparams.A;
2902 V   = guiparams.V;
2903 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2904 
2905 [the_file,the_path] = <span class="keyword">...</span>
2906     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2907     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2908     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2909 
2910 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2911 <span class="comment">% -----------------------------------------------------</span>
2912 <span class="keyword">if</span> ischar(the_file)
2913     guiparams.kmz_path = the_path;
2914     guiparams.kmz_file = the_file;
2915     
2916     <span class="comment">% Re-store the Application data:</span>
2917     <span class="comment">% ------------------------------</span>
2918     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2919     
2920     <span class="comment">% Update the preferences:</span>
2921     <span class="comment">% -----------------------</span>
2922     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2923     guiprefs.kmz_path = the_path;
2924     guiprefs.kmz_file = the_file;
2925     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2926     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2927     
2928     <span class="comment">%     if guiparams.display_shoreline</span>
2929     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2930     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2931     <span class="comment">%                             guiparams.vertical_offset);</span>
2932     <span class="comment">%     end</span>
2933     <span class="keyword">if</span> isempty(V)
2934         A = guiparams.A;
2935         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2936         A(1).vgns = guiparams.vertical_grid_node_spacing;
2937         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2938         [~,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2939             guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2940             guiparams.unit_discharge_correction,<span class="keyword">...</span>
2941             guiparams.bed_elevation);
2942     <span class="keyword">end</span>
2943     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2944         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2945         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2946         guiparams.KMZ_vertical_offset);
2947 <span class="keyword">end</span>
2948 
2949 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2950 
2951 
2952 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2953 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2954 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2955 
2956 <span class="comment">% --------------------------------------------------------------------</span>
2957 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2958 
2959 <span class="comment">% Get the Application data:</span>
2960 <span class="comment">% -------------------------</span>
2961 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2962 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2963 z = guiparams.z;
2964 A = guiparams.A;
2965 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2966 <span class="comment">% Map = guiparams.Map;</span>
2967 setends = guiparams.set_cross_section_endpoints;
2968 
2969 [the_file,the_path] = <span class="keyword">...</span>
2970     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2971     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2972     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2973     guiprefs.multibeambathymetry_file));
2974 
2975 <span class="keyword">if</span> ischar(the_file)
2976     guiparams.multibeambathymetry_path = the_path;
2977     guiparams.multibeambathymetry_file = the_file;
2978     
2979     <span class="comment">% Re-store the Application data:</span>
2980     <span class="comment">% ------------------------------</span>
2981     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2982     
2983     <span class="comment">% Update the preferences:</span>
2984     <span class="comment">% -----------------------</span>
2985     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2986     guiprefs.multibeambathymetry_path = the_path;
2987     guiprefs.multibeambathymetry_file = the_file;
2988     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2989     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2990     
2991     <span class="keyword">if</span> guiparams.output_auxiliary_data
2992     <span class="keyword">end</span>
2993     
2994     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2995     
2996     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2997         guiparams.multibeambathymetry_file);
2998     
2999     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
3000         [<span class="string">'   '</span> savefile]};
3001     statusLogging(handles.LogWindow,log_text)
3002     
3003     <span class="comment">% Process the transects:</span>
3004     <span class="comment">% ----------------------</span>
3005     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3006     A(1).vgns = guiparams.vertical_grid_node_spacing;
3007     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3008     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3009         guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation);
3010     
3011     <span class="comment">% Compute the smoothed variables</span>
3012     <span class="comment">% ------------------------------</span>
3013     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3014     <span class="comment">% runtime.</span>
3015     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3016         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3017         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3018         guiparams.vertical_smoothing_window);
3019     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3020     <span class="comment">% Push messages to Log Window:</span>
3021     <span class="comment">% ----------------------------</span>
3022     statusLogging(handles.LogWindow, processing_log_text)
3023 
3024     
3025     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wsedata,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3026         guiparams.A, <span class="keyword">...</span>
3027         savefile, <span class="keyword">...</span>
3028         guiparams.beam_angle, <span class="keyword">...</span>
3029         guiparams.magnetic_variation, <span class="keyword">...</span>
3030         guiparams.water_surface_elevation, <span class="keyword">...</span>
3031         guiparams.output_auxiliary_data);
3032     
3033     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3034     
3035 <span class="keyword">end</span>
3036 
3037 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3038 
3039 
3040 <span class="comment">% --------------------------------------------------------------------</span>
3041 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3042 <span class="comment">% Get the beam angle</span>
3043 
3044 <span class="comment">% Get the Application data:</span>
3045 <span class="comment">% -------------------------</span>
3046 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3047 
3048 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3049 <span class="comment">% ----------------------------------------------------------------</span>
3050 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3051 is_a_number = ~isnan(new_beam_angle);
3052 is_positive = new_beam_angle&gt;=0;
3053 
3054 <span class="comment">% Modify the Application data:</span>
3055 <span class="comment">% ----------------------------</span>
3056 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3057     guiparams.beam_angle = new_beam_angle;
3058     
3059     <span class="comment">% Re-store the Application data:</span>
3060     <span class="comment">% ------------------------------</span>
3061     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3062     
3063 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3064     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3065 <span class="keyword">end</span>
3066 
3067 <span class="comment">% [EOF] BeamAngle_Callback</span>
3068 
3069 
3070 <span class="comment">% --------------------------------------------------------------------</span>
3071 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3072 <span class="comment">% Get the Magnetic Variation</span>
3073 
3074 <span class="comment">% Get the Application data:</span>
3075 <span class="comment">% -------------------------</span>
3076 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3077 
3078 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3079 <span class="comment">% ----------------------------------------------------------------</span>
3080 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3081 is_a_number = ~isnan(new_magnetic_variation);
3082 is_positive = new_magnetic_variation&gt;=0;
3083 
3084 <span class="comment">% Modify the Application data:</span>
3085 <span class="comment">% ----------------------------</span>
3086 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3087     guiparams.magnetic_variation = new_magnetic_variation;
3088     
3089     <span class="comment">% Re-store the Application data:</span>
3090     <span class="comment">% ------------------------------</span>
3091     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3092     
3093 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3094     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3095 <span class="keyword">end</span>
3096 
3097 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3098 
3099 
3100 <span class="comment">% % --------------------------------------------------------------------</span>
3101 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3102 <span class="comment">%</span>
3103 <span class="comment">% % Get the Application data:</span>
3104 <span class="comment">% % -------------------------</span>
3105 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3106 <span class="comment">%</span>
3107 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3108 <span class="comment">% % ----------------------------------------------------------------</span>
3109 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3110 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3111 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3112 <span class="comment">%</span>
3113 <span class="comment">% % Modify the Application data:</span>
3114 <span class="comment">% % ----------------------------</span>
3115 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3116 <span class="comment">%     guiparams.wse = new_wse;</span>
3117 <span class="comment">%</span>
3118 <span class="comment">%     % Re-store the Application data:</span>
3119 <span class="comment">%     % ------------------------------</span>
3120 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3121 <span class="comment">%</span>
3122 <span class="comment">% else % Reject the (incorrect) input</span>
3123 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3124 <span class="comment">% end</span>
3125 <span class="comment">%</span>
3126 <span class="comment">% % [EOF] WSE_Callback</span>
3127 
3128 
3129 <span class="comment">% --------------------------------------------------------------------</span>
3130 <a name="_sub68" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3131 <span class="comment">% Bathymetry Auxiliary Data</span>
3132 
3133 <span class="comment">% Get the Application data:</span>
3134 <span class="comment">% -------------------------</span>
3135 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3136 
3137 <span class="comment">% Modify the Application data:</span>
3138 <span class="comment">% ----------------------------</span>
3139 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3140 
3141 <span class="comment">% Re-store the Application data:</span>
3142 <span class="comment">% ------------------------------</span>
3143 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3144 
3145 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3146 
3147 
3148 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3149 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3150 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3151 
3152 <span class="comment">% --------------------------------------------------------------------</span>
3153 <a name="_sub69" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3154 
3155 <span class="comment">% Get the Application data:</span>
3156 <span class="comment">% -------------------------</span>
3157 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3158 
3159 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3160 <span class="comment">% ----------------------------------------------------------------</span>
3161 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3162 is_a_number = ~isnan(new_depth_range_min);
3163 is_positive = new_depth_range_min&gt;=0;
3164 
3165 <span class="comment">% Modify the Application data:</span>
3166 <span class="comment">% ----------------------------</span>
3167 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3168     guiparams.depth_range_min = new_depth_range_min;
3169     
3170     <span class="comment">% Re-store the Application data:</span>
3171     <span class="comment">% ------------------------------</span>
3172     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3173     
3174 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3175     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3176 <span class="keyword">end</span>
3177 
3178 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3179 
3180 
3181 <span class="comment">% --------------------------------------------------------------------</span>
3182 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3183 
3184 <span class="comment">% Get the Application data:</span>
3185 <span class="comment">% -------------------------</span>
3186 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3187 
3188 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3189 <span class="comment">% ----------------------------------------------------------------</span>
3190 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3191 is_a_number = ~isnan(new_depth_range_max);
3192 is_positive = new_depth_range_max&gt;=0;
3193 
3194 <span class="comment">% Modify the Application data:</span>
3195 <span class="comment">% ----------------------------</span>
3196 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3197     guiparams.depth_range_max = new_depth_range_max;
3198     
3199     <span class="comment">% Re-store the Application data:</span>
3200     <span class="comment">% ------------------------------</span>
3201     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3202     
3203 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3204     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3205 <span class="keyword">end</span>
3206 
3207 <span class="comment">% [EOF] DepthMax_Callback</span>
3208 
3209 
3210 <span class="comment">% --------------------------------------------------------------------</span>
3211 <a name="_sub71" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3212 <span class="comment">% Set quiver scale (contour)</span>
3213 
3214 <span class="comment">% Get the Application data:</span>
3215 <span class="comment">% -------------------------</span>
3216 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3217 
3218 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3219 <span class="comment">% ----------------------------------------------------------------</span>
3220 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3221 is_a_number = ~isnan(new_vector_scale_plan_view);
3222 is_positive = new_vector_scale_plan_view&gt;=0;
3223 
3224 <span class="comment">% Modify the Application data:</span>
3225 <span class="comment">% ----------------------------</span>
3226 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3227     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3228     
3229     <span class="comment">% Re-store the Application data:</span>
3230     <span class="comment">% ------------------------------</span>
3231     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3232     
3233 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3234     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3235 <span class="keyword">end</span>
3236 
3237 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3238 
3239 
3240 <span class="comment">% --------------------------------------------------------------------</span>
3241 <a name="_sub72" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3242 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3243 
3244 <span class="comment">% Get the Application data:</span>
3245 <span class="comment">% -------------------------</span>
3246 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3247 
3248 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3249 <span class="comment">% ----------------------------------------------------------------</span>
3250 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3251 is_a_number = ~isnan(new_vector_spacing_plan_view);
3252 is_positive = new_vector_spacing_plan_view&gt;=0;
3253 
3254 <span class="comment">% Modify the Application data:</span>
3255 <span class="comment">% ----------------------------</span>
3256 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3257     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3258     
3259     <span class="comment">% Re-store the Application data:</span>
3260     <span class="comment">% ------------------------------</span>
3261     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3262     
3263 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3264     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3265 <span class="keyword">end</span>
3266 
3267 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3268 
3269 
3270 <span class="comment">% --------------------------------------------------------------------</span>
3271 <a name="_sub73" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3272 <span class="comment">% Plan View smoothing window size</span>
3273 
3274 <span class="comment">% Get the Application data:</span>
3275 <span class="comment">% -------------------------</span>
3276 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3277 
3278 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3279 <span class="comment">% ----------------------------------------------------------------</span>
3280 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3281 is_a_number = ~isnan(new_smoothing_window_size);
3282 is_positive = new_smoothing_window_size&gt;=0;
3283 
3284 <span class="comment">% Modify the Application data:</span>
3285 <span class="comment">% ----------------------------</span>
3286 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3287     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3288     
3289     <span class="comment">% Re-store the Application data:</span>
3290     <span class="comment">% ------------------------------</span>
3291     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3292     
3293 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3294     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3295 <span class="keyword">end</span>
3296 
3297 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3298 
3299 
3300 <span class="comment">% --------------------------------------------------------------------</span>
3301 <a name="_sub74" href="#_subfunctions" class="code">function DisplayShoreline_Callback(hObject, eventdata, handles)</a>
3302 
3303 <span class="comment">% Get the Application data:</span>
3304 <span class="comment">% -------------------------</span>
3305 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3306 
3307 <span class="comment">% Modify the Application data:</span>
3308 <span class="comment">% ----------------------------</span>
3309 guiparams.display_shoreline = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3310 
3311 <span class="comment">% Re-store the Application data:</span>
3312 <span class="comment">% ------------------------------</span>
3313 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3314 
3315 <span class="comment">% [EOF] DisplayShoreline_Callback</span>
3316 
3317 
3318 <span class="comment">% --------------------------------------------------------------------</span>
3319 <a name="_sub75" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3320 
3321 <span class="comment">% Get the Application data:</span>
3322 <span class="comment">% -------------------------</span>
3323 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3324 
3325 <span class="comment">% Modify the Application data:</span>
3326 <span class="comment">% ----------------------------</span>
3327 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3328 
3329 <span class="comment">% Re-store the Application data:</span>
3330 <span class="comment">% ------------------------------</span>
3331 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3332 
3333 <span class="comment">% [EOF] AddBackground_Callback</span>
3334 
3335 
3336 <span class="comment">% --------------------------------------------------------------------</span>
3337 <a name="_sub76" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3338 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3339 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3340 
3341 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3342 <span class="comment">% OFFSETS PANEL CALLBACKS %</span>
3343 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3344 
3345 
3346 <a name="_sub77" href="#_subfunctions" class="code">function WaterSurfaceElevation_Callback(hObject, eventdata, handles)</a>
3347 <span class="comment">% Water Surface Elevation</span>
3348 
3349 <span class="comment">% Get the Application data:</span>
3350 <span class="comment">% -------------------------</span>
3351 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3352 
3353 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3354 <span class="comment">% ----------------------------------------------------------------</span>
3355 string = get(hObject,<span class="string">'String'</span>);
3356 new_water_surface_elevation = str2double(string);
3357 is_a_number = ~isnan(new_water_surface_elevation);
3358 is_positive = new_water_surface_elevation&gt;=0;
3359 is_tide     = strcmpi(<span class="string">'tide'</span>,string);
3360 
3361 <span class="comment">% Modify the Application data:</span>
3362 <span class="comment">% ----------------------------</span>
3363 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3364     guiparams.water_surface_elevation = (new_water_surface_elevation);
3365     guiparams.load_wse_tide_file      = false;
3366     <span class="comment">% Re-store the Application data:</span>
3367     <span class="comment">% ------------------------------</span>
3368     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3369     
3370 <span class="keyword">elseif</span> is_tide
3371     guiparams.water_surface_elevation = <span class="string">'tide'</span>;
3372     guiparams.load_wse_tide_file      = true;
3373     
3374     <span class="comment">% Re-store the Application data:</span>
3375     <span class="comment">% ------------------------------</span>
3376     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3377 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3378     set(hObject,<span class="string">'String'</span>,guiparams.water_surface_elevation)
3379 <span class="keyword">end</span>
3380 
3381 <span class="comment">% [EOF] WaterSurfaceElevation_Callback</span>
3382 
3383 
3384 <a name="_sub78" href="#_subfunctions" class="code">function BedElevation_Callback(hObject, eventdata, handles)</a>
3385 <span class="comment">% Bed Elevation</span>
3386 <span class="comment">% This is a constant that is added to the V.mcsBedElev variable if the</span>
3387 <span class="comment">% 'Height above the bed' [hab] reference is selected. Note, in cases where</span>
3388 <span class="comment">% the bed is flat, this represents the actual bed elevation. Otherwise this</span>
3389 <span class="comment">% is a simple datum shift applied to the bed.</span>
3390 
3391 <span class="comment">% Get the Application data:</span>
3392 <span class="comment">% -------------------------</span>
3393 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3394 
3395 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3396 <span class="comment">% ----------------------------------------------------------------</span>
3397 string = get(hObject,<span class="string">'String'</span>);
3398 new_bed_elevation = str2double(string);
3399 is_a_number = ~isnan(new_bed_elevation);
3400 
3401 <span class="comment">% Modify the Application data:</span>
3402 <span class="comment">% ----------------------------</span>
3403 <span class="keyword">if</span> is_a_number
3404     guiparams.bed_elevation = (new_bed_elevation);
3405     
3406     <span class="comment">% Re-store the Application data:</span>
3407     <span class="comment">% ------------------------------</span>
3408     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3409     
3410 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3411     set(hObject,<span class="string">'String'</span>,guiparams.bed_elevation)
3412 <span class="keyword">end</span>
3413 
3414 <span class="comment">% [EOF] BedElevation_Callback</span>
3415 
3416 <a name="_sub79" href="#_subfunctions" class="code">function KMZVerticalOffset_Callback(hObject, eventdata, handles)</a>
3417 <span class="comment">% KMZ Vertical Offset</span>
3418 <span class="comment">% This is the elevation (in meters) that the cross section should be offset</span>
3419 <span class="comment">% to in Google Earth to ensure it plots above the land surface for</span>
3420 <span class="comment">% visualization.</span>
3421 
3422 <span class="comment">% Get the Application data:</span>
3423 <span class="comment">% -------------------------</span>
3424 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3425 
3426 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3427 <span class="comment">% ----------------------------------------------------------------</span>
3428 string = get(hObject,<span class="string">'String'</span>);
3429 new_KMZ_vertical_offset = str2double(string);
3430 is_a_number = ~isnan(new_KMZ_vertical_offset);
3431 is_positive = new_KMZ_vertical_offset&gt;=0;
3432 
3433 <span class="comment">% Modify the Application data:</span>
3434 <span class="comment">% ----------------------------</span>
3435 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3436     guiparams.KMZ_vertical_offset = (new_KMZ_vertical_offset);
3437     
3438     <span class="comment">% Re-store the Application data:</span>
3439     <span class="comment">% ------------------------------</span>
3440     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3441     
3442 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3443     set(hObject,<span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
3444 <span class="keyword">end</span>
3445 
3446 <span class="comment">% [EOF] KMZVerticalOffset_Callback</span>
3447 
3448 
3449 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3450 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3451 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3452 
3453 <span class="comment">% --------------------------------------------------------------------</span>
3454 <a name="_sub80" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3455 <span class="comment">% Set the horizontal grid node spacing</span>
3456 
3457 <span class="comment">% Get the Application data:</span>
3458 <span class="comment">% -------------------------</span>
3459 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3460 
3461 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3462 <span class="comment">% ----------------------------------------------------------------</span>
3463 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3464 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3465 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3466 
3467 <span class="comment">% Modify the Application data:</span>
3468 <span class="comment">% ----------------------------</span>
3469 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3470     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3471     
3472     <span class="comment">% Re-store the Application data:</span>
3473     <span class="comment">% ------------------------------</span>
3474     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3475     
3476 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3477     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3478 <span class="keyword">end</span>
3479 
3480 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3481 
3482 <span class="comment">% --------------------------------------------------------------------</span>
3483 <a name="_sub81" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3484 <span class="comment">% Set the horizontal grid node spacing</span>
3485 
3486 <span class="comment">% Get the Application data:</span>
3487 <span class="comment">% -------------------------</span>
3488 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3489 
3490 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3491 <span class="comment">% ----------------------------------------------------------------</span>
3492 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3493 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3494 is_positive = new_vertical_grid_node_spacing&gt;=0;
3495 
3496 <span class="comment">% Modify the Application data:</span>
3497 <span class="comment">% ----------------------------</span>
3498 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3499     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3500     
3501     <span class="comment">% Re-store the Application data:</span>
3502     <span class="comment">% ------------------------------</span>
3503     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3504     
3505 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3506     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3507 <span class="keyword">end</span>
3508 
3509 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3510 
3511 <span class="comment">% --------------------------------------------------------------------</span>
3512 <a name="_sub82" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3513 <span class="comment">% Set the cross section endpoints manually</span>
3514 
3515 <span class="comment">% Get the Application data:</span>
3516 <span class="comment">% -------------------------</span>
3517 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3518 
3519 <span class="comment">% Modify the Application data:</span>
3520 <span class="comment">% ----------------------------</span>
3521 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3522 
3523 <span class="comment">% Re-store the Application data:</span>
3524 <span class="comment">% ------------------------------</span>
3525 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3526 
3527 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3528 
3529 
3530 <span class="comment">% --------------------------------------------------------------------</span>
3531 <a name="_sub83" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3532 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3533 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3534 
3535 
3536 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3537 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3538 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3539 
3540 <span class="comment">% --------------------------------------------------------------------</span>
3541 <a name="_sub84" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3542 
3543 <span class="comment">% Get the Application data:</span>
3544 <span class="comment">% -------------------------</span>
3545 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3546 
3547 <span class="comment">% Modify the Application data:</span>
3548 <span class="comment">% ----------------------------</span>
3549 idx_variable = get(hObject,<span class="string">'Value'</span>);
3550 guiparams.idx_contour = idx_variable;
3551 guiparams.contour = guiparams.contours(idx_variable).variable;
3552 
3553 <span class="comment">% Re-store the Application data:</span>
3554 <span class="comment">% ------------------------------</span>
3555 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3556 
3557 <span class="comment">% [EOF] Contour_Callback</span>
3558 
3559 
3560 <span class="comment">% --------------------------------------------------------------------</span>
3561 <a name="_sub85" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3562 <span class="comment">% Set vertical exaggeration</span>
3563 
3564 <span class="comment">% Get the Application data:</span>
3565 <span class="comment">% -------------------------</span>
3566 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3567 
3568 <span class="comment">% Modify the Application data:</span>
3569 <span class="comment">% ----------------------------</span>
3570 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3571 
3572 <span class="comment">% Re-store the Application data:</span>
3573 <span class="comment">% ------------------------------</span>
3574 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3575 
3576 <span class="comment">% Update the GUI:</span>
3577 <span class="comment">% ---------------</span>
3578 <span class="comment">% updateGUI(handles,guiparams)</span>
3579 
3580 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3581 
3582 
3583 <span class="comment">% --------------------------------------------------------------------</span>
3584 <a name="_sub86" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3585 
3586 <span class="comment">% Get the Application data:</span>
3587 <span class="comment">% -------------------------</span>
3588 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3589 
3590 <span class="comment">% Modify the Application data:</span>
3591 <span class="comment">% ----------------------------</span>
3592 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3593 
3594 <span class="comment">% Re-store the Application data:</span>
3595 <span class="comment">% ------------------------------</span>
3596 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3597 
3598 <span class="comment">% Update the GUI:</span>
3599 <span class="comment">% ---------------</span>
3600 <span class="comment">% updateGUI(handles,guiparams)</span>
3601 
3602 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3603 
3604 
3605 <span class="comment">% --------------------------------------------------------------------</span>
3606 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3607 
3608 <span class="comment">% Get the Application data:</span>
3609 <span class="comment">% -------------------------</span>
3610 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3611 
3612 <span class="comment">% Modify the Application data:</span>
3613 <span class="comment">% ----------------------------</span>
3614 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3615 
3616 <span class="comment">% Re-store the Application data:</span>
3617 <span class="comment">% ------------------------------</span>
3618 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3619 
3620 <span class="comment">% Update the GUI:</span>
3621 <span class="comment">% ---------------</span>
3622 <span class="comment">% updateGUI(handles,guiparams)</span>
3623 
3624 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3625 
3626 
3627 <span class="comment">% --------------------------------------------------------------------</span>
3628 <a name="_sub88" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3629 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3630 
3631 <span class="comment">% Get the Application data:</span>
3632 <span class="comment">% -------------------------</span>
3633 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3634 
3635 <span class="comment">% Modify the Application data:</span>
3636 <span class="comment">% ----------------------------</span>
3637 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3638 
3639 <span class="comment">% Re-store the Application data:</span>
3640 <span class="comment">% ------------------------------</span>
3641 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3642 
3643 <span class="comment">% Update the GUI:</span>
3644 <span class="comment">% ---------------</span>
3645 <span class="comment">% updateGUI(handles,guiparams)</span>
3646 
3647 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3648 
3649 
3650 <span class="comment">% --------------------------------------------------------------------</span>
3651 <a name="_sub89" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3652 <span class="comment">% Horizontal Smoothing</span>
3653 
3654 <span class="comment">% Get the Application data:</span>
3655 <span class="comment">% -------------------------</span>
3656 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3657 
3658 <span class="comment">% Modify the Application data:</span>
3659 <span class="comment">% ----------------------------</span>
3660 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3661 
3662 <span class="comment">% Re-store the Application data:</span>
3663 <span class="comment">% ------------------------------</span>
3664 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3665 
3666 <span class="comment">% Update the GUI:</span>
3667 <span class="comment">% ---------------</span>
3668 <span class="comment">% updateGUI(handles,guiparams)</span>
3669 
3670 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3671 
3672 
3673 <span class="comment">% --------------------------------------------------------------------</span>
3674 <a name="_sub90" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3675 <span class="comment">% Vertical Smoothing</span>
3676 
3677 <span class="comment">% Get the Application data:</span>
3678 <span class="comment">% -------------------------</span>
3679 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3680 
3681 <span class="comment">% Modify the Application data:</span>
3682 <span class="comment">% ----------------------------</span>
3683 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3684 
3685 <span class="comment">% Re-store the Application data:</span>
3686 <span class="comment">% ------------------------------</span>
3687 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3688 
3689 <span class="comment">% Update the GUI:</span>
3690 <span class="comment">% ---------------</span>
3691 <span class="comment">% updateGUI(handles,guiparams)</span>
3692 
3693 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3694 
3695 
3696 <span class="comment">% --------------------------------------------------------------------</span>
3697 <a name="_sub91" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3698 
3699 <span class="comment">% Get the Application data:</span>
3700 <span class="comment">% -------------------------</span>
3701 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3702 
3703 <span class="comment">% Modify the Application data:</span>
3704 <span class="comment">% ----------------------------</span>
3705 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3706 
3707 <span class="comment">% Re-store the Application data:</span>
3708 <span class="comment">% ------------------------------</span>
3709 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3710 
3711 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3712 
3713 <span class="comment">% --- Executes on button press in AllowVMTFlipFlux.</span>
3714 <a name="_sub92" href="#_subfunctions" class="code">function AllowVMTFlipFlux_Callback(hObject, eventdata, handles)</a>
3715 
3716 <span class="comment">% Get the Application data:</span>
3717 <span class="comment">% -------------------------</span>
3718 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3719 
3720 <span class="comment">% Modify the Application data:</span>
3721 <span class="comment">% ----------------------------</span>
3722 guiparams.allow_vmt_flip_flux = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3723 
3724 <span class="comment">% Re-store the Application data:</span>
3725 <span class="comment">% ------------------------------</span>
3726 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3727 
3728 <span class="comment">% [EOF] AllowVMTFlipFlux_Callback</span>
3729 
3730 
3731 <span class="comment">% --------------------------------------------------------------------</span>
3732 <a name="_sub93" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3733 
3734 <span class="comment">% Get the Application data:</span>
3735 <span class="comment">% -------------------------</span>
3736 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3737 
3738 <span class="comment">% Modify the Application data:</span>
3739 <span class="comment">% ----------------------------</span>
3740 idx_variable = get(hObject,<span class="string">'Value'</span>);
3741 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3742 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3743 
3744 <span class="comment">% Re-store the Application data:</span>
3745 <span class="comment">% ------------------------------</span>
3746 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3747 
3748 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3749 
3750 
3751 <span class="comment">% --------------------------------------------------------------------</span>
3752 <a name="_sub94" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3753 
3754 <span class="comment">% Get the Application data:</span>
3755 <span class="comment">% -------------------------</span>
3756 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3757 
3758 <span class="comment">% Modify the Application data:</span>
3759 <span class="comment">% ----------------------------</span>
3760 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3761 
3762 <span class="comment">% Re-store the Application data:</span>
3763 <span class="comment">% ------------------------------</span>
3764 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3765 
3766 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3767 
3768 
3769 <span class="comment">% --------------------------------------------------------------------</span>
3770 <a name="_sub95" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3771 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3772 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3773 
3774 
3775 <span class="comment">% --------------------------------------------------------------------</span>
3776 <a name="_sub96" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3777 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3778 <span class="comment">% [EOF] ClearLog_Callback</span>
3779 
3780 <span class="comment">% --------------------------------------------------------------------</span>
3781 <a name="_sub97" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3782 
3783 <span class="comment">% Get the Application data:</span>
3784 <span class="comment">% -------------------------</span>
3785 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3786 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3787 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3788 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3789 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3790 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3791 
3792 [the_file,the_path] = <span class="keyword">...</span>
3793     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3794     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3795     fullfile(guiprefs.log_path,guiprefs.log_file));
3796 
3797 <span class="comment">% Save the log to a TXT file:</span>
3798 <span class="comment">% ---------------------------</span>
3799 <span class="keyword">if</span> ischar(the_file)
3800     guiparams.log_path = the_path;
3801     guiparams.log_file = the_file;
3802     <span class="comment">%guiparams.savefile = the_file;</span>
3803     
3804     <span class="comment">% Re-store the Application data:</span>
3805     <span class="comment">% ------------------------------</span>
3806     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3807     
3808     <span class="comment">% Update the preferences:</span>
3809     <span class="comment">% -----------------------</span>
3810     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3811     guiprefs.log_path = the_path;
3812     guiprefs.log_file = the_file;
3813     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3814     <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3815     
3816     [~,filename,extension] = fileparts(the_file);
3817     savefile = [the_path filename extension];
3818     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3819         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3820     
3821     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3822     [nrows,~]= size(logfile);
3823     fid = fopen(savefile, <span class="string">'w'</span>);
3824     <span class="keyword">for</span> row=1:nrows
3825         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3826     <span class="keyword">end</span>
3827     fclose(fid);
3828 <span class="keyword">end</span>
3829 <span class="comment">% [EOF] SaveLog_Callback</span>
3830 
3831 <span class="comment">%%%%%%%%%%%%%%%%</span>
3832 <span class="comment">% SUBFUNCTIONS %</span>
3833 <span class="comment">%%%%%%%%%%%%%%%%</span>
3834 
3835 <span class="comment">% --------------------------------------------------------------------</span>
3836 <a name="_sub98" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3837 
3838 icons = <a href="#_sub114" class="code" title="subfunction icons = getIcons">getIcons</a>;
3839 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3840 
3841 <span class="comment">% Load data</span>
3842 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3843 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3844 <span class="comment">% icon(icon==0) = NaN;</span>
3845 handles.toolbarLoadData = <span class="keyword">...</span>
3846     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3847     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3848     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3849 
3850 <span class="comment">% Save data</span>
3851 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3852 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3853 <span class="comment">% icon(icon==0) = NaN;</span>
3854 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3855     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3856     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3857     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3858     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3859 
3860 
3861 <span class="comment">% Save bathymetry</span>
3862 <span class="comment">%icon = ones(16,16,3);</span>
3863 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3864     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3865     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3866     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3867 
3868 <span class="comment">% Save figures</span>
3869 <span class="comment">% icon = ones(16,16,3);</span>
3870 handles.toolbarSaveFigures = <span class="keyword">...</span>
3871     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3872     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3873     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3874 
3875 <span class="comment">% Save Excel File</span>
3876 <span class="comment">% icon = ones(16,16,3);</span>
3877 handles.toolbarSaveExcel = <span class="keyword">...</span>
3878     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3879     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3880     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3881 
3882 
3883 <span class="comment">% Plotting parameters</span>
3884 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3885 <span class="comment">% icon = ind2rgb(icon,map);</span>
3886 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3887     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3888     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3889     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3890     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3891 
3892 <span class="comment">% Processing parameters</span>
3893 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3894 <span class="comment">% icon = ind2rgb(icon,map);</span>
3895 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3896     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3897     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3898     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3899 
3900 <span class="comment">% Zoom In</span>
3901 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3902 <span class="comment">% icon = ind2rgb(icon,map);</span>
3903 <span class="comment">% handles.toolbarZoomIn = ...</span>
3904 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3905 <span class="comment">%     'CData',        icons(8).data, ...</span>
3906 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3907 <span class="comment">%     'Separator',     'on');</span>
3908 
3909 <span class="comment">% Zoom Out</span>
3910 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3911 <span class="comment">% icon = ind2rgb(icon,map);</span>
3912 <span class="comment">% handles.toolbarZoomOut = ...</span>
3913 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3914 <span class="comment">%     'CData',        icons(9).data, ...</span>
3915 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3916 
3917 <span class="comment">% Pan</span>
3918 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3919 <span class="comment">% icon = ind2rgb(icon,map);</span>
3920 <span class="comment">% handles.toolbarPan = ...</span>
3921 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3922 <span class="comment">%     'CData',        icons(10).data, ...</span>
3923 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3924 
3925 
3926 
3927 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3928 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3929 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3930 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3931 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3932 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3933 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3934 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3935 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3936 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3937 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3938 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3939 
3940 <span class="comment">% [EOF] buildtoolbar</span>
3941 
3942 
3943 <span class="comment">% --------------------------------------------------------------------</span>
3944 <a name="_sub99" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3945 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3946 <span class="comment">% already exist.</span>
3947 
3948 <span class="comment">% Preferences:</span>
3949 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3950 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3951 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3952 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3953 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3954 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3955 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3956 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3957 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3958 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3959 <span class="comment">% 'renderer'             Default graphics renderer</span>
3960 <span class="comment">% 'units'                Default plotting units</span>
3961 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3962 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3963 <span class="comment">%                        started</span>
3964 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3965 
3966 <span class="comment">% Originals</span>
3967 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3968 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3969 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3970 
3971 <span class="comment">% ASCII</span>
3972 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3973     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3974     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3975         guiprefs.ascii_path = ascii.path;
3976     <span class="keyword">else</span>
3977         guiprefs.ascii_path = pwd;
3978     <span class="keyword">end</span>
3979     does_exist = false(1,length(ascii.file));
3980     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3981         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3982     <span class="keyword">end</span>
3983     <span class="keyword">if</span> any(does_exist)
3984         guiprefs.ascii_file = ascii.file(does_exist);
3985     <span class="keyword">else</span>
3986         guiprefs.ascii_file = {<span class="string">''</span>};
3987     <span class="keyword">end</span>
3988 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3989     guiprefs.ascii_path = pwd;
3990     guiprefs.ascii_file = {<span class="string">''</span>};
3991     
3992     ascii.path = pwd;
3993     ascii.file = {<span class="string">''</span>};
3994     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3995 <span class="keyword">end</span>
3996 
3997 <span class="comment">% MAT</span>
3998 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3999     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
4000     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
4001         guiprefs.mat_path = mat.path;
4002     <span class="keyword">else</span>
4003         guiprefs.mat_path = pwd;
4004     <span class="keyword">end</span>
4005     
4006     <span class="keyword">if</span> iscell(mat.file)
4007         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
4008             guiprefs.mat_file = mat.file;
4009         <span class="keyword">else</span>
4010             guiprefs.mat_file = <span class="string">''</span>;
4011         <span class="keyword">end</span>
4012     <span class="keyword">else</span>
4013         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
4014             guiprefs.mat_file = mat.file;
4015         <span class="keyword">else</span>
4016             guiprefs.mat_file = <span class="string">''</span>;
4017         <span class="keyword">end</span>
4018     <span class="keyword">end</span>
4019 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
4020     guiprefs.mat_path = pwd;
4021     guiprefs.mat_file = <span class="string">''</span>;
4022     
4023     mat.path = pwd;
4024     mat.file = <span class="string">''</span>;
4025     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4026 <span class="keyword">end</span>
4027 
4028 <span class="comment">% TECPLOT</span>
4029 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
4030     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
4031     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
4032         guiprefs.tecplot_path = tecplot.path;
4033     <span class="keyword">else</span>
4034         guiprefs.tecplot_path = pwd;
4035     <span class="keyword">end</span>
4036     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
4037         guiprefs.tecplot_file = tecplot.file;
4038     <span class="keyword">else</span>
4039         guiprefs.tecplot_file = <span class="string">''</span>;
4040     <span class="keyword">end</span>
4041 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4042     guiprefs.tecplot_path = pwd;
4043     guiprefs.tecplot_file = <span class="string">''</span>;
4044     
4045     tecplot.path = pwd;
4046     tecplot.file = <span class="string">''</span>;
4047     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4048 <span class="keyword">end</span>
4049 
4050 <span class="comment">% KMZ</span>
4051 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
4052     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
4053     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
4054         guiprefs.kmz_path = kmz.path;
4055     <span class="keyword">else</span>
4056         guiprefs.kmz_path = pwd;
4057     <span class="keyword">end</span>
4058     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
4059         guiprefs.kmz_file = kmz.file;
4060     <span class="keyword">else</span>
4061         guiprefs.kmz_file = <span class="string">''</span>;
4062     <span class="keyword">end</span>
4063 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
4064     guiprefs.kmz_path = pwd;
4065     guiprefs.kmz_file = <span class="string">''</span>;
4066     
4067     kmz.path = pwd;
4068     kmz.file = <span class="string">''</span>;
4069     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4070 <span class="keyword">end</span>
4071 
4072 <span class="comment">% MULTIBEAM BATHYMETRY</span>
4073 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
4074     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
4075     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
4076         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
4077     <span class="keyword">else</span>
4078         guiprefs.multibeambathymetry_path = pwd;
4079     <span class="keyword">end</span>
4080     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
4081         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
4082     <span class="keyword">else</span>
4083         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4084     <span class="keyword">end</span>
4085 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
4086     guiprefs.multibeambathymetry_path = pwd;
4087     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4088     
4089     multibeambathymetry.path = pwd;
4090     multibeambathymetry.file = <span class="string">''</span>;
4091     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4092 <span class="keyword">end</span>
4093 
4094 <span class="comment">% Log</span>
4095 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
4096     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
4097     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
4098         guiprefs.log_path = log.path;
4099     <span class="keyword">else</span>
4100         guiprefs.log_path = pwd;
4101     <span class="keyword">end</span>
4102     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
4103         guiprefs.log_file = log.file;
4104     <span class="keyword">else</span>
4105         guiprefs.log_file = <span class="string">''</span>;
4106     <span class="keyword">end</span>
4107 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4108     guiprefs.log_path = pwd;
4109     guiprefs.log_file = <span class="string">''</span>;
4110     
4111     log.path = pwd;
4112     log.file = <span class="string">''</span>;
4113     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4114 <span class="keyword">end</span>
4115 
4116 <span class="comment">% iRic</span>
4117 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
4118     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
4119     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
4120         guiprefs.iric_path = iric.path;
4121     <span class="keyword">else</span>
4122         guiprefs.iric_path = pwd;
4123     <span class="keyword">end</span>
4124     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
4125         guiprefs.iric_file = iric.file;
4126     <span class="keyword">else</span>
4127         guiprefs.iric_file = <span class="string">''</span>;
4128     <span class="keyword">end</span>
4129 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4130     guiprefs.iric_path = pwd;
4131     guiprefs.iric_file = <span class="string">''</span>;
4132     
4133     iric.path = pwd;
4134     iric.file = <span class="string">''</span>;
4135     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4136 <span class="keyword">end</span>
4137 
4138 <span class="comment">% excel</span>
4139 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
4140     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
4141     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
4142         guiprefs.excel_path = excel.path;
4143     <span class="keyword">else</span>
4144         guiprefs.excel_path = pwd;
4145     <span class="keyword">end</span>
4146     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4147         guiprefs.excel_file = excel.file;
4148     <span class="keyword">else</span>
4149         guiprefs.excel_file = <span class="string">''</span>;
4150     <span class="keyword">end</span>
4151 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4152     guiprefs.excel_path = pwd;
4153     guiprefs.excel_file = <span class="string">''</span>;
4154     
4155     excel.path = pwd;
4156     excel.file = <span class="string">''</span>;
4157     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4158 <span class="keyword">end</span>
4159 
4160 <span class="comment">% aerial</span>
4161 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4162     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4163     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4164         guiprefs.aerial_path = aerial.path;
4165     <span class="keyword">else</span>
4166         guiprefs.aerial_path = pwd;
4167     <span class="keyword">end</span>
4168     does_exist = false(1,length(aerial.file));
4169     <span class="keyword">if</span> iscell(aerial.file)
4170     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4171         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4172     <span class="keyword">end</span>
4173     <span class="keyword">else</span>
4174         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4175     <span class="keyword">end</span>
4176     <span class="keyword">if</span> any(does_exist)
4177         guiprefs.aerial_file = aerial.file;
4178     <span class="keyword">else</span>
4179         guiprefs.aerial_file = {<span class="string">''</span>};
4180     <span class="keyword">end</span>
4181 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4182     guiprefs.aerial_path = pwd;
4183     guiprefs.aerial_file = {<span class="string">''</span>};
4184     
4185     aerial.path = pwd;
4186     aerial.file = {<span class="string">''</span>};
4187     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4188 <span class="keyword">end</span>
4189 
4190 <span class="comment">% shoreline</span>
4191 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4192     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4193     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4194         guiprefs.shoreline_path = shoreline.path;
4195     <span class="keyword">else</span>
4196         guiprefs.shoreline_path = pwd;
4197     <span class="keyword">end</span>
4198     
4199     <span class="keyword">if</span> iscell(shoreline.file)
4200         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4201             guiprefs.shoreline_file = shoreline.file;
4202         <span class="keyword">else</span>
4203             guiprefs.shoreline_file = <span class="string">''</span>;
4204         <span class="keyword">end</span>
4205     <span class="keyword">else</span>
4206         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4207             guiprefs.shoreline_file = shoreline.file;
4208         <span class="keyword">else</span>
4209             guiprefs.shoreline_file = <span class="string">''</span>;
4210         <span class="keyword">end</span>
4211     <span class="keyword">end</span>
4212 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4213     guiprefs.shoreline_path = pwd;
4214     guiprefs.shoreline_file = <span class="string">''</span>;
4215     
4216     shoreline.path = pwd;
4217     shoreline.file = <span class="string">''</span>;
4218     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4219 <span class="keyword">end</span>
4220 <span class="comment">% guiprefs.presentation = true;</span>
4221 <span class="comment">% guiprefs.print        = false;</span>
4222 
4223 <span class="comment">% for k = 1:length(prefs)</span>
4224 <span class="comment">%     newpref = '';</span>
4225 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4226 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4227 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4228 <span class="comment">%             newpref = stored_newpref;</span>
4229 <span class="comment">%         else</span>
4230 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4231 <span class="comment">%         end</span>
4232 <span class="comment">%     end</span>
4233 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4234 <span class="comment">% end</span>
4235 
4236 <span class="comment">% RENDERER</span>
4237 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4238     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4239     guiprefs.renderer = renderer;
4240 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4241     renderer           = <span class="string">'OpenGL'</span>;
4242     guiprefs.renderer  = renderer;
4243     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4244 <span class="keyword">end</span>
4245 
4246 <span class="comment">% UNITS</span>
4247 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4248     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4249     guiprefs.units = units;
4250 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4251     units           = <span class="string">'metric'</span>;
4252     guiprefs.units  = units;
4253     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4254 <span class="keyword">end</span>
4255 
4256 <span class="comment">% PLOTREF</span>
4257 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4258     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4259     guiprefs.plotref = plotref;
4260 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4261     plotref           = <span class="string">'dfs'</span>;
4262     guiprefs.plotref  = plotref;
4263     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4264 <span class="keyword">end</span>
4265 
4266 <span class="comment">% RUNCOUNTER</span>
4267 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4268     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4269     guiprefs.runcounter = runcounter;
4270 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4271     runcounter           = 1;
4272     guiprefs.runcounter  = runcounter;
4273     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4274 <span class="keyword">end</span>
4275 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4276 
4277 <span class="comment">% SETENDPOINTS</span>
4278 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4279     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4280     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4281         guiprefs.setendpoints_path = setendpoints.path;
4282     <span class="keyword">else</span>
4283         guiprefs.setendpoints_path = pwd;
4284     <span class="keyword">end</span>
4285     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4286         guiprefs.setendpoints_file = setendpoints.file;
4287     <span class="keyword">else</span>
4288         guiprefs.setendpoints_file = <span class="string">''</span>;
4289     <span class="keyword">end</span>
4290 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4291     guiprefs.setendpoints_path = pwd;
4292     guiprefs.setendpoints_file = <span class="string">''</span>;
4293     
4294     setendpoints.path = pwd;
4295     setendpoints.file = <span class="string">''</span>;
4296     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4297 <span class="keyword">end</span>
4298 
4299 <span class="comment">% [EOF] load_prefs</span>
4300 
4301 
4302 <span class="comment">% --------------------------------------------------------------------</span>
4303 <a name="_sub100" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4304 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4305 <span class="comment">% preferences data.</span>
4306 
4307 <span class="comment">% Preferences:</span>
4308 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4309 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4310 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4311 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4312 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4313 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4314 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4315 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4316 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4317 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4318 <span class="comment">% 'renderer'             Default graphics renderer</span>
4319 <span class="comment">% 'units'                Default plotting units</span>
4320 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4321 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4322 <span class="comment">%                        started</span>
4323 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4324 
4325 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4326 
4327 <span class="keyword">switch</span> pref
4328     <span class="keyword">case</span> <span class="string">'ascii'</span>
4329         ascii.path = guiprefs.ascii_path;
4330         ascii.file = guiprefs.ascii_file;
4331         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4332     <span class="keyword">case</span> <span class="string">'mat'</span>
4333         mat.path = guiprefs.mat_path;
4334         mat.file = guiprefs.mat_file;
4335         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4336     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4337         tecplot.path = guiprefs.tecplot_path;
4338         tecplot.file = guiprefs.tecplot_file;
4339         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4340     <span class="keyword">case</span> <span class="string">'kmz'</span>
4341         kmz.path = guiprefs.kmz_path;
4342         kmz.file = guiprefs.kmz_file;
4343         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4344     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4345         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4346         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4347         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4348     <span class="keyword">case</span> <span class="string">'log'</span>
4349         log.path = guiprefs.log_path;
4350         log.file = guiprefs.log_file;
4351         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4352     <span class="keyword">case</span> <span class="string">'iric'</span>
4353         iric.path = guiprefs.iric_path;
4354         iric.file = guiprefs.iric_file;
4355         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4356     <span class="keyword">case</span> <span class="string">'excel'</span>
4357         excel.path = guiprefs.excel_path;
4358         excel.file = guiprefs.excel_file;
4359         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4360     <span class="keyword">case</span> <span class="string">'aerial'</span>
4361         aerial.path = guiprefs.aerial_path;
4362         aerial.file = guiprefs.aerial_file;
4363         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4364     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4365         shoreline.path = guiprefs.shoreline_path;
4366         shoreline.file = guiprefs.shoreline_file;
4367         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4368     <span class="keyword">case</span> <span class="string">'renderer'</span>
4369         renderer = guiprefs.renderer;
4370         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4371     <span class="keyword">case</span> <span class="string">'units'</span>
4372         units = guiprefs.units;
4373         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4374     <span class="keyword">case</span> <span class="string">'plotref'</span>
4375         plotref = guiprefs.plotref;
4376         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4377     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4378         runcounter = guiprefs.runcounter;
4379         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4380     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4381         setendpoints.path = guiprefs.setendpoints_path;
4382         setendpoints.file = guiprefs.setendpoints_file;
4383         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4384     <span class="keyword">otherwise</span>
4385 <span class="keyword">end</span>
4386 
4387 <span class="comment">% if ismember(pref,prefs)</span>
4388 <span class="comment">%     setpref('VMT',pref,value)</span>
4389 <span class="comment">%</span>
4390 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4391 <span class="comment">%     guiprefs.(pref) = value;</span>
4392 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4393 <span class="comment">% end</span>
4394 
4395 <span class="comment">% [EOF] store_prefs</span>
4396 
4397 
4398 <span class="comment">% --------------------------------------------------------------------</span>
4399 <a name="_sub101" href="#_subfunctions" class="code">function initGUI(handles)</a>
4400 <span class="comment">% Initialize the UI controls in the GUI.</span>
4401 
4402 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4403 
4404 <span class="comment">% Set the name and version</span>
4405 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4406     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4407 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4408 
4409 <span class="comment">% Set the PLOT 1 axis labels</span>
4410 axes(handles.Plot1Shiptracks);
4411 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4412 xlabel(<span class="string">'UTM Easting (m)'</span>)
4413 ylabel(<span class="string">'UTM Northing (m)'</span>)
4414 box on
4415 grid on
4416 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4417 
4418 <span class="comment">%%%%%%%%%%%%</span>
4419 <span class="comment">% MENU BAR %</span>
4420 <span class="comment">%%%%%%%%%%%%</span>
4421 <span class="keyword">if</span> guiparams.english_units
4422     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4423     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4424 <span class="keyword">else</span>
4425     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4426     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4427 <span class="keyword">end</span>
4428 
4429 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4430     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4431     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4432 <span class="keyword">else</span>
4433     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4434     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4435 <span class="keyword">end</span>
4436 
4437 
4438 <span class="keyword">if</span> guiparams.print
4439     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4440     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4441     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4442     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4443 <span class="keyword">elseif</span> guiparams.presentation
4444     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4445     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4446     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4447     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4448 <span class="keyword">else</span>
4449 <span class="keyword">end</span>
4450 
4451 <span class="keyword">switch</span> guiparams.renderer
4452     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4453         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4454         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4455         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4456     <span class="keyword">case</span> <span class="string">'painters'</span>
4457         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4458         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4459         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4460     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4461         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4462         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4463         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4464 <span class="keyword">end</span>
4465 
4466 
4467 <span class="comment">%%%%%%%%%%%%%%%</span>
4468 <span class="comment">% DATA EXPORT %</span>
4469 <span class="comment">%%%%%%%%%%%%%%%</span>
4470 <span class="comment">% BathymetryPanel</span>
4471 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4472 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4473 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4474 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4475 
4476 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4477 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4478 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4479 <span class="comment">% PlanViewPanel</span>
4480 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4481 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4482 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4483 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4484 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4485 set(handles.DisplayShoreline,           <span class="string">'Value'</span>, guiparams.display_shoreline)
4486 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4487 
4488 <span class="comment">%%%%%%%%%%%</span>
4489 <span class="comment">% OFFSETS %</span>
4490 <span class="comment">%%%%%%%%%%%</span>
4491 <span class="comment">% OffsetsPanel</span>
4492 set(handles.WaterSurfaceElevation,       <span class="string">'String'</span>,guiparams.water_surface_elevation)
4493 set(handles.BedElevation,                <span class="string">'String'</span>,guiparams.bed_elevation)
4494 set(handles.KMZVerticalOffset,           <span class="string">'String'</span>,guiparams.KMZ_vertical_offset)
4495 
4496 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4497 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4498 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4499 <span class="comment">% ShiptracksPanel</span>
4500 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4501 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4502 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4503 
4504 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4505 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4506 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4507 <span class="comment">% CrossSectionsPanel</span>
4508 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4509     <span class="string">'Value'</span>, guiparams.idx_contour)
4510 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4511 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4512 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4513 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4514 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4515 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4516 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4517 set(handles.AllowVMTFlipFlux,           <span class="string">'Value'</span>, guiparams.allow_vmt_flip_flux)
4518 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4519     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4520 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4521 
4522 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4523 
4524 <span class="comment">% [EOF] initGUI</span>
4525 
4526 
4527 <span class="comment">% --------------------------------------------------------------------</span>
4528 <a name="_sub102" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4529 
4530 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4531 
4532 <span class="keyword">switch</span> enable_state
4533     <span class="keyword">case</span> <span class="string">'init'</span>
4534         guiparams.gui_state = <span class="string">'init'</span>;
4535         set([handles.menuFile
4536             handles.menuOpen
4537             handles.menuOpenASCII
4538             handles.menuOpenMAT
4539             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4540         
4541         set([handles.toolbarLoadData
4542             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4543         set([handles.toolbarSaveMatFile
4544             handles.toolbarSaveBathymetry
4545             handles.toolbarSaveFigures
4546             handles.toolbarSaveExcel
4547             handles.toolbarPlottingParameters
4548             handles.toolbarProcessingParameters
4549             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4550         
4551         set([handles.DepthRangeMin
4552             handles.DepthRangeMax
4553             handles.VectorScalePlanView
4554             handles.VectorSpacingPlanview
4555             handles.SmoothingWindowSize
4556             handles.DisplayShoreline
4557             handles.AddBackground
4558             handles.PlotPlanView
4559             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4560         
4561         set([handles.WaterSurfaceElevation
4562             handles.BedElevation
4563             handles.KMZVerticalOffset
4564             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4565         
4566         set([handles.HorizontalGridNodeSpacing
4567             handles.VerticalGridNodeSpacing
4568             handles.PlotShiptracks
4569             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4570         
4571         set([handles.Contour
4572             handles.VerticalExaggeration
4573             handles.VectorScaleCrossSection
4574             handles.HorizontalVectorSpacing
4575             handles.VerticalVectorSpacing
4576             handles.HorizontalSmoothingWindow
4577             handles.VerticalSmoothingWindow
4578             handles.PlotSecondaryFlowVectors
4579             handles.AllowVMTFlipFlux
4580             handles.AllowVMTFlipFluxText
4581             handles.SecondaryFlowVectorVariable
4582             handles.IncludeVerticalVelocity
4583             handles.IncludeVerticalVelocityText
4584             handles.PlotCrossSection
4585             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4586         
4587     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4588         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4589         set([handles.menuFile
4590             handles.menuOpen
4591             handles.menuOpenASCII
4592             handles.menuOpenMAT
4593             handles.menuSaveMAT
4594             handles.menuSaveTecplot
4595             handles.menuSaveKMZFile
4596             handles.menuParameters
4597             handles.menuPlottingParameters
4598             handles.menuMetric
4599             handles.menuEnglish
4600             handles.menuBathymetryExportSettings
4601             handles.menuExportMultibeamBathymetry
4602             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4603             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4604         
4605         set([handles.toolbarLoadData
4606             handles.toolbarSaveMatFile
4607             handles.toolbarSaveBathymetry
4608             handles.toolbarSaveExcel
4609             handles.toolbarSaveFigures
4610             handles.toolbarPlottingParameters
4611             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4612         set([handles.toolbarProcessingParameters
4613             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4614         
4615            
4616         set([handles.DepthRangeMin
4617             handles.DepthRangeMax
4618             handles.VectorScalePlanView
4619             handles.VectorSpacingPlanview
4620             handles.SmoothingWindowSize
4621             handles.DisplayShoreline
4622             handles.PlotPlanView
4623             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4624         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4625             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4626         <span class="keyword">else</span>
4627             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4628         <span class="keyword">end</span>
4629         
4630         set([handles.WaterSurfaceElevation
4631             handles.BedElevation
4632             handles.KMZVerticalOffset
4633             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4634         
4635         set([handles.HorizontalGridNodeSpacing
4636             handles.VerticalGridNodeSpacing
4637             handles.PlotShiptracks
4638             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4639         
4640         set([handles.Contour
4641             handles.VerticalExaggeration
4642             handles.VectorScaleCrossSection
4643             handles.HorizontalVectorSpacing
4644             handles.VerticalVectorSpacing
4645             handles.HorizontalSmoothingWindow
4646             handles.VerticalSmoothingWindow
4647             handles.PlotSecondaryFlowVectors
4648             handles.AllowVMTFlipFlux
4649             handles.AllowVMTFlipFluxText
4650             handles.SecondaryFlowVectorVariable
4651             handles.IncludeVerticalVelocity
4652             handles.IncludeVerticalVelocityText
4653             handles.PlotCrossSection
4654             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4655     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4656         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4657         set([handles.menuFile
4658             handles.menuOpen
4659             handles.menuOpenASCII
4660             handles.menuOpenMAT
4661             handles.menuParameters
4662             handles.menuPlottingParameters
4663             handles.menuMetric
4664             handles.menuEnglish
4665             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4666         set([handles.menuSaveMAT
4667             handles.menuBathymetryExportSettings
4668             handles.menuExportMultibeamBathymetry
4669             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4670             handles.menuSaveKMZFile
4671             handles.menuSaveTecplot
4672             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4673         
4674         set([handles.toolbarLoadData
4675             handles.toolbarSaveFigures
4676             handles.toolbarPlottingParameters
4677             handles.toolbarSaveExcel
4678             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4679         set([handles.toolbarProcessingParameters
4680             handles.toolbarSaveMatFile
4681             handles.toolbarSaveBathymetry
4682             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4683         
4684         set([handles.DepthRangeMin
4685             handles.DepthRangeMax
4686             handles.VectorScalePlanView
4687             handles.VectorSpacingPlanview
4688             handles.SmoothingWindowSize
4689             handles.DisplayShoreline
4690             handles.PlotPlanView
4691             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4692         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4693             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4694         <span class="keyword">else</span>
4695             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4696         <span class="keyword">end</span>
4697         
4698         set([handles.HorizontalGridNodeSpacing
4699             handles.VerticalGridNodeSpacing
4700             handles.PlotShiptracks
4701             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4702         
4703         set([handles.Contour
4704             handles.VerticalExaggeration
4705             handles.VectorScaleCrossSection
4706             handles.HorizontalVectorSpacing
4707             handles.VerticalVectorSpacing
4708             handles.HorizontalSmoothingWindow
4709             handles.VerticalSmoothingWindow
4710             handles.PlotSecondaryFlowVectors
4711             handles.AllowVMTFlipFlux
4712             handles.AllowVMTFlipFluxText
4713             handles.SecondaryFlowVectorVariable
4714             handles.IncludeVerticalVelocity
4715             handles.IncludeVerticalVelocityText
4716             handles.PlotCrossSection
4717             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4718     <span class="keyword">otherwise</span>
4719 <span class="keyword">end</span>
4720 
4721 <span class="comment">% Save Application Data</span>
4722 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4723 
4724 <span class="comment">% [EOF] set_enable</span>
4725 
4726 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4727 
4728 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4729 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4730 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4731 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4732 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4733 
4734 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4735 
4736 
4737 <span class="comment">% --------------------------------------------------------------------</span>
4738 <a name="_sub103" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4739     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4740 
4741 w = 500;
4742 h = 110;
4743 dx = 10;
4744 dy = 35;
4745 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4746 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4747     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4748     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4749     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4750     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4751     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4752     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4753     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4754     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4755     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4756     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4757 dialog_params.english_units               = english_units;
4758 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4759 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4760 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4761 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4762 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4763 
4764 <span class="comment">% Build the graphics:</span>
4765 <span class="comment">% -------------------</span>
4766 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4767     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4768     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4769     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4770 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4771     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4772     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4773     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4774     <span class="string">'Position'</span>,[15 35 100 22]);
4775 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4776     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4777     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4778     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4779     <span class="string">'Position'</span>,[15 10 100 22]);
4780 
4781 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4782     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4783     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4784     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4785 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4786     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4787     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4788     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4789     <span class="string">'Position'</span>,[15 35 100 22]);
4790 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4791     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4792     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4793     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4794     <span class="string">'Position'</span>,[15 10 100 22]);
4795 
4796 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4797     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4798     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4799     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4800 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4801     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4802     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4803     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4804     <span class="string">'Position'</span>,[15 35 100 22]);
4805 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4806     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4807     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4808     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4809     <span class="string">'Position'</span>,[15 10 100 22]);
4810 
4811 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4812     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4813     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4814     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4815     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4816 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4817     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4818     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4819     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4820     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4821 
4822 <span class="comment">% Update the UI controls:</span>
4823 <span class="comment">% -----------------------</span>
4824 <span class="keyword">if</span> dialog_params.english_units
4825     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4826     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4827 <span class="keyword">else</span>
4828     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4829     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4830 <span class="keyword">end</span>
4831 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4832     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4833     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4834 <span class="keyword">else</span>
4835     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4836     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4837 <span class="keyword">end</span>
4838 <span class="keyword">if</span> dialog_params.presentation
4839     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4840     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4841 <span class="keyword">else</span>
4842     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4843     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4844 <span class="keyword">end</span>
4845 
4846 <span class="comment">% Set the callbacks:</span>
4847 <span class="comment">% ------------------</span>
4848 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4849 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4850 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4851 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4852 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4853 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4854 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4855 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4856 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4857 
4858 <span class="comment">% Position the dialog and make it visible:</span>
4859 <span class="comment">% ----------------------------------------</span>
4860 fpos = get(hf,<span class="string">'Position'</span>);
4861 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4862 movegui(handles.Figure,dpos)
4863 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4864 
4865 <span class="comment">% Hold the dialog open:</span>
4866 <span class="comment">% ---------------------</span>
4867 waitfor(handles.OK)
4868 
4869 <span class="comment">% Return the outputs and close the dialog:</span>
4870 <span class="comment">% ----------------------------------------</span>
4871 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4872 english_units = dialog_params.english_units;
4873 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4874 plot_presentation_style =  dialog_params.presentation;
4875 plot_print_style =  dialog_params.print;
4876 
4877 delete(handles.Figure)
4878 
4879 <span class="comment">% [EOF] plotParametersDialog</span>
4880 
4881 
4882 <span class="comment">% --------------------------------------------------------------------</span>
4883 <a name="_sub104" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4884 
4885 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4886 <span class="keyword">switch</span> the_units
4887     <span class="keyword">case</span> <span class="string">'metric'</span>
4888         dialog_params.english_units = false;
4889         
4890         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4891         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4892     <span class="keyword">case</span> <span class="string">'english'</span>
4893         dialog_params.english_units = true;
4894         
4895         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4896         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4897     <span class="keyword">otherwise</span>
4898 <span class="keyword">end</span>
4899 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4900 
4901 <span class="comment">% [EOF] dialogUnits</span>
4902 
4903 <span class="comment">% --------------------------------------------------------------------</span>
4904 <a name="_sub105" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4905 
4906 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4907 <span class="keyword">switch</span> the_endpoints
4908     <span class="keyword">case</span> <span class="string">'auto'</span>
4909         dialog_params.set_cross_section_endpoints = false;
4910         
4911         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4912         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4913     <span class="keyword">case</span> <span class="string">'manual'</span>
4914         dialog_params.set_cross_section_endpoints = true;
4915         
4916         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4917         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4918     <span class="keyword">otherwise</span>
4919 <span class="keyword">end</span>
4920 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4921 
4922 <span class="comment">% [EOF] dialogEnpoints</span>
4923 
4924 <a name="_sub106" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4925 
4926 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4927 <span class="keyword">switch</span> the_style
4928     <span class="keyword">case</span> <span class="string">'presentation'</span>
4929         dialog_params.presentation  = true;
4930         dialog_params.print         = false;
4931         
4932         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4933         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4934     <span class="keyword">case</span> <span class="string">'print'</span>
4935         dialog_params.presentation  = false;
4936         dialog_params.print         = true;
4937         
4938         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4939         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4940     <span class="keyword">otherwise</span>
4941 <span class="keyword">end</span>
4942 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4943 
4944 <span class="comment">% [EOF] dialogEnpoints</span>
4945 
4946 <span class="comment">% --------------------------------------------------------------------</span>
4947 <a name="_sub107" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4948 
4949 delete(h_OK)
4950 
4951 <span class="comment">% [EOF] dialogOK</span>
4952 
4953 <span class="comment">% --------------------------------------------------------------------</span>
4954 <a name="_sub108" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4955 <span class="comment">% Return the original inputs</span>
4956 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4957 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4958 delete(handles.OK)
4959 
4960 <span class="comment">% [EOF] dialogCancel</span>
4961 
4962 <span class="comment">% --------------------------------------------------------------------</span>
4963 <a name="_sub109" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4964 
4965 delete(h_OK)
4966 
4967 <span class="comment">% [EOF] dialogCloseReq</span>
4968 
4969 <a name="_sub110" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4970     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4971 w = 230;
4972 h = 245;
4973 dx = 10;
4974 dy = 35;
4975 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4976 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4977     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4978     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4979     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4980     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4981     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4982     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4983     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4984     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4985     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4986     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4987 dialog_params.beam_angle             = beam_angle;
4988 dialog_params.magnetic_variation     = magnetic_variation;
4989 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4990     dialog_params.wse                = <span class="string">'tide'</span>;
4991     wse_string                       = <span class="string">'tide'</span>;
4992 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4993     dialog_params.wse                = <span class="string">'tide'</span>;
4994     wse_string                       = <span class="string">'tide'</span>;
4995 <span class="keyword">else</span>
4996     dialog_params.wse                = wse;
4997     wse_string                       = num2str(wse);
4998 <span class="keyword">end</span>
4999 dialog_params.load_wse_tide_file     = load_wse_tide_file;
5000 dialog_params.output_auxiliary_data  = output_auxiliary_data;
5001 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5002 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5003 
5004 <span class="comment">% Build the graphics:</span>
5005 <span class="comment">% -------------------</span>
5006 ph = 150;
5007 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5008     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
5009     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5010     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5011 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5012     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5013     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
5014     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5015     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5016     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5017     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
5018 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5019     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5020     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
5021     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
5022     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5023     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5024     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
5025 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5026     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5027     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
5028     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5029     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5030     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5031     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
5032 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5033     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5034     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5035     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
5036     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5037     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5038     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
5039 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
5040     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5041     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
5042     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
5043     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
5044     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5045     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
5046 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
5047     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5048     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
5049     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
5050     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
5051     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5052     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
5053 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5054     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5055     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5056     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
5057     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
5058 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
5059     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
5060     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
5061     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5062     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
5063 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5064     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5065     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5066     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5067     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5068 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5069     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5070     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5071     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5072     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5073 
5074 <span class="comment">% Update the UI controls:</span>
5075 <span class="comment">% -----------------------</span>
5076 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
5077 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
5078 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
5079 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
5080 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
5081 
5082 <span class="comment">% Set the callbacks:</span>
5083 <span class="comment">% ------------------</span>
5084 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5085 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5086 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5087 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5088 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5089 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub111" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
5090 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
5091 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
5092 
5093 <span class="comment">% Position the dialog and make it visible:</span>
5094 <span class="comment">% ----------------------------------------</span>
5095 fpos = get(hf,<span class="string">'Position'</span>);
5096 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5097 movegui(handles.Figure,dpos)
5098 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5099 
5100 <span class="comment">% Hold the dialog open:</span>
5101 <span class="comment">% ---------------------</span>
5102 waitfor(handles.OK)
5103 
5104 <span class="comment">% Return the outputs and close the dialog:</span>
5105 <span class="comment">% ----------------------------------------</span>
5106 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5107 beam_angle              = dialog_params.beam_angle;
5108 magnetic_variation      = dialog_params.magnetic_variation;
5109 wse                     = dialog_params.wse;
5110 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
5111 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
5112 
5113 delete(handles.Figure)
5114 
5115 <span class="comment">% [EOF] exportSettingsDialog</span>
5116 
5117 <span class="comment">% --------------------------------------------------------------------</span>
5118 <a name="_sub111" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
5119 
5120 <span class="comment">% Grab the current data</span>
5121 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5122 
5123 <span class="comment">% Set it according to the dialog box values</span>
5124 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
5125 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
5126 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
5127 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
5128 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
5129 
5130 <span class="comment">% Re-store the application data</span>
5131 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5132 
5133 <span class="comment">% [EOF] dialogExportSettings</span>
5134 
5135 <a name="_sub112" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
5136 
5137 w = 230;
5138 h = 200;
5139 dx = 10;
5140 dy = 35;
5141 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
5142 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
5143     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
5144     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5145     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
5146     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
5147     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5148     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5149     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5150     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
5151     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5152     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
5153 dialog_params.figure_names               = figure_names;
5154 dialog_params.selected_figures           = <span class="string">''</span>;
5155 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5156 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5157 
5158 <span class="comment">% Build the graphics:</span>
5159 <span class="comment">% -------------------</span>
5160 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5161     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
5162     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5163     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5164 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
5165     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
5166     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
5167     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
5168     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
5169     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
5170     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5171     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5172 
5173 
5174 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5175     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5176     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5177     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5178     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5179 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5180     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5181     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5182     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5183     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5184 
5185 <span class="comment">% Update the UI controls:</span>
5186 <span class="comment">% -----------------------</span>
5187 
5188 
5189 <span class="comment">% Set the callbacks:</span>
5190 <span class="comment">% ------------------</span>
5191 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub109" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5192 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub113" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5193 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub107" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5194 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5195 
5196 <span class="comment">% Position the dialog and make it visible:</span>
5197 <span class="comment">% ----------------------------------------</span>
5198 fpos = get(hf,<span class="string">'Position'</span>);
5199 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5200 movegui(handles.Figure,dpos)
5201 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5202 
5203 <span class="comment">% Hold the dialog open:</span>
5204 <span class="comment">% ---------------------</span>
5205 waitfor(handles.OK)
5206 
5207 <span class="comment">% Return the outputs and close the dialog:</span>
5208 <span class="comment">% ----------------------------------------</span>
5209 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5210 selected_figures = dialog_params.selected_figures;
5211 
5212 delete(handles.Figure)
5213 
5214 <span class="comment">% [EOF] openFiguresDialog</span>
5215 
5216 <span class="comment">% --------------------------------------------------------------------</span>
5217 <a name="_sub113" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5218 
5219 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5220 
5221 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5222 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5223 selected     = fig_names(idx_selected);
5224 dialog_params.selected_figures = selected;
5225 
5226 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5227 
5228 
5229 
5230 <span class="comment">% --------------------------------------------------------------------</span>
5231 <a name="_sub114" href="#_subfunctions" class="code">function icons = getIcons</a>
5232 
5233 <span class="comment">% Load data</span>
5234 idx = 1;
5235 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5236     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5237     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5238     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5239     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5240     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5241     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5242     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5243     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5244     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5245     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5246     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5247     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5248     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5249     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5250     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5251     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5252 
5253 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5254     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5255     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5256     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5257     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5258     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5259     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5260     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5261     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5262     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5263     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5264     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5265     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5266     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5267     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5268     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5269     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5270 
5271 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5272     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5273     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5274     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5275     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5276     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5277     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5278     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5279     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5280     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5281     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5282     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5283     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5284     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5285     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5286     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5287     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5288 
5289 <span class="comment">% Save data</span>
5290 idx = idx+1;
5291 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5292     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5293     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5294     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5295     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5296     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5297     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5298     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5299     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5300     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5301     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5302     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5303     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5304     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5305     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5306     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5307     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5308 
5309 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5310     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5311     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5312     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5313     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5314     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5315     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5316     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5317     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5318     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5319     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5320     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5321     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5322     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5323     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5324     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5325     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5326 
5327 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5328     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5329     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5330     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5331     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5332     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5333     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5334     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5335     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5336     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5337     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5338     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5339     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5340     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5341     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5342     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5343     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5344 
5345 <span class="comment">% Plotting parameters</span>
5346 idx = idx+1;
5347 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5348     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5349     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5350     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5351     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5352     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5353     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5354     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5355     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5356     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5357     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5358     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5359     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5360     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5361     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5362     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5363     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5364 
5365 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5366     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5367     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5368     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5369     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5370     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5371     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5372     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5373     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5374     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5375     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5376     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5377     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5378     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5379     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5380     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5381     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5382 
5383 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5384     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5385     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5386     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5387     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5388     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5389     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5390     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5391     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5392     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5393     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5394     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5395     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5396     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5397     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5398     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5399     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5400 
5401 <span class="comment">% Processing parameters</span>
5402 idx = idx+1;
5403 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5404     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5405     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5406     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5407     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5408     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5409     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5410     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5411     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5412     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5413     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5414     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5415     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5416     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5417     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5418     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5419     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5420 
5421 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5422     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5423     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5424     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5425     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5426     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5427     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5428     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5429     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5430     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5431     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5432     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5433     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5434     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5435     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5436     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5437     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5438 
5439 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5440     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5441     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5442     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5443     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5444     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5445     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5446     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5447     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5448     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5449     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5450     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5451     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5452     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5453     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5454     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5455     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5456 
5457 <span class="comment">% Export bathymetry dialog</span>
5458 idx = idx+1;
5459 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5460     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5461     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5462     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5463     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5464     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5465     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5466     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5467     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5468     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5469     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5470     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5471     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5472     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5473     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5474     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5475     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5476     ]/255;
5477 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5478     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5479     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5480     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5481     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5482     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5483     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5484     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5485     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5486     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5487     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5488     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5489     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5490     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5491     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5492     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5493     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5494     ]/255;
5495 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5496     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5497     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5498     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5499     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5500     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5501     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5502     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5503     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5504     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5505     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5506     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5507     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5508     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5509     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5510     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5511     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5512     ]/255;
5513 
5514 <span class="comment">% Export Figures Dialog</span>
5515 idx = idx + 1;
5516 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5517     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5518     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5519     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5520     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5521     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5522     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5523     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5524     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5525     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5526     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5527     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5528     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5529     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5530     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5531     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5532 
5533 
5534 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5535     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5536     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5537     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5538     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5539     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5540     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5541     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5542     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5543     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5544     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5545     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5546     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5547     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5548     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5549     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5550 
5551 
5552 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5553     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5554     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5555     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5556     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5557     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5558     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5559     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5560     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5561     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5562     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5563     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5564     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5565     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5566     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5567     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5568 
5569 <span class="comment">% Export Excel File</span>
5570 idx = idx + 1;
5571 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5572     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5573    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5574    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5575    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5576    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5577    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5578    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5579    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5580    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5581    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5582    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5583    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5584    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5585    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5586    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5587     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5588 
5589 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5590     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5591    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5592    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5593    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5594    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5595    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5596    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5597    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5598    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5599    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5600    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5601    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5602    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5603    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5604    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5605     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5606 
5607 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5608     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5609    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5610    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5611    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5612    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5613    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5614    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5615    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5616    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5617    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5618    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5619    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5620    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5621    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5622    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5623     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5624 
5625 <span class="comment">% Zoom In</span>
5626 idx = idx + 1;
5627 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5628     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5629 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5630     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5631 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5632     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5633 
5634 <span class="comment">% Zoom Out</span>
5635 idx = idx + 1;
5636 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5637     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5638 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5639     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5640 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5641     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5642 
5643 <span class="comment">% Pan</span>
5644 idx = idx + 1;
5645 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5646     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5647 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5648     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5649 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5650     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5651 <span class="comment">% [EOF] getIcons</span>
5652 
5653 <a name="_sub115" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5654 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5655 
5656 <span class="comment">% Check for any stored prefs</span>
5657 <span class="comment">% --------------------------</span>
5658 <span class="comment">% Currently, units and the graphics renderer are stored as persistent prefs</span>
5659 guiprefs = getpref(<span class="string">'VMT'</span>);
5660 
5661 <span class="comment">% Organized by GUI panels</span>
5662 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5663 <span class="comment">% SHIPTRACKS PLOT %</span>
5664 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5665 guiparams.horizontal_grid_node_spacing       = 1.0;
5666 guiparams.vertical_grid_node_spacing         = 0.4;
5667 
5668 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5669 <span class="comment">% CROSS SECTION PLOT %</span>
5670 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5671 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5672 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5673 guiparams.idx_contour                        = 1;
5674 guiparams.vertical_exaggeration              = 10;
5675 guiparams.vector_scale_cross_section         = 0.2;
5676 guiparams.horizontal_vector_spacing          = 1;
5677 guiparams.vertical_vector_spacing            = 1;
5678 guiparams.horizontal_smoothing_window        = 1;
5679 guiparams.vertical_smoothing_window          = 1;
5680 guiparams.plot_secondary_flow_vectors        = true;
5681 guiparams.allow_vmt_flip_flux                = true;
5682 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5683 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5684 guiparams.idx_secondary_flow_vector_variable = 1;
5685 guiparams.include_vertical_velocity          = true;
5686 
5687 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5688 <span class="comment">% PLAN VIEW PLOT %</span>
5689 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5690 guiparams.depth_range_min                    = 0;
5691 guiparams.depth_range_max                    = inf;
5692 guiparams.vector_scale_plan_view             = 1;
5693 guiparams.vector_spacing_plan_view           = 1;
5694 guiparams.smoothing_window_size              = 1;
5695 guiparams.display_shoreline                  = false;
5696 guiparams.add_background                     = false;
5697 
5698 <span class="comment">%%%%%%%%%%%</span>
5699 <span class="comment">% OFFSETS %</span>
5700 <span class="comment">%%%%%%%%%%%</span>
5701 guiparams.water_surface_elevation            = 0.0;
5702 guiparams.bed_elevation                      = 0.0;
5703 guiparams.KMZ_vertical_offset                = 0.0;
5704 
5705 <span class="comment">%%%%%%%%%%%%%%%</span>
5706 <span class="comment">% DATA EXPORT %</span>
5707 <span class="comment">%%%%%%%%%%%%%%%</span>
5708 guiparams.beam_angle                         = 20.0;
5709 guiparams.magnetic_variation                 = 0.0;
5710 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5711 guiparams.load_wse_tide_file                 = false;
5712 guiparams.output_auxiliary_data              = false;
5713 
5714 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5715 <span class="comment">% Contour variables %</span>
5716 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5717 idx = 1;
5718 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5719 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5720 idx = idx + 1;
5721 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5722 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5723 idx = idx + 1;
5724 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5725 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5726 idx = idx + 1;
5727 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5728 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5729 idx = idx + 1;
5730 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5731 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5732 idx = idx + 1;
5733 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5734 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5735 idx = idx + 1;
5736 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5737 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5738 idx = idx + 1;
5739 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5740 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5741 idx = idx + 1;
5742 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5743 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5744 idx = idx + 1;
5745 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5746 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5747 idx = idx + 1;
5748 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5749 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5750 idx = idx + 1;
5751 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5752 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5753 idx = idx + 1;
5754 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5755 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5756 idx = idx + 1;
5757 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5758 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5759 idx = idx + 1;
5760 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5761 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5762 idx = idx + 1;
5763 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5764 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5765 idx = idx + 1;
5766 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5767 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5768 idx = idx + 1;
5769 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5770 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5771 idx = idx + 1;
5772 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5773 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5774 idx = idx + 1;
5775 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5776 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5777 
5778 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5779 
5780 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5781 <span class="comment">% Secondary Flow Vector Variables %</span>
5782 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5783 idx = 1;
5784 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5785 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5786 idx = idx + 1;
5787 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5788 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5789 idx = idx + 1;
5790 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5791 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5792 idx = idx + 1;
5793 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5794 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5795 idx = idx + 1;
5796 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5797 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5798 
5799 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5800     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5801 
5802 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5803 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5804 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5805 <span class="comment">% Menu bar options</span>
5806 guiparams.presentation                       = true;
5807 guiparams.print                              = false;
5808 guiparams.set_cross_section_endpoints        = false;
5809 guiparams.unit_discharge_correction          = false;
5810 
5811 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5812     <span class="keyword">switch</span> guiprefs.units
5813         <span class="keyword">case</span> <span class="string">'metric'</span>
5814             guiparams.english_units          = false;
5815         <span class="keyword">case</span> <span class="string">'english'</span>
5816             guiparams.english_units          = true;
5817     <span class="keyword">end</span>
5818 <span class="keyword">else</span>
5819     guiparams.english_units                  = false;
5820 <span class="keyword">end</span>
5821 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5822     <span class="keyword">switch</span> guiprefs.plotref
5823         <span class="keyword">case</span> <span class="string">'dfs'</span>
5824             guiparams.plotref                 = <span class="string">'dfs'</span>;
5825         <span class="keyword">case</span> <span class="string">'hab'</span>
5826             guiparams.plotref                 = <span class="string">'hab'</span>;
5827     <span class="keyword">end</span>
5828 <span class="keyword">else</span>
5829     guiparams.plotref                         = <span class="string">'dfs'</span>;
5830 <span class="keyword">end</span>
5831 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5832 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5833 
5834 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5835     guiparams.renderer                       = guiprefs.renderer;
5836 <span class="keyword">else</span>
5837     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5838 <span class="keyword">end</span>
5839 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5840 <span class="comment">% guiparams.plot_planview                      = false;</span>
5841 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5842 
5843 <span class="comment">% File location defaults</span>
5844 guiparams.ascii_path                        = pwd;
5845 guiparams.ascii_file                        = <span class="string">''</span>;
5846 guiparams.mat_path                          = pwd;
5847 guiparams.mat_file                          = <span class="string">''</span>;
5848 guiparams.tecplot_path                      = pwd;
5849 guiparams.tecplot_file                      = <span class="string">''</span>;
5850 guiparams.kmz_path                          = pwd;
5851 guiparams.kmz_file                          = <span class="string">''</span>;
5852 guiparams.multibeambathymetry_path          = pwd;
5853 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5854 guiparams.log_path                          = pwd;
5855 guiparams.log_file                          = <span class="string">''</span>;
5856 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5857 <span class="comment">% application</span>
5858 <span class="keyword">if</span> isdeployed 
5859     guiparams.has_mapping_toolbox           = true;
5860 <span class="keyword">else</span>
5861     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5862         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5863 <span class="keyword">end</span>
5864 
5865 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5866 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5867 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5868 guiparams.z                      = [];
5869 guiparams.A                      = [];
5870 guiparams.V                      = [];
5871 guiparams.Map                    = [];
5872 guiparams.savefile               = [];
5873 guiparams.iric_anv_planview_data = [];
5874 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5875 <span class="comment">% guiparams.zmax = [];</span>
5876 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5877 guiparams.data_folder = <span class="string">''</span>;
5878 guiparams.data_files  = {<span class="string">''</span>};
5879 guiparams.gui_state   = <span class="string">'init'</span>;
5880 
5881 <span class="comment">% [EOF] createGUIparams</span>
5882 
5883 <a name="_sub116" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5884 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5885 
5886 <a name="_sub117" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5887 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5888 
5889 <span class="comment">% [EOF] VMT</span>
5890 
5891 
5892 
5893 
5894 
5895 <span class="comment">% --- Hidden keyboard commands</span>
5896 <a name="_sub118" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5897 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5898 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5899 <span class="comment">%</span>
5900 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5901 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5902 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5903 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5904 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5905 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5906 
5907 in1 = eventdata.Modifier; 
5908 in2 = eventdata.Key;
5909 
5910 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5911     input = [in1{:} in2];
5912 <span class="keyword">else</span>
5913     input = in2;
5914 <span class="keyword">end</span>
5915 
5916 <span class="keyword">switch</span> input
5917     <span class="comment">% Hidden SonTek M9 support</span>
5918     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5919         msgtxt = {<span class="keyword">...</span>
5920             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5921             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5922             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5923             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5924             <span class="string">''</span>;<span class="keyword">...</span>
5925             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5926             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5927             <span class="string">'PROVISIONAL at best.'</span>};
5928         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5929         
5930         <span class="comment">% Get the Application data:</span>
5931         <span class="comment">% -------------------------</span>
5932         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5933         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5934         
5935         <span class="comment">% Ask the user to select files:</span>
5936         <span class="comment">% -----------------------------</span>
5937         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5938         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5939         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5940             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5941         <span class="keyword">else</span>
5942             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5943         <span class="keyword">end</span>
5944         [filename,pathname] = <span class="keyword">...</span>
5945             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5946             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5947             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5948         
5949         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5950             guiparams.data_folder = pathname;
5951             <span class="keyword">if</span> ischar(filename)
5952                 filename = {filename};
5953             <span class="keyword">end</span>
5954             guiparams.data_files = filename;
5955             guiparams.mat_file = <span class="string">''</span>;
5956             
5957             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5958             
5959             
5960             
5961             <span class="comment">% Update the preferences:</span>
5962             <span class="comment">% -----------------------</span>
5963             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5964             guiprefs.ascii_path = pathname;
5965             guiprefs.ascii_file = filename;
5966             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5967             <a href="#_sub100" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5968             
5969             <span class="comment">% Push messages to Log Window:</span>
5970             <span class="comment">% ----------------------------</span>
5971             log_text = {<span class="keyword">...</span>
5972                 <span class="string">''</span>;<span class="keyword">...</span>
5973                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5974                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5975                 guiparams.data_folder;
5976                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5977                 char(filename)};
5978             statusLogging(handles.LogWindow, log_text)
5979             
5980             <span class="comment">% Read the file(s)</span>
5981             <span class="comment">% ----------------</span>
5982             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5983             
5984             [~,~,savefile,A,z] = <span class="keyword">...</span>
5985                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5986             guiparams.savefile = savefile;
5987             guiparams.A        = A;
5988             guiparams.z        = z;
5989             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5990             
5991             
5992             <span class="comment">% Update the GUI:</span>
5993             <span class="comment">% ---------------</span>
5994             <a href="#_sub102" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5995         <span class="keyword">end</span>  
5996     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5997         SontekMAT2KML;
5998     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5999         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
6000         
6001     <span class="keyword">case</span> <span class="string">'controlalte'</span>
6002         VMT_BuildCustomFlatFile;
6003     <span class="keyword">otherwise</span>
6004         <span class="comment">%disp(input)</span>
6005 <span class="keyword">end</span>
6006 
6007 
6008 
6009 
6010 
6011 
6012 
6013 
6014 
6015</pre></div>
<hr><address>Generated on Thu 10-Dec-2015 12:46:24 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>