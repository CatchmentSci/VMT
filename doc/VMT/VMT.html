<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub24" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub25" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub94" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub95" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub96" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub97" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub98" class="code">function initGUI(handles)</a></li><li><a href="#_sub99" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub100" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub101" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub102" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub103" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub104" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub106" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub107" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub108" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub110" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub111" class="code">function icons = getIcons</a></li><li><a href="#_sub112" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub113" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub114" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub115" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 <span class="comment">% Adress 2015b java bug #1293244</span>
0034 javax.swing.UIManager.setLookAndFeel(<span class="string">'com.sun.java.swing.plaf.windows.WindowsLookAndFeel'</span>)
0035 gui_Singleton = 1;
0036 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0037     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0038     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0039     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0040     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0041     <span class="string">'gui_Callback'</span>,   []);
0042 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0043     gui_State.gui_Callback = str2func(varargin{1});
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0047 <span class="keyword">try</span>
0048 <span class="keyword">if</span> nargout
0049     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">else</span>
0051     gui_mainfcn(gui_State, varargin{:});
0052 <span class="keyword">end</span>
0053 
0054 <span class="keyword">catch</span> err
0055     <span class="keyword">if</span> isdeployed
0056         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0057             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0058         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0059             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0060             errLogFileName},<span class="keyword">...</span>
0061             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0062             <span class="string">'error'</span>);
0063         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0064         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0065         fclose(fid);
0066         rethrow(err)
0067     <span class="keyword">else</span>
0068         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0069             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0070             <span class="string">'error'</span>);
0071         rethrow(err);
0072     <span class="keyword">end</span>
0073 <span class="keyword">end</span>
0074 <span class="comment">% End initialization code - DO NOT EDIT</span>
0075 
0076 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0077 
0078 <span class="comment">% --- Executes just before VMT is made visible.</span>
0079 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0080 <span class="comment">% This function has no output args, see OutputFcn.</span>
0081 <span class="comment">% hObject    handle to figure</span>
0082 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0083 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0084 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0085 
0086 <span class="comment">% Choose default command line output for VMT</span>
0087 handles.output = hObject;
0088 
0089 <span class="comment">% Build the GUI toolbar:</span>
0090 <span class="comment">% ----------------------</span>
0091 handles = <a href="#_sub95" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0092 
0093 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0094 <span class="comment">% ----------------------------------------</span>
0095 <span class="keyword">if</span> ~isdeployed
0096     utilspath = [pwd filesep <span class="string">'utils'</span>];
0097     docspath  = [pwd filesep <span class="string">'doc'</span>];
0098     toolspath = [pwd filesep <span class="string">'tools'</span>];
0099     addpath(utilspath,docspath,toolspath)
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">% Update handles structure</span>
0103 <span class="comment">% ------------------------</span>
0104 guidata(hObject, handles);
0105 
0106 <span class="comment">% Load the GUI preferences:</span>
0107 <span class="comment">% -------------------------</span>
0108 <a href="#_sub96" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0109 
0110 <span class="comment">% Initialize the GUI parameters:</span>
0111 <span class="comment">% ------------------------------</span>
0112 guiparams = <a href="#_sub112" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0113 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20160714'</span>};
0114 
0115 <span class="comment">% Draw the VMT Background</span>
0116 <span class="comment">% -----------------</span>
0117 pos = get(handles.figure1,<span class="string">'position'</span>);
0118 axes(handles.VMTBackground);
0119 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0120     X = imread(<span class="string">'VMT_Background.png'</span>);
0121     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0122 <span class="comment">% else</span>
0123 <span class="comment">%     X = imread('VMT_Background.png');</span>
0124 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0125 <span class="comment">%     X = uint8(X);</span>
0126 <span class="comment">%     imshow(X,'Border','tight')</span>
0127 <span class="comment">% end</span>
0128 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0129 
0130 <span class="comment">% Store the application data:</span>
0131 <span class="comment">% ---------------------------</span>
0132 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0133 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0134 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0135 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0136 
0137 <span class="comment">% Auto-check for updates</span>
0138 <span class="comment">% ----------------------</span>
0139 thres = 20; 
0140 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0141 time_to_check = (mod(runcounter,thres)==0);
0142 <span class="keyword">if</span> time_to_check
0143     <a href="#_sub54" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0144 <span class="keyword">end</span>
0145 
0146 <span class="comment">% Initialize the GUI:</span>
0147 <span class="comment">% -------------------</span>
0148 <a href="#_sub98" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0149 <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0150 
0151 <span class="comment">% Allow VMT GUI to be resized depending on the screen resolution</span>
0152 <span class="comment">% set(0,'units','pixels')</span>
0153 <span class="comment">% Pix_SS = get(0,'screensize');</span>
0154 <span class="comment">% movegui(handles.figure1,'center')</span>
0155 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0156 
0157 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0158 <span class="comment">% the root</span>
0159 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0160 
0161 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0162 <span class="comment">% uiwait(handles.figure1);</span>
0163 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0164 
0165 
0166 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0167 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0168 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0169 <span class="comment">% hObject    handle to figure</span>
0170 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0171 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0172 
0173 <span class="comment">% Get default command line output from handles structure</span>
0174 varargout{1} = handles.output;
0175 <span class="comment">% [EOF] VMT_OutputFcn</span>
0176 
0177 <span class="comment">% --- Executes when figure1 is resized.</span>
0178 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0179 
0180 <span class="comment">% Draw the VMT Background</span>
0181 <span class="comment">% -----------------</span>
0182 pos = get(handles.figure1,<span class="string">'position'</span>);
0183 axes(handles.VMTBackground);
0184 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0185     X = imread(<span class="string">'VMT_Background.png'</span>);
0186     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0187 <span class="comment">% else</span>
0188 <span class="comment">%     X = imread('VMT_Background.png');</span>
0189 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0190 <span class="comment">%     X = uint8(X);</span>
0191 <span class="comment">%     imshow(X,'Border','tight')</span>
0192 <span class="comment">% end</span>
0193 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0194 
0195 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0196 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0197 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0198 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0199 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0200 
0201 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0202 who_called = get(hObject,<span class="string">'tag'</span>);
0203 close_button = questdlg(<span class="keyword">...</span>
0204     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0205     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0206 <span class="keyword">switch</span> close_button
0207     <span class="keyword">case</span> <span class="string">'Yes'</span>
0208         closereq
0209         close all hidden
0210     <span class="keyword">otherwise</span>
0211         <span class="keyword">return</span>
0212 <span class="keyword">end</span>
0213 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0214 
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 <span class="comment">% MENU BAR CALLBACKS %</span>
0217 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0221 <span class="comment">% Empty</span>
0222 
0223 <span class="comment">% --------------------------------------------------------------------</span>
0224 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0225 <span class="comment">% Empty</span>
0226 
0227 <span class="comment">% --------------------------------------------------------------------</span>
0228 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0229 <a href="#_sub56" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0230 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0231 
0232 <span class="comment">% --------------------------------------------------------------------</span>
0233 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenSonTekMAT_Callback(hObject, eventdata, handles)</a>
0234 <span class="comment">% Get the Application data:</span>
0235 <span class="comment">% -------------------------</span>
0236 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0237 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0238 
0239 <span class="comment">% Ask the user to select files:</span>
0240 <span class="comment">% -----------------------------</span>
0241 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0242 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0243 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0244     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0245 <span class="keyword">else</span>
0246     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0247 <span class="keyword">end</span>
0248 [filename,pathname] = <span class="keyword">...</span>
0249     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0250     <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
0251     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0252 
0253 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0254     guiparams.data_folder = pathname;
0255     <span class="keyword">if</span> ischar(filename)
0256         filename = {filename};
0257     <span class="keyword">end</span>
0258     guiparams.data_files = filename;
0259     guiparams.mat_file = <span class="string">''</span>;
0260     
0261     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0262     
0263     
0264     
0265     <span class="comment">% Update the preferences:</span>
0266     <span class="comment">% -----------------------</span>
0267     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0268     guiprefs.ascii_path = pathname;
0269     guiprefs.ascii_file = filename;
0270     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0271     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
0272     
0273     <span class="comment">% Push messages to Log Window:</span>
0274     <span class="comment">% ----------------------------</span>
0275     log_text = {<span class="keyword">...</span>
0276         <span class="string">''</span>;<span class="keyword">...</span>
0277         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
0278         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
0279         guiparams.data_folder;
0280         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
0281         char(filename)};
0282     statusLogging(handles.LogWindow, log_text)
0283     
0284     <span class="comment">% Read the file(s)</span>
0285     <span class="comment">% ----------------</span>
0286     <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
0287     
0288     [~,~,savefile,A,z] = <span class="keyword">...</span>
0289         <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
0290     guiparams.savefile = savefile;
0291     guiparams.A        = A;
0292     guiparams.z        = z;
0293     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0294     
0295     
0296     <span class="comment">% Update the GUI:</span>
0297     <span class="comment">% ---------------</span>
0298     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0299 <span class="keyword">end</span>
0300 <span class="comment">% [EOF] menuOpenSonTekMAT_Callback</span>
0301 
0302 <span class="comment">% --------------------------------------------------------------------</span>
0303 <a name="_sub9" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0304 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
0305 <span class="comment">% Get the Application data:</span>
0306 <span class="comment">% -------------------------</span>
0307 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0308 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0309 
0310 <span class="comment">% Ask the user to select files:</span>
0311 <span class="comment">% -----------------------------</span>
0312 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0313 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0314 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0315     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0316 <span class="keyword">else</span>
0317     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0318 <span class="keyword">end</span>
0319 [filename,pathname] = <span class="keyword">...</span>
0320     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0321     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0322     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0323 
0324 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0325     <span class="comment">% Load the data:</span>
0326     <span class="comment">% --------------</span>
0327     vars = load(fullfile(pathname,filename));
0328     
0329     <span class="comment">% Make sure the selected file is a valid file:</span>
0330     <span class="comment">% --------------------------------------------</span>
0331     varnames = fieldnames(vars);
0332     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0333         guiparams.mat_path = pathname;
0334         guiparams.mat_file = filename;
0335         guiparams.z = vars.z;
0336         guiparams.A = vars.A;
0337         guiparams.V = vars.V;
0338         
0339         <span class="comment">% Update the preferences:</span>
0340         <span class="comment">% -----------------------</span>
0341         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0342         guiprefs.mat_path = pathname;
0343         guiprefs.mat_file = filename;
0344         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0345         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0346                      
0347         <span class="comment">% Re-store the Application Data:</span>
0348         <span class="comment">% ------------------------------</span>
0349         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0350         
0351         <span class="comment">% Update the GUI:</span>
0352         <span class="comment">% ---------------</span>
0353         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0354         <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0355     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0356         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0357             <span class="string">'Invalid File...'</span>)
0358     <span class="keyword">end</span>
0359     
0360     <span class="comment">% Set the vertical grid node spacing</span>
0361     <span class="comment">% ----------------------------------</span>
0362     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0363     <span class="comment">% Backwards compatible</span>
0364     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0365         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0366     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0367         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0368     <span class="keyword">end</span>
0369     
0370 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0371     <span class="comment">% Set the filenames</span>
0372     <span class="comment">% -----------------</span>
0373     guiparams.mat_path = pathname;
0374     guiparams.mat_file = filename;
0375     
0376     <span class="comment">% Push status to log window</span>
0377     <span class="comment">% -------------------------</span>
0378     log_text = {<span class="keyword">...</span>
0379         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0380         <span class="string">'Directory:'</span>};
0381     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0382     statusLogging(handles.LogWindow,log_text)
0383     
0384     <span class="comment">% Update the Application Data:</span>
0385     <span class="comment">% ------------------------------</span>
0386     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0387     
0388     <span class="comment">% Update the persistent preferences:</span>
0389     <span class="comment">% ----------------------------------</span>
0390     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0391     guiprefs.mat_path = pathname;
0392     guiprefs.mat_file = filename;
0393     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0394     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0395         
0396     <span class="comment">% Update the GUI:</span>
0397     <span class="comment">% ---------------</span>
0398     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0399 <span class="keyword">end</span>
0400 
0401 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0402 
0403 <span class="comment">% --------------------------------------------------------------------</span>
0404 <a name="_sub10" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0405 <span class="comment">% Empty</span>
0406 
0407 <span class="comment">% --------------------------------------------------------------------</span>
0408 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0409 <a href="#_sub57" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0410 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0411 
0412 <span class="comment">% --------------------------------------------------------------------</span>
0413 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0414 <a href="#_sub65" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0415 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0416 
0417 <span class="comment">% --------------------------------------------------------------------</span>
0418 <a name="_sub13" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0419 <a href="#_sub66" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0420 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0421 
0422 <span class="comment">% --------------------------------------------------------------------</span>
0423 <a name="_sub14" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0424 <span class="comment">% Empty</span>
0425 
0426 <span class="comment">% --------------------------------------------------------------------</span>
0427 <a name="_sub15" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0428 <span class="comment">% Empty</span>
0429 
0430 <span class="comment">% --------------------------------------------------------------------</span>
0431 <a name="_sub16" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0432 
0433 <span class="comment">% Get the Application Data:</span>
0434 <span class="comment">% -------------------------</span>
0435 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0436 
0437 <span class="comment">% Update the Application Data:</span>
0438 <span class="comment">% ----------------------------</span>
0439 guiparams.print        = true;
0440 guiparams.presentation = false;
0441 
0442 <span class="comment">% Re-store the Application data:</span>
0443 <span class="comment">% ------------------------------</span>
0444 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0445 
0446 <span class="comment">% Update the GUI:</span>
0447 <span class="comment">% ---------------</span>
0448 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0449 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0450 
0451 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0452 
0453 
0454 <span class="comment">% --------------------------------------------------------------------</span>
0455 <a name="_sub17" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0456 
0457 <span class="comment">% Get the Application Data:</span>
0458 <span class="comment">% -------------------------</span>
0459 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0460 
0461 <span class="comment">% Update the Application Data:</span>
0462 <span class="comment">% ----------------------------</span>
0463 guiparams.print        = false;
0464 guiparams.presentation = true;
0465 
0466 <span class="comment">% Re-store the Application data:</span>
0467 <span class="comment">% ------------------------------</span>
0468 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0469 
0470 <span class="comment">% Update the GUI:</span>
0471 <span class="comment">% ---------------</span>
0472 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0473 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0474 
0475 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0476 
0477 <span class="comment">% --------------------------------------------------------------------</span>
0478 <a name="_sub18" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0479 <span class="comment">%  --- Empty ---</span>
0480 
0481 <span class="comment">% --------------------------------------------------------------------</span>
0482 <a name="_sub19" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0483 <span class="comment">% Get the Application Data:</span>
0484 <span class="comment">% -------------------------</span>
0485 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0486 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0487 
0488 <span class="comment">% Update the Application Data:</span>
0489 <span class="comment">% ----------------------------</span>
0490 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0491 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0492 
0493 <span class="comment">% Re-store the Application data:</span>
0494 <span class="comment">% ------------------------------</span>
0495 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0496 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0497 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0498 
0499 <span class="comment">% Update the GUI:</span>
0500 <span class="comment">% ---------------</span>
0501 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0502 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0503 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0504 
0505 <span class="comment">% Modify the existing figures</span>
0506 <span class="comment">% ---------------------------</span>
0507 <span class="comment">% Find what plots exist already</span>
0508 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0509 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0510 
0511 <span class="comment">% Loop through valid figures and adjust</span>
0512 <span class="comment">% -------------------------------------</span>
0513 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0514     <span class="keyword">for</span> i = 1:length(valid_names)
0515         <span class="comment">% Focus the figure</span>
0516         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0517         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0518             figure(hff)
0519             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0520         <span class="keyword">end</span>
0521         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0522         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0523             figure(hff)
0524             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0525         <span class="keyword">end</span>
0526     <span class="keyword">end</span>
0527 <span class="keyword">end</span>
0528 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0529 
0530 
0531 <span class="comment">% --------------------------------------------------------------------</span>
0532 <a name="_sub20" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0533 <span class="comment">% Get the Application Data:</span>
0534 <span class="comment">% -------------------------</span>
0535 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0536 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0537 
0538 <span class="comment">% Update the Application Data:</span>
0539 <span class="comment">% ----------------------------</span>
0540 guiparams.renderer  = <span class="string">'painters'</span>;
0541 guiprefs.renderer   = <span class="string">'painters'</span>;
0542 
0543 <span class="comment">% Re-store the Application data:</span>
0544 <span class="comment">% ------------------------------</span>
0545 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0546 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0547 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0548 
0549 <span class="comment">% Update the GUI:</span>
0550 <span class="comment">% ---------------</span>
0551 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0552 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0553 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0554 
0555 <span class="comment">% Modify the existing figures</span>
0556 <span class="comment">% ---------------------------</span>
0557 <span class="comment">% Find what plots exist already</span>
0558 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0559 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0560 
0561 <span class="comment">% Loop through valid figures and adjust</span>
0562 <span class="comment">% -------------------------------------</span>
0563 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0564     <span class="keyword">for</span> i = 1:length(valid_names)
0565         <span class="comment">% Focus the figure</span>
0566         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0567         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0568             figure(hff)
0569             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0570         <span class="keyword">end</span>
0571         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0572         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0573             figure(hff)
0574             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0575         <span class="keyword">end</span>
0576     <span class="keyword">end</span>
0577 <span class="keyword">end</span>
0578 <span class="comment">% [EOF] menuPainters_Callback</span>
0579 
0580 <span class="comment">% --------------------------------------------------------------------</span>
0581 <a name="_sub21" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0582 <span class="comment">% Get the Application Data:</span>
0583 <span class="comment">% -------------------------</span>
0584 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0585 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0586 
0587 <span class="comment">% Update the Application Data:</span>
0588 <span class="comment">% ----------------------------</span>
0589 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0590 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0591 
0592 <span class="comment">% Re-store the Application data:</span>
0593 <span class="comment">% ------------------------------</span>
0594 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0595 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0596 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0597 
0598 <span class="comment">% Update the GUI:</span>
0599 <span class="comment">% ---------------</span>
0600 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0601 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0602 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0603 
0604 <span class="comment">% Modify the existing figures</span>
0605 <span class="comment">% ---------------------------</span>
0606 <span class="comment">% Find what plots exist already</span>
0607 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0608 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0609 
0610 <span class="comment">% Loop through valid figures and adjust</span>
0611 <span class="comment">% -------------------------------------</span>
0612 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0613     <span class="keyword">for</span> i = 1:length(valid_names)
0614         <span class="comment">% Focus the figure</span>
0615         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0616         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0617             figure(hff)
0618             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0619         <span class="keyword">end</span>
0620         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0621         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0622             figure(hff)
0623             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0624         <span class="keyword">end</span>
0625     <span class="keyword">end</span>
0626 <span class="keyword">end</span>
0627 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0628 
0629 <span class="comment">% --------------------------------------------------------------------</span>
0630 <a name="_sub22" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0631 <span class="comment">% Get the Application data:</span>
0632 <span class="comment">% -------------------------</span>
0633 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0634 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0635 
0636 <span class="comment">% Find what plots exist already</span>
0637 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0638 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0639 
0640 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0641 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0642 <span class="keyword">if</span> ~isempty(idx)
0643     fig_names(idx) = [];
0644 <span class="keyword">end</span>
0645 
0646 <span class="keyword">if</span> guiparams.presentation
0647     figure_style = <span class="string">'presentation'</span>;
0648 <span class="keyword">else</span>
0649     figure_style = <span class="string">'print'</span>;
0650 <span class="keyword">end</span>
0651 
0652 [selected_figures] = <a href="#_sub109" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0653 
0654 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0655     <span class="keyword">return</span>
0656 <span class="keyword">else</span>
0657     <span class="keyword">for</span> i = 1:length(selected_figures)
0658         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0659     <span class="keyword">end</span>
0660 <span class="keyword">end</span>
0661 
0662 
0663 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0664 
0665 <span class="comment">% --------------------------------------------------------------------</span>
0666 <a name="_sub23" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0667 <span class="comment">% Get the Application data:</span>
0668 <span class="comment">% -------------------------</span>
0669 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0670 beam_angle             = guiparams.beam_angle; 
0671 magnetic_variation     = guiparams.magnetic_variation; 
0672 wse                    = guiparams.water_surface_elevation;
0673 output_auxiliary_data  = guiparams.output_auxiliary_data;
0674 load_wse_tide_file     = guiparams.load_wse_tide_file;
0675 
0676 <span class="comment">% Open dialog and allow user to select settings</span>
0677 <span class="comment">% ---------------------------------------------</span>
0678 [beam_angle,<span class="keyword">...</span>
0679     magnetic_variation,<span class="keyword">...</span>
0680     wse,<span class="keyword">...</span>
0681     output_auxiliary_data,<span class="keyword">...</span>
0682     load_wse_tide_file] = <span class="keyword">...</span>
0683     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0684 
0685 <span class="comment">% Re-store the Application data:</span>
0686 <span class="comment">% ------------------------------</span>
0687 guiparams.beam_angle            = beam_angle;
0688 guiparams.magnetic_variation    = magnetic_variation; 
0689 guiparams.load_wse_tide_file    = load_wse_tide_file;
0690 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0691       infile = fullfile(<span class="keyword">...</span>
0692         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0693         guiparams.multibeambathymetry_file);
0694     [wsedata] = <a href="#_sub24" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0695     guiparams.water_surface_elevation = wsedata;
0696 <span class="keyword">else</span>
0697       guiparams.water_surface_elevation = wse;
0698 <span class="keyword">end</span>
0699 guiparams.output_auxiliary_data = output_auxiliary_data;
0700 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0701 
0702 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0703 
0704 <span class="comment">% --------------------------------------------------------------------</span>
0705 <a name="_sub24" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0706 <span class="comment">% wsedata.obstime</span>
0707 <span class="comment">% wsedata.elev</span>
0708 
0709 <span class="comment">% Determine Files to Process</span>
0710 <span class="comment">% Ask the user to select files:</span>
0711 <span class="comment">% -----------------------------</span>
0712 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0713     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0714     infile, <span class="keyword">...</span>
0715     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0716 
0717 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0718     data = csvread(fullfile(zPathName,zFileName));
0719     wsedata.obstime = datenum(data(:,1:6));
0720     wsedata.elev    = data(:,7);
0721 <span class="keyword">else</span>
0722     wsedata.obstime = [];
0723     wsedata.elev    = [];
0724     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0725 <span class="keyword">end</span>
0726 <span class="comment">%  [EOF] loadTideFile</span>
0727 
0728 <span class="comment">% --------------------------------------------------------------------</span>
0729 <a name="_sub25" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0730 <a href="#_sub67" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0731 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0732 
0733 
0734 <span class="comment">% --------------------------------------------------------------------</span>
0735 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0736 
0737 <span class="comment">% Get the Application Data:</span>
0738 <span class="comment">% -------------------------</span>
0739 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0740 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0741 PVdata    = guiparams.iric_anv_planview_data;
0742 iric_path = guiprefs.iric_path;
0743 iric_file = guiprefs.iric_file;
0744 
0745 <span class="comment">% Is there any planview data?</span>
0746 <span class="keyword">if</span> isempty(PVdata)
0747     <span class="comment">% Nothing to do, warn user</span>
0748     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0749     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0750 <span class="keyword">else</span>
0751     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0752     <span class="comment">% and smoothing (for iRiC)</span>
0753     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0754     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0755         fullfile(iric_path,iric_file));
0756     
0757     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0758         outfile = fullfile(iric_path,iric_file);
0759         log_text = vertcat(log_text,{outfile});
0760         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0761         outcount = fprintf(ofid,<span class="keyword">...</span>
0762             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0763         fclose(ofid);
0764     <span class="keyword">else</span>
0765         <span class="comment">% Return default iric_path and iric_file</span>
0766         iric_path = guiprefs.iric_path;
0767         iric_file = guiprefs.iric_file;
0768     <span class="keyword">end</span>
0769 <span class="keyword">end</span>
0770 
0771 <span class="comment">% Push messages to Log Window:</span>
0772 <span class="comment">% ----------------------------</span>
0773 statusLogging(handles.LogWindow, log_text)
0774 
0775 <span class="comment">% Store the persistent preferences:</span>
0776 <span class="comment">% ---------------------------------</span>
0777 guiprefs.iric_file = iric_file;
0778 guiprefs.iric_path = iric_path;
0779 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0780 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0781 
0782 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0783 
0784 <span class="comment">% --------------------------------------------------------------------</span>
0785 <a name="_sub27" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0786 <span class="comment">% Get the Application Data:</span>
0787 <span class="comment">% -------------------------</span>
0788 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0789 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0790 excel_path  = guiprefs.excel_path;
0791 excel_file  = guiprefs.excel_file;
0792 
0793 <span class="comment">% Push messages to Log Window:</span>
0794 <span class="comment">% ----------------------------</span>
0795 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0796 statusLogging(handles.LogWindow, log_text)
0797 
0798 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0799 <span class="comment">% data.</span>
0800 <span class="keyword">if</span> iscell(guiparams.mat_file)
0801     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0802     <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0803     <span class="comment">% Refresh the Application Data:</span>
0804     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0805     z           = guiparams.z;
0806     A           = guiparams.A;
0807     V           = guiparams.V;
0808     Map         = guiparams.Map;
0809     wse         = guiparams.water_surface_elevation;
0810     PVdata      = guiparams.iric_anv_planview_data;
0811     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0812         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0813     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0814         fullfile(excel_path,excel_file));
0815     
0816     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0817         outfile = fullfile(excel_path,excel_file);
0818         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0819         
0820     <span class="keyword">else</span>
0821         <span class="comment">% Return default excel_path and excel_file</span>
0822         excel_path = guiprefs.excel_path;
0823         excel_file = guiprefs.excel_file;
0824         outfile = fullfile(excel_path,excel_file);
0825         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0826     <span class="keyword">end</span>
0827     
0828     <span class="comment">% Delete the old file if it exists</span>
0829     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0830         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0831             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0832             <span class="string">'already exists. Overwriting file...'</span>});
0833         delete(outfile)
0834     <span class="keyword">end</span>
0835     
0836     <span class="comment">% Save MCS Summary to an Excel File</span>
0837     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0838     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0839     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0840     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0841         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0842         sout = guiparams.mat_file';
0843     <span class="keyword">end</span>
0844     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0845     sout = {<span class="keyword">...</span>
0846         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0847         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0848         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0849         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0850         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0851         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0852         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0853         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0854         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0855         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0856         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0857         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0858         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0859         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0860         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0861         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0862         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0863         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0864         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0865         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0866         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0867         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0868         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0869         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0870         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0871         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0872         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0873         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0874         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0875         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0876         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0877         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0878         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0879         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0880         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0881         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0882         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0883         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0884         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0885         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0886         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0887         };
0888     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0889     
0890     <span class="comment">% Save DAV data to an Excel File</span>
0891     vmin = num2str(guiparams.depth_range_min);
0892     vmax = num2str(guiparams.depth_range_max);
0893     pvheaders = {<span class="keyword">...</span>
0894         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0895         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0896         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0897         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0898 
0899     <span class="comment">% Initialize Variables</span>
0900     pvdata = []; Dist = []; ID = {};
0901     X = []; Y = []; E = []; T = [];
0902     Ve = []; Vn =[]; Vm = []; Vd = [];
0903     
0904     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0905     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0906         <span class="comment">% Load current MAT-file</span>
0907         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0908         
0909         <span class="comment">% Location, Time and Bathy</span>
0910         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0911         X = [X V.mcsX(1,:)];
0912         Y = [Y V.mcsY(1,:)];
0913         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0914         E = [E V.mcsBedElev];
0915         T = [T V.mcsTime(1,:)];
0916                 
0917         <span class="comment">% Build layer-averaged velocities</span>
0918         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0919         V.mcsX(indx,:) = nan;
0920         V.mcsY(indx,:) = nan;
0921         V.mcsEast(indx,:) = nan;
0922         V.mcsNorth(indx,:) = nan;
0923         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0924         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0925         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0926         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0927         
0928         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0929     <span class="keyword">end</span>
0930     
0931     <span class="comment">% Put output into 1 matrix</span>
0932     pvdata = [<span class="keyword">...</span>
0933         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0934         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0935         ];
0936     pvdata(isnan(pvdata)) = -9999;
0937     
0938     <span class="comment">% Create table and write to Excel</span>
0939     pvout = num2cell(pvdata');
0940     pvout = horzcat(ID,pvout);
0941     timestamp = cellstr(nandatestr(T));
0942     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0943     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0944     
0945     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0946     <span class="comment">% results</span>
0947     PVheaders = {<span class="keyword">...</span>
0948         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0949         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0950         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0951         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0952         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0953     PVtable = [<span class="keyword">...</span>
0954         PVdata.outmat(1,:);<span class="keyword">...</span>
0955         PVdata.outmat(2,:);<span class="keyword">...</span>
0956         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0957         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0958         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0959         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0960         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0961     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0962     PVtable(isnan(PVtable)) = -9999;
0963     PVout = horzcat(<span class="keyword">...</span>
0964         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0965         PVdata.outfile,<span class="keyword">...</span>
0966         num2cell(PVtable'));
0967     PVout = vertcat(PVheaders,PVout);
0968     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0969     
0970     <span class="comment">% Close out waitbar</span>
0971     waitbar(1,hwait)
0972     delete(hwait)
0973     
0974     <span class="comment">% Push messages to Log Window:</span>
0975     <span class="comment">% ----------------------------</span>
0976     statusLogging(handles.LogWindow, log_text)
0977 <span class="keyword">else</span>
0978     
0979     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0980     <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0981     <a href="#_sub63" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0982     <span class="comment">% Refresh the Application Data:</span>
0983     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0984     z           = guiparams.z;
0985     A           = guiparams.A;
0986     V           = guiparams.V;
0987     Map         = guiparams.Map;
0988     wse         = guiparams.water_surface_elevation;
0989     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0990                                                     <span class="comment">% Planview Plot exactly</span>
0991     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
0992                                  <span class="comment">% planview plot</span>
0993         
0994     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0995     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0996         fullfile(excel_path,excel_file));
0997     
0998     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0999         outfile = fullfile(excel_path,excel_file);
1000         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
1001         
1002         <span class="comment">% Delete the old file if it exists</span>
1003         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
1004             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
1005                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
1006                 <span class="string">'already exists. Overwriting file...'</span>});
1007             delete(outfile)
1008         <span class="keyword">end</span>
1009         
1010         <span class="comment">% Push messages to Log Window:</span>
1011         <span class="comment">% ----------------------------</span>
1012         statusLogging(handles.LogWindow, log_text)
1013         
1014         <span class="comment">% Save MCS Summary to an Excel File</span>
1015         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
1016         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
1017         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
1018         waitbar(1/5,hwait)
1019         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
1020             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
1021             sout = {guiparams.mat_file};
1022         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
1023             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
1024             sout = guiparams.data_files';
1025         <span class="keyword">end</span>
1026         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
1027         waitbar(2/7,hwait)
1028         sout = {<span class="keyword">...</span>
1029             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1030             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1031             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1032             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1033             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1034             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
1035             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
1036             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
1037             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
1038             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
1039             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1040             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1041             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1042             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1043             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1044             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1045             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1046             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
1047             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
1048             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
1049             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1050             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
1051             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
1052             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
1053             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
1054             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1055             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
1056             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1057             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1058             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
1059             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
1060             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
1061             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1062             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1063             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1064             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1065             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1066             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1067             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1068             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1069             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1070             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1071             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1072             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1073             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1074             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1075             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1076             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1077             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1078             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1079             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1080             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1081             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1082             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1083             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1084             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1085             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1086             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1087             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1088             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1089             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1090             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1091             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1092             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1093             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1094             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1095             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1096             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1097             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1098             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1099             };
1100         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1101         waitbar(3/7,hwait)
1102         
1103         <span class="comment">% Save DAV data to an Excel File</span>
1104         vmin = num2str(guiparams.depth_range_min);
1105         vmax = num2str(guiparams.depth_range_max);
1106         pvheaders = {<span class="keyword">...</span>
1107             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1108             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1109             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1110             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1111             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1112             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1113         
1114         <span class="comment">% Create block style matrix of all processed data</span>
1115         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1116         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1117         <span class="comment">% layer-averaging applied</span>
1118         pvdata = [];
1119         
1120         <span class="comment">% Stationing from LEFT bank</span>
1121         Dist = V.mcsDist;
1122         
1123         <span class="comment">% Build bathy data matrix</span>
1124         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1125         
1126         <span class="comment">% Build layer-averaged velocities</span>
1127         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1128         V.mcsX(indx,:) = nan;
1129         V.mcsY(indx,:) = nan;
1130         V.mcsEast(indx,:) = nan;
1131         V.mcsNorth(indx,:) = nan;
1132         pvdata = [<span class="keyword">...</span>
1133             pvdata;<span class="keyword">...</span>
1134             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1135             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1136             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1137             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1138         pvdata(isnan(pvdata)) = -9999;
1139         pvout = num2cell(pvdata');
1140         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1141         timestr = nandatestr(V.mcsTime(1,:));
1142         timestamp = cellstr(timestr);
1143         pvout = horzcat(timestamp,pvout);
1144         pvout = vertcat(pvheaders,pvout);
1145         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1146         waitbar(4/7,hwait)
1147         
1148         <span class="comment">% Save MCS data to an Excel File</span>
1149         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1150         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1151         MCSheaders = {<span class="keyword">...</span>
1152             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1153             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1154             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1155             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1156             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1157             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1158             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1159             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1160             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1161             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1162             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1163             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1164             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1165             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1166             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1167             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1168             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1169         
1170         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1171         MCSdata = [<span class="keyword">...</span>
1172             V.mcsX(:)<span class="keyword">...</span>
1173             V.mcsY(:)<span class="keyword">...</span>
1174             V.mcsDist(:)<span class="keyword">...</span>
1175             vectorized_bed(:)<span class="keyword">...</span>
1176             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1177             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1178             V.mcsEast(:)<span class="keyword">...</span>
1179             V.mcsNorth(:)<span class="keyword">...</span>
1180             V.mcsVert(:)<span class="keyword">...</span>
1181             V.mcsMag(:)<span class="keyword">...</span>
1182             V.mcsDir(:)<span class="keyword">...</span>
1183             V.u(:)<span class="keyword">...</span>
1184             V.v(:)<span class="keyword">...</span>
1185             V.vp(:)<span class="keyword">...</span>
1186             V.vs(:)<span class="keyword">...</span>
1187             V.Roz.up(:)<span class="keyword">...</span>
1188             V.Roz.us(:)];
1189         MCSdata(isnan(MCSdata)) = -9999;
1190         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1191         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1192         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1193         waitbar(5/7,hwait)
1194                 
1195         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1196         <span class="comment">% results</span>
1197         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1198         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1199         PVheaders = {<span class="keyword">...</span>
1200             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1201             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1202             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1203             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1204             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1205             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1206             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1207             <span class="string">'Vel_dir_deg'</span>};
1208         PVtable = [<span class="keyword">...</span>
1209             PVdata.outmat(1,:);<span class="keyword">...</span>
1210             PVdata.outmat(2,:);<span class="keyword">...</span>
1211             PVDist;<span class="keyword">...</span>
1212             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1213             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1214             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1215             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1216         PVtable = (sortrows(PVtable',3))';
1217         PVtable(isnan(PVtable)) = -9999;
1218         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1219         PVout = vertcat(PVheaders,PVout);
1220         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1221         waitbar(6/7,hwait)
1222         
1223         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1224         <span class="comment">% results</span>
1225         <span class="comment">% Distance is from the LEFT bank</span>
1226         <span class="comment">% Doesn't include the reference vector</span>
1227         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1228         dist    = guiparams.mcsQuivers(1:end-1,1);
1229         depth   = guiparams.mcsQuivers(1:end-1,2);
1230         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1231         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1232         
1233         <span class="comment">% Compute an UTM coordinate for the vector</span>
1234         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1235         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1236         
1237         <span class="comment">% Compute a Time for each vector</span>
1238         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1239         
1240         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1241         <span class="keyword">switch</span> guiparams.contour
1242             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1243                 wtp=[<span class="string">'V.uSmooth'</span>];
1244             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1245                 wtp=[<span class="string">'V.vSmooth'</span>];
1246             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1247                 wtp=[<span class="string">'V.wSmooth'</span>];
1248             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1249                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1250             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1251                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1252             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1253                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1254             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1255                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1256             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1257                 wtp=[<span class="string">'V.vpSmooth'</span>];
1258             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1259                 wtp=[<span class="string">'V.vsSmooth'</span>];
1260             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1261                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1262             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1263                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1264             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1265                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1266             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1267                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1268             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1269                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1270             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1271                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1272             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1273                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1274             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1275                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1276             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1277                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1278             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1279                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1280             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1281                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1282         <span class="keyword">end</span>
1283         Ucomp = eval(wtp);
1284         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1285         
1286         <span class="comment">% Save MCS data to an Excel File</span>
1287         <span class="comment">% This includes the smoothed data results from the plots.</span>
1288         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1289         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1290         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1291         mcsheaders = {<span class="keyword">...</span>
1292             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1293             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1294             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1295             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1296             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1297             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1298             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1299             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1300             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1301             };
1302         mcsdata = [<span class="keyword">...</span>
1303             pUTMx(:)<span class="keyword">...</span>
1304             pUTMy(:)<span class="keyword">...</span>
1305             dist(:)<span class="keyword">...</span>
1306             depth(:)<span class="keyword">...</span>
1307             ucomp(:)<span class="keyword">...</span>
1308             vcomp(:)<span class="keyword">...</span>
1309             wcomp(:)];
1310         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1311         ridx = ~isnan(ucomp);
1312         mcsdata = mcsdata(ridx,:);
1313         mcsdata(isnan(mcsdata)) = -9999;
1314         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1315         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1316         waitbar(7/7,hwait)
1317     <span class="keyword">else</span>
1318         <span class="comment">% Return default excel_path and excel_file</span>
1319         excel_path = guiprefs.excel_path;
1320         excel_file = guiprefs.excel_file;
1321         outfile = fullfile(excel_path,excel_file);
1322         log_text = {<span class="string">'User aborted Excel export...'</span>};
1323     <span class="keyword">end</span>
1324     
1325     
1326 waitbar(1,hwait)  
1327 delete(hwait)
1328 <span class="keyword">end</span>
1329 
1330 <span class="comment">% Push messages to Log Window:</span>
1331 <span class="comment">% ----------------------------</span>
1332 statusLogging(handles.LogWindow, log_text)
1333 
1334 <span class="comment">% Store the persistent preferences:</span>
1335 <span class="comment">% ---------------------------------</span>
1336 guiprefs.excel_file = excel_file;
1337 guiprefs.excel_path = excel_path;
1338 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1339 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1340 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1341 
1342 
1343 <span class="comment">% --------------------------------------------------------------------</span>
1344 <a name="_sub28" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1345 <span class="comment">% Call separate GUI</span>
1346 VMT_BuildCustomFlatFile;
1347 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1348 
1349 <span class="comment">% --------------------------------------------------------------------</span>
1350 <a name="_sub29" href="#_subfunctions" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a>
1351 <span class="comment">% Empty</span>
1352 
1353 <span class="comment">% --------------------------------------------------------------------</span>
1354 <a name="_sub30" href="#_subfunctions" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a>
1355 <span class="comment">% Empty</span>
1356 
1357 <span class="comment">% --------------------------------------------------------------------</span>
1358 <a name="_sub31" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1359 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1360 
1361 <span class="comment">% Get the Application Data:</span>
1362 <span class="comment">% -------------------------</span>
1363 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1364 
1365 <span class="comment">% Update the GUI &amp; Application Data:</span>
1366 <span class="comment">% ----------------------------------</span>
1367 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1368 <span class="keyword">switch</span> status
1369     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1370         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1371         guiparams.unit_discharge_correction = false;
1372     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1373         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1374         guiparams.unit_discharge_correction = true;
1375 <span class="keyword">end</span>
1376 
1377 <span class="comment">% Re-store the Application data:</span>
1378 <span class="comment">% ------------------------------</span>
1379 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1380 
1381 
1382 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1383 
1384 <span class="comment">% --------------------------------------------------------------------</span>
1385 <a name="_sub32" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1386 <span class="comment">% Empty</span>
1387 
1388 <span class="comment">% --------------------------------------------------------------------</span>
1389 <a name="_sub33" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1390 <span class="comment">% Empty</span>
1391 
1392 <span class="comment">% --------------------------------------------------------------------</span>
1393 <a name="_sub34" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1394 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1395 
1396 <span class="comment">% Get the Application Data:</span>
1397 <span class="comment">% -------------------------</span>
1398 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1399 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1400 
1401 <span class="comment">% Update the Application Data:</span>
1402 <span class="comment">% ----------------------------</span>
1403 guiparams.english_units = false;
1404 guiprefs.units = <span class="string">'metric'</span>;
1405 
1406 <span class="comment">% Re-store the Application data:</span>
1407 <span class="comment">% ------------------------------</span>
1408 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1409 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1410 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1411 
1412 <span class="comment">% Update the GUI:</span>
1413 <span class="comment">% ---------------</span>
1414 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1415 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1416 
1417 <span class="comment">% [EOF] menuMetric_Callback</span>
1418 
1419 
1420 <span class="comment">% --------------------------------------------------------------------</span>
1421 <a name="_sub35" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1422 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1423 
1424 <span class="comment">% Get the Application Data:</span>
1425 <span class="comment">% -------------------------</span>
1426 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1427 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1428 
1429 <span class="comment">% Update the Application Data:</span>
1430 <span class="comment">% ----------------------------</span>
1431 guiparams.english_units = true;
1432 guiprefs.units = <span class="string">'english'</span>;
1433 
1434 <span class="comment">% Re-store the Application data:</span>
1435 <span class="comment">% ------------------------------</span>
1436 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1437 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1438 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1439 
1440 <span class="comment">% Update the GUI:</span>
1441 <span class="comment">% ---------------</span>
1442 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1443 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1444 
1445 <span class="comment">% [EOF] menuEnglish_Callback</span>
1446 
1447 <span class="comment">% --------------------------------------------------------------------</span>
1448 <a name="_sub36" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1449 <span class="comment">% Empty</span>
1450 
1451 <span class="comment">% --------------------------------------------------------------------</span>
1452 <a name="_sub37" href="#_subfunctions" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a>
1453 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1454 <span class="comment">% surface)</span>
1455 
1456 <span class="comment">% Get the Application Data:</span>
1457 <span class="comment">% -------------------------</span>
1458 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1459 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1460 
1461 <span class="keyword">switch</span> guiparams.plotref
1462     <span class="keyword">case</span> <span class="string">'dfs'</span>  <span class="comment">% Depth from surface</span>
1463         <span class="comment">% Update the Application Data:</span>
1464         <span class="comment">% ----------------------------</span>
1465         guiparams.plotref = <span class="string">'dfs'</span>;
1466         guiprefs.plotref  = <span class="string">'dfs'</span>;
1467         
1468         <span class="comment">% Re-store the Application data:</span>
1469         <span class="comment">% ------------------------------</span>
1470         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1471         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1472         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1473         
1474         <span class="comment">% Update the GUI:</span>
1475         <span class="comment">% ---------------</span>
1476         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1477     <span class="keyword">case</span> <span class="string">'hab'</span> <span class="comment">% Height above bed</span>
1478         <span class="comment">% Update the Application Data:</span>
1479         <span class="comment">% ----------------------------</span>
1480         guiparams.plotref = <span class="string">'hab'</span>;
1481         guiprefs.plotref  = <span class="string">'hab'</span>;
1482         
1483         <span class="comment">% Re-store the Application data:</span>
1484         <span class="comment">% ------------------------------</span>
1485         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1486         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1487         <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1488         
1489         <span class="comment">% Update the GUI:</span>
1490         <span class="comment">% ---------------</span>
1491         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1492 <span class="keyword">end</span>
1493 <span class="comment">% [EOF] VerticalReference_Callback</span>
1494 
1495 
1496 <span class="comment">% --------------------------------------------------------------------</span>
1497 <a name="_sub38" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1498 <span class="comment">% Empty</span>
1499 
1500 <span class="comment">% --------------------------------------------------------------------</span>
1501 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1502 <span class="comment">% Set cross-section endpoints automatically</span>
1503 
1504 <span class="comment">% Get the Application Data:</span>
1505 <span class="comment">% -------------------------</span>
1506 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1507 
1508 <span class="comment">% Update the Application Data:</span>
1509 <span class="comment">% ----------------------------</span>
1510 guiparams.set_cross_section_endpoints = false;
1511 
1512 <span class="comment">% Re-store the Application data:</span>
1513 <span class="comment">% ------------------------------</span>
1514 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1515 
1516 <span class="comment">% Update the GUI:</span>
1517 <span class="comment">% ---------------</span>
1518 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1519 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1520 
1521 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1522 
1523 
1524 <span class="comment">% --------------------------------------------------------------------</span>
1525 <a name="_sub40" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1526 <span class="comment">% Set cross-section endpoints manually</span>
1527 
1528 <span class="comment">% Get the Application Data:</span>
1529 <span class="comment">% -------------------------</span>
1530 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1531 
1532 <span class="comment">% Update the Application Data:</span>
1533 <span class="comment">% ----------------------------</span>
1534 guiparams.set_cross_section_endpoints = true;
1535 
1536 <span class="comment">% Re-store the Application data:</span>
1537 <span class="comment">% ------------------------------</span>
1538 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1539 
1540 <span class="comment">% Update the GUI:</span>
1541 <span class="comment">% ---------------</span>
1542 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1543 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1544 
1545 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1546 
1547 
1548 
1549 
1550 <span class="comment">% --------------------------------------------------------------------</span>
1551 <a name="_sub41" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1552 <span class="comment">% Empty</span>
1553 
1554 <span class="comment">% --------------------------------------------------------------------</span>
1555 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1556 
1557 <span class="comment">% Get the Application Data:</span>
1558 <span class="comment">% -------------------------</span>
1559 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1560 
1561 <span class="comment">% Update the Application Data:</span>
1562 <span class="comment">% ----------------------------</span>
1563 guiparams.print        = true;
1564 guiparams.presentation = false;
1565 
1566 <span class="comment">% Re-store the Application data:</span>
1567 <span class="comment">% ------------------------------</span>
1568 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1569 
1570 <span class="comment">% Update the GUI:</span>
1571 <span class="comment">% ---------------</span>
1572 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1573 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1574 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1575 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1576 
1577 <span class="comment">% Modify the existing figures</span>
1578 <span class="comment">% ---------------------------</span>
1579 <span class="comment">% Find what plots exist already</span>
1580 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1581 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1582 
1583 <span class="comment">% Defaults for Print Stlye Figure</span>
1584 BkgdColor   = <span class="string">'white'</span>;
1585 AxColor     = <span class="string">'black'</span>;
1586 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1587 FntSize     = 14;
1588 
1589 <span class="comment">% Loop through valid figures and adjust</span>
1590 <span class="comment">% -------------------------------------</span>
1591 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1592     
1593     <span class="keyword">for</span> i = 1:length(valid_names)
1594         <span class="keyword">switch</span> valid_names{i}
1595             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1596                 <span class="comment">% Focus the figure</span>
1597                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1598                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1599                     figure(hff)
1600                     
1601                     <span class="comment">% Make the changes to figure</span>
1602                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1603                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1604                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1605                     set(gca,<span class="string">'Color'</span>,FigColor)
1606                     set(gca,<span class="string">'XColor'</span>,AxColor)
1607                     set(gca,<span class="string">'YColor'</span>,AxColor)
1608                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1609                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1610                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1611                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1612                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1613                         <span class="string">'YColor'</span>,AxColor);
1614                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1615                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1616                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1617                     
1618                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1619                     <span class="comment">% the file(s) and path for the data</span>
1620                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1621                     <span class="keyword">if</span> ~ismultiplot
1622                         filestr = guiparams.savefile;
1623                         wd = length(filestr);
1624                         hd = 1;
1625                     <span class="keyword">else</span>
1626                         <span class="comment">% Construct a filename</span>
1627                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1628                         wd        = max(cellfun(@length,filestr));
1629                         hd        = numel(filestr);
1630                             
1631                     <span class="keyword">end</span>
1632                     
1633                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1634                     disableMenuBar(hff)
1635                     set(fileinfotxt,<span class="keyword">...</span>
1636                         <span class="string">'string'</span>,filestr)
1637                     set(fileinfotxt,<span class="keyword">...</span>
1638                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1639                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1640                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1641                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1642                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1643                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1644                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1645                     
1646                 <span class="keyword">end</span>
1647             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1648                 <span class="comment">% Focus the figure</span>
1649                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1650                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1651                     figure(hff)
1652                     
1653                     <span class="comment">% Make the changes to figure</span>
1654                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1655                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1656                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1657                     set(gca,<span class="string">'Color'</span>,FigColor)
1658                     set(gca,<span class="string">'XColor'</span>,AxColor)
1659                     set(gca,<span class="string">'YColor'</span>,AxColor)
1660                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1661                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1662                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1663                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1664                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1665                         <span class="string">'YColor'</span>,AxColor);
1666                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1667                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1668                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1669                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1670                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1671                     
1672                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1673                     <span class="comment">% the file(s) and path for the data</span>
1674                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1675                     <span class="keyword">if</span> ~ismultiplot
1676                         filestr = guiparams.savefile;
1677                         wd = length(filestr);
1678                         hd = 1;
1679                     <span class="keyword">else</span>
1680                         <span class="comment">% Construct a filename</span>
1681                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1682                         wd        = max(cellfun(@length,filestr));
1683                         hd        = numel(filestr);
1684                             
1685                     <span class="keyword">end</span>
1686                     
1687                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1688                     disableMenuBar(hff)
1689                     set(fileinfotxt,<span class="keyword">...</span>
1690                         <span class="string">'string'</span>,filestr)
1691                     set(fileinfotxt,<span class="keyword">...</span>
1692                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1693                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1694                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1695                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1696                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1697                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1698                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1699                 <span class="keyword">end</span>
1700             <span class="keyword">otherwise</span>
1701         <span class="keyword">end</span>
1702     <span class="keyword">end</span>
1703     
1704     
1705 <span class="keyword">end</span>
1706 
1707 
1708 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1709 
1710 
1711 <span class="comment">% --------------------------------------------------------------------</span>
1712 <a name="_sub43" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1713 <span class="comment">% Get the Application Data:</span>
1714 <span class="comment">% -------------------------</span>
1715 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1716 
1717 <span class="comment">% Update the Application Data:</span>
1718 <span class="comment">% ----------------------------</span>
1719 guiparams.print        = false;
1720 guiparams.presentation = true;
1721 
1722 <span class="comment">% Re-store the Application data:</span>
1723 <span class="comment">% ------------------------------</span>
1724 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1725 
1726 <span class="comment">% Update the GUI:</span>
1727 <span class="comment">% ---------------</span>
1728 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1729 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1730 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1731 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1732 
1733 <span class="comment">% Modify the existing figures</span>
1734 <span class="comment">% ---------------------------</span>
1735 <span class="comment">% Find what plots exist already</span>
1736 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1737 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1738 
1739 <span class="comment">% Defaults for Presentation Style Figure</span>
1740 <span class="comment">% --------------------------------------</span>
1741 BkgdColor   = <span class="string">'black'</span>;
1742 AxColor     = <span class="string">'white'</span>;
1743 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1744 FntSize     = 14;
1745 
1746 <span class="comment">% Loop through valid figures and adjust</span>
1747 <span class="comment">% -------------------------------------</span>
1748 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1749     
1750     <span class="keyword">for</span> i = 1:length(valid_names)
1751         <span class="keyword">switch</span> valid_names{i}
1752             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1753                 <span class="comment">% Focus the figure</span>
1754                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1755                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1756                     figure(hff)
1757                     
1758                     <span class="comment">% Make the changes to figure</span>
1759                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1760                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1761                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1762                     set(gca,<span class="string">'Color'</span>,FigColor)
1763                     set(gca,<span class="string">'XColor'</span>,AxColor)
1764                     set(gca,<span class="string">'YColor'</span>,AxColor)
1765                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1766                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1767                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1768                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1769                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1770                         <span class="string">'YColor'</span>,AxColor);
1771                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1772                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1773                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1774                     
1775                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1776                     <span class="comment">% the file(s) and path for the data</span>
1777                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1778                     <span class="keyword">if</span> ~ismultiplot
1779                         filestr = guiparams.savefile;
1780                         wd = length(filestr);
1781                         hd = 1;
1782                     <span class="keyword">else</span>
1783                         <span class="comment">% Construct a filename</span>
1784                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1785                         wd        = max(cellfun(@length,filestr));
1786                         hd        = numel(filestr);
1787                             
1788                     <span class="keyword">end</span>
1789                     
1790                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1791                     disableMenuBar(hff)
1792                     set(fileinfotxt,<span class="keyword">...</span>
1793                         <span class="string">'string'</span>,filestr)
1794                     set(fileinfotxt,<span class="keyword">...</span>
1795                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1796                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1797                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1798                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1799                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1800                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1801                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1802                     
1803                 <span class="keyword">end</span>
1804             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1805                 <span class="comment">% Focus the figure</span>
1806                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1807                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1808                     figure(hff)
1809                     
1810                     <span class="comment">% Make the changes to figure</span>
1811                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1812                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1813                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1814                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1815                     set(gca,<span class="string">'XColor'</span>,AxColor)
1816                     set(gca,<span class="string">'YColor'</span>,AxColor)
1817                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1818                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1819                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1820                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1821                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1822                         <span class="string">'YColor'</span>,AxColor);
1823                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1824                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1825                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1826                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1827                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1828                     
1829                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1830                     <span class="comment">% the file(s) and path for the data</span>
1831                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1832                     <span class="keyword">if</span> ~ismultiplot
1833                         filestr = guiparams.savefile;
1834                         wd = length(filestr);
1835                         hd = 1;
1836                     <span class="keyword">else</span>
1837                         <span class="comment">% Construct a filename</span>
1838                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1839                         wd        = max(cellfun(@length,filestr));
1840                         hd        = numel(filestr);
1841                             
1842                     <span class="keyword">end</span>
1843                     
1844                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1845                     disableMenuBar(hff)
1846                     set(fileinfotxt,<span class="keyword">...</span>
1847                         <span class="string">'string'</span>,filestr)
1848                     set(fileinfotxt,<span class="keyword">...</span>
1849                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1850                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1851                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1852                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1853                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1854                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1855                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1856                 <span class="keyword">end</span>
1857             <span class="keyword">otherwise</span>
1858         <span class="keyword">end</span>
1859     <span class="keyword">end</span>
1860     
1861     
1862 <span class="keyword">end</span>
1863 
1864 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1865 
1866 <span class="comment">% --------------------------------------------------------------------</span>
1867 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1868 <span class="comment">%</span>
1869 <span class="comment">% % Get the Application data:</span>
1870 <span class="comment">% % -------------------------</span>
1871 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1872 <span class="comment">%</span>
1873 <span class="comment">% % Initialize the answer:</span>
1874 <span class="comment">% % ----------------------</span>
1875 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1876 <span class="comment">% answer = NaN;</span>
1877 <span class="comment">% while isnan(answer)</span>
1878 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1879 <span class="comment">%</span>
1880 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1881 <span class="comment">%         return</span>
1882 <span class="comment">%     end</span>
1883 <span class="comment">%</span>
1884 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1885 <span class="comment">%     % A numeric char will be a double</span>
1886 <span class="comment">% end</span>
1887 <span class="comment">%</span>
1888 <span class="comment">% % Re-store the Application data:</span>
1889 <span class="comment">% % ------------------------------</span>
1890 <span class="comment">% guiparams.vertical_offset = answer;</span>
1891 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1892 <span class="comment">%</span>
1893 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1894 
1895 <span class="comment">% --------------------------------------------------------------------</span>
1896 <a name="_sub44" href="#_subfunctions" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a>
1897 <span class="comment">% Get the Application Data:</span>
1898 <span class="comment">% -------------------------</span>
1899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1900 
1901 <span class="comment">% Open the Advanced Settings SubGUI</span>
1902 <span class="comment">%----------------------------------</span>
1903 AdvancedSettings_subgui();
1904 uiwait(findobj(<span class="string">'Name'</span>,<span class="string">'Advanced Settings'</span>));
1905 
1906 <span class="comment">% Get the data back from the Advanced Settings SubGUI</span>
1907 <span class="comment">% and store them back in the VMT memory</span>
1908 <span class="comment">%----------------------------------------------------</span>
1909 guiparams = getpref(<span class="string">'VMTadvancedsettings'</span>,<span class="string">'guiparams'</span>);
1910 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1911 
1912 <span class="comment">% Process Vertical Reference Changes</span>
1913 <a href="#_sub37" class="code" title="subfunction VerticalReference_Callback(hObject, eventdata, handles)">VerticalReference_Callback</a>(hObject, eventdata, handles)
1914 
1915 
1916 
1917 <span class="comment">% --------------------------------------------------------------------</span>
1918 <a name="_sub45" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1919 <span class="comment">% Not implemented</span>
1920 
1921 <span class="comment">% --------------------------------------------------------------------</span>
1922 <a name="_sub46" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1923 <span class="comment">% Empty</span>
1924 
1925 <span class="comment">% --------------------------------------------------------------------</span>
1926 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1927 ASCII2GIS_GUI
1928 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1929 
1930 <span class="comment">% --------------------------------------------------------------------</span>
1931 <a name="_sub48" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1932 
1933 <span class="comment">% Get the Application preferences:</span>
1934 <span class="comment">% --------------------------------</span>
1935 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1936 
1937 inpath = guiprefs.kmz_path;
1938 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1939     infile = guiprefs.kmz_file{1};
1940 <span class="keyword">else</span>
1941     infile = guiprefs.kmz_file;
1942 <span class="keyword">end</span>
1943 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1944 
1945 guiprefs.kmz_path = outpath;
1946 guiprefs.kmz_file = outfile;
1947 
1948 <span class="comment">% Update persistent preferences</span>
1949 <span class="comment">% -----------------------------</span>
1950 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1951 
1952 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1953 
1954 <span class="comment">% --------------------------------------------------------------------</span>
1955 <a name="_sub49" href="#_subfunctions" class="code">function menuSonTekMAT2KML_Callback(hObject, eventdata, handles)</a>
1956 SontekMAT2KML;
1957 <span class="comment">% [EOF] menuSonTekMAT2KML_Callback</span>
1958 
1959 <span class="comment">% --------------------------------------------------------------------</span>
1960 <a name="_sub50" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1961 <span class="comment">% Get the Application preferences:</span>
1962 <span class="comment">% --------------------------------</span>
1963 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1964 
1965 VMT_BatchMode;
1966 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1967 
1968 <span class="comment">% --------------------------------------------------------------------</span>
1969 <a name="_sub51" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1970 <span class="comment">% Empty</span>
1971 
1972 <span class="comment">% --------------------------------------------------------------------</span>
1973 <a name="_sub52" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1974 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1975 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1976     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1977     
1978 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1979     
1980     <span class="keyword">if</span> isdeployed
1981         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1982             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1983         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1984             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1985             errLogFileName},<span class="keyword">...</span>
1986             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1987             <span class="string">'error'</span>);
1988         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1989         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1990         fclose(fid);
1991         rethrow(err)
1992     <span class="keyword">else</span>
1993         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1994             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1995             <span class="string">'error'</span>);
1996         rethrow(err);
1997     <span class="keyword">end</span>
1998 <span class="keyword">end</span>
1999 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
2000 
2001 <span class="comment">% --------------------------------------------------------------------</span>
2002 <a name="_sub53" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
2003 <span class="comment">% Get the Application data:</span>
2004 <span class="comment">% -------------------------</span>
2005 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
2006 
2007 <span class="keyword">try</span>
2008     open([pwd filesep <span class="string">'/doc/index.html'</span>])
2009 
2010 
2011 <span class="comment">% This catch is probably not necessary.</span>
2012 <span class="keyword">catch</span> err 
2013     <span class="keyword">if</span> isdeployed
2014         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
2015             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
2016         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
2017             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
2018             errLogFileName},<span class="keyword">...</span>
2019             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2020             <span class="string">'error'</span>);
2021         fid = fopen(errLogFileName,<span class="string">'W'</span>);
2022         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
2023         fclose(fid);
2024         rethrow(err)
2025     <span class="keyword">else</span>
2026         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
2027             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2028             <span class="string">'error'</span>);
2029         rethrow(err);
2030     <span class="keyword">end</span>
2031 <span class="keyword">end</span>
2032 
2033 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
2034 
2035 <span class="comment">% --------------------------------------------------------------------</span>
2036 <a name="_sub54" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
2037 
2038 <span class="comment">% Get the Application data:</span>
2039 <span class="comment">% -------------------------</span>
2040 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2041 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2042 
2043 <span class="comment">% Check version tag against the web, and display a message</span>
2044 <span class="keyword">try</span>
2045     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
2046     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
2047     <span class="keyword">if</span> length(webdata) &gt; 5
2048         current_vmt_version{1} = webdata(1:5);
2049         current_vmt_version{2} = webdata(8:16);
2050     <span class="keyword">else</span>
2051         current_vmt_version = webdata;
2052     <span class="keyword">end</span>
2053     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
2054 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
2055     <span class="keyword">if</span> isdeployed
2056         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
2057             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
2058         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
2059             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
2060             errLogFileName},<span class="keyword">...</span>
2061             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2062             <span class="string">'error'</span>);
2063         fid = fopen(errLogFileName,<span class="string">'W'</span>);
2064         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
2065         fclose(fid);
2066         rethrow(err)
2067     <span class="keyword">else</span>
2068         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
2069             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
2070             <span class="string">'error'</span>);
2071         rethrow(err);
2072     <span class="keyword">end</span>
2073 <span class="keyword">end</span>
2074 
2075 <span class="keyword">if</span> ischar(current_vmt_version)
2076     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2077         h = msgbox(<span class="keyword">...</span>
2078             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2079             <span class="string">''</span>;<span class="keyword">...</span>
2080             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2081             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2082     <span class="keyword">else</span>
2083         h = msgbox(<span class="keyword">...</span>
2084             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2085             <span class="string">''</span>;<span class="keyword">...</span>
2086             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2087             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2088     <span class="keyword">end</span>
2089 <span class="keyword">elseif</span> iscell(current_vmt_version)
2090     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2091         h = msgbox(<span class="keyword">...</span>
2092             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2093             <span class="string">''</span>;<span class="keyword">...</span>
2094             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2095             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2096     <span class="keyword">else</span>
2097         h = msgbox(<span class="keyword">...</span>
2098             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2099             <span class="string">''</span>;<span class="keyword">...</span>
2100             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2101             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2102     <span class="keyword">end</span>
2103 <span class="keyword">end</span>
2104 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2105 
2106 <span class="comment">% --------------------------------------------------------------------</span>
2107 <a name="_sub55" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2108 
2109 <span class="comment">% Get the Application data:</span>
2110 <span class="comment">% -------------------------</span>
2111 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2112 messagestr = <span class="keyword">...</span>
2113     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2114     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2115     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2116     <span class="string">''</span>;<span class="keyword">...</span>
2117     <span class="string">''</span>;<span class="keyword">...</span>
2118     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2119     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2120     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2121     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2122     <span class="string">''</span>;<span class="keyword">...</span>
2123     <span class="string">''</span>;<span class="keyword">...</span>
2124     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2125     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2126     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2127     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2128     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2129     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2130     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2131 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2132 <span class="comment">% [EOF] menuAbout_Callback</span>
2133 
2134 
2135 
2136 
2137 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2138 <span class="comment">% TOOLBAR CALLBACKS %</span>
2139 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2140 
2141 <span class="comment">% --------------------------------------------------------------------</span>
2142 <a name="_sub56" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2143 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
2144 <span class="comment">% Read Files into Data Structure using tfile.</span>
2145 
2146 <span class="comment">% Get the Application data:</span>
2147 <span class="comment">% -------------------------</span>
2148 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2149 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2150 
2151 <span class="comment">% Ask the user to select files:</span>
2152 <span class="comment">% -----------------------------</span>
2153 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2154 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2155     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2156     current_file, <span class="keyword">...</span>
2157     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2158 
2159 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2160     guiparams.data_folder = pathname;
2161     <span class="keyword">if</span> ischar(filename)
2162         filename = {filename};
2163     <span class="keyword">end</span>
2164     guiparams.data_files = filename;
2165     guiparams.mat_file = <span class="string">''</span>;
2166     
2167     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2168     
2169    
2170     
2171     <span class="comment">% Update the preferences:</span>
2172     <span class="comment">% -----------------------</span>
2173     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2174     guiprefs.ascii_path = pathname;
2175     guiprefs.ascii_file = filename;
2176     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2177     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2178     
2179     <span class="comment">% Push messages to Log Window:</span>
2180     <span class="comment">% ----------------------------</span>
2181     log_text = {<span class="keyword">...</span>
2182         <span class="string">''</span>;<span class="keyword">...</span>
2183         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2184         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2185         guiparams.data_folder;
2186         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2187         char(filename)};
2188     statusLogging(handles.LogWindow, log_text)
2189     
2190     <span class="comment">% Read the file(s)</span>
2191     <span class="comment">% ----------------</span>
2192     [~,~,savefile,A,z] = <span class="keyword">...</span>
2193         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2194     guiparams.savefile = savefile;
2195     guiparams.A        = A;
2196     guiparams.z        = z;
2197     
2198     
2199     <span class="comment">% Set the vertical grid node spacing</span>
2200     <span class="comment">% ----------------------------------</span>
2201     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2202     <span class="comment">% Backwards compatible</span>
2203     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2204         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2205         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2206     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2207         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2208         guiparams.vertical_grid_node_spacing = 0.4;
2209     <span class="keyword">end</span>
2210     
2211     
2212     <span class="comment">% Save application data</span>
2213     <span class="comment">% ---------------------</span>
2214     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2215        
2216 <span class="comment">%</span>
2217 <span class="comment">%     % Preprocess the data:</span>
2218 <span class="comment">%     % --------------------</span>
2219 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2220 <span class="comment">%</span>
2221 <span class="comment">%     % Push messages to Log Window:</span>
2222 <span class="comment">%     % ----------------------------</span>
2223 <span class="comment">%     log_text = {...</span>
2224 <span class="comment">%         '   Preprocessing complete.';...</span>
2225 <span class="comment">%         '   Begin Data Processing...'};</span>
2226 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2227 <span class="comment">%</span>
2228 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2229 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2230 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2231 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2232 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2233 <span class="comment">%</span>
2234 <span class="comment">%     % Push messages to Log Window:</span>
2235 <span class="comment">%     % ----------------------------</span>
2236 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2237 <span class="comment">%</span>
2238 <span class="comment">%     % Store the data:</span>
2239 <span class="comment">%     % ---------------</span>
2240 <span class="comment">%     guiparams.z = z;</span>
2241 <span class="comment">%     guiparams.A = A;</span>
2242 <span class="comment">%     guiparams.V = V;</span>
2243 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2244     
2245           
2246     <span class="comment">% Update the GUI:</span>
2247     <span class="comment">% ---------------</span>
2248     <a href="#_sub99" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2249     
2250     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2251     
2252 <span class="keyword">end</span>
2253 <span class="comment">% [EOF] loadDataCallback</span>
2254 
2255 
2256 
2257 <span class="comment">% --------------------------------------------------------------------</span>
2258 <a name="_sub57" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2259 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2260 
2261 <span class="comment">% Get the Application data:</span>
2262 <span class="comment">% -------------------------</span>
2263 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2264 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2265 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2266 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2267 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2268 
2269 [the_file,the_path] = <span class="keyword">...</span>
2270     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2271     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2272     fullfile(guiparams.mat_path,guiparams.savefile));
2273 
2274 <span class="comment">% Save the processed data to a MAT file:</span>
2275 <span class="comment">% --------------------------------------</span>
2276 <span class="keyword">if</span> ischar(the_file)
2277     guiparams.mat_path = the_path;
2278     guiparams.mat_file = the_file;
2279     guiparams.savefile = the_file;
2280     
2281     <span class="comment">% Re-store the Application data:</span>
2282     <span class="comment">% ------------------------------</span>
2283     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2284     
2285     <span class="comment">% Update the preferences:</span>
2286     <span class="comment">% -----------------------</span>
2287     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2288     guiprefs.mat_path = the_path;
2289     guiprefs.mat_file = the_file;
2290     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2291     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2292     
2293     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2294     savefile = fullfile(pathstr,[filename extension]);
2295     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2296     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2297     log_text = {<span class="keyword">...</span>
2298         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2299         savefile};
2300     statusLogging(handles.LogWindow,log_text)
2301     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2302 <span class="keyword">end</span>
2303 
2304 <span class="comment">% [EOF] saveDataCallback</span>
2305 
2306 
2307 <span class="comment">% --------------------------------------------------------------------</span>
2308 <a name="_sub58" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2309 
2310 <span class="comment">% Get the Application data:</span>
2311 <span class="comment">% -------------------------</span>
2312 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2313 z   = guiparams.z;
2314 A   = guiparams.A;
2315 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2316 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2317 
2318 <span class="comment">% Compute multibeam bathymetry:</span>
2319 <span class="comment">% -----------------------------</span>
2320 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2321 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2322 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2323     guiparams.beam_angle, <span class="keyword">...</span>
2324     guiparams.magnetic_variation, <span class="keyword">...</span>
2325     guiparams.water_surface_elevation, <span class="keyword">...</span>
2326     guiparams.output_auxiliary_data);
2327 
2328 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2329 
2330 <span class="comment">% [EOF] saveBathymetryCallback</span>
2331 
2332 <span class="comment">% --------------------------------------------------------------------</span>
2333 <a name="_sub59" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2334 
2335 <span class="comment">% Get the Application data:</span>
2336 <span class="comment">% -------------------------</span>
2337 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2338 
2339 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2340     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2341     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2342     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2343     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2344     handles.figure1);
2345 
2346 <span class="comment">% Update the GUI:</span>
2347 <span class="comment">% ---------------</span>
2348 <span class="keyword">if</span> guiparams.english_units
2349     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2350     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2351 <span class="keyword">else</span>
2352     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2353     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2354 <span class="keyword">end</span>
2355 
2356 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2357     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2358     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2359 <span class="keyword">else</span>
2360     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2361     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2362 <span class="keyword">end</span>
2363 
2364 <span class="keyword">if</span> guiparams.presentation
2365     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2366 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2367 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2368 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2369 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2370 <span class="keyword">else</span>
2371     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2372 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2373 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2374 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2375 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2376 <span class="keyword">end</span>
2377 
2378 <span class="comment">% Re-store the Application data:</span>
2379 <span class="comment">% ------------------------------</span>
2380 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2381 
2382 <span class="comment">% [EOF] plottingParametersCallback</span>
2383 
2384 
2385 <span class="comment">% --------------------------------------------------------------------</span>
2386 <a name="_sub60" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2387 
2388 <span class="comment">% Get the Application data:</span>
2389 <span class="comment">% -------------------------</span>
2390 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2391 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2392 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2393 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2394 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2395 
2396 <span class="comment">% [EOF] processingParametersCallback</span>
2397 
2398 
2399 <span class="comment">% --------------------------------------------------------------------</span>
2400 <a name="_sub61" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2401 <span class="comment">% Plot 1</span>
2402 
2403 <span class="comment">% Get the Application data:</span>
2404 <span class="comment">% -------------------------</span>
2405 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2406 z = guiparams.z;
2407 A = guiparams.A;
2408 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2409 <span class="comment">% Map = guiparams.Map;</span>
2410 
2411 
2412 <span class="comment">% Preprocess the data:</span>
2413 <span class="comment">% --------------------</span>
2414 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2415 
2416 <span class="comment">% Push messages to Log Window:</span>
2417 <span class="comment">% ----------------------------</span>
2418 log_text = {<span class="keyword">...</span>
2419     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2420     <span class="string">'   Begin Data Processing...'</span>};
2421 statusLogging(handles.LogWindow, log_text)
2422 
2423 <span class="comment">% Process the transects:</span>
2424 <span class="comment">% ----------------------</span>
2425 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2426 A(1).vgns = guiparams.vertical_grid_node_spacing;
2427 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2428 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2429     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2430 
2431 <span class="comment">% Compute the smoothed variables</span>
2432 <span class="comment">% ------------------------------</span>
2433 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2434 <span class="comment">% runtime.</span>
2435 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2436     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2437     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2438     guiparams.vertical_smoothing_window);
2439 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2440 
2441 <span class="comment">% Push messages to Log Window:</span>
2442 <span class="comment">% ----------------------------</span>
2443 statusLogging(handles.LogWindow, processing_log_text)
2444 
2445 <span class="comment">% Store the data:</span>
2446 <span class="comment">% ---------------</span>
2447 guiparams.z = z;
2448 guiparams.A = A;
2449 guiparams.V = V;
2450 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2451 
2452 <span class="comment">% Push messages to Log Window:</span>
2453 <span class="comment">% ----------------------------</span>
2454 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2455 statusLogging(handles.LogWindow, log_text)
2456 
2457 <span class="comment">% Create or replot the Shiptracks</span>
2458 <span class="comment">% -------------------------------</span>
2459 <span class="comment">% Grab the axes to the plot</span>
2460 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2461 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2462 
2463 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2464 <span class="comment">% New plot display window</span>
2465 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2466 <span class="comment">% h = figure(1); clf</span>
2467 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2468 
2469 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2470 
2471 
2472 <span class="comment">% --------------------------------------------------------------------</span>
2473 <a name="_sub62" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2474 <span class="comment">% Plot 2</span>
2475 
2476 <span class="comment">% Get the Application data:</span>
2477 <span class="comment">% -------------------------</span>
2478 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2479 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2480 
2481 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2482     <span class="comment">% Push messages to Log Window:</span>
2483     <span class="comment">% ----------------------------</span>
2484     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2485     statusLogging(handles.LogWindow, log_text)
2486     
2487        
2488     <span class="comment">% Push plotting parameters to log window:</span>
2489     <span class="comment">% ---------------------------------------</span>
2490     log_text = {<span class="keyword">...</span>
2491         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2492         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2493         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2494         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2495         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2496         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2497         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2498         };
2499     statusLogging(handles.LogWindow, log_text)
2500     
2501     <span class="comment">% Plot the data:</span>
2502     <span class="comment">% --------------</span>
2503     z = [];
2504     A = [];
2505     V = [];
2506     Map = [];
2507     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2508     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2509         depth_range, <span class="keyword">...</span>
2510         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2511         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2512         guiparams.smoothing_window_size, <span class="keyword">...</span>
2513         guiparams.display_shoreline, <span class="keyword">...</span>
2514         guiparams.english_units, <span class="keyword">...</span>
2515         guiparams.mat_file, <span class="keyword">...</span>
2516         guiparams.mat_path, <span class="keyword">...</span>
2517         guiparams.plotref); <span class="comment">% PLOT2</span>
2518     statusLogging(handles.LogWindow, log_text)
2519     
2520     <span class="comment">% Plot a Shoreline Map:</span>
2521     <span class="comment">% ---------------------</span>
2522     <span class="keyword">if</span> guiparams.display_shoreline
2523         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2524             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2525             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2526             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2527         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2528             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2529             Map.UTMe   = mapdata(:,1);
2530             Map.UTMn   = mapdata(:,2);
2531             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2532             <span class="comment">%Map.UTMzone = zone;</span>
2533         <span class="keyword">else</span>
2534             Map = [];
2535         <span class="keyword">end</span>
2536         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2537         log_text = {<span class="keyword">...</span>
2538             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2539             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2540             };
2541         statusLogging(handles.LogWindow, log_text)
2542     <span class="keyword">else</span>
2543         Map = [];
2544     <span class="keyword">end</span>
2545     
2546 <span class="keyword">else</span>
2547     z = guiparams.z;
2548     A = guiparams.A;
2549     <span class="comment">% V = guiparams.V;</span>
2550     Map = guiparams.Map;
2551     
2552     <span class="comment">% Push messages to Log Window:</span>
2553     <span class="comment">% ----------------------------</span>
2554     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2555     statusLogging(handles.LogWindow, log_text)
2556     
2557         
2558     <span class="comment">% Preprocess the data:</span>
2559     <span class="comment">% --------------------</span>
2560     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2561     
2562     <span class="comment">% Process the transects:</span>
2563     <span class="comment">% ----------------------</span>
2564     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2565     A(1).vgns = guiparams.vertical_grid_node_spacing;
2566     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2567     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2568     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2569     
2570     <span class="comment">% Compute the smoothed variables</span>
2571     <span class="comment">% ------------------------------</span>
2572     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2573     <span class="comment">% runtime.</span>
2574     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2575         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2576         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2577         guiparams.vertical_smoothing_window);
2578     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2579     
2580     <span class="comment">% Push messages to Log Window:</span>
2581     <span class="comment">% ----------------------------</span>
2582     statusLogging(handles.LogWindow, processing_log_text)
2583     
2584     <span class="comment">% Plot the cross section:</span>
2585     <span class="comment">% -----------------------</span>
2586     log_text = {<span class="keyword">...</span>
2587         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2588         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2589         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2590         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2591         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2592         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2593         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2594         };
2595     statusLogging(handles.LogWindow, log_text)
2596     
2597     <span class="comment">% Plot the data:</span>
2598     <span class="comment">% --------------</span>
2599     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2600     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2601     
2602     
2603     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2604         depth_range, <span class="keyword">...</span>
2605         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2606         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2607         guiparams.smoothing_window_size, <span class="keyword">...</span>
2608         guiparams.display_shoreline, <span class="keyword">...</span>
2609         guiparams.english_units, <span class="keyword">...</span>
2610         guiparams.mat_file, <span class="keyword">...</span>
2611         guiparams.mat_path, <span class="keyword">...</span>
2612         guiparams.plotref); <span class="comment">% PLOT2</span>
2613     statusLogging(handles.LogWindow, log_text)
2614     
2615     <span class="comment">% Plot User Set Endpoints</span>
2616     <span class="comment">% -----------------------</span>
2617     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2618         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2619         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2620         x = data(:,1);
2621         y = data(:,2);
2622         
2623         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2624         figure(fh); hold on
2625         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2626         hold off
2627     <span class="keyword">end</span>
2628     
2629     <span class="comment">% Plot a Shoreline Map:</span>
2630     <span class="comment">% ---------------------</span>
2631     <span class="keyword">if</span> guiparams.display_shoreline
2632         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2633             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2634             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2635             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2636         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2637             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2638             Map.UTMe   = mapdata(:,1);
2639             Map.UTMn   = mapdata(:,2);
2640             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2641             <span class="comment">%Map.UTMzone = zone;</span>
2642         <span class="keyword">else</span>
2643             Map = [];
2644         <span class="keyword">end</span>
2645         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2646         log_text = {<span class="keyword">...</span>
2647             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2648             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2649             };
2650         statusLogging(handles.LogWindow, log_text)
2651     <span class="keyword">else</span>
2652         Map = [];
2653     <span class="keyword">end</span>
2654     
2655 <span class="keyword">end</span>
2656 
2657 <span class="keyword">if</span> guiparams.add_background
2658     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2659     statusLogging(handles.LogWindow, log_text)
2660 <span class="keyword">end</span>
2661 
2662 <span class="comment">% Update guiparams</span>
2663 <span class="comment">% ----------------</span>
2664 guiparams.z   = z;
2665 guiparams.A   = A;
2666 guiparams.V   = V;
2667 guiparams.Map = Map;
2668 guiparams.iric_anv_planview_data = PVdata;
2669 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2670 
2671 <span class="comment">% Update preferences</span>
2672 <span class="comment">% ------------------</span>
2673 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2674 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2675 <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2676 
2677 <span class="comment">% Force plot to be formated properly</span>
2678 <span class="comment">% ----------------------------------</span>
2679 <span class="keyword">if</span> guiparams.presentation
2680     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2681 <span class="keyword">else</span>
2682     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2683 <span class="keyword">end</span>
2684 <span class="keyword">switch</span> guiparams.renderer
2685     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2686         <a href="#_sub19" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2687     <span class="keyword">case</span> <span class="string">'painters'</span>
2688         <a href="#_sub20" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2689     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2690         <a href="#_sub21" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2691 <span class="keyword">end</span>
2692 
2693 <span class="comment">% Focus the figure</span>
2694 <span class="comment">% ----------------</span>
2695 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2696 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2697     figure(hff)
2698 <span class="keyword">end</span>
2699 
2700 <span class="comment">% Start the Graphics Control Gui</span>
2701 <span class="comment">% ------------------------------</span>
2702 VMT_GraphicsControl
2703 
2704 <span class="comment">% [EOF] planviewPlotCallback</span>
2705 
2706 
2707 <span class="comment">% --------------------------------------------------------------------</span>
2708 <a name="_sub63" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2709 <span class="comment">% Plot 3</span>
2710 
2711 <span class="comment">% Get the Application data:</span>
2712 <span class="comment">% -------------------------</span>
2713 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2714 z = guiparams.z;
2715 A = guiparams.A;
2716 <span class="comment">% V = guiparams.V;</span>
2717 <span class="comment">% Map = guiparams.Map;</span>
2718 
2719 <span class="comment">% Preprocess the data:</span>
2720 <span class="comment">% --------------------</span>
2721 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2722 
2723 <span class="comment">% Push messages to Log Window:</span>
2724 <span class="comment">% ----------------------------</span>
2725 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2726 statusLogging(handles.LogWindow, log_text)
2727 
2728 <span class="comment">% Process the transects:</span>
2729 <span class="comment">% ----------------------</span>
2730 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2731 A(1).vgns = guiparams.vertical_grid_node_spacing;
2732 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2733 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2734     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2735 
2736 <span class="comment">% Push messages to Log Window:</span>
2737 <span class="comment">% ----------------------------</span>
2738 statusLogging(handles.LogWindow, processing_log_text)
2739 
2740 <span class="comment">% Plot the cross section:</span>
2741 <span class="comment">% -----------------------</span>
2742 log_text = {<span class="keyword">...</span>
2743     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2744     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2745     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2746     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2747     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2748     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2749     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2750     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2751     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2752     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2753     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2754     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2755     
2756     };
2757 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2758     log_text = vertcat(log_text, {<span class="keyword">...</span>
2759         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2760         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2761         });
2762 <span class="keyword">end</span>
2763 <span class="comment">% Push messages to Log Window:</span>
2764 <span class="comment">% ----------------------------</span>
2765 statusLogging(handles.LogWindow, log_text)
2766 
2767 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2768     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2769 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2770 <span class="comment">%         ...guiparams.contour, ...</span>
2771 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2772 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2773     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2774         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2775         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2776         guiparams.vertical_smoothing_window);
2777     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2778     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2779         guiparams.contour, <span class="keyword">...</span>
2780         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2781         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2782         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2783         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2784         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2785         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2786         guiparams.english_units,<span class="keyword">...</span>
2787         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2788         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2789     
2790 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2791     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2792         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2793         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2794         guiparams.vertical_smoothing_window);
2795     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2796     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip,start_bank)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2797         guiparams.contour, <span class="keyword">...</span>
2798         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2799         guiparams.english_units, <span class="keyword">...</span>
2800         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2801         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2802     
2803     guiparams.zmin = zmin;
2804     guiparams.zmax = zmax;
2805     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2806 <span class="keyword">end</span>
2807 
2808 <span class="comment">% Force plot to be formated properly</span>
2809 <span class="comment">% ----------------------------------</span>
2810 <span class="keyword">if</span> guiparams.presentation
2811     <a href="#_sub43" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2812 <span class="keyword">else</span>
2813     <a href="#_sub42" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2814 <span class="keyword">end</span>
2815 <span class="keyword">switch</span> guiparams.renderer
2816     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2817         <a href="#_sub19" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2818     <span class="keyword">case</span> <span class="string">'painters'</span>
2819         <a href="#_sub20" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2820     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2821         <a href="#_sub21" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2822 <span class="keyword">end</span>
2823 
2824 <span class="comment">% Focus the figure</span>
2825 <span class="comment">% ----------------</span>
2826 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2827 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2828     figure(hff)
2829 <span class="keyword">end</span>
2830 
2831 <span class="comment">% Re-store the Application data:</span>
2832 <span class="comment">% ------------------------------</span>
2833 guiparams.V = V;
2834 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2835 
2836 <span class="comment">% Start the Graphics Control Gui</span>
2837 <span class="comment">% ------------------------------</span>
2838 VMT_GraphicsControl
2839 
2840 <span class="comment">% Push messages to Log Window:</span>
2841 <span class="comment">% ----------------------------</span>
2842 statusLogging(handles.LogWindow, plot_cont_log_text)
2843 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2844 
2845 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2846 
2847 
2848 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2849 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2850 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2851 
2852 <span class="comment">% --------------------------------------------------------------------</span>
2853 <a name="_sub64" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2854 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2855 
2856 <span class="comment">% Get the Application data:</span>
2857 <span class="comment">% -------------------------</span>
2858 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2859 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2860 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2861 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2862 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2863 
2864 [the_file,the_path] = <span class="keyword">...</span>
2865     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2866     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2867     fullfile(guiparams.mat_path,guiparams.savefile));
2868 
2869 <span class="comment">% Save the processed data to a MAT file:</span>
2870 <span class="comment">% --------------------------------------</span>
2871 <span class="keyword">if</span> ischar(the_file)
2872     guiparams.mat_path = the_path;
2873     guiparams.mat_file = the_file;
2874     guiparams.savefile = the_file;
2875     
2876     <span class="comment">% Re-store the Application data:</span>
2877     <span class="comment">% ------------------------------</span>
2878     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2879     
2880     <span class="comment">% Update the preferences:</span>
2881     <span class="comment">% -----------------------</span>
2882     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2883     guiprefs.mat_path = the_path;
2884     guiprefs.mat_file = the_file;
2885     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2886     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2887     
2888     [~,filename,extension] = fileparts(guiparams.savefile);
2889     savefile = [filename extension];
2890     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2891         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2892     disp(<span class="string">'Saving Processed Data File...'</span>)
2893     disp(savefile)
2894     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2895 <span class="keyword">end</span>
2896 
2897 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2898 
2899 
2900 <span class="comment">% --------------------------------------------------------------------</span>
2901 <a name="_sub65" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2902 
2903 <span class="comment">% Get the Application data:</span>
2904 <span class="comment">% -------------------------</span>
2905 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2906 <span class="comment">% z   = guiparams.z;</span>
2907 <span class="comment">% A   = guiparams.A;</span>
2908 V   = guiparams.V;
2909 <span class="comment">% Map = guiparams.Map;</span>
2910 
2911 [the_file,the_path] = <span class="keyword">...</span>
2912     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2913     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2914     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2915 
2916 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2917 <span class="comment">% ------------------------------------------</span>
2918 <span class="keyword">if</span> ischar(the_file)
2919     guiparams.tecplot_path = the_path;
2920     guiparams.tecplot_file = the_file;
2921     
2922     <span class="comment">% Re-store the Application data:</span>
2923     <span class="comment">% ------------------------------</span>
2924     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2925     
2926     <span class="comment">% Update the preferences:</span>
2927     <span class="comment">% -----------------------</span>
2928     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2929     guiprefs.tecplot_path = the_path;
2930     guiprefs.tecplot_file = the_file;
2931     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2932     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2933     
2934     <span class="comment">% Push to log window</span>
2935     <span class="comment">% ------------------</span>
2936     log_text = {<span class="keyword">...</span>
2937         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2938         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2939         the_path;<span class="keyword">...</span>
2940         [<span class="string">'Filename: '</span> the_file]};
2941     statusLogging(handles.LogWindow,log_text)
2942         
2943     <span class="keyword">if</span> isempty(V)
2944         A = guiparams.A;
2945         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2946         A(1).vgns = guiparams.vertical_grid_node_spacing;
2947         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2948         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2949     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2950     <span class="keyword">end</span>
2951     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2952     
2953     <span class="comment">% Push to log window</span>
2954     <span class="comment">% ------------------</span>
2955     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2956     statusLogging(handles.LogWindow,log_text)
2957     
2958     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2959     
2960     <span class="comment">% Push to log window</span>
2961     <span class="comment">% ------------------</span>
2962     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2963     statusLogging(handles.LogWindow,log_text)
2964    
2965 <span class="keyword">end</span>
2966 
2967 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2968 
2969 
2970 <span class="comment">% --------------------------------------------------------------------</span>
2971 <a name="_sub66" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2972 
2973 <span class="comment">% Get the Application data:</span>
2974 <span class="comment">% -------------------------</span>
2975 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2976 <span class="comment">% z   = guiparams.z;</span>
2977 A   = guiparams.A;
2978 V   = guiparams.V;
2979 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2980 
2981 [the_file,the_path] = <span class="keyword">...</span>
2982     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2983     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2984     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2985 
2986 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2987 <span class="comment">% -----------------------------------------------------</span>
2988 <span class="keyword">if</span> ischar(the_file)
2989     guiparams.kmz_path = the_path;
2990     guiparams.kmz_file = the_file;
2991     
2992     <span class="comment">% Re-store the Application data:</span>
2993     <span class="comment">% ------------------------------</span>
2994     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2995     
2996     <span class="comment">% Update the preferences:</span>
2997     <span class="comment">% -----------------------</span>
2998     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2999     guiprefs.kmz_path = the_path;
3000     guiprefs.kmz_file = the_file;
3001     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3002     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
3003     
3004     <span class="comment">%     if guiparams.display_shoreline</span>
3005     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
3006     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
3007     <span class="comment">%                             guiparams.vertical_offset);</span>
3008     <span class="comment">%     end</span>
3009     <span class="keyword">if</span> isempty(V)
3010         A = guiparams.A;
3011         A(1).hgns = guiparams.horizontal_grid_node_spacing;
3012         A(1).vgns = guiparams.vertical_grid_node_spacing;
3013         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3014         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3015     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
3016     <span class="keyword">end</span>
3017     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
3018         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
3019         guiparams.vertical_exaggeration, <span class="keyword">...</span>
3020         guiparams.KMZ_vertical_offset);
3021 <span class="keyword">end</span>
3022 
3023 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
3024 
3025 
3026 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3027 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
3028 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3029 
3030 <span class="comment">% --------------------------------------------------------------------</span>
3031 <a name="_sub67" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
3032 
3033 <span class="comment">% Get the Application data:</span>
3034 <span class="comment">% -------------------------</span>
3035 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3036 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3037 z = guiparams.z;
3038 A = guiparams.A;
3039 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
3040 <span class="comment">% Map = guiparams.Map;</span>
3041 setends = guiparams.set_cross_section_endpoints;
3042 
3043 [the_file,the_path] = <span class="keyword">...</span>
3044     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
3045     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
3046     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
3047     guiprefs.multibeambathymetry_file));
3048 
3049 <span class="keyword">if</span> ischar(the_file)
3050     guiparams.multibeambathymetry_path = the_path;
3051     guiparams.multibeambathymetry_file = the_file;
3052     
3053     <span class="comment">% Re-store the Application data:</span>
3054     <span class="comment">% ------------------------------</span>
3055     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3056     
3057     <span class="comment">% Update the preferences:</span>
3058     <span class="comment">% -----------------------</span>
3059     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3060     guiprefs.multibeambathymetry_path = the_path;
3061     guiprefs.multibeambathymetry_file = the_file;
3062     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3063     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
3064     
3065     <span class="keyword">if</span> guiparams.output_auxiliary_data
3066     <span class="keyword">end</span>
3067     
3068     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
3069     
3070     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
3071         guiparams.multibeambathymetry_file);
3072     
3073     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
3074         [<span class="string">'   '</span> savefile]};
3075     statusLogging(handles.LogWindow,log_text)
3076     
3077     <span class="comment">% Process the transects:</span>
3078     <span class="comment">% ----------------------</span>
3079     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3080     A(1).vgns = guiparams.vertical_grid_node_spacing;
3081     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3082     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3083     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
3084     
3085     <span class="comment">% Compute the smoothed variables</span>
3086     <span class="comment">% ------------------------------</span>
3087     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3088     <span class="comment">% runtime.</span>
3089     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3090         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3091         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3092         guiparams.vertical_smoothing_window);
3093     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3094     <span class="comment">% Push messages to Log Window:</span>
3095     <span class="comment">% ----------------------------</span>
3096     statusLogging(handles.LogWindow, processing_log_text)
3097 
3098     
3099     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3100         guiparams.A, <span class="keyword">...</span>
3101         savefile, <span class="keyword">...</span>
3102         guiparams.beam_angle, <span class="keyword">...</span>
3103         guiparams.magnetic_variation, <span class="keyword">...</span>
3104         guiparams.water_surface_elevation, <span class="keyword">...</span>
3105         guiparams.output_auxiliary_data);
3106     
3107     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3108     
3109 <span class="keyword">end</span>
3110 
3111 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3112 
3113 
3114 <span class="comment">% --------------------------------------------------------------------</span>
3115 <a name="_sub68" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3116 <span class="comment">% Get the beam angle</span>
3117 
3118 <span class="comment">% Get the Application data:</span>
3119 <span class="comment">% -------------------------</span>
3120 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3121 
3122 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3123 <span class="comment">% ----------------------------------------------------------------</span>
3124 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3125 is_a_number = ~isnan(new_beam_angle);
3126 is_positive = new_beam_angle&gt;=0;
3127 
3128 <span class="comment">% Modify the Application data:</span>
3129 <span class="comment">% ----------------------------</span>
3130 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3131     guiparams.beam_angle = new_beam_angle;
3132     
3133     <span class="comment">% Re-store the Application data:</span>
3134     <span class="comment">% ------------------------------</span>
3135     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3136     
3137 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3138     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3139 <span class="keyword">end</span>
3140 
3141 <span class="comment">% [EOF] BeamAngle_Callback</span>
3142 
3143 
3144 <span class="comment">% --------------------------------------------------------------------</span>
3145 <a name="_sub69" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3146 <span class="comment">% Get the Magnetic Variation</span>
3147 
3148 <span class="comment">% Get the Application data:</span>
3149 <span class="comment">% -------------------------</span>
3150 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3151 
3152 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3153 <span class="comment">% ----------------------------------------------------------------</span>
3154 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3155 is_a_number = ~isnan(new_magnetic_variation);
3156 is_positive = new_magnetic_variation&gt;=0;
3157 
3158 <span class="comment">% Modify the Application data:</span>
3159 <span class="comment">% ----------------------------</span>
3160 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3161     guiparams.magnetic_variation = new_magnetic_variation;
3162     
3163     <span class="comment">% Re-store the Application data:</span>
3164     <span class="comment">% ------------------------------</span>
3165     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3166     
3167 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3168     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3169 <span class="keyword">end</span>
3170 
3171 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3172 
3173 
3174 <span class="comment">% % --------------------------------------------------------------------</span>
3175 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3176 <span class="comment">%</span>
3177 <span class="comment">% % Get the Application data:</span>
3178 <span class="comment">% % -------------------------</span>
3179 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3180 <span class="comment">%</span>
3181 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3182 <span class="comment">% % ----------------------------------------------------------------</span>
3183 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3184 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3185 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3186 <span class="comment">%</span>
3187 <span class="comment">% % Modify the Application data:</span>
3188 <span class="comment">% % ----------------------------</span>
3189 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3190 <span class="comment">%     guiparams.wse = new_wse;</span>
3191 <span class="comment">%</span>
3192 <span class="comment">%     % Re-store the Application data:</span>
3193 <span class="comment">%     % ------------------------------</span>
3194 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3195 <span class="comment">%</span>
3196 <span class="comment">% else % Reject the (incorrect) input</span>
3197 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3198 <span class="comment">% end</span>
3199 <span class="comment">%</span>
3200 <span class="comment">% % [EOF] WSE_Callback</span>
3201 
3202 
3203 <span class="comment">% --------------------------------------------------------------------</span>
3204 <a name="_sub70" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3205 <span class="comment">% Bathymetry Auxiliary Data</span>
3206 
3207 <span class="comment">% Get the Application data:</span>
3208 <span class="comment">% -------------------------</span>
3209 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3210 
3211 <span class="comment">% Modify the Application data:</span>
3212 <span class="comment">% ----------------------------</span>
3213 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3214 
3215 <span class="comment">% Re-store the Application data:</span>
3216 <span class="comment">% ------------------------------</span>
3217 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3218 
3219 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3220 
3221 
3222 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3223 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3224 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3225 
3226 <span class="comment">% --------------------------------------------------------------------</span>
3227 <a name="_sub71" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3228 
3229 <span class="comment">% Get the Application data:</span>
3230 <span class="comment">% -------------------------</span>
3231 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3232 
3233 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3234 <span class="comment">% ----------------------------------------------------------------</span>
3235 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3236 is_a_number = ~isnan(new_depth_range_min);
3237 is_positive = new_depth_range_min&gt;=0;
3238 
3239 <span class="comment">% Modify the Application data:</span>
3240 <span class="comment">% ----------------------------</span>
3241 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3242     guiparams.depth_range_min = new_depth_range_min;
3243     
3244     <span class="comment">% Re-store the Application data:</span>
3245     <span class="comment">% ------------------------------</span>
3246     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3247     
3248 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3249     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3250 <span class="keyword">end</span>
3251 
3252 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3253 
3254 
3255 <span class="comment">% --------------------------------------------------------------------</span>
3256 <a name="_sub72" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3257 
3258 <span class="comment">% Get the Application data:</span>
3259 <span class="comment">% -------------------------</span>
3260 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3261 
3262 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3263 <span class="comment">% ----------------------------------------------------------------</span>
3264 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3265 is_a_number = ~isnan(new_depth_range_max);
3266 is_positive = new_depth_range_max&gt;=0;
3267 
3268 <span class="comment">% Modify the Application data:</span>
3269 <span class="comment">% ----------------------------</span>
3270 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3271     guiparams.depth_range_max = new_depth_range_max;
3272     
3273     <span class="comment">% Re-store the Application data:</span>
3274     <span class="comment">% ------------------------------</span>
3275     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3276     
3277 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3278     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3279 <span class="keyword">end</span>
3280 
3281 <span class="comment">% [EOF] DepthMax_Callback</span>
3282 
3283 
3284 <span class="comment">% --------------------------------------------------------------------</span>
3285 <a name="_sub73" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3286 <span class="comment">% Set quiver scale (contour)</span>
3287 
3288 <span class="comment">% Get the Application data:</span>
3289 <span class="comment">% -------------------------</span>
3290 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3291 
3292 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3293 <span class="comment">% ----------------------------------------------------------------</span>
3294 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3295 is_a_number = ~isnan(new_vector_scale_plan_view);
3296 is_positive = new_vector_scale_plan_view&gt;=0;
3297 
3298 <span class="comment">% Modify the Application data:</span>
3299 <span class="comment">% ----------------------------</span>
3300 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3301     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3302     
3303     <span class="comment">% Re-store the Application data:</span>
3304     <span class="comment">% ------------------------------</span>
3305     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3306     
3307 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3308     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3309 <span class="keyword">end</span>
3310 
3311 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3312 
3313 
3314 <span class="comment">% --------------------------------------------------------------------</span>
3315 <a name="_sub74" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3316 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3317 
3318 <span class="comment">% Get the Application data:</span>
3319 <span class="comment">% -------------------------</span>
3320 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3321 
3322 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3323 <span class="comment">% ----------------------------------------------------------------</span>
3324 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3325 is_a_number = ~isnan(new_vector_spacing_plan_view);
3326 is_positive = new_vector_spacing_plan_view&gt;=0;
3327 
3328 <span class="comment">% Modify the Application data:</span>
3329 <span class="comment">% ----------------------------</span>
3330 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3331     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3332     
3333     <span class="comment">% Re-store the Application data:</span>
3334     <span class="comment">% ------------------------------</span>
3335     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3336     
3337 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3338     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3339 <span class="keyword">end</span>
3340 
3341 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3342 
3343 
3344 <span class="comment">% --------------------------------------------------------------------</span>
3345 <a name="_sub75" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3346 <span class="comment">% Plan View smoothing window size</span>
3347 
3348 <span class="comment">% Get the Application data:</span>
3349 <span class="comment">% -------------------------</span>
3350 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3351 
3352 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3353 <span class="comment">% ----------------------------------------------------------------</span>
3354 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3355 is_a_number = ~isnan(new_smoothing_window_size);
3356 is_positive = new_smoothing_window_size&gt;=0;
3357 
3358 <span class="comment">% Modify the Application data:</span>
3359 <span class="comment">% ----------------------------</span>
3360 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3361     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3362     
3363     <span class="comment">% Re-store the Application data:</span>
3364     <span class="comment">% ------------------------------</span>
3365     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3366     
3367 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3368     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3369 <span class="keyword">end</span>
3370 
3371 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3372 
3373 
3374 <span class="comment">% --------------------------------------------------------------------</span>
3375 <a name="_sub76" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3376 
3377 <span class="comment">% Get the Application data:</span>
3378 <span class="comment">% -------------------------</span>
3379 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3380 
3381 <span class="comment">% Modify the Application data:</span>
3382 <span class="comment">% ----------------------------</span>
3383 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3384 
3385 <span class="comment">% Re-store the Application data:</span>
3386 <span class="comment">% ------------------------------</span>
3387 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3388 
3389 <span class="comment">% [EOF] AddBackground_Callback</span>
3390 
3391 
3392 <span class="comment">% --------------------------------------------------------------------</span>
3393 <a name="_sub77" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3394 <a href="#_sub62" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3395 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3396 
3397 
3398 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3399 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3400 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3401 
3402 <span class="comment">% --------------------------------------------------------------------</span>
3403 <a name="_sub78" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3404 <span class="comment">% Set the horizontal grid node spacing</span>
3405 
3406 <span class="comment">% Get the Application data:</span>
3407 <span class="comment">% -------------------------</span>
3408 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3409 
3410 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3411 <span class="comment">% ----------------------------------------------------------------</span>
3412 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3413 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3414 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3415 
3416 <span class="comment">% Modify the Application data:</span>
3417 <span class="comment">% ----------------------------</span>
3418 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3419     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3420     
3421     <span class="comment">% Re-store the Application data:</span>
3422     <span class="comment">% ------------------------------</span>
3423     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3424     
3425 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3426     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3427 <span class="keyword">end</span>
3428 
3429 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3430 
3431 <span class="comment">% --------------------------------------------------------------------</span>
3432 <a name="_sub79" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3433 <span class="comment">% Set the horizontal grid node spacing</span>
3434 
3435 <span class="comment">% Get the Application data:</span>
3436 <span class="comment">% -------------------------</span>
3437 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3438 
3439 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3440 <span class="comment">% ----------------------------------------------------------------</span>
3441 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3442 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3443 is_positive = new_vertical_grid_node_spacing&gt;=0;
3444 
3445 <span class="comment">% Modify the Application data:</span>
3446 <span class="comment">% ----------------------------</span>
3447 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3448     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3449     
3450     <span class="comment">% Re-store the Application data:</span>
3451     <span class="comment">% ------------------------------</span>
3452     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3453     
3454 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3455     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3456 <span class="keyword">end</span>
3457 
3458 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3459 
3460 <span class="comment">% --------------------------------------------------------------------</span>
3461 <a name="_sub80" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3462 <span class="comment">% Set the cross section endpoints manually</span>
3463 
3464 <span class="comment">% Get the Application data:</span>
3465 <span class="comment">% -------------------------</span>
3466 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3467 
3468 <span class="comment">% Modify the Application data:</span>
3469 <span class="comment">% ----------------------------</span>
3470 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3471 
3472 <span class="comment">% Re-store the Application data:</span>
3473 <span class="comment">% ------------------------------</span>
3474 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3475 
3476 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3477 
3478 
3479 <span class="comment">% --------------------------------------------------------------------</span>
3480 <a name="_sub81" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3481 <a href="#_sub61" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3482 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3483 
3484 
3485 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3486 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3487 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3488 
3489 <span class="comment">% --------------------------------------------------------------------</span>
3490 <a name="_sub82" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3491 
3492 <span class="comment">% Get the Application data:</span>
3493 <span class="comment">% -------------------------</span>
3494 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3495 
3496 <span class="comment">% Modify the Application data:</span>
3497 <span class="comment">% ----------------------------</span>
3498 idx_variable = get(hObject,<span class="string">'Value'</span>);
3499 guiparams.idx_contour = idx_variable;
3500 guiparams.contour = guiparams.contours(idx_variable).variable;
3501 
3502 <span class="comment">% Re-store the Application data:</span>
3503 <span class="comment">% ------------------------------</span>
3504 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3505 
3506 <span class="comment">% [EOF] Contour_Callback</span>
3507 
3508 
3509 <span class="comment">% --------------------------------------------------------------------</span>
3510 <a name="_sub83" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3511 <span class="comment">% Set vertical exaggeration</span>
3512 
3513 <span class="comment">% Get the Application data:</span>
3514 <span class="comment">% -------------------------</span>
3515 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3516 
3517 <span class="comment">% Modify the Application data:</span>
3518 <span class="comment">% ----------------------------</span>
3519 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3520 
3521 <span class="comment">% Re-store the Application data:</span>
3522 <span class="comment">% ------------------------------</span>
3523 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3524 
3525 <span class="comment">% Update the GUI:</span>
3526 <span class="comment">% ---------------</span>
3527 <span class="comment">% updateGUI(handles,guiparams)</span>
3528 
3529 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3530 
3531 
3532 <span class="comment">% --------------------------------------------------------------------</span>
3533 <a name="_sub84" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3534 
3535 <span class="comment">% Get the Application data:</span>
3536 <span class="comment">% -------------------------</span>
3537 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3538 
3539 <span class="comment">% Modify the Application data:</span>
3540 <span class="comment">% ----------------------------</span>
3541 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3542 
3543 <span class="comment">% Re-store the Application data:</span>
3544 <span class="comment">% ------------------------------</span>
3545 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3546 
3547 <span class="comment">% Update the GUI:</span>
3548 <span class="comment">% ---------------</span>
3549 <span class="comment">% updateGUI(handles,guiparams)</span>
3550 
3551 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3552 
3553 
3554 <span class="comment">% --------------------------------------------------------------------</span>
3555 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3556 
3557 <span class="comment">% Get the Application data:</span>
3558 <span class="comment">% -------------------------</span>
3559 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3560 
3561 <span class="comment">% Modify the Application data:</span>
3562 <span class="comment">% ----------------------------</span>
3563 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3564 
3565 <span class="comment">% Re-store the Application data:</span>
3566 <span class="comment">% ------------------------------</span>
3567 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3568 
3569 <span class="comment">% Update the GUI:</span>
3570 <span class="comment">% ---------------</span>
3571 <span class="comment">% updateGUI(handles,guiparams)</span>
3572 
3573 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3574 
3575 
3576 <span class="comment">% --------------------------------------------------------------------</span>
3577 <a name="_sub86" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3578 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3579 
3580 <span class="comment">% Get the Application data:</span>
3581 <span class="comment">% -------------------------</span>
3582 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3583 
3584 <span class="comment">% Modify the Application data:</span>
3585 <span class="comment">% ----------------------------</span>
3586 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3587 
3588 <span class="comment">% Re-store the Application data:</span>
3589 <span class="comment">% ------------------------------</span>
3590 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3591 
3592 <span class="comment">% Update the GUI:</span>
3593 <span class="comment">% ---------------</span>
3594 <span class="comment">% updateGUI(handles,guiparams)</span>
3595 
3596 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3597 
3598 
3599 <span class="comment">% --------------------------------------------------------------------</span>
3600 <a name="_sub87" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3601 <span class="comment">% Horizontal Smoothing</span>
3602 
3603 <span class="comment">% Get the Application data:</span>
3604 <span class="comment">% -------------------------</span>
3605 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3606 
3607 <span class="comment">% Modify the Application data:</span>
3608 <span class="comment">% ----------------------------</span>
3609 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3610 
3611 <span class="comment">% Re-store the Application data:</span>
3612 <span class="comment">% ------------------------------</span>
3613 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3614 
3615 <span class="comment">% Update the GUI:</span>
3616 <span class="comment">% ---------------</span>
3617 <span class="comment">% updateGUI(handles,guiparams)</span>
3618 
3619 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3620 
3621 
3622 <span class="comment">% --------------------------------------------------------------------</span>
3623 <a name="_sub88" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3624 <span class="comment">% Vertical Smoothing</span>
3625 
3626 <span class="comment">% Get the Application data:</span>
3627 <span class="comment">% -------------------------</span>
3628 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3629 
3630 <span class="comment">% Modify the Application data:</span>
3631 <span class="comment">% ----------------------------</span>
3632 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3633 
3634 <span class="comment">% Re-store the Application data:</span>
3635 <span class="comment">% ------------------------------</span>
3636 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3637 
3638 <span class="comment">% Update the GUI:</span>
3639 <span class="comment">% ---------------</span>
3640 <span class="comment">% updateGUI(handles,guiparams)</span>
3641 
3642 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3643 
3644 
3645 <span class="comment">% --------------------------------------------------------------------</span>
3646 <a name="_sub89" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3647 
3648 <span class="comment">% Get the Application data:</span>
3649 <span class="comment">% -------------------------</span>
3650 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3651 
3652 <span class="comment">% Modify the Application data:</span>
3653 <span class="comment">% ----------------------------</span>
3654 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3655 
3656 <span class="comment">% Re-store the Application data:</span>
3657 <span class="comment">% ------------------------------</span>
3658 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3659 
3660 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3661 
3662 
3663 <span class="comment">% --------------------------------------------------------------------</span>
3664 <a name="_sub90" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3665 
3666 <span class="comment">% Get the Application data:</span>
3667 <span class="comment">% -------------------------</span>
3668 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3669 
3670 <span class="comment">% Modify the Application data:</span>
3671 <span class="comment">% ----------------------------</span>
3672 idx_variable = get(hObject,<span class="string">'Value'</span>);
3673 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3674 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3675 
3676 <span class="comment">% Re-store the Application data:</span>
3677 <span class="comment">% ------------------------------</span>
3678 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3679 
3680 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3681 
3682 
3683 <span class="comment">% --------------------------------------------------------------------</span>
3684 <a name="_sub91" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3685 
3686 <span class="comment">% Get the Application data:</span>
3687 <span class="comment">% -------------------------</span>
3688 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3689 
3690 <span class="comment">% Modify the Application data:</span>
3691 <span class="comment">% ----------------------------</span>
3692 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3693 
3694 <span class="comment">% Re-store the Application data:</span>
3695 <span class="comment">% ------------------------------</span>
3696 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3697 
3698 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3699 
3700 
3701 <span class="comment">% --------------------------------------------------------------------</span>
3702 <a name="_sub92" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3703 <a href="#_sub63" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3704 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3705 
3706 
3707 <span class="comment">% --------------------------------------------------------------------</span>
3708 <a name="_sub93" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3709 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3710 <span class="comment">% [EOF] ClearLog_Callback</span>
3711 
3712 <span class="comment">% --------------------------------------------------------------------</span>
3713 <a name="_sub94" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3714 
3715 <span class="comment">% Get the Application data:</span>
3716 <span class="comment">% -------------------------</span>
3717 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3718 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3719 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3720 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3721 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3722 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3723 
3724 [the_file,the_path] = <span class="keyword">...</span>
3725     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3726     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3727     fullfile(guiprefs.log_path,guiprefs.log_file));
3728 
3729 <span class="comment">% Save the log to a TXT file:</span>
3730 <span class="comment">% ---------------------------</span>
3731 <span class="keyword">if</span> ischar(the_file)
3732     guiparams.log_path = the_path;
3733     guiparams.log_file = the_file;
3734     <span class="comment">%guiparams.savefile = the_file;</span>
3735     
3736     <span class="comment">% Re-store the Application data:</span>
3737     <span class="comment">% ------------------------------</span>
3738     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3739     
3740     <span class="comment">% Update the preferences:</span>
3741     <span class="comment">% -----------------------</span>
3742     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3743     guiprefs.log_path = the_path;
3744     guiprefs.log_file = the_file;
3745     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3746     <a href="#_sub97" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3747     
3748     [~,filename,extension] = fileparts(the_file);
3749     savefile = [the_path filename extension];
3750     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3751         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3752     
3753     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3754     [nrows,~]= size(logfile);
3755     fid = fopen(savefile, <span class="string">'w'</span>);
3756     <span class="keyword">for</span> row=1:nrows
3757         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3758     <span class="keyword">end</span>
3759     fclose(fid);
3760 <span class="keyword">end</span>
3761 <span class="comment">% [EOF] SaveLog_Callback</span>
3762 
3763 <span class="comment">%%%%%%%%%%%%%%%%</span>
3764 <span class="comment">% SUBFUNCTIONS %</span>
3765 <span class="comment">%%%%%%%%%%%%%%%%</span>
3766 
3767 <span class="comment">% --------------------------------------------------------------------</span>
3768 <a name="_sub95" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3769 
3770 icons = <a href="#_sub111" class="code" title="subfunction icons = getIcons">getIcons</a>;
3771 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3772 
3773 <span class="comment">% Load data</span>
3774 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3775 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3776 <span class="comment">% icon(icon==0) = NaN;</span>
3777 handles.toolbarLoadData = <span class="keyword">...</span>
3778     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3779     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3780     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3781 
3782 <span class="comment">% Save data</span>
3783 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3784 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3785 <span class="comment">% icon(icon==0) = NaN;</span>
3786 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3787     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3788     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3789     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3790     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3791 
3792 
3793 <span class="comment">% Save bathymetry</span>
3794 <span class="comment">%icon = ones(16,16,3);</span>
3795 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3796     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3797     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3798     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3799 
3800 <span class="comment">% Save figures</span>
3801 <span class="comment">% icon = ones(16,16,3);</span>
3802 handles.toolbarSaveFigures = <span class="keyword">...</span>
3803     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3804     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3805     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3806 
3807 <span class="comment">% Save Excel File</span>
3808 <span class="comment">% icon = ones(16,16,3);</span>
3809 handles.toolbarSaveExcel = <span class="keyword">...</span>
3810     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3811     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3812     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3813 
3814 
3815 <span class="comment">% Plotting parameters</span>
3816 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3817 <span class="comment">% icon = ind2rgb(icon,map);</span>
3818 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3819     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3820     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3821     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3822     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3823 
3824 <span class="comment">% Processing parameters</span>
3825 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3826 <span class="comment">% icon = ind2rgb(icon,map);</span>
3827 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3828     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3829     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3830     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3831 
3832 <span class="comment">% Zoom In</span>
3833 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3834 <span class="comment">% icon = ind2rgb(icon,map);</span>
3835 <span class="comment">% handles.toolbarZoomIn = ...</span>
3836 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3837 <span class="comment">%     'CData',        icons(8).data, ...</span>
3838 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3839 <span class="comment">%     'Separator',     'on');</span>
3840 
3841 <span class="comment">% Zoom Out</span>
3842 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3843 <span class="comment">% icon = ind2rgb(icon,map);</span>
3844 <span class="comment">% handles.toolbarZoomOut = ...</span>
3845 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3846 <span class="comment">%     'CData',        icons(9).data, ...</span>
3847 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3848 
3849 <span class="comment">% Pan</span>
3850 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3851 <span class="comment">% icon = ind2rgb(icon,map);</span>
3852 <span class="comment">% handles.toolbarPan = ...</span>
3853 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3854 <span class="comment">%     'CData',        icons(10).data, ...</span>
3855 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3856 
3857 
3858 
3859 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub56" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3860 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3861 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub67" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3862 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub22" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3863 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub27" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3864 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub59" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3865 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub60" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3866 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3867 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3868 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3869 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3870 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3871 
3872 <span class="comment">% [EOF] buildtoolbar</span>
3873 
3874 
3875 <span class="comment">% --------------------------------------------------------------------</span>
3876 <a name="_sub96" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3877 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3878 <span class="comment">% already exist.</span>
3879 
3880 <span class="comment">% Preferences:</span>
3881 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3882 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3883 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3884 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3885 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3886 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3887 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3888 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3889 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3890 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3891 <span class="comment">% 'renderer'             Default graphics renderer</span>
3892 <span class="comment">% 'units'                Default plotting units</span>
3893 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3894 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3895 <span class="comment">%                        started</span>
3896 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3897 
3898 <span class="comment">% Originals</span>
3899 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3900 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3901 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3902 
3903 <span class="comment">% ASCII</span>
3904 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3905     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3906     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3907         guiprefs.ascii_path = ascii.path;
3908     <span class="keyword">else</span>
3909         guiprefs.ascii_path = pwd;
3910     <span class="keyword">end</span>
3911     does_exist = false(1,length(ascii.file));
3912     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3913         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3914     <span class="keyword">end</span>
3915     <span class="keyword">if</span> any(does_exist)
3916         guiprefs.ascii_file = ascii.file(does_exist);
3917     <span class="keyword">else</span>
3918         guiprefs.ascii_file = {<span class="string">''</span>};
3919     <span class="keyword">end</span>
3920 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3921     guiprefs.ascii_path = pwd;
3922     guiprefs.ascii_file = {<span class="string">''</span>};
3923     
3924     ascii.path = pwd;
3925     ascii.file = {<span class="string">''</span>};
3926     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3927 <span class="keyword">end</span>
3928 
3929 <span class="comment">% MAT</span>
3930 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3931     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3932     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3933         guiprefs.mat_path = mat.path;
3934     <span class="keyword">else</span>
3935         guiprefs.mat_path = pwd;
3936     <span class="keyword">end</span>
3937     
3938     <span class="keyword">if</span> iscell(mat.file)
3939         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3940             guiprefs.mat_file = mat.file;
3941         <span class="keyword">else</span>
3942             guiprefs.mat_file = <span class="string">''</span>;
3943         <span class="keyword">end</span>
3944     <span class="keyword">else</span>
3945         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3946             guiprefs.mat_file = mat.file;
3947         <span class="keyword">else</span>
3948             guiprefs.mat_file = <span class="string">''</span>;
3949         <span class="keyword">end</span>
3950     <span class="keyword">end</span>
3951 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3952     guiprefs.mat_path = pwd;
3953     guiprefs.mat_file = <span class="string">''</span>;
3954     
3955     mat.path = pwd;
3956     mat.file = <span class="string">''</span>;
3957     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3958 <span class="keyword">end</span>
3959 
3960 <span class="comment">% TECPLOT</span>
3961 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3962     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3963     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3964         guiprefs.tecplot_path = tecplot.path;
3965     <span class="keyword">else</span>
3966         guiprefs.tecplot_path = pwd;
3967     <span class="keyword">end</span>
3968     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3969         guiprefs.tecplot_file = tecplot.file;
3970     <span class="keyword">else</span>
3971         guiprefs.tecplot_file = <span class="string">''</span>;
3972     <span class="keyword">end</span>
3973 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3974     guiprefs.tecplot_path = pwd;
3975     guiprefs.tecplot_file = <span class="string">''</span>;
3976     
3977     tecplot.path = pwd;
3978     tecplot.file = <span class="string">''</span>;
3979     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3980 <span class="keyword">end</span>
3981 
3982 <span class="comment">% KMZ</span>
3983 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3984     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3985     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3986         guiprefs.kmz_path = kmz.path;
3987     <span class="keyword">else</span>
3988         guiprefs.kmz_path = pwd;
3989     <span class="keyword">end</span>
3990     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3991         guiprefs.kmz_file = kmz.file;
3992     <span class="keyword">else</span>
3993         guiprefs.kmz_file = <span class="string">''</span>;
3994     <span class="keyword">end</span>
3995 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3996     guiprefs.kmz_path = pwd;
3997     guiprefs.kmz_file = <span class="string">''</span>;
3998     
3999     kmz.path = pwd;
4000     kmz.file = <span class="string">''</span>;
4001     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4002 <span class="keyword">end</span>
4003 
4004 <span class="comment">% MULTIBEAM BATHYMETRY</span>
4005 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
4006     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
4007     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
4008         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
4009     <span class="keyword">else</span>
4010         guiprefs.multibeambathymetry_path = pwd;
4011     <span class="keyword">end</span>
4012     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
4013         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
4014     <span class="keyword">else</span>
4015         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4016     <span class="keyword">end</span>
4017 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
4018     guiprefs.multibeambathymetry_path = pwd;
4019     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
4020     
4021     multibeambathymetry.path = pwd;
4022     multibeambathymetry.file = <span class="string">''</span>;
4023     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4024 <span class="keyword">end</span>
4025 
4026 <span class="comment">% Log</span>
4027 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
4028     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
4029     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
4030         guiprefs.log_path = log.path;
4031     <span class="keyword">else</span>
4032         guiprefs.log_path = pwd;
4033     <span class="keyword">end</span>
4034     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
4035         guiprefs.log_file = log.file;
4036     <span class="keyword">else</span>
4037         guiprefs.log_file = <span class="string">''</span>;
4038     <span class="keyword">end</span>
4039 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4040     guiprefs.log_path = pwd;
4041     guiprefs.log_file = <span class="string">''</span>;
4042     
4043     log.path = pwd;
4044     log.file = <span class="string">''</span>;
4045     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4046 <span class="keyword">end</span>
4047 
4048 <span class="comment">% iRic</span>
4049 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
4050     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
4051     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
4052         guiprefs.iric_path = iric.path;
4053     <span class="keyword">else</span>
4054         guiprefs.iric_path = pwd;
4055     <span class="keyword">end</span>
4056     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
4057         guiprefs.iric_file = iric.file;
4058     <span class="keyword">else</span>
4059         guiprefs.iric_file = <span class="string">''</span>;
4060     <span class="keyword">end</span>
4061 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
4062     guiprefs.iric_path = pwd;
4063     guiprefs.iric_file = <span class="string">''</span>;
4064     
4065     iric.path = pwd;
4066     iric.file = <span class="string">''</span>;
4067     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4068 <span class="keyword">end</span>
4069 
4070 <span class="comment">% excel</span>
4071 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
4072     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
4073     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
4074         guiprefs.excel_path = excel.path;
4075     <span class="keyword">else</span>
4076         guiprefs.excel_path = pwd;
4077     <span class="keyword">end</span>
4078     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4079         guiprefs.excel_file = excel.file;
4080     <span class="keyword">else</span>
4081         guiprefs.excel_file = <span class="string">''</span>;
4082     <span class="keyword">end</span>
4083 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4084     guiprefs.excel_path = pwd;
4085     guiprefs.excel_file = <span class="string">''</span>;
4086     
4087     excel.path = pwd;
4088     excel.file = <span class="string">''</span>;
4089     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4090 <span class="keyword">end</span>
4091 
4092 <span class="comment">% aerial</span>
4093 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4094     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4095     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4096         guiprefs.aerial_path = aerial.path;
4097     <span class="keyword">else</span>
4098         guiprefs.aerial_path = pwd;
4099     <span class="keyword">end</span>
4100     does_exist = false(1,length(aerial.file));
4101     <span class="keyword">if</span> iscell(aerial.file)
4102     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4103         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4104     <span class="keyword">end</span>
4105     <span class="keyword">else</span>
4106         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4107     <span class="keyword">end</span>
4108     <span class="keyword">if</span> any(does_exist)
4109         guiprefs.aerial_file = aerial.file;
4110     <span class="keyword">else</span>
4111         guiprefs.aerial_file = {<span class="string">''</span>};
4112     <span class="keyword">end</span>
4113 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4114     guiprefs.aerial_path = pwd;
4115     guiprefs.aerial_file = {<span class="string">''</span>};
4116     
4117     aerial.path = pwd;
4118     aerial.file = {<span class="string">''</span>};
4119     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4120 <span class="keyword">end</span>
4121 
4122 <span class="comment">% shoreline</span>
4123 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4124     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4125     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4126         guiprefs.shoreline_path = shoreline.path;
4127     <span class="keyword">else</span>
4128         guiprefs.shoreline_path = pwd;
4129     <span class="keyword">end</span>
4130     
4131     <span class="keyword">if</span> iscell(shoreline.file)
4132         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4133             guiprefs.shoreline_file = shoreline.file;
4134         <span class="keyword">else</span>
4135             guiprefs.shoreline_file = <span class="string">''</span>;
4136         <span class="keyword">end</span>
4137     <span class="keyword">else</span>
4138         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4139             guiprefs.shoreline_file = shoreline.file;
4140         <span class="keyword">else</span>
4141             guiprefs.shoreline_file = <span class="string">''</span>;
4142         <span class="keyword">end</span>
4143     <span class="keyword">end</span>
4144 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4145     guiprefs.shoreline_path = pwd;
4146     guiprefs.shoreline_file = <span class="string">''</span>;
4147     
4148     shoreline.path = pwd;
4149     shoreline.file = <span class="string">''</span>;
4150     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4151 <span class="keyword">end</span>
4152 <span class="comment">% guiprefs.presentation = true;</span>
4153 <span class="comment">% guiprefs.print        = false;</span>
4154 
4155 <span class="comment">% for k = 1:length(prefs)</span>
4156 <span class="comment">%     newpref = '';</span>
4157 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4158 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4159 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4160 <span class="comment">%             newpref = stored_newpref;</span>
4161 <span class="comment">%         else</span>
4162 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4163 <span class="comment">%         end</span>
4164 <span class="comment">%     end</span>
4165 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4166 <span class="comment">% end</span>
4167 
4168 <span class="comment">% RENDERER</span>
4169 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4170     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4171     guiprefs.renderer = renderer;
4172 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4173     renderer           = <span class="string">'OpenGL'</span>;
4174     guiprefs.renderer  = renderer;
4175     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4176 <span class="keyword">end</span>
4177 
4178 <span class="comment">% UNITS</span>
4179 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4180     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4181     guiprefs.units = units;
4182 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4183     units           = <span class="string">'metric'</span>;
4184     guiprefs.units  = units;
4185     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4186 <span class="keyword">end</span>
4187 
4188 <span class="comment">% PLOTREF</span>
4189 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4190     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4191     guiprefs.plotref = plotref;
4192 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4193     plotref           = <span class="string">'dfs'</span>;
4194     guiprefs.plotref  = plotref;
4195     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4196 <span class="keyword">end</span>
4197 
4198 <span class="comment">% RUNCOUNTER</span>
4199 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4200     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4201     guiprefs.runcounter = runcounter;
4202 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4203     runcounter           = 1;
4204     guiprefs.runcounter  = runcounter;
4205     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4206 <span class="keyword">end</span>
4207 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4208 
4209 <span class="comment">% SETENDPOINTS</span>
4210 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4211     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4212     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4213         guiprefs.setendpoints_path = setendpoints.path;
4214     <span class="keyword">else</span>
4215         guiprefs.setendpoints_path = pwd;
4216     <span class="keyword">end</span>
4217     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4218         guiprefs.setendpoints_file = setendpoints.file;
4219     <span class="keyword">else</span>
4220         guiprefs.setendpoints_file = <span class="string">''</span>;
4221     <span class="keyword">end</span>
4222 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4223     guiprefs.setendpoints_path = pwd;
4224     guiprefs.setendpoints_file = <span class="string">''</span>;
4225     
4226     setendpoints.path = pwd;
4227     setendpoints.file = <span class="string">''</span>;
4228     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4229 <span class="keyword">end</span>
4230 
4231 <span class="comment">% [EOF] load_prefs</span>
4232 
4233 
4234 <span class="comment">% --------------------------------------------------------------------</span>
4235 <a name="_sub97" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4236 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4237 <span class="comment">% preferences data.</span>
4238 
4239 <span class="comment">% Preferences:</span>
4240 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4241 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4242 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4243 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4244 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4245 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4246 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4247 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4248 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4249 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4250 <span class="comment">% 'renderer'             Default graphics renderer</span>
4251 <span class="comment">% 'units'                Default plotting units</span>
4252 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4253 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4254 <span class="comment">%                        started</span>
4255 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4256 
4257 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4258 
4259 <span class="keyword">switch</span> pref
4260     <span class="keyword">case</span> <span class="string">'ascii'</span>
4261         ascii.path = guiprefs.ascii_path;
4262         ascii.file = guiprefs.ascii_file;
4263         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4264     <span class="keyword">case</span> <span class="string">'mat'</span>
4265         mat.path = guiprefs.mat_path;
4266         mat.file = guiprefs.mat_file;
4267         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4268     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4269         tecplot.path = guiprefs.tecplot_path;
4270         tecplot.file = guiprefs.tecplot_file;
4271         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4272     <span class="keyword">case</span> <span class="string">'kmz'</span>
4273         kmz.path = guiprefs.kmz_path;
4274         kmz.file = guiprefs.kmz_file;
4275         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4276     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4277         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4278         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4279         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4280     <span class="keyword">case</span> <span class="string">'log'</span>
4281         log.path = guiprefs.log_path;
4282         log.file = guiprefs.log_file;
4283         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4284     <span class="keyword">case</span> <span class="string">'iric'</span>
4285         iric.path = guiprefs.iric_path;
4286         iric.file = guiprefs.iric_file;
4287         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4288     <span class="keyword">case</span> <span class="string">'excel'</span>
4289         excel.path = guiprefs.excel_path;
4290         excel.file = guiprefs.excel_file;
4291         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4292     <span class="keyword">case</span> <span class="string">'aerial'</span>
4293         aerial.path = guiprefs.aerial_path;
4294         aerial.file = guiprefs.aerial_file;
4295         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4296     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4297         shoreline.path = guiprefs.shoreline_path;
4298         shoreline.file = guiprefs.shoreline_file;
4299         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4300     <span class="keyword">case</span> <span class="string">'renderer'</span>
4301         renderer = guiprefs.renderer;
4302         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4303     <span class="keyword">case</span> <span class="string">'units'</span>
4304         units = guiprefs.units;
4305         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4306     <span class="keyword">case</span> <span class="string">'plotref'</span>
4307         plotref = guiprefs.plotref;
4308         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4309     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4310         runcounter = guiprefs.runcounter;
4311         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4312     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4313         setendpoints.path = guiprefs.setendpoints_path;
4314         setendpoints.file = guiprefs.setendpoints_file;
4315         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4316     <span class="keyword">otherwise</span>
4317 <span class="keyword">end</span>
4318 
4319 <span class="comment">% if ismember(pref,prefs)</span>
4320 <span class="comment">%     setpref('VMT',pref,value)</span>
4321 <span class="comment">%</span>
4322 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4323 <span class="comment">%     guiprefs.(pref) = value;</span>
4324 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4325 <span class="comment">% end</span>
4326 
4327 <span class="comment">% [EOF] store_prefs</span>
4328 
4329 
4330 <span class="comment">% --------------------------------------------------------------------</span>
4331 <a name="_sub98" href="#_subfunctions" class="code">function initGUI(handles)</a>
4332 <span class="comment">% Initialize the UI controls in the GUI.</span>
4333 
4334 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4335 
4336 <span class="comment">% Set the name and version</span>
4337 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4338     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4339 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4340 
4341 <span class="comment">% Set the PLOT 1 axis labels</span>
4342 axes(handles.Plot1Shiptracks);
4343 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4344 xlabel(<span class="string">'UTM Easting (m)'</span>)
4345 ylabel(<span class="string">'UTM Northing (m)'</span>)
4346 box on
4347 grid on
4348 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4349 
4350 <span class="comment">%%%%%%%%%%%%</span>
4351 <span class="comment">% MENU BAR %</span>
4352 <span class="comment">%%%%%%%%%%%%</span>
4353 <span class="keyword">if</span> guiparams.english_units
4354     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4355     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4356 <span class="keyword">else</span>
4357     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4358     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4359 <span class="keyword">end</span>
4360 
4361 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4362     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4363     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4364 <span class="keyword">else</span>
4365     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4366     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4367 <span class="keyword">end</span>
4368 
4369 
4370 <span class="keyword">if</span> guiparams.print
4371     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4372     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4373     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4374     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4375 <span class="keyword">elseif</span> guiparams.presentation
4376     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4377     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4378     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4379     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4380 <span class="keyword">else</span>
4381 <span class="keyword">end</span>
4382 
4383 <span class="keyword">switch</span> guiparams.renderer
4384     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4385         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4386         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4387         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4388     <span class="keyword">case</span> <span class="string">'painters'</span>
4389         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4390         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4391         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4392     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4393         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4394         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4395         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4396 <span class="keyword">end</span>
4397 
4398 
4399 <span class="comment">%%%%%%%%%%%%%%%</span>
4400 <span class="comment">% DATA EXPORT %</span>
4401 <span class="comment">%%%%%%%%%%%%%%%</span>
4402 <span class="comment">% BathymetryPanel</span>
4403 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4404 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4405 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4406 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4407 
4408 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4409 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4410 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4411 <span class="comment">% PlanViewPanel</span>
4412 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4413 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4414 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4415 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4416 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4417 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4418 
4419 
4420 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4421 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4422 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4423 <span class="comment">% ShiptracksPanel</span>
4424 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4425 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4426 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4427 
4428 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4429 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4430 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4431 <span class="comment">% CrossSectionsPanel</span>
4432 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4433     <span class="string">'Value'</span>, guiparams.idx_contour)
4434 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4435 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4436 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4437 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4438 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4439 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4440 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4441 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4442     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4443 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4444 
4445 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4446 
4447 <span class="comment">% [EOF] initGUI</span>
4448 
4449 
4450 <span class="comment">% --------------------------------------------------------------------</span>
4451 <a name="_sub99" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4452 
4453 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4454 
4455 <span class="keyword">switch</span> enable_state
4456     <span class="keyword">case</span> <span class="string">'init'</span>
4457         guiparams.gui_state = <span class="string">'init'</span>;
4458         set([handles.menuFile
4459             handles.menuOpen
4460             handles.menuOpenASCII
4461             handles.menuOpenMAT
4462             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4463         
4464         set([handles.toolbarLoadData
4465             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4466         set([handles.toolbarSaveMatFile
4467             handles.toolbarSaveBathymetry
4468             handles.toolbarSaveFigures
4469             handles.toolbarSaveExcel
4470             handles.toolbarPlottingParameters
4471             handles.toolbarProcessingParameters
4472             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4473         
4474         set([handles.DepthRangeMin
4475             handles.DepthRangeMax
4476             handles.VectorScalePlanView
4477             handles.VectorSpacingPlanview
4478             handles.SmoothingWindowSize
4479             handles.AddBackground
4480             handles.PlotPlanView
4481             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4482       
4483         set([handles.HorizontalGridNodeSpacing
4484             handles.VerticalGridNodeSpacing
4485             handles.PlotShiptracks
4486             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4487         
4488         set([handles.Contour
4489             handles.VerticalExaggeration
4490             handles.VectorScaleCrossSection
4491             handles.HorizontalVectorSpacing
4492             handles.VerticalVectorSpacing
4493             handles.HorizontalSmoothingWindow
4494             handles.VerticalSmoothingWindow
4495             handles.PlotSecondaryFlowVectors
4496             handles.SecondaryFlowVectorVariable
4497             handles.IncludeVerticalVelocity
4498             handles.IncludeVerticalVelocityText
4499             handles.PlotCrossSection
4500             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4501         
4502     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4503         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4504         set([handles.menuFile
4505             handles.menuOpen
4506             handles.menuOpenASCII
4507             handles.menuOpenMAT
4508             handles.menuSaveMAT
4509             handles.menuSaveTecplot
4510             handles.menuSaveKMZFile
4511             handles.menuSettings
4512             handles.menuPlottingParameters
4513             handles.menuMetric
4514             handles.menuEnglish
4515             handles.menuBathymetryExportSettings
4516             handles.menuExportMultibeamBathymetry
4517             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4518             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4519         
4520         set([handles.toolbarLoadData
4521             handles.toolbarSaveMatFile
4522             handles.toolbarSaveBathymetry
4523             handles.toolbarSaveExcel
4524             handles.toolbarSaveFigures
4525             handles.toolbarPlottingParameters
4526             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4527         set([handles.toolbarProcessingParameters
4528             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4529         
4530            
4531         set([handles.DepthRangeMin
4532             handles.DepthRangeMax
4533             handles.VectorScalePlanView
4534             handles.VectorSpacingPlanview
4535             handles.SmoothingWindowSize
4536             handles.PlotPlanView
4537             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4538         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4539             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4540         <span class="keyword">else</span>
4541             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4542         <span class="keyword">end</span>
4543         
4544         set([handles.HorizontalGridNodeSpacing
4545             handles.VerticalGridNodeSpacing
4546             handles.PlotShiptracks
4547             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4548         
4549         set([handles.Contour
4550             handles.VerticalExaggeration
4551             handles.VectorScaleCrossSection
4552             handles.HorizontalVectorSpacing
4553             handles.VerticalVectorSpacing
4554             handles.HorizontalSmoothingWindow
4555             handles.VerticalSmoothingWindow
4556             handles.PlotSecondaryFlowVectors
4557             handles.SecondaryFlowVectorVariable
4558             handles.IncludeVerticalVelocity
4559             handles.IncludeVerticalVelocityText
4560             handles.PlotCrossSection
4561             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4562     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4563         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4564         set([handles.menuFile
4565             handles.menuOpen
4566             handles.menuOpenASCII
4567             handles.menuOpenMAT
4568             handles.menuSettings
4569             handles.menuPlottingParameters
4570             handles.menuMetric
4571             handles.menuEnglish
4572             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4573         set([handles.menuSaveMAT
4574             handles.menuBathymetryExportSettings
4575             handles.menuExportMultibeamBathymetry
4576             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4577             handles.menuSaveKMZFile
4578             handles.menuSaveTecplot
4579             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4580         
4581         set([handles.toolbarLoadData
4582             handles.toolbarSaveFigures
4583             handles.toolbarPlottingParameters
4584             handles.toolbarSaveExcel
4585             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4586         set([handles.toolbarProcessingParameters
4587             handles.toolbarSaveMatFile
4588             handles.toolbarSaveBathymetry
4589             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4590         
4591         set([handles.DepthRangeMin
4592             handles.DepthRangeMax
4593             handles.VectorScalePlanView
4594             handles.VectorSpacingPlanview
4595             handles.SmoothingWindowSize
4596             handles.PlotPlanView
4597             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4598         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4599             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4600         <span class="keyword">else</span>
4601             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4602         <span class="keyword">end</span>
4603         
4604         set([handles.HorizontalGridNodeSpacing
4605             handles.VerticalGridNodeSpacing
4606             handles.PlotShiptracks
4607             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4608         
4609         set([handles.Contour
4610             handles.VerticalExaggeration
4611             handles.VectorScaleCrossSection
4612             handles.HorizontalVectorSpacing
4613             handles.VerticalVectorSpacing
4614             handles.HorizontalSmoothingWindow
4615             handles.VerticalSmoothingWindow
4616             handles.PlotSecondaryFlowVectors
4617             handles.SecondaryFlowVectorVariable
4618             handles.IncludeVerticalVelocity
4619             handles.IncludeVerticalVelocityText
4620             handles.PlotCrossSection
4621             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4622     <span class="keyword">otherwise</span>
4623 <span class="keyword">end</span>
4624 
4625 <span class="comment">% Save Application Data</span>
4626 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4627 
4628 <span class="comment">% [EOF] set_enable</span>
4629 
4630 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4631 
4632 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4633 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4634 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4635 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4636 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4637 
4638 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4639 
4640 
4641 <span class="comment">% --------------------------------------------------------------------</span>
4642 <a name="_sub100" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4643     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4644 
4645 w = 500;
4646 h = 110;
4647 dx = 10;
4648 dy = 35;
4649 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4650 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4651     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4652     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4653     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4654     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4655     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4656     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4657     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4658     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4659     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4660     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4661 dialog_params.english_units               = english_units;
4662 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4663 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4664 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4665 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4666 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4667 
4668 <span class="comment">% Build the graphics:</span>
4669 <span class="comment">% -------------------</span>
4670 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4671     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4672     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4673     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4674 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4675     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4676     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4677     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4678     <span class="string">'Position'</span>,[15 35 100 22]);
4679 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4680     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4681     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4682     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4683     <span class="string">'Position'</span>,[15 10 100 22]);
4684 
4685 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4686     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4687     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4688     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4689 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4690     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4691     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4692     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4693     <span class="string">'Position'</span>,[15 35 100 22]);
4694 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4695     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4696     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4697     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4698     <span class="string">'Position'</span>,[15 10 100 22]);
4699 
4700 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4701     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4702     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4703     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4704 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4705     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4706     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4707     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4708     <span class="string">'Position'</span>,[15 35 100 22]);
4709 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4710     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4711     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4712     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4713     <span class="string">'Position'</span>,[15 10 100 22]);
4714 
4715 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4716     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4717     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4718     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4719     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4720 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4721     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4722     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4723     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4724     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4725 
4726 <span class="comment">% Update the UI controls:</span>
4727 <span class="comment">% -----------------------</span>
4728 <span class="keyword">if</span> dialog_params.english_units
4729     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4730     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4731 <span class="keyword">else</span>
4732     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4733     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4734 <span class="keyword">end</span>
4735 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4736     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4737     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4738 <span class="keyword">else</span>
4739     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4740     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4741 <span class="keyword">end</span>
4742 <span class="keyword">if</span> dialog_params.presentation
4743     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4744     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4745 <span class="keyword">else</span>
4746     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4747     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4748 <span class="keyword">end</span>
4749 
4750 <span class="comment">% Set the callbacks:</span>
4751 <span class="comment">% ------------------</span>
4752 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4753 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4754 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4755 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4756 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4757 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4758 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4759 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4760 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4761 
4762 <span class="comment">% Position the dialog and make it visible:</span>
4763 <span class="comment">% ----------------------------------------</span>
4764 fpos = get(hf,<span class="string">'Position'</span>);
4765 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4766 movegui(handles.Figure,dpos)
4767 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4768 
4769 <span class="comment">% Hold the dialog open:</span>
4770 <span class="comment">% ---------------------</span>
4771 waitfor(handles.OK)
4772 
4773 <span class="comment">% Return the outputs and close the dialog:</span>
4774 <span class="comment">% ----------------------------------------</span>
4775 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4776 english_units = dialog_params.english_units;
4777 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4778 plot_presentation_style =  dialog_params.presentation;
4779 plot_print_style =  dialog_params.print;
4780 
4781 delete(handles.Figure)
4782 
4783 <span class="comment">% [EOF] plotParametersDialog</span>
4784 
4785 
4786 <span class="comment">% --------------------------------------------------------------------</span>
4787 <a name="_sub101" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4788 
4789 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4790 <span class="keyword">switch</span> the_units
4791     <span class="keyword">case</span> <span class="string">'metric'</span>
4792         dialog_params.english_units = false;
4793         
4794         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4795         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4796     <span class="keyword">case</span> <span class="string">'english'</span>
4797         dialog_params.english_units = true;
4798         
4799         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4800         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4801     <span class="keyword">otherwise</span>
4802 <span class="keyword">end</span>
4803 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4804 
4805 <span class="comment">% [EOF] dialogUnits</span>
4806 
4807 <span class="comment">% --------------------------------------------------------------------</span>
4808 <a name="_sub102" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4809 
4810 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4811 <span class="keyword">switch</span> the_endpoints
4812     <span class="keyword">case</span> <span class="string">'auto'</span>
4813         dialog_params.set_cross_section_endpoints = false;
4814         
4815         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4816         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4817     <span class="keyword">case</span> <span class="string">'manual'</span>
4818         dialog_params.set_cross_section_endpoints = true;
4819         
4820         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4821         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4822     <span class="keyword">otherwise</span>
4823 <span class="keyword">end</span>
4824 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4825 
4826 <span class="comment">% [EOF] dialogEnpoints</span>
4827 
4828 <a name="_sub103" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4829 
4830 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4831 <span class="keyword">switch</span> the_style
4832     <span class="keyword">case</span> <span class="string">'presentation'</span>
4833         dialog_params.presentation  = true;
4834         dialog_params.print         = false;
4835         
4836         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4837         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4838     <span class="keyword">case</span> <span class="string">'print'</span>
4839         dialog_params.presentation  = false;
4840         dialog_params.print         = true;
4841         
4842         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4843         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4844     <span class="keyword">otherwise</span>
4845 <span class="keyword">end</span>
4846 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4847 
4848 <span class="comment">% [EOF] dialogEnpoints</span>
4849 
4850 <span class="comment">% --------------------------------------------------------------------</span>
4851 <a name="_sub104" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4852 
4853 delete(h_OK)
4854 
4855 <span class="comment">% [EOF] dialogOK</span>
4856 
4857 <span class="comment">% --------------------------------------------------------------------</span>
4858 <a name="_sub105" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4859 <span class="comment">% Return the original inputs</span>
4860 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4861 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4862 delete(handles.OK)
4863 
4864 <span class="comment">% [EOF] dialogCancel</span>
4865 
4866 <span class="comment">% --------------------------------------------------------------------</span>
4867 <a name="_sub106" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4868 
4869 delete(h_OK)
4870 
4871 <span class="comment">% [EOF] dialogCloseReq</span>
4872 
4873 <a name="_sub107" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4874     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4875 w = 230;
4876 h = 245;
4877 dx = 10;
4878 dy = 35;
4879 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4880 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4881     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4882     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4883     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4884     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4885     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4886     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4887     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4888     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4889     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4890     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4891 dialog_params.beam_angle             = beam_angle;
4892 dialog_params.magnetic_variation     = magnetic_variation;
4893 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4894     dialog_params.wse                = <span class="string">'tide'</span>;
4895     wse_string                       = <span class="string">'tide'</span>;
4896 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4897     dialog_params.wse                = <span class="string">'tide'</span>;
4898     wse_string                       = <span class="string">'tide'</span>;
4899 <span class="keyword">else</span>
4900     dialog_params.wse                = wse;
4901     wse_string                       = num2str(wse);
4902 <span class="keyword">end</span>
4903 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4904 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4905 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4906 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4907 
4908 <span class="comment">% Build the graphics:</span>
4909 <span class="comment">% -------------------</span>
4910 ph = 150;
4911 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4912     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4913     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4914     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4915 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4916     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4917     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4918     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4919     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4920     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4921     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4922 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4923     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4924     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4925     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4926     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4927     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4928     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4929 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4930     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4931     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4932     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4933     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4934     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4935     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4936 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4937     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4938     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4939     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4940     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4941     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4942     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4943 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4944     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4945     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4946     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4947     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4948     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4949     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4950 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4951     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4952     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4953     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4954     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4955     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4956     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4957 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4958     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4959     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4960     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4961     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4962 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4963     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4964     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4965     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4966     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4967 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4968     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4969     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4970     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4971     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4972 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4973     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4974     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4975     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4976     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4977 
4978 <span class="comment">% Update the UI controls:</span>
4979 <span class="comment">% -----------------------</span>
4980 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4981 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4982 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4983 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4984 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4985 
4986 <span class="comment">% Set the callbacks:</span>
4987 <span class="comment">% ------------------</span>
4988 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4989 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4990 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4991 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4992 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4993 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4994 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4995 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4996 
4997 <span class="comment">% Position the dialog and make it visible:</span>
4998 <span class="comment">% ----------------------------------------</span>
4999 fpos = get(hf,<span class="string">'Position'</span>);
5000 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5001 movegui(handles.Figure,dpos)
5002 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5003 
5004 <span class="comment">% Hold the dialog open:</span>
5005 <span class="comment">% ---------------------</span>
5006 waitfor(handles.OK)
5007 
5008 <span class="comment">% Return the outputs and close the dialog:</span>
5009 <span class="comment">% ----------------------------------------</span>
5010 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5011 beam_angle              = dialog_params.beam_angle;
5012 magnetic_variation      = dialog_params.magnetic_variation;
5013 wse                     = dialog_params.wse;
5014 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
5015 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
5016 
5017 delete(handles.Figure)
5018 
5019 <span class="comment">% [EOF] exportSettingsDialog</span>
5020 
5021 <span class="comment">% --------------------------------------------------------------------</span>
5022 <a name="_sub108" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
5023 
5024 <span class="comment">% Grab the current data</span>
5025 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5026 
5027 <span class="comment">% Set it according to the dialog box values</span>
5028 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
5029 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
5030 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
5031 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
5032 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
5033 
5034 <span class="comment">% Re-store the application data</span>
5035 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5036 
5037 <span class="comment">% [EOF] dialogExportSettings</span>
5038 
5039 <a name="_sub109" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
5040 
5041 w = 230;
5042 h = 200;
5043 dx = 10;
5044 dy = 35;
5045 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
5046 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
5047     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
5048     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5049     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
5050     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
5051     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5052     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
5053     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5054     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
5055     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
5056     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
5057 dialog_params.figure_names               = figure_names;
5058 dialog_params.selected_figures           = <span class="string">''</span>;
5059 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5060 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
5061 
5062 <span class="comment">% Build the graphics:</span>
5063 <span class="comment">% -------------------</span>
5064 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
5065     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
5066     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5067     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
5068 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
5069     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
5070     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
5071     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
5072     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
5073     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
5074     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
5075     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5076 
5077 
5078 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5079     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5080     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5081     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5082     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5083 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5084     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5085     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5086     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5087     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5088 
5089 <span class="comment">% Update the UI controls:</span>
5090 <span class="comment">% -----------------------</span>
5091 
5092 
5093 <span class="comment">% Set the callbacks:</span>
5094 <span class="comment">% ------------------</span>
5095 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub106" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5096 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub110" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5097 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub104" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5098 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub105" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5099 
5100 <span class="comment">% Position the dialog and make it visible:</span>
5101 <span class="comment">% ----------------------------------------</span>
5102 fpos = get(hf,<span class="string">'Position'</span>);
5103 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5104 movegui(handles.Figure,dpos)
5105 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5106 
5107 <span class="comment">% Hold the dialog open:</span>
5108 <span class="comment">% ---------------------</span>
5109 waitfor(handles.OK)
5110 
5111 <span class="comment">% Return the outputs and close the dialog:</span>
5112 <span class="comment">% ----------------------------------------</span>
5113 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5114 selected_figures = dialog_params.selected_figures;
5115 
5116 delete(handles.Figure)
5117 
5118 <span class="comment">% [EOF] openFiguresDialog</span>
5119 
5120 <span class="comment">% --------------------------------------------------------------------</span>
5121 <a name="_sub110" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5122 
5123 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5124 
5125 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5126 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5127 selected     = fig_names(idx_selected);
5128 dialog_params.selected_figures = selected;
5129 
5130 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5131 
5132 
5133 
5134 <span class="comment">% --------------------------------------------------------------------</span>
5135 <a name="_sub111" href="#_subfunctions" class="code">function icons = getIcons</a>
5136 
5137 <span class="comment">% Load data</span>
5138 idx = 1;
5139 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5140     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5141     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5142     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5143     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5144     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5145     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5146     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5147     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5148     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5149     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5150     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5151     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5152     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5153     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5154     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5155     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5156 
5157 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5158     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5159     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5160     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5161     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5162     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5163     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5164     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5165     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5166     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5167     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5168     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5169     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5170     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5171     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5172     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5173     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5174 
5175 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5176     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5177     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5178     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5179     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5180     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5181     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5182     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5183     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5184     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5185     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5186     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5187     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5188     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5189     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5190     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5191     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5192 
5193 <span class="comment">% Save data</span>
5194 idx = idx+1;
5195 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5196     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5197     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5198     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5199     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5200     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5201     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5202     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5203     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5204     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5205     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5206     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5207     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5208     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5209     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5210     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5211     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5212 
5213 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5214     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5215     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5216     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5217     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5218     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5219     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5220     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5221     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5222     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5223     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5224     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5225     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5226     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5227     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5228     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5229     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5230 
5231 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5232     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5233     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5234     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5235     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5236     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5237     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5238     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5239     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5240     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5241     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5242     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5243     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5244     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5245     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5246     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5247     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5248 
5249 <span class="comment">% Plotting parameters</span>
5250 idx = idx+1;
5251 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5252     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5253     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5254     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5255     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5256     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5257     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5258     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5259     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5260     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5261     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5262     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5263     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5264     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5265     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5266     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5267     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5268 
5269 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5270     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5271     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5272     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5273     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5274     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5275     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5276     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5277     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5278     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5279     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5280     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5281     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5282     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5283     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5284     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5285     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5286 
5287 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5288     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5289     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5290     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5291     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5292     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5293     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5294     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5295     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5296     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5297     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5298     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5299     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5300     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5301     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5302     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5303     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5304 
5305 <span class="comment">% Processing parameters</span>
5306 idx = idx+1;
5307 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5308     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5309     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5310     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5311     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5312     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5313     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5314     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5315     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5316     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5317     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5318     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5319     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5320     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5321     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5322     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5323     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5324 
5325 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5326     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5327     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5328     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5329     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5330     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5331     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5332     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5333     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5334     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5335     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5336     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5337     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5338     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5339     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5340     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5341     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5342 
5343 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5344     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5345     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5346     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5347     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5348     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5349     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5350     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5351     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5352     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5353     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5354     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5355     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5356     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5357     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5358     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5359     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5360 
5361 <span class="comment">% Export bathymetry dialog</span>
5362 idx = idx+1;
5363 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5364     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5365     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5366     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5367     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5368     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5369     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5370     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5371     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5372     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5373     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5374     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5375     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5376     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5377     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5378     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5379     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5380     ]/255;
5381 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5382     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5383     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5384     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5385     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5386     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5387     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5388     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5389     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5390     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5391     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5392     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5393     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5394     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5395     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5396     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5397     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5398     ]/255;
5399 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5400     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5401     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5402     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5403     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5404     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5405     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5406     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5407     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5408     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5409     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5410     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5411     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5412     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5413     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5414     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5415     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5416     ]/255;
5417 
5418 <span class="comment">% Export Figures Dialog</span>
5419 idx = idx + 1;
5420 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5421     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5422     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5423     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5424     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5425     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5426     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5427     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5428     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5429     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5430     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5431     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5432     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5433     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5434     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5435     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5436 
5437 
5438 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5439     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5440     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5441     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5442     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5443     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5444     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5445     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5446     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5447     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5448     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5449     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5450     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5451     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5452     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5453     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5454 
5455 
5456 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5457     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5458     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5459     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5460     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5461     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5462     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5463     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5464     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5465     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5466     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5467     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5468     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5469     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5470     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5471     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5472 
5473 <span class="comment">% Export Excel File</span>
5474 idx = idx + 1;
5475 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5476     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5477    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5478    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5479    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5480    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5481    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5482    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5483    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5484    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5485    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5486    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5487    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5488    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5489    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5490    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5491     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5492 
5493 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5494     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5495    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5496    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5497    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5498    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5499    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5500    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5501    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5502    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5503    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5504    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5505    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5506    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5507    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5508    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5509     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5510 
5511 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5512     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5513    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5514    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5515    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5516    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5517    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5518    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5519    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5520    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5521    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5522    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5523    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5524    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5525    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5526    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5527     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5528 
5529 <span class="comment">% Zoom In</span>
5530 idx = idx + 1;
5531 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5532     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5533 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5534     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5535 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5536     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5537 
5538 <span class="comment">% Zoom Out</span>
5539 idx = idx + 1;
5540 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5541     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5542 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5543     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5544 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5545     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5546 
5547 <span class="comment">% Pan</span>
5548 idx = idx + 1;
5549 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5550     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5551 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5552     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5553 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5554     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5555 <span class="comment">% [EOF] getIcons</span>
5556 
5557 <a name="_sub112" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5558 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5559 
5560 <span class="comment">% Check for any stored prefs</span>
5561 <span class="comment">% --------------------------</span>
5562 <span class="comment">% Units and the graphics renderer are stored as persistent prefs</span>
5563 guiprefs = getpref(<span class="string">'VMT'</span>);
5564 
5565 <span class="comment">% Organized by GUI panels</span>
5566 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5567 <span class="comment">% SHIPTRACKS PLOT %</span>
5568 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5569 guiparams.horizontal_grid_node_spacing       = 1.0;
5570 guiparams.vertical_grid_node_spacing         = 0.4;
5571 
5572 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5573 <span class="comment">% CROSS SECTION PLOT %</span>
5574 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5575 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5576 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5577 guiparams.idx_contour                        = 1;
5578 guiparams.vertical_exaggeration              = 10;
5579 guiparams.vector_scale_cross_section         = 0.2;
5580 guiparams.horizontal_vector_spacing          = 1;
5581 guiparams.vertical_vector_spacing            = 1;
5582 guiparams.horizontal_smoothing_window        = 1;
5583 guiparams.vertical_smoothing_window          = 1;
5584 guiparams.plot_secondary_flow_vectors        = true;
5585 guiparams.allow_vmt_flip_flux                = true;
5586 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5587 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5588 guiparams.idx_secondary_flow_vector_variable = 1;
5589 guiparams.include_vertical_velocity          = true;
5590 
5591 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5592 <span class="comment">% PLAN VIEW PLOT %</span>
5593 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5594 guiparams.depth_range_min                    = 0;
5595 guiparams.depth_range_max                    = inf;
5596 guiparams.vector_scale_plan_view             = 1;
5597 guiparams.vector_spacing_plan_view           = 1;
5598 guiparams.smoothing_window_size              = 1;
5599 guiparams.display_shoreline                  = false;
5600 guiparams.add_background                     = false;
5601 
5602 <span class="comment">%%%%%%%%%%%</span>
5603 <span class="comment">% OFFSETS %</span>
5604 <span class="comment">%%%%%%%%%%%</span>
5605 guiparams.water_surface_elevation            = 0.0;
5606 guiparams.bed_elevation                      = 0.0;
5607 guiparams.KMZ_vertical_offset                = 0.0;
5608 
5609 <span class="comment">%%%%%%%%%%%%%%%</span>
5610 <span class="comment">% DATA EXPORT %</span>
5611 <span class="comment">%%%%%%%%%%%%%%%</span>
5612 guiparams.beam_angle                         = 20.0;
5613 guiparams.magnetic_variation                 = 0.0;
5614 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5615 guiparams.load_wse_tide_file                 = false;
5616 guiparams.output_auxiliary_data              = false;
5617 
5618 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5619 <span class="comment">% Contour variables %</span>
5620 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5621 idx = 1;
5622 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5623 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5624 idx = idx + 1;
5625 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5626 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5627 idx = idx + 1;
5628 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5629 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5630 idx = idx + 1;
5631 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5632 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5633 idx = idx + 1;
5634 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5635 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5636 idx = idx + 1;
5637 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5638 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5639 idx = idx + 1;
5640 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5641 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5642 idx = idx + 1;
5643 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5644 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5645 idx = idx + 1;
5646 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5647 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5648 idx = idx + 1;
5649 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5650 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5651 idx = idx + 1;
5652 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5653 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5654 idx = idx + 1;
5655 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5656 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5657 idx = idx + 1;
5658 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5659 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5660 idx = idx + 1;
5661 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5662 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5663 idx = idx + 1;
5664 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5665 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5666 idx = idx + 1;
5667 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5668 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5669 idx = idx + 1;
5670 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5671 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5672 idx = idx + 1;
5673 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5674 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5675 idx = idx + 1;
5676 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5677 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5678 idx = idx + 1;
5679 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5680 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5681 
5682 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5683 
5684 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5685 <span class="comment">% Secondary Flow Vector Variables %</span>
5686 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5687 idx = 1;
5688 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5689 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5690 idx = idx + 1;
5691 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5692 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5693 idx = idx + 1;
5694 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5695 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5696 idx = idx + 1;
5697 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5698 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5699 idx = idx + 1;
5700 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5701 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5702 
5703 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5704     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5705 
5706 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5707 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5708 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5709 <span class="comment">% Menu bar options</span>
5710 guiparams.presentation                       = true;
5711 guiparams.print                              = false;
5712 guiparams.set_cross_section_endpoints        = false;
5713 guiparams.unit_discharge_correction          = false;
5714 guiparams.start_bank                         = <span class="string">'auto'</span>;
5715 
5716 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5717     <span class="keyword">switch</span> guiprefs.units
5718         <span class="keyword">case</span> <span class="string">'metric'</span>
5719             guiparams.english_units          = false;
5720         <span class="keyword">case</span> <span class="string">'english'</span>
5721             guiparams.english_units          = true;
5722     <span class="keyword">end</span>
5723 <span class="keyword">else</span>
5724     guiparams.english_units                  = false;
5725 <span class="keyword">end</span>
5726 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5727     <span class="keyword">switch</span> guiprefs.plotref
5728         <span class="keyword">case</span> <span class="string">'dfs'</span>
5729             guiparams.plotref                 = <span class="string">'dfs'</span>;
5730         <span class="keyword">case</span> <span class="string">'hab'</span>
5731             guiparams.plotref                 = <span class="string">'hab'</span>;
5732     <span class="keyword">end</span>
5733 <span class="keyword">else</span>
5734     guiparams.plotref                         = <span class="string">'dfs'</span>;
5735 <span class="keyword">end</span>
5736 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5737 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5738 
5739 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5740     guiparams.renderer                       = guiprefs.renderer;
5741 <span class="keyword">else</span>
5742     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5743 <span class="keyword">end</span>
5744 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5745 <span class="comment">% guiparams.plot_planview                      = false;</span>
5746 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5747 
5748 <span class="comment">% File location defaults</span>
5749 guiparams.ascii_path                        = pwd;
5750 guiparams.ascii_file                        = <span class="string">''</span>;
5751 guiparams.mat_path                          = pwd;
5752 guiparams.mat_file                          = <span class="string">''</span>;
5753 guiparams.tecplot_path                      = pwd;
5754 guiparams.tecplot_file                      = <span class="string">''</span>;
5755 guiparams.kmz_path                          = pwd;
5756 guiparams.kmz_file                          = <span class="string">''</span>;
5757 guiparams.multibeambathymetry_path          = pwd;
5758 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5759 guiparams.log_path                          = pwd;
5760 guiparams.log_file                          = <span class="string">''</span>;
5761 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5762 <span class="comment">% application</span>
5763 <span class="keyword">if</span> isdeployed 
5764     guiparams.has_mapping_toolbox           = true;
5765 <span class="keyword">else</span>
5766     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5767         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5768 <span class="keyword">end</span>
5769 
5770 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5771 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5772 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5773 guiparams.z                      = [];
5774 guiparams.A                      = [];
5775 guiparams.V                      = [];
5776 guiparams.Map                    = [];
5777 guiparams.savefile               = [];
5778 guiparams.iric_anv_planview_data = [];
5779 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5780 <span class="comment">% guiparams.zmax = [];</span>
5781 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5782 guiparams.data_folder = <span class="string">''</span>;
5783 guiparams.data_files  = {<span class="string">''</span>};
5784 guiparams.gui_state   = <span class="string">'init'</span>;
5785 
5786 <span class="comment">% [EOF] createGUIparams</span>
5787 
5788 <a name="_sub113" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5789 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5790 
5791 <a name="_sub114" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5792 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5793 
5794 <span class="comment">% [EOF] VMT</span>
5795 
5796 
5797 
5798 <span class="comment">% --- Hidden keyboard commands</span>
5799 <a name="_sub115" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5800 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5801 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5802 <span class="comment">%</span>
5803 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5804 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5805 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5806 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5807 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5808 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5809 
5810 in1 = eventdata.Modifier; 
5811 in2 = eventdata.Key;
5812 
5813 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5814     input = [in1{:} in2];
5815 <span class="keyword">else</span>
5816     input = in2;
5817 <span class="keyword">end</span>
5818 
5819 <span class="keyword">switch</span> input
5820     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5821         <a href="#_sub52" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5822         
5823     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5824         VMT_BuildCustomFlatFile;
5825     <span class="keyword">otherwise</span>
5826         <span class="comment">%disp(input)</span>
5827 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 27-Jul-2016 16:47:33 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>