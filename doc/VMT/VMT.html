<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of VMT</title>
  <meta name="keywords" content="VMT">
  <meta name="description" content="--- THE VELOCITY MAPPING TOOLBOX ---">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- menu.html VMT -->
<h1>VMT
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--- THE VELOCITY MAPPING TOOLBOX ---</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function varargout = VMT(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> --- THE VELOCITY MAPPING TOOLBOX ---
 
 VMT is a Matlab-based software for processing and visualizing ADCP data
 collected along transects in rivers or other bodies of water. VMT allows
 rapid processing, visualization, and analysis of a range of ADCP datasets
 and includes utilities to export ADCP data to files compatible with
 ArcGIS, Tecplot, and Google Earth. The software can be used to explore
 patterns of three-dimensional fluid motion through several methods for
 calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et
 al., 2000). The software also includes capabilities for analyzing the
 acoustic backscatter and bathymetric data from the ADCP. A user-friendly
 graphical user interface (GUI) enhances program functionality and
 provides ready access to two- and three- dimensional plotting functions,
 allowing rapid display and interrogation of velocity, backscatter, and
 bathymetry data.
 
 CITATION: 
 Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.
 L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,
 J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and
 visualization suite for moving-vessel ADCP measurements. Earth Surf.
 Process. Landforms. doi: 10.1002/esp.3367

__________________________________________________________________________
 P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center
 (pjackson@usgs.gov)

 Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.
__________________________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>	Takes the processed data structure and writes a TecPlot ASCII data file.</li><li><a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>	Takes the processed data structure and writes a TecPlot ASCII data file</li><li><a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>	Computes the layer averaged mean of y over the depth range.</li><li><a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>	Computes the multibeam bathymetry from the four beams of the ADCP</li><li><a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>	Outputs the mean cross section (3-D) from VMT to Google Earth (saved as a</li><li><a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>	Prompts the user for a geotiff DOQQ (USGS) and overlays the aerial image</li><li><a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>	This function plots a plan view of the measurement region with a vector</li><li><a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>	Plots the shiptracks, and interpolated grid in the VMT GUI axes. Also</li><li><a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>	Plots a shoreline map given the shoreline data structure 'Map' (see</li><li><a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>	Plots contours for the variable 'var' within the mean cross section given</li><li><a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>	This function plots the the contour plot (mean XS) for the variable 'var'</li><li><a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>	This function is a driver to preprocess the transects data.  Several</li><li><a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>	Driver program to process multiple transects at a single cross-section</li><li><a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>	Read in multiple ASCII output files from WinRiver or WinRiverII.</li><li><a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>	Read in multiple MAT output files from SonTek RSL v1.5-3.60.</li><li><a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>	Saves the figures (specified by fignums) from VMT as .PNG or EPS files</li><li><a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>	This routine smooths all processed variables in V struct. By default is</li><li><a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>	Not currently implemented</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a></li><li><a href="#_sub2" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub3" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub4" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a></li><li><a href="#_sub5" class="code">function menuFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub6" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub7" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub8" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub9" class="code">function menuSave_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub10" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub11" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub12" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub13" class="code">function menuExport_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub14" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub15" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub16" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub17" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub18" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub19" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub20" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub21" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub22" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub23" class="code">function [wsedata] = loadTideFile(infile)</a></li><li><a href="#_sub24" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub25" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub26" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub27" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub28" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub29" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub30" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub31" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub32" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub33" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub34" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub35" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub36" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub37" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub38" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub39" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub40" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub41" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub42" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub43" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub44" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub45" class="code">function menuTools_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub46" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub47" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub48" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub49" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub50" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub51" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub52" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub53" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub54" class="code">function loadDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub55" class="code">function saveDataCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub56" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub57" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub58" class="code">function processingParametersCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub59" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub60" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub61" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a></li><li><a href="#_sub62" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub63" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub64" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub65" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub66" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub67" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub68" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub69" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub70" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub71" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub72" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub73" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub74" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub75" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub76" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub77" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub78" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub79" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub80" class="code">function Contour_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub81" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub82" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub83" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub84" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub85" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub86" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub87" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub88" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub89" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub90" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub91" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub92" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a></li><li><a href="#_sub93" class="code">function handles = buildToolbar(handles)</a></li><li><a href="#_sub94" class="code">function load_prefs(hfigure)</a></li><li><a href="#_sub95" class="code">function store_prefs(hfigure,pref)</a></li><li><a href="#_sub96" class="code">function initGUI(handles)</a></li><li><a href="#_sub97" class="code">function set_enable(handles,enable_state)</a></li><li><a href="#_sub98" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] =</a></li><li><a href="#_sub99" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a></li><li><a href="#_sub100" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a></li><li><a href="#_sub101" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a></li><li><a href="#_sub102" class="code">function dialogOK(hObject,eventdata,h_OK)</a></li><li><a href="#_sub103" class="code">function dialogCancel(hObject,eventdata,handles)</a></li><li><a href="#_sub104" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a></li><li><a href="#_sub105" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] =</a></li><li><a href="#_sub106" class="code">function dialogExportSettings(hObject,eventdata,handles)</a></li><li><a href="#_sub107" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a></li><li><a href="#_sub108" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a></li><li><a href="#_sub109" class="code">function icons = getIcons</a></li><li><a href="#_sub110" class="code">function guiparams = createGUIparams</a></li><li><a href="#_sub111" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a></li><li><a href="#_sub112" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a></li><li><a href="#_sub113" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function varargout = VMT(varargin)</a>
0002 <span class="comment">% --- THE VELOCITY MAPPING TOOLBOX ---</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% VMT is a Matlab-based software for processing and visualizing ADCP data</span>
0005 <span class="comment">% collected along transects in rivers or other bodies of water. VMT allows</span>
0006 <span class="comment">% rapid processing, visualization, and analysis of a range of ADCP datasets</span>
0007 <span class="comment">% and includes utilities to export ADCP data to files compatible with</span>
0008 <span class="comment">% ArcGIS, Tecplot, and Google Earth. The software can be used to explore</span>
0009 <span class="comment">% patterns of three-dimensional fluid motion through several methods for</span>
0010 <span class="comment">% calculation of secondary flows (e.g. Rhoads and Kenworthy, 1998; Lane et</span>
0011 <span class="comment">% al., 2000). The software also includes capabilities for analyzing the</span>
0012 <span class="comment">% acoustic backscatter and bathymetric data from the ADCP. A user-friendly</span>
0013 <span class="comment">% graphical user interface (GUI) enhances program functionality and</span>
0014 <span class="comment">% provides ready access to two- and three- dimensional plotting functions,</span>
0015 <span class="comment">% allowing rapid display and interrogation of velocity, backscatter, and</span>
0016 <span class="comment">% bathymetry data.</span>
0017 <span class="comment">%</span>
0018 <span class="comment">% CITATION:</span>
0019 <span class="comment">% Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L., Rhoads, B.</span>
0020 <span class="comment">% L., Oberg, K. A., Best, J. L., Mueller, D. S., Johnson, K. K. and Riley,</span>
0021 <span class="comment">% J. D. (2013), Velocity Mapping Toolbox (VMT): a processing and</span>
0022 <span class="comment">% visualization suite for moving-vessel ADCP measurements. Earth Surf.</span>
0023 <span class="comment">% Process. Landforms. doi: 10.1002/esp.3367</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%__________________________________________________________________________</span>
0026 <span class="comment">% P.R. Jackson, U.S. Geological Survey, Illinois Water Science Center</span>
0027 <span class="comment">% (pjackson@usgs.gov)</span>
0028 <span class="comment">%</span>
0029 <span class="comment">% Code contributed by D. Parsons, D. Mueller, J. Czuba, and F. Engel.</span>
0030 <span class="comment">%__________________________________________________________________________</span>
0031 
0032 <span class="comment">% Begin initialization code - DO NOT EDIT</span>
0033 <span class="comment">% Adress 2015b java bug #1293244</span>
0034 javax.swing.UIManager.setLookAndFeel(<span class="string">'com.sun.java.swing.plaf.windows.WindowsLookAndFeel'</span>)
0035 gui_Singleton = 1;
0036 gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
0037     <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
0038     <span class="string">'gui_OpeningFcn'</span>, @<a href="#_sub1" class="code" title="subfunction VMT_OpeningFcn(hObject, eventdata, handles, varargin)">VMT_OpeningFcn</a>, <span class="keyword">...</span>
0039     <span class="string">'gui_OutputFcn'</span>,  @<a href="#_sub2" class="code" title="subfunction varargout = VMT_OutputFcn(hObject, eventdata, handles)">VMT_OutputFcn</a>, <span class="keyword">...</span>
0040     <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
0041     <span class="string">'gui_Callback'</span>,   []);
0042 <span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
0043     gui_State.gui_Callback = str2func(varargin{1});
0044 <span class="keyword">end</span>
0045 
0046 <span class="comment">% If ERROR, write a txt file with the error dump info</span>
0047 <span class="keyword">try</span>
0048 <span class="keyword">if</span> nargout
0049     [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
0050 <span class="keyword">else</span>
0051     gui_mainfcn(gui_State, varargin{:});
0052 <span class="keyword">end</span>
0053 
0054 <span class="keyword">catch</span> err
0055     <span class="keyword">if</span> isdeployed
0056         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
0057             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
0058         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
0059             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
0060             errLogFileName},<span class="keyword">...</span>
0061             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0062             <span class="string">'error'</span>);
0063         fid = fopen(errLogFileName,<span class="string">'W'</span>);
0064         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
0065         fclose(fid);
0066         rethrow(err)
0067     <span class="keyword">else</span>
0068         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
0069             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
0070             <span class="string">'error'</span>);
0071         rethrow(err);
0072     <span class="keyword">end</span>
0073 <span class="keyword">end</span>
0074 <span class="comment">% End initialization code - DO NOT EDIT</span>
0075 
0076 <span class="comment">%#ok&lt;*DEFNU,*INUSL,*INUSD&gt;</span>
0077 
0078 <span class="comment">% --- Executes just before VMT is made visible.</span>
0079 <a name="_sub1" href="#_subfunctions" class="code">function VMT_OpeningFcn(hObject, eventdata, handles, varargin)</a>
0080 <span class="comment">% This function has no output args, see OutputFcn.</span>
0081 <span class="comment">% hObject    handle to figure</span>
0082 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0083 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0084 <span class="comment">% varargin   command line arguments to VMT (see VARARGIN)</span>
0085 
0086 <span class="comment">% Choose default command line output for VMT</span>
0087 handles.output = hObject;
0088 
0089 <span class="comment">% Build the GUI toolbar:</span>
0090 <span class="comment">% ----------------------</span>
0091 handles = <a href="#_sub93" class="code" title="subfunction handles = buildToolbar(handles)">buildToolbar</a>(handles);
0092 
0093 <span class="comment">% Ensure path to utils &amp; docs is available</span>
0094 <span class="comment">% ----------------------------------------</span>
0095 <span class="keyword">if</span> ~isdeployed
0096     utilspath = [pwd filesep <span class="string">'utils'</span>];
0097     docspath  = [pwd filesep <span class="string">'doc'</span>];
0098     toolspath = [pwd filesep <span class="string">'tools'</span>];
0099     addpath(utilspath,docspath,toolspath)
0100 <span class="keyword">end</span>
0101 
0102 <span class="comment">% Update handles structure</span>
0103 <span class="comment">% ------------------------</span>
0104 guidata(hObject, handles);
0105 
0106 <span class="comment">% Load the GUI preferences:</span>
0107 <span class="comment">% -------------------------</span>
0108 <a href="#_sub94" class="code" title="subfunction load_prefs(hfigure)">load_prefs</a>(handles.figure1)
0109 
0110 <span class="comment">% Initialize the GUI parameters:</span>
0111 <span class="comment">% ------------------------------</span>
0112 guiparams = <a href="#_sub110" class="code" title="subfunction guiparams = createGUIparams">createGUIparams</a>;
0113 guiparams.vmt_version = {<span class="string">'v4.08'</span>; <span class="string">'r20160121'</span>};
0114 
0115 <span class="comment">% Draw the VMT Background</span>
0116 <span class="comment">% -----------------</span>
0117 pos = get(handles.figure1,<span class="string">'position'</span>);
0118 axes(handles.VMTBackground);
0119 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0120     X = imread(<span class="string">'VMT_Background.png'</span>);
0121     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0122 <span class="comment">% else</span>
0123 <span class="comment">%     X = imread('VMT_Background.png');</span>
0124 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0125 <span class="comment">%     X = uint8(X);</span>
0126 <span class="comment">%     imshow(X,'Border','tight')</span>
0127 <span class="comment">% end</span>
0128 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0129 
0130 <span class="comment">% Store the application data:</span>
0131 <span class="comment">% ---------------------------</span>
0132 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0133 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
0134 <span class="comment">% setappdata(handles.figure1,'guiprefs',guiprefs)</span>
0135 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'runcounter'</span>)
0136 
0137 <span class="comment">% Auto-check for updates</span>
0138 <span class="comment">% ----------------------</span>
0139 thres = 20; 
0140 runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>);
0141 time_to_check = (mod(runcounter,thres)==0);
0142 <span class="keyword">if</span> time_to_check
0143     <a href="#_sub52" class="code" title="subfunction menuCheckForUpdates_Callback(hObject, eventdata, handles)">menuCheckForUpdates_Callback</a>(hObject, eventdata, handles)
0144 <span class="keyword">end</span>
0145 
0146 <span class="comment">% Initialize the GUI:</span>
0147 <span class="comment">% -------------------</span>
0148 <a href="#_sub96" class="code" title="subfunction initGUI(handles)">initGUI</a>(handles)
0149 <a href="#_sub97" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'init'</span>)
0150 
0151 <span class="comment">% Allow VMT GUI to be resized depending on the screen resolution</span>
0152 <span class="comment">% set(0,'units','pixels')</span>
0153 <span class="comment">% Pix_SS = get(0,'screensize');</span>
0154 <span class="comment">% movegui(handles.figure1,'center')</span>
0155 set(handles.figure1,<span class="string">'Resize'</span>,<span class="string">'on'</span>)
0156 
0157 <span class="comment">% Allow access to the VMT Main GUI info by other sub-GUIs by pushing it to</span>
0158 <span class="comment">% the root</span>
0159 setappdata(0  , <span class="string">'hVMTgui'</span>    , gcf);
0160 
0161 <span class="comment">% UIWAIT makes VMT wait for user response (see UIRESUME)</span>
0162 <span class="comment">% uiwait(handles.figure1);</span>
0163 <span class="comment">% [EOF] VMT_OpeningFcn</span>
0164 
0165 
0166 <span class="comment">% --- Outputs from this function are returned to the command line.</span>
0167 <a name="_sub2" href="#_subfunctions" class="code">function varargout = VMT_OutputFcn(hObject, eventdata, handles)</a>
0168 <span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
0169 <span class="comment">% hObject    handle to figure</span>
0170 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0171 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0172 
0173 <span class="comment">% Get default command line output from handles structure</span>
0174 varargout{1} = handles.output;
0175 <span class="comment">% [EOF] VMT_OutputFcn</span>
0176 
0177 <span class="comment">% --- Executes when figure1 is resized.</span>
0178 <a name="_sub3" href="#_subfunctions" class="code">function figure1_ResizeFcn(hObject, eventdata, handles)</a>
0179 
0180 <span class="comment">% Draw the VMT Background</span>
0181 <span class="comment">% -----------------</span>
0182 pos = get(handles.figure1,<span class="string">'position'</span>);
0183 axes(handles.VMTBackground);
0184 <span class="comment">% if ~isdeployed %isempty(dir(fullfile(matlabroot,'toolbox','images')))</span>
0185     X = imread(<span class="string">'VMT_Background.png'</span>);
0186     imdisp(X,<span class="string">'size'</span>,[pos(4) pos(3)]) <span class="comment">% Avoids problems with users not having Image Processing TB</span>
0187 <span class="comment">% else</span>
0188 <span class="comment">%     X = imread('VMT_Background.png');</span>
0189 <span class="comment">%     X = imresize(X, [pos(4) pos(3)]);</span>
0190 <span class="comment">%     X = uint8(X);</span>
0191 <span class="comment">%     imshow(X,'Border','tight')</span>
0192 <span class="comment">% end</span>
0193 uistack(handles.VMTBackground,<span class="string">'bottom'</span>)
0194 
0195 <span class="comment">% --- Executes when user attempts to close figure1.</span>
0196 <a name="_sub4" href="#_subfunctions" class="code">function figure1_CloseRequestFcn(hObject, eventdata, handles)</a>
0197 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
0198 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
0199 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
0200 
0201 <span class="comment">% Hint: delete(hObject) closes the figure</span>
0202 who_called = get(hObject,<span class="string">'tag'</span>);
0203 close_button = questdlg(<span class="keyword">...</span>
0204     <span class="string">'You are about to exit VMT. Any unsaved work will be lost. Are you sure?'</span>,<span class="keyword">...</span>
0205     <span class="string">'Exit VMT?'</span>,<span class="string">'No'</span>);
0206 <span class="keyword">switch</span> close_button
0207     <span class="keyword">case</span> <span class="string">'Yes'</span>
0208         closereq
0209         close all hidden
0210     <span class="keyword">otherwise</span>
0211         <span class="keyword">return</span>
0212 <span class="keyword">end</span>
0213 <span class="comment">% [EOF] figure1_CloseRequestFcn</span>
0214 
0215 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0216 <span class="comment">% MENU BAR CALLBACKS %</span>
0217 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
0218 
0219 <span class="comment">% --------------------------------------------------------------------</span>
0220 <a name="_sub5" href="#_subfunctions" class="code">function menuFile_Callback(hObject, eventdata, handles)</a>
0221 <span class="comment">% Empty</span>
0222 
0223 <span class="comment">% --------------------------------------------------------------------</span>
0224 <a name="_sub6" href="#_subfunctions" class="code">function menuOpen_Callback(hObject, eventdata, handles)</a>
0225 <span class="comment">% Empty</span>
0226 
0227 <span class="comment">% --------------------------------------------------------------------</span>
0228 <a name="_sub7" href="#_subfunctions" class="code">function menuOpenASCII_Callback(hObject, eventdata, handles)</a>
0229 <a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>(hObject, eventdata, handles)
0230 <span class="comment">% [EOF] menuOpenASCII_Callback</span>
0231 
0232 <span class="comment">% --------------------------------------------------------------------</span>
0233 <a name="_sub8" href="#_subfunctions" class="code">function menuOpenMAT_Callback(hObject, eventdata, handles)</a>
0234 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
0235 <span class="comment">% Get the Application data:</span>
0236 <span class="comment">% -------------------------</span>
0237 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0238 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0239 
0240 <span class="comment">% Ask the user to select files:</span>
0241 <span class="comment">% -----------------------------</span>
0242 <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
0243 <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
0244 <span class="keyword">if</span> iscell(guiprefs.mat_file)
0245     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
0246 <span class="keyword">else</span>
0247     uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
0248 <span class="keyword">end</span>
0249 [filename,pathname] = <span class="keyword">...</span>
0250     uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
0251     <span class="string">'Select MAT File'</span>, <span class="keyword">...</span>
0252     uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
0253 
0254 <span class="keyword">if</span> ischar(filename) <span class="comment">% Single MAT file loaded</span>
0255     <span class="comment">% Load the data:</span>
0256     <span class="comment">% --------------</span>
0257     vars = load(fullfile(pathname,filename));
0258     
0259     <span class="comment">% Make sure the selected file is a valid file:</span>
0260     <span class="comment">% --------------------------------------------</span>
0261     varnames = fieldnames(vars);
0262     <span class="keyword">if</span> isequal(sort(varnames),{<span class="string">'A'</span> <span class="string">'Map'</span> <span class="string">'V'</span> <span class="string">'z'</span>}')
0263         guiparams.mat_path = pathname;
0264         guiparams.mat_file = filename;
0265         guiparams.z = vars.z;
0266         guiparams.A = vars.A;
0267         guiparams.V = vars.V;
0268         
0269         <span class="comment">% Update the preferences:</span>
0270         <span class="comment">% -----------------------</span>
0271         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0272         guiprefs.mat_path = pathname;
0273         guiprefs.mat_file = filename;
0274         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0275         <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0276                      
0277         <span class="comment">% Re-store the Application Data:</span>
0278         <span class="comment">% ------------------------------</span>
0279         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0280         
0281         <span class="comment">% Update the GUI:</span>
0282         <span class="comment">% ---------------</span>
0283         set(handles.HorizontalGridNodeSpacing,<span class="string">'String'</span>,vars.A(1).hgns)
0284         <a href="#_sub97" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
0285     <span class="keyword">else</span> <span class="comment">% Not a valid file</span>
0286         errordlg(<span class="string">'The selected file is not a valid ADCP data MAT file.'</span>, <span class="keyword">...</span>
0287             <span class="string">'Invalid File...'</span>)
0288     <span class="keyword">end</span>
0289     
0290     <span class="comment">% Set the vertical grid node spacing</span>
0291     <span class="comment">% ----------------------------------</span>
0292     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
0293     <span class="comment">% Backwards compatible</span>
0294     <span class="keyword">if</span> vars.A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
0295         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(vars.A(1).Sup.binSize_cm(1))/100)
0296     <span class="keyword">else</span> <span class="comment">% Older file, must be RG</span>
0297         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
0298     <span class="keyword">end</span>
0299     
0300 <span class="keyword">elseif</span> iscell(filename) <span class="comment">% Multiple MAT files loaded</span>
0301     <span class="comment">% Set the filenames</span>
0302     <span class="comment">% -----------------</span>
0303     guiparams.mat_path = pathname;
0304     guiparams.mat_file = filename;
0305     
0306     <span class="comment">% Push status to log window</span>
0307     <span class="comment">% -------------------------</span>
0308     log_text = {<span class="keyword">...</span>
0309         <span class="string">'Loading previously processed MAT files.'</span>;<span class="keyword">...</span>
0310         <span class="string">'Directory:'</span>};
0311     log_text = vertcat(log_text, pathname, {<span class="string">'Files:'</span>}, filename');
0312     statusLogging(handles.LogWindow,log_text)
0313     
0314     <span class="comment">% Update the Application Data:</span>
0315     <span class="comment">% ------------------------------</span>
0316     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0317     
0318     <span class="comment">% Update the persistent preferences:</span>
0319     <span class="comment">% ----------------------------------</span>
0320     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0321     guiprefs.mat_path = pathname;
0322     guiprefs.mat_file = filename;
0323     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0324     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
0325         
0326     <span class="comment">% Update the GUI:</span>
0327     <span class="comment">% ---------------</span>
0328     <a href="#_sub97" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'multiplematfiles'</span>)
0329 <span class="keyword">end</span>
0330 
0331 <span class="comment">% [EOF] menuOpenMAT_Callback</span>
0332 
0333 <span class="comment">% --------------------------------------------------------------------</span>
0334 <a name="_sub9" href="#_subfunctions" class="code">function menuSave_Callback(hObject, eventdata, handles)</a>
0335 <span class="comment">% Empty</span>
0336 
0337 <span class="comment">% --------------------------------------------------------------------</span>
0338 <a name="_sub10" href="#_subfunctions" class="code">function menuSaveMAT_Callback(hObject, eventdata, handles)</a>
0339 <a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>(hObject, eventdata, handles)
0340 <span class="comment">% [EOF] menuSaveMAT_Callback</span>
0341 
0342 <span class="comment">% --------------------------------------------------------------------</span>
0343 <a name="_sub11" href="#_subfunctions" class="code">function menuSaveTecplot_Callback(hObject, eventdata, handles)</a>
0344 <a href="#_sub63" class="code" title="subfunction SaveTecplotFile_Callback(hObject, eventdata, handles)">SaveTecplotFile_Callback</a>(handles,eventdata,handles)
0345 <span class="comment">% [EOF] menuSaveTecplot_Callback</span>
0346 
0347 <span class="comment">% --------------------------------------------------------------------</span>
0348 <a name="_sub12" href="#_subfunctions" class="code">function menuSaveKMZFile_Callback(hObject, eventdata, handles)</a>
0349 <a href="#_sub64" class="code" title="subfunction SaveGoogleEarthFile_Callback(hObject, eventdata, handles)">SaveGoogleEarthFile_Callback</a>(handles,eventdata,handles)
0350 <span class="comment">% [EOF] menuSaveKMZFile_Callback</span>
0351 
0352 <span class="comment">% --------------------------------------------------------------------</span>
0353 <a name="_sub13" href="#_subfunctions" class="code">function menuExport_Callback(hObject, eventdata, handles)</a>
0354 <span class="comment">% Empty</span>
0355 
0356 <span class="comment">% --------------------------------------------------------------------</span>
0357 <a name="_sub14" href="#_subfunctions" class="code">function menuFigureExportsettings_Callback(hObject, eventdata, handles)</a>
0358 <span class="comment">% Empty</span>
0359 
0360 <span class="comment">% --------------------------------------------------------------------</span>
0361 <a name="_sub15" href="#_subfunctions" class="code">function menuPrintFormat_Callback(hObject, eventdata, handles)</a>
0362 
0363 <span class="comment">% Get the Application Data:</span>
0364 <span class="comment">% -------------------------</span>
0365 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0366 
0367 <span class="comment">% Update the Application Data:</span>
0368 <span class="comment">% ----------------------------</span>
0369 guiparams.print        = true;
0370 guiparams.presentation = false;
0371 
0372 <span class="comment">% Re-store the Application data:</span>
0373 <span class="comment">% ------------------------------</span>
0374 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0375 
0376 <span class="comment">% Update the GUI:</span>
0377 <span class="comment">% ---------------</span>
0378 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0379 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
0380 
0381 <span class="comment">% [EOF] menuPrintFormat_Callback</span>
0382 
0383 
0384 <span class="comment">% --------------------------------------------------------------------</span>
0385 <a name="_sub16" href="#_subfunctions" class="code">function menuPresentationFormat_Callback(hObject, eventdata, handles)</a>
0386 
0387 <span class="comment">% Get the Application Data:</span>
0388 <span class="comment">% -------------------------</span>
0389 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0390 
0391 <span class="comment">% Update the Application Data:</span>
0392 <span class="comment">% ----------------------------</span>
0393 guiparams.print        = false;
0394 guiparams.presentation = true;
0395 
0396 <span class="comment">% Re-store the Application data:</span>
0397 <span class="comment">% ------------------------------</span>
0398 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0399 
0400 <span class="comment">% Update the GUI:</span>
0401 <span class="comment">% ---------------</span>
0402 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0403 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
0404 
0405 <span class="comment">% [EOF] menuPresentationFormat_Callback</span>
0406 
0407 <span class="comment">% --------------------------------------------------------------------</span>
0408 <a name="_sub17" href="#_subfunctions" class="code">function menuGraphicsRenderer_Callback(hObject, eventdata, handles)</a>
0409 <span class="comment">%  --- Empty ---</span>
0410 
0411 <span class="comment">% --------------------------------------------------------------------</span>
0412 <a name="_sub18" href="#_subfunctions" class="code">function menuOpenGL_Callback(hObject, eventdata, handles)</a>
0413 <span class="comment">% Get the Application Data:</span>
0414 <span class="comment">% -------------------------</span>
0415 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0416 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0417 
0418 <span class="comment">% Update the Application Data:</span>
0419 <span class="comment">% ----------------------------</span>
0420 guiparams.renderer  = <span class="string">'OpenGL'</span>;
0421 guiprefs.renderer   = <span class="string">'OpenGL'</span>;
0422 
0423 <span class="comment">% Re-store the Application data:</span>
0424 <span class="comment">% ------------------------------</span>
0425 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0426 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0427 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0428 
0429 <span class="comment">% Update the GUI:</span>
0430 <span class="comment">% ---------------</span>
0431 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0432 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0433 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0434 
0435 <span class="comment">% Modify the existing figures</span>
0436 <span class="comment">% ---------------------------</span>
0437 <span class="comment">% Find what plots exist already</span>
0438 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0439 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0440 
0441 <span class="comment">% Loop through valid figures and adjust</span>
0442 <span class="comment">% -------------------------------------</span>
0443 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0444     <span class="keyword">for</span> i = 1:length(valid_names)
0445         <span class="comment">% Focus the figure</span>
0446         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0447         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0448             figure(hff)
0449             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0450         <span class="keyword">end</span>
0451         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0452         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0453             figure(hff)
0454             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0455         <span class="keyword">end</span>
0456     <span class="keyword">end</span>
0457 <span class="keyword">end</span>
0458 <span class="comment">% [EOF] menuOpenGL_Callback</span>
0459 
0460 
0461 <span class="comment">% --------------------------------------------------------------------</span>
0462 <a name="_sub19" href="#_subfunctions" class="code">function menuPainters_Callback(hObject, eventdata, handles)</a>
0463 <span class="comment">% Get the Application Data:</span>
0464 <span class="comment">% -------------------------</span>
0465 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0466 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0467 
0468 <span class="comment">% Update the Application Data:</span>
0469 <span class="comment">% ----------------------------</span>
0470 guiparams.renderer  = <span class="string">'painters'</span>;
0471 guiprefs.renderer   = <span class="string">'painters'</span>;
0472 
0473 <span class="comment">% Re-store the Application data:</span>
0474 <span class="comment">% ------------------------------</span>
0475 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0476 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0477 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0478 
0479 <span class="comment">% Update the GUI:</span>
0480 <span class="comment">% ---------------</span>
0481 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0482 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0483 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0484 
0485 <span class="comment">% Modify the existing figures</span>
0486 <span class="comment">% ---------------------------</span>
0487 <span class="comment">% Find what plots exist already</span>
0488 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0489 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0490 
0491 <span class="comment">% Loop through valid figures and adjust</span>
0492 <span class="comment">% -------------------------------------</span>
0493 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0494     <span class="keyword">for</span> i = 1:length(valid_names)
0495         <span class="comment">% Focus the figure</span>
0496         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0497         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0498             figure(hff)
0499             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0500         <span class="keyword">end</span>
0501         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0502         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0503             figure(hff)
0504             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0505         <span class="keyword">end</span>
0506     <span class="keyword">end</span>
0507 <span class="keyword">end</span>
0508 <span class="comment">% [EOF] menuPainters_Callback</span>
0509 
0510 <span class="comment">% --------------------------------------------------------------------</span>
0511 <a name="_sub20" href="#_subfunctions" class="code">function menuZbuffer_Callback(hObject, eventdata, handles)</a>
0512 <span class="comment">% Get the Application Data:</span>
0513 <span class="comment">% -------------------------</span>
0514 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0515 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0516 
0517 <span class="comment">% Update the Application Data:</span>
0518 <span class="comment">% ----------------------------</span>
0519 guiparams.renderer  = <span class="string">'zbuffer'</span>;
0520 guiprefs.renderer   = <span class="string">'zbuffer'</span>;
0521 
0522 <span class="comment">% Re-store the Application data:</span>
0523 <span class="comment">% ------------------------------</span>
0524 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0525 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0526 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'renderer'</span>)
0527 
0528 <span class="comment">% Update the GUI:</span>
0529 <span class="comment">% ---------------</span>
0530 set(handles.menuOpenGL,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0531 set(handles.menuPainters, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
0532 set(handles.menuZbuffer,  <span class="string">'Checked'</span>,<span class="string">'on'</span>)
0533 
0534 <span class="comment">% Modify the existing figures</span>
0535 <span class="comment">% ---------------------------</span>
0536 <span class="comment">% Find what plots exist already</span>
0537 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0538 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
0539 
0540 <span class="comment">% Loop through valid figures and adjust</span>
0541 <span class="comment">% -------------------------------------</span>
0542 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
0543     <span class="keyword">for</span> i = 1:length(valid_names)
0544         <span class="comment">% Focus the figure</span>
0545         hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
0546         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0547             figure(hff)
0548             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0549         <span class="keyword">end</span>
0550         hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
0551         <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
0552             figure(hff)
0553             set(hff,<span class="string">'Renderer'</span>,guiparams.renderer)
0554         <span class="keyword">end</span>
0555     <span class="keyword">end</span>
0556 <span class="keyword">end</span>
0557 <span class="comment">% [EOF] menuZbuffer_Callback</span>
0558 
0559 <span class="comment">% --------------------------------------------------------------------</span>
0560 <a name="_sub21" href="#_subfunctions" class="code">function menuExportFigures_Callback(hObject, eventdata, handles)</a>
0561 <span class="comment">% Get the Application data:</span>
0562 <span class="comment">% -------------------------</span>
0563 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0564 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0565 
0566 <span class="comment">% Find what plots exist already</span>
0567 fig_handles = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
0568 fig_names   = get(fig_handles,<span class="string">'name'</span>);
0569 
0570 <span class="comment">% Remove the VMT GUI as a valid figure in the list</span>
0571 [~, idx] = ismember({get(handles.figure1,<span class="string">'Name'</span>),<span class="string">'VMT_GraphicsControl'</span>}, fig_names);
0572 <span class="keyword">if</span> ~isempty(idx)
0573     fig_names(idx) = [];
0574 <span class="keyword">end</span>
0575 
0576 <span class="keyword">if</span> guiparams.presentation
0577     figure_style = <span class="string">'presentation'</span>;
0578 <span class="keyword">else</span>
0579     figure_style = <span class="string">'print'</span>;
0580 <span class="keyword">end</span>
0581 
0582 [selected_figures] = <a href="#_sub107" class="code" title="subfunction [selected_figures] = openFiguresDialog(figure_names,hf)">openFiguresDialog</a>(fig_names,handles.figure1);
0583 
0584 <span class="keyword">if</span> isempty(selected_figures) <span class="comment">% User pressed cancel</span>
0585     <span class="keyword">return</span>
0586 <span class="keyword">else</span>
0587     <span class="keyword">for</span> i = 1:length(selected_figures)
0588         <a href="VMT_SaveFigs.html" class="code" title="function VMT_SaveFigs(pathname,to_export,figure_style)">VMT_SaveFigs</a>(guiprefs.mat_path,selected_figures(i),figure_style)
0589     <span class="keyword">end</span>
0590 <span class="keyword">end</span>
0591 
0592 
0593 <span class="comment">% [EOF] menuExportFigures_Callback</span>
0594 
0595 <span class="comment">% --------------------------------------------------------------------</span>
0596 <a name="_sub22" href="#_subfunctions" class="code">function menuBathymetryExportSettings_Callback(hObject, eventdata, handles)</a>
0597 <span class="comment">% Get the Application data:</span>
0598 <span class="comment">% -------------------------</span>
0599 guiparams              = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0600 beam_angle             = guiparams.beam_angle; 
0601 magnetic_variation     = guiparams.magnetic_variation; 
0602 wse                    = guiparams.water_surface_elevation;
0603 output_auxiliary_data  = guiparams.output_auxiliary_data;
0604 load_wse_tide_file     = guiparams.load_wse_tide_file;
0605 
0606 <span class="comment">% Open dialog and allow user to select settings</span>
0607 <span class="comment">% ---------------------------------------------</span>
0608 [beam_angle,<span class="keyword">...</span>
0609     magnetic_variation,<span class="keyword">...</span>
0610     wse,<span class="keyword">...</span>
0611     output_auxiliary_data,<span class="keyword">...</span>
0612     load_wse_tide_file] = <span class="keyword">...</span>
0613     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,handles.figure1);
0614 
0615 <span class="comment">% Re-store the Application data:</span>
0616 <span class="comment">% ------------------------------</span>
0617 guiparams.beam_angle            = beam_angle;
0618 guiparams.magnetic_variation    = magnetic_variation; 
0619 guiparams.load_wse_tide_file    = load_wse_tide_file;
0620 <span class="keyword">if</span> guiparams.load_wse_tide_file <span class="comment">% prompt and load file</span>
0621       infile = fullfile(<span class="keyword">...</span>
0622         guiparams.multibeambathymetry_path,<span class="keyword">...</span>
0623         guiparams.multibeambathymetry_file);
0624     [wsedata] = <a href="#_sub23" class="code" title="subfunction [wsedata] = loadTideFile(infile)">loadTideFile</a>(infile);
0625     guiparams.water_surface_elevation = wsedata;
0626 <span class="keyword">else</span>
0627       guiparams.water_surface_elevation = wse;
0628 <span class="keyword">end</span>
0629 guiparams.output_auxiliary_data = output_auxiliary_data;
0630 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
0631 
0632 <span class="comment">% [EOF] menuExportSettings_Callback</span>
0633 
0634 <span class="comment">% --------------------------------------------------------------------</span>
0635 <a name="_sub23" href="#_subfunctions" class="code">function [wsedata] = loadTideFile(infile)</a>
0636 <span class="comment">% wsedata.obstime</span>
0637 <span class="comment">% wsedata.elev</span>
0638 
0639 <span class="comment">% Determine Files to Process</span>
0640 <span class="comment">% Ask the user to select files:</span>
0641 <span class="comment">% -----------------------------</span>
0642 [zFileName,zPathName] = uigetfile({<span class="string">'*.csv'</span>,<span class="string">'Comma Separated Values File (*.csv)'</span>;<span class="string">'*.*'</span>,<span class="string">'All files (*.*)'</span>}, <span class="keyword">...</span>
0643     <span class="string">'Select the WSE Tide file'</span>, <span class="keyword">...</span>
0644     infile, <span class="keyword">...</span>
0645     <span class="string">'MultiSelect'</span>,<span class="string">'off'</span>);
0646 
0647 <span class="keyword">if</span> ischar(zPathName) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0648     data = csvread(fullfile(zPathName,zFileName));
0649     wsedata.obstime = datenum(data(:,1:6));
0650     wsedata.elev    = data(:,7);
0651 <span class="keyword">else</span>
0652     wsedata.obstime = [];
0653     wsedata.elev    = [];
0654     warndlg(<span class="string">'Loading a tide file failed. Please try again.'</span>,<span class="string">'Warning: No tide file loaded'</span>)
0655 <span class="keyword">end</span>
0656 <span class="comment">%  [EOF] loadTideFile</span>
0657 
0658 <span class="comment">% --------------------------------------------------------------------</span>
0659 <a name="_sub24" href="#_subfunctions" class="code">function menuExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
0660 <a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>(hObject, eventdata, handles);
0661 <span class="comment">% [EOF] menuExportMultibeamBathymetry_Callback</span>
0662 
0663 
0664 <span class="comment">% --------------------------------------------------------------------</span>
0665 <a name="_sub25" href="#_subfunctions" class="code">function menuSaveANVFile_Callback(hObject, eventdata, handles)</a>
0666 
0667 <span class="comment">% Get the Application Data:</span>
0668 <span class="comment">% -------------------------</span>
0669 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0670 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0671 PVdata    = guiparams.iric_anv_planview_data;
0672 iric_path = guiprefs.iric_path;
0673 iric_file = guiprefs.iric_file;
0674 
0675 <span class="comment">% Is there any planview data?</span>
0676 <span class="keyword">if</span> isempty(PVdata)
0677     <span class="comment">% Nothing to do, warn user</span>
0678     log_text = {<span class="string">'No planview plot data to export. User must Plot Plan View first.'</span>};
0679     warndlg(log_text{:},<span class="string">'Nothing to export'</span>)
0680 <span class="keyword">else</span>
0681     <span class="comment">% Save the planview data as output and to an *.anv file with spacing</span>
0682     <span class="comment">% and smoothing (for iRiC)</span>
0683     log_text = {<span class="string">'Exporting iRic formated ANV vector file...'</span>};
0684     [iric_file,iric_path] = uiputfile(<span class="string">'*.anv'</span>,<span class="string">'Save *.anv file'</span>,<span class="keyword">...</span>
0685         fullfile(iric_path,iric_file));
0686     
0687     <span class="keyword">if</span> ischar(iric_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0688         outfile = fullfile(iric_path,iric_file);
0689         log_text = vertcat(log_text,{outfile});
0690         ofid   = fopen(outfile, <span class="string">'wt'</span>);
0691         outcount = fprintf(ofid,<span class="keyword">...</span>
0692             <span class="string">'%8.2f  %8.2f  %5.2f  %3.3f  %3.3f\n'</span>,PVdata.outmat);
0693         fclose(ofid);
0694     <span class="keyword">else</span>
0695         <span class="comment">% Return default iric_path and iric_file</span>
0696         iric_path = guiprefs.iric_path;
0697         iric_file = guiprefs.iric_file;
0698     <span class="keyword">end</span>
0699 <span class="keyword">end</span>
0700 
0701 <span class="comment">% Push messages to Log Window:</span>
0702 <span class="comment">% ----------------------------</span>
0703 statusLogging(handles.LogWindow, log_text)
0704 
0705 <span class="comment">% Store the persistent preferences:</span>
0706 <span class="comment">% ---------------------------------</span>
0707 guiprefs.iric_file = iric_file;
0708 guiprefs.iric_path = iric_path;
0709 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
0710 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'iric'</span>)
0711 
0712 <span class="comment">% [EOF] menuSaveANVFile_Callback</span>
0713 
0714 <span class="comment">% --------------------------------------------------------------------</span>
0715 <a name="_sub26" href="#_subfunctions" class="code">function menuSaveExcel_Callback(hObject, eventdata, handles)</a>
0716 <span class="comment">% Get the Application Data:</span>
0717 <span class="comment">% -------------------------</span>
0718 guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0719 guiprefs    = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
0720 excel_path  = guiprefs.excel_path;
0721 excel_file  = guiprefs.excel_file;
0722 
0723 <span class="comment">% Push messages to Log Window:</span>
0724 <span class="comment">% ----------------------------</span>
0725 log_text = {<span class="string">'Exporting Excel File (reprocessing dataset; this will create new plots)'</span>};
0726 statusLogging(handles.LogWindow, log_text)
0727 
0728 <span class="comment">% If there are multiple MAT files loaded, go ahead and export just the DAV</span>
0729 <span class="comment">% data.</span>
0730 <span class="keyword">if</span> iscell(guiparams.mat_file)
0731     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0732     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0733     <span class="comment">% Refresh the Application Data:</span>
0734     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0735     z           = guiparams.z;
0736     A           = guiparams.A;
0737     V           = guiparams.V;
0738     Map         = guiparams.Map;
0739     wse         = guiparams.water_surface_elevation;
0740     PVdata      = guiparams.iric_anv_planview_data;
0741     log_text = {<span class="string">'Writing data to Excel file...'</span>;<span class="keyword">...</span>
0742         <span class="string">'Multiple transected loaded. Will export Planview Data Only!'</span>};
0743     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0744         fullfile(excel_path,excel_file));
0745     
0746     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0747         outfile = fullfile(excel_path,excel_file);
0748         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0749         
0750     <span class="keyword">else</span>
0751         <span class="comment">% Return default excel_path and excel_file</span>
0752         excel_path = guiprefs.excel_path;
0753         excel_file = guiprefs.excel_file;
0754         outfile = fullfile(excel_path,excel_file);
0755         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0756     <span class="keyword">end</span>
0757     
0758     <span class="comment">% Delete the old file if it exists</span>
0759     <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0760         log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0761             [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0762             <span class="string">'already exists. Overwriting file...'</span>});
0763         delete(outfile)
0764     <span class="keyword">end</span>
0765     
0766     <span class="comment">% Save MCS Summary to an Excel File</span>
0767     hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0768     xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0769     xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>);
0770     <span class="keyword">if</span> isempty(guiparams.data_files{1}) || ~isempty(guiparams.mat_file{1}) <span class="comment">% Loaded MAT file</span>
0771         xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0772         sout = guiparams.mat_file';
0773     <span class="keyword">end</span>
0774     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>);
0775     sout = {<span class="keyword">...</span>
0776         <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0777         <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0778         <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0779         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0780         <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0781         <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0782         <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0783         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0784         <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0785         <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0786         <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0787         <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0788         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0789         <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0790         <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0791         <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0792         <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0793         <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0794         <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0795         <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0796         <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0797         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0798         <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0799         <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0800         <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0801         <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0802         <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0803         <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0804         <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0805         <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0806         <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0807         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0808         <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0809         <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0810         <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0811         <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0812         <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0813         <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0814         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0815         <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0816         <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0817         };
0818     xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>);
0819     
0820     <span class="comment">% Save DAV data to an Excel File</span>
0821     vmin = num2str(guiparams.depth_range_min);
0822     vmax = num2str(guiparams.depth_range_max);
0823     pvheaders = {<span class="keyword">...</span>
0824         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span> <span class="string">'UTM_East'</span> <span class="string">'UTM_North'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
0825         [<span class="string">'EastDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0826         [<span class="string">'NorthDAV_cm/s, dpth rng '</span> vmin <span class="string">' to '</span> vmax <span class="string">' m'</span>]<span class="keyword">...</span>
0827         <span class="string">'Vel_mag_cm/s'</span> <span class="string">'Vel_dir_deg'</span>};
0828 
0829     <span class="comment">% Initialize Variables</span>
0830     pvdata = []; Dist = []; ID = {};
0831     X = []; Y = []; E = []; T = [];
0832     Ve = []; Vn =[]; Vm = []; Vd = [];
0833     
0834     <span class="comment">% Concatenate data from all MAT files into arrays</span>
0835     <span class="keyword">for</span> i = 1:length(guiparams.mat_file)
0836         <span class="comment">% Load current MAT-file</span>
0837         load(fullfile(guiparams.mat_path, guiparams.mat_file{i}))
0838         
0839         <span class="comment">% Location, Time and Bathy</span>
0840         ID = vertcat(ID,repmat(guiparams.mat_file(i),length(V.mcsX(1,:)),1));
0841         X = [X V.mcsX(1,:)];
0842         Y = [Y V.mcsY(1,:)];
0843         Dist = [Dist sort(V.mcsDist(1,:),<span class="string">'descend'</span>)];
0844         E = [E V.mcsBedElev];
0845         T = [T V.mcsTime(1,:)];
0846                 
0847         <span class="comment">% Build layer-averaged velocities</span>
0848         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
0849         V.mcsX(indx,:) = nan;
0850         V.mcsY(indx,:) = nan;
0851         V.mcsEast(indx,:) = nan;
0852         V.mcsNorth(indx,:) = nan;
0853         Ve = [Ve <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast)];
0854         Vn = [Vn <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth)];
0855         Vm = [Vm sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2)];
0856         Vd = [Vd ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth),<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
0857         
0858         waitbar(i/(length(guiparams.mat_file)+1),hwait)
0859     <span class="keyword">end</span>
0860     
0861     <span class="comment">% Put output into 1 matrix</span>
0862     pvdata = [<span class="keyword">...</span>
0863         X; Y; Dist; E;<span class="keyword">...</span><span class="comment"> % Bathy and locations</span>
0864         Ve; Vn; Vm; Vd<span class="keyword">...</span><span class="comment"> % Velocity</span>
0865         ];
0866     pvdata(isnan(pvdata)) = -9999;
0867     
0868     <span class="comment">% Create table and write to Excel</span>
0869     pvout = num2cell(pvdata');
0870     pvout = horzcat(ID,pvout);
0871     timestamp = cellstr(nandatestr(T));
0872     pvout = vertcat(pvheaders,horzcat(timestamp,pvout));
0873     xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
0874     
0875     <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
0876     <span class="comment">% results</span>
0877     PVheaders = {<span class="keyword">...</span>
0878         <span class="string">'Timestamp'</span> <span class="string">'FileName'</span><span class="keyword">...</span>
0879         <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span><span class="keyword">...</span>
0880         [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0881         [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
0882         <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
0883     PVtable = [<span class="keyword">...</span>
0884         PVdata.outmat(1,:);<span class="keyword">...</span>
0885         PVdata.outmat(2,:);<span class="keyword">...</span>
0886         PVdata.outmat(7,:);<span class="keyword">...</span><span class="comment">;...</span>
0887         PVdata.outmat(4,:).*100;<span class="keyword">...</span>
0888         PVdata.outmat(5,:).*100;<span class="keyword">...</span>
0889         sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
0890         ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
0891     <span class="comment">%PVtable = (sortrows(PVtable',3))';</span>
0892     PVtable(isnan(PVtable)) = -9999;
0893     PVout = horzcat(<span class="keyword">...</span>
0894         cellstr(nandatestr(PVdata.outmat(6,:)')),<span class="keyword">...</span>
0895         PVdata.outfile,<span class="keyword">...</span>
0896         num2cell(PVtable'));
0897     PVout = vertcat(PVheaders,PVout);
0898     xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
0899     
0900     <span class="comment">% Close out waitbar</span>
0901     waitbar(1,hwait)
0902     delete(hwait)
0903     
0904     <span class="comment">% Push messages to Log Window:</span>
0905     <span class="comment">% ----------------------------</span>
0906     statusLogging(handles.LogWindow, log_text)
0907 <span class="keyword">else</span>
0908     
0909     <span class="comment">% Force VMT to reprocess before outputing Excel</span>
0910     <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
0911     <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
0912     <span class="comment">% Refresh the Application Data:</span>
0913     guiparams   = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
0914     z           = guiparams.z;
0915     A           = guiparams.A;
0916     V           = guiparams.V;
0917     Map         = guiparams.Map;
0918     wse         = guiparams.water_surface_elevation;
0919     PVdata      = guiparams.iric_anv_planview_data; <span class="comment">% this is what's in the</span>
0920                                                     <span class="comment">% Planview Plot exactly</span>
0921     ID = PVdata.outfile;         <span class="comment">% File name for for each data point in the</span>
0922                                  <span class="comment">% planview plot</span>
0923         
0924     log_text = {<span class="string">'Writing data to Excel file...'</span>};
0925     [excel_file,excel_path] = uiputfile(<span class="string">'*.xlsx'</span>,<span class="string">'Save *.xlsx file'</span>,<span class="keyword">...</span>
0926         fullfile(excel_path,excel_file));
0927     
0928     <span class="keyword">if</span> ischar(excel_path) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
0929         outfile = fullfile(excel_path,excel_file);
0930         <span class="comment">%log_text = vertcat(log_text,{outfile});</span>
0931         
0932         <span class="comment">% Delete the old file if it exists</span>
0933         <span class="keyword">if</span> exist(outfile, <span class="string">'file'</span>) == 2
0934             log_text = vertcat(log_text,{<span class="string">'Warning: The file'</span>;<span class="keyword">...</span>
0935                 [<span class="string">'   '</span> outfile];<span class="keyword">...</span>
0936                 <span class="string">'already exists. Overwriting file...'</span>});
0937             delete(outfile)
0938         <span class="keyword">end</span>
0939         
0940         <span class="comment">% Push messages to Log Window:</span>
0941         <span class="comment">% ----------------------------</span>
0942         statusLogging(handles.LogWindow, log_text)
0943         
0944         <span class="comment">% Save MCS Summary to an Excel File</span>
0945         hwait = waitbar(0,<span class="string">'Exporting Excel File...'</span>);
0946         xlswrite(outfile,{<span class="string">'Path:'</span>}, <span class="string">'VMTSummary'</span>,<span class="string">'H3'</span>);
0947         xlswrite(outfile,{<span class="string">'Files:'</span>},<span class="string">'VMTSummary'</span>,<span class="string">'H4'</span>); 
0948         waitbar(1/5,hwait)
0949         <span class="keyword">if</span> isempty(guiparams.data_files{1}) <span class="comment">% Loaded MAT file</span>
0950             xlswrite(outfile,{guiparams.mat_path},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0951             sout = {guiparams.mat_file};
0952         <span class="keyword">else</span> <span class="comment">% ASCII file(s)</span>
0953             xlswrite(outfile,{guiparams.data_folder},<span class="string">'VMTSummary'</span>,<span class="string">'I3'</span>);
0954             sout = guiparams.data_files';
0955         <span class="keyword">end</span>
0956         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'I4'</span>); 
0957         waitbar(2/7,hwait)
0958         sout = {<span class="keyword">...</span>
0959             <span class="string">'VMT: SUMMARY OF MEAN CROSS SECTION'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0960             <span class="string">'VMT '</span> guiparams.vmt_version{1} guiparams.vmt_version{2} <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0961             <span class="string">'Date Processed: '</span> datestr(now) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0962             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0963             <span class="string">'MEAN CROSS SECTION (MCS) PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0964             <span class="string">'Horz. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.horizontal_grid_node_spacing;<span class="keyword">...</span>
0965             <span class="string">'Vert. Grid Node Spacing (m):'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> guiparams.vertical_grid_node_spacing;<span class="keyword">...</span>
0966             <span class="string">'Water Surface Elevation (m):'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> wse;<span class="keyword">...</span>
0967             <span class="string">'Time of first velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmin(V.mcsTime(:)));<span class="keyword">...</span>
0968             <span class="string">'Time of last velocity sample:'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> datestr(nanmax(V.mcsTime(:)));<span class="keyword">...</span>
0969             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0970             <span class="string">'SMOOTHED DATA PROPERTIES'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0971             <span class="string">'Smoothed Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0972             <span class="string">'Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>  num2str(guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0973             <span class="string">'Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0974             <span class="string">'Smoothed Mean Cross Section:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0975             <span class="string">'Horz. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0976             <span class="string">'Horz. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing);<span class="keyword">...</span>
0977             <span class="string">'Vert. Vector Spacing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0978             <span class="string">'Vert. Vector Smoothing, in ground distance (m)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing);<span class="keyword">...</span>
0979             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0980             <span class="string">'ENDPOINTS:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">'UTM_East'</span>    <span class="string">'UTM_North'</span>;<span class="keyword">...</span>
0981             <span class="string">'Left Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xLeftBank V.yLeftBank;<span class="keyword">...</span>
0982             <span class="string">'Right Bank'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>    V.xRightBank V.yRightBank;<span class="keyword">...</span>
0983             <span class="string">'Total Length in meters'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.dl;<span class="keyword">...</span>
0984             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0985             <span class="string">'Mean Flow Direction (deg)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> num2str(V.mfd);<span class="keyword">...</span>
0986             <span class="string">'in geographic coordinates'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0987             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0988             <span class="string">'Slope'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.m;<span class="keyword">...</span>
0989             <span class="string">'Intercept'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.b;<span class="keyword">...</span>
0990             <span class="string">'Theta (deg)'</span>    <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> V.theta
0991             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0992             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0993             <span class="string">'DATA STRUCTURE'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0994             <span class="string">''</span> <span class="string">'1. These data are the computed output from The Velocity Mapping Toolbox (VMT).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0995             <span class="string">''</span> <span class="string">'2. VMT maps the loaded ADCP data to a mean cross-section (MCS), typically a line of best fit to the ADCP positions.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0996             <span class="string">''</span> <span class="string">'3. The ADCP data are then interpolated to a user specified grid (see Cells F6:F7).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0997             <span class="string">''</span> <span class="string">'4. VMT then averages the mapped and interpolated data to the MCS grid.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0998             <span class="string">''</span> <span class="string">'5. For more information, see the VMT homepage: '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
0999             <span class="string">''</span> <span class="string">'=HYPERLINK(&quot;http://hydroacoustics.usgs.gov/movingboat/VMT/VMT.shtml&quot;)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1000             <span class="string">'Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1001             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1002             <span class="string">''</span> <span class="string">'2. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1003             <span class="string">''</span> <span class="string">'3. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1004             <span class="string">''</span> <span class="string">'4. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1005             <span class="string">'MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1006             <span class="string">''</span> <span class="string">'1. Data are in vectorized i,j structure, where i is the index into the horizontal, j is index to vertical. Thus, the first j rows correspond to vertical i.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1007             <span class="string">''</span> <span class="string">'2. Bed elevation is computed as the entered water surface elevation minus depth at each vertical location (if WSE=0, the elevations will be negative).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1008             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1009             <span class="string">'Smoothed_Planview:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1010             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1011             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Planview plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1012             <span class="string">''</span> <span class="string">'3. Values are for layer-avg quanties. Thus &quot;dpthrng_0_to_Infm&quot; would represent layer-averaging over the entire depth.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1013             <span class="string">''</span> <span class="string">'4. If the user specifies a depth range, the column title will indicate it (e.g. &quot;dpthrng_1.2_to_5m&quot; would show resultant layer-averaged velocities over depths from 1.2 to 5 meters).'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1014             <span class="string">''</span> <span class="string">'5. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1015             <span class="string">'Smoothed_MeanCrossSection:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1016             <span class="string">''</span> <span class="string">'1. Units are indicated in the column titles.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1017             <span class="string">''</span> <span class="string">'2. Data are the actual vectors shown in the Mean Cross Section plot, and reflect any user specified smoothing and/or spacings.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1018             <span class="string">''</span> <span class="string">'3. NULL or missing data are represented as &quot;-9999&quot;.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1019             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1020             <span class="string">'Further Notes:'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1021             <span class="string">''</span> <span class="string">'1. Timestamp values represent the average time over which the data are sampled. In the case of the Planview '</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1022             <span class="string">''</span> <span class="string">'   and MeanCrossSection worksheets, timestamps are the average based on the nearest ensembles (from the ADCP)'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1023             <span class="string">''</span> <span class="string">'   mapped to each grid node. For smoothed outputs, the timestamps are the average time over the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1024             <span class="string">''</span> <span class="string">'   Thus if the smoothing window is 2, the time is the average of the 2 grid nodes on either side (5 nodes) of the'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1025             <span class="string">''</span> <span class="string">'   center of the smoothing window.'</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1026             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1027             <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1028             <span class="string">'Form last revised:'</span> <span class="string">''</span> guiparams.vmt_version{2}(2:end) <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>;<span class="keyword">...</span>
1029             };
1030         xlswrite(outfile,sout,<span class="string">'VMTSummary'</span>,<span class="string">'A1'</span>); 
1031         waitbar(3/7,hwait)
1032         
1033         <span class="comment">% Save DAV data to an Excel File</span>
1034         vmin = num2str(guiparams.depth_range_min);
1035         vmax = num2str(guiparams.depth_range_max);
1036         pvheaders = {<span class="keyword">...</span>
1037             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1038             <span class="keyword">...</span><span class="comment">'FileName'...</span>
1039             <span class="string">'UTM_East_WGS84'</span> <span class="string">'UTM_North_WGS84'</span> <span class="string">'Dist_m'</span> <span class="string">'Bed_Elev_m'</span><span class="keyword">...</span>
1040             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1041             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1042             <span class="string">'Vel_mag_cms'</span> <span class="string">'Vel_dir_deg'</span>};
1043         
1044         <span class="comment">% Create block style matrix of all processed data</span>
1045         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1046         <span class="comment">% This is for EACH grid node specified by hgns/vgns, with the</span>
1047         <span class="comment">% layer-averaging applied</span>
1048         pvdata = [];
1049         
1050         <span class="comment">% Stationing from LEFT bank</span>
1051         Dist = V.mcsDist;
1052         
1053         <span class="comment">% Build bathy data matrix</span>
1054         pvdata = [V.mcsX(1,:); V.mcsY(1,:); Dist(1,:); V.mcsBedElev];
1055         
1056         <span class="comment">% Build layer-averaged velocities</span>
1057         indx = find(V.mcsDepth(:,1) &lt; str2num(vmin) | V.mcsDepth(:,1) &gt; str2num(vmax));
1058         V.mcsX(indx,:) = nan;
1059         V.mcsY(indx,:) = nan;
1060         V.mcsEast(indx,:) = nan;
1061         V.mcsNorth(indx,:) = nan;
1062         pvdata = [<span class="keyword">...</span>
1063             pvdata;<span class="keyword">...</span>
1064             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast);<span class="keyword">...</span>
1065             <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth);<span class="keyword">...</span>
1066             sqrt(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast).^2 + <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth).^2);<span class="keyword">...</span>
1067             ari2geodeg(atan2(<a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsNorth), <a href="VMT_LayerAveMean.html" class="code" title="function lam = VMT_LayerAveMean(x,y)">VMT_LayerAveMean</a>(V.mcsDepth,V.mcsEast))*180/pi)];
1068         pvdata(isnan(pvdata)) = -9999;
1069         pvout = num2cell(pvdata');
1070         <span class="comment">%pvout = horzcat(repmat(ID(1),length(pvout(:,1)),1),pvout);</span>
1071         timestr = nandatestr(V.mcsTime(1,:));
1072         timestamp = cellstr(timestr);
1073         pvout = horzcat(timestamp,pvout);
1074         pvout = vertcat(pvheaders,pvout);
1075         xlswrite(outfile,pvout,<span class="string">'Planview'</span>);
1076         waitbar(4/7,hwait)
1077         
1078         <span class="comment">% Save MCS data to an Excel File</span>
1079         <span class="comment">% This does not include the smoothed data results from the plots.</span>
1080         <span class="comment">% This is for EACH grid node specified by hgns/vgns</span>
1081         MCSheaders = {<span class="keyword">...</span>
1082             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1083             <span class="string">'UTM_East'</span> <span class="keyword">...</span>
1084             <span class="string">'UTM_North'</span><span class="keyword">...</span>
1085             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1086             <span class="string">'Elevation, in meters'</span><span class="keyword">...</span>
1087             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1088             <span class="string">'East Velocity, in cm/s'</span><span class="keyword">...</span>
1089             <span class="string">'North Velocity, in cm/s'</span><span class="keyword">...</span>
1090             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1091             <span class="string">'Velocity Magnitude, in cm/s'</span><span class="keyword">...</span>
1092             <span class="string">'Velocity Direction, in degrees (geographic coordinates)'</span><span class="keyword">...</span>
1093             <span class="string">'Streamwise Velocity, in cm/s'</span><span class="keyword">...</span>
1094             <span class="string">'Transverse Velocity, in cm/s'</span><span class="keyword">...</span>
1095             <span class="string">'Primary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1096             <span class="string">'Secondary Velocity (zsd), in cm/s'</span><span class="keyword">...</span>
1097             <span class="string">'Primary Velocity (roz), in cm/s'</span><span class="keyword">...</span>
1098             <span class="string">'Secondary Velocity (roz), in cm/s'</span>};
1099         
1100         vectorized_bed = meshgrid(V.mcsBedElev,V.mcsDepth(:,1));
1101         MCSdata = [<span class="keyword">...</span>
1102             V.mcsX(:)<span class="keyword">...</span>
1103             V.mcsY(:)<span class="keyword">...</span>
1104             V.mcsDist(:)<span class="keyword">...</span>
1105             vectorized_bed(:)<span class="keyword">...</span>
1106             <span class="keyword">...</span><span class="comment">(str2num(wse) - V.mcsDepth(:))...</span>
1107             <span class="keyword">...</span><span class="comment">repmat((wse - V.mcsBed(:)),size(V.mcsX,1),1)...</span>
1108             V.mcsEast(:)<span class="keyword">...</span>
1109             V.mcsNorth(:)<span class="keyword">...</span>
1110             V.mcsVert(:)<span class="keyword">...</span>
1111             V.mcsMag(:)<span class="keyword">...</span>
1112             V.mcsDir(:)<span class="keyword">...</span>
1113             V.u(:)<span class="keyword">...</span>
1114             V.v(:)<span class="keyword">...</span>
1115             V.vp(:)<span class="keyword">...</span>
1116             V.vs(:)<span class="keyword">...</span>
1117             V.Roz.up(:)<span class="keyword">...</span>
1118             V.Roz.us(:)];
1119         MCSdata(isnan(MCSdata)) = -9999;
1120         timestamp = cellstr(nandatestr(V.mcsTime(:)));
1121         MCSout = vertcat(MCSheaders,horzcat(timestamp,num2cell(MCSdata)));
1122         xlswrite(outfile,MCSout,<span class="string">'MeanCrossSection'</span>);
1123         waitbar(5/7,hwait)
1124                 
1125         <span class="comment">% Save the actual Planview plot data, which includes the smoothed</span>
1126         <span class="comment">% results</span>
1127         <span class="comment">% Compute distance from the LEFT bank using the MCS endpoints</span>
1128         PVDist = hypot(V.xLeftBank-PVdata.outmat(1,:),V.yLeftBank-PVdata.outmat(2,:));
1129         PVheaders = {<span class="keyword">...</span>
1130             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1131             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1132             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1133             <span class="string">'Dist_m'</span><span class="keyword">...</span>
1134             [<span class="string">'EastDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1135             [<span class="string">'NorthDAV_cms_dpthrng_'</span> vmin <span class="string">'_to_'</span> vmax <span class="string">'m'</span>]<span class="keyword">...</span>
1136             <span class="string">'Vel_mag_cms'</span><span class="keyword">...</span>
1137             <span class="string">'Vel_dir_deg'</span>};
1138         PVtable = [<span class="keyword">...</span>
1139             PVdata.outmat(1,:);<span class="keyword">...</span>
1140             PVdata.outmat(2,:);<span class="keyword">...</span>
1141             PVDist;<span class="keyword">...</span>
1142             PVdata.outmat(4,:).*100;<span class="keyword">...</span>
1143             PVdata.outmat(5,:).*100;<span class="keyword">...</span>
1144             sqrt(PVdata.outmat(4,:).^2 + PVdata.outmat(5,:).^2).*100;<span class="keyword">...</span>
1145             ari2geodeg(atan2(PVdata.outmat(5,:), PVdata.outmat(4,:))*180/pi)];
1146         PVtable = (sortrows(PVtable',3))';
1147         PVtable(isnan(PVtable)) = -9999;
1148         PVout = horzcat(cellstr(nandatestr(PVdata.outmat(6,:)')), num2cell(PVtable'));
1149         PVout = vertcat(PVheaders,PVout);
1150         xlswrite(outfile,PVout,<span class="string">'Smoothed_Planview'</span>);
1151         waitbar(6/7,hwait)
1152         
1153         <span class="comment">% Save the actual MCS plot data, which includes the smoothed</span>
1154         <span class="comment">% results</span>
1155         <span class="comment">% Distance is from the LEFT bank</span>
1156         <span class="comment">% Doesn't include the reference vector</span>
1157         compstr = [guiparams.contour <span class="string">'_'</span> guiparams.secondary_flow_vector_variable];
1158         dist    = guiparams.mcsQuivers(1:end-1,1);
1159         depth   = guiparams.mcsQuivers(1:end-1,2);
1160         vcomp   = guiparams.mcsQuivers(1:end-1,3);
1161         wcomp   = guiparams.mcsQuivers(1:end-1,4);
1162         
1163         <span class="comment">% Compute an UTM coordinate for the vector</span>
1164         pUTMx = interp1(V.mcsDist(1,:),V.mcsX(1,:),dist);
1165         pUTMy = interp1(V.mcsDist(1,:),V.mcsY(1,:),dist);
1166         
1167         <span class="comment">% Compute a Time for each vector</span>
1168         pTime = interp1(V.mcsDist(1,:),V.mcsTime(1,:),dist);
1169         
1170         <span class="comment">% Compute the streamwise component at each vector in the MCS plot</span>
1171         <span class="keyword">switch</span> guiparams.contour
1172             <span class="keyword">case</span> <span class="string">'streamwise'</span>   <span class="comment">%Plots the streamwise velocity</span>
1173                 wtp=[<span class="string">'V.uSmooth'</span>];
1174             <span class="keyword">case</span> <span class="string">'transverse'</span>  <span class="comment">%Plots the transverse velocity</span>
1175                 wtp=[<span class="string">'V.vSmooth'</span>];
1176             <span class="keyword">case</span> <span class="string">'vertical'</span>  <span class="comment">%Plots the vertical velocity</span>
1177                 wtp=[<span class="string">'V.wSmooth'</span>];
1178             <span class="keyword">case</span> <span class="string">'mag'</span>  <span class="comment">%Plots the velocity magnitude</span>
1179                 wtp=[<span class="string">'V.mcsMagSmooth'</span>];
1180             <span class="keyword">case</span> <span class="string">'east'</span>  <span class="comment">%Plots the east velocity</span>
1181                 wtp=[<span class="string">'V.mcsEastSmooth'</span>];
1182             <span class="keyword">case</span> <span class="string">'error'</span>  <span class="comment">%Plots the error velocity</span>
1183                 wtp=[<span class="string">'V.mcsErrorSmooth'</span>];
1184             <span class="keyword">case</span> <span class="string">'north'</span>  <span class="comment">%Plots the north velocity</span>
1185                 wtp=[<span class="string">'V.mcsNorthSmooth'</span>];
1186             <span class="keyword">case</span> <span class="string">'primary_zsd'</span>   <span class="comment">%Plots the primary velocity with zero secondary discharge definition</span>
1187                 wtp=[<span class="string">'V.vpSmooth'</span>];
1188             <span class="keyword">case</span> <span class="string">'secondary_zsd'</span>  <span class="comment">%Plots the secondary velocity with zero secondary discharge definition</span>
1189                 wtp=[<span class="string">'V.vsSmooth'</span>];
1190             <span class="keyword">case</span> <span class="string">'primary_roz'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition</span>
1191                 wtp=[<span class="string">'V.Roz.upSmooth'</span>];
1192             <span class="keyword">case</span> <span class="string">'secondary_roz'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition</span>
1193                 wtp=[<span class="string">'V.Roz.usSmooth'</span>];
1194             <span class="keyword">case</span> <span class="string">'primary_roz_x'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (downstream component)</span>
1195                 wtp=[<span class="string">'V.Roz.upxSmooth'</span>];
1196             <span class="keyword">case</span> <span class="string">'primary_roz_y'</span>   <span class="comment">%Plots the primary velocity with Rozovskii definition (cross-stream component)</span>
1197                 wtp=[<span class="string">'V.Roz.upySmooth'</span>];
1198             <span class="keyword">case</span> <span class="string">'secondary_roz_x'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (downstream component)</span>
1199                 wtp=[<span class="string">'V.Roz.usxSmooth'</span>];
1200             <span class="keyword">case</span> <span class="string">'secondary_roz_y'</span>  <span class="comment">%Plots the secondary velocity with Rozovskii definition (cross-stream component)</span>
1201                 wtp=[<span class="string">'V.Roz.usySmooth'</span>];
1202             <span class="keyword">case</span> <span class="string">'backscatter'</span>  <span class="comment">%Plots the backscatter</span>
1203                 wtp=[<span class="string">'V.mcsBackSmooth'</span>];
1204             <span class="keyword">case</span> <span class="string">'flowangle'</span>  <span class="comment">%Plots the flow direction (N = 0.0 deg)</span>
1205                 wtp=[<span class="string">'V.mcsDirSmooth'</span>];
1206             <span class="keyword">case</span> <span class="string">'vorticity_vw'</span>
1207                 wtp=[<span class="string">'V.vorticity_vw'</span>];
1208             <span class="keyword">case</span> <span class="string">'vorticity_zsd'</span>
1209                 wtp=[<span class="string">'V.vorticity_zsd'</span>];
1210             <span class="keyword">case</span> <span class="string">'vorticity_roz'</span>
1211                 wtp=[<span class="string">'V.vorticity_roz'</span>];
1212         <span class="keyword">end</span>
1213         Ucomp = eval(wtp);
1214         ucomp = interp2(V.mcsDist,V.mcsDepth,Ucomp,dist,depth);
1215         
1216         <span class="comment">% Save MCS data to an Excel File</span>
1217         <span class="comment">% This includes the smoothed data results from the plots.</span>
1218         <span class="comment">% This is for EACH VECTOR on the MCS plot</span>
1219         u_str = regexprep(lower(guiparams.contour),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1220         v_str = regexprep(lower(guiparams.secondary_flow_vector_variable),<span class="string">'(\&lt;[a-z])'</span>,<span class="string">'${upper($1)}'</span>);
1221         mcsheaders = {<span class="keyword">...</span>
1222             <span class="string">'Timestamp'</span><span class="keyword">...</span>
1223             <span class="string">'UTM_East_WGS84'</span><span class="keyword">...</span>
1224             <span class="string">'UTM_North_WGS84'</span><span class="keyword">...</span>
1225             <span class="string">'Distance from Left Bank, in meters'</span><span class="keyword">...</span>
1226             <span class="string">'Depth from surface, in meters'</span><span class="keyword">...</span>
1227             <span class="keyword">...</span><span class="comment">'Bed Elevation, in meters'...</span>
1228             [u_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1229             [v_str <span class="string">' Velocity, in cm/s'</span>]<span class="keyword">...</span>
1230             <span class="string">'Vertical Velocity, in cm/s'</span><span class="keyword">...</span>
1231             };
1232         mcsdata = [<span class="keyword">...</span>
1233             pUTMx(:)<span class="keyword">...</span>
1234             pUTMy(:)<span class="keyword">...</span>
1235             dist(:)<span class="keyword">...</span>
1236             depth(:)<span class="keyword">...</span>
1237             ucomp(:)<span class="keyword">...</span>
1238             vcomp(:)<span class="keyword">...</span>
1239             wcomp(:)];
1240         <span class="comment">% Keep only data where there is a full 3D vector (u,v,w)</span>
1241         ridx = ~isnan(ucomp);
1242         mcsdata = mcsdata(ridx,:);
1243         mcsdata(isnan(mcsdata)) = -9999;
1244         mcsout = vertcat(mcsheaders,horzcat(cellstr(nandatestr(pTime(ridx))), num2cell(mcsdata)));
1245         xlswrite(outfile,mcsout,<span class="string">'Smoothed_MeanCrossSection'</span>);
1246         waitbar(7/7,hwait)
1247     <span class="keyword">else</span>
1248         <span class="comment">% Return default excel_path and excel_file</span>
1249         excel_path = guiprefs.excel_path;
1250         excel_file = guiprefs.excel_file;
1251         outfile = fullfile(excel_path,excel_file);
1252         log_text = {<span class="string">'User aborted Excel export...'</span>};
1253     <span class="keyword">end</span>
1254     
1255     
1256 waitbar(1,hwait)  
1257 delete(hwait)
1258 <span class="keyword">end</span>
1259 
1260 <span class="comment">% Push messages to Log Window:</span>
1261 <span class="comment">% ----------------------------</span>
1262 statusLogging(handles.LogWindow, log_text)
1263 
1264 <span class="comment">% Store the persistent preferences:</span>
1265 <span class="comment">% ---------------------------------</span>
1266 guiprefs.excel_file = excel_file;
1267 guiprefs.excel_path = excel_path;
1268 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1269 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'excel'</span>)
1270 <span class="comment">% [EOF] menuSaveExcel_Callback</span>
1271 
1272 
1273 <span class="comment">% --------------------------------------------------------------------</span>
1274 <a name="_sub27" href="#_subfunctions" class="code">function menuExportCustomFlatFile_Callback(hObject, eventdata, handles)</a>
1275 <span class="comment">% Call separate GUI</span>
1276 VMT_BuildCustomFlatFile;
1277 <span class="comment">% [EOF] menuExportCustomFlatFile_Callback</span>
1278 
1279 <span class="comment">% --------------------------------------------------------------------</span>
1280 <a name="_sub28" href="#_subfunctions" class="code">function menuSettings_Callback(hObject, eventdata, handles)</a>
1281 <span class="comment">% Empty</span>
1282 
1283 <span class="comment">% --------------------------------------------------------------------</span>
1284 <a name="_sub29" href="#_subfunctions" class="code">function menuProcessingSettings_Callback(hObject, eventdata, handles)</a>
1285 <span class="comment">% Empty</span>
1286 
1287 <span class="comment">% --------------------------------------------------------------------</span>
1288 <a name="_sub30" href="#_subfunctions" class="code">function menuUnitDischargeCorrection_Callback(hObject, eventdata, handles)</a>
1289 <span class="comment">% Turn ON or OFF Unit Discharge Correction</span>
1290 
1291 <span class="comment">% Get the Application Data:</span>
1292 <span class="comment">% -------------------------</span>
1293 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1294 
1295 <span class="comment">% Update the GUI &amp; Application Data:</span>
1296 <span class="comment">% ----------------------------------</span>
1297 status = get(handles.menuUnitDischargeCorrection,<span class="string">'Checked'</span>);
1298 <span class="keyword">switch</span> status
1299     <span class="keyword">case</span> <span class="string">'on'</span> <span class="comment">% Turn it off</span>
1300         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1301         guiparams.unit_discharge_correction = false;
1302     <span class="keyword">case</span> <span class="string">'off'</span> <span class="comment">% Turn it on</span>
1303         set(handles.menuUnitDischargeCorrection, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1304         guiparams.unit_discharge_correction = true;
1305 <span class="keyword">end</span>
1306 
1307 <span class="comment">% Re-store the Application data:</span>
1308 <span class="comment">% ------------------------------</span>
1309 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1310 
1311 
1312 <span class="comment">%  [EOF] menuUnitDischargeCorrection_Callback</span>
1313 
1314 <span class="comment">% --------------------------------------------------------------------</span>
1315 <a name="_sub31" href="#_subfunctions" class="code">function menuPlottingParameters_Callback(hObject, eventdata, handles)</a>
1316 <span class="comment">% Empty</span>
1317 
1318 <span class="comment">% --------------------------------------------------------------------</span>
1319 <a name="_sub32" href="#_subfunctions" class="code">function menuUnits_Callback(hObject, eventdata, handles)</a>
1320 <span class="comment">% Empty</span>
1321 
1322 <span class="comment">% --------------------------------------------------------------------</span>
1323 <a name="_sub33" href="#_subfunctions" class="code">function menuMetric_Callback(hObject, eventdata, handles)</a>
1324 <span class="comment">% Set the Plotting Parameter Units to &quot;metric&quot;</span>
1325 
1326 <span class="comment">% Get the Application Data:</span>
1327 <span class="comment">% -------------------------</span>
1328 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1329 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1330 
1331 <span class="comment">% Update the Application Data:</span>
1332 <span class="comment">% ----------------------------</span>
1333 guiparams.english_units = false;
1334 guiprefs.units = <span class="string">'metric'</span>;
1335 
1336 <span class="comment">% Re-store the Application data:</span>
1337 <span class="comment">% ------------------------------</span>
1338 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1339 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1340 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1341 
1342 <span class="comment">% Update the GUI:</span>
1343 <span class="comment">% ---------------</span>
1344 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1345 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1346 
1347 <span class="comment">% [EOF] menuMetric_Callback</span>
1348 
1349 
1350 <span class="comment">% --------------------------------------------------------------------</span>
1351 <a name="_sub34" href="#_subfunctions" class="code">function menuEnglish_Callback(hObject, eventdata, handles)</a>
1352 <span class="comment">% Set the Plotting Parameter Units to &quot;english&quot;</span>
1353 
1354 <span class="comment">% Get the Application Data:</span>
1355 <span class="comment">% -------------------------</span>
1356 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1357 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1358 
1359 <span class="comment">% Update the Application Data:</span>
1360 <span class="comment">% ----------------------------</span>
1361 guiparams.english_units = true;
1362 guiprefs.units = <span class="string">'english'</span>;
1363 
1364 <span class="comment">% Re-store the Application data:</span>
1365 <span class="comment">% ------------------------------</span>
1366 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1367 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1368 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'units'</span>)
1369 
1370 <span class="comment">% Update the GUI:</span>
1371 <span class="comment">% ---------------</span>
1372 set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1373 set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1374 
1375 <span class="comment">% [EOF] menuEnglish_Callback</span>
1376 
1377 <span class="comment">% --------------------------------------------------------------------</span>
1378 <a name="_sub35" href="#_subfunctions" class="code">function menuVerticalReference_Callback(hObject, eventdata, handles)</a>
1379 <span class="comment">% Empty</span>
1380 
1381 <span class="comment">% --------------------------------------------------------------------</span>
1382 <a name="_sub36" href="#_subfunctions" class="code">function VerticalReference_Callback(hObject, eventdata, handles)</a>
1383 <span class="comment">% Set the Plotting Parameter Vertical Reference to &quot;dfs&quot; (depth from</span>
1384 <span class="comment">% surface)</span>
1385 
1386 <span class="comment">% Get the Application Data:</span>
1387 <span class="comment">% -------------------------</span>
1388 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1389 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1390 
1391 <span class="keyword">switch</span> guiparams.plotref
1392     <span class="keyword">case</span> <span class="string">'dfs'</span>  <span class="comment">% Depth from surface</span>
1393         <span class="comment">% Update the Application Data:</span>
1394         <span class="comment">% ----------------------------</span>
1395         guiparams.plotref = <span class="string">'dfs'</span>;
1396         guiprefs.plotref  = <span class="string">'dfs'</span>;
1397         
1398         <span class="comment">% Re-store the Application data:</span>
1399         <span class="comment">% ------------------------------</span>
1400         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1401         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1402         <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1403         
1404         <span class="comment">% Update the GUI:</span>
1405         <span class="comment">% ---------------</span>
1406         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Depth From Surface'</span>)
1407     <span class="keyword">case</span> <span class="string">'hab'</span> <span class="comment">% Height above bed</span>
1408         <span class="comment">% Update the Application Data:</span>
1409         <span class="comment">% ----------------------------</span>
1410         guiparams.plotref = <span class="string">'hab'</span>;
1411         guiprefs.plotref  = <span class="string">'hab'</span>;
1412         
1413         <span class="comment">% Re-store the Application data:</span>
1414         <span class="comment">% ------------------------------</span>
1415         setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1416         setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1417         <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'plotref'</span>)
1418         
1419         <span class="comment">% Update the GUI:</span>
1420         <span class="comment">% ---------------</span>
1421         set(handles.verticalReference,    <span class="string">'String'</span>,<span class="string">'Height Above Bottom'</span>)
1422 <span class="keyword">end</span>
1423 <span class="comment">% [EOF] VerticalReference_Callback</span>
1424 
1425 
1426 <span class="comment">% --------------------------------------------------------------------</span>
1427 <a name="_sub37" href="#_subfunctions" class="code">function menuSetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
1428 <span class="comment">% Empty</span>
1429 
1430 <span class="comment">% --------------------------------------------------------------------</span>
1431 <a name="_sub38" href="#_subfunctions" class="code">function menuCrossSectionEndpointAutomatic_Callback(hObject, eventdata, handles)</a>
1432 <span class="comment">% Set cross-section endpoints automatically</span>
1433 
1434 <span class="comment">% Get the Application Data:</span>
1435 <span class="comment">% -------------------------</span>
1436 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1437 
1438 <span class="comment">% Update the Application Data:</span>
1439 <span class="comment">% ----------------------------</span>
1440 guiparams.set_cross_section_endpoints = false;
1441 
1442 <span class="comment">% Re-store the Application data:</span>
1443 <span class="comment">% ------------------------------</span>
1444 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1445 
1446 <span class="comment">% Update the GUI:</span>
1447 <span class="comment">% ---------------</span>
1448 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1449 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1450 
1451 <span class="comment">% [EOF] menuCrossSectionEndpointAutomatic_Callback</span>
1452 
1453 
1454 <span class="comment">% --------------------------------------------------------------------</span>
1455 <a name="_sub39" href="#_subfunctions" class="code">function menuCrossSectionEndpointManual_Callback(hObject, eventdata, handles)</a>
1456 <span class="comment">% Set cross-section endpoints manually</span>
1457 
1458 <span class="comment">% Get the Application Data:</span>
1459 <span class="comment">% -------------------------</span>
1460 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1461 
1462 <span class="comment">% Update the Application Data:</span>
1463 <span class="comment">% ----------------------------</span>
1464 guiparams.set_cross_section_endpoints = true;
1465 
1466 <span class="comment">% Re-store the Application data:</span>
1467 <span class="comment">% ------------------------------</span>
1468 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1469 
1470 <span class="comment">% Update the GUI:</span>
1471 <span class="comment">% ---------------</span>
1472 set(handles.menuCrossSectionEndpointAutomatic, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1473 set(handles.menuCrossSectionEndpointManual,    <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1474 
1475 <span class="comment">% [EOF] menuCrossSectionEndpointManual_Callback</span>
1476 
1477 
1478 
1479 
1480 <span class="comment">% --------------------------------------------------------------------</span>
1481 <a name="_sub40" href="#_subfunctions" class="code">function menuPlotStyle_Callback(hObject, eventdata, handles)</a>
1482 <span class="comment">% Empty</span>
1483 
1484 <span class="comment">% --------------------------------------------------------------------</span>
1485 <a name="_sub41" href="#_subfunctions" class="code">function menuStylePrint_Callback(hObject, eventdata, handles)</a>
1486 
1487 <span class="comment">% Get the Application Data:</span>
1488 <span class="comment">% -------------------------</span>
1489 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1490 
1491 <span class="comment">% Update the Application Data:</span>
1492 <span class="comment">% ----------------------------</span>
1493 guiparams.print        = true;
1494 guiparams.presentation = false;
1495 
1496 <span class="comment">% Re-store the Application data:</span>
1497 <span class="comment">% ------------------------------</span>
1498 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1499 
1500 <span class="comment">% Update the GUI:</span>
1501 <span class="comment">% ---------------</span>
1502 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1503 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1504 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1505 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
1506 
1507 <span class="comment">% Modify the existing figures</span>
1508 <span class="comment">% ---------------------------</span>
1509 <span class="comment">% Find what plots exist already</span>
1510 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1511 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1512 
1513 <span class="comment">% Defaults for Print Stlye Figure</span>
1514 BkgdColor   = <span class="string">'white'</span>;
1515 AxColor     = <span class="string">'black'</span>;
1516 FigColor    = <span class="string">'white'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1517 FntSize     = 14;
1518 
1519 <span class="comment">% Loop through valid figures and adjust</span>
1520 <span class="comment">% -------------------------------------</span>
1521 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1522     
1523     <span class="keyword">for</span> i = 1:length(valid_names)
1524         <span class="keyword">switch</span> valid_names{i}
1525             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1526                 <span class="comment">% Focus the figure</span>
1527                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1528                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1529                     figure(hff)
1530                     
1531                     <span class="comment">% Make the changes to figure</span>
1532                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1533                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1534                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1535                     set(gca,<span class="string">'Color'</span>,FigColor)
1536                     set(gca,<span class="string">'XColor'</span>,AxColor)
1537                     set(gca,<span class="string">'YColor'</span>,AxColor)
1538                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1539                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1540                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1541                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1542                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1543                         <span class="string">'YColor'</span>,AxColor);
1544                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1545                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1546                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1547                     
1548                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1549                     <span class="comment">% the file(s) and path for the data</span>
1550                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1551                     <span class="keyword">if</span> ~ismultiplot
1552                         filestr = guiparams.savefile;
1553                         wd = length(filestr);
1554                         hd = 1;
1555                     <span class="keyword">else</span>
1556                         <span class="comment">% Construct a filename</span>
1557                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1558                         wd        = max(cellfun(@length,filestr));
1559                         hd        = numel(filestr);
1560                             
1561                     <span class="keyword">end</span>
1562                     
1563                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1564                     disableMenuBar(hff)
1565                     set(fileinfotxt,<span class="keyword">...</span>
1566                         <span class="string">'string'</span>,filestr)
1567                     set(fileinfotxt,<span class="keyword">...</span>
1568                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1569                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1570                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1571                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1572                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1573                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1574                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1575                     
1576                 <span class="keyword">end</span>
1577             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1578                 <span class="comment">% Focus the figure</span>
1579                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1580                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1581                     figure(hff)
1582                     
1583                     <span class="comment">% Make the changes to figure</span>
1584                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1585                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1586                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1587                     set(gca,<span class="string">'Color'</span>,FigColor)
1588                     set(gca,<span class="string">'XColor'</span>,AxColor)
1589                     set(gca,<span class="string">'YColor'</span>,AxColor)
1590                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1591                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1592                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1593                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1594                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1595                         <span class="string">'YColor'</span>,AxColor);
1596                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1597                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1598                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1599                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1600                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1601                     
1602                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1603                     <span class="comment">% the file(s) and path for the data</span>
1604                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1605                     <span class="keyword">if</span> ~ismultiplot
1606                         filestr = guiparams.savefile;
1607                         wd = length(filestr);
1608                         hd = 1;
1609                     <span class="keyword">else</span>
1610                         <span class="comment">% Construct a filename</span>
1611                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1612                         wd        = max(cellfun(@length,filestr));
1613                         hd        = numel(filestr);
1614                             
1615                     <span class="keyword">end</span>
1616                     
1617                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1618                     disableMenuBar(hff)
1619                     set(fileinfotxt,<span class="keyword">...</span>
1620                         <span class="string">'string'</span>,filestr)
1621                     set(fileinfotxt,<span class="keyword">...</span>
1622                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1623                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1624                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1625                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1626                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1627                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1628                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1629                 <span class="keyword">end</span>
1630             <span class="keyword">otherwise</span>
1631         <span class="keyword">end</span>
1632     <span class="keyword">end</span>
1633     
1634     
1635 <span class="keyword">end</span>
1636 
1637 
1638 <span class="comment">%[EOF] menuStylePrint_Callback</span>
1639 
1640 
1641 <span class="comment">% --------------------------------------------------------------------</span>
1642 <a name="_sub42" href="#_subfunctions" class="code">function menuStylePresentation_Callback(hObject, eventdata, handles)</a>
1643 <span class="comment">% Get the Application Data:</span>
1644 <span class="comment">% -------------------------</span>
1645 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1646 
1647 <span class="comment">% Update the Application Data:</span>
1648 <span class="comment">% ----------------------------</span>
1649 guiparams.print        = false;
1650 guiparams.presentation = true;
1651 
1652 <span class="comment">% Re-store the Application data:</span>
1653 <span class="comment">% ------------------------------</span>
1654 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1655 
1656 <span class="comment">% Update the GUI:</span>
1657 <span class="comment">% ---------------</span>
1658 set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1659 set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
1660 set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
1661 set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
1662 
1663 <span class="comment">% Modify the existing figures</span>
1664 <span class="comment">% ---------------------------</span>
1665 <span class="comment">% Find what plots exist already</span>
1666 hf = findobj(<span class="string">'type'</span>,<span class="string">'figure'</span>);
1667 valid_names = {<span class="string">'Plan View Map'</span>; <span class="string">'Mean Cross Section Contour'</span>};
1668 
1669 <span class="comment">% Defaults for Presentation Style Figure</span>
1670 <span class="comment">% --------------------------------------</span>
1671 BkgdColor   = <span class="string">'black'</span>;
1672 AxColor     = <span class="string">'white'</span>;
1673 FigColor    = <span class="string">'black'</span>; <span class="comment">% [0.3 0.3 0.3]</span>
1674 FntSize     = 14;
1675 
1676 <span class="comment">% Loop through valid figures and adjust</span>
1677 <span class="comment">% -------------------------------------</span>
1678 <span class="keyword">if</span> ~isempty(hf) &amp;&amp;  any(ishandle(hf))
1679     
1680     <span class="keyword">for</span> i = 1:length(valid_names)
1681         <span class="keyword">switch</span> valid_names{i}
1682             <span class="keyword">case</span> <span class="string">'Plan View Map'</span>
1683                 <span class="comment">% Focus the figure</span>
1684                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
1685                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1686                     figure(hff)
1687                     
1688                     <span class="comment">% Make the changes to figure</span>
1689                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1690                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1691                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1692                     set(gca,<span class="string">'Color'</span>,FigColor)
1693                     set(gca,<span class="string">'XColor'</span>,AxColor)
1694                     set(gca,<span class="string">'YColor'</span>,AxColor)
1695                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1696                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1697                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1698                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1699                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1700                         <span class="string">'YColor'</span>,AxColor);
1701                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1702                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1703                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1704                     
1705                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1706                     <span class="comment">% the file(s) and path for the data</span>
1707                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1708                     <span class="keyword">if</span> ~ismultiplot
1709                         filestr = guiparams.savefile;
1710                         wd = length(filestr);
1711                         hd = 1;
1712                     <span class="keyword">else</span>
1713                         <span class="comment">% Construct a filename</span>
1714                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1715                         wd        = max(cellfun(@length,filestr));
1716                         hd        = numel(filestr);
1717                             
1718                     <span class="keyword">end</span>
1719                     
1720                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1721                     disableMenuBar(hff)
1722                     set(fileinfotxt,<span class="keyword">...</span>
1723                         <span class="string">'string'</span>,filestr)
1724                     set(fileinfotxt,<span class="keyword">...</span>
1725                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1726                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1727                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1728                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1729                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1730                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1731                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now)</span>
1732                     
1733                 <span class="keyword">end</span>
1734             <span class="keyword">case</span> <span class="string">'Mean Cross Section Contour'</span>
1735                 <span class="comment">% Focus the figure</span>
1736                 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
1737                 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
1738                     figure(hff)
1739                     
1740                     <span class="comment">% Make the changes to figure</span>
1741                     set(gcf,<span class="string">'Color'</span>,BkgdColor);
1742                     set(gca,<span class="string">'FontSize'</span>,FntSize)
1743                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize)
1744                     set(gca,<span class="string">'Color'</span>,[0.3 0.3 0.3]) <span class="comment">%FigColor)</span>
1745                     set(gca,<span class="string">'XColor'</span>,AxColor)
1746                     set(gca,<span class="string">'YColor'</span>,AxColor)
1747                     set(gca,<span class="string">'ZColor'</span>,AxColor)
1748                     set(findobj(gcf,<span class="string">'tag'</span>,<span class="string">'Colorbar'</span>),<span class="keyword">...</span>
1749                         <span class="string">'FontSize'</span>,FntSize,<span class="keyword">...</span>
1750                         <span class="string">'Color'</span>,AxColor,<span class="keyword">...</span>
1751                         <span class="string">'XColor'</span>,AxColor,<span class="keyword">...</span>
1752                         <span class="string">'YColor'</span>,AxColor);
1753                     set(get(gca,<span class="string">'Title'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1754                     set(get(gca,<span class="string">'xLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1755                     set(get(gca,<span class="string">'yLabel'</span>),<span class="string">'FontSize'</span>,FntSize,<span class="string">'Color'</span>,AxColor)
1756                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'PlotBedElevation'</span>)   ,<span class="string">'color'</span>    ,AxColor)
1757                     set(findobj(gca,<span class="string">'tag'</span>,<span class="string">'ReferenceVectorText'</span>),<span class="string">'color'</span>    ,AxColor)
1758                     
1759                     <span class="comment">% Add a text object at the bottom of the figure with</span>
1760                     <span class="comment">% the file(s) and path for the data</span>
1761                     ismultiplot = numel(guiparams.mat_file)&gt;1;
1762                     <span class="keyword">if</span> ~ismultiplot
1763                         filestr = guiparams.savefile;
1764                         wd = length(filestr);
1765                         hd = 1;
1766                     <span class="keyword">else</span>
1767                         <span class="comment">% Construct a filename</span>
1768                         filestr   = [{guiparams.mat_path};guiparams.mat_file'];
1769                         wd        = max(cellfun(@length,filestr));
1770                         hd        = numel(filestr);
1771                             
1772                     <span class="keyword">end</span>
1773                     
1774                     fileinfotxt = uicontrol(<span class="string">'style'</span>,<span class="string">'text'</span>,<span class="string">'units'</span>,<span class="string">'characters'</span>);
1775                     disableMenuBar(hff)
1776                     set(fileinfotxt,<span class="keyword">...</span>
1777                         <span class="string">'string'</span>,filestr)
1778                     set(fileinfotxt,<span class="keyword">...</span>
1779                         <span class="string">'position'</span>,[0,0,wd,hd],<span class="keyword">...</span>
1780                         <span class="string">'Fontsize'</span>,FntSize/2,<span class="keyword">...</span>
1781                         <span class="string">'ForegroundColor'</span>,AxColor,<span class="keyword">...</span>
1782                         <span class="string">'BackgroundColor'</span>,BkgdColor,<span class="keyword">...</span>
1783                         <span class="string">'HorizontalAlignment'</span>,<span class="string">'Left'</span>,<span class="keyword">...</span>
1784                         <span class="string">'Tag'</span>,<span class="string">'fileinfotxt'</span>,<span class="keyword">...</span>
1785                         <span class="string">'Visible'</span>,<span class="string">'off'</span>)  <span class="comment">% hide this by default, editFigureDialog handles it now</span>
1786                 <span class="keyword">end</span>
1787             <span class="keyword">otherwise</span>
1788         <span class="keyword">end</span>
1789     <span class="keyword">end</span>
1790     
1791     
1792 <span class="keyword">end</span>
1793 
1794 <span class="comment">% [EOF] menuStylePresentation_Callback</span>
1795 
1796 <span class="comment">% --------------------------------------------------------------------</span>
1797 <span class="comment">% function menuKMZVerticalOffset_Callback(hObject, eventdata, handles)</span>
1798 <span class="comment">%</span>
1799 <span class="comment">% % Get the Application data:</span>
1800 <span class="comment">% % -------------------------</span>
1801 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
1802 <span class="comment">%</span>
1803 <span class="comment">% % Initialize the answer:</span>
1804 <span class="comment">% % ----------------------</span>
1805 <span class="comment">% numstr = {num2str(guiparams.vertical_offset)};</span>
1806 <span class="comment">% answer = NaN;</span>
1807 <span class="comment">% while isnan(answer)</span>
1808 <span class="comment">%     answer = inputdlg('Vertical Offset (m)','KMZ Export',1,numstr);</span>
1809 <span class="comment">%</span>
1810 <span class="comment">%     if isempty(answer) % User hits &quot;Cancel&quot;</span>
1811 <span class="comment">%         return</span>
1812 <span class="comment">%     end</span>
1813 <span class="comment">%</span>
1814 <span class="comment">%     answer = str2double(answer); % A non-numeric char will be NaN</span>
1815 <span class="comment">%     % A numeric char will be a double</span>
1816 <span class="comment">% end</span>
1817 <span class="comment">%</span>
1818 <span class="comment">% % Re-store the Application data:</span>
1819 <span class="comment">% % ------------------------------</span>
1820 <span class="comment">% guiparams.vertical_offset = answer;</span>
1821 <span class="comment">% setappdata(handles.figure1,'guiparams',guiparams)</span>
1822 <span class="comment">%</span>
1823 <span class="comment">% % [EOF] menuKMZExport_Callback</span>
1824 
1825 <span class="comment">% --------------------------------------------------------------------</span>
1826 <a name="_sub43" href="#_subfunctions" class="code">function menuAdvancedSettings_Callback(hObject, eventdata, handles)</a>
1827 <span class="comment">% Get the Application Data:</span>
1828 <span class="comment">% -------------------------</span>
1829 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1830 
1831 <span class="comment">% Open the Advanced Settings SubGUI</span>
1832 <span class="comment">%----------------------------------</span>
1833 AdvancedSettings_subgui();
1834 uiwait(findobj(<span class="string">'Name'</span>,<span class="string">'Advanced Settings'</span>));
1835 
1836 <span class="comment">% Get the data back from the Advanced Settings SubGUI</span>
1837 <span class="comment">% and store them back in the VMT memory</span>
1838 <span class="comment">%----------------------------------------------------</span>
1839 guiparams = getpref(<span class="string">'VMTadvancedsettings'</span>,<span class="string">'guiparams'</span>);
1840 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
1841 
1842 <span class="comment">% Process Vertical Reference Changes</span>
1843 <a href="#_sub36" class="code" title="subfunction VerticalReference_Callback(hObject, eventdata, handles)">VerticalReference_Callback</a>(hObject, eventdata, handles)
1844 
1845 
1846 
1847 <span class="comment">% --------------------------------------------------------------------</span>
1848 <a name="_sub44" href="#_subfunctions" class="code">function menuBathymetryParameters_Callback(hObject, eventdata, handles)</a>
1849 <span class="comment">% Not implemented</span>
1850 
1851 <span class="comment">% --------------------------------------------------------------------</span>
1852 <a name="_sub45" href="#_subfunctions" class="code">function menuTools_Callback(hObject, eventdata, handles)</a>
1853 <span class="comment">% Empty</span>
1854 
1855 <span class="comment">% --------------------------------------------------------------------</span>
1856 <a name="_sub46" href="#_subfunctions" class="code">function menuASCII2GIS_Callback(hObject, eventdata, handles)</a>
1857 ASCII2GIS_GUI
1858 <span class="comment">% [EOF] menuASCII2GIS_Callback</span>
1859 
1860 <span class="comment">% --------------------------------------------------------------------</span>
1861 <a name="_sub47" href="#_subfunctions" class="code">function menuASCII2KML_Callback(hObject, eventdata, handles)</a>
1862 
1863 <span class="comment">% Get the Application preferences:</span>
1864 <span class="comment">% --------------------------------</span>
1865 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1866 
1867 inpath = guiprefs.kmz_path;
1868 <span class="keyword">if</span> iscell(guiprefs.kmz_file)
1869     infile = guiprefs.kmz_file{1};
1870 <span class="keyword">else</span>
1871     infile = guiprefs.kmz_file;
1872 <span class="keyword">end</span>
1873 [log_text,outpath,outfile] = ASCII2KML(inpath,infile);
1874 
1875 guiprefs.kmz_path = outpath;
1876 guiprefs.kmz_file = outfile;
1877 
1878 <span class="comment">% Update persistent preferences</span>
1879 <span class="comment">% -----------------------------</span>
1880 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
1881 
1882 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1883 
1884 <span class="comment">% --------------------------------------------------------------------</span>
1885 <a name="_sub48" href="#_subfunctions" class="code">function menuOpenBatchMode_Callback(hObject, eventdata, handles)</a>
1886 <span class="comment">% Get the Application preferences:</span>
1887 <span class="comment">% --------------------------------</span>
1888 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1889 
1890 VMT_BatchMode;
1891 <span class="comment">% [EOF] menuOpenBatchMode_Callback</span>
1892 
1893 <span class="comment">% --------------------------------------------------------------------</span>
1894 <a name="_sub49" href="#_subfunctions" class="code">function menuHelp_Callback(hObject, eventdata, handles)</a>
1895 <span class="comment">% Empty</span>
1896 
1897 <span class="comment">% --------------------------------------------------------------------</span>
1898 <a name="_sub50" href="#_subfunctions" class="code">function menuUsersGuide_Callback(hObject, eventdata, handles)</a>
1899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1900 <span class="keyword">try</span> <span class="comment">% to open the User Guide PDF</span>
1901     open([pwd filesep <span class="string">'doc'</span> filesep <span class="string">'VMT User Guide '</span> guiparams.vmt_version{1} <span class="string">'.pdf'</span>]);
1902     
1903 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1904     
1905     <span class="keyword">if</span> isdeployed
1906         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1907             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1908         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1909             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1910             errLogFileName},<span class="keyword">...</span>
1911             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1912             <span class="string">'error'</span>);
1913         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1914         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1915         fclose(fid);
1916         rethrow(err)
1917     <span class="keyword">else</span>
1918         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1919             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1920             <span class="string">'error'</span>);
1921         rethrow(err);
1922     <span class="keyword">end</span>
1923 <span class="keyword">end</span>
1924 <span class="comment">% [EOF] menuASCII2KML_Callback</span>
1925 
1926 <span class="comment">% --------------------------------------------------------------------</span>
1927 <a name="_sub51" href="#_subfunctions" class="code">function menuFunctionLibrary_Callback(hObject, eventdata, handles)</a>
1928 <span class="comment">% Get the Application data:</span>
1929 <span class="comment">% -------------------------</span>
1930 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams'); %#ok&lt;NASGU&gt;</span>
1931 
1932 <span class="keyword">try</span>
1933     open([pwd filesep <span class="string">'/doc/index.html'</span>])
1934 
1935 
1936 <span class="comment">% This catch is probably not necessary.</span>
1937 <span class="keyword">catch</span> err 
1938     <span class="keyword">if</span> isdeployed
1939         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1940             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1941         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1942             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1943             errLogFileName},<span class="keyword">...</span>
1944             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1945             <span class="string">'error'</span>);
1946         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1947         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1948         fclose(fid);
1949         rethrow(err)
1950     <span class="keyword">else</span>
1951         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1952             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1953             <span class="string">'error'</span>);
1954         rethrow(err);
1955     <span class="keyword">end</span>
1956 <span class="keyword">end</span>
1957 
1958 <span class="comment">% [EOF] menuFunctionLibrary_Callback</span>
1959 
1960 <span class="comment">% --------------------------------------------------------------------</span>
1961 <a name="_sub52" href="#_subfunctions" class="code">function menuCheckForUpdates_Callback(hObject, eventdata, handles)</a>
1962 
1963 <span class="comment">% Get the Application data:</span>
1964 <span class="comment">% -------------------------</span>
1965 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
1966 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
1967 
1968 <span class="comment">% Check version tag against the web, and display a message</span>
1969 <span class="keyword">try</span>
1970     <span class="comment">%webdata = urlread('file:///C:/Users/fengel/Downloads/VMT_version.txt');</span>
1971     webdata = urlread(<span class="string">'https://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt'</span>);
1972     <span class="keyword">if</span> length(webdata) &gt; 5
1973         current_vmt_version{1} = webdata(1:5);
1974         current_vmt_version{2} = webdata(8:16);
1975     <span class="keyword">else</span>
1976         current_vmt_version = webdata;
1977     <span class="keyword">end</span>
1978     <span class="comment">%     current_vmt_version = urlread('http://hydroacoustics.usgs.gov/movingboat/VMT/VMT_version.txt');</span>
1979 <span class="keyword">catch</span> err <span class="comment">%#ok&lt;NASGU&gt;</span>
1980     <span class="keyword">if</span> isdeployed
1981         errLogFileName = fullfile(pwd,<span class="keyword">...</span>
1982             [<span class="string">'errorLog'</span> datestr(now,<span class="string">'yyyymmddHHMMSS'</span>) <span class="string">'.txt'</span>]);
1983         msgbox({[<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier];<span class="keyword">...</span>
1984             [<span class="string">'Error details are being written to the following file: '</span>];<span class="keyword">...</span>
1985             errLogFileName},<span class="keyword">...</span>
1986             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1987             <span class="string">'error'</span>);
1988         fid = fopen(errLogFileName,<span class="string">'W'</span>);
1989         fwrite(fid,err.getReport(<span class="string">'extended'</span>,<span class="string">'hyperlinks'</span>,<span class="string">'off'</span>));
1990         fclose(fid);
1991         rethrow(err)
1992     <span class="keyword">else</span>
1993         msgbox([<span class="string">'An unexpected error occurred. Error code: '</span> err.identifier],<span class="keyword">...</span>
1994             <span class="string">'VMT Status: Unexpected Error'</span>,<span class="keyword">...</span>
1995             <span class="string">'error'</span>);
1996         rethrow(err);
1997     <span class="keyword">end</span>
1998 <span class="keyword">end</span>
1999 
2000 <span class="keyword">if</span> ischar(current_vmt_version)
2001     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version)
2002         h = msgbox(<span class="keyword">...</span>
2003             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2004             <span class="string">''</span>;<span class="keyword">...</span>
2005             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2006             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2007     <span class="keyword">else</span>
2008         h = msgbox(<span class="keyword">...</span>
2009             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2010             <span class="string">''</span>;<span class="keyword">...</span>
2011             [<span class="string">'Latest available version: '</span> current_vmt_version];<span class="keyword">...</span>
2012             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2013     <span class="keyword">end</span>
2014 <span class="keyword">elseif</span> iscell(current_vmt_version)
2015     <span class="keyword">if</span> strcmpi(guiparams.vmt_version{1},current_vmt_version{1}) &amp;&amp; strcmpi(guiparams.vmt_version{2},current_vmt_version{2})
2016         h = msgbox(<span class="keyword">...</span>
2017             {<span class="string">'VMT is currently up to date, no updates available.'</span>;<span class="keyword">...</span>
2018             <span class="string">''</span>;<span class="keyword">...</span>
2019             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2020             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2021     <span class="keyword">else</span>
2022         h = msgbox(<span class="keyword">...</span>
2023             {<span class="string">'VMT is out of date. Please visit the VMT homepage.'</span>;<span class="keyword">...</span>
2024             <span class="string">''</span>;<span class="keyword">...</span>
2025             [<span class="string">'Latest available version: '</span> current_vmt_version{1} <span class="string">'; Release: '</span> current_vmt_version{2}];<span class="keyword">...</span>
2026             [<span class="string">'Installed version: '</span> guiparams.vmt_version{1} <span class="string">'; Release: '</span> guiparams.vmt_version{2}]},<span class="string">'Check for updates'</span>,<span class="string">'modal'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2027     <span class="keyword">end</span>
2028 <span class="keyword">end</span>
2029 <span class="comment">% [EOF] menuCheckForUpdates_Callback</span>
2030 
2031 <span class="comment">% --------------------------------------------------------------------</span>
2032 <a name="_sub53" href="#_subfunctions" class="code">function menuAbout_Callback(hObject, eventdata, handles)</a>
2033 
2034 <span class="comment">% Get the Application data:</span>
2035 <span class="comment">% -------------------------</span>
2036 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2037 messagestr = <span class="keyword">...</span>
2038     {<span class="string">'The Velocity Mapping Toolbox'</span>;<span class="keyword">...</span>
2039     [<span class="string">'   Version: '</span> guiparams.vmt_version{1}];<span class="keyword">...</span>
2040     [<span class="string">'   Release: '</span> guiparams.vmt_version{2}];<span class="keyword">...</span>
2041     <span class="string">''</span>;<span class="keyword">...</span>
2042     <span class="string">''</span>;<span class="keyword">...</span>
2043     <span class="string">'With collaborations from:'</span>;<span class="keyword">...</span>
2044     <span class="string">'   U.S. Geological Survey'</span>;<span class="keyword">...</span>
2045     <span class="string">'   University of Illinois'</span>;<span class="keyword">...</span>
2046     <span class="string">'   University of Hull'</span>;<span class="keyword">...</span>
2047     <span class="string">''</span>;<span class="keyword">...</span>
2048     <span class="string">''</span>;<span class="keyword">...</span>
2049     <span class="string">'Citation: '</span>;<span class="keyword">...</span>
2050     <span class="string">'   Parsons, D. R., Jackson, P. R., Czuba, J. A., Engel, F. L.,'</span>;<span class="keyword">...</span>
2051     <span class="string">'   Rhoads, B. L., Oberg, K. A., Best, J. L., Mueller, D. S.,'</span>;<span class="keyword">...</span>
2052     <span class="string">'   Johnson, K. K. and Riley, J. D. (2013), Velocity Mapping'</span>;<span class="keyword">...</span>
2053     <span class="string">'   Toolbox (VMT): a processing and visualization suite for'</span>;<span class="keyword">...</span>
2054     <span class="string">'   moving-vessel ADCP measurements. Earth Surf. Process.'</span>;<span class="keyword">...</span>
2055     <span class="string">'   Landforms.doi: 10.1002/esp.3367'</span>};
2056 h = msgbox(messagestr,<span class="string">'About VMT'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2057 <span class="comment">% [EOF] menuAbout_Callback</span>
2058 
2059 
2060 
2061 
2062 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2063 <span class="comment">% TOOLBAR CALLBACKS %</span>
2064 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
2065 
2066 <span class="comment">% --------------------------------------------------------------------</span>
2067 <a name="_sub54" href="#_subfunctions" class="code">function loadDataCallback(hObject, eventdata, handles)</a>
2068 axes(findobj(handles.figure1,<span class="string">'Tag'</span>,<span class="string">'Plot1Shiptracks'</span>)); cla 
2069 <span class="comment">% Read Files into Data Structure using tfile.</span>
2070 
2071 <span class="comment">% Get the Application data:</span>
2072 <span class="comment">% -------------------------</span>
2073 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2074 guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2075 
2076 <span class="comment">% Ask the user to select files:</span>
2077 <span class="comment">% -----------------------------</span>
2078 current_file = fullfile(guiprefs.ascii_path,guiprefs.ascii_file{1});
2079 [filename,pathname] = uigetfile({<span class="string">'*_ASC.TXT'</span>,<span class="string">'ASCII (*_ASC.TXT)'</span>}, <span class="keyword">...</span>
2080     <span class="string">'Select the ASCII Output Files'</span>, <span class="keyword">...</span>
2081     current_file, <span class="keyword">...</span>
2082     <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
2083 
2084 <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
2085     guiparams.data_folder = pathname;
2086     <span class="keyword">if</span> ischar(filename)
2087         filename = {filename};
2088     <span class="keyword">end</span>
2089     guiparams.data_files = filename;
2090     guiparams.mat_file = <span class="string">''</span>;
2091     
2092     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2093     
2094    
2095     
2096     <span class="comment">% Update the preferences:</span>
2097     <span class="comment">% -----------------------</span>
2098     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2099     guiprefs.ascii_path = pathname;
2100     guiprefs.ascii_file = filename;
2101     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2102     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
2103     
2104     <span class="comment">% Push messages to Log Window:</span>
2105     <span class="comment">% ----------------------------</span>
2106     log_text = {<span class="keyword">...</span>
2107         <span class="string">''</span>;<span class="keyword">...</span>
2108         [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
2109         <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
2110         guiparams.data_folder;
2111         <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
2112         char(filename)};
2113     statusLogging(handles.LogWindow, log_text)
2114     
2115     <span class="comment">% Read the file(s)</span>
2116     <span class="comment">% ----------------</span>
2117     [~,~,savefile,A,z] = <span class="keyword">...</span>
2118         <a href="VMT_ReadFiles.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles(zPathName,zFileName)">VMT_ReadFiles</a>(guiparams.data_folder,guiparams.data_files);
2119     guiparams.savefile = savefile;
2120     guiparams.A        = A;
2121     guiparams.z        = z;
2122     
2123     
2124     <span class="comment">% Set the vertical grid node spacing</span>
2125     <span class="comment">% ----------------------------------</span>
2126     <span class="comment">% For RioGrande probes, use the bin size, else just use the default</span>
2127     <span class="comment">% Backwards compatible</span>
2128     <span class="keyword">if</span> A(1).Sup.wm ~= 3 <span class="comment">% RG</span>
2129         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,double(A(1).Sup.binSize_cm(1))/100)
2130         guiparams.vertical_grid_node_spacing = double(A(1).Sup.binSize_cm(1))/100;
2131     <span class="keyword">else</span> <span class="comment">% Older file, must be RR or M9</span>
2132         set(handles.VerticalGridNodeSpacing,<span class="string">'String'</span>,0.4)
2133         guiparams.vertical_grid_node_spacing = 0.4;
2134     <span class="keyword">end</span>
2135     
2136     
2137     <span class="comment">% Save application data</span>
2138     <span class="comment">% ---------------------</span>
2139     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2140        
2141 <span class="comment">%</span>
2142 <span class="comment">%     % Preprocess the data:</span>
2143 <span class="comment">%     % --------------------</span>
2144 <span class="comment">%     A = VMT_PreProcess(z,A);</span>
2145 <span class="comment">%</span>
2146 <span class="comment">%     % Push messages to Log Window:</span>
2147 <span class="comment">%     % ----------------------------</span>
2148 <span class="comment">%     log_text = {...</span>
2149 <span class="comment">%         '   Preprocessing complete.';...</span>
2150 <span class="comment">%         '   Begin Data Processing...'};</span>
2151 <span class="comment">%     statusLogging(handles.LogWindow, log_text)</span>
2152 <span class="comment">%</span>
2153 <span class="comment">%     A(1).hgns = guiparams.horizontal_grid_node_spacing;</span>
2154 <span class="comment">%     A(1).wse  = guiparams.wse;  %Set the WSE to entered value</span>
2155 <span class="comment">%     [A,V,processing_log_text] = VMT_ProcessTransects(z,A,...</span>
2156 <span class="comment">%         guiparams.set_cross_section_endpoints,...</span>
2157 <span class="comment">%         guiparams.unit_discharge_correction,guiparams.eta);</span>
2158 <span class="comment">%</span>
2159 <span class="comment">%     % Push messages to Log Window:</span>
2160 <span class="comment">%     % ----------------------------</span>
2161 <span class="comment">%     statusLogging(handles.LogWindow, processing_log_text)</span>
2162 <span class="comment">%</span>
2163 <span class="comment">%     % Store the data:</span>
2164 <span class="comment">%     % ---------------</span>
2165 <span class="comment">%     guiparams.z = z;</span>
2166 <span class="comment">%     guiparams.A = A;</span>
2167 <span class="comment">%     guiparams.V = V;</span>
2168 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
2169     
2170           
2171     <span class="comment">% Update the GUI:</span>
2172     <span class="comment">% ---------------</span>
2173     <a href="#_sub97" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
2174     
2175     <span class="comment">% If data are RG or SP, set vertical grid node spacing to bin size</span>
2176     
2177 <span class="keyword">end</span>
2178 <span class="comment">% [EOF] loadDataCallback</span>
2179 
2180 
2181 
2182 <span class="comment">% --------------------------------------------------------------------</span>
2183 <a name="_sub55" href="#_subfunctions" class="code">function saveDataCallback(hObject, eventdata, handles)</a>
2184 <span class="comment">% SaveMATFile_Callback(handles.SaveMATFile,eventdata,handles)</span>
2185 
2186 <span class="comment">% Get the Application data:</span>
2187 <span class="comment">% -------------------------</span>
2188 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2189 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2190 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2191 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2192 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2193 
2194 [the_file,the_path] = <span class="keyword">...</span>
2195     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2196     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2197     fullfile(guiparams.mat_path,guiparams.savefile));
2198 
2199 <span class="comment">% Save the processed data to a MAT file:</span>
2200 <span class="comment">% --------------------------------------</span>
2201 <span class="keyword">if</span> ischar(the_file)
2202     guiparams.mat_path = the_path;
2203     guiparams.mat_file = the_file;
2204     guiparams.savefile = the_file;
2205     
2206     <span class="comment">% Re-store the Application data:</span>
2207     <span class="comment">% ------------------------------</span>
2208     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2209     
2210     <span class="comment">% Update the preferences:</span>
2211     <span class="comment">% -----------------------</span>
2212     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2213     guiprefs.mat_path = the_path;
2214     guiprefs.mat_file = the_file;
2215     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2216     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2217     
2218     [pathstr,filename,extension] = fileparts([guiparams.mat_path guiparams.savefile]);
2219     savefile = fullfile(pathstr,[filename extension]);
2220     <span class="comment">%h = msgbox(['Saving processed data in MAT File ''' filename extension ''''], ...</span>
2221     <span class="comment">%    'Saving Processed Data File...'); %#ok&lt;NASGU&gt;</span>
2222     log_text = {<span class="keyword">...</span>
2223         <span class="string">'Saving Processed Data File...'</span>;<span class="keyword">...</span>
2224         savefile};
2225     statusLogging(handles.LogWindow,log_text)
2226     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2227 <span class="keyword">end</span>
2228 
2229 <span class="comment">% [EOF] saveDataCallback</span>
2230 
2231 
2232 <span class="comment">% --------------------------------------------------------------------</span>
2233 <a name="_sub56" href="#_subfunctions" class="code">function saveBathymetryCallback(hObject, eventdata, handles)</a>
2234 
2235 <span class="comment">% Get the Application data:</span>
2236 <span class="comment">% -------------------------</span>
2237 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2238 z   = guiparams.z;
2239 A   = guiparams.A;
2240 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
2241 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
2242 
2243 <span class="comment">% Compute multibeam bathymetry:</span>
2244 <span class="comment">% -----------------------------</span>
2245 msgbox(<span class="string">'Processing Bathymetry...Please Be Patient'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2246 <span class="comment">%A = VMT_MBBathy(z,A,savefile,handles.beam_angle,handles.MagneticVariation,handles.WSE);</span>
2247 <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(z,A,savefile, <span class="keyword">...</span>
2248     guiparams.beam_angle, <span class="keyword">...</span>
2249     guiparams.magnetic_variation, <span class="keyword">...</span>
2250     guiparams.water_surface_elevation, <span class="keyword">...</span>
2251     guiparams.output_auxiliary_data);
2252 
2253 msgbox(<span class="string">'Bathymetry Output Complete'</span>,<span class="string">'VMT Status'</span>,<span class="string">'help'</span>,<span class="string">'replace'</span>)
2254 
2255 <span class="comment">% [EOF] saveBathymetryCallback</span>
2256 
2257 <span class="comment">% --------------------------------------------------------------------</span>
2258 <a name="_sub57" href="#_subfunctions" class="code">function plottingParametersCallback(hObject, eventdata, handles)</a>
2259 
2260 <span class="comment">% Get the Application data:</span>
2261 <span class="comment">% -------------------------</span>
2262 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2263 
2264 [guiparams.english_units,guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2265     guiparams.presentation,guiparams.print] = <span class="keyword">...</span>
2266     plotParametersDialog(guiparams.english_units, <span class="keyword">...</span>
2267     guiparams.set_cross_section_endpoints,<span class="keyword">...</span>
2268     guiparams.presentation,guiparams.print,<span class="keyword">...</span>
2269     handles.figure1);
2270 
2271 <span class="comment">% Update the GUI:</span>
2272 <span class="comment">% ---------------</span>
2273 <span class="keyword">if</span> guiparams.english_units
2274     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2275     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2276 <span class="keyword">else</span>
2277     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2278     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2279 <span class="keyword">end</span>
2280 
2281 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2282     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
2283     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
2284 <span class="keyword">else</span>
2285     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
2286     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
2287 <span class="keyword">end</span>
2288 
2289 <span class="keyword">if</span> guiparams.presentation
2290     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2291 <span class="comment">%     set(handles.menuStylePrint,           'Checked','off')</span>
2292 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','on')</span>
2293 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','off')</span>
2294 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','on')</span>
2295 <span class="keyword">else</span>
2296     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2297 <span class="comment">%     set(handles.menuStylePrint,           'Checked','on')</span>
2298 <span class="comment">%     set(handles.menuStylePresentation,    'Checked','off')</span>
2299 <span class="comment">%     set(handles.menuPrintFormat,          'Checked','on')</span>
2300 <span class="comment">%     set(handles.menuPresentationFormat,   'Checked','off')</span>
2301 <span class="keyword">end</span>
2302 
2303 <span class="comment">% Re-store the Application data:</span>
2304 <span class="comment">% ------------------------------</span>
2305 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2306 
2307 <span class="comment">% [EOF] plottingParametersCallback</span>
2308 
2309 
2310 <span class="comment">% --------------------------------------------------------------------</span>
2311 <a name="_sub58" href="#_subfunctions" class="code">function processingParametersCallback(hObject, eventdata, handles)</a>
2312 
2313 <span class="comment">% Get the Application data:</span>
2314 <span class="comment">% -------------------------</span>
2315 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2316 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2317 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2318 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2319 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2320 
2321 <span class="comment">% [EOF] processingParametersCallback</span>
2322 
2323 
2324 <span class="comment">% --------------------------------------------------------------------</span>
2325 <a name="_sub59" href="#_subfunctions" class="code">function shiptracksPlotCallback(hObject, eventdata, handles)</a>
2326 <span class="comment">% Plot 1</span>
2327 
2328 <span class="comment">% Get the Application data:</span>
2329 <span class="comment">% -------------------------</span>
2330 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2331 z = guiparams.z;
2332 A = guiparams.A;
2333 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2334 <span class="comment">% Map = guiparams.Map;</span>
2335 
2336 
2337 <span class="comment">% Preprocess the data:</span>
2338 <span class="comment">% --------------------</span>
2339 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2340 
2341 <span class="comment">% Push messages to Log Window:</span>
2342 <span class="comment">% ----------------------------</span>
2343 log_text = {<span class="keyword">...</span>
2344     <span class="string">'   Preprocessing complete.'</span>;<span class="keyword">...</span>
2345     <span class="string">'   Begin Data Processing...'</span>};
2346 statusLogging(handles.LogWindow, log_text)
2347 
2348 <span class="comment">% Process the transects:</span>
2349 <span class="comment">% ----------------------</span>
2350 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2351 A(1).vgns = guiparams.vertical_grid_node_spacing;
2352 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2353 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2354     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2355 
2356 <span class="comment">% Compute the smoothed variables</span>
2357 <span class="comment">% ------------------------------</span>
2358 <span class="comment">% This is required so that the V struc is complete at any point during</span>
2359 <span class="comment">% runtime.</span>
2360 V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2361     <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2362     guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2363     guiparams.vertical_smoothing_window);
2364 [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2365 
2366 <span class="comment">% Push messages to Log Window:</span>
2367 <span class="comment">% ----------------------------</span>
2368 statusLogging(handles.LogWindow, processing_log_text)
2369 
2370 <span class="comment">% Store the data:</span>
2371 <span class="comment">% ---------------</span>
2372 guiparams.z = z;
2373 guiparams.A = A;
2374 guiparams.V = V;
2375 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2376 
2377 <span class="comment">% Push messages to Log Window:</span>
2378 <span class="comment">% ----------------------------</span>
2379 log_text = {<span class="string">'Plotting Shiptracks (reprocessing)'</span>};
2380 statusLogging(handles.LogWindow, log_text)
2381 
2382 <span class="comment">% Create or replot the Shiptracks</span>
2383 <span class="comment">% -------------------------------</span>
2384 <span class="comment">% Grab the axes to the plot</span>
2385 <span class="comment">% axes(handles.Plot1Shiptracks);</span>
2386 <a href="VMT_PlotShiptracks.html" class="code" title="function hf = VMT_PlotShiptracks(A,V,z,setends,hf)">VMT_PlotShiptracks</a>(A,V,z,guiparams.set_cross_section_endpoints,handles.Plot1Shiptracks); <span class="comment">% PLOT 1</span>
2387 
2388 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2389 <span class="comment">% New plot display window</span>
2390 <span class="comment">% h = VMT_CreatePlotDisplay('shiptracks');</span>
2391 <span class="comment">% h = figure(1); clf</span>
2392 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2393 
2394 <span class="comment">% [EOF] shiptracksPlotCallback</span>
2395 
2396 
2397 <span class="comment">% --------------------------------------------------------------------</span>
2398 <a name="_sub60" href="#_subfunctions" class="code">function planviewPlotCallback(hObject, eventdata, handles)</a>
2399 <span class="comment">% Plot 2</span>
2400 
2401 <span class="comment">% Get the Application data:</span>
2402 <span class="comment">% -------------------------</span>
2403 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2404 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2405 
2406 <span class="keyword">if</span> iscell(guiparams.mat_file) <span class="comment">% Multiple MAT files loaded</span>
2407     <span class="comment">% Push messages to Log Window:</span>
2408     <span class="comment">% ----------------------------</span>
2409     log_text = {<span class="string">'Plotting Multiple Transects (Planview)'</span>};
2410     statusLogging(handles.LogWindow, log_text)
2411     
2412        
2413     <span class="comment">% Push plotting parameters to log window:</span>
2414     <span class="comment">% ---------------------------------------</span>
2415     log_text = {<span class="keyword">...</span>
2416         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2417         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2418         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2419         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2420         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2421         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2422         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2423         };
2424     statusLogging(handles.LogWindow, log_text)
2425     
2426     <span class="comment">% Plot the data:</span>
2427     <span class="comment">% --------------</span>
2428     z = [];
2429     A = [];
2430     V = [];
2431     Map = [];
2432     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2433     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2434         depth_range, <span class="keyword">...</span>
2435         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2436         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2437         guiparams.smoothing_window_size, <span class="keyword">...</span>
2438         guiparams.display_shoreline, <span class="keyword">...</span>
2439         guiparams.english_units, <span class="keyword">...</span>
2440         guiparams.mat_file, <span class="keyword">...</span>
2441         guiparams.mat_path, <span class="keyword">...</span>
2442         guiparams.plotref); <span class="comment">% PLOT2</span>
2443     statusLogging(handles.LogWindow, log_text)
2444     
2445     <span class="comment">% Plot a Shoreline Map:</span>
2446     <span class="comment">% ---------------------</span>
2447     <span class="keyword">if</span> guiparams.display_shoreline
2448         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2449             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2450             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2451             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2452         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2453             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2454             Map.UTMe   = mapdata(:,1);
2455             Map.UTMn   = mapdata(:,2);
2456             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2457             <span class="comment">%Map.UTMzone = zone;</span>
2458         <span class="keyword">else</span>
2459             Map = [];
2460         <span class="keyword">end</span>
2461         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2462         log_text = {<span class="keyword">...</span>
2463             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2464             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2465             };
2466         statusLogging(handles.LogWindow, log_text)
2467     <span class="keyword">else</span>
2468         Map = [];
2469     <span class="keyword">end</span>
2470     
2471 <span class="keyword">else</span>
2472     z = guiparams.z;
2473     A = guiparams.A;
2474     <span class="comment">% V = guiparams.V;</span>
2475     Map = guiparams.Map;
2476     
2477     <span class="comment">% Push messages to Log Window:</span>
2478     <span class="comment">% ----------------------------</span>
2479     log_text = {<span class="string">'Plotting Depth Averaged Vectors (reprocessing)'</span>};
2480     statusLogging(handles.LogWindow, log_text)
2481     
2482         
2483     <span class="comment">% Preprocess the data:</span>
2484     <span class="comment">% --------------------</span>
2485     A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2486     
2487     <span class="comment">% Process the transects:</span>
2488     <span class="comment">% ----------------------</span>
2489     A(1).hgns = guiparams.horizontal_grid_node_spacing;
2490     A(1).vgns = guiparams.vertical_grid_node_spacing;
2491     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2492     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2493     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2494     
2495     <span class="comment">% Compute the smoothed variables</span>
2496     <span class="comment">% ------------------------------</span>
2497     <span class="comment">% This is required so that the V struc is complete at any point during</span>
2498     <span class="comment">% runtime.</span>
2499     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2500         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2501         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2502         guiparams.vertical_smoothing_window);
2503     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2504     
2505     <span class="comment">% Push messages to Log Window:</span>
2506     <span class="comment">% ----------------------------</span>
2507     statusLogging(handles.LogWindow, processing_log_text)
2508     
2509     <span class="comment">% Plot the cross section:</span>
2510     <span class="comment">% -----------------------</span>
2511     log_text = {<span class="keyword">...</span>
2512         <span class="string">'Plan View Plotting Parameters'</span>;<span class="keyword">...</span>
2513         sprintf(<span class="string">'   Depth range %3.1f to %3.1f m'</span>,guiparams.depth_range_min, guiparams.depth_range_max);<span class="keyword">...</span>
2514         sprintf(<span class="string">'   Vector scale: %d'</span>,guiparams.vector_scale_plan_view);<span class="keyword">...</span>
2515         sprintf(<span class="string">'   Vector spacing: %d'</span>,guiparams.vector_spacing_plan_view);<span class="keyword">...</span>
2516         sprintf(<span class="string">'   Vector spacing, in ground distance: %g m'</span>, (guiparams.vector_spacing_plan_view*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2517         sprintf(<span class="string">'   Smoothing window size: %d'</span>,guiparams.smoothing_window_size);<span class="keyword">...</span>
2518         sprintf(<span class="string">'   Smoothing window size, in ground distance: %g m'</span>, (2*guiparams.smoothing_window_size*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2519         };
2520     statusLogging(handles.LogWindow, log_text)
2521     
2522     <span class="comment">% Plot the data:</span>
2523     <span class="comment">% --------------</span>
2524     <span class="comment">%msgbox('Plotting Plan View','VMT Status','help','replace');</span>
2525     depth_range = [guiparams.depth_range_min guiparams.depth_range_max];
2526     
2527     
2528     [PVdata,~,log_text] = <a href="VMT_PlotPlanViewQuivers.html" class="code" title="function [PVdata,fig_planview_handle,log_text] = VMT_PlotPlanViewQuivers(z,A,V,Map,drng,ascale,QuiverSpacing,pvsmwin,pshore,plot_english,varargin)">VMT_PlotPlanViewQuivers</a>(z,A,V,Map, <span class="keyword">...</span>
2529         depth_range, <span class="keyword">...</span>
2530         guiparams.vector_scale_plan_view, <span class="keyword">...</span>
2531         guiparams.vector_spacing_plan_view, <span class="keyword">...</span>
2532         guiparams.smoothing_window_size, <span class="keyword">...</span>
2533         guiparams.display_shoreline, <span class="keyword">...</span>
2534         guiparams.english_units, <span class="keyword">...</span>
2535         guiparams.mat_file, <span class="keyword">...</span>
2536         guiparams.mat_path, <span class="keyword">...</span>
2537         guiparams.plotref); <span class="comment">% PLOT2</span>
2538     statusLogging(handles.LogWindow, log_text)
2539     
2540     <span class="comment">% Plot User Set Endpoints</span>
2541     <span class="comment">% -----------------------</span>
2542     <span class="keyword">if</span> guiparams.set_cross_section_endpoints
2543         setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
2544         data = dlmread(fullfile(setendpoints.path,setendpoints.file));
2545         x = data(:,1);
2546         y = data(:,2);
2547         
2548         fh = findobj(0,<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2549         figure(fh); hold on
2550         plot(x,y,<span class="string">'go'</span>,<span class="string">'MarkerSize'</span>,10);
2551         hold off
2552     <span class="keyword">end</span>
2553     
2554     <span class="comment">% Plot a Shoreline Map:</span>
2555     <span class="comment">% ---------------------</span>
2556     <span class="keyword">if</span> guiparams.display_shoreline
2557         [guiprefs.shoreline_file,guiprefs.shoreline_path] = uigetfile(<span class="keyword">...</span>
2558             {<span class="string">'*.txt;*.csv'</span>,<span class="string">'All Text Files'</span>; <span class="string">'*.*'</span>,<span class="string">'All Files'</span>},<span class="keyword">...</span>
2559             <span class="string">'Select Map Text File'</span>,<span class="keyword">...</span>
2560             fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2561         <span class="keyword">if</span> ischar(guiprefs.shoreline_file) <span class="comment">% User did not hit cancel</span>
2562             mapdata = dlmread(fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file));
2563             Map.UTMe   = mapdata(:,1);
2564             Map.UTMn   = mapdata(:,2);
2565             Map.infile = fullfile(guiprefs.shoreline_path,guiprefs.shoreline_file);
2566             <span class="comment">%Map.UTMzone = zone;</span>
2567         <span class="keyword">else</span>
2568             Map = [];
2569         <span class="keyword">end</span>
2570         <a href="VMT_PlotShoreline.html" class="code" title="function VMT_PlotShoreline(Map)">VMT_PlotShoreline</a>(Map)
2571         log_text = {<span class="keyword">...</span>
2572             <span class="string">'   Loading map file.'</span>;<span class="keyword">...</span>
2573             <span class="string">'   Plotting shoreline.'</span><span class="keyword">...</span>
2574             };
2575         statusLogging(handles.LogWindow, log_text)
2576     <span class="keyword">else</span>
2577         Map = [];
2578     <span class="keyword">end</span>
2579     
2580 <span class="keyword">end</span>
2581 
2582 <span class="keyword">if</span> guiparams.add_background
2583     [guiprefs,log_text] = <a href="VMT_OverlayDOQQ.html" class="code" title="function [guiprefs,log_text] = VMT_OverlayDOQQ(guiprefs,varargin)">VMT_OverlayDOQQ</a>(guiprefs);
2584     statusLogging(handles.LogWindow, log_text)
2585 <span class="keyword">end</span>
2586 
2587 <span class="comment">% Update guiparams</span>
2588 <span class="comment">% ----------------</span>
2589 guiparams.z   = z;
2590 guiparams.A   = A;
2591 guiparams.V   = V;
2592 guiparams.Map = Map;
2593 guiparams.iric_anv_planview_data = PVdata;
2594 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams);
2595 
2596 <span class="comment">% Update preferences</span>
2597 <span class="comment">% ------------------</span>
2598 setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2599 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'shoreline'</span>)
2600 <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'aerial'</span>)
2601 
2602 <span class="comment">% Force plot to be formated properly</span>
2603 <span class="comment">% ----------------------------------</span>
2604 <span class="keyword">if</span> guiparams.presentation
2605     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2606 <span class="keyword">else</span>
2607     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2608 <span class="keyword">end</span>
2609 <span class="keyword">switch</span> guiparams.renderer
2610     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2611         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2612     <span class="keyword">case</span> <span class="string">'painters'</span>
2613         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2614     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2615         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2616 <span class="keyword">end</span>
2617 
2618 <span class="comment">% Focus the figure</span>
2619 <span class="comment">% ----------------</span>
2620 hff = findobj(<span class="string">'name'</span>,<span class="string">'Plan View Map'</span>);
2621 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2622     figure(hff)
2623 <span class="keyword">end</span>
2624 
2625 <span class="comment">% Start the Graphics Control Gui</span>
2626 <span class="comment">% ------------------------------</span>
2627 VMT_GraphicsControl
2628 
2629 <span class="comment">% [EOF] planviewPlotCallback</span>
2630 
2631 
2632 <span class="comment">% --------------------------------------------------------------------</span>
2633 <a name="_sub61" href="#_subfunctions" class="code">function crosssectionPlotCallback(hObject, eventdata, handles)</a>
2634 <span class="comment">% Plot 3</span>
2635 
2636 <span class="comment">% Get the Application data:</span>
2637 <span class="comment">% -------------------------</span>
2638 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2639 z = guiparams.z;
2640 A = guiparams.A;
2641 <span class="comment">% V = guiparams.V;</span>
2642 <span class="comment">% Map = guiparams.Map;</span>
2643 
2644 <span class="comment">% Preprocess the data:</span>
2645 <span class="comment">% --------------------</span>
2646 A = <a href="VMT_PreProcess.html" class="code" title="function A = VMT_PreProcess(z,A)">VMT_PreProcess</a>(z,A);
2647 
2648 <span class="comment">% Push messages to Log Window:</span>
2649 <span class="comment">% ----------------------------</span>
2650 log_text = {<span class="string">'Plotting Cross Section (reprocessing)'</span>};
2651 statusLogging(handles.LogWindow, log_text)
2652 
2653 <span class="comment">% Process the transects:</span>
2654 <span class="comment">% ----------------------</span>
2655 A(1).hgns = guiparams.horizontal_grid_node_spacing;
2656 A(1).vgns = guiparams.vertical_grid_node_spacing;
2657 A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2658 [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2659     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2660 
2661 <span class="comment">% Push messages to Log Window:</span>
2662 <span class="comment">% ----------------------------</span>
2663 statusLogging(handles.LogWindow, processing_log_text)
2664 
2665 <span class="comment">% Plot the cross section:</span>
2666 <span class="comment">% -----------------------</span>
2667 log_text = {<span class="keyword">...</span>
2668     <span class="string">'Cross Section Plotting Parameters'</span>;<span class="keyword">...</span>
2669     sprintf(<span class="string">'   Contour variable: %s'</span>          ,guiparams.contours(guiparams.idx_contour).string);<span class="keyword">...</span>
2670     sprintf(<span class="string">'   Vertical exaggeration: %d'</span>     ,guiparams.vertical_exaggeration);<span class="keyword">...</span>
2671     sprintf(<span class="string">'   Vector scale: %3.1f'</span>           ,guiparams.vector_scale_cross_section);<span class="keyword">...</span>
2672     sprintf(<span class="string">'   Horizontal vector spacing: %d'</span> ,guiparams.horizontal_vector_spacing);<span class="keyword">...</span>
2673     sprintf(<span class="string">'   Horz. vector spacing, in ground distance: %g m'</span>, (guiparams.horizontal_vector_spacing*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2674     sprintf(<span class="string">'   Vertical vector spacing: %d'</span>   ,guiparams.vertical_vector_spacing);<span class="keyword">...</span>
2675     sprintf(<span class="string">'   Vert. vector spacing, in ground distance: %g m'</span>, (guiparams.vertical_vector_spacing*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2676     sprintf(<span class="string">'   Horizontal smoothing window: %d'</span>,guiparams.horizontal_smoothing_window);<span class="keyword">...</span>
2677     sprintf(<span class="string">'   Horz. smoothing window, in ground distance: %g m'</span>, (2*guiparams.horizontal_smoothing_window*guiparams.horizontal_grid_node_spacing));<span class="keyword">...</span>
2678     sprintf(<span class="string">'   Vertical smoothing window: %d'</span> ,guiparams.vertical_smoothing_window);<span class="keyword">...</span>
2679     sprintf(<span class="string">'   Vert. smoothing window, in ground distance: %g m'</span>, (2*guiparams.vertical_smoothing_window*guiparams.vertical_grid_node_spacing));<span class="keyword">...</span>
2680     
2681     };
2682 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2683     log_text = vertcat(log_text, {<span class="keyword">...</span>
2684         sprintf(<span class="string">'   Vector variable: %s'</span>,guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).string);<span class="keyword">...</span>
2685         sprintf(<span class="string">'   Inc. vertical component?: %d'</span>,guiparams.include_vertical_velocity)<span class="keyword">...</span>
2686         });
2687 <span class="keyword">end</span>
2688 <span class="comment">% Push messages to Log Window:</span>
2689 <span class="comment">% ----------------------------</span>
2690 statusLogging(handles.LogWindow, log_text)
2691 
2692 <span class="keyword">if</span> guiparams.plot_secondary_flow_vectors
2693     <span class="comment">%msgbox('Plotting Cross Section','VMT Status','help','replace')</span>
2694 <span class="comment">%     V = VMT_SmoothVar(V, ...</span>
2695 <span class="comment">%         ...guiparams.contour, ...</span>
2696 <span class="comment">%         guiparams.horizontal_smoothing_window, ...</span>
2697 <span class="comment">%         guiparams.vertical_smoothing_window);</span>
2698     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2699         <span class="keyword">...</span><span class="comment">guiparams.secondary_flow_vector_variable, ...</span>
2700         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2701         guiparams.vertical_smoothing_window);
2702     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2703     [~,A,V,guiparams.mcsQuivers,plot_cont_log_text] = <a href="VMT_PlotXSContQuiver.html" class="code" title="function [z,A,V,toquiv,log_text] = VMT_PlotXSContQuiver(z,A,V,var,sf,exag,qspchorz,qspcvert,secvecvar,vvelcomp,plot_english,allow_flux_flip,start_bank,varargin)">VMT_PlotXSContQuiver</a>(z,A,V, <span class="keyword">...</span>
2704         guiparams.contour, <span class="keyword">...</span>
2705         guiparams.vector_scale_cross_section, <span class="keyword">...</span>
2706         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2707         guiparams.horizontal_vector_spacing, <span class="keyword">...</span>
2708         guiparams.vertical_vector_spacing, <span class="keyword">...</span>
2709         guiparams.secondary_flow_vector_variable, <span class="keyword">...</span>
2710         guiparams.include_vertical_velocity, <span class="keyword">...</span>
2711         guiparams.english_units,<span class="keyword">...</span>
2712         guiparams.allow_vmt_flip_flux,<span class="keyword">...</span>
2713         guiparams.start_bank); <span class="comment">%#ok&lt;ASGLU&gt; % PLOT3</span>
2714     
2715 <span class="keyword">elseif</span> ~guiparams.plot_secondary_flow_vectors
2716     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
2717         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
2718         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
2719         guiparams.vertical_smoothing_window);
2720     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
2721     [~,A,V,zmin,zmax,plot_cont_log_text] = <a href="VMT_PlotXSCont.html" class="code" title="function [z,A,V,zmin,zmax,log_text,fig_contour_handle] = VMT_PlotXSCont(z,A,V,var,exag,plot_english,allow_flux_flip)">VMT_PlotXSCont</a>(z,A,V, <span class="keyword">...</span>
2722         guiparams.contour, <span class="keyword">...</span>
2723         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2724         guiparams.english_units, <span class="keyword">...</span>
2725         guiparams.allow_vmt_flip_flux);  <span class="comment">%#ok&lt;ASGLU&gt;</span>
2726     
2727     guiparams.zmin = zmin;
2728     guiparams.zmax = zmax;
2729     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2730 <span class="keyword">end</span>
2731 
2732 <span class="comment">% Force plot to be formated properly</span>
2733 <span class="comment">% ----------------------------------</span>
2734 <span class="keyword">if</span> guiparams.presentation
2735     <a href="#_sub42" class="code" title="subfunction menuStylePresentation_Callback(hObject, eventdata, handles)">menuStylePresentation_Callback</a>(hObject, eventdata, handles)
2736 <span class="keyword">else</span>
2737     <a href="#_sub41" class="code" title="subfunction menuStylePrint_Callback(hObject, eventdata, handles)">menuStylePrint_Callback</a>(hObject, eventdata, handles)
2738 <span class="keyword">end</span>
2739 <span class="keyword">switch</span> guiparams.renderer
2740     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
2741         <a href="#_sub18" class="code" title="subfunction menuOpenGL_Callback(hObject, eventdata, handles)">menuOpenGL_Callback</a>(hObject, eventdata, handles)
2742     <span class="keyword">case</span> <span class="string">'painters'</span>
2743         <a href="#_sub19" class="code" title="subfunction menuPainters_Callback(hObject, eventdata, handles)">menuPainters_Callback</a>(hObject, eventdata, handles)
2744     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
2745         <a href="#_sub20" class="code" title="subfunction menuZbuffer_Callback(hObject, eventdata, handles)">menuZbuffer_Callback</a>(hObject, eventdata, handles)
2746 <span class="keyword">end</span>
2747 
2748 <span class="comment">% Focus the figure</span>
2749 <span class="comment">% ----------------</span>
2750 hff = findobj(<span class="string">'name'</span>,<span class="string">'Mean Cross Section Contour'</span>);
2751 <span class="keyword">if</span> ~isempty(hff) &amp;&amp;  ishandle(hff)
2752     figure(hff)
2753 <span class="keyword">end</span>
2754 
2755 <span class="comment">% Re-store the Application data:</span>
2756 <span class="comment">% ------------------------------</span>
2757 guiparams.V = V;
2758 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2759 
2760 <span class="comment">% Start the Graphics Control Gui</span>
2761 <span class="comment">% ------------------------------</span>
2762 VMT_GraphicsControl
2763 
2764 <span class="comment">% Push messages to Log Window:</span>
2765 <span class="comment">% ----------------------------</span>
2766 statusLogging(handles.LogWindow, plot_cont_log_text)
2767 <span class="comment">% msgbox('Plotting Complete','VMT Status','help','replace')</span>
2768 
2769 <span class="comment">% [EOF] crosssectionPlotCallback</span>
2770 
2771 
2772 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2773 <span class="comment">% DATA EXPORT CALLBACKS %</span>
2774 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2775 
2776 <span class="comment">% --------------------------------------------------------------------</span>
2777 <a name="_sub62" href="#_subfunctions" class="code">function SaveMATFile_Callback(hObject, eventdata, handles)</a>
2778 <span class="comment">% saveDataCallback(hObject, eventdata, handles)</span>
2779 
2780 <span class="comment">% Get the Application data:</span>
2781 <span class="comment">% -------------------------</span>
2782 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2783 z   = guiparams.z;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2784 A   = guiparams.A;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2785 V   = guiparams.V;   <span class="comment">%#ok&lt;NASGU&gt;</span>
2786 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2787 
2788 [the_file,the_path] = <span class="keyword">...</span>
2789     uiputfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-Files (*.mat)'</span>}, <span class="keyword">...</span>
2790     <span class="string">'Save MAT-File'</span>, <span class="keyword">...</span>
2791     fullfile(guiparams.mat_path,guiparams.savefile));
2792 
2793 <span class="comment">% Save the processed data to a MAT file:</span>
2794 <span class="comment">% --------------------------------------</span>
2795 <span class="keyword">if</span> ischar(the_file)
2796     guiparams.mat_path = the_path;
2797     guiparams.mat_file = the_file;
2798     guiparams.savefile = the_file;
2799     
2800     <span class="comment">% Re-store the Application data:</span>
2801     <span class="comment">% ------------------------------</span>
2802     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2803     
2804     <span class="comment">% Update the preferences:</span>
2805     <span class="comment">% -----------------------</span>
2806     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2807     guiprefs.mat_path = the_path;
2808     guiprefs.mat_file = the_file;
2809     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2810     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'mat'</span>)
2811     
2812     [~,filename,extension] = fileparts(guiparams.savefile);
2813     savefile = [filename extension];
2814     h = msgbox([<span class="string">'Saving processed data in MAT File '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
2815         <span class="string">'Saving Processed Data File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
2816     disp(<span class="string">'Saving Processed Data File...'</span>)
2817     disp(savefile)
2818     save(savefile,<span class="string">'A'</span>,<span class="string">'V'</span>,<span class="string">'z'</span>,<span class="string">'Map'</span>)
2819 <span class="keyword">end</span>
2820 
2821 <span class="comment">% [EOF] SaveMATFile_Callback</span>
2822 
2823 
2824 <span class="comment">% --------------------------------------------------------------------</span>
2825 <a name="_sub63" href="#_subfunctions" class="code">function SaveTecplotFile_Callback(hObject, eventdata, handles)</a>
2826 
2827 <span class="comment">% Get the Application data:</span>
2828 <span class="comment">% -------------------------</span>
2829 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2830 <span class="comment">% z   = guiparams.z;</span>
2831 <span class="comment">% A   = guiparams.A;</span>
2832 V   = guiparams.V;
2833 <span class="comment">% Map = guiparams.Map;</span>
2834 
2835 [the_file,the_path] = <span class="keyword">...</span>
2836     uiputfile({<span class="string">'*.dat'</span>,<span class="string">'Tecplot Files (*.dat)'</span>}, <span class="keyword">...</span>
2837     <span class="string">'Save Tecplot File'</span>, <span class="keyword">...</span>
2838     fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2839 
2840 <span class="comment">% Output the data (no smoothing) to Tecplot:</span>
2841 <span class="comment">% ------------------------------------------</span>
2842 <span class="keyword">if</span> ischar(the_file)
2843     guiparams.tecplot_path = the_path;
2844     guiparams.tecplot_file = the_file;
2845     
2846     <span class="comment">% Re-store the Application data:</span>
2847     <span class="comment">% ------------------------------</span>
2848     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2849     
2850     <span class="comment">% Update the preferences:</span>
2851     <span class="comment">% -----------------------</span>
2852     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2853     guiprefs.tecplot_path = the_path;
2854     guiprefs.tecplot_file = the_file;
2855     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2856     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'tecplot'</span>)
2857     
2858     <span class="comment">% Push to log window</span>
2859     <span class="comment">% ------------------</span>
2860     log_text = {<span class="keyword">...</span>
2861         <span class="string">'Exporting Data to Tecplot (*.dat) File...'</span>;<span class="keyword">...</span>
2862         <span class="string">'Directory:'</span>;<span class="keyword">...</span>
2863         the_path;<span class="keyword">...</span>
2864         [<span class="string">'Filename: '</span> the_file]};
2865     statusLogging(handles.LogWindow,log_text)
2866         
2867     <span class="keyword">if</span> isempty(V)
2868         A = guiparams.A;
2869         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2870         A(1).vgns = guiparams.vertical_grid_node_spacing;
2871         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2872         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2873     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2874     <span class="keyword">end</span>
2875     <a href="VMT_BuildTecplotFile.html" class="code" title="function VMT_BuildTecplotFile(V,savefile)">VMT_BuildTecplotFile</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2876     
2877     <span class="comment">% Push to log window</span>
2878     <span class="comment">% ------------------</span>
2879     log_text = {<span class="string">'Exporting XS Bathy Data to Tecplot (*.dat) File...'</span>};
2880     statusLogging(handles.LogWindow,log_text)
2881     
2882     <a href="VMT_BuildTecplotFile_XSBathy.html" class="code" title="function VMT_BuildTecplot_XSBathy(V,savefile)">VMT_BuildTecplotFile_XSBathy</a>(V,fullfile(guiparams.tecplot_path,guiparams.tecplot_file));
2883     
2884     <span class="comment">% Push to log window</span>
2885     <span class="comment">% ------------------</span>
2886     log_text = {<span class="string">'Tecplot Export Complete'</span>};
2887     statusLogging(handles.LogWindow,log_text)
2888    
2889 <span class="keyword">end</span>
2890 
2891 <span class="comment">% [EOF] SaveTechplotFile_Callback</span>
2892 
2893 
2894 <span class="comment">% --------------------------------------------------------------------</span>
2895 <a name="_sub64" href="#_subfunctions" class="code">function SaveGoogleEarthFile_Callback(hObject, eventdata, handles)</a>
2896 
2897 <span class="comment">% Get the Application data:</span>
2898 <span class="comment">% -------------------------</span>
2899 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2900 <span class="comment">% z   = guiparams.z;</span>
2901 A   = guiparams.A;
2902 V   = guiparams.V;
2903 Map = guiparams.Map; <span class="comment">%#ok&lt;NASGU&gt;</span>
2904 
2905 [the_file,the_path] = <span class="keyword">...</span>
2906     uiputfile({<span class="string">'*.kmz'</span>,<span class="string">'Google Earth Files (*.kmz)'</span>}, <span class="keyword">...</span>
2907     <span class="string">'Save Google Earth File'</span>, <span class="keyword">...</span>
2908     fullfile(guiparams.kmz_path,guiparams.kmz_file));
2909 
2910 <span class="comment">% Save the processed data to a Google Earth (KMZ) file:</span>
2911 <span class="comment">% -----------------------------------------------------</span>
2912 <span class="keyword">if</span> ischar(the_file)
2913     guiparams.kmz_path = the_path;
2914     guiparams.kmz_file = the_file;
2915     
2916     <span class="comment">% Re-store the Application data:</span>
2917     <span class="comment">% ------------------------------</span>
2918     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2919     
2920     <span class="comment">% Update the preferences:</span>
2921     <span class="comment">% -----------------------</span>
2922     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2923     guiprefs.kmz_path = the_path;
2924     guiprefs.kmz_file = the_file;
2925     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2926     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'kmz'</span>)
2927     
2928     <span class="comment">%     if guiparams.display_shoreline</span>
2929     <span class="comment">%         VMT_Shoreline2GE_3D(A,Map, ...</span>
2930     <span class="comment">%                             guiparams.vertical_exaggeration, ...</span>
2931     <span class="comment">%                             guiparams.vertical_offset);</span>
2932     <span class="comment">%     end</span>
2933     <span class="keyword">if</span> isempty(V)
2934         A = guiparams.A;
2935         A(1).hgns = guiparams.horizontal_grid_node_spacing;
2936         A(1).vgns = guiparams.vertical_grid_node_spacing;
2937         A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
2938         [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
2939     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
2940     <span class="keyword">end</span>
2941     <a href="VMT_MeanXS2GE_3D.html" class="code" title="function VMT_MeanXS2GE_3D(A,V,pathstr,filestr,vscale,voffset)">VMT_MeanXS2GE_3D</a>(A,V,[], <span class="keyword">...</span>
2942         fullfile(guiparams.kmz_path,guiparams.kmz_file), <span class="keyword">...</span>
2943         guiparams.vertical_exaggeration, <span class="keyword">...</span>
2944         guiparams.KMZ_vertical_offset);
2945 <span class="keyword">end</span>
2946 
2947 <span class="comment">% [EOF] SaveGoogleEarthFile_Callback</span>
2948 
2949 
2950 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2951 <span class="comment">% DATA EXPORT/BATHYMETRY CALLBACKS %</span>
2952 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
2953 
2954 <span class="comment">% --------------------------------------------------------------------</span>
2955 <a name="_sub65" href="#_subfunctions" class="code">function ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)</a>
2956 
2957 <span class="comment">% Get the Application data:</span>
2958 <span class="comment">% -------------------------</span>
2959 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
2960 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2961 z = guiparams.z;
2962 A = guiparams.A;
2963 V = guiparams.V; <span class="comment">%#ok&lt;NASGU&gt;</span>
2964 <span class="comment">% Map = guiparams.Map;</span>
2965 setends = guiparams.set_cross_section_endpoints;
2966 
2967 [the_file,the_path] = <span class="keyword">...</span>
2968     uiputfile({<span class="string">'*.csv'</span>,<span class="string">'Multibeam Bathymetry Files (*.csv)'</span>}, <span class="keyword">...</span>
2969     <span class="string">'Export Multibeam Bathymetry'</span>, <span class="keyword">...</span>
2970     fullfile(guiprefs.multibeambathymetry_path, <span class="keyword">...</span>
2971     guiprefs.multibeambathymetry_file));
2972 
2973 <span class="keyword">if</span> ischar(the_file)
2974     guiparams.multibeambathymetry_path = the_path;
2975     guiparams.multibeambathymetry_file = the_file;
2976     
2977     <span class="comment">% Re-store the Application data:</span>
2978     <span class="comment">% ------------------------------</span>
2979     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
2980     
2981     <span class="comment">% Update the preferences:</span>
2982     <span class="comment">% -----------------------</span>
2983     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
2984     guiprefs.multibeambathymetry_path = the_path;
2985     guiprefs.multibeambathymetry_file = the_file;
2986     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
2987     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'multibeambathymetry'</span>)
2988     
2989     <span class="keyword">if</span> guiparams.output_auxiliary_data
2990     <span class="keyword">end</span>
2991     
2992     <span class="comment">%msgbox('Processing Bathymetry...Please Be Patient','VMT Status','help','replace')</span>
2993     
2994     savefile = fullfile(guiparams.multibeambathymetry_path, <span class="keyword">...</span>
2995         guiparams.multibeambathymetry_file);
2996     
2997     log_text = {<span class="string">'Multibeam bathymetry file saved to:'</span>;<span class="keyword">...</span>
2998         [<span class="string">'   '</span> savefile]};
2999     statusLogging(handles.LogWindow,log_text)
3000     
3001     <span class="comment">% Process the transects:</span>
3002     <span class="comment">% ----------------------</span>
3003     A(1).hgns = guiparams.horizontal_grid_node_spacing;
3004     A(1).vgns = guiparams.vertical_grid_node_spacing;
3005     A(1).wse  = guiparams.water_surface_elevation;  <span class="comment">%Set the WSE to entered value</span>
3006     [A,V,processing_log_text] = <a href="VMT_ProcessTransects.html" class="code" title="function [A,V,log_text] = VMT_ProcessTransects(z,A,setends,unitQcorrection,eta,start_bank)">VMT_ProcessTransects</a>(z,A,<span class="keyword">...</span>
3007     guiparams.set_cross_section_endpoints,guiparams.unit_discharge_correction,guiparams.bed_elevation,guiparams.start_bank);
3008     
3009     <span class="comment">% Compute the smoothed variables</span>
3010     <span class="comment">% ------------------------------</span>
3011     <span class="comment">% This is required so that the V struc is complete at any point during</span>
3012     <span class="comment">% runtime.</span>
3013     V = <a href="VMT_SmoothVar.html" class="code" title="function [V] = VMT_SmoothVar(V,hwin,vwin)">VMT_SmoothVar</a>(V, <span class="keyword">...</span>
3014         <span class="keyword">...</span><span class="comment">guiparams.contour, ...</span>
3015         guiparams.horizontal_smoothing_window, <span class="keyword">...</span>
3016         guiparams.vertical_smoothing_window);
3017     [V] = <a href="VMT_Vorticity.html" class="code" title="function [V] = VMT_Vorticity(V)">VMT_Vorticity</a>(V);
3018     <span class="comment">% Push messages to Log Window:</span>
3019     <span class="comment">% ----------------------------</span>
3020     statusLogging(handles.LogWindow, processing_log_text)
3021 
3022     
3023     <a href="VMT_MBBathy.html" class="code" title="function [A] = VMT_MBBathy(z,A,savefile,beamAng,magVar,wseval,saveaux)">VMT_MBBathy</a>(guiparams.z, <span class="keyword">...</span>
3024         guiparams.A, <span class="keyword">...</span>
3025         savefile, <span class="keyword">...</span>
3026         guiparams.beam_angle, <span class="keyword">...</span>
3027         guiparams.magnetic_variation, <span class="keyword">...</span>
3028         guiparams.water_surface_elevation, <span class="keyword">...</span>
3029         guiparams.output_auxiliary_data);
3030     
3031     <span class="comment">%msgbox('Bathymetry Output Complete','VMT Status','help','replace')</span>
3032     
3033 <span class="keyword">end</span>
3034 
3035 <span class="comment">% [EOF] ExportMultibeamBathymetry_Callback</span>
3036 
3037 
3038 <span class="comment">% --------------------------------------------------------------------</span>
3039 <a name="_sub66" href="#_subfunctions" class="code">function BeamAngle_Callback(hObject, eventdata, handles)</a>
3040 <span class="comment">% Get the beam angle</span>
3041 
3042 <span class="comment">% Get the Application data:</span>
3043 <span class="comment">% -------------------------</span>
3044 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3045 
3046 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3047 <span class="comment">% ----------------------------------------------------------------</span>
3048 new_beam_angle = str2double(get(hObject,<span class="string">'String'</span>));
3049 is_a_number = ~isnan(new_beam_angle);
3050 is_positive = new_beam_angle&gt;=0;
3051 
3052 <span class="comment">% Modify the Application data:</span>
3053 <span class="comment">% ----------------------------</span>
3054 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3055     guiparams.beam_angle = new_beam_angle;
3056     
3057     <span class="comment">% Re-store the Application data:</span>
3058     <span class="comment">% ------------------------------</span>
3059     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3060     
3061 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3062     set(hObject,<span class="string">'String'</span>,guiparams.beam_angle)
3063 <span class="keyword">end</span>
3064 
3065 <span class="comment">% [EOF] BeamAngle_Callback</span>
3066 
3067 
3068 <span class="comment">% --------------------------------------------------------------------</span>
3069 <a name="_sub67" href="#_subfunctions" class="code">function MagneticVariation_Callback(hObject, eventdata, handles)</a>
3070 <span class="comment">% Get the Magnetic Variation</span>
3071 
3072 <span class="comment">% Get the Application data:</span>
3073 <span class="comment">% -------------------------</span>
3074 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3075 
3076 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3077 <span class="comment">% ----------------------------------------------------------------</span>
3078 new_magnetic_variation = str2double(get(hObject,<span class="string">'String'</span>));
3079 is_a_number = ~isnan(new_magnetic_variation);
3080 is_positive = new_magnetic_variation&gt;=0;
3081 
3082 <span class="comment">% Modify the Application data:</span>
3083 <span class="comment">% ----------------------------</span>
3084 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3085     guiparams.magnetic_variation = new_magnetic_variation;
3086     
3087     <span class="comment">% Re-store the Application data:</span>
3088     <span class="comment">% ------------------------------</span>
3089     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3090     
3091 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3092     set(hObject,<span class="string">'String'</span>,guiparams.magnetic_variation)
3093 <span class="keyword">end</span>
3094 
3095 <span class="comment">% [EOF] MagneticVariation_Callback</span>
3096 
3097 
3098 <span class="comment">% % --------------------------------------------------------------------</span>
3099 <span class="comment">% function WSE_Callback(hObject, eventdata, handles)</span>
3100 <span class="comment">%</span>
3101 <span class="comment">% % Get the Application data:</span>
3102 <span class="comment">% % -------------------------</span>
3103 <span class="comment">% guiparams = getappdata(handles.figure1,'guiparams');</span>
3104 <span class="comment">%</span>
3105 <span class="comment">% % Get the new entry and make sure it is valid (numeric, positive):</span>
3106 <span class="comment">% % ----------------------------------------------------------------</span>
3107 <span class="comment">% new_wse = str2double(get(hObject,'String'));</span>
3108 <span class="comment">% is_a_number = ~isnan(new_wse);</span>
3109 <span class="comment">% is_positive = new_wse&gt;=0;</span>
3110 <span class="comment">%</span>
3111 <span class="comment">% % Modify the Application data:</span>
3112 <span class="comment">% % ----------------------------</span>
3113 <span class="comment">% if is_a_number &amp;&amp; is_positive</span>
3114 <span class="comment">%     guiparams.wse = new_wse;</span>
3115 <span class="comment">%</span>
3116 <span class="comment">%     % Re-store the Application data:</span>
3117 <span class="comment">%     % ------------------------------</span>
3118 <span class="comment">%     setappdata(handles.figure1,'guiparams',guiparams)</span>
3119 <span class="comment">%</span>
3120 <span class="comment">% else % Reject the (incorrect) input</span>
3121 <span class="comment">%     set(hObject,'String',guiparams.wse)</span>
3122 <span class="comment">% end</span>
3123 <span class="comment">%</span>
3124 <span class="comment">% % [EOF] WSE_Callback</span>
3125 
3126 
3127 <span class="comment">% --------------------------------------------------------------------</span>
3128 <a name="_sub68" href="#_subfunctions" class="code">function OutputAuxiliaryData_Callback(hObject, eventdata, handles)</a>
3129 <span class="comment">% Bathymetry Auxiliary Data</span>
3130 
3131 <span class="comment">% Get the Application data:</span>
3132 <span class="comment">% -------------------------</span>
3133 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3134 
3135 <span class="comment">% Modify the Application data:</span>
3136 <span class="comment">% ----------------------------</span>
3137 guiparams.output_auxiliary_data = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3138 
3139 <span class="comment">% Re-store the Application data:</span>
3140 <span class="comment">% ------------------------------</span>
3141 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3142 
3143 <span class="comment">% [EOF] OutputAuxiliaryData_Callback</span>
3144 
3145 
3146 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3147 <span class="comment">% PLOTTING/PLAN VIEW PLOT CALLBACKS %</span>
3148 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3149 
3150 <span class="comment">% --------------------------------------------------------------------</span>
3151 <a name="_sub69" href="#_subfunctions" class="code">function DepthRangeMin_Callback(hObject, eventdata, handles)</a>
3152 
3153 <span class="comment">% Get the Application data:</span>
3154 <span class="comment">% -------------------------</span>
3155 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3156 
3157 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3158 <span class="comment">% ----------------------------------------------------------------</span>
3159 new_depth_range_min = str2double(get(hObject,<span class="string">'String'</span>));
3160 is_a_number = ~isnan(new_depth_range_min);
3161 is_positive = new_depth_range_min&gt;=0;
3162 
3163 <span class="comment">% Modify the Application data:</span>
3164 <span class="comment">% ----------------------------</span>
3165 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3166     guiparams.depth_range_min = new_depth_range_min;
3167     
3168     <span class="comment">% Re-store the Application data:</span>
3169     <span class="comment">% ------------------------------</span>
3170     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3171     
3172 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3173     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_min)
3174 <span class="keyword">end</span>
3175 
3176 <span class="comment">% [EOF] DepthRangeMin_Callback</span>
3177 
3178 
3179 <span class="comment">% --------------------------------------------------------------------</span>
3180 <a name="_sub70" href="#_subfunctions" class="code">function DepthRangeMax_Callback(hObject, eventdata, handles)</a>
3181 
3182 <span class="comment">% Get the Application data:</span>
3183 <span class="comment">% -------------------------</span>
3184 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3185 
3186 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3187 <span class="comment">% ----------------------------------------------------------------</span>
3188 new_depth_range_max = str2double(get(hObject,<span class="string">'String'</span>));
3189 is_a_number = ~isnan(new_depth_range_max);
3190 is_positive = new_depth_range_max&gt;=0;
3191 
3192 <span class="comment">% Modify the Application data:</span>
3193 <span class="comment">% ----------------------------</span>
3194 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3195     guiparams.depth_range_max = new_depth_range_max;
3196     
3197     <span class="comment">% Re-store the Application data:</span>
3198     <span class="comment">% ------------------------------</span>
3199     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3200     
3201 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3202     set(hObject,<span class="string">'String'</span>,guiparams.depth_range_max)
3203 <span class="keyword">end</span>
3204 
3205 <span class="comment">% [EOF] DepthMax_Callback</span>
3206 
3207 
3208 <span class="comment">% --------------------------------------------------------------------</span>
3209 <a name="_sub71" href="#_subfunctions" class="code">function VectorScalePlanView_Callback(hObject, eventdata, handles)</a>
3210 <span class="comment">% Set quiver scale (contour)</span>
3211 
3212 <span class="comment">% Get the Application data:</span>
3213 <span class="comment">% -------------------------</span>
3214 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3215 
3216 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3217 <span class="comment">% ----------------------------------------------------------------</span>
3218 new_vector_scale_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3219 is_a_number = ~isnan(new_vector_scale_plan_view);
3220 is_positive = new_vector_scale_plan_view&gt;=0;
3221 
3222 <span class="comment">% Modify the Application data:</span>
3223 <span class="comment">% ----------------------------</span>
3224 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3225     guiparams.vector_scale_plan_view = (new_vector_scale_plan_view);
3226     
3227     <span class="comment">% Re-store the Application data:</span>
3228     <span class="comment">% ------------------------------</span>
3229     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3230     
3231 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3232     set(hObject,<span class="string">'String'</span>,guiparams.vector_scale_plan_view)
3233 <span class="keyword">end</span>
3234 
3235 <span class="comment">% [EOF] VectorScalePlanView_Callback</span>
3236 
3237 
3238 <span class="comment">% --------------------------------------------------------------------</span>
3239 <a name="_sub72" href="#_subfunctions" class="code">function VectorSpacingPlanview_Callback(hObject, eventdata, handles)</a>
3240 <span class="comment">% Set quiver spacing (contour, horizontal)</span>
3241 
3242 <span class="comment">% Get the Application data:</span>
3243 <span class="comment">% -------------------------</span>
3244 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3245 
3246 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3247 <span class="comment">% ----------------------------------------------------------------</span>
3248 new_vector_spacing_plan_view = str2double(get(hObject,<span class="string">'String'</span>));
3249 is_a_number = ~isnan(new_vector_spacing_plan_view);
3250 is_positive = new_vector_spacing_plan_view&gt;=0;
3251 
3252 <span class="comment">% Modify the Application data:</span>
3253 <span class="comment">% ----------------------------</span>
3254 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3255     guiparams.vector_spacing_plan_view = round(new_vector_spacing_plan_view);
3256     
3257     <span class="comment">% Re-store the Application data:</span>
3258     <span class="comment">% ------------------------------</span>
3259     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3260     
3261 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3262     set(hObject,<span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
3263 <span class="keyword">end</span>
3264 
3265 <span class="comment">% [EOF] VectorSpacingPlanview_Callback</span>
3266 
3267 
3268 <span class="comment">% --------------------------------------------------------------------</span>
3269 <a name="_sub73" href="#_subfunctions" class="code">function SmoothingWindowSize_Callback(hObject, eventdata, handles)</a>
3270 <span class="comment">% Plan View smoothing window size</span>
3271 
3272 <span class="comment">% Get the Application data:</span>
3273 <span class="comment">% -------------------------</span>
3274 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3275 
3276 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3277 <span class="comment">% ----------------------------------------------------------------</span>
3278 new_smoothing_window_size = str2double(get(hObject,<span class="string">'String'</span>));
3279 is_a_number = ~isnan(new_smoothing_window_size);
3280 is_positive = new_smoothing_window_size&gt;=0;
3281 
3282 <span class="comment">% Modify the Application data:</span>
3283 <span class="comment">% ----------------------------</span>
3284 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3285     guiparams.smoothing_window_size = round(new_smoothing_window_size);
3286     
3287     <span class="comment">% Re-store the Application data:</span>
3288     <span class="comment">% ------------------------------</span>
3289     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3290     
3291 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3292     set(hObject,<span class="string">'String'</span>,guiparams.smoothing_window_size)
3293 <span class="keyword">end</span>
3294 
3295 <span class="comment">% [EOF] SmoothingWindowSize_Callback</span>
3296 
3297 
3298 <span class="comment">% --------------------------------------------------------------------</span>
3299 <a name="_sub74" href="#_subfunctions" class="code">function AddBackground_Callback(hObject, eventdata, handles)</a>
3300 
3301 <span class="comment">% Get the Application data:</span>
3302 <span class="comment">% -------------------------</span>
3303 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3304 
3305 <span class="comment">% Modify the Application data:</span>
3306 <span class="comment">% ----------------------------</span>
3307 guiparams.add_background = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3308 
3309 <span class="comment">% Re-store the Application data:</span>
3310 <span class="comment">% ------------------------------</span>
3311 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3312 
3313 <span class="comment">% [EOF] AddBackground_Callback</span>
3314 
3315 
3316 <span class="comment">% --------------------------------------------------------------------</span>
3317 <a name="_sub75" href="#_subfunctions" class="code">function PlotPlanView_Callback(hObject, eventdata, handles)</a>
3318 <a href="#_sub60" class="code" title="subfunction planviewPlotCallback(hObject, eventdata, handles)">planviewPlotCallback</a>(hObject, eventdata, handles)
3319 <span class="comment">% [EOF] PlotPlanView_Callback</span>
3320 
3321 
3322 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3323 <span class="comment">% PLOTTING/SHIP TRACKS PLOT CALLBACKS %</span>
3324 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3325 
3326 <span class="comment">% --------------------------------------------------------------------</span>
3327 <a name="_sub76" href="#_subfunctions" class="code">function HorizontalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3328 <span class="comment">% Set the horizontal grid node spacing</span>
3329 
3330 <span class="comment">% Get the Application data:</span>
3331 <span class="comment">% -------------------------</span>
3332 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3333 
3334 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3335 <span class="comment">% ----------------------------------------------------------------</span>
3336 new_horizontal_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3337 is_a_number = ~isnan(new_horizontal_grid_node_spacing);
3338 is_positive = new_horizontal_grid_node_spacing&gt;=0;
3339 
3340 <span class="comment">% Modify the Application data:</span>
3341 <span class="comment">% ----------------------------</span>
3342 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3343     guiparams.horizontal_grid_node_spacing = new_horizontal_grid_node_spacing;
3344     
3345     <span class="comment">% Re-store the Application data:</span>
3346     <span class="comment">% ------------------------------</span>
3347     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3348     
3349 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3350     set(hObject,<span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
3351 <span class="keyword">end</span>
3352 
3353 <span class="comment">% [EOF] HorizontalGridNodeSpacing_Callback</span>
3354 
3355 <span class="comment">% --------------------------------------------------------------------</span>
3356 <a name="_sub77" href="#_subfunctions" class="code">function VerticalGridNodeSpacing_Callback(hObject, eventdata, handles)</a>
3357 <span class="comment">% Set the horizontal grid node spacing</span>
3358 
3359 <span class="comment">% Get the Application data:</span>
3360 <span class="comment">% -------------------------</span>
3361 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3362 
3363 <span class="comment">% Get the new entry and make sure it is valid (numeric, positive):</span>
3364 <span class="comment">% ----------------------------------------------------------------</span>
3365 new_vertical_grid_node_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3366 is_a_number = ~isnan(new_vertical_grid_node_spacing);
3367 is_positive = new_vertical_grid_node_spacing&gt;=0;
3368 
3369 <span class="comment">% Modify the Application data:</span>
3370 <span class="comment">% ----------------------------</span>
3371 <span class="keyword">if</span> is_a_number &amp;&amp; is_positive
3372     guiparams.vertical_grid_node_spacing = new_vertical_grid_node_spacing;
3373     
3374     <span class="comment">% Re-store the Application data:</span>
3375     <span class="comment">% ------------------------------</span>
3376     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3377     
3378 <span class="keyword">else</span> <span class="comment">% Reject the (incorrect) input</span>
3379     set(hObject,<span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
3380 <span class="keyword">end</span>
3381 
3382 <span class="comment">% [EOF] VerticalGridNodeSpacing_Callback</span>
3383 
3384 <span class="comment">% --------------------------------------------------------------------</span>
3385 <a name="_sub78" href="#_subfunctions" class="code">function SetCrossSectionEndpoints_Callback(hObject, eventdata, handles)</a>
3386 <span class="comment">% Set the cross section endpoints manually</span>
3387 
3388 <span class="comment">% Get the Application data:</span>
3389 <span class="comment">% -------------------------</span>
3390 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3391 
3392 <span class="comment">% Modify the Application data:</span>
3393 <span class="comment">% ----------------------------</span>
3394 guiparams.set_cross_section_endpoints = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3395 
3396 <span class="comment">% Re-store the Application data:</span>
3397 <span class="comment">% ------------------------------</span>
3398 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3399 
3400 <span class="comment">% [EOF] SetCrossSectionEndpoints_Callback</span>
3401 
3402 
3403 <span class="comment">% --------------------------------------------------------------------</span>
3404 <a name="_sub79" href="#_subfunctions" class="code">function PlotShiptracks_Callback(hObject, eventdata, handles)</a>
3405 <a href="#_sub59" class="code" title="subfunction shiptracksPlotCallback(hObject, eventdata, handles)">shiptracksPlotCallback</a>(hObject, eventdata, handles)
3406 <span class="comment">% [EOF] PlotShiptracks_Callback</span>
3407 
3408 
3409 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3410 <span class="comment">% PLOTTING/CROSS SECTION PLOT CALLBACKS %</span>
3411 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
3412 
3413 <span class="comment">% --------------------------------------------------------------------</span>
3414 <a name="_sub80" href="#_subfunctions" class="code">function Contour_Callback(hObject, eventdata, handles)</a>
3415 
3416 <span class="comment">% Get the Application data:</span>
3417 <span class="comment">% -------------------------</span>
3418 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3419 
3420 <span class="comment">% Modify the Application data:</span>
3421 <span class="comment">% ----------------------------</span>
3422 idx_variable = get(hObject,<span class="string">'Value'</span>);
3423 guiparams.idx_contour = idx_variable;
3424 guiparams.contour = guiparams.contours(idx_variable).variable;
3425 
3426 <span class="comment">% Re-store the Application data:</span>
3427 <span class="comment">% ------------------------------</span>
3428 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3429 
3430 <span class="comment">% [EOF] Contour_Callback</span>
3431 
3432 
3433 <span class="comment">% --------------------------------------------------------------------</span>
3434 <a name="_sub81" href="#_subfunctions" class="code">function VerticalExaggeration_Callback(hObject, eventdata, handles)</a>
3435 <span class="comment">% Set vertical exaggeration</span>
3436 
3437 <span class="comment">% Get the Application data:</span>
3438 <span class="comment">% -------------------------</span>
3439 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3440 
3441 <span class="comment">% Modify the Application data:</span>
3442 <span class="comment">% ----------------------------</span>
3443 guiparams.vertical_exaggeration = str2double(get(hObject,<span class="string">'String'</span>));
3444 
3445 <span class="comment">% Re-store the Application data:</span>
3446 <span class="comment">% ------------------------------</span>
3447 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3448 
3449 <span class="comment">% Update the GUI:</span>
3450 <span class="comment">% ---------------</span>
3451 <span class="comment">% updateGUI(handles,guiparams)</span>
3452 
3453 <span class="comment">% [EOF] VerticalExaggeration_Callback</span>
3454 
3455 
3456 <span class="comment">% --------------------------------------------------------------------</span>
3457 <a name="_sub82" href="#_subfunctions" class="code">function VectorScaleCrossSection_Callback(hObject, eventdata, handles)</a>
3458 
3459 <span class="comment">% Get the Application data:</span>
3460 <span class="comment">% -------------------------</span>
3461 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3462 
3463 <span class="comment">% Modify the Application data:</span>
3464 <span class="comment">% ----------------------------</span>
3465 guiparams.vector_scale_cross_section = str2double(get(hObject,<span class="string">'String'</span>));
3466 
3467 <span class="comment">% Re-store the Application data:</span>
3468 <span class="comment">% ------------------------------</span>
3469 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3470 
3471 <span class="comment">% Update the GUI:</span>
3472 <span class="comment">% ---------------</span>
3473 <span class="comment">% updateGUI(handles,guiparams)</span>
3474 
3475 <span class="comment">% [EOF] VectorScaleCrossSection_Callback</span>
3476 
3477 
3478 <span class="comment">% --------------------------------------------------------------------</span>
3479 <a name="_sub83" href="#_subfunctions" class="code">function HorizontalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3480 
3481 <span class="comment">% Get the Application data:</span>
3482 <span class="comment">% -------------------------</span>
3483 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3484 
3485 <span class="comment">% Modify the Application data:</span>
3486 <span class="comment">% ----------------------------</span>
3487 guiparams.horizontal_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3488 
3489 <span class="comment">% Re-store the Application data:</span>
3490 <span class="comment">% ------------------------------</span>
3491 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3492 
3493 <span class="comment">% Update the GUI:</span>
3494 <span class="comment">% ---------------</span>
3495 <span class="comment">% updateGUI(handles,guiparams)</span>
3496 
3497 <span class="comment">% [EOF] HorizontalVectorSpacing_Callback</span>
3498 
3499 
3500 <span class="comment">% --------------------------------------------------------------------</span>
3501 <a name="_sub84" href="#_subfunctions" class="code">function VerticalVectorSpacing_Callback(hObject, eventdata, handles)</a>
3502 <span class="comment">% Get the vertical quiver spacing for contour plots</span>
3503 
3504 <span class="comment">% Get the Application data:</span>
3505 <span class="comment">% -------------------------</span>
3506 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3507 
3508 <span class="comment">% Modify the Application data:</span>
3509 <span class="comment">% ----------------------------</span>
3510 guiparams.vertical_vector_spacing = str2double(get(hObject,<span class="string">'String'</span>));
3511 
3512 <span class="comment">% Re-store the Application data:</span>
3513 <span class="comment">% ------------------------------</span>
3514 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3515 
3516 <span class="comment">% Update the GUI:</span>
3517 <span class="comment">% ---------------</span>
3518 <span class="comment">% updateGUI(handles,guiparams)</span>
3519 
3520 <span class="comment">% [EOF] VerticalVectorSpacing_Callback</span>
3521 
3522 
3523 <span class="comment">% --------------------------------------------------------------------</span>
3524 <a name="_sub85" href="#_subfunctions" class="code">function HorizontalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3525 <span class="comment">% Horizontal Smoothing</span>
3526 
3527 <span class="comment">% Get the Application data:</span>
3528 <span class="comment">% -------------------------</span>
3529 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3530 
3531 <span class="comment">% Modify the Application data:</span>
3532 <span class="comment">% ----------------------------</span>
3533 guiparams.horizontal_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3534 
3535 <span class="comment">% Re-store the Application data:</span>
3536 <span class="comment">% ------------------------------</span>
3537 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3538 
3539 <span class="comment">% Update the GUI:</span>
3540 <span class="comment">% ---------------</span>
3541 <span class="comment">% updateGUI(handles,guiparams)</span>
3542 
3543 <span class="comment">% [EOF] HorizontalSmoothingWindow_Callback</span>
3544 
3545 
3546 <span class="comment">% --------------------------------------------------------------------</span>
3547 <a name="_sub86" href="#_subfunctions" class="code">function VerticalSmoothingWindow_Callback(hObject, eventdata, handles)</a>
3548 <span class="comment">% Vertical Smoothing</span>
3549 
3550 <span class="comment">% Get the Application data:</span>
3551 <span class="comment">% -------------------------</span>
3552 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3553 
3554 <span class="comment">% Modify the Application data:</span>
3555 <span class="comment">% ----------------------------</span>
3556 guiparams.vertical_smoothing_window = str2double(get(hObject,<span class="string">'String'</span>));
3557 
3558 <span class="comment">% Re-store the Application data:</span>
3559 <span class="comment">% ------------------------------</span>
3560 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3561 
3562 <span class="comment">% Update the GUI:</span>
3563 <span class="comment">% ---------------</span>
3564 <span class="comment">% updateGUI(handles,guiparams)</span>
3565 
3566 <span class="comment">% [EOF] VerticalSmoothingWindow_Callback</span>
3567 
3568 
3569 <span class="comment">% --------------------------------------------------------------------</span>
3570 <a name="_sub87" href="#_subfunctions" class="code">function PlotSecondaryFlowVectors_Callback(hObject, eventdata, handles)</a>
3571 
3572 <span class="comment">% Get the Application data:</span>
3573 <span class="comment">% -------------------------</span>
3574 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3575 
3576 <span class="comment">% Modify the Application data:</span>
3577 <span class="comment">% ----------------------------</span>
3578 guiparams.plot_secondary_flow_vectors = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3579 
3580 <span class="comment">% Re-store the Application data:</span>
3581 <span class="comment">% ------------------------------</span>
3582 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3583 
3584 <span class="comment">% [EOF] PlotSecondaryFlowVectors_Callback</span>
3585 
3586 
3587 <span class="comment">% --------------------------------------------------------------------</span>
3588 <a name="_sub88" href="#_subfunctions" class="code">function SecondaryFlowVectorVariable_Callback(hObject, eventdata, handles)</a>
3589 
3590 <span class="comment">% Get the Application data:</span>
3591 <span class="comment">% -------------------------</span>
3592 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3593 
3594 <span class="comment">% Modify the Application data:</span>
3595 <span class="comment">% ----------------------------</span>
3596 idx_variable = get(hObject,<span class="string">'Value'</span>);
3597 guiparams.idx_secondary_flow_vector_variable = idx_variable;
3598 guiparams.secondary_flow_vector_variable = guiparams.secondary_flows(idx_variable).variable;
3599 
3600 <span class="comment">% Re-store the Application data:</span>
3601 <span class="comment">% ------------------------------</span>
3602 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3603 
3604 <span class="comment">% [EOF] SecondaryFlowVectorVariable_Callback</span>
3605 
3606 
3607 <span class="comment">% --------------------------------------------------------------------</span>
3608 <a name="_sub89" href="#_subfunctions" class="code">function IncludeVerticalVelocity_Callback(hObject, eventdata, handles)</a>
3609 
3610 <span class="comment">% Get the Application data:</span>
3611 <span class="comment">% -------------------------</span>
3612 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3613 
3614 <span class="comment">% Modify the Application data:</span>
3615 <span class="comment">% ----------------------------</span>
3616 guiparams.include_vertical_velocity = logical(get(hObject,<span class="string">'Value'</span>)); <span class="comment">% boolean</span>
3617 
3618 <span class="comment">% Re-store the Application data:</span>
3619 <span class="comment">% ------------------------------</span>
3620 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3621 
3622 <span class="comment">% [EOF] IncludeVerticalVelocity_Callback</span>
3623 
3624 
3625 <span class="comment">% --------------------------------------------------------------------</span>
3626 <a name="_sub90" href="#_subfunctions" class="code">function PlotCrossSection_Callback(hObject, eventdata, handles)</a>
3627 <a href="#_sub61" class="code" title="subfunction crosssectionPlotCallback(hObject, eventdata, handles)">crosssectionPlotCallback</a>(hObject, eventdata, handles)
3628 <span class="comment">% [EOF] PlotCrossSection_Callback</span>
3629 
3630 
3631 <span class="comment">% --------------------------------------------------------------------</span>
3632 <a name="_sub91" href="#_subfunctions" class="code">function ClearLog_Callback(hObject, eventdata, handles)</a>
3633 set(handles.LogWindow,<span class="string">'string'</span>,<span class="string">''</span>)
3634 <span class="comment">% [EOF] ClearLog_Callback</span>
3635 
3636 <span class="comment">% --------------------------------------------------------------------</span>
3637 <a name="_sub92" href="#_subfunctions" class="code">function SaveLog_Callback(hObject, eventdata, handles)</a>
3638 
3639 <span class="comment">% Get the Application data:</span>
3640 <span class="comment">% -------------------------</span>
3641 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
3642 guiprefs  = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3643 <span class="comment">% z   = guiparams.z;   %#ok&lt;NASGU&gt;</span>
3644 <span class="comment">% A   = guiparams.A;   %#ok&lt;NASGU&gt;</span>
3645 <span class="comment">% V   = guiparams.V;   %#ok&lt;NASGU&gt;</span>
3646 <span class="comment">% Map = guiparams.Map; %#ok&lt;NASGU&gt;</span>
3647 
3648 [the_file,the_path] = <span class="keyword">...</span>
3649     uiputfile({<span class="string">'*.txt'</span>,<span class="string">'TXT-Files (*.txt)'</span>}, <span class="keyword">...</span>
3650     <span class="string">'Choose where to save the log file'</span>, <span class="keyword">...</span>
3651     fullfile(guiprefs.log_path,guiprefs.log_file));
3652 
3653 <span class="comment">% Save the log to a TXT file:</span>
3654 <span class="comment">% ---------------------------</span>
3655 <span class="keyword">if</span> ischar(the_file)
3656     guiparams.log_path = the_path;
3657     guiparams.log_file = the_file;
3658     <span class="comment">%guiparams.savefile = the_file;</span>
3659     
3660     <span class="comment">% Re-store the Application data:</span>
3661     <span class="comment">% ------------------------------</span>
3662     setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
3663     
3664     <span class="comment">% Update the preferences:</span>
3665     <span class="comment">% -----------------------</span>
3666     guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
3667     guiprefs.log_path = the_path;
3668     guiprefs.log_file = the_file;
3669     setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
3670     <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'log'</span>)
3671     
3672     [~,filename,extension] = fileparts(the_file);
3673     savefile = [the_path filename extension];
3674     h = msgbox([<span class="string">'Saving log to: '''</span> savefile <span class="string">''''</span>], <span class="keyword">...</span>
3675         <span class="string">'Saving Log File...'</span>); <span class="comment">%#ok&lt;NASGU&gt;</span>
3676     
3677     logfile = get(handles.LogWindow,<span class="string">'string'</span>);
3678     [nrows,~]= size(logfile);
3679     fid = fopen(savefile, <span class="string">'w'</span>);
3680     <span class="keyword">for</span> row=1:nrows
3681         fprintf(fid, <span class="string">'%s \n'</span>, logfile{row,:});
3682     <span class="keyword">end</span>
3683     fclose(fid);
3684 <span class="keyword">end</span>
3685 <span class="comment">% [EOF] SaveLog_Callback</span>
3686 
3687 <span class="comment">%%%%%%%%%%%%%%%%</span>
3688 <span class="comment">% SUBFUNCTIONS %</span>
3689 <span class="comment">%%%%%%%%%%%%%%%%</span>
3690 
3691 <span class="comment">% --------------------------------------------------------------------</span>
3692 <a name="_sub93" href="#_subfunctions" class="code">function handles = buildToolbar(handles)</a>
3693 
3694 icons = <a href="#_sub109" class="code" title="subfunction icons = getIcons">getIcons</a>;
3695 ht = uitoolbar(<span class="string">'Parent'</span>,handles.figure1);
3696 
3697 <span class="comment">% Load data</span>
3698 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_open.png');</span>
3699 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3700 <span class="comment">% icon(icon==0) = NaN;</span>
3701 handles.toolbarLoadData = <span class="keyword">...</span>
3702     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3703     <span class="string">'CData'</span>,        icons(1).data, <span class="keyword">...</span>
3704     <span class="string">'TooltipString'</span>,<span class="string">'Open ASCII File'</span>);
3705 
3706 <span class="comment">% Save data</span>
3707 <span class="comment">% icon = imread('C:\Users\pfricker\Desktop\icons\file_save.png');</span>
3708 <span class="comment">% icon = double(icon)/(2^16-1);</span>
3709 <span class="comment">% icon(icon==0) = NaN;</span>
3710 handles.toolbarSaveMatFile = <span class="keyword">...</span>
3711     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3712     <span class="string">'CData'</span>,        icons(2).data, <span class="keyword">...</span>
3713     <span class="string">'TooltipString'</span>,<span class="string">'Save MAT File'</span>, <span class="keyword">...</span>
3714     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3715 
3716 
3717 <span class="comment">% Save bathymetry</span>
3718 <span class="comment">%icon = ones(16,16,3);</span>
3719 handles.toolbarSaveBathymetry = <span class="keyword">...</span>
3720     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3721     <span class="string">'CData'</span>,        icons(5).data, <span class="keyword">...</span>
3722     <span class="string">'TooltipString'</span>,<span class="string">'Export Bathymetry'</span>);
3723 
3724 <span class="comment">% Save figures</span>
3725 <span class="comment">% icon = ones(16,16,3);</span>
3726 handles.toolbarSaveFigures = <span class="keyword">...</span>
3727     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3728     <span class="string">'CData'</span>,        icons(6).data, <span class="keyword">...</span>
3729     <span class="string">'TooltipString'</span>,<span class="string">'Export Figures'</span>);
3730 
3731 <span class="comment">% Save Excel File</span>
3732 <span class="comment">% icon = ones(16,16,3);</span>
3733 handles.toolbarSaveExcel = <span class="keyword">...</span>
3734     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3735     <span class="string">'CData'</span>,        icons(7).data, <span class="keyword">...</span>
3736     <span class="string">'TooltipString'</span>,<span class="string">'Export Excel File'</span>);
3737 
3738 
3739 <span class="comment">% Plotting parameters</span>
3740 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\PlotGeneralElement.gif');</span>
3741 <span class="comment">% icon = ind2rgb(icon,map);</span>
3742 handles.toolbarPlottingParameters = <span class="keyword">...</span>
3743     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3744     <span class="string">'CData'</span>,        icons(3).data, <span class="keyword">...</span>
3745     <span class="string">'TooltipString'</span>,<span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
3746     <span class="string">'Separator'</span>,    <span class="string">'on'</span>);
3747 
3748 <span class="comment">% Processing parameters</span>
3749 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3750 <span class="comment">% icon = ind2rgb(icon,map);</span>
3751 handles.toolbarProcessingParameters = <span class="keyword">...</span>
3752     uipushtool(<span class="string">'Parent'</span>,       ht, <span class="keyword">...</span>
3753     <span class="string">'CData'</span>,        icons(4).data, <span class="keyword">...</span>
3754     <span class="string">'TooltipString'</span>,<span class="string">'Processing Parameters'</span>);
3755 
3756 <span class="comment">% Zoom In</span>
3757 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3758 <span class="comment">% icon = ind2rgb(icon,map);</span>
3759 <span class="comment">% handles.toolbarZoomIn = ...</span>
3760 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3761 <span class="comment">%     'CData',        icons(8).data, ...</span>
3762 <span class="comment">%     'TooltipString','Zoom In (Shiptracks)', ...</span>
3763 <span class="comment">%     'Separator',     'on');</span>
3764 
3765 <span class="comment">% Zoom Out</span>
3766 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3767 <span class="comment">% icon = ind2rgb(icon,map);</span>
3768 <span class="comment">% handles.toolbarZoomOut = ...</span>
3769 <span class="comment">%     uitoggletool('Parent',       ht, ...</span>
3770 <span class="comment">%     'CData',        icons(9).data, ...</span>
3771 <span class="comment">%     'TooltipString','Zoom Out (Shiptracks)');</span>
3772 
3773 <span class="comment">% Pan</span>
3774 <span class="comment">% [icon,map] = imread('C:\Users\pfricker\Desktop\icons\ParameterIcon.gif');</span>
3775 <span class="comment">% icon = ind2rgb(icon,map);</span>
3776 <span class="comment">% handles.toolbarPan = ...</span>
3777 <span class="comment">%     uipushtool('Parent',       ht, ...</span>
3778 <span class="comment">%     'CData',        icons(10).data, ...</span>
3779 <span class="comment">%     'TooltipString','Pan (Shiptracks)');</span>
3780 
3781 
3782 
3783 set(handles.toolbarLoadData,            <span class="string">'ClickedCallback'</span>,{@<a href="#_sub54" class="code" title="subfunction loadDataCallback(hObject, eventdata, handles)">loadDataCallback</a>,handles})
3784 set(handles.toolbarSaveMatFile,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub55" class="code" title="subfunction saveDataCallback(hObject, eventdata, handles)">saveDataCallback</a>,handles})
3785 set(handles.toolbarSaveBathymetry,      <span class="string">'ClickedCallback'</span>,{@<a href="#_sub65" class="code" title="subfunction ExportMultibeamBathymetry_Callback(hObject, eventdata, handles)">ExportMultibeamBathymetry_Callback</a>,handles})
3786 set(handles.toolbarSaveFigures,         <span class="string">'ClickedCallback'</span>,{@<a href="#_sub21" class="code" title="subfunction menuExportFigures_Callback(hObject, eventdata, handles)">menuExportFigures_Callback</a>,handles})
3787 set(handles.toolbarSaveExcel,           <span class="string">'ClickedCallback'</span>,{@<a href="#_sub26" class="code" title="subfunction menuSaveExcel_Callback(hObject, eventdata, handles)">menuSaveExcel_Callback</a>,handles})
3788 set(handles.toolbarPlottingParameters,  <span class="string">'ClickedCallback'</span>,{@<a href="#_sub57" class="code" title="subfunction plottingParametersCallback(hObject, eventdata, handles)">plottingParametersCallback</a>,handles})
3789 set(handles.toolbarProcessingParameters,<span class="string">'ClickedCallback'</span>,{@<a href="#_sub58" class="code" title="subfunction processingParametersCallback(hObject, eventdata, handles)">processingParametersCallback</a>,handles})
3790 <span class="comment">% set(handles.toolbarZoomIn,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3791 <span class="comment">% set(handles.toolbarZoomOut,              'ClickedCallback',{@ShiptracksZoom_Callback,handles})</span>
3792 <span class="comment">% set(handles.toolbarPan,              'ClickedCallback',{@ShiptracksPan_Callback,handles})</span>
3793 <span class="comment">% set(handles.planviewPlot,        'ClickedCallback',{@planviewPlotCallback,handles})</span>
3794 <span class="comment">% set(handles.crosssectionPlot,    'ClickedCallback',{@crosssectionPlotCallback,handles})</span>
3795 
3796 <span class="comment">% [EOF] buildtoolbar</span>
3797 
3798 
3799 <span class="comment">% --------------------------------------------------------------------</span>
3800 <a name="_sub94" href="#_subfunctions" class="code">function load_prefs(hfigure)</a>
3801 <span class="comment">% Load the GUI preferences.  Also, initialize preferences if they don't</span>
3802 <span class="comment">% already exist.</span>
3803 
3804 <span class="comment">% Preferences:</span>
3805 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
3806 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
3807 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
3808 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
3809 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
3810 <span class="comment">% 'log'                  Path and filename of last Log file</span>
3811 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
3812 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
3813 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
3814 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
3815 <span class="comment">% 'renderer'             Default graphics renderer</span>
3816 <span class="comment">% 'units'                Default plotting units</span>
3817 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
3818 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
3819 <span class="comment">%                        started</span>
3820 <span class="comment">% 'setendpoints'         Path and filename of user set endpoints</span>
3821 
3822 <span class="comment">% Originals</span>
3823 <span class="comment">% prefs = {'ascii2gispath' 'ascii2kmlpath' 'asciipath'   'doqqpath' ...</span>
3824 <span class="comment">%          'endspath'      'logpath'       'matpath'     'savedpath' ...</span>
3825 <span class="comment">%          'shorepath'     'stapath'       'ysidatapath' 'ysidatapath'};</span>
3826 
3827 <span class="comment">% ASCII</span>
3828 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>)
3829     ascii = getpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>);
3830     <span class="keyword">if</span> exist(ascii.path,<span class="string">'dir'</span>)
3831         guiprefs.ascii_path = ascii.path;
3832     <span class="keyword">else</span>
3833         guiprefs.ascii_path = pwd;
3834     <span class="keyword">end</span>
3835     does_exist = false(1,length(ascii.file));
3836     <span class="keyword">for</span> k = 1:length(ascii.file) <span class="comment">% Check each file one-by-one</span>
3837         does_exist(k) = exist(fullfile(ascii.path,ascii.file{k}),<span class="string">'file'</span>);
3838     <span class="keyword">end</span>
3839     <span class="keyword">if</span> any(does_exist)
3840         guiprefs.ascii_file = ascii.file(does_exist);
3841     <span class="keyword">else</span>
3842         guiprefs.ascii_file = {<span class="string">''</span>};
3843     <span class="keyword">end</span>
3844 <span class="keyword">else</span> <span class="comment">% Initialize ASCII</span>
3845     guiprefs.ascii_path = pwd;
3846     guiprefs.ascii_file = {<span class="string">''</span>};
3847     
3848     ascii.path = pwd;
3849     ascii.file = {<span class="string">''</span>};
3850     setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
3851 <span class="keyword">end</span>
3852 
3853 <span class="comment">% MAT</span>
3854 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>)
3855     mat = getpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>);
3856     <span class="keyword">if</span> exist(mat.path,<span class="string">'dir'</span>)
3857         guiprefs.mat_path = mat.path;
3858     <span class="keyword">else</span>
3859         guiprefs.mat_path = pwd;
3860     <span class="keyword">end</span>
3861     
3862     <span class="keyword">if</span> iscell(mat.file)
3863         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file{1}),<span class="string">'file'</span>)
3864             guiprefs.mat_file = mat.file;
3865         <span class="keyword">else</span>
3866             guiprefs.mat_file = <span class="string">''</span>;
3867         <span class="keyword">end</span>
3868     <span class="keyword">else</span>
3869         <span class="keyword">if</span> exist(fullfile(mat.path,mat.file),<span class="string">'file'</span>)
3870             guiprefs.mat_file = mat.file;
3871         <span class="keyword">else</span>
3872             guiprefs.mat_file = <span class="string">''</span>;
3873         <span class="keyword">end</span>
3874     <span class="keyword">end</span>
3875 <span class="keyword">else</span> <span class="comment">% Initialize MAT</span>
3876     guiprefs.mat_path = pwd;
3877     guiprefs.mat_file = <span class="string">''</span>;
3878     
3879     mat.path = pwd;
3880     mat.file = <span class="string">''</span>;
3881     setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
3882 <span class="keyword">end</span>
3883 
3884 <span class="comment">% TECPLOT</span>
3885 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>)
3886     tecplot = getpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>);
3887     <span class="keyword">if</span> exist(tecplot.path,<span class="string">'dir'</span>)
3888         guiprefs.tecplot_path = tecplot.path;
3889     <span class="keyword">else</span>
3890         guiprefs.tecplot_path = pwd;
3891     <span class="keyword">end</span>
3892     <span class="keyword">if</span> exist(fullfile(tecplot.path,tecplot.file),<span class="string">'file'</span>)
3893         guiprefs.tecplot_file = tecplot.file;
3894     <span class="keyword">else</span>
3895         guiprefs.tecplot_file = <span class="string">''</span>;
3896     <span class="keyword">end</span>
3897 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
3898     guiprefs.tecplot_path = pwd;
3899     guiprefs.tecplot_file = <span class="string">''</span>;
3900     
3901     tecplot.path = pwd;
3902     tecplot.file = <span class="string">''</span>;
3903     setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
3904 <span class="keyword">end</span>
3905 
3906 <span class="comment">% KMZ</span>
3907 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>)
3908     kmz = getpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>);
3909     <span class="keyword">if</span> exist(kmz.path,<span class="string">'dir'</span>)
3910         guiprefs.kmz_path = kmz.path;
3911     <span class="keyword">else</span>
3912         guiprefs.kmz_path = pwd;
3913     <span class="keyword">end</span>
3914     <span class="keyword">if</span> exist(fullfile(kmz.path,kmz.file),<span class="string">'file'</span>)
3915         guiprefs.kmz_file = kmz.file;
3916     <span class="keyword">else</span>
3917         guiprefs.kmz_file = <span class="string">''</span>;
3918     <span class="keyword">end</span>
3919 <span class="keyword">else</span> <span class="comment">% Initialize KMZ</span>
3920     guiprefs.kmz_path = pwd;
3921     guiprefs.kmz_file = <span class="string">''</span>;
3922     
3923     kmz.path = pwd;
3924     kmz.file = <span class="string">''</span>;
3925     setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
3926 <span class="keyword">end</span>
3927 
3928 <span class="comment">% MULTIBEAM BATHYMETRY</span>
3929 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>)
3930     multibeambathymetry = getpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>);
3931     <span class="keyword">if</span> exist(multibeambathymetry.path,<span class="string">'dir'</span>)
3932         guiprefs.multibeambathymetry_path = multibeambathymetry.path;
3933     <span class="keyword">else</span>
3934         guiprefs.multibeambathymetry_path = pwd;
3935     <span class="keyword">end</span>
3936     <span class="keyword">if</span> exist(fullfile(multibeambathymetry.path,multibeambathymetry.file),<span class="string">'file'</span>)
3937         guiprefs.multibeambathymetry_file = multibeambathymetry.file;
3938     <span class="keyword">else</span>
3939         guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3940     <span class="keyword">end</span>
3941 <span class="keyword">else</span> <span class="comment">% Initialize MULTIBEAM BATHYMETRY</span>
3942     guiprefs.multibeambathymetry_path = pwd;
3943     guiprefs.multibeambathymetry_file = <span class="string">''</span>;
3944     
3945     multibeambathymetry.path = pwd;
3946     multibeambathymetry.file = <span class="string">''</span>;
3947     setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
3948 <span class="keyword">end</span>
3949 
3950 <span class="comment">% Log</span>
3951 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'log'</span>)
3952     log = getpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>);
3953     <span class="keyword">if</span> exist(log.path,<span class="string">'dir'</span>)
3954         guiprefs.log_path = log.path;
3955     <span class="keyword">else</span>
3956         guiprefs.log_path = pwd;
3957     <span class="keyword">end</span>
3958     <span class="keyword">if</span> exist(fullfile(log.path,log.file),<span class="string">'file'</span>)
3959         guiprefs.log_file = log.file;
3960     <span class="keyword">else</span>
3961         guiprefs.log_file = <span class="string">''</span>;
3962     <span class="keyword">end</span>
3963 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3964     guiprefs.log_path = pwd;
3965     guiprefs.log_file = <span class="string">''</span>;
3966     
3967     log.path = pwd;
3968     log.file = <span class="string">''</span>;
3969     setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
3970 <span class="keyword">end</span>
3971 
3972 <span class="comment">% iRic</span>
3973 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>)
3974     iric = getpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>);
3975     <span class="keyword">if</span> exist(iric.path,<span class="string">'dir'</span>)
3976         guiprefs.iric_path = iric.path;
3977     <span class="keyword">else</span>
3978         guiprefs.iric_path = pwd;
3979     <span class="keyword">end</span>
3980     <span class="keyword">if</span> exist(fullfile(iric.path,iric.file),<span class="string">'file'</span>)
3981         guiprefs.iric_file = iric.file;
3982     <span class="keyword">else</span>
3983         guiprefs.iric_file = <span class="string">''</span>;
3984     <span class="keyword">end</span>
3985 <span class="keyword">else</span> <span class="comment">% Initialize Log</span>
3986     guiprefs.iric_path = pwd;
3987     guiprefs.iric_file = <span class="string">''</span>;
3988     
3989     iric.path = pwd;
3990     iric.file = <span class="string">''</span>;
3991     setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
3992 <span class="keyword">end</span>
3993 
3994 <span class="comment">% excel</span>
3995 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>)
3996     excel = getpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>);
3997     <span class="keyword">if</span> exist(excel.path,<span class="string">'dir'</span>)
3998         guiprefs.excel_path = excel.path;
3999     <span class="keyword">else</span>
4000         guiprefs.excel_path = pwd;
4001     <span class="keyword">end</span>
4002     <span class="keyword">if</span> exist(fullfile(excel.path,excel.file),<span class="string">'file'</span>)
4003         guiprefs.excel_file = excel.file;
4004     <span class="keyword">else</span>
4005         guiprefs.excel_file = <span class="string">''</span>;
4006     <span class="keyword">end</span>
4007 <span class="keyword">else</span> <span class="comment">% Initialize pref</span>
4008     guiprefs.excel_path = pwd;
4009     guiprefs.excel_file = <span class="string">''</span>;
4010     
4011     excel.path = pwd;
4012     excel.file = <span class="string">''</span>;
4013     setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4014 <span class="keyword">end</span>
4015 
4016 <span class="comment">% aerial</span>
4017 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>)
4018     aerial = getpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>);
4019     <span class="keyword">if</span> exist(aerial.path,<span class="string">'dir'</span>)
4020         guiprefs.aerial_path = aerial.path;
4021     <span class="keyword">else</span>
4022         guiprefs.aerial_path = pwd;
4023     <span class="keyword">end</span>
4024     does_exist = false(1,length(aerial.file));
4025     <span class="keyword">if</span> iscell(aerial.file)
4026     <span class="keyword">for</span> k = 1:numel(aerial.file) <span class="comment">% Check each file one-by-one</span>
4027         does_exist(k) = exist(fullfile(aerial.path,aerial.file{k}),<span class="string">'file'</span>);
4028     <span class="keyword">end</span>
4029     <span class="keyword">else</span>
4030         does_exist = exist(fullfile(aerial.path,aerial.file),<span class="string">'file'</span>);
4031     <span class="keyword">end</span>
4032     <span class="keyword">if</span> any(does_exist)
4033         guiprefs.aerial_file = aerial.file;
4034     <span class="keyword">else</span>
4035         guiprefs.aerial_file = {<span class="string">''</span>};
4036     <span class="keyword">end</span>
4037 <span class="keyword">else</span> <span class="comment">% Initialize aerial</span>
4038     guiprefs.aerial_path = pwd;
4039     guiprefs.aerial_file = {<span class="string">''</span>};
4040     
4041     aerial.path = pwd;
4042     aerial.file = {<span class="string">''</span>};
4043     setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4044 <span class="keyword">end</span>
4045 
4046 <span class="comment">% shoreline</span>
4047 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>)
4048     shoreline = getpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>);
4049     <span class="keyword">if</span> exist(shoreline.path,<span class="string">'dir'</span>)
4050         guiprefs.shoreline_path = shoreline.path;
4051     <span class="keyword">else</span>
4052         guiprefs.shoreline_path = pwd;
4053     <span class="keyword">end</span>
4054     
4055     <span class="keyword">if</span> iscell(shoreline.file)
4056         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file{1}),<span class="string">'file'</span>)
4057             guiprefs.shoreline_file = shoreline.file;
4058         <span class="keyword">else</span>
4059             guiprefs.shoreline_file = <span class="string">''</span>;
4060         <span class="keyword">end</span>
4061     <span class="keyword">else</span>
4062         <span class="keyword">if</span> exist(fullfile(shoreline.path,shoreline.file),<span class="string">'file'</span>)
4063             guiprefs.shoreline_file = shoreline.file;
4064         <span class="keyword">else</span>
4065             guiprefs.shoreline_file = <span class="string">''</span>;
4066         <span class="keyword">end</span>
4067     <span class="keyword">end</span>
4068 <span class="keyword">else</span> <span class="comment">% Initialize shoreline</span>
4069     guiprefs.shoreline_path = pwd;
4070     guiprefs.shoreline_file = <span class="string">''</span>;
4071     
4072     shoreline.path = pwd;
4073     shoreline.file = <span class="string">''</span>;
4074     setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4075 <span class="keyword">end</span>
4076 <span class="comment">% guiprefs.presentation = true;</span>
4077 <span class="comment">% guiprefs.print        = false;</span>
4078 
4079 <span class="comment">% for k = 1:length(prefs)</span>
4080 <span class="comment">%     newpref = '';</span>
4081 <span class="comment">%     if ispref('VMT',prefs{k})</span>
4082 <span class="comment">%         stored_newpref = getpref('VMT',prefs{k});</span>
4083 <span class="comment">%         if exist(stored_newpref,'dir')</span>
4084 <span class="comment">%             newpref = stored_newpref;</span>
4085 <span class="comment">%         else</span>
4086 <span class="comment">%             setpref('VMT',prefs{k},newpref)</span>
4087 <span class="comment">%         end</span>
4088 <span class="comment">%     end</span>
4089 <span class="comment">%     guiprefs.(prefs{k}) = newpref;</span>
4090 <span class="comment">% end</span>
4091 
4092 <span class="comment">% RENDERER</span>
4093 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
4094     renderer = getpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>);
4095     guiprefs.renderer = renderer;
4096 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4097     renderer           = <span class="string">'OpenGL'</span>;
4098     guiprefs.renderer  = renderer;
4099     setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4100 <span class="keyword">end</span>
4101 
4102 <span class="comment">% UNITS</span>
4103 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
4104     units = getpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>);
4105     guiprefs.units = units;
4106 <span class="keyword">else</span> <span class="comment">% Initialize UNITS</span>
4107     units           = <span class="string">'metric'</span>;
4108     guiprefs.units  = units;
4109     setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4110 <span class="keyword">end</span>
4111 
4112 <span class="comment">% PLOTREF</span>
4113 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'protref'</span>)
4114     plotref = getpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>);
4115     guiprefs.plotref = plotref;
4116 <span class="keyword">else</span> <span class="comment">% Initialize PLOTREF</span>
4117     plotref           = <span class="string">'dfs'</span>;
4118     guiprefs.plotref  = plotref;
4119     setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4120 <span class="keyword">end</span>
4121 
4122 <span class="comment">% RUNCOUNTER</span>
4123 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)
4124     runcounter = getpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>)+1;
4125     guiprefs.runcounter = runcounter;
4126 <span class="keyword">else</span> <span class="comment">% Initialize RENDERER</span>
4127     runcounter           = 1;
4128     guiprefs.runcounter  = runcounter;
4129     setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4130 <span class="keyword">end</span>
4131 setappdata(hfigure,<span class="string">'guiprefs'</span>,guiprefs)
4132 
4133 <span class="comment">% SETENDPOINTS</span>
4134 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>)
4135     setendpoints = getpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>);
4136     <span class="keyword">if</span> exist(setendpoints.path,<span class="string">'dir'</span>)
4137         guiprefs.setendpoints_path = setendpoints.path;
4138     <span class="keyword">else</span>
4139         guiprefs.setendpoints_path = pwd;
4140     <span class="keyword">end</span>
4141     <span class="keyword">if</span> exist(fullfile(setendpoints.path,setendpoints.file),<span class="string">'file'</span>)
4142         guiprefs.setendpoints_file = setendpoints.file;
4143     <span class="keyword">else</span>
4144         guiprefs.setendpoints_file = <span class="string">''</span>;
4145     <span class="keyword">end</span>
4146 <span class="keyword">else</span> <span class="comment">% Initialize TECPLOT</span>
4147     guiprefs.setendpoints_path = pwd;
4148     guiprefs.setendpoints_file = <span class="string">''</span>;
4149     
4150     setendpoints.path = pwd;
4151     setendpoints.file = <span class="string">''</span>;
4152     setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4153 <span class="keyword">end</span>
4154 
4155 <span class="comment">% [EOF] load_prefs</span>
4156 
4157 
4158 <span class="comment">% --------------------------------------------------------------------</span>
4159 <a name="_sub95" href="#_subfunctions" class="code">function store_prefs(hfigure,pref)</a>
4160 <span class="comment">% Store preferences in the Application data and in the persistent</span>
4161 <span class="comment">% preferences data.</span>
4162 
4163 <span class="comment">% Preferences:</span>
4164 <span class="comment">% 'ascii'                Path and filenames of current ASCII files</span>
4165 <span class="comment">% 'mat'                  Path and filename of current MAT file</span>
4166 <span class="comment">% 'tecplot'              Path and filename of last Tecplot file</span>
4167 <span class="comment">% 'kmz'                  Path and filename of last KMZ file</span>
4168 <span class="comment">% 'multibeambathymetry'  Path and filename of last Multibeam Bathymetry file</span>
4169 <span class="comment">% 'log'                  Path and filename of last Log file</span>
4170 <span class="comment">% 'iric'                 Path and filename of last iRic ANV file</span>
4171 <span class="comment">% 'excel'                Path and filename of last Excel file</span>
4172 <span class="comment">% 'aerial'               Path and filename of last Aerial file</span>
4173 <span class="comment">% 'shoreline'            Path and filename of last Shoreline file</span>
4174 <span class="comment">% 'renderer'             Default graphics renderer</span>
4175 <span class="comment">% 'units'                Default plotting units</span>
4176 <span class="comment">% 'plotref'              Default plotting vertical reference</span>
4177 <span class="comment">% 'runcounter'           Keeps a running tally of how many times VMT is</span>
4178 <span class="comment">%                        started</span>
4179 <span class="comment">% 'setendpoints'         Path and filename of user endpoint file</span>
4180 
4181 guiprefs = getappdata(hfigure,<span class="string">'guiprefs'</span>);
4182 
4183 <span class="keyword">switch</span> pref
4184     <span class="keyword">case</span> <span class="string">'ascii'</span>
4185         ascii.path = guiprefs.ascii_path;
4186         ascii.file = guiprefs.ascii_file;
4187         setpref(<span class="string">'VMT'</span>,<span class="string">'ascii'</span>,ascii)
4188     <span class="keyword">case</span> <span class="string">'mat'</span>
4189         mat.path = guiprefs.mat_path;
4190         mat.file = guiprefs.mat_file;
4191         setpref(<span class="string">'VMT'</span>,<span class="string">'mat'</span>,mat)
4192     <span class="keyword">case</span> <span class="string">'tecplot'</span>
4193         tecplot.path = guiprefs.tecplot_path;
4194         tecplot.file = guiprefs.tecplot_file;
4195         setpref(<span class="string">'VMT'</span>,<span class="string">'tecplot'</span>,tecplot)
4196     <span class="keyword">case</span> <span class="string">'kmz'</span>
4197         kmz.path = guiprefs.kmz_path;
4198         kmz.file = guiprefs.kmz_file;
4199         setpref(<span class="string">'VMT'</span>,<span class="string">'kmz'</span>,kmz)
4200     <span class="keyword">case</span> <span class="string">'multibeambathymetry'</span>
4201         multibeambathymetry.path = guiprefs.multibeambathymetry_path;
4202         multibeambathymetry.file = guiprefs.multibeambathymetry_file;
4203         setpref(<span class="string">'VMT'</span>,<span class="string">'multibeambathymetry'</span>,multibeambathymetry)
4204     <span class="keyword">case</span> <span class="string">'log'</span>
4205         log.path = guiprefs.log_path;
4206         log.file = guiprefs.log_file;
4207         setpref(<span class="string">'VMT'</span>,<span class="string">'log'</span>,log)
4208     <span class="keyword">case</span> <span class="string">'iric'</span>
4209         iric.path = guiprefs.iric_path;
4210         iric.file = guiprefs.iric_file;
4211         setpref(<span class="string">'VMT'</span>,<span class="string">'iric'</span>,iric)
4212     <span class="keyword">case</span> <span class="string">'excel'</span>
4213         excel.path = guiprefs.excel_path;
4214         excel.file = guiprefs.excel_file;
4215         setpref(<span class="string">'VMT'</span>,<span class="string">'excel'</span>,excel)
4216     <span class="keyword">case</span> <span class="string">'aerial'</span>
4217         aerial.path = guiprefs.aerial_path;
4218         aerial.file = guiprefs.aerial_file;
4219         setpref(<span class="string">'VMT'</span>,<span class="string">'aerial'</span>,aerial)
4220     <span class="keyword">case</span> <span class="string">'shoreline'</span>
4221         shoreline.path = guiprefs.shoreline_path;
4222         shoreline.file = guiprefs.shoreline_file;
4223         setpref(<span class="string">'VMT'</span>,<span class="string">'shoreline'</span>,shoreline)
4224     <span class="keyword">case</span> <span class="string">'renderer'</span>
4225         renderer = guiprefs.renderer;
4226         setpref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>,renderer)
4227     <span class="keyword">case</span> <span class="string">'units'</span>
4228         units = guiprefs.units;
4229         setpref(<span class="string">'VMT'</span>,<span class="string">'units'</span>,units)
4230     <span class="keyword">case</span> <span class="string">'plotref'</span>
4231         plotref = guiprefs.plotref;
4232         setpref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>,plotref)
4233     <span class="keyword">case</span> <span class="string">'runcounter'</span>
4234         runcounter = guiprefs.runcounter;
4235         setpref(<span class="string">'VMT'</span>,<span class="string">'runcounter'</span>,runcounter)
4236     <span class="keyword">case</span> <span class="string">'setendpoints'</span>
4237         setendpoints.path = guiprefs.setendpoints_path;
4238         setendpoints.file = guiprefs.setendpoints_file;
4239         setpref(<span class="string">'VMT'</span>,<span class="string">'setendpoints'</span>,setendpoints)
4240     <span class="keyword">otherwise</span>
4241 <span class="keyword">end</span>
4242 
4243 <span class="comment">% if ismember(pref,prefs)</span>
4244 <span class="comment">%     setpref('VMT',pref,value)</span>
4245 <span class="comment">%</span>
4246 <span class="comment">%     guiprefs = getappdata(hfigure,'guiprefs');</span>
4247 <span class="comment">%     guiprefs.(pref) = value;</span>
4248 <span class="comment">%     setappdata(hfigure,'guiprefs',guiprefs)</span>
4249 <span class="comment">% end</span>
4250 
4251 <span class="comment">% [EOF] store_prefs</span>
4252 
4253 
4254 <span class="comment">% --------------------------------------------------------------------</span>
4255 <a name="_sub96" href="#_subfunctions" class="code">function initGUI(handles)</a>
4256 <span class="comment">% Initialize the UI controls in the GUI.</span>
4257 
4258 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4259 
4260 <span class="comment">% Set the name and version</span>
4261 set(handles.figure1,<span class="string">'Name'</span>,[<span class="string">'Velocity Mapping Toolbox (VMT) '</span> guiparams.vmt_version{1}], <span class="keyword">...</span>
4262     <span class="string">'DockControls'</span>,<span class="string">'off'</span>)
4263 <span class="comment">%set(handles.VMTversion,             'String',guiparams.vmt_version)</span>
4264 
4265 <span class="comment">% Set the PLOT 1 axis labels</span>
4266 axes(handles.Plot1Shiptracks);
4267 set(handles.Plot1Shiptracks,<span class="string">'DataAspectRatio'</span>,[1 1 1],<span class="string">'PlotBoxAspectRatio'</span>,[1 1 1])
4268 xlabel(<span class="string">'UTM Easting (m)'</span>)
4269 ylabel(<span class="string">'UTM Northing (m)'</span>)
4270 box on
4271 grid on
4272 <span class="comment">% ticks_format('%6.0f','%8.0f'); %formats the ticks for UTM</span>
4273 
4274 <span class="comment">%%%%%%%%%%%%</span>
4275 <span class="comment">% MENU BAR %</span>
4276 <span class="comment">%%%%%%%%%%%%</span>
4277 <span class="keyword">if</span> guiparams.english_units
4278     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4279     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4280 <span class="keyword">else</span>
4281     set(handles.menuMetric, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4282     set(handles.menuEnglish,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4283 <span class="keyword">end</span>
4284 
4285 <span class="keyword">if</span> guiparams.set_cross_section_endpoints
4286     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4287     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4288 <span class="keyword">else</span>
4289     set(handles.menuCrossSectionEndpointAutomatic,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4290     set(handles.menuCrossSectionEndpointManual,   <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4291 <span class="keyword">end</span>
4292 
4293 
4294 <span class="keyword">if</span> guiparams.print
4295     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4296     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'off'</span>)
4297     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4298     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4299 <span class="keyword">elseif</span> guiparams.presentation
4300     set(handles.menuPrintFormat,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4301     set(handles.menuPresentationFormat,<span class="string">'Checked'</span>,<span class="string">'on'</span>)
4302     set(handles.menuStylePrint,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4303     set(handles.menuStylePresentation, <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4304 <span class="keyword">else</span>
4305 <span class="keyword">end</span>
4306 
4307 <span class="keyword">switch</span> guiparams.renderer
4308     <span class="keyword">case</span> <span class="string">'OpenGL'</span>
4309         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4310         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4311         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4312     <span class="keyword">case</span> <span class="string">'painters'</span>
4313         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4314         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4315         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4316     <span class="keyword">case</span> <span class="string">'zbuffer'</span>
4317         set(handles.menuOpenGL,        <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4318         set(handles.menuPainters,      <span class="string">'Checked'</span>,<span class="string">'off'</span>)
4319         set(handles.menuZbuffer,       <span class="string">'Checked'</span>,<span class="string">'on'</span>)
4320 <span class="keyword">end</span>
4321 
4322 
4323 <span class="comment">%%%%%%%%%%%%%%%</span>
4324 <span class="comment">% DATA EXPORT %</span>
4325 <span class="comment">%%%%%%%%%%%%%%%</span>
4326 <span class="comment">% BathymetryPanel</span>
4327 <span class="comment">% set(handles.BeamAngle,                  'String',guiparams.beam_angle)</span>
4328 <span class="comment">% set(handles.MagneticVariation,          'String',guiparams.magnetic_variation)</span>
4329 <span class="comment">% set(handles.WSE,                        'String',guiparams.wse)</span>
4330 <span class="comment">% set(handles.OutputAuxiliaryData,        'Value', guiparams.output_auxiliary_data)</span>
4331 
4332 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4333 <span class="comment">% PLOTTING/PLAN VIEW %</span>
4334 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
4335 <span class="comment">% PlanViewPanel</span>
4336 set(handles.DepthRangeMin,              <span class="string">'String'</span>,guiparams.depth_range_min)
4337 set(handles.DepthRangeMax,              <span class="string">'String'</span>,guiparams.depth_range_max)
4338 set(handles.VectorScalePlanView,        <span class="string">'String'</span>,guiparams.vector_scale_plan_view)
4339 set(handles.VectorSpacingPlanview,      <span class="string">'String'</span>,guiparams.vector_spacing_plan_view)
4340 set(handles.SmoothingWindowSize,        <span class="string">'String'</span>,guiparams.smoothing_window_size)
4341 set(handles.AddBackground,              <span class="string">'Value'</span>, guiparams.add_background)
4342 
4343 
4344 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4345 <span class="comment">% PLOTTING/SHIP TRACKS %</span>
4346 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%</span>
4347 <span class="comment">% ShiptracksPanel</span>
4348 set(handles.HorizontalGridNodeSpacing,  <span class="string">'String'</span>,guiparams.horizontal_grid_node_spacing)
4349 set(handles.VerticalGridNodeSpacing,    <span class="string">'String'</span>,guiparams.vertical_grid_node_spacing)
4350 <span class="comment">%set(handles.SetCrossSectionEndpoints,   'Value', guiparams.set_cross_section_endpoints)</span>
4351 
4352 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4353 <span class="comment">% PLOTTING/CROSS SECTIONS %</span>
4354 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
4355 <span class="comment">% CrossSectionsPanel</span>
4356 set(handles.Contour,                    <span class="string">'String'</span>,{guiparams.contours.string}, <span class="keyword">...</span>
4357     <span class="string">'Value'</span>, guiparams.idx_contour)
4358 set(handles.VerticalExaggeration,       <span class="string">'String'</span>,guiparams.vertical_exaggeration)
4359 set(handles.VectorScaleCrossSection,    <span class="string">'String'</span>,guiparams.vector_scale_cross_section)
4360 set(handles.HorizontalVectorSpacing,    <span class="string">'String'</span>,guiparams.horizontal_vector_spacing)
4361 set(handles.VerticalVectorSpacing,      <span class="string">'String'</span>,guiparams.vertical_vector_spacing)
4362 set(handles.HorizontalSmoothingWindow,  <span class="string">'String'</span>,guiparams.horizontal_smoothing_window)
4363 set(handles.VerticalSmoothingWindow,    <span class="string">'String'</span>,guiparams.vertical_smoothing_window)
4364 set(handles.PlotSecondaryFlowVectors,   <span class="string">'Value'</span>, guiparams.plot_secondary_flow_vectors)
4365 set(handles.SecondaryFlowVectorVariable,<span class="string">'String'</span>,{guiparams.secondary_flows.string}, <span class="keyword">...</span>
4366     <span class="string">'Value'</span>, guiparams.idx_secondary_flow_vector_variable)
4367 set(handles.IncludeVerticalVelocity,    <span class="string">'Value'</span>, guiparams.include_vertical_velocity)
4368 
4369 <span class="comment">% set(handles.EnglishUnits,               'Value',guiparams.english_units)</span>
4370 
4371 <span class="comment">% [EOF] initGUI</span>
4372 
4373 
4374 <span class="comment">% --------------------------------------------------------------------</span>
4375 <a name="_sub97" href="#_subfunctions" class="code">function set_enable(handles,enable_state)</a>
4376 
4377 guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
4378 
4379 <span class="keyword">switch</span> enable_state
4380     <span class="keyword">case</span> <span class="string">'init'</span>
4381         guiparams.gui_state = <span class="string">'init'</span>;
4382         set([handles.menuFile
4383             handles.menuOpen
4384             handles.menuOpenASCII
4385             handles.menuOpenMAT
4386             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4387         
4388         set([handles.toolbarLoadData
4389             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4390         set([handles.toolbarSaveMatFile
4391             handles.toolbarSaveBathymetry
4392             handles.toolbarSaveFigures
4393             handles.toolbarSaveExcel
4394             handles.toolbarPlottingParameters
4395             handles.toolbarProcessingParameters
4396             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4397         
4398         set([handles.DepthRangeMin
4399             handles.DepthRangeMax
4400             handles.VectorScalePlanView
4401             handles.VectorSpacingPlanview
4402             handles.SmoothingWindowSize
4403             handles.AddBackground
4404             handles.PlotPlanView
4405             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4406       
4407         set([handles.HorizontalGridNodeSpacing
4408             handles.VerticalGridNodeSpacing
4409             handles.PlotShiptracks
4410             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4411         
4412         set([handles.Contour
4413             handles.VerticalExaggeration
4414             handles.VectorScaleCrossSection
4415             handles.HorizontalVectorSpacing
4416             handles.VerticalVectorSpacing
4417             handles.HorizontalSmoothingWindow
4418             handles.VerticalSmoothingWindow
4419             handles.PlotSecondaryFlowVectors
4420             handles.SecondaryFlowVectorVariable
4421             handles.IncludeVerticalVelocity
4422             handles.IncludeVerticalVelocityText
4423             handles.PlotCrossSection
4424             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4425         
4426     <span class="keyword">case</span> <span class="string">'fileloaded'</span>
4427         guiparams.gui_state = <span class="string">'fileloaded'</span>;
4428         set([handles.menuFile
4429             handles.menuOpen
4430             handles.menuOpenASCII
4431             handles.menuOpenMAT
4432             handles.menuSaveMAT
4433             handles.menuSaveTecplot
4434             handles.menuSaveKMZFile
4435             handles.menuSettings
4436             handles.menuPlottingParameters
4437             handles.menuMetric
4438             handles.menuEnglish
4439             handles.menuBathymetryExportSettings
4440             handles.menuExportMultibeamBathymetry
4441             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4442             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4443         
4444         set([handles.toolbarLoadData
4445             handles.toolbarSaveMatFile
4446             handles.toolbarSaveBathymetry
4447             handles.toolbarSaveExcel
4448             handles.toolbarSaveFigures
4449             handles.toolbarPlottingParameters
4450             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4451         set([handles.toolbarProcessingParameters
4452             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4453         
4454            
4455         set([handles.DepthRangeMin
4456             handles.DepthRangeMax
4457             handles.VectorScalePlanView
4458             handles.VectorSpacingPlanview
4459             handles.SmoothingWindowSize
4460             handles.PlotPlanView
4461             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4462         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4463             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4464         <span class="keyword">else</span>
4465             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4466         <span class="keyword">end</span>
4467         
4468         set([handles.HorizontalGridNodeSpacing
4469             handles.VerticalGridNodeSpacing
4470             handles.PlotShiptracks
4471             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4472         
4473         set([handles.Contour
4474             handles.VerticalExaggeration
4475             handles.VectorScaleCrossSection
4476             handles.HorizontalVectorSpacing
4477             handles.VerticalVectorSpacing
4478             handles.HorizontalSmoothingWindow
4479             handles.VerticalSmoothingWindow
4480             handles.PlotSecondaryFlowVectors
4481             handles.SecondaryFlowVectorVariable
4482             handles.IncludeVerticalVelocity
4483             handles.IncludeVerticalVelocityText
4484             handles.PlotCrossSection
4485             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4486     <span class="keyword">case</span> <span class="string">'multiplematfiles'</span>
4487         guiparams.gui_state = <span class="string">'multiplematfiles'</span>;
4488         set([handles.menuFile
4489             handles.menuOpen
4490             handles.menuOpenASCII
4491             handles.menuOpenMAT
4492             handles.menuSettings
4493             handles.menuPlottingParameters
4494             handles.menuMetric
4495             handles.menuEnglish
4496             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4497         set([handles.menuSaveMAT
4498             handles.menuBathymetryExportSettings
4499             handles.menuExportMultibeamBathymetry
4500             <span class="keyword">...</span><span class="comment">handles.menuKMZVerticalOffset</span>
4501             handles.menuSaveKMZFile
4502             handles.menuSaveTecplot
4503             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4504         
4505         set([handles.toolbarLoadData
4506             handles.toolbarSaveFigures
4507             handles.toolbarPlottingParameters
4508             handles.toolbarSaveExcel
4509             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4510         set([handles.toolbarProcessingParameters
4511             handles.toolbarSaveMatFile
4512             handles.toolbarSaveBathymetry
4513             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4514         
4515         set([handles.DepthRangeMin
4516             handles.DepthRangeMax
4517             handles.VectorScalePlanView
4518             handles.VectorSpacingPlanview
4519             handles.SmoothingWindowSize
4520             handles.PlotPlanView
4521             ],<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4522         <span class="keyword">if</span> guiparams.has_mapping_toolbox
4523             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'on'</span>)
4524         <span class="keyword">else</span>
4525             set(handles.AddBackground,<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4526         <span class="keyword">end</span>
4527         
4528         set([handles.HorizontalGridNodeSpacing
4529             handles.VerticalGridNodeSpacing
4530             handles.PlotShiptracks
4531             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4532         
4533         set([handles.Contour
4534             handles.VerticalExaggeration
4535             handles.VectorScaleCrossSection
4536             handles.HorizontalVectorSpacing
4537             handles.VerticalVectorSpacing
4538             handles.HorizontalSmoothingWindow
4539             handles.VerticalSmoothingWindow
4540             handles.PlotSecondaryFlowVectors
4541             handles.SecondaryFlowVectorVariable
4542             handles.IncludeVerticalVelocity
4543             handles.IncludeVerticalVelocityText
4544             handles.PlotCrossSection
4545             ],<span class="string">'Enable'</span>,<span class="string">'off'</span>)
4546     <span class="keyword">otherwise</span>
4547 <span class="keyword">end</span>
4548 
4549 <span class="comment">% Save Application Data</span>
4550 setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
4551 
4552 <span class="comment">% [EOF] set_enable</span>
4553 
4554 <span class="comment">%% Compute the longitudinal dispersion coefficient</span>
4555 
4556 <span class="comment">%% --- Executes on button press in zerosecq_chkbox.</span>
4557 <span class="comment">%function zerosecq_chkbox_Callback(hObject, eventdata, handles)</span>
4558 <span class="comment">% hObject    handle to zerosecq_chkbox (see GCBO)</span>
4559 <span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
4560 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
4561 
4562 <span class="comment">% Hint: get(hObject,'Value') returns toggle state of zerosecq_chkbox</span>
4563 
4564 
4565 <span class="comment">% --------------------------------------------------------------------</span>
4566 <a name="_sub98" href="#_subfunctions" class="code">function [english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style] = </a><span class="keyword">...</span>
4567     plotParametersDialog(english_units,set_cross_section_endpoints,plot_presentation_style,plot_print_style,hf)
4568 
4569 w = 500;
4570 h = 110;
4571 dx = 10;
4572 dy = 35;
4573 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4574 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Plotting Parameters'</span>, <span class="keyword">...</span>
4575     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4576     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4577     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4578     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4579     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4580     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4581     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4582     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4583     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4584     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4585 dialog_params.english_units               = english_units;
4586 dialog_params.set_cross_section_endpoints = set_cross_section_endpoints;
4587 dialog_params.presentation                = plot_presentation_style; <span class="comment">%presentation;</span>
4588 dialog_params.print                       = plot_print_style; <span class="comment">%print;</span>
4589 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4590 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4591 
4592 <span class="comment">% Build the graphics:</span>
4593 <span class="comment">% -------------------</span>
4594 handles.UnitsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4595     <span class="string">'Title'</span>, <span class="string">'Units'</span>, <span class="keyword">...</span>
4596     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4597     <span class="string">'Position'</span>,[dx dy (w-3*dx)/3 h-dx-dy+10]);
4598 handles.UnitsMetric = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4599     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4600     <span class="string">'String'</span>,<span class="string">'Metric'</span>, <span class="keyword">...</span>
4601     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4602     <span class="string">'Position'</span>,[15 35 100 22]);
4603 handles.UnitsEnglish = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4604     <span class="string">'Parent'</span>,handles.UnitsPanel, <span class="keyword">...</span>
4605     <span class="string">'String'</span>,<span class="string">'English'</span>, <span class="keyword">...</span>
4606     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4607     <span class="string">'Position'</span>,[15 10 100 22]);
4608 
4609 handles.EndpointsPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4610     <span class="string">'Title'</span>, <span class="string">'Cross-Section Endpoints'</span>, <span class="keyword">...</span>
4611     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4612     <span class="string">'Position'</span>,[(w+dx)/3 dy (w-3*dx)/3 h-dx-dy+10]);
4613 handles.EndpointsAutomatic = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4614     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4615     <span class="string">'String'</span>,<span class="string">'Automatic'</span>, <span class="keyword">...</span>
4616     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4617     <span class="string">'Position'</span>,[15 35 100 22]);
4618 handles.EndpointsManual = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4619     <span class="string">'Parent'</span>,handles.EndpointsPanel, <span class="keyword">...</span>
4620     <span class="string">'String'</span>,<span class="string">'Set Manually'</span>, <span class="keyword">...</span>
4621     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4622     <span class="string">'Position'</span>,[15 10 100 22]);
4623 
4624 handles.StylePanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4625     <span class="string">'Title'</span>, <span class="string">'Plot Style'</span>, <span class="keyword">...</span>
4626     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4627     <span class="string">'Position'</span>,[w-w/3 dy (w-3*dx)/3 h-dx-dy+10]);
4628 handles.StylePresentation = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4629     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4630     <span class="string">'String'</span>,<span class="string">'Presentation'</span>, <span class="keyword">...</span>
4631     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4632     <span class="string">'Position'</span>,[15 35 100 22]);
4633 handles.StylePrint = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4634     <span class="string">'Parent'</span>,handles.StylePanel, <span class="keyword">...</span>
4635     <span class="string">'String'</span>,<span class="string">'Print'</span>, <span class="keyword">...</span>
4636     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4637     <span class="string">'Position'</span>,[15 10 100 22]);
4638 
4639 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4640     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4641     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4642     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4643     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4644 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4645     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4646     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4647     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4648     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4649 
4650 <span class="comment">% Update the UI controls:</span>
4651 <span class="comment">% -----------------------</span>
4652 <span class="keyword">if</span> dialog_params.english_units
4653     set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4654     set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4655 <span class="keyword">else</span>
4656     set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4657     set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4658 <span class="keyword">end</span>
4659 <span class="keyword">if</span> dialog_params.set_cross_section_endpoints
4660     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4661     set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4662 <span class="keyword">else</span>
4663     set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4664     set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4665 <span class="keyword">end</span>
4666 <span class="keyword">if</span> dialog_params.presentation
4667     set(handles.StylePresentation, <span class="string">'Value'</span>,1)
4668     set(handles.StylePrint,        <span class="string">'Value'</span>,0)
4669 <span class="keyword">else</span>
4670     set(handles.StylePresentation, <span class="string">'Value'</span>,0)
4671     set(handles.StylePrint,        <span class="string">'Value'</span>,1)
4672 <span class="keyword">end</span>
4673 
4674 <span class="comment">% Set the callbacks:</span>
4675 <span class="comment">% ------------------</span>
4676 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub104" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>, handles.OK})
4677 set(handles.UnitsMetric,       <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'metric'</span>})
4678 set(handles.UnitsEnglish,      <span class="string">'Callback'</span>,       {@<a href="#_sub99" class="code" title="subfunction dialogUnits(hObject,eventdata,handles,the_units)">dialogUnits</a>,    handles,<span class="string">'english'</span>})
4679 set(handles.EndpointsAutomatic,<span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'auto'</span>})
4680 set(handles.EndpointsManual,   <span class="string">'Callback'</span>,       {@<a href="#_sub100" class="code" title="subfunction dialogEnpoints(hObject,eventdata,handles,the_endpoints)">dialogEnpoints</a>, handles,<span class="string">'manual'</span>})
4681 set(handles.StylePresentation, <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'presentation'</span>})
4682 set(handles.StylePrint,        <span class="string">'Callback'</span>,       {@<a href="#_sub101" class="code" title="subfunction dialogPlotStyle(hObject,eventdata,handles,the_style)">dialogPlotStyle</a>,handles,<span class="string">'print'</span>})
4683 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
4684 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
4685 
4686 <span class="comment">% Position the dialog and make it visible:</span>
4687 <span class="comment">% ----------------------------------------</span>
4688 fpos = get(hf,<span class="string">'Position'</span>);
4689 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4690 movegui(handles.Figure,dpos)
4691 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4692 
4693 <span class="comment">% Hold the dialog open:</span>
4694 <span class="comment">% ---------------------</span>
4695 waitfor(handles.OK)
4696 
4697 <span class="comment">% Return the outputs and close the dialog:</span>
4698 <span class="comment">% ----------------------------------------</span>
4699 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4700 english_units = dialog_params.english_units;
4701 set_cross_section_endpoints = dialog_params.set_cross_section_endpoints;
4702 plot_presentation_style =  dialog_params.presentation;
4703 plot_print_style =  dialog_params.print;
4704 
4705 delete(handles.Figure)
4706 
4707 <span class="comment">% [EOF] plotParametersDialog</span>
4708 
4709 
4710 <span class="comment">% --------------------------------------------------------------------</span>
4711 <a name="_sub99" href="#_subfunctions" class="code">function dialogUnits(hObject,eventdata,handles,the_units)</a>
4712 
4713 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4714 <span class="keyword">switch</span> the_units
4715     <span class="keyword">case</span> <span class="string">'metric'</span>
4716         dialog_params.english_units = false;
4717         
4718         set(handles.UnitsMetric, <span class="string">'Value'</span>,1)
4719         set(handles.UnitsEnglish,<span class="string">'Value'</span>,0)
4720     <span class="keyword">case</span> <span class="string">'english'</span>
4721         dialog_params.english_units = true;
4722         
4723         set(handles.UnitsMetric, <span class="string">'Value'</span>,0)
4724         set(handles.UnitsEnglish,<span class="string">'Value'</span>,1)
4725     <span class="keyword">otherwise</span>
4726 <span class="keyword">end</span>
4727 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4728 
4729 <span class="comment">% [EOF] dialogUnits</span>
4730 
4731 <span class="comment">% --------------------------------------------------------------------</span>
4732 <a name="_sub100" href="#_subfunctions" class="code">function dialogEnpoints(hObject,eventdata,handles,the_endpoints)</a>
4733 
4734 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4735 <span class="keyword">switch</span> the_endpoints
4736     <span class="keyword">case</span> <span class="string">'auto'</span>
4737         dialog_params.set_cross_section_endpoints = false;
4738         
4739         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,1)
4740         set(handles.EndpointsManual,   <span class="string">'Value'</span>,0)
4741     <span class="keyword">case</span> <span class="string">'manual'</span>
4742         dialog_params.set_cross_section_endpoints = true;
4743         
4744         set(handles.EndpointsAutomatic,<span class="string">'Value'</span>,0)
4745         set(handles.EndpointsManual,   <span class="string">'Value'</span>,1)
4746     <span class="keyword">otherwise</span>
4747 <span class="keyword">end</span>
4748 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4749 
4750 <span class="comment">% [EOF] dialogEnpoints</span>
4751 
4752 <a name="_sub101" href="#_subfunctions" class="code">function dialogPlotStyle(hObject,eventdata,handles,the_style)</a>
4753 
4754 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4755 <span class="keyword">switch</span> the_style
4756     <span class="keyword">case</span> <span class="string">'presentation'</span>
4757         dialog_params.presentation  = true;
4758         dialog_params.print         = false;
4759         
4760         set(handles.StylePresentation,<span class="string">'Value'</span>,1)
4761         set(handles.StylePrint,       <span class="string">'Value'</span>,0)
4762     <span class="keyword">case</span> <span class="string">'print'</span>
4763         dialog_params.presentation  = false;
4764         dialog_params.print         = true;
4765         
4766         set(handles.StylePresentation,<span class="string">'Value'</span>,0)
4767         set(handles.StylePrint,       <span class="string">'Value'</span>,1)
4768     <span class="keyword">otherwise</span>
4769 <span class="keyword">end</span>
4770 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4771 
4772 <span class="comment">% [EOF] dialogEnpoints</span>
4773 
4774 <span class="comment">% --------------------------------------------------------------------</span>
4775 <a name="_sub102" href="#_subfunctions" class="code">function dialogOK(hObject,eventdata,h_OK)</a>
4776 
4777 delete(h_OK)
4778 
4779 <span class="comment">% [EOF] dialogOK</span>
4780 
4781 <span class="comment">% --------------------------------------------------------------------</span>
4782 <a name="_sub103" href="#_subfunctions" class="code">function dialogCancel(hObject,eventdata,handles)</a>
4783 <span class="comment">% Return the original inputs</span>
4784 dialog_params = getappdata(handles.Figure,<span class="string">'original_dialog_params'</span>);
4785 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4786 delete(handles.OK)
4787 
4788 <span class="comment">% [EOF] dialogCancel</span>
4789 
4790 <span class="comment">% --------------------------------------------------------------------</span>
4791 <a name="_sub104" href="#_subfunctions" class="code">function dialogCloseReq(hObject,eventdata,h_OK)</a>
4792 
4793 delete(h_OK)
4794 
4795 <span class="comment">% [EOF] dialogCloseReq</span>
4796 
4797 <a name="_sub105" href="#_subfunctions" class="code">function [beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file] = </a><span class="keyword">...</span>
4798     exportSettingsDialog(beam_angle,magnetic_variation,wse,output_auxiliary_data,load_wse_tide_file,hf)
4799 w = 230;
4800 h = 245;
4801 dx = 10;
4802 dy = 35;
4803 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4804 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Export Settings'</span>, <span class="keyword">...</span>
4805     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4806     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4807     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4808     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4809     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4810     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4811     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4812     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4813     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4814     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4815 dialog_params.beam_angle             = beam_angle;
4816 dialog_params.magnetic_variation     = magnetic_variation;
4817 <span class="keyword">if</span> isstruct(wse) <span class="comment">% tidefile loaded already</span>
4818     dialog_params.wse                = <span class="string">'tide'</span>;
4819     wse_string                       = <span class="string">'tide'</span>;
4820 <span class="keyword">elseif</span> load_wse_tide_file <span class="comment">% tidefile is requested, but not loaded</span>
4821     dialog_params.wse                = <span class="string">'tide'</span>;
4822     wse_string                       = <span class="string">'tide'</span>;
4823 <span class="keyword">else</span>
4824     dialog_params.wse                = wse;
4825     wse_string                       = num2str(wse);
4826 <span class="keyword">end</span>
4827 dialog_params.load_wse_tide_file     = load_wse_tide_file;
4828 dialog_params.output_auxiliary_data  = output_auxiliary_data;
4829 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4830 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4831 
4832 <span class="comment">% Build the graphics:</span>
4833 <span class="comment">% -------------------</span>
4834 ph = 150;
4835 handles.BathymetryPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4836     <span class="string">'Title'</span>, <span class="string">'Bathymetry'</span>, <span class="keyword">...</span>
4837     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4838     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4839 handles.BeamAngleText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4840     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4841     <span class="string">'String'</span>,<span class="string">'Beam Angle (deg)'</span>, <span class="keyword">...</span>
4842     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4843     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4844     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4845     <span class="string">'Position'</span>,[dx+5 h-ph+60-4 100 22]);
4846 handles.BeamAngle = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4847     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4848     <span class="keyword">...</span><span class="comment">'String','Beam Angle (deg)', ...</span>
4849     <span class="string">'String'</span>,beam_angle,<span class="keyword">...</span>
4850     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4851     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4852     <span class="string">'Position'</span>,[w-dx-80 h-ph+60 50 22]);
4853 handles.MagneticVariationText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4854     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4855     <span class="string">'String'</span>,<span class="string">'Magnetic Variation'</span>, <span class="keyword">...</span>
4856     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4857     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4858     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4859     <span class="string">'Position'</span>,[dx+5 h-ph+30-4 100 22]);
4860 handles.MagneticVariation = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4861     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4862     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4863     <span class="string">'String'</span>,magnetic_variation,<span class="keyword">...</span>
4864     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4865     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4866     <span class="string">'Position'</span>,[w-dx-80 h-ph+30 50 22]);
4867 handles.WSEText = uicontrol(<span class="string">'Style'</span>,<span class="string">'text'</span>, <span class="keyword">...</span>
4868     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4869     <span class="string">'String'</span>,<span class="string">'WSE (m)'</span>, <span class="keyword">...</span>
4870     <span class="keyword">...</span><span class="comment">'Value',beam_angle,...</span>
4871     <span class="string">'HorizontalAlignment'</span>,<span class="string">'right'</span>,<span class="keyword">...</span>
4872     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4873     <span class="string">'Position'</span>,[dx+5 h-ph-4 100 22]);
4874 handles.WSE = uicontrol(<span class="string">'Style'</span>,<span class="string">'edit'</span>, <span class="keyword">...</span>
4875     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4876     <span class="keyword">...</span><span class="comment">'String','Magnetic Variation', ...</span>
4877     <span class="string">'String'</span>,wse_string,<span class="keyword">...</span>
4878     <span class="string">'BackgroundColor'</span>,<span class="string">'w'</span>,<span class="keyword">...</span>
4879     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4880     <span class="string">'Position'</span>,[w-dx-80 h-ph 50 22]);
4881 handles.LoadWSETideFile = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4882     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4883     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4884     <span class="string">'String'</span>,<span class="string">'Read WSE as tide file?'</span>,<span class="keyword">...</span>
4885     <span class="string">'Position'</span>,[dx+5 45 w-2*dx-30 22]);
4886 handles.OutputauxiliaryData = uicontrol(<span class="string">'Style'</span>,<span class="string">'checkbox'</span>, <span class="keyword">...</span>
4887     <span class="string">'Parent'</span>,handles.BathymetryPanel, <span class="keyword">...</span>
4888     <span class="string">'String'</span>,<span class="string">'Output auxiliary Data'</span>, <span class="keyword">...</span>
4889     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4890     <span class="string">'Position'</span>,[dx+5 20 w-2*dx-30 22]);
4891 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4892     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4893     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
4894     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4895     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
4896 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
4897     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
4898     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
4899     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
4900     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
4901 
4902 <span class="comment">% Update the UI controls:</span>
4903 <span class="comment">% -----------------------</span>
4904 set(handles.BeamAngle,                <span class="string">'String'</span>,dialog_params.beam_angle)
4905 set(handles.MagneticVariation,        <span class="string">'String'</span>,dialog_params.magnetic_variation)
4906 set(handles.WSE,                      <span class="string">'String'</span>,dialog_params.wse)
4907 set(handles.LoadWSETideFile,          <span class="string">'Value'</span>, double(dialog_params.load_wse_tide_file))
4908 set(handles.OutputauxiliaryData,      <span class="string">'Value'</span>, double(dialog_params.output_auxiliary_data))
4909 
4910 <span class="comment">% Set the callbacks:</span>
4911 <span class="comment">% ------------------</span>
4912 set(handles.Figure,                      <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub104" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
4913 set(handles.BeamAngle,                   <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4914 set(handles.MagneticVariation,           <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4915 set(handles.WSE,                         <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4916 set(handles.LoadWSETideFile,             <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4917 set(handles.OutputauxiliaryData,         <span class="string">'Callback'</span>,       {@<a href="#_sub106" class="code" title="subfunction dialogExportSettings(hObject,eventdata,handles)">dialogExportSettings</a>,handles})
4918 set(handles.OK,                          <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,      handles.OK})
4919 set(handles.Cancel,                      <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,  handles})
4920 
4921 <span class="comment">% Position the dialog and make it visible:</span>
4922 <span class="comment">% ----------------------------------------</span>
4923 fpos = get(hf,<span class="string">'Position'</span>);
4924 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
4925 movegui(handles.Figure,dpos)
4926 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
4927 
4928 <span class="comment">% Hold the dialog open:</span>
4929 <span class="comment">% ---------------------</span>
4930 waitfor(handles.OK)
4931 
4932 <span class="comment">% Return the outputs and close the dialog:</span>
4933 <span class="comment">% ----------------------------------------</span>
4934 dialog_params           = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4935 beam_angle              = dialog_params.beam_angle;
4936 magnetic_variation      = dialog_params.magnetic_variation;
4937 wse                     = dialog_params.wse;
4938 load_wse_tide_file      = logical(dialog_params.load_wse_tide_file);
4939 output_auxiliary_data   = logical(dialog_params.output_auxiliary_data);
4940 
4941 delete(handles.Figure)
4942 
4943 <span class="comment">% [EOF] exportSettingsDialog</span>
4944 
4945 <span class="comment">% --------------------------------------------------------------------</span>
4946 <a name="_sub106" href="#_subfunctions" class="code">function dialogExportSettings(hObject,eventdata,handles)</a>
4947 
4948 <span class="comment">% Grab the current data</span>
4949 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
4950 
4951 <span class="comment">% Set it according to the dialog box values</span>
4952 dialog_params.beam_angle                = get(handles.BeamAngle,<span class="string">'String'</span>);
4953 dialog_params.magnetic_variation        = get(handles.MagneticVariation,<span class="string">'String'</span>);
4954 dialog_params.wse                       = get(handles.WSE,<span class="string">'String'</span>);
4955 dialog_params.load_wse_tide_file        = get(handles.LoadWSETideFile,<span class="string">'Value'</span>);
4956 dialog_params.output_auxiliary_data     = get(handles.OutputauxiliaryData,<span class="string">'Value'</span>);
4957 
4958 <span class="comment">% Re-store the application data</span>
4959 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4960 
4961 <span class="comment">% [EOF] dialogExportSettings</span>
4962 
4963 <a name="_sub107" href="#_subfunctions" class="code">function [selected_figures] = openFiguresDialog(figure_names,hf)</a>
4964 
4965 w = 230;
4966 h = 200;
4967 dx = 10;
4968 dy = 35;
4969 the_color = get(0,<span class="string">'factoryUipanelBackgroundColor'</span>);
4970 handles.Figure = figure(<span class="string">'Name'</span>, <span class="string">'Select open figures to export'</span>, <span class="keyword">...</span>
4971     <span class="string">'Color'</span>,the_color, <span class="keyword">...</span>
4972     <span class="string">'NumberTitle'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4973     <span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>, <span class="keyword">...</span>
4974     <span class="string">'WindowStyle'</span>,<span class="string">'modal'</span>, <span class="keyword">...</span>
4975     <span class="string">'MenuBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4976     <span class="string">'ToolBar'</span>,<span class="string">'none'</span>, <span class="keyword">...</span>
4977     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4978     <span class="string">'Position'</span>,[0 0 w h], <span class="keyword">...</span>
4979     <span class="string">'Resize'</span>,<span class="string">'off'</span>, <span class="keyword">...</span>
4980     <span class="string">'Visible'</span>,<span class="string">'off'</span>);
4981 dialog_params.figure_names               = figure_names;
4982 dialog_params.selected_figures           = <span class="string">''</span>;
4983 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
4984 setappdata(handles.Figure,<span class="string">'original_dialog_params'</span>,dialog_params)
4985 
4986 <span class="comment">% Build the graphics:</span>
4987 <span class="comment">% -------------------</span>
4988 handles.ListboxPanel = uipanel(<span class="string">'Parent'</span>,handles.Figure, <span class="keyword">...</span>
4989     <span class="string">'Title'</span>, <span class="string">'Figures'</span>, <span class="keyword">...</span>
4990     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4991     <span class="string">'Position'</span>,[dx dy (w-2*dx) h-dx-dy+10]);
4992 handles.Figures = uicontrol(<span class="string">'Style'</span>,<span class="string">'listbox'</span>, <span class="keyword">...</span>
4993     <span class="string">'Parent'</span>,handles.ListboxPanel, <span class="keyword">...</span>
4994     <span class="string">'BackGroundColor'</span>,<span class="string">'white'</span>,<span class="keyword">...</span>
4995     <span class="string">'String'</span>,figure_names, <span class="keyword">...</span>
4996     <span class="string">'Min'</span>, 0,<span class="keyword">...</span>
4997     <span class="string">'Max'</span>, 2,<span class="keyword">...</span>
4998     <span class="string">'Units'</span>,<span class="string">'pixels'</span>, <span class="keyword">...</span>
4999     <span class="string">'Position'</span>,[15 35 (w-5*dx) 100]);
5000 
5001 
5002 handles.OK = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5003     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5004     <span class="string">'String'</span>,  <span class="string">'OK'</span>, <span class="keyword">...</span>
5005     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5006     <span class="string">'Position'</span>,[w/2-80-dx/4 6 80 22]);
5007 handles.Cancel = uicontrol(<span class="string">'Style'</span>,   <span class="string">'pushbutton'</span>, <span class="keyword">...</span>
5008     <span class="string">'Parent'</span>,  handles.Figure, <span class="keyword">...</span>
5009     <span class="string">'String'</span>,  <span class="string">'Cancel'</span>, <span class="keyword">...</span>
5010     <span class="string">'Units'</span>,   <span class="string">'pixels'</span>, <span class="keyword">...</span>
5011     <span class="string">'Position'</span>,[w/2+dx/4 6 80 22]);
5012 
5013 <span class="comment">% Update the UI controls:</span>
5014 <span class="comment">% -----------------------</span>
5015 
5016 
5017 <span class="comment">% Set the callbacks:</span>
5018 <span class="comment">% ------------------</span>
5019 set(handles.Figure,            <span class="string">'CloseRequestFcn'</span>,{@<a href="#_sub104" class="code" title="subfunction dialogCloseReq(hObject,eventdata,h_OK)">dialogCloseReq</a>,handles.OK})
5020 set(handles.Figures,           <span class="string">'Callback'</span>,       {@<a href="#_sub108" class="code" title="subfunction dialogSelectFigures(hObject,eventdata,handles)">dialogSelectFigures</a>    handles})
5021 set(handles.OK,                <span class="string">'Callback'</span>,       {@<a href="#_sub102" class="code" title="subfunction dialogOK(hObject,eventdata,h_OK)">dialogOK</a>,       handles.OK})
5022 set(handles.Cancel,            <span class="string">'Callback'</span>,       {@<a href="#_sub103" class="code" title="subfunction dialogCancel(hObject,eventdata,handles)">dialogCancel</a>,   handles})
5023 
5024 <span class="comment">% Position the dialog and make it visible:</span>
5025 <span class="comment">% ----------------------------------------</span>
5026 fpos = get(hf,<span class="string">'Position'</span>);
5027 dpos = [(fpos(1) + fpos(3)/2 -w/2) (fpos(2) + fpos(4)/2)];
5028 movegui(handles.Figure,dpos)
5029 set(handles.Figure,<span class="string">'Visible'</span>,<span class="string">'on'</span>)
5030 
5031 <span class="comment">% Hold the dialog open:</span>
5032 <span class="comment">% ---------------------</span>
5033 waitfor(handles.OK)
5034 
5035 <span class="comment">% Return the outputs and close the dialog:</span>
5036 <span class="comment">% ----------------------------------------</span>
5037 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5038 selected_figures = dialog_params.selected_figures;
5039 
5040 delete(handles.Figure)
5041 
5042 <span class="comment">% [EOF] openFiguresDialog</span>
5043 
5044 <span class="comment">% --------------------------------------------------------------------</span>
5045 <a name="_sub108" href="#_subfunctions" class="code">function dialogSelectFigures(hObject,eventdata,handles)</a>
5046 
5047 dialog_params = getappdata(handles.Figure,<span class="string">'dialog_params'</span>);
5048 
5049 idx_selected = get(handles.Figures,<span class="string">'Value'</span>);
5050 fig_names    = get(handles.Figures,<span class="string">'String'</span>);
5051 selected     = fig_names(idx_selected);
5052 dialog_params.selected_figures = selected;
5053 
5054 setappdata(handles.Figure,<span class="string">'dialog_params'</span>,dialog_params)
5055 
5056 
5057 
5058 <span class="comment">% --------------------------------------------------------------------</span>
5059 <a name="_sub109" href="#_subfunctions" class="code">function icons = getIcons</a>
5060 
5061 <span class="comment">% Load data</span>
5062 idx = 1;
5063 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5064     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5065     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   129   120   135   188   NaN   NaN   NaN
5066     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN    96   189   NaN   NaN   130   NaN    95   NaN
5067     NaN   NaN   206   206   206   206   NaN   NaN   NaN   NaN   NaN   NaN   NaN    84    79   NaN
5068     NaN   206   255   255   255   255   198   197   NaN   NaN   NaN   NaN    83    79    76   NaN
5069     198   255   255   255   255   255   255   198   198   198   198   198   198   212   212   NaN
5070     198   255   255   255   255   255   255   255   255   255   255   255   198   157   197   NaN
5071     198   255   226   198   198   198   198   198   198   198   198   198   198   198   177   NaN
5072     198   255   198   218   255   255   255   255   255   255   255   255   255   255   161   NaN
5073     198   253   198   247   255   255   255   255   255   255   255   255   255   251   155   NaN
5074     198   226   201   255   255   255   255   255   255   255   255   255   231   206   165   NaN
5075     198   207   215   255   255   255   255   255   255   255   255   255   239   198   159   NaN
5076     198   198   240   255   255   255   255   255   255   255   255   255   222   157   159   NaN
5077     198   199   255   255   255   255   255   255   255   255   255   255   191   165   159   NaN
5078     NaN   165   165   165   165   165   165   165   165   165   165   165   165   159   159   NaN
5079     NaN   NaN   159   159   159   159   159   159   159   159   159   159   159   159   NaN   NaN]/255;
5080 
5081 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5082     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5083     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   145   137   149   195   NaN   NaN   NaN
5084     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   116   196   NaN   NaN   145   NaN   116   NaN
5085     NaN   NaN   162   162   162   162   NaN   NaN   NaN   NaN   NaN   NaN   NaN   107   105   NaN
5086     NaN   162   255   255   255   255   154   197   NaN   NaN   NaN   NaN   106   104   103   NaN
5087     154   255   255   255   255   255   255   154   154   154   154   154   154   208   208   NaN
5088     154   243   243   243   243   243   243   255   255   255   255   255   154   123   197   NaN
5089     154   235   193   154   154   154   154   154   154   154   154   154   154   154   137   NaN
5090     154   215   154   191   255   255   251   255   255   255   255   255   231   255   126   NaN
5091     154   213   154   240   255   255   255   255   255   255   255   255   199   249   123   NaN
5092     154   179   160   255   247   247   247   247   247   247   247   247   190   188   115   NaN
5093     154   162   184   255   235   235   235   235   235   235   235   231   186   154   169   NaN
5094     154   154   228   255   227   227   227   227   227   227   227   223   178   123   169   NaN
5095     154   156   255   215   215   215   215   215   215   215   215   215   153   115   169   NaN
5096     NaN   115   115   115   115   115   115   115   115   115   115   115   115   169   169   NaN
5097     NaN   NaN   169   169   169   169   169   169   169   169   169   169   169   169   NaN   NaN]/255;
5098 
5099 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5100     [NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
5101     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   166   161   170   202   NaN   NaN   NaN
5102     NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   149   205   NaN   NaN   166   NaN   148   NaN
5103     NaN   NaN    34    34    34    34   NaN   NaN   NaN   NaN   NaN   NaN   NaN   141   144   NaN
5104     NaN    34   255   255   255   255    25   197   NaN   NaN   NaN   NaN   142   145   147   NaN
5105     25   255   156   156   156   156   255    25    25    25    25    25    25   200   200   NaN
5106     25   156   140   140   140   140   140   255   255   255   255   255    25    26   197   NaN
5107     25   132    80    25    25    25    25    25    25    25    25    25    25    25    25   NaN
5108     25   132    25   108   255   255   247   255   255   255   255   255   132   255    25   NaN
5109     25   112    25   137   156   156   156   156   156   156   156   156    91   150    25   NaN
5110     25    67    33   165   148   148   148   148   148   148   148   148    83    92    13   NaN
5111     25    38    64   156   132   132   132   132   132   132   132   132    67    25   176   NaN
5112     25    26   122   156   124   124   124   124   124   124   124   124    67    26   176   NaN
5113     25    28   156   108   108   108   108   108   108   108   108   108    41    13   176   NaN
5114     NaN    13    13    13    13    13    13    13    13    13    13    13    13   176   176   NaN
5115     NaN   NaN   176   176   176   176   176   176   176   176   176   176   176   176   NaN   NaN]/255;
5116 
5117 <span class="comment">% Save data</span>
5118 idx = idx+1;
5119 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5120     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5121     NaN    0.6902    0.6902    0.6902    0.6902    0.6902    0.6274    0.6274    0.5647    0.5647    0.5647    0.5019    0.5019    0.4392    0.2510       NaN
5122     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.3137    0.3765    0.2510    0.4670
5123     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.2510    0.1882    0.2510    0.4670
5124     NaN    0.6274    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.1882    0.5019    0.2510    0.4670
5125     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.1882    0.4392    0.2510    0.4670
5126     NaN    0.6274    0.7529    0.4392    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.1255    0.3765    0.2510    0.4670
5127     NaN    0.5647    0.7529    0.3765    1.0000    1.0000    0.9412    0.9412    0.8784    0.8157    0.7529    0.7529    0.0627    0.3765    0.2510    0.4670
5128     NaN    0.5647    0.7529    0.6902    0.3765    0.3137    0.3137    0.2510    0.1882    0.1882    0.1255    0.0627    0.3765    0.3137    0.2510    0.4670
5129     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5019    0.5019    0.5019    0.4392    0.4392    0.3765    0.3137    0.3137    0.2510    0.4670
5130     NaN    0.5019    0.6902    0.6274    0.5647    0.3137    0.3137    0.3137    0.3137    0.3137    0.3765    0.3137    0.3137    0.2510    0.2510    0.4670
5131     NaN    0.4392    0.6274    0.5647    0.5019    0.3137       NaN    0.1882    0.8157    0.8157    0.3765    0.2510    0.2510    0.2510    0.2510    0.4670
5132     NaN    0.4392    0.6274    0.5019    0.5019    0.3137    0.1882    0.4392    0.8784    0.8784    0.4392    0.1882    0.2510    0.1882    0.2510    0.4670
5133     NaN    0.4392    0.5647    0.5019    0.1255    0.1255    0.6902    0.6902    0.7529    0.7529    0.3137    0.1882    0.1882    0.1882    0.2510    0.4670
5134     NaN    0.7333    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.2510    0.4670
5135     NaN       NaN    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670    0.4670];
5136 
5137 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5138     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5139     NaN    0.7216    0.7216    0.6902    0.6902    0.6588    0.6274    0.5961    0.5647    0.5647    0.5333    0.5019    0.4706    0.4706    0.2196       NaN
5140     NaN    0.6902    0.7529    0.5647    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.3451    0.3451    0.2196    0.5378
5141     NaN    0.6902    0.7529    0.5333    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.3137    0.1882    0.2196    0.5378
5142     NaN    0.6588    0.7529    0.5019    1.0000    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.3137    0.4706    0.2196    0.5378
5143     NaN    0.6274    0.7529    0.4706    1.0000    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.2824    0.4392    0.2196    0.5378
5144     NaN    0.5961    0.7529    0.4392    1.0000    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.2510    0.4078    0.2196    0.5378
5145     NaN    0.5647    0.7529    0.4078    1.0000    1.0000    0.9725    0.9412    0.9098    0.8470    0.8157    0.7843    0.2196    0.3765    0.2196    0.5378
5146     NaN    0.5333    0.7216    0.7216    0.3765    0.3765    0.3451    0.3137    0.3137    0.2824    0.2510    0.2196    0.3765    0.3451    0.2196    0.5378
5147     NaN    0.5019    0.6902    0.6902    0.6274    0.5647    0.5333    0.5019    0.4706    0.4392    0.4078    0.3765    0.3451    0.3137    0.2196    0.5378
5148     NaN    0.4706    0.6588    0.6274    0.5647    0.3451    0.3451    0.3451    0.3451    0.3765    0.4078    0.3451    0.3137    0.2824    0.2196    0.5378
5149     NaN    0.4706    0.6274    0.5647    0.5333    0.3451       NaN    0.2510    0.8470    0.8784    0.4706    0.2824    0.2824    0.2510    0.2196    0.5378
5150     NaN    0.4392    0.5961    0.5333    0.5019    0.3451    0.2510    0.4706    0.8784    0.9098    0.5019    0.2510    0.2510    0.2510    0.2196    0.5378
5151     NaN    0.4078    0.5647    0.5019    0.2824    0.1882    0.7216    0.7216    0.7529    0.7843    0.3137    0.2510    0.2510    0.2196    0.2196    0.5378
5152     NaN    0.7176    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.2196    0.5378
5153     NaN       NaN    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378    0.5378];
5154 
5155 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5156     [NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN       NaN
5157     NaN    0.9412    0.9412    0.9412    0.9412    0.9412    0.9412    0.8784    0.8784    0.8784    0.8784    0.8784    0.8157    0.8157    0.4392       NaN
5158     NaN    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.7529    0.6902    0.4392    0.5997
5159     NaN    0.9412    1.0000    0.9412    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.7529    0.3765    0.4392    0.5997
5160     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.6902    0.8784    0.4392    0.5997
5161     NaN    0.9412    1.0000    0.8784    1.0000    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.6902    0.8157    0.4392    0.5997
5162     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.6274    0.8157    0.4392    0.5997
5163     NaN    0.8784    1.0000    0.8157    1.0000    1.0000    1.0000    0.9412    0.9412    0.9412    0.8784    0.8784    0.6274    0.7529    0.4392    0.5997
5164     NaN    0.8784    1.0000    1.0000    0.8157    0.7529    0.7529    0.7529    0.6902    0.6902    0.6274    0.6274    0.7529    0.7529    0.4392    0.5997
5165     NaN    0.8784    1.0000    1.0000    1.0000    0.9412    0.9412    0.8784    0.8784    0.8157    0.8157    0.7529    0.7529    0.6902    0.4392    0.5997
5166     NaN    0.8157    1.0000    1.0000    0.9412    0.4392    0.4392    0.4392    0.4392    0.4392    0.5019    0.7529    0.6902    0.6902    0.4392    0.5997
5167     NaN    0.8157    1.0000    0.9412    0.9412    0.4392       NaN    0.2510    0.9412    0.9412    0.5019    0.6902    0.6902    0.6274    0.4392    0.5997
5168     NaN    0.8157    1.0000    0.9412    0.8784    0.4392    0.2510    0.5647    0.9412    0.9412    0.5647    0.6274    0.6274    0.6274    0.4392    0.5997
5169     NaN    0.8157    0.9412    0.8784    0.6902    0.2510    0.7529    0.7529    0.8157    0.8157    0.3137    0.6274    0.6274    0.6274    0.4392    0.5997
5170     NaN    0.8275    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.4392    0.5997
5171     NaN       NaN    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997    0.5997];
5172 
5173 <span class="comment">% Plotting parameters</span>
5174 idx = idx+1;
5175 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5176     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5177     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5178     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5179     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5180     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5181     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5182     0   101   239   255   224   109   255   255   255   247    79   254   254   123    36   165
5183     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5184     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5185     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5186     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5187     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5188     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5189     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5190     0     0     0     1     0     0     0     0     0     0     0     0     0     0     0   165
5191     255   165   165   165   172   165   165   165   165   165   165   165   165   165   165   165]/255;
5192 
5193 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5194     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
5195     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0     0
5196     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5197     0   255   203    79   213   255   255   255   255   255   254   160   109   247     0   165
5198     0   254    71   224    79   255   255   255   255   255   211   101   165   123     0   165
5199     0   191   123   255   123   203   255   255   255   255   101   224   254    79     0   165
5200     0   101   239   255   224   109   255   255   255   247    79   254   254   123     0   165
5201     0   123   254   255   255    79   247   255   255   165   165   255   255   224     0   165
5202     0   255   255   255   254   160   173   255   255    87   239   255   255   255     0   165
5203     0   255   255   255   255   224   101   255   239    87   255   255   255   255     0   165
5204     0   255   255   255   255   255   101   224   123   191   255   255   255   255     0   165
5205     0   255   255   255   255   254   224    54   101   255   255   255   255   255     0   165
5206     0   255   255   255   255   255   255   247   255   255   255   255   255   255     0   165
5207     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   165
5208     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   165
5209     0   165   165   165   153   165   165   165   165   165   165   165   165   165   165   165]/255;
5210 
5211 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5212     [  0     0     0     0     0     0     0     0     0     0     0     0     0     0     0   255
5213     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5214     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5215     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5216     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5217     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5218     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5219     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5220     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5221     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5222     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5223     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5224     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5225     0   255   255   255   255   255   255   255   255   255   255   255   255   255     0   145
5226     0    24    39     0     0     0     0     0     0     0     0     0     0     0     0   145
5227     255   145   145   145   134   145   145   145   145   145   145   145   145   145   145   145]/255;
5228 
5229 <span class="comment">% Processing parameters</span>
5230 idx = idx+1;
5231 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5232     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5233     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5234     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5235     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5236     255     0   255   255   107   255   255   107   255   255   107   255   107   255     0   255
5237     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5238     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5239     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5240     255     0   255   255   107   255   107   255   107   255   255   107   255   255     0   255
5241     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5242     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5243     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5244     255     0   255   107   255   107   255   107   255   255   107   255   107   255     0   255
5245     255     0   255   255   107   255   255   107   255   255   255   107   255   255     0   255
5246     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5247     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5248 
5249 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5250     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5251     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5252     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5253     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5254     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5255     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5256     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5257     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5258     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5259     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5260     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5261     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5262     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5263     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5264     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5265     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5266 
5267 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5268     [255   255   255   255   255   255   255   255   255   255   255   255   255   255   255   255
5269     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255
5270     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5271     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5272     255     0   255   255    99   255   255    99   255   255    99   255    99   255     0   255
5273     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5274     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5275     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5276     255     0   255   255    99   255    99   255    99   255   255    99   255   255     0   255
5277     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5278     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5279     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5280     255     0   255    99   255    99   255    99   255   255    99   255    99   255     0   255
5281     255     0   255   255    99   255   255    99   255   255   255    99   255   255     0   255
5282     255     0   255   255   255   255   255   255   255   255   255   255   255   255     0   255
5283     255     0     0     0   255   255   255   255   255   255   255   255     0     0     0   255]/255;
5284 
5285 <span class="comment">% Export bathymetry dialog</span>
5286 idx = idx+1;
5287 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5288     [226    226    226    226    226    226    226    197    220    226    226    226    226    226    226    226
5289     226    226    226    226    226    227    241    144    158    241    228    228    229    228    229    226
5290     226    243    243    243    237    237    246    164    119    242    232    225    226    218    243    206
5291     179    152    153    166    148    148    177    179    63    185    141    146    154    151    179    189
5292     167    4    134    175    151    164    161    198    122    255    212    233    215    199    140    185
5293     134    50    209    241    255    255    133    118    15    20    28    94    4    0    0    89
5294     136    0    0    0    0    0    0    0    0    0    0    0    0    21    56    140
5295     208    255    226    233    255    242    215    232    251    237    226    233    207    222    156    139
5296     172    159    152    153    166    145    178    147    169    164    161    163    154    153    128    135
5297     160    164    148    139    171    150    165    154    165    185    166    173    190    190    148    162
5298     214    233    211    203    217    212    217    238    202    236    213    222    230    224    184    184
5299     219    206    174    190    219    204    201    218    183    224    219    222    217    202    176    182
5300     210    182    183    214    225    220    203    229    175    217    220    220    222    212    184    185
5301     197    175    207    224    223    220    205    231    170    221    220    220    222    217    191    187
5302     186    193    223    224    220    201    203    228    171    224    218    220    222    215    190    187
5303     189    211    220    216    204    201    214    213    187    213    216    220    220    212    193    189
5304     ]/255;
5305 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5306     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5307     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5308     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5309     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5310     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5311     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5312     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5313     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5314     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5315     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5316     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5317     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5318     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5319     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5320     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5321     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5322     ]/255;
5323 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5324     [233    233    233    233    233    233    233    204    227    233    233    233    233    233    233    233
5325     233    233    233    233    233    234    247    152    167    247    235    234    235    234    236    233
5326     233    242    242    240    236    237    247    170    131    243    234    231    234    224    245    212
5327     208    193    199    209    196    196    211    197    100    211    194    196    200    199    202    196
5328     205    19    179    199    183    197    182    179    162    255    217    246    234    231    191    199
5329     167    47    229    240    255    252    139    154    87    86    99    139    79    46    23    121
5330     175    30    47    29    28    19    5    41    33    39    54    55    65    83    81    185
5331     236    255    249    253    255    251    240    255    235    255    247    252    233    245    204    190
5332     208    200    195    196    204    192    214    202    144    215    201    201    195    195    177    186
5333     200    201    189    183    206    192    204    210    111    231    209    214    222    223    199    209
5334     245    255    251    247    254    254    252    255    156    255    254    255    255    254    235    232
5335     249    244    227    237    247    244    242    255    132    239    254    250    247    244    228    231
5336     245    231    231    246    253    249    243    255    119    223    255    251    250    245    229    232
5337     239    227    244    251    251    248    244    255    110    217    255    250    251    246    233    233
5338     233    237    250    252    249    242    246    255    115    209    255    250    251    246    232    232
5339     234    245    249    247    242    242    246    231    154    192    246    249    249    245    234    233
5340     ]/255;
5341 
5342 <span class="comment">% Export Figures Dialog</span>
5343 idx = idx + 1;
5344 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5345     [NaN    NaN    10    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5346     NaN    NaN    67    255    255    255    255    255    255    255    201    141    NaN    NaN    NaN    NaN
5347     NaN    NaN    43    255    241    240    241    246    252    255    186    220    151    NaN    NaN    NaN
5348     NaN    NaN    42    255    238    237    237    236    238    254    210    178    214    38    NaN    NaN
5349     NaN    NaN    43    255    241    241    241    241    240    244    252    255    255    79    NaN    NaN
5350     NaN    NaN    47    255    232    232    225    224    224    223    220    238    255    69    NaN    NaN
5351     NaN    NaN    55    233    114    225    230    223    221    221    215    237    255    67    NaN    NaN
5352     4    NaN    37    181    168    126    193    214    205    200    203    242    255    67    NaN    NaN
5353     41    164    134    153    144    139    131    209    238    223    242    240    255    67    NaN    NaN
5354     41    118    91    91    122    125    120    106    170    241    245    241    255    67    NaN    NaN
5355     41    113    91    89    97    108    99    89    117    205    190    230    255    67    NaN    NaN
5356     41    124    94    88    78    74    81    179    255    252    244    241    255    67    NaN    NaN
5357     13    34    76    187    88    92    222    255    255    250    250    250    255    73    NaN    NaN
5358     NaN    NaN    69    236    121    227    255    243    238    238    238    238    255    82    NaN    NaN
5359     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5360 
5361 
5362 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5363     [NaN    NaN    10    24    24    24    24    24    24    24    22    4    NaN    NaN    NaN    NaN
5364     NaN    NaN    69    255    255    255    255    255    255    255    204    144    NaN    NaN    NaN    NaN
5365     NaN    NaN    45    255    241    240    241    246    252    255    189    222    155    NaN    NaN    NaN
5366     NaN    NaN    43    255    238    237    237    236    238    254    210    179    215    39    NaN    NaN
5367     NaN    NaN    44    255    241    241    241    241    240    244    252    255    255    80    NaN    NaN
5368     NaN    NaN    49    255    231    230    225    224    224    223    220    238    255    70    NaN    NaN
5369     NaN    NaN    56    227    136    214    227    223    221    221    215    237    255    68    NaN    NaN
5370     4    NaN    19    157    243    154    181    210    204    200    203    242    255    67    NaN    NaN
5371     51    255    231    225    219    217    172    197    232    222    242    240    255    67    NaN    NaN
5372     52    227    184    183    195    201    204    172    169    239    245    241    255    67    NaN    NaN
5373     51    218    177    177    180    187    187    177    130    202    190    230    255    67    NaN    NaN
5374     51    237    195    183    172    170    152    175    255    251    244    241    255    67    NaN    NaN
5375     15    38    72    173    183    149    211    255    255    250    250    250    255    73    NaN    NaN
5376     NaN    NaN    65    226    174    214    252    242    238    238    238    238    255    84    NaN    NaN
5377     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5378 
5379 
5380 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5381     [NaN    NaN    9    23    23    23    23    23    23    23    21    3    NaN    NaN    NaN    NaN
5382     NaN    NaN    66    255    255    255    255    255    255    255    196    139    NaN    NaN    NaN    NaN
5383     NaN    NaN    42    255    239    238    238    244    252    255    186    216    148    NaN    NaN    NaN
5384     NaN    NaN    41    255    236    235    235    234    237    251    210    176    212    36    NaN    NaN
5385     NaN    NaN    42    255    239    239    239    239    238    241    252    255    255    78    NaN    NaN
5386     NaN    NaN    46    255    233    232    224    223    223    223    219    235    255    67    NaN    NaN
5387     NaN    NaN    53    240    101    232    230    221    219    218    213    235    255    65    NaN    NaN
5388     5    NaN    60    212    94    107    205    215    203    198    201    240    255    66    NaN    NaN
5389     34    56    40    80    70    62    94    222    241    221    240    238    255    66    NaN    NaN
5390     35    10    2    0    51    55    36    46    176    240    243    239    255    66    NaN    NaN
5391     35    11    9    7    16    34    12    6    110    204    188    228    255    66    NaN    NaN
5392     35    14    0    0    0    0    14    187    255    251    242    239    255    66    NaN    NaN
5393     12    37    84    206    0    41    234    255    255    248    248    248    255    72    NaN    NaN
5394     NaN    NaN    69    249    79    239    255    240    236    236    236    236    255    80    NaN    NaN
5395     NaN    NaN    NaN    0    0    0    0    0    0    0    0    0    0    0    NaN    NaN]/255;
5396 
5397 <span class="comment">% Export Excel File</span>
5398 idx = idx + 1;
5399 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5400     [NaN    NaN    NaN    NaN    NaN    NaN  106  252  255  255  255  255  255  255  255  255
5401    38  136  109  101   96   77   95  134  106   99   93   87   90   66  255  255
5402    52  197  232  217  210  202  191  178  170  164  160  159  155   15  255  255
5403    51  181  255  255  255  255  255  255  255  255  255  255  253    9  255  255
5404    49  174  245  153  156  175  255  255  181  153  149  205  245    0  255  255
5405    47  168  199  122  149  100  155  183   99   99   15  117  245    0  255  241
5406    45  158  255  146  146  141   87   68  120   34   86  255  238    0  252  232
5407    42  144  255  255  158  158  143   74   68  117  255  255  230    0  255  255
5408    40  134  255  255  169   15  150  111   68   81  105  167  236    0  230  217
5409    37  131  255  158   99  106   10  143  117   50   51  165  252    0  255  254
5410    35  122  208    0   22   32    8   17  110   20    0   13  212    0  255  245
5411    33  115  255  255  255  255  255  250  146  113  119  106  217    0  236  217
5412    31  109  255  254  252  251  250  255  255  255  255  255  241    0  255  251
5413    29  116  190  168  164  157  145  133  126  121  117  118  112    0  215  205
5414    20   63   47   38   36   20   38   83   64   51   52   55   64   20  255  241
5415     NaN    NaN    NaN    NaN    NaN    NaN   96  249  252  228  237  251  249  203  241  246]/255;
5416 
5417 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5418     [NaN    NaN    NaN    NaN    NaN    NaN  114  252  255  255  255  255  255  255  255  255
5419    49  180  152  145  140  118  140  173  150  139  132  126  126  106  255  255
5420    67  249  252  242  237  231  221  207  201  196  194  193  193   75  255  255
5421    66  232  255  255  255  255  255  255  255  255  255  255  255   68  255  255
5422    64  226  251  197  191  200  255  255  194  170  168  214  253   61  255  255
5423    62  220  224  183  207  173  189  202  167  175  116  172  253   58  255  246
5424    60  211  255  190  196  203  166  131  187  134  148  255  249   54  254  240
5425    57  199  255  255  198  203  202  158  132  168  255  255  245   47  255  255
5426    54  190  255  255  200  110  199  185  155  147  160  203  251   44  240  230
5427    52  187  255  204  187  194  121  204  189  139   99  179  255   39  255  254
5428    49  180  230   42   49   53   36   64  182   98   65   70  228   36  255  248
5429    47  171  255  255  255  255  255  255  186  115  124  114  235   34  243  229
5430    45  166  255  255  254  254  255  255  255  255  255  255  255   33  255  252
5431    43  176  222  206  204  200  190  180  174  171  169  169  169   32  229  220
5432    30  101   81   74   69   54   72  116   96   84   84   84   94   55  255  245
5433     NaN    NaN    NaN    NaN    NaN    NaN  105  251  253  237  242  252  251  218  246  249]/255;
5434 
5435 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5436     [ NaN    NaN    NaN    NaN    NaN    NaN  125  253  255  255  255  255  255  255  255  255
5437    34  118   92   84   79   56   83  111   88   79   73   69   74   45  255  255
5438    46  180  228  207  203  195  182  169  159  155  149  149  145    0  255  255
5439    45  163  255  255  255  255  255  255  255  255  255  255  254    0  255  255
5440    42  156  248  152  155  176  255  255  181  154  147  206  245    0  255  255
5441    40  150  202  117  136   87  154  181   90   84    8  120  243    0  255  252
5442    38  138  255  145  137  131   81   65  106   27   86  255  238    0  255  250
5443    35  122  255  255  159  152  137   75   62  121  255  255  229    0  255  255
5444    33  113  255  255  171   13  145  111   67   76   84  159  234    0  255  247
5445    30  109  255  160   89   97   10  136  111   36   33  159  251    0  255  255
5446    28   99  211    0   12   23    2   11  101    0    0   13  209    0  255  253
5447    26   92  255  255  255  255  255  250  146  111  117  104  213    0  255  245
5448    23   89  255  255  255  255  255  255  255  255  255  255  241    0  255  254
5449    22   93  180  156  151  141  129  114  105   98   93   93   83    0  255  239
5450    15   43   26   17   15    0   25   63   45   39   38   39   44    9  255  252
5451     NaN    NaN    NaN    NaN    NaN    NaN  117  253  255  249  251  255  254  239  252  254]/255;
5452 
5453 <span class="comment">% Zoom In</span>
5454 idx = idx + 1;
5455 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5456     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.196078431372549,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.196078431372549,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.803921568627451,0.803921568627451,0.196078431372549,0.619592584115358,0.607843137254902,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.196078431372549,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,1,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,0.666651407644770,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5457 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5458     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.274509803921569,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.274509803921569,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.862729839017319,0.862729839017319,0.274509803921569,0.815671015487907,0.803921568627451,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.274509803921569,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,0.615686274509804,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,0.674494544899672,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5459 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5460     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.470588235294118,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.470588235294118,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.917631799801633,0.917631799801633,0.470588235294118,0.945098039215686,0.949004348821241,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.470588235294118,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,0.180392156862745,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,0.780392156862745,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5461 
5462 <span class="comment">% Zoom Out</span>
5463 idx = idx + 1;
5464 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5465     [NaN,NaN,0.745082780193790,0.603906309605554,0.603906309605554,0.603906309605554,0.603906309605554,0.568627450980392,0.764705882352941,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,0.698023956664378,0.568627450980392,0.780392156862745,0.823514152742809,0.854886701762417,0.925474937056535,0.827450980392157,0.596063172350652,0.749019607843137,NaN,NaN,NaN,NaN,NaN,NaN;0.752925917448692,0.501945525291829,0.737239642938888,0.643121995880064,0.584313725490196,0.690180819409476,0.760769054703594,1,0.894102388036927,0.596063172350652,NaN,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.639215686274510,0.650965133134966,0.600000000000000,0.596063172350652,0.643121995880064,0.596063172350652,0.764705882352941,0.941161211566339,0.721553368429084,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.686274509803922,0.678431372549020,0.682337682154574,0.662745098039216,0.650965133134966,0.650965133134966,0.639215686274510,0.788235294117647,0.811764705882353,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.764705882352941,0.815671015487907,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.196078431372549,0.682337682154574,0.815671015487907,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.603906309605554,0.866666666666667,0.952941176470588,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.760769054703594,0.737239642938888,0.741176470588235,0.603906309605554,NaN,NaN,NaN,NaN,NaN;0.682337682154574,0.721553368429084,1,1,0.968627450980392,0.870572976272221,0.709803921568628,0.670588235294118,0.807827878233005,0.564690623331045,0.772549019607843,NaN,NaN,NaN,NaN,NaN;NaN,0.592156862745098,0.839200427252613,1,1,0.901945525291829,0.788235294117647,0.792141603723201,0.549004348821241,0.654901960784314,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,0.639215686274510,0.698023956664378,0.827450980392157,0.784298466468299,0.650965133134966,0.498054474708171,0.623529411764706,0.627435721370260,0.890196078431373,0.937254901960784,0.996063172350652,NaN,NaN,NaN;NaN,NaN,NaN,0.772549019607843,0.698023956664378,0.678431372549020,0.690180819409476,0.784298466468299,NaN,0.615686274509804,0.745082780193790,1,0.933318074311437,0.996063172350652,NaN,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.517631799801633,0.745082780193790,1,0.929411764705882,1,NaN;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.513725490196078,0.741176470588235,1,0.925474937056535,0.749019607843137;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.705867093919280,0.513725490196078,0.741176470588235,0.988220035095750,0.745082780193790;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.701960784313725,0.533318074311437,0.549004348821241,0.654901960784314;NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.694117647058824,0.635278858625162,NaN;];
5466 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5467     [1,1,0.745082780193790,0.670588235294118,0.670588235294118,0.670588235294118,0.670588235294118,0.576470588235294,0.760769054703594,1,1,1,1,1,1,1;1,0.701960784313725,0.650965133134966,0.917631799801633,0.968627450980392,0.992156862745098,1,0.898039215686275,0.603906309605554,0.741176470588235,1,1,1,1,1,1;0.756862745098039,0.588220035095750,0.929411764705882,0.858823529411765,0.807827878233005,0.854886701762417,0.894102388036927,1,0.976470588235294,0.596063172350652,1,1,1,1,1,1;0.721553368429084,0.823514152742809,0.878416113527123,0.835294117647059,0.831357289997711,0.843137254901961,0.815671015487907,0.894102388036927,1,0.807827878233005,0.670588235294118,1,1,1,1,1;0.670588235294118,0.901945525291829,0.890196078431373,0.890196078431373,0.878416113527123,0.870572976272221,0.854886701762417,0.831357289997711,0.937254901960784,0.933318074311437,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.937254901960784,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.274509803921569,0.878416113527123,0.937254901960784,0.670588235294118,1,1,1,1,1;0.670588235294118,0.937254901960784,0.988220035095750,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.819607843137255,0.921568627450980,0.854886701762417,0.670588235294118,1,1,1,1,1;0.721553368429084,0.737239642938888,1,1,0.988220035095750,0.952941176470588,0.898039215686275,0.882352941176471,0.980376897840848,0.627435721370260,0.768612191958496,1,1,1,1,1;1,0.603906309605554,0.847043564507515,1,1,0.984313725490196,0.960784313725490,0.976470588235294,0.662745098039216,0.658808270389868,1,1,1,1,1,1;1,1,0.650965133134966,0.701960784313725,0.854886701762417,0.874509803921569,0.780392156862745,0.564690623331045,0.615686274509804,0.627435721370260,0.733333333333333,0.713710231174182,0.600000000000000,1,1,1;1,1,1,0.772549019607843,0.705867093919280,0.686274509803922,0.694117647058824,0.784298466468299,1,0.572533760585946,0.498054474708171,0.741176470588235,0.709803921568628,0.600000000000000,1,1;1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.509788662546731,0.741176470588235,0.709803921568628,0.600000000000000,1;1,1,1,1,1,1,1,1,1,1,0.701960784313725,0.439215686274510,0.505882352941176,0.741176470588235,0.721553368429084,0.501945525291829;1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.443152513923857,0.505882352941176,0.733333333333333,0.670588235294118;1,1,1,1,1,1,1,1,1,1,1,1,0.705867093919280,0.454901960784314,0.435309376668956,0.658808270389868;1,1,1,1,1,1,1,1,1,1,1,1,1,0.694117647058824,0.647058823529412,1;];
5468 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5469     [1,1,0.796078431372549,0.854886701762417,0.854886701762417,0.854886701762417,0.854886701762417,0.713710231174182,0.792141603723201,1,1,1,1,1,1,1;1,0.768612191958496,0.827450980392157,0.956847486076143,0.976470588235294,0.992156862745098,1,0.945098039215686,0.803921568627451,0.796078431372549,1,1,1,1,1,1;0.776455329213397,0.749019607843137,0.952941176470588,0.901945525291829,0.882352941176471,0.909788662546731,0.937254901960784,1,0.988220035095750,0.819607843137255,1,1,1,1,1,1;0.858823529411765,0.882352941176471,0.909788662546731,0.882352941176471,0.886259250782025,0.894102388036927,0.882352941176471,0.933318074311437,1,0.921568627450980,0.854886701762417,1,1,1,1,1;0.854886701762417,0.925474937056535,0.909788662546731,0.913725490196078,0.905882352941177,0.901945525291829,0.901945525291829,0.894102388036927,0.960784313725490,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.945098039215686,0.949004348821241,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.470588235294118,0.921568627450980,0.968627450980392,0.854886701762417,1,1,1,1,1;0.854886701762417,0.952941176470588,0.992156862745098,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.890196078431373,0.941161211566339,0.937254901960784,0.854886701762417,1,1,1,1,1;0.858823529411765,0.827450980392157,1,1,0.992156862745098,0.964690623331045,0.921568627450980,0.909788662546731,0.980376897840848,0.823514152742809,0.792141603723201,1,1,1,1,1;1,0.717647058823529,0.925474937056535,1,1,0.980376897840848,0.960784313725490,0.976470588235294,0.815671015487907,0.776455329213397,1,1,1,1,1,1;1,1,0.776455329213397,0.870572976272221,0.941161211566339,0.937254901960784,0.866666666666667,0.717647058823529,0.682337682154574,0.607843137254902,0.490211337453269,0.435309376668956,0.203921568627451,1,1,1;1,1,1,0.799984740978103,0.796078431372549,0.792141603723201,0.764705882352941,0.792141603723201,1,0.545098039215686,0.125490196078431,0.325505455100328,0.450995651178759,0.203921568627451,1,1;1,1,1,1,1,1,1,1,1,0.784298466468299,0.384313725490196,0.149019607843137,0.325505455100328,0.458838788433661,0.180392156862745,1;1,1,1,1,1,1,1,1,1,1,0.796078431372549,0.396093690394446,0.149019607843137,0.329411764705882,0.458838788433661,0.254917219806210;1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.407843137254902,0.149019607843137,0.298039215686275,0.580376897840848;1,1,1,1,1,1,1,1,1,1,1,1,0.803921568627451,0.403936827649348,0.258823529411765,0.674494544899672;1,1,1,1,1,1,1,1,1,1,1,1,1,0.749019607843137,0.654901960784314,1;];
5470 
5471 <span class="comment">% Pan</span>
5472 idx = idx + 1;
5473 icons(idx).data(:,:,1) = <span class="keyword">...</span>
5474     [NaN,NaN,NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN,NaN,NaN,NaN;NaN,NaN,NaN,0.290196078431373,0.290196078431373,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,0.290196078431373,NaN,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,NaN,NaN;NaN,NaN,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,NaN,0.290196078431373,NaN;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,0.290196078431373;NaN,NaN,NaN,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373,1,1,0.290196078431373;NaN,0.290196078431373,0.290196078431373,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.290196078431373,1,0.991546501869230,0.290196078431373;0.290196078431373,1,1,0.290196078431373,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.290196078431373;0.290196078431373,1,1,1,0.290196078431373,1,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968841077286946,0.290196078431373,NaN;NaN,0.290196078431373,1,1,1,1,1,1,1,0.996032654306859,0.986602578774701,0.975188830395972,0.962127107652400,0.947631036850538,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,1,1,0.991546501869230,0.981109330891890,0.968871595330739,0.955046921492332,0.939909971770810,0.923643854428931,0.290196078431373,NaN;NaN,NaN,0.290196078431373,1,1,1,0.996063172350652,0.986572060730907,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915190356298161,0.290196078431373,NaN,NaN;NaN,NaN,NaN,0.290196078431373,1,0.991546501869230,0.981109330891890,0.968841077286946,0.955016403448539,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.290196078431373,NaN,NaN;NaN,NaN,NaN,NaN,0.290196078431373,0.975188830395972,0.962127107652400,0.947631036850538,0.931914244296941,0.915220874341955,0.897734035248341,0.879728389410239,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.939909971770810,0.923643854428931,0.906553749904631,0.888761730373083,0.870634012359808,0.852231631952392,0.290196078431373,NaN,NaN,NaN;NaN,NaN,NaN,NaN,NaN,0.290196078431373,0.915190356298161,0.897734035248341,0.879758907454032,0.861478599221790,0.843076218814374,0.824887464713512,0.290196078431373,NaN,NaN,NaN;];
5475 icons(idx).data(:,:,2) = <span class="keyword">...</span>
5476     [0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894071869993134,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894071869993134,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.882536049439231,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.407843137254902;0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860105287251087,0.842221713588159,0.822354467078660,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.894102388036927,0.882566567483024,0.868223086900130,0.851468680857557,0.832516975661860,0.811795223926146,0.789547570000763,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.894102388036927,0.894102388036927,0.888700694285496,0.875730525673304,0.860135805294881,0.842221713588159,0.822354467078660,0.800839246204318,0.777950713359274,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.894102388036927,0.882536049439231,0.868223086900130,0.851438162813764,0.832516975661860,0.811764705882353,0.789547570000763,0.766079194323644,0.741756313420310,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.860135805294881,0.842252231631952,0.822384985122454,0.800808728160525,0.777920195315480,0.754024567025254,0.729396505683986,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.811764705882353,0.789547570000763,0.766079194323644,0.741786831464103,0.716914625772488,0.691676203555352,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902,0.777920195315480,0.754024567025254,0.729396505683986,0.704371709773404,0.679133287556268,0.654261081864653,0.407843137254902,0.407843137254902,0.407843137254902,0.407843137254902;];
5477 icons(idx).data(:,:,3) = <span class="keyword">...</span>
5478     [0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.709803921568628,0.799954222934310,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799954222934310,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.709803921568628,0.799984740978103,0.785091935606928,0.709803921568628;0.709803921568628,0.799954222934310,0.799984740978103,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756130312046998,0.709803921568628;0.709803921568628,0.799984740978103,0.799954222934310,0.799984740978103,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766628519111925,0.744960708018616,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799954222934310,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776272220950637,0.756160830090791,0.733089188982986,0.707423514152743,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.799984740978103,0.785091935606928,0.766598001068132,0.744960708018616,0.720546272983902,0.693781948577096,0.665094987411307,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.799984740978103,0.799984740978103,0.792996108949416,0.776241702906844,0.756160830090791,0.733089188982986,0.707423514152743,0.679682612344549,0.650141145952545,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.799984740978103,0.785061417563134,0.766598001068132,0.744960708018616,0.720546272983902,0.693812466620890,0.665094987411307,0.634882124055848,0.603479056992447,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.756160830090791,0.733089188982986,0.707423514152743,0.679652094300755,0.650141145952545,0.619287403677424,0.587518120088502,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.693781948577096,0.665094987411307,0.634882124055848,0.603509575036240,0.571404592965591,0.538872358281834,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628,0.650141145952545,0.619256885633631,0.587518120088502,0.555230029755093,0.522697795071336,0.490638590066377,0.709803921568628,0.709803921568628,0.709803921568628,0.709803921568628;];
5479 <span class="comment">% [EOF] getIcons</span>
5480 
5481 <a name="_sub110" href="#_subfunctions" class="code">function guiparams = createGUIparams</a>
5482 <span class="comment">% Creates the guiparams structure with specified defaults.</span>
5483 
5484 <span class="comment">% Check for any stored prefs</span>
5485 <span class="comment">% --------------------------</span>
5486 <span class="comment">% Units and the graphics renderer are stored as persistent prefs</span>
5487 guiprefs = getpref(<span class="string">'VMT'</span>);
5488 
5489 <span class="comment">% Organized by GUI panels</span>
5490 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5491 <span class="comment">% SHIPTRACKS PLOT %</span>
5492 <span class="comment">%%%%%%%%%%%%%%%%%%%</span>
5493 guiparams.horizontal_grid_node_spacing       = 1.0;
5494 guiparams.vertical_grid_node_spacing         = 0.4;
5495 
5496 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5497 <span class="comment">% CROSS SECTION PLOT %</span>
5498 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%</span>
5499 guiparams.contours                           = <span class="string">''</span>; <span class="comment">% Set below</span>
5500 guiparams.contour                            = <span class="string">''</span>; <span class="comment">% Set below</span>
5501 guiparams.idx_contour                        = 1;
5502 guiparams.vertical_exaggeration              = 10;
5503 guiparams.vector_scale_cross_section         = 0.2;
5504 guiparams.horizontal_vector_spacing          = 1;
5505 guiparams.vertical_vector_spacing            = 1;
5506 guiparams.horizontal_smoothing_window        = 1;
5507 guiparams.vertical_smoothing_window          = 1;
5508 guiparams.plot_secondary_flow_vectors        = true;
5509 guiparams.allow_vmt_flip_flux                = true;
5510 guiparams.secondary_flows                    = <span class="string">''</span>; <span class="comment">% Set below</span>
5511 guiparams.secondary_flow_vector_variable     = <span class="string">''</span>; <span class="comment">% Set below</span>
5512 guiparams.idx_secondary_flow_vector_variable = 1;
5513 guiparams.include_vertical_velocity          = true;
5514 
5515 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5516 <span class="comment">% PLAN VIEW PLOT %</span>
5517 <span class="comment">%%%%%%%%%%%%%%%%%%</span>
5518 guiparams.depth_range_min                    = 0;
5519 guiparams.depth_range_max                    = inf;
5520 guiparams.vector_scale_plan_view             = 1;
5521 guiparams.vector_spacing_plan_view           = 1;
5522 guiparams.smoothing_window_size              = 1;
5523 guiparams.display_shoreline                  = false;
5524 guiparams.add_background                     = false;
5525 
5526 <span class="comment">%%%%%%%%%%%</span>
5527 <span class="comment">% OFFSETS %</span>
5528 <span class="comment">%%%%%%%%%%%</span>
5529 guiparams.water_surface_elevation            = 0.0;
5530 guiparams.bed_elevation                      = 0.0;
5531 guiparams.KMZ_vertical_offset                = 0.0;
5532 
5533 <span class="comment">%%%%%%%%%%%%%%%</span>
5534 <span class="comment">% DATA EXPORT %</span>
5535 <span class="comment">%%%%%%%%%%%%%%%</span>
5536 guiparams.beam_angle                         = 20.0;
5537 guiparams.magnetic_variation                 = 0.0;
5538 <span class="comment">% guiparams.wse                                = guiparams.water_surface_elevation;</span>
5539 guiparams.load_wse_tide_file                 = false;
5540 guiparams.output_auxiliary_data              = false;
5541 
5542 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5543 <span class="comment">% Contour variables %</span>
5544 <span class="comment">%%%%%%%%%%%%%%%%%%%%%</span>
5545 idx = 1;
5546 guiparams.contours(idx).string   = <span class="string">'Streamwise Velocity (u)'</span>;
5547 guiparams.contours(idx).variable = <span class="string">'streamwise'</span>;
5548 idx = idx + 1;
5549 guiparams.contours(idx).string   = <span class="string">'Transverse Velocity (v)'</span>;
5550 guiparams.contours(idx).variable = <span class="string">'transverse'</span>;
5551 idx = idx + 1;
5552 guiparams.contours(idx).string   = <span class="string">'Vertical Velocity (w)'</span>;
5553 guiparams.contours(idx).variable = <span class="string">'vertical'</span>;
5554 idx = idx + 1;
5555 guiparams.contours(idx).string   = <span class="string">'Velocity Magnitude'</span>;
5556 guiparams.contours(idx).variable = <span class="string">'mag'</span>;
5557 idx = idx + 1;
5558 guiparams.contours(idx).string   = <span class="string">'East Velocity (E)'</span>;
5559 guiparams.contours(idx).variable = <span class="string">'east'</span>;
5560 idx = idx + 1;
5561 guiparams.contours(idx).string   = <span class="string">'North Velocity (N)'</span>;
5562 guiparams.contours(idx).variable = <span class="string">'north'</span>;
5563 idx = idx + 1;
5564 guiparams.contours(idx).string   = <span class="string">'Error Velocity'</span>;
5565 guiparams.contours(idx).variable = <span class="string">'error'</span>;
5566 idx = idx + 1;
5567 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (zsd)'</span>;
5568 guiparams.contours(idx).variable = <span class="string">'primary_zsd'</span>;
5569 idx = idx + 1;
5570 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (zsd)'</span>;
5571 guiparams.contours(idx).variable = <span class="string">'secondary_zsd'</span>;
5572 idx = idx + 1;
5573 guiparams.contours(idx).string   = <span class="string">'Primary Velocity (Roz)'</span>;
5574 guiparams.contours(idx).variable = <span class="string">'primary_roz'</span>;
5575 idx = idx + 1;
5576 guiparams.contours(idx).string   = <span class="string">'Secondary Velocity (Roz)'</span>;
5577 guiparams.contours(idx).variable = <span class="string">'secondary_roz'</span>;
5578 idx = idx + 1;
5579 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Downstream Comp.)'</span>;
5580 guiparams.contours(idx).variable = <span class="string">'primary_roz_x'</span>;
5581 idx = idx + 1;
5582 guiparams.contours(idx).string   = <span class="string">'Prim. Vel. (Roz, Cross-Stream Comp.)'</span>;
5583 guiparams.contours(idx).variable = <span class="string">'primary_roz_y'</span>;
5584 idx = idx + 1;
5585 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Downstream Comp.)'</span>;
5586 guiparams.contours(idx).variable = <span class="string">'secondary_roz_x'</span>;
5587 idx = idx + 1;
5588 guiparams.contours(idx).string   = <span class="string">'Sec. Vel. (Roz, Cross-Stream Comp.)'</span>;
5589 guiparams.contours(idx).variable = <span class="string">'secondary_roz_y'</span>;
5590 idx = idx + 1;
5591 guiparams.contours(idx).string   = <span class="string">'Backscatter'</span>;
5592 guiparams.contours(idx).variable = <span class="string">'backscatter'</span>;
5593 idx = idx + 1;
5594 guiparams.contours(idx).string   = <span class="string">'Flow Direction (deg.)'</span>;
5595 guiparams.contours(idx).variable = <span class="string">'flowangle'</span>;
5596 idx = idx + 1;
5597 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (v,w)'</span>;
5598 guiparams.contours(idx).variable = <span class="string">'vorticity_vw'</span>;
5599 idx = idx + 1;
5600 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (zsd)'</span>;
5601 guiparams.contours(idx).variable = <span class="string">'vorticity_zsd'</span>;
5602 idx = idx + 1;
5603 guiparams.contours(idx).string   = <span class="string">'Flow Vorticity (roz)'</span>;
5604 guiparams.contours(idx).variable = <span class="string">'vorticity_roz'</span>;
5605 
5606 guiparams.contour = guiparams.contours(guiparams.idx_contour).variable;
5607 
5608 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5609 <span class="comment">% Secondary Flow Vector Variables %</span>
5610 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5611 idx = 1;
5612 guiparams.secondary_flows(idx).string   = <span class="string">'Transverse'</span>;
5613 guiparams.secondary_flows(idx).variable = <span class="string">'transverse'</span>;
5614 idx = idx + 1;
5615 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (zsd)'</span>;
5616 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_zsd'</span>;
5617 idx = idx + 1;
5618 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz)'</span>;
5619 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz'</span>;
5620 idx = idx + 1;
5621 guiparams.secondary_flows(idx).string   = <span class="string">'Secondary (Roz, Cross-Stream Comp)'</span>;
5622 guiparams.secondary_flows(idx).variable = <span class="string">'secondary_roz_y'</span>;
5623 idx = idx + 1;
5624 guiparams.secondary_flows(idx).string   = <span class="string">'Primary (Roz, Cross-Stream Comp)'</span>;
5625 guiparams.secondary_flows(idx).variable  = <span class="string">'primary_roz_y'</span>;
5626 
5627 guiparams.secondary_flow_vector_variable = <span class="keyword">...</span>
5628     guiparams.secondary_flows(guiparams.idx_secondary_flow_vector_variable).variable;
5629 
5630 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5631 <span class="comment">% INTERNAL SETTINGS &amp; DEFAULTS %</span>
5632 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5633 <span class="comment">% Menu bar options</span>
5634 guiparams.presentation                       = true;
5635 guiparams.print                              = false;
5636 guiparams.set_cross_section_endpoints        = false;
5637 guiparams.unit_discharge_correction          = false;
5638 guiparams.start_bank                         = <span class="string">'auto'</span>;
5639 
5640 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'units'</span>)
5641     <span class="keyword">switch</span> guiprefs.units
5642         <span class="keyword">case</span> <span class="string">'metric'</span>
5643             guiparams.english_units          = false;
5644         <span class="keyword">case</span> <span class="string">'english'</span>
5645             guiparams.english_units          = true;
5646     <span class="keyword">end</span>
5647 <span class="keyword">else</span>
5648     guiparams.english_units                  = false;
5649 <span class="keyword">end</span>
5650 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'plotref'</span>)
5651     <span class="keyword">switch</span> guiprefs.plotref
5652         <span class="keyword">case</span> <span class="string">'dfs'</span>
5653             guiparams.plotref                 = <span class="string">'dfs'</span>;
5654         <span class="keyword">case</span> <span class="string">'hab'</span>
5655             guiparams.plotref                 = <span class="string">'hab'</span>;
5656     <span class="keyword">end</span>
5657 <span class="keyword">else</span>
5658     guiparams.plotref                         = <span class="string">'dfs'</span>;
5659 <span class="keyword">end</span>
5660 <span class="comment">% guiparams.eta                                 = guiparams.bed_elevation; % Used in HAB reference</span>
5661 <span class="comment">% guiparams.vertical_offset                     = guiparams.KMZ_vertical_offset;</span>
5662 
5663 <span class="keyword">if</span> ispref(<span class="string">'VMT'</span>,<span class="string">'renderer'</span>)
5664     guiparams.renderer                       = guiprefs.renderer;
5665 <span class="keyword">else</span>
5666     guiparams.renderer                       = <span class="string">'OpenGL'</span>;
5667 <span class="keyword">end</span>
5668 <span class="comment">% guiparams.plot_ship_tracks                   = false;</span>
5669 <span class="comment">% guiparams.plot_planview                      = false;</span>
5670 <span class="comment">% guiparams.plot_cross_section                 = false;</span>
5671 
5672 <span class="comment">% File location defaults</span>
5673 guiparams.ascii_path                        = pwd;
5674 guiparams.ascii_file                        = <span class="string">''</span>;
5675 guiparams.mat_path                          = pwd;
5676 guiparams.mat_file                          = <span class="string">''</span>;
5677 guiparams.tecplot_path                      = pwd;
5678 guiparams.tecplot_file                      = <span class="string">''</span>;
5679 guiparams.kmz_path                          = pwd;
5680 guiparams.kmz_file                          = <span class="string">''</span>;
5681 guiparams.multibeambathymetry_path          = pwd;
5682 guiparams.multibeambathymetry_file          = <span class="string">''</span>;
5683 guiparams.log_path                          = pwd;
5684 guiparams.log_file                          = <span class="string">''</span>;
5685 <span class="comment">% Avoids problems of not finding the MCR root when running as a standalone</span>
5686 <span class="comment">% application</span>
5687 <span class="keyword">if</span> isdeployed 
5688     guiparams.has_mapping_toolbox           = true;
5689 <span class="keyword">else</span>
5690     guiparams.has_mapping_toolbox               = <span class="keyword">...</span>
5691         ~isempty(dir(fullfile(matlabroot,<span class="string">'toolbox'</span>,<span class="string">'map'</span>)));
5692 <span class="keyword">end</span>
5693 
5694 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5695 <span class="comment">% IN MEMORY DATA STORAGE %</span>
5696 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
5697 guiparams.z                      = [];
5698 guiparams.A                      = [];
5699 guiparams.V                      = [];
5700 guiparams.Map                    = [];
5701 guiparams.savefile               = [];
5702 guiparams.iric_anv_planview_data = [];
5703 <span class="comment">% guiparams.zmin = []; % Don't need to store these?</span>
5704 <span class="comment">% guiparams.zmax = [];</span>
5705 <span class="comment">% guiprefs = getappdata(handles.figure1,'guiprefs');</span>
5706 guiparams.data_folder = <span class="string">''</span>;
5707 guiparams.data_files  = {<span class="string">''</span>};
5708 guiparams.gui_state   = <span class="string">'init'</span>;
5709 
5710 <span class="comment">% [EOF] createGUIparams</span>
5711 
5712 <a name="_sub111" href="#_subfunctions" class="code">function ShiptracksZoom_Callback(obj,evd,handles)</a>
5713 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when zooming)</span>
5714 
5715 <a name="_sub112" href="#_subfunctions" class="code">function ShiptracksPan_Callback(obj,evd,handles)</a>
5716 ticks_format(<span class="string">'%6.0f'</span>,<span class="string">'%8.0f'</span>); <span class="comment">%formats the ticks for UTM (when panning)</span>
5717 
5718 <span class="comment">% [EOF] VMT</span>
5719 
5720 
5721 
5722 <span class="comment">% --- Hidden keyboard commands</span>
5723 <a name="_sub113" href="#_subfunctions" class="code">function figure1_WindowKeyPressFcn(hObject, eventdata, handles)</a>
5724 <span class="comment">% Used to pass specific hidden keyboard commands to VMT. Currently, the</span>
5725 <span class="comment">% only use for this function is to open Beta support for SonTek M9 data.</span>
5726 <span class="comment">%</span>
5727 <span class="comment">% hObject    handle to figure1 (see GCBO)</span>
5728 <span class="comment">% eventdata  structure with the following fields (see FIGURE)</span>
5729 <span class="comment">%    Key: name of the key that was pressed, in lower case</span>
5730 <span class="comment">%    Character: character interpretation of the key(s) that was pressed</span>
5731 <span class="comment">%    Modifier: name(s) of the modifier key(s) (i.e., control, shift) pressed</span>
5732 <span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
5733 
5734 in1 = eventdata.Modifier; 
5735 in2 = eventdata.Key;
5736 
5737 <span class="keyword">if</span> ~isempty(in1) <span class="comment">% User pressed at least one modifier key</span>
5738     input = [in1{:} in2];
5739 <span class="keyword">else</span>
5740     input = in2;
5741 <span class="keyword">end</span>
5742 
5743 <span class="keyword">switch</span> input
5744     <span class="comment">% Hidden SonTek M9 support</span>
5745     <span class="keyword">case</span> <span class="string">'shiftcontrols'</span>
5746         msgtxt = {<span class="keyword">...</span>
5747             <span class="string">'VMT offers limited support for SonTek M9/S5 data.'</span>;<span class="keyword">...</span>
5748             <span class="string">'SonTek RiverSurveyorLive required data format:'</span>;<span class="keyword">...</span>
5749             <span class="string">'      -ENU coordinates'</span>;<span class="keyword">...</span>
5750             <span class="string">'      -Desired GPS reference (BT/GGA/VTG)'</span>
5751             <span class="string">''</span>;<span class="keyword">...</span>
5752             <span class="string">'Abosolutely NO GUARANTEE is made or implied that this'</span>;<span class="keyword">...</span>
5753             <span class="string">'functionality will work for all cases. Results are'</span>;<span class="keyword">...</span>
5754             <span class="string">'PROVISIONAL at best.'</span>};
5755         msgbox(msgtxt, <span class="string">'Hidden Functionality: Process SonTek M9'</span>, <span class="string">'warn'</span>,<span class="string">'replace'</span>)
5756         
5757         <span class="comment">% Get the Application data:</span>
5758         <span class="comment">% -------------------------</span>
5759         guiparams = getappdata(handles.figure1,<span class="string">'guiparams'</span>);
5760         guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5761         
5762         <span class="comment">% Ask the user to select files:</span>
5763         <span class="comment">% -----------------------------</span>
5764         <span class="comment">% current_file = fullfile(guiparams.data_folder,guiparams.data_files{1});</span>
5765         <span class="comment">% current_file = fullfile(guiprefs.mat_path,guiprefs.mat_file);</span>
5766         <span class="keyword">if</span> iscell(guiprefs.mat_file)
5767             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file{1});
5768         <span class="keyword">else</span>
5769             uifile = fullfile(guiprefs.mat_path,guiprefs.mat_file);
5770         <span class="keyword">end</span>
5771         [filename,pathname] = <span class="keyword">...</span>
5772             uigetfile({<span class="string">'*.mat'</span>,<span class="string">'MAT-files (*.mat)'</span>}, <span class="keyword">...</span>
5773             <span class="string">'Select SonTek RiverSurveyor Live v3.60 MAT File'</span>, <span class="keyword">...</span>
5774             uifile, <span class="string">'MultiSelect'</span>,<span class="string">'on'</span>);
5775         
5776         <span class="keyword">if</span> ischar(pathname) <span class="comment">% The user did not hit &quot;Cancel&quot;</span>
5777             guiparams.data_folder = pathname;
5778             <span class="keyword">if</span> ischar(filename)
5779                 filename = {filename};
5780             <span class="keyword">end</span>
5781             guiparams.data_files = filename;
5782             guiparams.mat_file = <span class="string">''</span>;
5783             
5784             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5785             
5786             
5787             
5788             <span class="comment">% Update the preferences:</span>
5789             <span class="comment">% -----------------------</span>
5790             guiprefs = getappdata(handles.figure1,<span class="string">'guiprefs'</span>);
5791             guiprefs.ascii_path = pathname;
5792             guiprefs.ascii_file = filename;
5793             setappdata(handles.figure1,<span class="string">'guiprefs'</span>,guiprefs)
5794             <a href="#_sub95" class="code" title="subfunction store_prefs(hfigure,pref)">store_prefs</a>(handles.figure1,<span class="string">'ascii'</span>)
5795             
5796             <span class="comment">% Push messages to Log Window:</span>
5797             <span class="comment">% ----------------------------</span>
5798             log_text = {<span class="keyword">...</span>
5799                 <span class="string">''</span>;<span class="keyword">...</span>
5800                 [<span class="string">'%--- '</span> datestr(now) <span class="string">' ---%'</span>];<span class="keyword">...</span>
5801                 <span class="string">'Current Project Directory:'</span>;<span class="keyword">...</span>
5802                 guiparams.data_folder;
5803                 <span class="string">'Loading the following files into memory:'</span>;<span class="keyword">...</span>
5804                 char(filename)};
5805             statusLogging(handles.LogWindow, log_text)
5806             
5807             <span class="comment">% Read the file(s)</span>
5808             <span class="comment">% ----------------</span>
5809             <span class="comment">%A = parseSonTekVMT(fullfile(pathname,filename));</span>
5810             
5811             [~,~,savefile,A,z] = <span class="keyword">...</span>
5812                 <a href="VMT_ReadFiles_SonTek.html" class="code" title="function [zPathName,zFileName,savefile,A,z] = VMT_ReadFiles_SonTek(zPathName,zFileName)">VMT_ReadFiles_SonTek</a>(guiparams.data_folder,guiparams.data_files);
5813             guiparams.savefile = savefile;
5814             guiparams.A        = A;
5815             guiparams.z        = z;
5816             setappdata(handles.figure1,<span class="string">'guiparams'</span>,guiparams)
5817             
5818             
5819             <span class="comment">% Update the GUI:</span>
5820             <span class="comment">% ---------------</span>
5821             <a href="#_sub97" class="code" title="subfunction set_enable(handles,enable_state)">set_enable</a>(handles,<span class="string">'fileloaded'</span>)
5822         <span class="keyword">end</span>  
5823     <span class="keyword">case</span> <span class="string">'shiftcontroll'</span> <span class="comment">% Call SontekMAT2KML</span>
5824         SontekMAT2KML;
5825     <span class="keyword">case</span> <span class="string">'f1'</span> <span class="comment">% Call the VMT UsersGuide</span>
5826         <a href="#_sub50" class="code" title="subfunction menuUsersGuide_Callback(hObject, eventdata, handles)">menuUsersGuide_Callback</a>(hObject, eventdata, handles)
5827         
5828     <span class="keyword">case</span> <span class="string">'controlalte'</span>
5829         VMT_BuildCustomFlatFile;
5830     <span class="keyword">otherwise</span>
5831         <span class="comment">%disp(input)</span>
5832 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 16-Feb-2016 14:29:39 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>